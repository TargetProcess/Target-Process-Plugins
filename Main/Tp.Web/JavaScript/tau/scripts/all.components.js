define("tau/core/event",["Underscore"],function(e){var t=function(e){var t=e.split(":"),i={name:t[0]};return t.length>1&&(i.rule=t[1]),i},i=function(t){return t.name?[t.data]:e.pluck(e.values(t),"data")},n=function(){};n.implementOn=function(e){var t=n.prototype;for(var i in t)void 0==e[i]&&(e[i]=t[i]);return e},n.extend=function(e){return n.implementOn(e.prototype),e},n.signUpOnEvents=function(n,a,r,s,o,l){for(var u={},c=[],d={},p=function(t){if(l)for(var s=e.indexOf(n,t.name),o=0;s>o;o++){var p=n[o].replace(":last","");if(!u.hasOwnProperty(p))return}if(u[t.name]=t,e.keys(u).length===c.length){for(var f={},m=0,h=c.length;h>m;m++){var g=d[c[m]];f[g.name]=u[g.name],"last"!==g.rule&&delete u[g.name]}f=[f].concat(i(f)),a[r].apply(a,f)}},f=0,m=n.length;m>f;f++){var h=t(n[f]),g=h.name;d[g]=h,c.push(g),s.on(g,p,a,null,o)}},n.subscribeOn=function(t){var i=[];for(var a in t)if(/\s/.test(a)){var r=t[a];r&&e.isFunction(r)&&i.push(a)}i.sort();for(var s=0,o=i.length;o>s;s++){var l=i[s],u=l.replace(/\s*\+\s*/g,"+").replace(/\s*>\s*/g,">"),c=u.split(/\s+/);if(!(c.length<2)){var d=c[0];if(e.has(t,d)){var p=t[d];if(p&&e.isFunction(p.on)){var f=c[1],m=f.split("+"),h=f.split(">");if(m.length>1&&h.length>1)throw new Error('"'+l+'": + and > can not be used together');var g;c.length>2&&!isNaN(c[2])&&(g=c[2]),m.length>1?n.signUpOnEvents(m,t,l,p,g,!1):h.length>1?n.signUpOnEvents(h,t,l,p,g,!0):p.on(f,t[l],t,null,g)}}}}},n.unSubscribe=function(t){e.each(t,function(i){i&&e.isFunction(i.removeAllListeners)&&i.removeAllListeners(t)})};var a=function(e){this.name=e,this.listeners=[]};a.prototype={getListenerIndex:function(e,t){for(var i=0,n=this.listeners;i<n.length;i++){var a=n[i];if(a.fn==e&&(a.scopeObj===t||!a.scopeObj&&!t))return i}return-1}};var r={getPrivateEvents:function(){var e=this.getPrivate&&this.getPrivate()||this._||(this._={});return e.events||(e.events={})},getPrivateEvent:function(e){var t=this.getPrivate&&this.getPrivate()||this._;return t&&t.events?t.events[e]:null},once:function(t,i,n,a,r){var s=e.bind(function(e){this.removeListener(t,e,n||this)
},this),o=function(){i.apply(this,e.toArray(arguments)),s(o)};this.on(t,o,n,a,r)},on:function(t,i,r,s,o){if(e.isString(t)&&t.indexOf("+")>0){var l=t.split("+");return n.signUpOnEvents(l,this,i,this,o),this}if(e.isArray(t)){var u=this;return e.each(t,function(e){u.on(e,i,r,s,o)}),this}var c=this.getPrivateEvents(),d=c[t]||(c[t]=new a(t));if(d.getListenerIndex(i,r)>=0)return this;var p=d.listeners;r||(r=this),isNaN(o)&&(o=10);var f=this,m=function(e,n,a,o,l){var u={name:t,sender:this,date:new Date,caller:e,data:n,listenerData:s,stop:a,cancel:o,suspendMain:function(){l&&l.lock()},cancelMain:function(){l&&l.cancel()},resumeMain:function(){l&&l.unlock()},removeListener:function(){f.removeListener(t,i,r)}};return i.call(r,u,u.data),u.data};m.fn=i,m.scopeObj=r,m.priority=o;for(var h=p.length-1;h>=0;h--)if(p[h].priority<=o)return p.splice(h+1,0,m),this;return p.unshift(m),this},fire:function(){var e=!1,t=function(){e=!0},i=!1,n=function(){i=!0};return function(a,r,s,o){var l=this.getPrivateEvent(a),u=e,c=i;if(e=i=!1,l){var d=l.listeners;if(d.length){d=d.slice(0);for(var p=0;p<d.length;p++){var f=d[p].call(this,s,r,t,n,o);if("undefined"!=typeof f&&(r=f),e||i)break}}}var m=i||("undefined"==typeof r?!1:r);return e=u,i=c,m}}(),fireOnce:function(e,t,i){var n=this.fire(e,t,i);return delete this.getPrivateEvents()[e],n},removeListener:function(e,t,i){var n=this.getPrivateEvent(e);if(n){var a=n.getListenerIndex(t,i);a>=0&&n.listeners.splice(a,1)}},removeAllListeners:function(e){var t=this.getPrivateEvents();for(var i in t)if(t[i].listeners)if(e){for(var n=t[i].listeners,a=[],r=0;r<n.length;r++)n[r].scopeObj!=e&&a.push(n[r]);t[i].listeners=a}else delete t[i].listeners,delete t[i]},hasListeners:function(e){var t=this.getPrivateEvent(e);return t&&t.listeners.length>0},getListeners:function(){var e=this.getPrivateEvents(),t=[];for(var i in e){var n=e[i].listeners;if(n&&n.length>0){for(var a=[],r=0;r<n.length;r++){var s=n[r],o={name:"unknown",item:s};s.scopeObj&&s.scopeObj.bus&&s.scopeObj.bus.name?o.name=s.scopeObj.bus.name:s.scopeObj&&s.scopeObj.name&&(o.name=s.scopeObj.name),a.push(o)
}t.push({name:i,items:n,count:n.length,listeners:a})}}return t},getListenersCount:function(){var e=this.getPrivateEvents(),t=0;for(var i in e)e[i].listeners&&(t+=e[i].listeners.length);return t},createChildEventEmitter:function(t){var i=this,n=["on","removeListener","removeAllListeners","hasListeners","getListeners","getListenersCount"],a=e.map(n,function(e){return{writable:!1,value:this[e].bind(this)}},this),r=e.extend(e.object(n,a),t);return Object.create(i,r)}};return r.addEventListener=r.on,r.unbind=r.removeAllListeners,n.prototype=r,n}),define("tau/core/bus.collection",["Underscore","jQuery","tau/core/class","tau/core/event"],function(e,t,i,n){var a=i.extend({init:function(){this.buses={}},register:function(e){this.buses[e.id]=e,this.fire("create",{bus:e})},count:function(t){var i=e.keys(this.buses);return t&&(i=e.without(i,"global")),i.length},size:function(){return this.count()},stats:function(){var t={};e.forEach(this.buses,function(e){t.hasOwnProperty(e.name)||(t[e.name]=0),t[e.name]++}),e.forEach(t,function(e,t){console.log(t+" : "+e)})},unregister:function(e){"global"!==e.id&&(delete this.buses[e.id],this.fire("destroy",{bus:e}))},getByName:function(i,n){var a=t.Deferred(),r=function(e){return e.name===i},s=e.find(this.buses,r);if(s)a.resolve(s);else{var o=e.bind(function(e,t){var i=t.data.bus;r(i)&&(this.removeListener("create",o,this),e.resolve(i))},this,a);this.on("create",o,this)}return n&&a.done(n),a},onCreate:function(e){this.register(e)},onDestroy:function(e){this.unregister(e)},logCount:function(){console.log("#count: "+this.count())},clear:function(){this.buses={}}});return n.implementOn(a.prototype),a}),define("tau/core/bus.reg",["Underscore","tau/core/bus.collection"],function(e,t){var i=new t;return window.tau=window.tau||{},e.extend(window.tau,{buses:i}),i}),define("tau/core/event.queued",["Underscore","tau/core/event"],function(e,t){var i=function(){t.call(this,arguments)};e.extend(i,t),e.extend(i.prototype,t.prototype);var n=null,a=function(i){var a=e.clone(i.originalArguments);
a[0]="after_"+a[0],a[1]=a[1]||{},a[2]=a[2]||{},n&&0!=n.length?(n.push({arguments:i.originalArguments,scope:i.scope}),n.push({arguments:a,scope:i.scope})):(t.prototype.fire.apply(i.scope,i.originalArguments),t.prototype.fire.apply(i.scope,a))};return i.prototype.fire=function(){var i=e.toArray(arguments),r=e.clone(i);r[0]="before_"+r[0],r[1]=r[1]||{},r[2]=r[2]||{};var s=e.clone(i);if(s[0]="after_"+s[0],s[1]=s[1]||{},s[2]=s[2]||{},r[3]={lockCount:0,canceled:!1,originalArguments:i,scope:this,unlockedDelegate:function(){},setUnlockDelegate:function(e){this.unlockedDelegate=e},isCanceled:function(){return this.canceled},isLocked:function(){return this.lockCount>0},cancel:function(){this.canceled=!0},lock:function(){this.lockCount++},unlock:function(){this.lockCount--,0==this.lockCount&&(this.unlockedDelegate(this),delete this.originalArguments,delete this.scope)}},e.isNull(n)){for(n=[],n.push({arguments:r,scope:this}),n.push({arguments:i,scope:this}),n.push({arguments:s,scope:this});n.length>0;){var o=n.shift(),l=o.arguments,u=o.scope;t.prototype.fire.apply(u,l);var c=l&&l[3];c&&(c.isLocked()||c.isCanceled())&&(n.splice(0,2),0==c.isCanceled()&&c.setUnlockDelegate(a))}n=null}else n.push({arguments:r,scope:this}),n.push({arguments:i,scope:this}),n.push({arguments:s,scope:this})},i}),define("tau/core/bus",["Underscore","tau/core/class","tau/core/bus.reg","tau/core/event","tau/core/event.queued"],function(e,t,i,n,a){var r=function(e){return function(t,n){this.globalBus&&this.globalBus.fire(t,n,this);var a=e.prototype.fire.apply(this,arguments);return"destroy"===t&&(i.onDestroy(this),delete this.globalBus),a}},s=r(a),o=t.extend({globalBus:null,init:function(t){t=t||{},(t["queue.bus"]||t.queuedBus)&&(this.fire=s),this.globalBus=t&&t.globalBus?t.globalBus:null,this.name=t&&t.name?t.name:e.uniqueId()+"",e.defaults(t,{id:e.uniqueId("bus_")}),this.id=t.id,i.onCreate(this)},initialize:function(e){this.fire("initialize",e)},destroy:function(){this.fire("destroy"),delete this.globalBus
},getGlobalBus:function(){return this.globalBus}});return n.implementOn(o.prototype),o.prototype.fire=r(n),o}),define("tau/core/global.bus",["tau/core/bus","app.bus"],function(e,t){var i=new e({id:"global",name:"globalBus"});return t.resolve(i),{bus:null,reset:function(){},get:function(){return i}}}),define("app.path",["jQuery","tau/core/class"],function($,clazz){var appRoot=null,getAppPath=function(e){var t=window.location,i=t.protocol+"//"+t.host+t.pathname,n=i.split("/");n.pop();var a=window.pathToRequire?window.pathToRequire:$(document).find('script[src*="/require.js"]').attr("src"),r=a.split("/");r.pop();for(var s=e.split("/");".."===r[0];)r.shift(),n.pop();if(0===r.length)for(var o=0;o<s.length;o++)n.pop();else if(r.join("/").toLowerCase()!==s.join("/").toLowerCase())throw"Can't determine application root";return n.join("/")},api={get:function(){return appRoot||(appRoot=getAppPath("javascript/tau/scripts"))},tp:{}},tp=api.tp;return tp.UrlParameterCollection=clazz.extend({query:null,_parameters:null,init:function(e){this.query=e;var t=[],i=this.query.split("&"),n="";if(i.length<1)return t;for(var a=0;a<i.length;a++)n=i[a].split("="),n[0].length>0&&(t[a]=[n[0],1==n.length?n[0]:n[1]]);this._parameters=t},get:function(e){var t=this._findParameter(e);return t?t[1]:void 0},_findParameter:function(e){for(var t=0;t<this._parameters.length;t++)if(this._parameters[t][0]==e)return this._parameters[t]},set:function(e,t){var i=this._findParameter(e);return i?void(i[1]=t):void this._parameters.push([e,t])},remove:function(e){for(var t=0;t<this._parameters.length;t++)this._parameters[t][0]==e&&this._parameters.splice(t,1)}}),tp.UrlParameterCollection.prototype.toString=function(){if(0==this._parameters.length)return"";for(var e="?",t=0;t<this._parameters.length;t++)t>0&&(e+="&"),e+=this._parameters[t][0]+"="+this._parameters[t][1];return e},tp.URL=clazz.extend({init:function(url){0==url.length&&eval('throw "Invalid URL ['+url+']"'),this.url=url,this.port=-1,this.query=this.url.indexOf("?")>=0?this.url.substring(this.url.indexOf("?")+1):"",this.query.indexOf("#")>=0&&(this.query=this.query.substring(0,this.query.indexOf("#"))),this.protocol="",this.host="",this.protocolSep="",this.portSep="";
var protocolSepIndex=this.url.indexOf("://");if(protocolSepIndex>=0){this.protocolSep="://",this.protocol=this.url.substring(0,protocolSepIndex).toLowerCase(),this.host=this.url.substring(protocolSepIndex+3),this.host.indexOf("/")>=0&&(this.host=this.host.substring(0,this.host.indexOf("/")));var atIndex=this.host.indexOf("@");if(atIndex>=0){var credentials=this.host.substring(0,atIndex),colonIndex=credentials.indexOf(":");colonIndex>=0?(this.username=credentials.substring(0,colonIndex),this.password=credentials.substring(colonIndex)):this.username=credentials,this.host=this.host.substring(atIndex+1)}var portColonIndex=this.host.indexOf(":");portColonIndex>=0&&(this.portSep=":",this.port=this.host.substring(portColonIndex),this.host=this.host.substring(0,portColonIndex)),this.file=this.url.substring(protocolSepIndex+3),this.file=this.file.substring(this.file.indexOf("/"))}else this.file=this.url;this.file.indexOf("?")>=0&&(this.file=this.file.substring(0,this.file.indexOf("?")));var refSepIndex=url.indexOf("#");refSepIndex>=0?(this.file=this.file.substring(0,refSepIndex),this.reference=this.url.substring(this.url.indexOf("#"))):this.reference="",this.path=this.file,this.query.length>0&&(this.file+="?"+this.query),this.reference.length>0&&(this.file+="#"+this.reference),this._parameters=new tp.UrlParameterCollection(this.query)},getPort:function(){return this.port},getQuery:function(){return this._parameters.toString()},getProtocol:function(){return this.protocol},getHost:function(){return this.host},getUserName:function(){return this.username},getPassword:function(){return this.password},getFile:function(){return this.file},getReference:function(){return this.reference},getPath:function(){return this.path},getAcid:function(){return this.getArgumentValue("acid")},setAcid:function(e){this.setArgumentValue("acid",e)},setArgumentValue:function(e,t){this._parameters.set(e,t)},removeArgument:function(e){this._parameters.remove(e)},getArgumentValue:function(e){var t=this._parameters.get(e);
return null!=t?t.replace(/\+/g," "):null}}),tp.URL.prototype.toString=function(){var e=[this.getProtocol(),this.protocolSep,this.getHost(),this.getPort(),this.getPath(),this.getQuery()],t="";return $.each(e,function(){this&&-1!=this&&(t+=this)}),t},tp.AcidURL=tp.URL.extend({init:function(e){this._super(e)},toString:function(){var e=new tp.URL(document.location.href).getAcid();return this.setAcid(e),this._super()}}),tp.WebServiceURL=tp.AcidURL.extend({init:function(e){this._super(api.get()+e)}}),api}),define("tau/core/tau",["Underscore"],function(e){var t=t||{};t.empty=function(){},t.ns=function(e){for(var t=e.split("."),i=window,n=0,a=t.length;a>n;n++){var r=t[n];"undefined"==typeof i[r]&&(i[r]={}),i=i[r]}},t.getIEVersion=function(e){e=e||window.navigator;var t,i=e.appName,n=e.userAgent;return"Microsoft Internet Explorer"==i?t=n.match(/MSIE (\d+[.\d]*)/):"Netscape"==i&&(t=n.match(/Trident\/.*rv:(\d+[.\d]*)/)),t?parseInt(t[1],10):void 0},t.ieVersion=t.getIEVersion(),t.getQueryValueFromUrl=function(e,t){t=t.replace(/\[/,"\\[").replace(/\]/,"\\]");var i="[\\?&]"+t+"=([^&#]*)",n=new RegExp(i,"i"),a=n.exec(e);return a?a[1]:""},t.getValueFromQueryString=function(e){var i=window.location.href;return t.getQueryValueFromUrl(i,e)},t.getTokenParameterFromQueryString=function(e){var i=t.getValueFromQueryString("token");return i?e+"token="+i:""},t.extendArgs=function(e,t){var i=e;return i=[].slice.call(e),i.unshift(t),i},t.concat=function(){return String.prototype.concat.apply("",arguments)},t.createScopedCallbackIfRequired=function(e){return"function"==typeof e?e:t.createScopedCallback(e.fn,e.scope)},t.createScopedCallback=function(e,t){return"function"!=typeof e&&"function"==typeof e.fn&&(e=e.fn,e.scope&&(t=e.scope)),"function"==typeof e&&t?e.bind(t):e},t.getCallbacks=function(i){return i=i||{},e.isFunction(i)&&(i={success:i}),{success:t.createScopedCallback(i.success||t.empty,i.scope),failure:t.createScopedCallback(i.failure||t.empty,i.scope)}};var i=function(e,t,i){this.name="tauError",this.message=e,this.description=t,this.data=i,this.stack=(new window.Error).stack
};return i.prototype=new window.Error,t.Error=i,t}),define("tau/store/typesClass",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(){this._dictionary={}},registerType:function(t,i){i[t.name]=t,t.aliases=t.aliases||[],t.refs=t.refs||{},e.each(t.aliases,function(e){i[e]=i[e.toLowerCase()]=t})},register:function(e){var t=this,i=t._dictionary;this.registerType(e,i)},findByKeyword:function(e){return this._dictionary[e]||null},getDictionary:function(){return this._dictionary}})}),define("tau/store/types",["tau/store/typesClass"],function(e){return new e}),define("tau/core/save.interrupter",["tau/core/class","jQuery","Underscore"],function(e){var t=e.extend({init:function(){this.interrupters={}},interruptSave:function(e,t){var i=e.toLowerCase();this.interrupters[i]||(this.interrupters[i]=[]),this.interrupters[i].push(t)},getInterruptersByType:function(e){if(!e)return[];var t=this.interrupters[e.toLowerCase()];return t||[]},clear:function(){this.interrupters={}}});return t}),define("tau/store/store.interrupter",["tau/core/save.interrupter"],function(e){return new e}),define("tau/store/store",["Underscore","tau/core/class","tau/core/tau","tau/store/types","tau/store/typesClass","tau/core/bus","tau/core/global.bus","tau/store/store.interrupter","libs/jquery/jquery"],function(e,t,i,n,a,r,s,o,l){var u=new r({"queue.bus":!0,name:"store",globalBus:s.get()}),c={_processCommand:function(e,t,i,n){n=n||{};var a=this.types[t];a&&(t=a.name);var r={type:t,name:e,config:i,callbacks:n};return this.commands.push(r),this}};return t.extend({init:function(t){this.id=e.uniqueId("store_"),this._frozenCommandsQueue=[],this._frozenPromisesQueue=[],this._frozenPromises={},this.config=t,this.eventEmitter=this.config.eventEmitter||{fire:function(){},on:function(){},removeAllListeners:function(){}};var r=t.types||t.proxy.types;if(r){var s=new a;e(r).each(function(e){s.register(e)}),c.types=s.getDictionary()}else c.types=n.getDictionary();var o=e.functionsExt(t.proxy);e.each(o,function(e){var t=e.split("api ");
if(2===t.length){var n=t[1];c[n]=function(){var e=this,t=i.extendArgs(arguments,n);return e._processCommand.apply(e,t)}}}),this._extendWithCommonAPI(this,this)},typeMetaInfo:function(e){return c.types[e]},getTypes:function(){return n},_extendWithCommonAPI:function(t,i){e.each(e.functionsExt(c),function(n){"_"!=n[0]&&(t[n]=function(){var a=e.extend({},c);return a.commands=t.commands||[],a[n].apply(a,arguments),a.done=function(e){i._done(a.commands,e)},a})})},_unfreeze:function(){if(e.isEmpty(this._frozenPromises)){var t=[].concat(this._frozenCommandsQueue);this._frozenCommandsQueue=[],this.config.proxy.execute(t)}},_freeze:function(){var t=this,n=e.uniqueId(),a={id:n,unfreeze:function(){this.unfreeze=i.empty,delete t._frozenPromises[n],t._unfreeze(),t._frozenPromisesQueue.shift();var e=t._frozenPromisesQueue[0];e&&e.resolve(t._freeze())}};return t._frozenPromises[n]=a,a},freeze:function(e){var t=l.Deferred();if(this._frozenPromisesQueue.push(t),e)return 1===this._frozenPromisesQueue.length&&t.resolve(this._freeze()),t;var i=this._freeze();return t.resolve(i),i},register:function(e,t){this.config.proxy.registerData(e,t)},registerWithEvents:function(e,t,i){var n=e.id,a=e.__type;e.hasOwnProperty("assignable")&&this.evictProperties(n,a,["$ref:assignable[id]"]);var r=this.config.proxy,s=r.registerData(e,t);r._notifyAboutNewsAndChanges(s,i||null)},removeWithEvents:function(t){t.type=e.toCamelCase(t.__type);var i=this.config.proxy;this.evictPersistedObject(t.id,t.type),i._populateAfterRemoveEvent(null,{tree:[],deletedData:[t]})},on:function(e,t){return this.config.proxy.on(e,t),this.eventEmitter.fire("afterStoreOn",e),this},unbind:function(e){return this.config.proxy.unbind(e),this.eventEmitter.fire("afterStoreUnbind",e),this},_processChain:function(t,n){n=i.getCallbacks(n);var a=[].concat(t);e.each(t,function(r){var s=i.getCallbacks(r.callbacks),o=function(i,o,l){u.fire(o,l),a[e.indexOf(a,r)]=l;var c=e.every(t,function(e){return e.executed===!0});if(s[i](l),c){var d=e.some(t,function(e){return e.failed===!0
});n[d?"failure":"success"](a)}};r.callbacks={success:o.bind(this,"success","store.command.executed"),failure:o.bind(this,"failure","store.command.failed")}},this)},done:function(e){i.getCallbacks(e).success([])},getEvictedPropertiesByType:function(e){return"project"===e?["process"]:"task"===e?["project","team","userStory"]:["project","team"]},evictProperties:function(e,t,i){this.config.proxy.evictProperties(e,t,i)},evictData:function(){this.config.proxy.evictData()},evictPersistedObject:function(e,t){this.config.proxy.evictPersistedObject(e,t)},evictCollection:function(e){this.config.proxy.evictCollection(e)},isPropertyInitialized:function(e,t,i){return this.config.proxy.isPropertyInitialized(e,t,i)},_done:function(t,i){if(this._processChain(t,i),e.isEmpty(this._frozenPromises)){var n=e.reduce(t,function(e,t){var i="save"==t.name&&o.getInterruptersByType(t.type).length>0;return i?e.interrupted.push(t):e.nonInterrupted.push(t),e},{interrupted:[],nonInterrupted:[]});n.interrupted.length>0?this._callInterruptedCommands(n.interrupted,n.nonInterrupted):this._callNotInterruptedCommands(n.nonInterrupted)}else this._frozenCommandsQueue=[].concat(this._frozenCommandsQueue,t)},_callInterruptedCommands:function(t,i){var n=this,a=t.concat(i),r=e.chain(t).map(function(t){return e.map(o.getInterruptersByType(t.type),function(e){return{callback:e,deferred:l.Deferred(),command:t}})}).flatten().value(),s=e.map(r,function(e){return e.deferred});l.whenList(s).done(function(){n.config.proxy.execute(a)}).fail(function(t){e.each(a,function(e){e.failed=!0,e.error=t,n.config.proxy.invokeFailCallback(e)})}),e.each(r,function(e){e.callback(e.deferred,n._getChanges(e.command))})},_getChanges:function(t){var i=t.type,n=l.isArray(t.config.$set)?t.config.$set:[t.config.$set],a=t.config.id;return e.map(n,function(t){return{type:i,id:a||t.id,changes:e.chain(e.keys(t)).filter(function(e){return"id"!=e}).map(function(e){return{name:e,value:t[e]}}).value()}})},_callNotInterruptedCommands:function(e){this.config.proxy.execute(e)
},getDef:function(){var t=e.toArray(arguments),i=l.Deferred();return t.push({success:function(e){i.resolve(e.data)},failure:i.reject}),this.get.apply(this,t).done(),i},saveDef:function(){var t=e.toArray(arguments),i=l.Deferred();return t.push({success:function(e){i.resolve(e)},failure:i.reject}),this.save.apply(this,t).done(),i},removeDef:function(){var t=e.toArray(arguments),i=l.Deferred();return t.push({success:i.resolve,failure:i.reject}),this.remove.apply(this,t).done(),i}})}),define("tau/store/header",["Underscore","tau/core/tau"],function(_,tau){var tauExtension=_.extend(tau,{ref:function(e,t){var i={};return i[e]=t,i},list:function(e,t){var i=tau.ref(e,t);return i.list=!0,i},getNextPage:function(e,t,i){i=i||[];var n={holder:e,url:t,fields:i};return e.getNextPage=function(){return n},n},parseFieldsFromString:function(value){var self=this;value=value.replace(/([\w-]+)\[+/gi,'{"$1":['),value=value.replace(/(\])/gi,"]}"),value=value.substr(0,value.length-1),value=value.replace(/([\w-]+)(,|\])/gi,"'$1'$2");var fields=eval("(function () { return "+value+";})();"),toLowerCase=function(e){var t=e.split("-");if(t.length>1){var i=[];return _.each(t,function(e){i.push(toLowerCase(e))}),i.join("-")}return e.charAt(0).toLowerCase()+e.substr(1)},formatFields=function(e){var t=[];return _.each(e,function(e){if(self.header.isSimple(e))return void t.push(toLowerCase(e));var i={},n=self.header.getFieldName(e);i[toLowerCase(n)]=formatFields(e[n]),t.push(i)}),t};return formatFields(fields)},formatObject:function(e,t){var i=this,n={data:[],nextPages:[]};if(_.isUndefined(e)||_.isNull(e))return n.data=null,n;if("object"!=typeof e)return n.data=e,n;t=t?t:"Lower";var a=function(e){return e.charAt(0)["to"+t+"Case"]()+e.substr(1)};if(e&&(e.hasOwnProperty("Items")||e.hasOwnProperty("items"))){var r=e.next||e.Next;r&&n.nextPages.push(i.getNextPage(n.data,r,[])),e=e.Items||e.items}if(_.isArray(e))return _.each(e,function(e){var a=i.formatObject(e,t);n.nextPages=n.nextPages.concat(a.nextPages||[]),n.data.push(a.data)
}),n;var s={};return _.each(_.keys(e),function(r){var o=a(r),l=o.split("-");if(l.length>1){var u=[];_.each(l,function(e){u.push(a(e))}),o=u.join("-")}var c=i.formatObject(e[r],t);n.nextPages=n.nextPages.concat(c.nextPages||[]),s[o]=c.data}),n.data=s,n},header:{getFieldName:function(e){return _.getFieldName(e)},isSimple:function(e){return _.isString(e)},isList:function(e){return e.list===!0}}});return tauExtension}),define("tau/core/comparer",["Underscore"],function(e){return{isEqualIncluded:function(t,i){if(t===i)return!0;var n=typeof t,a=typeof i;if(n!=a)return!1;if(t==i)return!0;if(!t&&i||t&&!i)return!1;if(e.isDate(t)&&e.isDate(i))return t.getTime()===i.getTime();if(e.isNaN(t)&&e.isNaN(i))return!1;if(e.isRegExp(t)&&e.isRegExp(i))return t.source===i.source&&t.global===i.global&&t.ignoreCase===i.ignoreCase&&t.multiline===i.multiline;if("object"!==n)return!1;if(e.isArray(t)&&e.isArray(i)&&t.length!==i.length)return!1;for(var r=e.keys(i),s=0;s<r.length;s++){var o=r[s];if(t.hasOwnProperty(o)&&!this.isEqualIncluded(t[o],i[o]))return!1}return!0},compare:function(t,i){var n=this,a={changes:{}};return t?(e.each(e(i).keys(),function(e){var r={value:i[e]};return t.hasOwnProperty(e)?void(n.isEqualIncluded(t[e],i[e])||(a.changes[e]=r)):void(a.changes[e]=r)}),a):a}}}),define("tau/store/db",["Underscore","tau/core/class","tau/store/header","tau/core/comparer"],function(e,t,i,n){return t.extend({init:function(e){this.__data={},this.__types=e.types||{}},_getTypeHolder:function(e,t){var i=e[t]||{};return e.hasOwnProperty(t)||(e[t]=i),i},_getTypeDictionary:function(e){return this._getTypeHolder(this.__data,e)},getPersistedNode:function(e,t){var i=this.__data[t];if(!i)return null;if(!e)return i;var n=i[e];return n?n:null},_getRefsArray:function(t){return t&&t.refs?(t.hasOwnProperty("refsArray")||(t.refsArray=e(t.refs).keys()),t.refsArray):[]},_registerReference:function(t,i,a,r,s){var o=this,l=a.refs[i];if(e.isUndefined(t)||null===t||null===t.id)return l.list?[]:null;t.__type=l.name;var u=o.__types[l.name],c=o._register(t,function(t){if(u.refs){var i=l.relationProperty;
if(i){var a=u.refs[i];if(a){var c=t.data.hasOwnProperty(i),d=a.list;if(!d||c){var p=t.data[i],f=o._getReferenceObject(r.id,r.__type),m=function(e){var i={};i[l.relationProperty]=e,s.diffs.push({id:t.id,type:o._getOriginType(t),changes:i})};d?e(p).any(function(e){return e.id===r.id})?f=p:(f=p.concat([f]),m(f)):n.isEqualIncluded(f,p)||m(f),t.data[i]=f}}}}});e.mergeArrayObjects(s,c,["diffs"]);var d={isReference:!0,type:l.name,list:!0};return l.list?e.extend(c.refs,d):c.refs[0]},_removeCascadeObjects:function(t,i){var n=this,a=n._getRegisterTemplate();return e.each(n._getRefsArray(t),function(r){var s=t.refs[r];s.cascade&&(s.list?e.each(i[r],function(e){n._extendRegister(a,n.remove(e.id,e.type))}):n._extendRegister(a,n.remove(i[r].id,i[r].type)))}),a},_getOriginType:function(e){return e.origin?e.origin.type:e.__type},_removeRefFromObj:function(t,i,n,a,r){var s=this,o=t.data;if(o.hasOwnProperty(i)){var l=o[i];if(l){var u=a.refs[i];if(u.relationProperty){var c=s.__types[u.name];e.isArray(l)||(l=[l]);for(var d=0,p=l.length;p>d;d++){var f=l[d];if(!r||r===f.id){var m=s.getPersistedNode(f.id,f.type);if(!m)return;if(!m.data.hasOwnProperty(u.relationProperty))return;n.nodes.push(m);var h={};h[u.relationProperty]=null,c.refs&&c.refs[u.relationProperty]&&c.refs[u.relationProperty].list?(m.data[u.relationProperty]=e(m.data[u.relationProperty]).select(function(e){return e.id!=t.id}),h[u.relationProperty]=m.data[u.relationProperty]):m.data[u.relationProperty]=null,n.diffs.push({id:m.id,type:s._getOriginType(m),changes:h})}}}}}},_removeObjectFromRefs:function(t,i){var n=this,a=n._getRegisterTemplate();return e(n._getRefsArray(t)).each(function(e){n._removeRefFromObj(i,e,a,t)}),a},removeProperties:function(t,i,n){var a=this.getPersistedNode(t,i);if(a){var r=a.data;e.each(n,function(e){delete r[e]})}},removeFromList:function(t,n,a){var r=this._getRegisterTemplate(),s=this.getPersistedNode(t,n);if(!s)return r;var o=this.__types[n],l=i.header.getFieldName(a),u=s.data[l]||[];if(!u)return r;
var c=[],d=a[l].id;e.each(u,function(e){e.id==d?this._removeRefFromObj(s,l,r,o,d):c.push({id:e.id})},this);var p={id:t,__type:n};p[l]=c;var f=this.register(p);return this._extendRegister(f,r),f},remove:function(t,i){var n=this._getRegisterTemplate(),a=this.getPersistedNode(t,i);if(!a)return n;var r=this.__types[i],s=a.data;return n.deletedData.push(e(s).defaults({id:t,type:i})),delete this.__data[i][t],this._extendRegister(n,this._removeCascadeObjects(r,s)),this._extendRegister(n,this._removeObjectFromRefs(r,a)),n},removeCollection:function(t){var i=this,n=i.__data[t];n&&e.forEach(e.keys(n),function(e){i.remove(e,t)})},isPropertyInitialized:function(e,t,i){var n=this.getPersistedNode(e,t);return n&&n.data?n.data.hasOwnProperty(i):!1},_getReferenceObject:function(e,t){return{isReference:!0,id:e,type:t}},_attachReference:function(e,t,i){var n=this._getReferenceObject(t,i);return e.push(n),n},_getParentTypeNames:function(e){if(!e.__parents){e.__parents=[];for(var t=e.parent;t;){e.__parents.push(t);var i=this.__types[t];if(!i)break;t=i.parent}}return e.__parents},_registerParentNodes:function(t,i,n){for(var a={data:n.data,id:i,origin:{id:i,type:t}},r=this.__types[t],s=this._getParentTypeNames(r),o=0;o<s.length;o++){var l=s[o],u=this._getTypeDictionary(l);u[i]=u[i]||{},e.extend(u[i],a)}},_getRegisterTemplate:function(){return{refs:[],nodes:[],diffs:[],tree:{},deletedData:[]}},_registerObjectInTree:function(t,i){var n=this,a=n._getTypeHolder(t,i.type);if(!a.hasOwnProperty(i.id)){for(var r={},s=n.__types[i.type],o={id:i.id,changes:r},l=n._getParentTypeNames(s),u=0;u<l.length;u++){var c=n.__types[l[u]],d=n._getTypeHolder(t,c.name);d[i.id]=o}a[i.id]=o}e.extend(a[i.id].changes,i.changes)},_extendTree:function(t,i){var n=this;e.each(i,function(e){n._registerObjectInTree(t,e)})},_extendRegister:function(t,i){this._extendTree(t.tree,i.diffs),e.mergeArrayObjects(t,i,["diffs","deleteData"])},register:function(e,t,i){return this._register(e,t,i)},isTypeDetectionRequired:function(e){var t=this.__types[e];
return t.isParentType},getTypeDetectionForNode:function(e,t){if(!this.isTypeDetectionRequired(t))return{required:!1};var i=this.getPersistedNode(e,t);return i&&i.origin&&i.origin.id&&i.origin.type?{required:!1,type:i.origin.type}:{required:!0}},_getTypeDefinitionForRegistration:function(e,t,i){var n=this.__types[t]||this.__types[t.toLowerCase()];if(n.isParentType){var a=this.getTypeDetectionForNode(e,n.name);t=a.required?n.detectType(i):a.type,n=this.__types[t]}return n},_register:function(t,i,n){n=n||"__type";var a=this._getRegisterTemplate();if(e.isEmpty(t))return a;e.isArray(t)||(t=e.isArray(t.items)?t.items:[t]);for(var r=t[n],s=0,o=t.length;o>s;s++){var l=t[s];l.hasOwnProperty(n)||(l[n]=r),this._registerObject(l,a,i,n)}return a},__findItemByName:function(t,i){return e.find(t,function(e){return e.name===i})},_registerObject:function(t,i,a,r){var s=this,o=t[r],l=t.id;if(!l)throw new Error('Property "id" is required for data registration entity "'+o+'"');if(!o)throw new Error('Property "__type" is required for data registration entity "'+l+'"');var u=s._getTypeDefinitionForRegistration(l,o,t);if(!u)return void console.warn("Missing type definition for object",t);var c={id:l,type:u.name,changes:{}},d=s._getTypeDictionary(u.name),p=d[l];p||(d[l]=p={__type:u.name,data:{id:l},id:l},s._registerParentNodes(u.name,l,p,d));var f=p.data,m=u.refs,h=s._getRegisterTemplate();for(var g in t)if("__type"!==g&&"id"!==g){var v=t[g],b=f[g];if(m.hasOwnProperty(g)&&(v=s._registerReference(v,g,u,p,h)),"customFields"===g){v=e.map(v,function(e){if("Entity"===e.type){if(e.value&&"None"===e.value.kind&&""===e.value.name){var t=s.__findItemByName(b,e.name);if(t)return t}}else"CheckBox"===e.type&&null==e.value&&(e.value=!1);return e});var y=e.filter(v,function(e){var t=s.__findItemByName(b,e.name);return t?!n.isEqualIncluded(e,t):!0});c.changes[g]=y}p.data[g]=v,"customFields"===g||n.isEqualIncluded(b,v)||(c.changes[g]=v)}s._extendRegister(i,h),p.data.hasOwnProperty("__type")&&delete p.data.__type,i.nodes.push(p),s._extendTree(i.tree,[c]),i.diffs.push(c),s._attachReference(i.refs,l,u.name),a&&a(p)
},get:function(t,i,n){if(t)return this._get(t,i,n);var a={data:[],notInitializedFields:[],all:!0};return e.each(this._getTypeDictionary(i),function(e,t){var r=this._get(t,i,n);a.data.push(r.data),this.mergeFields(a.notInitializedFields,r.notInitializedFields)},this),a},_get:function(t,n,a){var r=this;a=a||{};var s=r.getPersistedNode(t,n),o=r.__types[n]||{},l=o.refs||{},u=a.$fields||a.fields||[],c={data:null,type:o,notInitializedFields:u};if(!s)return c;var d={},p=[],f=function(e,t,i){var n=r._get(e.id,e.type,{fields:t||[]});return n.notInitializedFields.length&&i.push(n.notInitializedFields),n.data},m=s.data;return e.each(u,function(t){var n=i.header.getFieldName(t),a=m[n];if(e.isUndefined(a))return void p.push(t);if(d[n]=a,l.hasOwnProperty(n)&&a){var s=[];if(e.isArray(a)){var o=a;a=[],e.each(o,function(e){a.push(f(e,t[n],s))})}else a=f(a,t[n],s);if(s.length>0){var u={};u[n]=[],e(s).each(function(e){r.mergeFields(u[n],e)}),u[n].length>0&&p.push(u)}}d[n]=a}),s.origin&&(n=s.origin.type),{type:o,data:e(d).defaults({id:t,__type:n}),notInitializedFields:p}},mergeFields:function(t,i,n){return e.mergeFields(t,i,n)},destroy:function(){delete this.__data,delete this.__types}})}),define("tau/store/repository",["Underscore","tau/core/class","tau/core/event","tau/core/tau","tau/store/header","tau/core/comparer","tau/store/types","tau/store/db"],function(e,t,i,n,a,r,s,o){var l=t.extend({init:function(e){if(!e.service)throw"rest service should be defined";this.__listenerObjects={objects:[],holders:[]},this.__subscriptions={},this.types=e.types||s.getDictionary(),this._initDb(e),this.service=e.service},_initDb:function(e){e=e||{},this.__allTypeLoadMarkers={},this.db=e.db||new o({types:this.types})},mergeCommands:function(t){var i={},a=this;return e.each(t,function(t){t=e.defaults(t,{name:"get",config:{},callbacks:{}}),t.callbacks=n.getCallbacks(t.callbacks),a._processFieldsConfig(t,"get"===t.name?null:"_getEmptyArray");var r=[t.type,t.config.id||"_",t.name,t.config.nested===!0?e.uniqueId():""].join("_");
if(i.hasOwnProperty(r)){var s=i[r];a.db.mergeFields(s.config.fields,t.config.fields),s.commands.push(t)}else i[r]=t,t.commands=[]}),i},execute:function(t){var i=this;e.isArray(t)||(t=[t]);var n=i.mergeCommands(t);e.each(n,function(e){if(e.executed===!0)throw"command is already executed. the same command can not be used twice";e.failed===!0?i._invokeCommandCallback("failure",e.callbacks,e,e.error):i["api "+e.name](e)})},_registerListener:function(t,i,a){var r=t||{},s=i.eventName;r.hasOwnProperty(s)||(r[s]={});var o=e.uniqueId(s),l={id:o,config:i,callback:n.createScopedCallbackIfRequired(a)},u=r[s],c=i.listener;if(c){if(!c.__getRepositorySubscriberId){var d=e.uniqueId("repository_");c.__getRepositorySubscriberId=function(){return d},this.__listenerObjects[d]={listener:c,holders:[]}}var p={id:o,holder:u};this.__listenerObjects[c.__getRepositorySubscriberId()].holders.push(p)}return u[o]=l,l},unbind:function(t){if(t.__getRepositorySubscriberId){var i=this,n=t.__getRepositorySubscriberId(),a=i.__listenerObjects[n];if(a){var r=a.holders;r&&(e(r).each(function(e){var t=e.holder[e.id];t.callback=function(){},delete e.holder[e.id]}),delete t.__getRepositorySubscriberId,delete i.__listenerObjects[n])}}},_getListeners:function(t){var i=this,n=i._getSubscriptions(t.type);if(!n)return[];var a=n[t.eventName];if(!a)return[];var s=[];return e.each(e(a).values(),function(n){var a=n.config.filter,o=n.config.hasChanges||[];if(a){var l=i.db.getPersistedNode(t.obj.id,t.obj.type),u=t.obj;l&&l.data?u=l.data:t.nodeEvent.changes&&!e.isEmpty(t.nodeEvent.changes)&&(u=t.nodeEvent.changes);var c=r.compare(u,a);if(e(c.changes).keys().length>0)return}if(t.nodeEvent&&o.length>0){var d=t.nodeEvent.changes||{},p=e(o).all(function(t){var i=t.split("|"),n=!1;return n=i.length>1?0<e(d).chain().keys().intersection(i).size().value():d.hasOwnProperty(t)});if(!p)return}s.push(n)}),s},on:function(t,i){var n="_all_";t.type&&(n=e.has(this.types,t.type)?this.types[t.type].name:t.type);var a=this._getSubscriptions(n);
return this._registerListener(a,t,i)},invokeFailCallback:function(e){this._invokeCommandCallback("failure",e.callbacks,e,e.error)},_getSubscriptions:function(e){return this.__subscriptions.hasOwnProperty(e)||(this.__subscriptions[e]={}),this.__subscriptions[e]},_autoAppend:function(t,i,n){e.each(i,function(i){e.any(t,function(e){return a.header.getFieldName(e)===a.header.getFieldName(i)})||t[n?n:"unshift"](i)})},registerData:function(e,t){return this.db.register(e,null,t)},_getEmptyArray:function(){return[]},_getDefaultFields:function(t){var i=this.types[t.type];return e.clone(i?i.fields||[]:[])},_processFieldsConfig:function(t,i){var n=this;i=i||"_getDefaultFields",t.config.fields&&0!==t.config.fields.length||(t.config.fields=n[i](t));var a=t.config.fields;n._autoAppend(a,["id"]);for(var r=a.length;r>0;r--){var s=a[r-1];if(!e.isSimple(s)){var o=e.getFieldName(s),l=t.type?n.types[t.type]:null,u=null,c=[];if(l&&l.refs&&l.refs[o]){var d=l.refs[o];d.list===!0&&(s.list=!0),c=d.fields,u=d.name}var p={type:u,config:{fields:s[o]||c}};s[o]=n._processFieldsConfig(p,i)}}var f=a.length;for(r=0;f>r;r++)for(var m=e.getFieldName(a[r]),h=r+1;f>h;h++)e.getFieldName(a[h])===m&&(e.isSimple(a[r])||e.mergeFields(a[r][m],a[h][m]),a.splice(h,1),f--,h--);return a},_invokeCommandCallback:function(t,i,n,a){var r=this;if(r._invokeCommandCallbackR(t,i,n,a),n.config.silent!==!0&&r.__subscriptions._all_&&!e.isEmpty(r.__subscriptions._all_)){var s=e.values(r.__subscriptions._all_[t]||[]),o={name:t,data:{cmd:n,data:a}};e(s).each(function(e){e.callback(o)})}},_invokeCommandCallbackR:function(t,i,n,a){var r=this;n.executed=!0,i[t]({command:n,data:a}),n.hasOwnProperty("commands")&&e.each(n.commands,function(e){e.executed=!0,e.failed=n.failed,r._invokeCommandCallbackR(t,e.callbacks,e,a)})},"api removeFromList":function(e){var t=this,i=e.callbacks;e.config.$set=e.config.$set||{},e.callbacks={success:function(){var n=t.db.removeFromList(e.config.id,e.type,e.config.$set);t._invokeCommandCallback("success",i,e,{}),t._notifyAboutNewsAndChanges(n,e)
},failure:function(n){e.failed=!0,t._invokeCommandCallback("failure",i,e,n)}},t._populateBeforeSaveEvent(e),t._processFieldsConfig(e,"_getEmptyArray"),t.service.removeFromList(e)},"api remove":function(e){var t=this,i=e.callbacks;e.callbacks={success:function(){var n=t.evictPersistedObject(e.config.id,e.type);t._populateAfterRemoveEvent(e,n),t._invokeCommandCallback("success",i,e,e.callbacks)},failure:function(n){e.failed=!0,t._invokeCommandCallback("failure",i,e,n)}},t._populateBeforeRemoveEvent(e),t.service.remove(e)},evictPersistedObject:function(e,t){return this.db.remove(e,this.types[t].name)},evictProperties:function(e,t,i){this.db.removeProperties(e,this.types[t].name,i)},evictData:function(){this._initDb()},evictCollection:function(e){this.db.removeCollection(e),this.unmarkRecordSetAsCompleteLoaded(e)},isPropertyInitialized:function(e,t,i){return this.db.isPropertyInitialized(e,t,i)},getProperties:function(t){var i=this.db.__types[t];return i.simpleFields.concat(e.keys(i.refs))},"api save":function(t){var i=this,n=t.callbacks;t.config.$set=t.config.$set||{},t.callbacks={success:function(a){a.__type=t.type;var r={};if(e.isArray(t.config.$set)){r=[];for(var s=0;s<t.config.$set.length;s++){var o=e.extend(e.extend({__type:t.type},t.config.$set[s]),a[s]);r.push(o)}}else r=e.extend(e.extend({},t.config.$set),a);var l=i.db.register(r);i._notifyAboutNewsAndChanges(l,t),i._invokeCommandCallback("success",n,t,r)},failure:function(e){t.failed=!0,i._invokeCommandCallback("failure",n,t,e)}},i._populateBeforeSaveEvent(t),i._processFieldsConfig(t,"_getEmptyArray"),i.service.save(t)},_notifyAboutNewsAndChanges:function(t,i){var n=this;e.each(t.tree,function(t,a){e.each(t,function(e){n._populateEvent(i,"afterSave",e,{id:e.id,type:a})})})},_populateEvent:function(t,i,n,a){var r=this._getListeners({type:a.type,eventName:i,nodeEvent:n,obj:a});if(0!==r.length){var s=e.uniqueId("repositoryEvent"),o={id:s,name:i,data:{id:a.id,type:a.type,cmd:t,obj:a,changes:n.changes}};e.each(r,function(e){e.callback(o)
})}},_populateBeforeRemoveEvent:function(e){this._populateEvent(e,"beforeRemove",{},{id:e.config.id,type:e.type})},_populateAfterRemoveEvent:function(t,i){e.each(i.deletedData,function(e){this._populateEvent(t,"afterRemove",{},e)},this),this._notifyAboutNewsAndChanges(i,t)},_populateBeforeSaveEvent:function(e){this._populateEvent(e,"beforeSave",{changes:e.config.$set||{}},{id:e.config.id,type:e.type})},markRecordSetAsCompleteLoaded:function(e){this.__allTypeLoadMarkers[e]=!0},unmarkRecordSetAsCompleteLoaded:function(e){this.__allTypeLoadMarkers[e]=!1},isTypeMarkedAsCompleteLoaded:function(e){return this.__allTypeLoadMarkers[e]===!0},_appendDiscriminator:function(t,i){var n=this;if(!t)throw new Error("Table name is not defined");t.isParentType&&e.indexOf(i,"id")>=0&&n._autoAppend(i,[t.discriminator],"push"),e.each(i,function(e){if(!a.header.isSimple(e)){var i=a.header.getFieldName(e),r=t.refs[i];r&&n._appendDiscriminator(n.types[r.name],e[i])}})},_runReadCommand:function(t,i,n,a){var r=this;try{r._appendDiscriminator(r.types[t.type],n)}catch(s){return t.failed=!0,void t.callbacks.failure(null,s)}t.config.fields=n,r._processFieldsConfig(t);var o=t.callbacks;t.callbacks={success:function(n){t.config.fields=i,e.defaults(n,{__type:t.type});var s=a(n,r.db.register(n));r._invokeCommandCallback("success",o,t,s),t.callbacks=o},failure:function(e){t.config.fields=i,t.failed=!0,r._invokeCommandCallback("failure",o,t,e),t.callbacks=o}},this.service[t.name](t)},"api refresh":function(t){var i=this,n=t.config.fields,a=function(e,a){return i._notifyAboutNewsAndChanges(a,t),i.db.get(t.config.id,t.type,{fields:n}).data};this._runReadCommand(t,n,e.clone(n),a)},"api turboGet":function(t){var i=this,n=t.config.fields||[];i._autoAppend(n,["id"]);var a=t.callbacks;t.callbacks={success:function(n){e.defaults(n,{__type:t.type}),i._invokeCommandCallback("success",a,t,n),t.callbacks=a},failure:function(e){t.failed=!0,i._invokeCommandCallback("failure",a,t,e),t.callbacks=a}},this.service[t.name](t)
},"api find":function(t){var i=this,n=t.config.fields,a=function(a){var r=[];if(e.each(a,function(e){r.push(i.db.get(e.id,t.type,{fields:n}).data)}),a.hasOwnProperty("getNextPage")){r.isNextPageAvailable=function(){return!0};var s=e.clone(t);s.config=e.clone(s.config),s.config.$skip+=s.config.$limit,r.getNextPageCommand=function(){return s}}else r.isNextPageAvailable=function(){return!1};return r};this._runReadCommand(t,n,e.clone(n),a)},_getFromCache:function(e){var t=this.db.get(e.config.id,e.type,e.config);if(0===t.notInitializedFields.length){var i=!t.all;if(i||this.isTypeMarkedAsCompleteLoaded(e.type))return t}return null},"api get":function(t){var i=this._getFromCache(t);if(i)this._invokeCommandCallback("success",t.callbacks,t,i.data);else{var n=t.config.fields,a=function(){return t.config.id||this.markRecordSetAsCompleteLoaded(t.type),this.db.get(t.config.id,t.type,{fields:n}).data}.bind(this);this._runReadCommand(t,n,e.clone(n),a)}}});return l}),define("tau/store/services/formatProperties",[],function(){return{customFields:{}}}),define("tau/store/services/service.arrayToJsonConverter",["Underscore","tau/store/header","tau/store/services/formatProperties"],function(e,t,i){return{convertArray:function(i,n){var a=this,r=[],s=[];return n.next&&s.push(t.getNextPage(r,n.next,i.header)),n=n.items?n.items:n,e.each(n,function(e){var t=a.convert(i,e);r.push(t.data),s=s.concat(t.nextPages)}),{data:r,nextPages:s}},convert:function(n,a){for(var r={},s=this,o=[],l=0,u=n.header.length;u>l;l++){var c=a[l];e.isUndefined(c)&&(c=null);var d=n.header[l];if(t.header.isSimple(d))i.hasOwnProperty(d)&&(c=t.formatObject(c).data),r[d]=c;else{var p=t.header.getFieldName(d),f=d.list===!0;if(e.isNull(c)||!c.hasOwnProperty("items")&&!c.hasOwnProperty("Items")||(f=!0),!e.isEmpty(c)||f){if(!e.isNull(c)){var m={header:d[p]},h=c;if((c.hasOwnProperty("items")||c.hasOwnProperty("Items"))&&(c=c.items||c.Items),f){var g=[];e.each(c,function(e){var t=s.convert(m,e);o=o.concat(t.nextPages),g.push(t.data)
}),c=g,h.next&&o.push(t.getNextPage(g,h.next,m.header))}else{var v=s.convert(m,c);o=o.concat(v.nextPages),c=v.data}}e.isNull(c)&&f&&(c=[]),r.hasOwnProperty(p)?e.extend(r[p],c):r[p]=c}else r[p]=null}}return{data:r,nextPages:o}}}});var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,r,s,o=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)s[i]=str(i,l)||"null";return a=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,a}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;r>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],a=str(n,l),a&&s.push(quote(n)+(gap?": ":":")+a));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a=str(n,l),a&&s.push(quote(n)+(gap?": ":":")+a));return a=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;
"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n=walk(a,i),void 0!==n?a[i]=n:delete a[i]);return reviver.call(e,t,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("libs/json2",function(){}),define("tau/store/services/service.rest",["Underscore","jQuery","tau/core/class","tau/store/types","tau/store/services/service.arrayToJsonConverter","tau/store/header","tau/core/tau","libs/json2"],function(e,t,i,n,a,r,s){var o=i.extend({init:function(i){i=i||{},e.defaults(i,{api:t,types:n.getDictionary()}),this.config=i},removeFromList:function(e){var t=this,i=r.header.getFieldName(e.config.$set),n={url:t.getUrl(e)+"/"+i+"/"+e.config.$set[i].id,contentType:"application/json; charset=utf-8",type:"POST",processData:!1,dataType:"json",beforeSend:function(e){e.setRequestHeader("X-HTTP-Method-Override","DELETE")}},a=this.getErrorCallback(e);t.config.api.ajax(n).success(function(){e.callbacks.success({id:e.config.id})}).error(a)},remove:function(e){var t=this,i={Id:e.config.id},n={url:t.getUrl(e),contentType:"application/json; charset=utf-8",type:"POST",processData:!1,dataType:"json",data:JSON.stringify(i),beforeSend:function(e){e.setRequestHeader("X-HTTP-Method-Override","DELETE")
}},a=this.getErrorCallback(e);t.config.api.ajax(n).success(function(){e.callbacks.success({id:e.config.id})}).error(a)},save:function(t){var i={$set:t.config.$set||{}};return"prioritizer"===t.type?(e.extend(i,{$include:this._formIncludes(t.config.fields)}),void this.executeCrudCommandViaPageService(t,i,"save")):void this.executeCrudCommand(t,i,"save")},getErrorCallback:function(e){var i=this.config.appPath;return function(n){if(401===n.status)return void(document.location.href=i+"/login.aspx?ReturnUrl="+document.location.href);try{n.response=t.parseJSON(n.responseText||null)}catch(a){}finally{e.callbacks.failure(n)}}},executeCrudCommandViaPageService:function(i,n,a){var s=this,o={id:i.config.id,type:i.type};e.extend(o,n);var l=JSON.stringify({json:JSON.stringify(o)}),u={url:[s.config.appPath,"PageServices/RESTCrud.asmx",a].join("/"),contentType:"application/json; charset=utf-8",type:"POST",data:l,dataType:"json"},c=this.getErrorCallback(i);s.config.api.ajax(u).success(function(n){var a={id:n.d.id};if(n.d.isError===!0)return void i.callbacks.failure({Message:n.d.errorMessage,CRUD:!0});if(n.d.jsonToReturn&&n.d.jsonToReturn.length>0){var s=t.parseJSON(n.d.jsonToReturn);s=r.formatObject(s),e.extend(a,s.data)}i.callbacks.success(a)}).error(c)},executeCrudCommand:function(t,i){var n=this;e.defaults(t.config,{format:"json"});var a=i.$set,r={id:t.config.id};e.isArray(a)?r=a:e.extend(r,a);var s=n.getUrl(t,"resultInclude"),o=t.config.format,l=n._getFields(t),u=n._getApiConfig(s,o,"convert",l);e.extend(u,{url:s,contentType:"application/json; charset=utf-8",type:"POST",processData:!1,data:JSON.stringify(r),dataType:"json"}),n._executeApiCall(t,"json",u)},find:function(e){this.get(e)},refresh:function(e){this.get(e)},getCompleteCallback:function(e){var t=this;return function(i){if("implementationHistory"===e.type&&(i.id=e.config.hasOwnProperty("acid")?e.config.acid:e.config.hasOwnProperty("ids")?i.acid:e.config.id),"context"===e.type&&(i.id=e.config.hasOwnProperty("id")?e.config.id:i.acid),e.config.nested===!0){var n=t._getNestedObject(e),a=r.header.getFieldName(n),s={id:e.config.id};
s[a]=i,i=s}e.callbacks.success(i)}},_getArrayConverter:function(e,t){var i=this;return function(n){var r=i.config.api.parseJSON(n);return a[e]({header:t},r)}},_getJsonConverter:function(){var e=this;return function(t){var i=e.config.api.parseJSON(t);return r.formatObject(i)}},_getApiConfig:function(e,t,i,n){var a=this;return{url:e,accepts:{array:"application/x-array"},dataType:t,converters:{"text array":a._getArrayConverter(i,n),"text json":a._getJsonConverter()}}},_getNextPageFields:function(e){var t=e.fields,i=s.getQueryValueFromUrl(e.url,"include");return i&&i.length>0&&(t=r.parseFieldsFromString(i)),t},_executeApiCall:function(t,i,n){var a=this,r=a.getErrorCallback(t),s=a.getCompleteCallback(t),o=null,l=[],u=function(){var e=0===l.length;return e&&s(o),e},c=function(e){for(var t=0,i=e.nextPages.length;i>t;t++){var n=e.nextPages[t];d(n)}},d=function(t){var n=a._getNextPageFields(t),s=a._getApiConfig(t.url,i,"convertArray",n);a.config.api.ajax(s).success(function(i){l=l.concat(i.nextPages||[]);var n=t.holder;e.each(i.data,function(e){n.push(e)}),i.data.getNextPage&&(i.data.getNextPage().holder=t.holder),c(i);var a=e.indexOf(l,t);l.splice(a,1),u()}).error(r)},p=function(e){return o=e.data,"find"===t.name?void s(o):(l=l.concat(e.nextPages||[]),u(),void c(e))};a.config.api.ajax(n).success(p).error(r)},get:function(t){var i=this;e.defaults(t.config,{format:"array"});var n=t.config.nested!==!0&&t.config.id?"convert":"convertArray",a=i.getUrl(t),r=t.config.format,s=i._getFields(t),o=i._getApiConfig(a,r,n,s);i._executeApiCall(t,r,o)},turboGet:function(e){this.get(e)},_formIncludes:function(t){var i=[],n=this;return e.each(t,function(e){if(r.header.isSimple(e)){var t=e;return 0===e.indexOf("$ref")&&(t=e.replace("$ref:","")),void i.push(t)}var a=r.header.getFieldName(e);i.push(a+n._formIncludes(e[a]))}),["[",i.join(","),"]"].join("")},_getQueryOperators:function(){var t=function(t,i){var n=this,a=[];return e.isArray(i)||(i=[i]),e.each(i,function(e){a.push("("+t+" "+n.name+" "+JSON.stringify(e)+")")
}),a},i=function(e){return["("+e+" "+this.name+")"]},n=function(t,i){var n=this,a=[];e.isArray(i)||(i=[i]);var r=[];return e(i).each(function(e){r.push(JSON.stringify(e))}),a.push("("+t+" "+n.name+" ("+r.join(",")+"))"),a};return{$in:{name:"in",render:n},$ne:{name:"ne",render:t},$gt:{name:"gt",render:t},$gte:{name:"gte",render:t},$lt:{name:"lt",render:t},$lte:{name:"lte",render:t},$contains:{name:"contains",render:t},$eq:{name:"eq",render:t},$isNull:{name:"is null",render:i},$isNotNull:{name:"is not null",render:i}}},_isQueryValueWithOperator:function(t,i){var n=e(t).keys();if(0===n.length)return!1;var a=i||this._getQueryOperators();return a.hasOwnProperty(n[0])},_formWhere:function(t,i){var n=[],a=this;i=i||"";var r=a._getQueryOperators();return e.each(e(t).keys(),function(s){var o=t[s],l=i+s;if(e.isString(o)||e.isNumber(o)||e.isDate(o)||e.isArray(o)||e.isBoolean(o)||e.isNull(o)){var u=null===o?"$isNull":"$eq";return void(n=n.concat(r[u].render(l,o)))}return a._isQueryValueWithOperator(o,r)?void e.each(e(o).keys(),function(e){n=n.concat(r[e].render(l,o[e]))}):void n.push(a._formWhere(o,l+"."))}),n},_getWhere:function(t){var i=this._formWhere(t);return 0===i.length?"":"&where="+encodeURIComponent(e.flatten(i).join(" and "))},_getNestedObject:function(t){var i=null;return e.each(t.config.fields,function(e){r.header.isSimple(e)||(i=e)}),i},_getFields:function(e){if(e.config.nested!==!0)return e.config.fields;var t=this._getNestedObject(e),i=r.header.getFieldName(t);return t[i]},_getOrderBy:function(e){return e.config.$orderBy&&""!==e.config.$orderBy?"&orderBy="+e.config.$orderBy:""},_getOrderByDesc:function(e){return e.config.$orderByDesc&&""!==e.config.$orderByDesc?"&orderByDesc="+e.config.$orderByDesc:""},_encodeRestParams:function(i){return e.isObject(i)&&(i=e.map(i,function(t,i){return{name:i,value:e.isArray(t)?t.join(","):t}})),decodeURIComponent(t.param(i))},getUrl:function(t,i){var n=this,a={$skip:0,$limit:999,$query:{}},o=t.config;if(e.defaults(o,a),"context"===t.type){if(o.format="json",o.hasOwnProperty("acid"))return[n.config.path,"context.asmx","?acid="+o.acid].join("/");
var l={};return l.ids=o.id||o.ids,l.ids||(l.projectIds=o.projectIds||o.projectId||"*",l.teamIds=o.teamIds||o.teamId||"*"),e.each(l,function(e,t){e||delete l[t]}),[n.config.path,"context.asmx?"+n._encodeRestParams(l)].join("/")}if("implementationHistory"===t.type)return o.format="json",[n.config.appPath,"TpReports/ImplementationHistory.ashx?id="+o.id+"&"+(new Date).valueOf()].join("/");var u=n.config.types[t.type]||{resource:t.type},c=o.fields,d=[n.config.path,u.resource+".asmx",o.id].join("/");if(o.nested===!0){var p=n._getNestedObject(t),f=r.header.getFieldName(p);c=p[f],d=[d,f].join("/")}if(t.name&&t.name.indexOf("remove")>=0)return d;e.isArray(o.$set)&&(d+="bulk");var m="find"===t.name||"turboGet"===t.name||!e.isEmpty(o.$query);return d=[d,"?skip=",o.$skip,"&take=",o.$limit,"&",i?i:"include","=",n._formIncludes(c),m?n._getWhere(o.$query):"",n._getOrderBy(t),n._getOrderByDesc(t),s.getTokenParameterFromQueryString("&")].join("")}});return o}),define("tau/rules/auto-include-beforeSave",["Underscore"],function(e){return{"auto include beforeSave":function(t,i){for(var n=this,a=t.data.obj,r=0;r<i.fields.length;r++){var s=i.fields[r];(n.store.isPropertyInitialized(a.id,a.type,e.getFieldName(s))||i.force)&&e.mergeFields(t.data.cmd.config.fields,[s])}}}}),define("tau/rules/core",["Underscore","tau/core/class","tau/rules/auto-include-beforeSave"],function(e,t,i){return t.extend({init:function(t){var n=this;n.store=t.store||{},t.rulesImpl=t.rulesImpl||{},e.extend(n,i),e.extend(n,{name:"rules engine"}),e(t.rulesImpl).each(function(t){e.extend(n,t)}),n.register(t.rules||[])},register:function(t){var n=this;e.isArray(t)||(t=[t]),e(t).each(function(t){if(e.defaults(t,{name:e(i).keys()[0],fields:[],changes:[]}),!t.hasOwnProperty("type"))throw"type should be configured for rule";0!==t.fields.length&&e.each(t.changes,function(e){var i=function(e){n[t.name](e,t)},a=t.name.split(" ");n.store.on({eventName:a[a.length-1],type:t.type,listener:n,hasChanges:[e]},i)})})},registerRule:function(t){var i=this;
if(e.defaults(t,{fields:[],changes:[]}),!t.hasOwnProperty("name"))throw'"name" field should be configured for rule';if(!t.hasOwnProperty("type"))throw'"type" field should be configured for rule';if(!i.hasOwnProperty(t.name))throw"unknown rule name ["+t.name+"]";i[t.name].call(i,t)},destroy:function(){var e=this.store;delete this.store,e.unbind(this)}})}),define("tau/rules/rule.auto-include-before-save",["Underscore"],function(e){var t=function(t,i){for(var n=this,a=t.data.obj,r=0;r<i.fields.length;r++){var s=i.fields[r];(a.id&&n.store.isPropertyInitialized(a.id,a.type,e.getFieldName(s))||i.force)&&e.mergeFields(t.data.cmd.config.fields,[s])}};return{"auto-include-before-save":function(i){var n=this;0!==i.fields.length&&e.each(i.changes,function(e){var a=[e],r=function(e){t.call(n,e,i)};n.store.on({eventName:"beforeSave",type:i.type,listener:n,hasChanges:a},r)})}}}),define("tau/rules/rule.auto-action-after-save",["Underscore"],function(){var e=function(e,t){var i=this,n=e.data,a={store:i.store,data:n};t.action(a)};return{"auto-action-after-save":function(t){var i=this,n=function(n){e.call(i,n,t)},a={eventName:"afterSave",type:t.type,listener:i};t.hasOwnProperty("changes")&&t.changes.length&&(a.hasChanges=[t.changes.join("|")]),i.store.on(a,n)}}}),define("tau/rules/rule.auto-include-before-remove",["Underscore"],function(e){var t=function(t,i){for(var n=(t.data.obj,0);n<i.fields.length;n++){var a=i.fields[n];e.mergeFields(t.data.cmd.config.fields,[a])}};return{"auto-include-before-remove":function(e){var i=this;if(0!==e.fields.length){var n=function(n){t.call(i,n,e)};i.store.on({eventName:"beforeRemove",type:e.type,listener:i},n)}}}}),define("tau/store/types.targetprocess.generated",[],function(){return[{name:"context"},{name:"process",parent:null,resource:"processes",aliases:["Process","processes","Processes"],fields:["id","name"],simpleFields:["id","name","isDefault","description","entityStates-count","projects-count","practices-count","customFields-count","processAdmins-count","terms-count"],refs:{entityStates:{list:!0,name:"entityState",multiplicity:"one",relationProperty:"process"},projects:{list:!0,name:"project",multiplicity:"one",relationProperty:"process"},practices:{list:!0,name:"practice",multiplicity:"",relationProperty:""},customFields:{list:!0,name:"customField",multiplicity:"one",relationProperty:"process"},processAdmins:{list:!0,name:"user",multiplicity:"",relationProperty:""},terms:{list:!0,name:"term",multiplicity:"one",relationProperty:"terms"}}},{name:"tag",parent:null,resource:"tags",aliases:["Tag","tags","Tags"],fields:["id","name"],simpleFields:["id","name","generals-count"],refs:{generals:{list:!0,name:"general",multiplicity:"",relationProperty:""}}},{name:"milestone",parent:null,resource:"milestones",aliases:["Milestone","milestones","Milestones"],fields:["id","name"],simpleFields:["id","name","description","date","cssClass","projects-count"],refs:{owner:{name:"user",multiplicity:"",relationProperty:"milestones"},projects:{list:!0,name:"project",multiplicity:"",relationProperty:""}}},{name:"practice",parent:null,resource:"practices",aliases:["Practice","practices","Practices"],fields:["id","name","displayName"],simpleFields:["id","name","description","displayName","processes-count"],refs:{processes:{list:!0,name:"process",multiplicity:"",relationProperty:""}}},{name:"entityType",parent:null,resource:"entityTypes",aliases:["EntityType","entityTypes","EntityTypes"],fields:["id","name"],simpleFields:["id","name","isExtendable","isSearchable","isUnitInHourOnly","entityStates-count"],refs:{entityStates:{list:!0,name:"entityState",multiplicity:"one",relationProperty:"entityType"}}},{name:"priority",parent:null,resource:"priorities",aliases:["Priority","priorities","Priorities"],fields:["id","name"],simpleFields:["id","name","importance","isDefault"],refs:{entityType:{name:"entityType",multiplicity:"",relationProperty:"priorities"}}},{name:"severity",parent:null,resource:"severities",aliases:["Severity","severities","Severities"],fields:["id","name"],simpleFields:["id","name","importance","isDefault"],refs:{}},{name:"entityState",parent:null,resource:"entityStates",aliases:["EntityState","entityStates","EntityStates"],fields:["id","name"],simpleFields:["id","name","isInitial","isFinal","isPlanned","isCommentRequired","numericPriority","nextStates-count","previousStates-count"],refs:{role:{name:"role",multiplicity:"",relationProperty:"entityStates"},nextStates:{list:!0,name:"entityState",multiplicity:"",relationProperty:""},previousStates:{list:!0,name:"entityState",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"entityStates"},process:{name:"process",multiplicity:"",relationProperty:"entityStates"}}},{name:"general",parent:null,resource:"generals",aliases:["General","generals","Generals"],fields:["id","name"],simpleFields:["id","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"assignable",parent:"general",resource:"assignables",aliases:["Assignable","assignables","Assignables"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},release:{name:"release",multiplicity:"",relationProperty:"assignables"},iteration:{name:"iteration",multiplicity:"",relationProperty:"assignables"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"generalUser",parent:null,resource:"generalUsers",aliases:["GeneralUser","generalUsers","GeneralUsers"],fields:["id","firstName","lastName"],simpleFields:["id","firstName","lastName","email","login","createDate","modifyDate","deleteDate","isActive","isAdministrator","kind","password","avatarUri","assignables-count","comments-count","requests-count"],refs:{assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"owner"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""}}},{name:"user",parent:"generalUser",resource:"users",aliases:["User","users","Users"],fields:["id","activeDirectoryName","firstName","lastName"],simpleFields:["id","lastLoginDate","weeklyAvailableHours","currentAllocation","currentAvailableHours","availableFrom","availableFutureAllocation","availableFutureHours","isObserver","skills","activeDirectoryName","firstName","lastName","email","login","createDate","modifyDate","deleteDate","isActive","isAdministrator","kind","password","avatarUri","times-count","impediments-count","customActivities-count","revisions-count","teamMembers-count","projectMembers-count","milestones-count","adminProcesses-count","following-count","assignables-count","comments-count","requests-count"],refs:{role:{name:"role",multiplicity:"",relationProperty:""},times:{list:!0,name:"time",multiplicity:"one",relationProperty:"user"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"responsible"},customActivities:{list:!0,name:"customActivity",multiplicity:"one",relationProperty:"user"},revisions:{list:!0,name:"revision",multiplicity:"one",relationProperty:"author"},teamMembers:{list:!0,name:"teamMember",multiplicity:"one",relationProperty:"user"},projectMembers:{list:!0,name:"projectMember",multiplicity:"one",relationProperty:"user"},milestones:{list:!0,name:"milestone",multiplicity:"one",relationProperty:"owner"},adminProcesses:{list:!0,name:"process",multiplicity:"",relationProperty:""},following:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"user"},assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"owner"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""}}},{name:"requester",parent:"generalUser",resource:"requesters",aliases:["Requester","requesters","Requesters"],fields:["id","firstName","lastName"],simpleFields:["id","phone","notes","sourceType","firstName","lastName","email","login","createDate","modifyDate","deleteDate","isActive","isAdministrator","kind","password","avatarUri","assignables-count","comments-count","requests-count"],refs:{company:{name:"company",multiplicity:"",relationProperty:""},assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"owner"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""}}},{name:"project",parent:"general",resource:"projects",aliases:["Project","projects","Projects"],fields:["id","name"],simpleFields:["id","isActive","isProduct","abbreviation","mailReplyAddress","color","progress","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","generals-count","features-count","epics-count","releases-count","crossProjectReleases-count","iterations-count","userStories-count","tasks-count","bugs-count","testCases-count","testPlans-count","builds-count","times-count","revisions-count","customActivities-count","projectMembers-count","teamProjects-count","requests-count","testPlanRuns-count","milestones-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{generals:{list:!0,name:"general",multiplicity:"one",relationProperty:"project"},program:{name:"program",multiplicity:"",relationProperty:"projects"},process:{name:"process",multiplicity:"",relationProperty:"projects"},features:{list:!0,name:"feature",multiplicity:"one",relationProperty:"project"},epics:{list:!0,name:"epic",multiplicity:"one",relationProperty:"project"},releases:{list:!0,name:"release",multiplicity:"one",relationProperty:"project"},crossProjectReleases:{list:!0,name:"release",multiplicity:"",relationProperty:""},iterations:{list:!0,name:"iteration",multiplicity:"one",relationProperty:"project"},userStories:{list:!0,name:"userStory",multiplicity:"one",relationProperty:"project"},tasks:{list:!0,name:"task",multiplicity:"one",relationProperty:"project"},bugs:{list:!0,name:"bug",multiplicity:"one",relationProperty:"project"},testCases:{list:!0,name:"testCase",multiplicity:"one",relationProperty:"project"},testPlans:{list:!0,name:"testPlan",multiplicity:"one",relationProperty:"project"},builds:{list:!0,name:"build",multiplicity:"one",relationProperty:"project"},times:{list:!0,name:"time",multiplicity:"one",relationProperty:"project"},revisions:{list:!0,name:"revision",multiplicity:"one",relationProperty:"project"},customActivities:{list:!0,name:"customActivity",multiplicity:"one",relationProperty:"project"},company:{name:"company",multiplicity:"",relationProperty:"projects"},projectMembers:{list:!0,name:"projectMember",multiplicity:"one",relationProperty:"project"},teamProjects:{list:!0,name:"teamProject",multiplicity:"one",relationProperty:"project"},requests:{list:!0,name:"request",multiplicity:"one",relationProperty:"project"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"one",relationProperty:"project"},milestones:{list:!0,name:"milestone",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"program",parent:"general",resource:"programs",aliases:["Program","programs","Programs"],fields:["id","name"],simpleFields:["id","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","projects-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{projects:{list:!0,name:"project",multiplicity:"zeroOrOne",relationProperty:"program"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"release",parent:"general",resource:"releases",aliases:["Release","releases","Releases"],fields:["id","name"],simpleFields:["id","isCurrent","progress","units","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","iterations-count","assignables-count","features-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","requests-count","builds-count","testPlans-count","projects-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"releases"},iterations:{list:!0,name:"iteration",multiplicity:"one",relationProperty:"release"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"release"},features:{list:!0,name:"feature",multiplicity:"zeroOrOne",relationProperty:"release"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"release"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"release"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"release"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"release"},requests:{list:!0,name:"request",multiplicity:"zeroOrOne",relationProperty:"release"},builds:{list:!0,name:"build",multiplicity:"one",relationProperty:"release"},testPlans:{list:!0,name:"testPlan",multiplicity:"zeroOrOne",relationProperty:"release"},projects:{list:!0,name:"project",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"iteration",parent:"general",resource:"iterations",aliases:["Iteration","iterations","Iterations"],fields:["id","name"],simpleFields:["id","isCurrent","velocity","duration","progress","canBeFinished","units","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","assignables-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","requests-count","builds-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"iterations"},release:{name:"release",multiplicity:"",relationProperty:"iterations"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"iteration"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"iteration"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"iteration"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"iteration"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"iteration"},requests:{list:!0,name:"request",multiplicity:"zeroOrOne",relationProperty:"iteration"},builds:{list:!0,name:"build",multiplicity:"zeroOrOne",relationProperty:"iteration"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"teamIteration",parent:"general",resource:"teamIterations",aliases:["TeamIteration","teamIterations","TeamIterations"],fields:["id","name"],simpleFields:["id","isCurrent","velocity","duration","progress","forecastEndDate","canBeFinished","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","assignables-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","testPlans-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{team:{name:"team",multiplicity:"",relationProperty:"teamIterations"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},testPlans:{list:!0,name:"testPlan",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"team",parent:"general",resource:"teams",aliases:["Team","teams","Teams"],fields:["id","name"],simpleFields:["id","icon","isActive","abbreviation","iconUri","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","teamMembers-count","teamProjects-count","assignables-count","userStories-count","tasks-count","bugs-count","requests-count","features-count","epics-count","teamIterations-count","testPlans-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{teamMembers:{list:!0,name:"teamMember",multiplicity:"one",relationProperty:"team"},teamProjects:{list:!0,name:"teamProject",multiplicity:"one",relationProperty:"team"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"team"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"team"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"team"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"team"},requests:{list:!0,name:"request",multiplicity:"one",relationProperty:"team"},features:{list:!0,name:"feature",multiplicity:"zeroOrOne",relationProperty:"team"},epics:{list:!0,name:"epic",multiplicity:"zeroOrOne",relationProperty:"team"},teamIterations:{list:!0,name:"teamIteration",multiplicity:"one",relationProperty:"team"},testPlans:{list:!0,name:"testPlan",multiplicity:"zeroOrOne",relationProperty:"team"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"epic",parent:"assignable",resource:"epics",aliases:["Epic","epics","Epics"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","features-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"epics"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},features:{list:!0,name:"feature",multiplicity:"zeroOrOne",relationProperty:"epic"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},release:{name:"release",multiplicity:"",relationProperty:"assignables"},iteration:{name:"iteration",multiplicity:"",relationProperty:"assignables"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"feature",parent:"assignable",resource:"features",aliases:["Feature","features","Features"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","userStories-count","history-count","bugs-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"features"},release:{name:"release",multiplicity:"",relationProperty:"features"},epic:{name:"epic",multiplicity:"",relationProperty:"features"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"feature"},history:{list:!0,name:"featureHistory",multiplicity:"one",relationProperty:"feature"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"feature"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},iteration:{name:"iteration",multiplicity:"",relationProperty:"assignables"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"userStory",parent:"assignable",resource:"userStories",aliases:["UserStory","userStories","UserStories"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","tasks-count","bugs-count","testCases-count","times-count","history-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"userStories"},feature:{name:"feature",multiplicity:"",relationProperty:"userStories"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"userStory"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"userStory"},testCases:{list:!0,name:"testCase",multiplicity:"zeroOrOne",relationProperty:"userStory"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"userStory"},release:{name:"release",multiplicity:"",relationProperty:"userStories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"userStories"},team:{name:"team",multiplicity:"",relationProperty:"userStories"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"userStories"},history:{list:!0,name:"userStoryHistory",multiplicity:"one",relationProperty:"userStory"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"userStoryHistory",parent:null,resource:"userStoryHistories",aliases:["UserStoryHistory","userStoryHistories","UserStoryHistories"],fields:["id"],simpleFields:["id","date","effort","effortCompleted","effortToDo"],refs:{entityState:{name:"entityState",multiplicity:"",relationProperty:"userStoryHistories"},modifier:{name:"generalUser",multiplicity:"",relationProperty:"userStoryHistories"},userStory:{name:"userStory",multiplicity:"",relationProperty:"history"},release:{name:"release",multiplicity:"",relationProperty:"userStoryHistories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"userStoryHistories"}}},{name:"bugHistory",parent:null,resource:"bugHistories",aliases:["BugHistory","bugHistories","BugHistories"],fields:["id"],simpleFields:["id","date","effort","effortCompleted","effortToDo"],refs:{entityState:{name:"entityState",multiplicity:"",relationProperty:"bugHistories"},modifier:{name:"generalUser",multiplicity:"",relationProperty:"bugHistories"},bug:{name:"bug",multiplicity:"",relationProperty:"history"},release:{name:"release",multiplicity:"",relationProperty:"bugHistories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"bugHistories"}}},{name:"featureHistory",parent:null,resource:"featureHistories",aliases:["FeatureHistory","featureHistories","FeatureHistories"],fields:["id"],simpleFields:["id","date","effort","effortCompleted","effortToDo"],refs:{entityState:{name:"entityState",multiplicity:"",relationProperty:"featureHistories"},modifier:{name:"generalUser",multiplicity:"",relationProperty:"featureHistories"},feature:{name:"feature",multiplicity:"",relationProperty:"history"},release:{name:"release",multiplicity:"",relationProperty:"featureHistories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"featureHistories"}}},{name:"requestHistory",parent:null,resource:"requestHistories",aliases:["RequestHistory","requestHistories","RequestHistories"],fields:["id"],simpleFields:["id","date","effort","effortCompleted","effortToDo"],refs:{entityState:{name:"entityState",multiplicity:"",relationProperty:"requestHistories"},modifier:{name:"generalUser",multiplicity:"",relationProperty:"requestHistories"},request:{name:"request",multiplicity:"",relationProperty:"history"},release:{name:"release",multiplicity:"",relationProperty:"requestHistories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"requestHistories"}}},{name:"taskHistory",parent:null,resource:"taskHistories",aliases:["TaskHistory","taskHistories","TaskHistories"],fields:["id"],simpleFields:["id","date","effort","effortCompleted","effortToDo"],refs:{entityState:{name:"entityState",multiplicity:"",relationProperty:"taskHistories"},modifier:{name:"generalUser",multiplicity:"",relationProperty:"taskHistories"},task:{name:"task",multiplicity:"",relationProperty:"history"},release:{name:"release",multiplicity:"",relationProperty:"taskHistories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"taskHistories"}}},{name:"impedimentHistory",parent:null,resource:"impedimentHistories",aliases:["ImpedimentHistory","impedimentHistories","ImpedimentHistories"],fields:["id"],simpleFields:["id","date"],refs:{entityState:{name:"entityState",multiplicity:"",relationProperty:"impedimentHistories"},modifier:{name:"generalUser",multiplicity:"",relationProperty:"impedimentHistories"},impediment:{name:"impediment",multiplicity:"",relationProperty:"history"}}},{name:"task",parent:"assignable",resource:"tasks",aliases:["Task","tasks","Tasks"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","times-count","history-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],effortInHours:!0,refs:{project:{name:"project",multiplicity:"",relationProperty:"tasks"},userStory:{name:"userStory",multiplicity:"",relationProperty:"tasks"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"task"},release:{name:"release",multiplicity:"",relationProperty:"tasks"},iteration:{name:"iteration",multiplicity:"",relationProperty:"tasks"},team:{name:"team",multiplicity:"",relationProperty:"tasks"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"tasks"},history:{list:!0,name:"taskHistory",multiplicity:"one",relationProperty:"task"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"bug",parent:"assignable",resource:"bugs",aliases:["Bug","bugs","Bugs"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","times-count","history-count","testCaseRuns-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"bugs"},build:{name:"build",multiplicity:"",relationProperty:"bugs"},userStory:{name:"userStory",multiplicity:"",relationProperty:"bugs"},feature:{name:"feature",multiplicity:"",relationProperty:"bugs"},severity:{name:"severity",multiplicity:"",relationProperty:"bugs"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"bug"},release:{name:"release",multiplicity:"",relationProperty:"bugs"},iteration:{name:"iteration",multiplicity:"",relationProperty:"bugs"},team:{name:"team",multiplicity:"",relationProperty:"bugs"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"bugs"},history:{list:!0,name:"bugHistory",multiplicity:"one",relationProperty:"bug"},testCaseRuns:{list:!0,name:"testCaseRun",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testCase",parent:"general",resource:"testCases",aliases:["TestCase","testCases","TestCases"],fields:["id","name"],simpleFields:["id","steps","success","lastStatus","lastFailureComment","lastRunDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","testPlans-count","testCaseRuns-count","testSteps-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"testCases"},userStory:{name:"userStory",multiplicity:"",relationProperty:"testCases"},priority:{name:"priority",multiplicity:"",relationProperty:"testCases"},testPlans:{list:!0,name:"testPlan",multiplicity:"",relationProperty:""},testCaseRuns:{list:!0,name:"testCaseRun",multiplicity:"one",relationProperty:"testCase"},testSteps:{list:!0,name:"testStep",multiplicity:"one",relationProperty:"testCase"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testCaseRun",parent:null,resource:"testCaseRuns",aliases:["TestCaseRun","testCaseRuns","TestCaseRuns"],fields:["id","name"],simpleFields:["id","executed","passed","comment","runDate","name","description","steps","success","testCases-count","testStepRuns-count","bugs-count"],refs:{testPlanRun:{name:"testPlanRun",multiplicity:"",relationProperty:"testCaseRuns"},testCases:{list:!0,name:"testCase",multiplicity:"",relationProperty:""},testCase:{name:"testCase",multiplicity:"",relationProperty:"testCase"},testStepRuns:{list:!0,name:"testStepRun",multiplicity:"one",relationProperty:"testCaseRun"},bugs:{list:!0,name:"bug",multiplicity:"",relationProperty:""}}},{name:"testPlan",parent:"assignable",resource:"testPlans",aliases:["TestPlan","testPlans","TestPlans"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","testCases-count","testPlanRuns-count","times-count","childTestPlans-count","parentTestPlans-count","testItems-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],effortInHours:!0,refs:{project:{name:"project",multiplicity:"",relationProperty:"testPlans"},release:{name:"release",multiplicity:"",relationProperty:"testPlans"},testCases:{list:!0,name:"testCase",multiplicity:"",relationProperty:""},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"one",relationProperty:"testPlan"},team:{name:"team",multiplicity:"",relationProperty:"testPlans"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"testPlans"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"testPlan"},childTestPlans:{list:!0,name:"testPlan",multiplicity:"",relationProperty:""},parentTestPlans:{list:!0,name:"testPlan",multiplicity:"",relationProperty:""},testItems:{list:!0,name:"testItem",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},iteration:{name:"iteration",multiplicity:"",relationProperty:"assignables"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testPlanRun",parent:"assignable",resource:"testPlanRuns",aliases:["TestPlanRun","testPlanRuns","TestPlanRuns"],fields:["id","name"],simpleFields:["id","passedCount","failedCount","notRunCount","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","testCaseRuns-count","times-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],effortInHours:!0,refs:{release:{name:"release",multiplicity:"",relationProperty:"testPlanRuns"},build:{name:"build",multiplicity:"",relationProperty:"testPlanRuns"},iteration:{name:"iteration",multiplicity:"",relationProperty:"testPlanRuns"},testPlan:{name:"testPlan",multiplicity:"",relationProperty:"testPlanRuns"},project:{name:"project",multiplicity:"",relationProperty:"testPlanRuns"},testCaseRuns:{list:!0,name:"testCaseRun",multiplicity:"one",relationProperty:"testPlanRun"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"testPlanRun"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testStep",parent:null,resource:"testSteps",aliases:["TestStep","testSteps","TestSteps"],fields:["id"],simpleFields:["id","description","result","runOrder"],refs:{testCase:{name:"testCase",multiplicity:"",relationProperty:"testSteps"}}},{name:"testStepRun",parent:null,resource:"testStepRuns",aliases:["TestStepRun","testStepRuns","TestStepRuns"],fields:["id"],simpleFields:["id","passed","runned","runOrder"],refs:{testCaseRun:{name:"testCaseRun",multiplicity:"",relationProperty:"testStepRuns"},testStep:{name:"testStep",multiplicity:"",relationProperty:"testStepRuns"}}},{name:"time",parent:null,resource:"times",aliases:["Time","times","Times"],fields:["id"],simpleFields:["id","description","spent","remain","isEstimation","date","createDate"],refs:{project:{name:"project",multiplicity:"",relationProperty:"times"},userStory:{name:"userStory",multiplicity:"",relationProperty:"times"},task:{name:"task",multiplicity:"",relationProperty:"times"},bug:{name:"bug",multiplicity:"",relationProperty:"times"},request:{name:"request",multiplicity:"",relationProperty:"times"},testPlan:{name:"testPlan",multiplicity:"",relationProperty:"times"},testPlanRun:{name:"testPlanRun",multiplicity:"",relationProperty:"times"},user:{name:"user",multiplicity:"",relationProperty:"times"},assignable:{name:"assignable",multiplicity:"",relationProperty:"times"},role:{name:"role",multiplicity:"",relationProperty:"times"},customActivity:{name:"customActivity",multiplicity:"",relationProperty:"times"}}},{name:"revision",parent:null,resource:"revisions",aliases:["Revision","revisions","Revisions"],fields:["id"],simpleFields:["id","sourceControlId","description","commitDate","revisionFiles-count","assignables-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"revisions"},revisionFiles:{list:!0,name:"revisionFile",multiplicity:"one",relationProperty:"revision"},author:{name:"user",multiplicity:"",relationProperty:"revisions"},assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""}}},{name:"revisionFile",parent:null,resource:"revisionFiles",aliases:["RevisionFile","revisionFiles","RevisionFiles"],fields:["id","fileName"],simpleFields:["id","fileName","fileAction"],refs:{revision:{name:"revision",multiplicity:"",relationProperty:"revisionFiles"}}},{name:"customActivity",parent:null,resource:"customActivities",aliases:["CustomActivity","customActivities","CustomActivities"],fields:["id","name"],simpleFields:["id","name","created","estimate","times-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"customActivities"},user:{name:"user",multiplicity:"",relationProperty:"customActivities"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"customActivity"}}},{name:"request",parent:"assignable",resource:"requests",aliases:["Request","requests","Requests"],fields:["id","name"],simpleFields:["id","sourceType","isReplied","isPrivate","effort","effortCompleted","effortToDo","progress","timeSpent","timeRemain","plannedStartDate","plannedEndDate","units","leadTime","cycleTime","forecastEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","requesters-count","times-count","history-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],effortInHours:!0,refs:{project:{name:"project",multiplicity:"",relationProperty:"requests"},team:{name:"team",multiplicity:"",relationProperty:"requests"},release:{name:"release",multiplicity:"",relationProperty:"requests"},iteration:{name:"iteration",multiplicity:"",relationProperty:"requests"},requestType:{name:"requestType",multiplicity:"",relationProperty:"requests"},requesters:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"request"},history:{list:!0,name:"requestHistory",multiplicity:"one",relationProperty:"request"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"requestType",parent:null,resource:"requestTypes",aliases:["RequestType","requestTypes","RequestTypes"],fields:["id","name"],simpleFields:["id","name","requests-count"],refs:{requests:{list:!0,name:"request",multiplicity:"one",relationProperty:"requestType"}}},{name:"build",parent:"general",resource:"builds",aliases:["Build","builds","Builds"],fields:["id","name"],simpleFields:["id","buildDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","bugs-count","testPlanRuns-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"builds"},release:{name:"release",multiplicity:"",relationProperty:"builds"},iteration:{name:"iteration",multiplicity:"",relationProperty:"builds"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"build"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"build"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"comment",parent:null,resource:"comments",aliases:["Comment","comments","Comments"],fields:["id"],simpleFields:["id","description","parentId","createDate"],refs:{general:{name:"general",multiplicity:"",relationProperty:"comments"},owner:{name:"generalUser",multiplicity:"",relationProperty:"comments"}}},{name:"assignment",parent:null,resource:"assignments",aliases:["Assignment","assignments","Assignments"],fields:["id"],simpleFields:["id"],refs:{assignable:{name:"assignable",multiplicity:"",relationProperty:"assignments"},generalUser:{name:"user",multiplicity:"",relationProperty:"assignments"},role:{name:"role",multiplicity:"",relationProperty:"assignments"}}},{name:"role",parent:null,resource:"roles",aliases:["Role","roles","Roles"],fields:["id","name"],simpleFields:["id","name","hasEffort","canChangeOwner","roleEfforts-count","entityStates-count"],refs:{roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"role"},entityStates:{list:!0,name:"entityState",multiplicity:"one",relationProperty:"role"}}},{name:"impediment",parent:"general",resource:"impediments",aliases:["Impediment","impediments","Impediments"],fields:["id","name"],simpleFields:["id","isPrivate","plannedStartDate","plannedEndDate","name","customField1","customField2","customField3","customField4","customField5","customField6","customField7","customField8","customField9","customField10","customField11","customField12","customField13","customField14","customField15","customField16","customField17","customField18","customField19","customField20","customField21","customField22","customField23","customField24","customField25","customField26","customField27","customField28","customField29","customField30","customField31","customField32","customField33","customField34","customField35","customField36","customField37","customField38","customField39","customField40","customField41","customField42","customField43","customField44","customField45","customField46","customField47","customField48","customField49","customField50","customField51","customField52","customField53","customField54","customField55","customField56","customField57","customField58","customField59","customField60","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","isNow","isNext","isPrevious","history-count","comments-count","messages-count","tagObjects-count","masterRelations-count","slaveRelations-count","followers-count","attachments-count"],refs:{assignable:{name:"assignable",multiplicity:"",relationProperty:"impediments"},entityState:{name:"entityState",multiplicity:"",relationProperty:"impediments"},priority:{name:"priority",multiplicity:"",relationProperty:"impediments"},responsible:{name:"user",multiplicity:"",relationProperty:"impediments"},history:{list:!0,name:"impedimentHistory",multiplicity:"one",relationProperty:"impediment"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},lastCommentedUser:{name:"generalUser",multiplicity:"",relationProperty:"lastCommentedGenerals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},tagObjects:{list:!0,name:"tag",multiplicity:"",relationProperty:""},masterRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"slave"},slaveRelations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"master"},followers:{list:!0,name:"generalFollower",multiplicity:"one",relationProperty:"general"},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"company",parent:null,resource:"companies",aliases:["Company","companies","Companies"],fields:["id","name"],simpleFields:["id","name","url","description","projects-count"],refs:{projects:{list:!0,name:"project",multiplicity:"zeroOrOne",relationProperty:"company"}}},{name:"roleEffort",parent:null,resource:"roleEfforts",aliases:["RoleEffort","roleEfforts","RoleEfforts"],fields:["id"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain"],refs:{assignable:{name:"assignable",multiplicity:"",relationProperty:"roleEfforts"},role:{name:"role",multiplicity:"",relationProperty:"roleEfforts"}}},{name:"projectMember",parent:null,resource:"projectMembers",aliases:["ProjectMember","projectMembers","ProjectMembers"],fields:["id"],simpleFields:["id","weeklyAvailableHours","membershipStartDate","membershipEndDate","allocation","isActive"],refs:{project:{name:"project",multiplicity:"",relationProperty:"projectMembers"},user:{name:"user",multiplicity:"",relationProperty:"projectMembers"},role:{name:"role",multiplicity:"",relationProperty:""}}},{name:"teamMember",parent:null,resource:"teamMembers",aliases:["TeamMember","teamMembers","TeamMembers"],fields:["id"],simpleFields:["id","startDate","endDate"],refs:{team:{name:"team",multiplicity:"",relationProperty:"teamMembers"},user:{name:"user",multiplicity:"",relationProperty:"teamMembers"},role:{name:"role",multiplicity:"",relationProperty:""}}},{name:"teamProject",parent:null,resource:"teamProjects",aliases:["TeamProject","teamProjects","TeamProjects"],fields:["id"],simpleFields:["id","startDate","endDate","isProjectAccessed"],refs:{team:{name:"team",multiplicity:"",relationProperty:"teamProjects"},project:{name:"project",multiplicity:"",relationProperty:"teamProjects"}}},{name:"message",parent:null,resource:"messages",aliases:["Message","messages","Messages"],fields:["id"],simpleFields:["id","subject","recipients","body","isRead","isProcessed","createDate","sendDate","messageType","contentType","generals-count","attachments-count"],refs:{from:{name:"generalUser",multiplicity:"",relationProperty:"messagesFrom"},to:{name:"generalUser",multiplicity:"",relationProperty:"messagesTo"},messageUid:{name:"messageUid",multiplicity:"",relationProperty:""},generals:{list:!0,name:"general",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"zeroOrOne",relationProperty:"message"}}},{name:"messageUid",parent:null,resource:"messageUids",aliases:["MessageUid","messageUids","MessageUids"],fields:["id"],simpleFields:["id","uid","mailServer","mailLogin"],refs:{}},{name:"customField",parent:null,resource:"customFields",aliases:["CustomField","customFields","CustomFields"],fields:["id","name","entityFieldName"],simpleFields:["id","name","value","entityFieldName","fieldType","enabledForFilter","required","configString","config"],refs:{entityType:{name:"entityType",multiplicity:"",relationProperty:"customFields"},process:{name:"process",multiplicity:"",relationProperty:"customFields"}}},{name:"relationType",parent:null,resource:"relationTypes",aliases:["RelationType","relationTypes","RelationTypes"],fields:["id","name"],simpleFields:["id","name","relations-count"],refs:{relations:{list:!0,name:"relation",multiplicity:"one",relationProperty:"relationType"}}},{name:"relation",parent:null,resource:"relations",aliases:["Relation","relations","Relations"],fields:["id"],simpleFields:["id"],refs:{master:{name:"general",multiplicity:"",relationProperty:"slaveRelations"},slave:{name:"general",multiplicity:"",relationProperty:"masterRelations"},relationType:{name:"relationType",multiplicity:"",relationProperty:"relations"}}},{name:"generalFollower",parent:null,resource:"generalFollowers",aliases:["GeneralFollower","generalFollowers","GeneralFollowers"],fields:["id"],simpleFields:["id"],refs:{general:{name:"general",multiplicity:"",relationProperty:"followers"},user:{name:"user",multiplicity:"",relationProperty:"following"}}},{name:"term",parent:null,resource:"terms",aliases:["Term","terms","Terms"],fields:["id"],simpleFields:["id","wordKey","value"],refs:{process:{name:"process",multiplicity:"",relationProperty:"process"},entityType:{name:"entityType",multiplicity:"",relationProperty:"entityType"}}},{name:"resourceBase",parent:"resource",resource:"resourceBases",aliases:["ResourceBase","resourceBases","ResourceBases"],fields:["id"],simpleFields:["id"],refs:{}},{name:"attachment",parent:null,resource:"attachments",aliases:["Attachment","attachments","Attachments"],fields:["id","name"],simpleFields:["id","name","description","date","mimeType","uri","thumbnailUri","size"],refs:{owner:{name:"generalUser",multiplicity:"",relationProperty:"attachments"},general:{name:"general",multiplicity:"",relationProperty:"attachments"},message:{name:"message",multiplicity:"",relationProperty:"attachments"}}},{name:"customFieldConfig",parent:null,resource:"customFieldConfigs",aliases:["CustomFieldConfig","customFieldConfigs","CustomFieldConfigs"],fields:["id"],simpleFields:["id","defaultValue"],refs:{}},{name:"generalListItem",parent:null,resource:"generalListItems",aliases:["GeneralListItem","generalListItems","GeneralListItems"],fields:["id","name"],simpleFields:["id","name","parentProjectId","entityTypeId","numericPriority","createDate","startDate","endDate"],refs:{}},{name:"context",parent:null,resource:"contexts",aliases:["Context","contexts","Contexts"],fields:["id"],simpleFields:["id","acid","edition","version","selectedProjects-count","selectedTeams-count","processes-count"],refs:{loggedUser:{name:"user",multiplicity:"",relationProperty:""},culture:{name:"culture",multiplicity:"",relationProperty:""},selectedProjects:{list:!0,name:"projectInfo",multiplicity:"",relationProperty:""},selectedTeams:{list:!0,name:"teamInfo",multiplicity:"",relationProperty:""},processes:{list:!0,name:"processInfo",multiplicity:"",relationProperty:""},appContext:{name:"appContext",multiplicity:"",relationProperty:""}}},{name:"appContext",parent:null,resource:"appContexts",aliases:["AppContext","appContexts","AppContexts"],fields:["id"],simpleFields:["id"],refs:{projectContext:{name:"simpleContext",multiplicity:"",relationProperty:""},teamContext:{name:"simpleContext",multiplicity:"",relationProperty:""}}},{name:"simpleContext",parent:null,resource:"simpleContexts",aliases:["SimpleContext","simpleContexts","SimpleContexts"],fields:["id"],simpleFields:["id","no"],refs:{}},{name:"culture",parent:null,resource:"cultures",aliases:["Culture","cultures","Cultures"],fields:["id","name"],simpleFields:["id","name","decimalSeparator","shortDateFormat","longDateFormat","timePattern"],refs:{}},{name:"processInfo",parent:null,resource:"processInfos",aliases:["ProcessInfo","processInfos","ProcessInfos"],fields:["id","name"],simpleFields:["id","name","isDefault","terms-count","customFields-count","practices-count"],refs:{terms:{list:!0,name:"term",multiplicity:"",relationProperty:""},customFields:{list:!0,name:"customFieldInfo",multiplicity:"",relationProperty:""},practices:{list:!0,name:"practice",multiplicity:"",relationProperty:""}}},{name:"customFieldInfo",parent:null,resource:"customFieldInfos",aliases:["CustomFieldInfo","customFieldInfos","CustomFieldInfos"],fields:["id","name","entityFieldName"],simpleFields:["id","entityKind","name","entityFieldName","value","type","required","listed"],refs:{process:{name:"processInfo",multiplicity:"",relationProperty:"customFields"}}},{name:"projectInfo",parent:null,resource:"projectInfos",aliases:["ProjectInfo","projectInfos","ProjectInfos"],fields:["id","name"],simpleFields:["id","name","color","isActive","abbreviation"],refs:{process:{name:"processInfo",multiplicity:"",relationProperty:""},program:{name:"programInfo",multiplicity:"",relationProperty:""}}},{name:"teamInfo",parent:null,resource:"teamInfos",aliases:["TeamInfo","teamInfos","TeamInfos"],fields:["id","name"],simpleFields:["id","name","abbreviation","icon"],refs:{}},{name:"programInfo",parent:null,resource:"programInfos",aliases:["ProgramInfo","programInfos","ProgramInfos"],fields:["id","name"],simpleFields:["id","name"],refs:{}}]
}),define("tau/store/types.targetprocess.additional",[],function(){return[{name:"endDate",parent:null,aliases:["enddate","End Date","enddates","End Dates"],fields:[],simpleFields:[],refs:{}},{name:"createdDate",parent:null,aliases:["createdate","createddate","Created Date","createddates","Created Dates"],fields:[],simpleFields:[],refs:{}},{name:"startDate",parent:null,aliases:["startdate","Start Date","startdates","Start Dates"],fields:[],simpleFields:[],refs:{}},{name:"effort",parent:null,aliases:["Effort","efforts","Efforts"],fields:[],simpleFields:[],refs:{}},{name:"source",parent:null,aliases:["Source","sources","Sources"],fields:[],simpleFields:[],refs:{}},{name:"assignedUser",parent:null,aliases:["assigneduser","Assigned User","Assigned Users","assignedusers"],fields:[],simpleFields:[],refs:{}},{name:"inboundRelation",parent:null,aliases:["inboundrelation","Inbound Relation","Inbound Relations","inboundrelations"],fields:[],simpleFields:[],refs:{}},{name:"outboundRelation",parent:null,aliases:["outboundrelation","Outbound Relation","Outbound Relations","outboundrelations"],fields:[],simpleFields:[],refs:{}}]}),define("tau/store/types.targetprocess",["Underscore","tau/store/types","tau/store/types.targetprocess.generated","tau/store/types.targetprocess.additional"],function(e,t,i,n){var a=function(e){for(var t=[],i=0,n=e.length;n>i;i++){var a=e.charAt(i),r=a.toUpperCase();0===i?a=r:a===r&&t.push(" "),t.push(a)}return t.join("")},r=function(e){return{key:e,val:e}},s=function(t,i){return i=i||e.pluralize(t),{key:i,val:i}},o=function(e){return{key:e+" Big Icon Text",val:e}},l={testcase:"TC",teamiteration:"TI",testplan:"TP",testplanrun:"TR",userstory:"U"},u=function(t,i){return{key:t+" Small Icon Text",val:l[i.toLowerCase()]||e.last(t.split(" ")).charAt(0)}},c=function(e){if(e&&e.entityType&&e.entityType.name)return e.entityType.name;throw new Error("Type of entity is not detected")},d=function(e,t){var i=a(e);return{name:r(i),names:s(i,t),iconBig:o(i),iconSmall:u(i,e)}
};return e.each(i.concat(n),function(e){var i;switch(e.name){case"projectMember":i="Project Allocations";break;case"userStory":e.aliases.unshift("story","stories","us"),e.simpleFields.push("tasks-effort-sum","tasks-effortToDo-sum");break;case"general":case"assignable":e.isParentType=!0,e.discriminator={entityType:["id","name"]},e.detectType=c}("general"===e.parent||"assignable"===e.parent)&&e.simpleFields.push("customFields"),e.terms=d(e.name,i),"processInfo"===e.name&&e.refs&&(e.refs={}),"context"===e.name&&(e.refs||(e.refs={}),e.refs.culture&&delete e.refs.culture,e.refs.appContext&&delete e.refs.appContext,e.refs.selectedProjects={list:!0,name:"project"},e.simpleFields=["id","acid"]),t.register(e)}),t.register({name:"implementationHistory",aliases:["stats"]}),t.register({name:"solution"}),t.register({name:"prioritizer",fields:["id"],refs:[]}),t}),define("tau/target.process.rules.registrator",["Underscore","tau/store/types.targetprocess"],function(e,t){return{typeContainSimpleField:function(t,i){return e.find(t.simpleFields,function(e){return e===i})},registerRules:function(i,n){this.registeredEntityTypes={},this.rules=i,e.each(t.getDictionary(),this.registerType,this),i.register({type:"feature",changes:["initialEstimate"],fields:["timeRemain"]}),i.register({type:"iteration",changes:["startDate"],fields:["endDate"]}),i.register({type:"iteration",changes:["endDate"],fields:["startDate"]}),i.register({type:"teamIteration",changes:["startDate"],fields:["endDate"]}),i.register({type:"teamIteration",changes:["endDate"],fields:["startDate"]}),i.register({type:"testPlanRun",changes:["release"],fields:[{build:["id","name"]}]}),i.register({type:"testPlanRun",changes:["iteration","teamIteration"],fields:[{build:["id","name"]}]}),i.registerRule({name:"auto-include-before-save",type:"roleEffort",changes:["effort"],fields:[{assignable:["id","effort","effortToDo","effortCompleted","timeSpent","timeRemain"]}]}),i.registerRule({name:"auto-include-before-save",type:"userStory",changes:["release","iteration","teamIteration"],fields:[{tasks:[{release:["id","name"]},{iteration:["id","name"]},{teamIteration:["id","name"]}]}]}),i.registerRule({name:"auto-include-before-save",type:"task",changes:["entityState"],fields:[{release:["id","name"]},{iteration:["id","name"]},{teamIteration:["id","name"]}]}),i.registerRule({name:"auto-action-after-save",type:"assignable",changes:["times"],action:function(e){e.store.refresh("assignable",{id:e.data.id,fields:["effortCompleted","effortToDo","timeSpent","timeRemain",{roleEfforts:["id","effort","effortToDo"]}]}).done()
}}),i.registerRule({name:"auto-action-after-save",type:"feature",changes:["userStories"],action:function(e){e.store.refresh("feature",{id:e.data.id,fields:["effortCompleted","effortToDo","timeSpent","timeRemain","userStories-count","effort",{roleEfforts:["id","effort","effortToDo"]}]}).done()}}),i.registerRule({name:"auto-action-after-save",type:"iteration",changes:["userStories|bugs"],action:function(e){e.store.refresh("iteration",{id:e.data.id,fields:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"]}).done()}}),i.registerRule({name:"auto-action-after-save",type:"teamIteration",changes:["userStories|bugs"],action:function(e){e.store.refresh("teamIteration",{id:e.data.id,fields:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"]}).done()}}),i.registerRule({name:"auto-action-after-save",type:"release",changes:["userStories"],action:function(e){e.store.refresh("release",{id:e.data.id,fields:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum",{features:["effortToDo","effortCompleted","userStories-count"]}]}).done()}}),i.registerRule({name:"auto-action-after-save",type:"userStory",changes:["tasks"],action:function(e){var t=e.data,i=t.cmd?t.cmd.type:t.obj?t.obj.type:t.type,n=t.cmd?t.cmd.config.id:null;"task"!==i||n?e.store.refresh("userStory",{id:e.data.id,fields:["effort","effortToDo","effortCompleted","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum"]}).done():e.store.refresh("userStory",{id:e.data.id,fields:["tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{entityState:["id","name"]}]}).done()}}),i.registerRule({name:"auto-include-before-save",type:"task",changes:["entityState"],fields:[{userStory:["id","tasks-effort-sum","tasks-effortToDo-sum","effort","effortToDo","effortCompleted","timeSpent","timeRemain","tasks-count",{entityState:["id","name","isInitial","isFinal","isPlanned","isCommentRequired"]}]}]}),i.registerRule({name:"auto-include-before-save",type:"userStory",changes:["entityState"],fields:["tasks-effortToDo-sum",{feature:["effortToDo","effortCompleted","userStories-count"]},{iteration:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{teamIteration:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{release:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum",{features:["effortToDo","effortCompleted","userStories-count"]}]}]}),i.registerRule({name:"auto-action-after-save",type:"feature",changes:["userStories"],action:function(e){e.store.refresh("feature",{id:e.data.obj.id,fields:["effortToDo","effortCompleted","userStories-count"]}).done()
}}),i.registerRule({name:"auto-include-before-save",type:"bug",changes:["entityState"],fields:[{iteration:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]},{teamIteration:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]}]}),i.registerRule({name:"auto-action-after-save",type:"roleEffort",changes:["effort"],action:function(t){var i=t.store,n=t.data.obj;i.get(n.type,{id:n.id,fields:[{assignable:["id"]}]}).done({success:function(t){t=t[0];var n=t.data.assignable.id,a=t.data.assignable.__type,r={task:[{userStory:["id","effort","effortToDo","effortCompleted","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{roleEfforts:["effort","effortToDo"]}]}],userStory:[{iteration:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{teamIteration:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{release:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{feature:["userStories-count","effort","effortToDo","effortCompleted","timeSpent","timeRemain"]}],bug:[{iteration:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]},{teamIteration:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]},{release:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]}]},s=r[a];if(s){var o=e(s).filter(function(t){var r=e.getFieldName(t);return i.isPropertyInitialized(n,a,r)});o.length&&i.refresh(a,{id:n,fields:o}).done()}}})}}),i.registerRule({name:"auto-action-after-save",type:"comment",action:function(t){var i=t.data,a=i.cmd["comment-practices-notification-opts"];if(a&&e(a).keys().length){var r=n.getNotificationService();r.notifyComment(i.id,a)}}})},registerType:function(t){var i=this.registeredEntityTypes,n=this.rules;if(!i.hasOwnProperty(t.name)){i[t.name]=!0,e.each(t.aliases,function(e){i[e]=!0});var a="endDate";t.refs.hasOwnProperty("entityState")&&this.typeContainSimpleField(t,a)&&(n.register({type:t.name,changes:["entityState"],fields:["endDate","leadTime","cycleTime"]}),n.register({type:t.name,changes:["entityState"],fields:[{roleEfforts:["effort","effortToDo"]}]}))
}}}}),define("tau/store/factory",["Underscore","app.path","tau/core/class","tau/store/store","tau/store/repository","tau/store/services/service.rest","tau/core/global.bus","tau/rules/core","tau/rules/rule.auto-include-before-save","tau/rules/rule.auto-action-after-save","tau/rules/rule.auto-include-before-remove","tau/target.process.rules.registrator","tau/store/types","tau/store/db","tau/store/types.targetprocess"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){var m=null;return i.extend({rulesDisabled:!1,clearSingles:function(){m=null,this.rulesEngine&&(this.rulesEngine.destroy&&this.rulesEngine.destroy(),delete this.rulesEngine),delete this.proxy,delete this.service,delete this.store},clear:function(){this.clearSingles(),delete this.initialData,delete this.appPath,delete this.rulesDisabled},setApplicationPath:function(e){this.appPath!==e&&(this.appPath=e)},getApplicationPath:function(){return this.appPath?this.appPath:t.get()},setInitialData:function(e){this.initialData=e},setService:function(e){this.service!==e&&(this.clearSingles(),this.service=e)},getService:function(){return this.service||(this.service=new r({appPath:this.getApplicationPath(),path:this.getRestPath()})),this.service},getRestPath:function(){return this.getApplicationPath()+"/api/v1"},getDb:function(){return m||(m=new f({types:p.getDictionary()})),m},setProxy:function(e){this.proxy=e},getProxy:function(){return this.proxy||(this.proxy=new a({db:this.getDb(),service:this.getService()})),this.initialData&&(this.proxy.registerData(this.initialData),delete this.initialData),this.proxy},disableRules:function(){this.rulesDisabled=!0},enableRules:function(){this.rulesDisabled=!1},initRules:function(e){this.rulesDisabled!==!0&&(this.rulesEngine=new o({store:this.store,rules:[],rulesImpl:[l,u,c]}),d.registerRules(this.rulesEngine,e))},getStore:function(e){return this.store||(e=e||{},e.proxy=this.getProxy(),e.eventEmitter=e.eventEmitter||s.get(),this.store=new n(e),this.initRules(e.services)),this.store},setStore:function(e){this.store=e
}})}),define("tau/services/keyboard.manager",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(){this._handlers=[],t(document).keydown(e.bind(this._keyDown,this))},pushHandler:function(e){this._handlers.push(e)},popHandler:function(){this._handlers.pop()},_keyDown:function(t){var i=this._handlers.length>0?e.last(this._handlers):null;i&&i.handleKeyDown&&i.handleKeyDown(t)}})}),define("tau/services/state.manager",["Underscore","tau/core/class"],function(e,t){var i=function(){},n=t.extend({init:function(e){e=e||{};var t=[];if(e.state||t.push("state"),e.service||t.push("service"),t.length>0)throw"State manager should be initialized with following parameters: ["+t.join(",")+"]";this.subscriptions={},this.cfg=e},get:function(t){var n=this;if(!t.id)throw"StateManager.get operation requires parameter [id]";var a=e.defaults(t,{fields:[],callback:i}),r=this.cfg.service;return r.get(a),n},set:function(t){var n=this;if(!t.id)throw"StateManager.set operation requires parameter [id]";var a=e.defaults(t,{set:{},callback:i}),r=this.cfg.service;return r.set(a),n},update:function(t){var i=this,n=this.cfg.state,a=[];e(t).chain().keys().each(function(r){a.push(r);var s=n[r]||{},o=t[r];if(!e.isString(o)&&!e.isString(s)){var l=e(s).keys(),u=e(o).keys();e(e.union(l,u)).each(function(t){if(!e.isEqual(o[t],s[t])){var n=s.hasOwnProperty(t)?s[t]:null,a=o.hasOwnProperty(t)?o[t]:null;i.applyChanges({paramId:r,fieldName:t,value:a,delta:{prev:n,curr:a}})}})}}),e(n).chain().keys().difference(a).each(function(t){var a=n[t];e.isString(a)||e(a).chain().keys().each(function(e){i.applyChanges({paramId:t,fieldName:e,value:null,delta:{prev:a[e],curr:null}})})}),i.cfg.state=t},applyChanges:function(t){for(var i=this.subscriptions,n=e.clone((i[t.paramId]||{})[t.fieldName]||[]),a=0,r=n.length;r>a;a++){var s=n[a];s&&!s.isDeleted&&s.callback.call(s.scope,t)}},bind:function(e){var t=e.paramId,i=e.fieldName,n=e.callback,a=e.listener,r=this.subscriptions;return r[t]=r[t]||{},r[t][i]=r[t][i]||[],r[t][i].push({callback:n,scope:a}),this
},unbind:function(t){for(var i=this.subscriptions,n=e(i).keys(),a=0,r=n.length;r>a;a++){for(var s=n[a],o=e(i[s]).keys(),l=0,u=o.length;u>l;l++){for(var c=o[l],d=i[s][c],p=d.length-1;p>=0;p--)d[p].scope===t&&(d[p].isDeleted=!0,d.splice(p,1));0===i[s][c].length&&delete i[s][c]}0===e(i[s]).keys()&&delete i[s]}}});return n}),define("tau/services/service.routing",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e){e=e||{},this.config=e,this.external=e.external},get:function(e){for(var t={},i=e.id,n=e.fields,a=n.length,r=this.external.getHashParam(i),s=0;a>s;s++){var o=n[s];t[o]=r.hasOwnProperty(o)?r[o]:null}e.callback(t)},set:function(t){var i=t.id,n=t.set,a=this.external.getHashParam(i),r=e(a).extend(n);this.external.setHashParam(i,r),t.callback(r)}});return i}),define("tau/services/service.hash",["Underscore","jQuery","tau/core/class","tau/core/event","libs/parseUri","libs/json2"],function(e,t,i,n,a){var r=i.extend({init:function(t){this._id=e.uniqueId("sh"),this.setWindow(t.getWindow()),this.setEncoder(t.getHashEncoder()||this.encoderDefault())},setWindow:function(i){this.window&&t(this.window).unbind("hashchange."+this._id),this.window=e.defaults(i||{},{location:{hash:"",replace:function(e){i.location.hash=e}}}),t(this.window).bind("hashchange."+this._id,e.bind(function(){this.fire("changed",{hash:this.getHash()})},this))},setEncoder:function(e){this.paramsEncoder=e},getHash:function(){for(var e=this.window.location.hash;0===e.indexOf("#");)e=e.substr(1);return this.tryDecodeUri(e)},setHref:function(e){this.window.location.href=e},getHref:function(){return this.window.location.href},getHrefParsed:function(){return a(this.getHref())},setHash:function(e){this.window.location.replace("#"+e)},triggerHashChange:function(e){t(this.window).trigger("hashchange."+this._id,{hash:e})},hashParams:function(){for(var e={},t=this.getHash(),i=t.split("&"),n=0,a=i.length;a>n;n++){var r=i[n],s=r.indexOf("=");if(-1!==s){var o=r.substr(0,s),l=r.substr(s+1);e[o]=this.paramsEncoder.decode(l)
}}return e},getHashParam:function(e,t){var i=this.hashParams();return i[e]||(arguments.length>1?t:{})},setHashParam:function(e,t){var i=this.getHash(),n=this.mergeHashParams(i,e,t);this.setHash(n)},applyHashObject:function(t){var i=this,n=this.getHash();e.each(t,function(e,t){n=this.mergeHashParams(n,t,e)},i),i.setHash(n)},mergeHashParams:function(e,t,i){e="&"!==e.charAt(0)?"&"+e:e;var n=e.indexOf("&"+t+"="),a=-1!==n?n:e.length;n=e.indexOf("&",1+a);var r=-1!==n?n:e.length,s="";if(null!==i){var o=this.paramsEncoder.encode(i),l="&"===e?"":"&";s=l+t+"="+o}var u=e.substring(0,a),c=e.substring(r),d=u+s+c;return d="&"!==d.charAt(0)?d:d.substring(1)},tryDecodeUri:function(e){var t=e;try{t=decodeURIComponent(e)}catch(i){}return t},onHashChange:function(e){this.on("changed",e,e)},unbindHashChange:function(e){this.removeListener("changed",e,e)},encoderDefault:function(){return{encode:function(t){var i=t;return e.isObject(t)&&(i=JSON.stringify(t)),i},decode:function(e){var t=e;return"{"===t.charAt(0)&&"}"===t.charAt(t.length-1)&&(t=JSON.parse(t)),t}}},setDefaultEncoder:function(){this.paramsEncoder=this.encoderDefault()},setFakeWindow:function(i){var n=this._getLocation(i),a=t("<div />");a.location=e.defaults(n,{hash:"",href:"",replace:function(t){a.location.hash=e.asString(t),a.trigger("hashchange",{})}}),this.on("destroy",function(){a.remove()}),this.setWindow(a)},_getLocation:function(t){return e.isString(t)?{hash:t}:t||{}},destroy:function(){this.fire("destroy"),this.removeAllListeners()}});return n.implementOn(r.prototype),r}),define("tau/utils/utils.routing/utils.routing.store.hash",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=i.extend({init:function(t){this.config=e.defaults(t,{window:window})},_parseUrl:function(e){e&&"#"==e[0]&&(e=e.slice(1));var t=e;try{t=decodeURIComponent(t)}catch(i){}var n={url:t.split("||")[0],source:"#"+e};return n},setUrl:function(e){this.config.window.location.hash=e},getUrl:function(){return this._parseUrl(this.config.window.location.hash)
}});return n}),define("libs/base64/base64",[],function(){function e(){this.buffer=[]}function t(e){this._input=e,this._index=-1,this._buffer=[]}function i(e){this._input=e,this._index=-1,this._buffer=[]}e.prototype.append=function(e){return this.buffer.push(e),this},e.prototype.toString=function(){return this.buffer.join("")};var n={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(i){for(var n=new e,a=new t(i);a.moveNext();){var r=a.current;a.moveNext();var s=a.current;a.moveNext();var o=a.current,l=r>>2,u=(3&r)<<4|s>>4,c=(15&s)<<2|o>>6,d=63&o;isNaN(s)?c=d=64:isNaN(o)&&(d=64),n.append(this.codex.charAt(l)+this.codex.charAt(u)+this.codex.charAt(c)+this.codex.charAt(d))}return n.toString()},decode:function(t){for(var n=new e,a=new i(t);a.moveNext();){var r=a.current;if(128>r)n.append(String.fromCharCode(r));else if(r>191&&224>r){a.moveNext();var s=a.current;n.append(String.fromCharCode((31&r)<<6|63&s))}else{a.moveNext();var s=a.current;a.moveNext();var o=a.current;n.append(String.fromCharCode((15&r)<<12|(63&s)<<6|63&o))}}return n.toString()}};return t.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var e=this._input.charCodeAt(++this._index);return 13==e&&10==this._input.charCodeAt(this._index+1)&&(e=10,this._index+=2),128>e?this.current=e:e>127&&2048>e?(this.current=e>>6|192,this._buffer.push(63&e|128)):(this.current=e>>12|224,this._buffer.push(e>>6&63|128),this._buffer.push(63&e|128)),!0}},i.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var e=n.codex.indexOf(this._input.charAt(++this._index)),t=n.codex.indexOf(this._input.charAt(++this._index)),i=n.codex.indexOf(this._input.charAt(++this._index)),a=n.codex.indexOf(this._input.charAt(++this._index)),r=e<<2|t>>4,s=(15&t)<<4|i>>2,o=(3&i)<<6|a;
return this.current=r,64!=i&&this._buffer.push(s),64!=a&&this._buffer.push(o),!0}},n}),define("tau/utils/utils.storage.cookie",["libs/base64/base64"],function(e){var t=function(t){var i=e.encode(t);return i="#"+i},i=function(t){var i=t;return"#"===t.charAt(0)&&(t=t.substring(1),i=e.decode(t)),i},n=function(e){return"$"+e},a={set:function(e,i,a){var r=n(e),s=new Date;s.setTime(s.getTime()+31536e6),a=a||s.toGMTString();var o=JSON.stringify(i);o=t(o);var l=[r+"="+o,"expires="+a,"path=/"].join("; ");document.cookie=l},get:function(e){var t=n(e);t+="=";for(var a,r=document.cookie.split(";"),s=0;s<r.length;s++){for(var o=r[s];" "===o.charAt(0);)o=o.substring(1,o.length);0===o.indexOf(t)&&(a=o.substring(t.length,o.length),a=i(a),a=JSON.parse(a))}return a},remove:function(e){return a.set(e,"",-1)}};return a}),define("tau/utils/utils.storage",["tau/utils/utils.storage.cookie"],function(e){var t=!!(window.localStorage&&window.localStorage.getItem&&window.localStorage.setItem);return t?{set:function(e,t){return localStorage.setItem(e,JSON.stringify(t)),!0},get:function(e){var t=localStorage.getItem(e);if(t)try{t=JSON.parse(t)}catch(i){}return t},remove:function(e){return localStorage.removeItem(e)}}:e}),define("tau/utils/utils.routing",["Underscore","jQuery","tau/core/class","tau/core/event","tau/utils/utils.routing/utils.routing.store.hash","tau/utils/utils.storage"],function(e,t,i,n,a,r){var s=i.extend({init:function(t){this.options=t,this.window=this.options.window||window,this.store=new a(this.options),this.referer=this.restoreReferer(),this._routeData={route:{},args:{}},this.routeChanged=e.Callbacks()},redirect:function(t){e.startsWith(t,"#")&&(t=this.window.location.href.split("#")[0]+t),this.window.open(t,"_self")},getUrl:function(){return this.store.getUrl()},setUrl:function(e){this.store.setUrl(e)},getReferer:function(){return this.referer},setReferer:function(e){this.referer=e,r.set("utils.routing.referer",this.referer)},restoreReferer:function(){return r.get("utils.routing.referer")
},setCurrentRoute:function(e){this._routeData=e,this.routeChanged.fire(e)},getCurrentRoute:function(){return this._routeData},destroy:function(){this.routeChanged.removeAll()}});return s}),define("tau/utils/utils.history",["Underscore","tau/core/class","tau/core/event"],function(e,t,i){var n=t.extend({init:function(){this.stack=[],this.current=null},size:function(){return this.stack.length},push:function(e){return this.stack.push(e),this},pop:function(){return this.stack.pop()},setCurrent:function(e){this.current=e,this.fire("setCurrent")},getCurrent:function(){return this.current},process:function(){this.current&&(this.stack=this.getFlatStack(),this.stack.push(e.clone(this.current))),this.current=null},updateCurrent:function(e){this.current&&(this.current.url=e.url||this.current.url,this.current.title=e.title||this.current.title,this.current.id=e.id||this.current.id,this.fire("setCurrent"))},exclude:function(t,i){this.stack=e.reject(this.stack,function(e){return e.id&&e.id==t}),this.current&&this.current.id==t&&(this.current=null),i!==!1&&this.fire("changed")},getFlatStack:function(){var t=this.stack,i=t;if(this.current){var n=e.find(i,e.bind(function(e){return e.id&&e.id===this.current.id},this));n&&(i=t.slice(0,e.indexOf(i,n)))}return i},reset:function(){this.current=null,this.stack=[]}});return i.implementOn(n.prototype),n}),define("tau/storage/app.state.store.seriailzer",["Underscore"],function(){return{extractSharedState:function(e){var t=null;return e.acid&&(t={},t[e.id]={acid:e.acid}),t},serialize:function(e){return e.acid?e.id+'={"acid":"'+e.acid+'"}':null}}}),define("tau/configurations/const.page.entity.actions",{SHOW:"show",SILENT:"silent",PRINT:"print"}),define("tau/utils/utils.urlBuilder.service",["require","Underscore","jQuery","tau/core/class","tau/storage/app.state.store.seriailzer","tau/services/service.hash","tau/configurations/const.page.entity.actions"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class"),a=e("tau/storage/app.state.store.seriailzer"),r=e("tau/services/service.hash"),s=e("tau/configurations/const.page.entity.actions");
return n.extend({init:function(e){this.applicationPath=e.getApplicationPath(),this.currentAcid=e.getCurrentAcid(),this.configurator=e,this.stateManager=e.getStateManager(),this.stateManager.get({id:"appConfig",fields:["acid"],callback:t.bind(function(e){e.acid&&(this.currentAcid=e.acid)},this)}),this.stateManager.bind({paramId:"appConfig",fieldName:"acid",listener:this,callback:t.bind(function(e){e.value&&(this.currentAcid=e.value)},this)}),this.pages={view:"/RestUI/TpView.aspx"}},getApplicationPath:function(){return this.applicationPath},getCurrentAcid:function(){return this.currentAcid},getHashBuilder:function(){var e=new r(this.configurator);return e.setFakeWindow(),{append:function(i){return t.forEach(i,function(t,i){e.setHashParam(i,t)}),this},build:function(){var t="#"+e.getHash();return e.destroy(),t}}},getAddImpedimentUrl:function(e){return this.getApplicationPath()+"/Project/Tracking/Impediment/Edit.aspx?AssignableID="+e},getAddTimeUrl:function(e){return this.getApplicationPath()+"/Project/Tracking/Time/Edit.aspx?AssignableID="+e},getAddTaskForUserStoryUrl:function(e){return this.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?UserStoryID="+e},getAddTaskForRequestUrl:function(e){return this.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?RequestID="+e},getSplitForUserStoryUrl:function(e,t){return this.getApplicationPath()+"/Project/Planning/UserStory/Split.aspx?UserStoryID="+e+"&SplittedStoryID="+t},getAddBugForUserStoryUrl:function(e){return this.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?UserStoryID="+e},getAddBugForRequestUrl:function(e){return this.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?RequestID="+e},getAddTestCaseForUserStoryUrl:function(e){return this.getApplicationPath()+"/Project/QA/TestCase/Edit.aspx?UserStoryID="+e},getAssignTestCasesForTestPlanUrl:function(e){return this.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+e},getAddTestRunForTestPlanUrl:function(e){return this.getApplicationPath()+"/Project/QA/TestPlanRun/Edit.aspx?TestPlanID="+e
},getAddUserStoryForRequestUrl:function(e){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?RequestID="+e},getAddUserStoryForFeatureUrl:function(e){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?FeatureID="+e},getAddUserStoryForIterationUrl:function(e){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?IterationID="+e},getAddFeatureForRequestUrl:function(e){return this.getApplicationPath()+"/Project/Planning/Feature/Edit.aspx?RequestID="+e},getAddTestCaseForTestPlanRunUrl:function(e){return this.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+e},getAddIterationForReleaseUrl:function(e){return this.getApplicationPath()+"/Project/Planning/Iteration/Edit.aspx?ReleaseID="+e},getBoardPageRelativePath:function(){return"restui/board.aspx"},getPrintUrlRelative:function(e,t){return"RestUI/Print.aspx?acid="+this.getCurrentAcid()+"#"+t.toLowerCase()+"/"+e+"/"+s.PRINT},getNewViewUrl:function(e,t,i){return this.getRelativeBoardPageUrl(t.toLowerCase()+"/"+e,i===!0?void 0:i)},getNewViewUrlWithAction:function(e,t,i,n){return this.getRelativeBoardPageUrl(t.toLowerCase()+"/"+e+"/"+n,i===!0?void 0:i)},getDashboardUrl:function(){return this.getRelativeBoardPageUrl("board/current")},getShortViewUrl:function(e){return this.getApplicationPath()+"/entity/"+e.id},getEditUrl:function(e,i){var n=this.getApplicationPath()+"/",a=i.toLowerCase();return"project"==a?n+="EditProject.aspx?ProjectID="+e:"program"==a?n+="EditProgram.aspx?ProgramID="+e:(n+="Project/",n+=t.indexOf(["bug","testplan","testcase","testplanrun"],a)>-1?"QA/":t.indexOf(["impediment"],a)>-1?"Tracking/":t.indexOf(["request"],a)>-1?"HelpDesk/":"time"===a?"Tracking/":"Planning/",n+=i+"/Edit.aspx?"+i+"ID="+e),n},getAvatarUrl:function(e,t){return this.getApplicationPath()+"/Avatar.ashx?UserId="+e+"&size="+t},getLogoutUrl:function(){return this.getApplicationPath()+"/login.aspx?logout=true"},getUserUrl:function(e,t){var i="/User/View.aspx?UserID=";
return t&&"Requester"==t&&(i="/User/Requester/View.aspx?RequesterID="),[this.getApplicationPath(),i,e].join("")},getRelativeBoardPageUrl:function(e,i){var n=t.clone(this.configurator.getAppStateStore().settings);null==i?i=n:t.isString(i)&&(n.acid=i,i=n);var r=this.getHashBuilder();return r.append({page:e}),r.append(a.extractSharedState(i)),r.build()},getRelativeBoardUrl:function(e,t){return this.getRelativeBoardPageUrl("board/"+e,t)},getRelativeLastBoardUrl:function(e){return this.getRelativeBoardUrl("last",e)},getAdminProcessEdit:function(e){return this.getApplicationPath()+"/Admin/EditProcess.aspx?acid="+this.getCurrentAcid()+"&ProcessID="+e+"&rmnav=1"},getAdminPracticesEdit:function(e){return this.getAdminProcessEdit(e)+"&hideleftmenu=1&nomashups"},getAdminAdminDelegateEdit:function(e){return this.getApplicationPath()+"/Admin/AdminDelegate.aspx?acid="+this.getCurrentAcid()+"&ProcessID="+e+"&rmnav=1&hideleftmenu=1&nomashups"},getAdminCustomFieldsEdit:function(e){return this.getApplicationPath()+"/Admin/CustomFields.aspx?acid="+this.getCurrentAcid()+"&ProcessID="+e+"&rmnav=1&hideleftmenu=1&nomashups"},getAdminWorkflowEdit:function(e){return this.getApplicationPath()+"/Admin/Workflow.aspx?acid="+this.getCurrentAcid()+"&ProcessID="+e+"&rmnav=1&hideleftmenu=1&nomashups"},getProcessSetupPage:function(e,t){return this.getRelativeBoardPageUrl("process-setup/"+e+"/"+t)},getWorkflowSetupPage:function(e,t){return this.getRelativeBoardPageUrl("process-setup/"+e+"/workflows/"+t)},_build:function(e){var t=e.path,n=i.param(e.params);return n&&(t=t+"?"+n),e.hash&&(t=t+"#"+e.hash),t},destroy:function(){this.stateManager.unbind(this)}})}),function(){"use strict";function e(e,t,i,n,a,r){t[e]&&(i.push(e),(t[e]===!0||1===t[e])&&n.push(a+e+"/"+r))}function t(e,t,i,n,a){var r=n+t+"/"+a;require._fileExists(e.toUrl(r))&&i.push(r)}function i(e,t,n){var a;for(a in t)!t.hasOwnProperty(a)||e.hasOwnProperty(a)&&!n?"object"==typeof t[a]&&i(e[a],t[a],n):e[a]=t[a]}var n=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;
define("i18n",["module"],function(a){var r=a.config();return{version:"2.0.1",load:function(a,s,o,l){l=l||{},l.locale&&(r.locale=l.locale);var u,c,d,p=n.exec(a),f=p[1],m=p[4],h=p[5],g=m.split("-"),v=[],b={},y="";if(p[5]?(f=p[1],u=f+h):(u=a,h=p[4],m=r.locale,m||(m=r.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=m.split("-")),l.isBuild){for(v.push(u),t(s,"root",v,f,h),c=0;c<g.length;c++)d=g[c],y+=(y?"-":"")+d,t(s,y,v,f,h);s(v,function(){o()})}else s([u],function(t){var n,a=[];for(e("root",t,a,v,f,h),c=0;c<g.length;c++)n=g[c],y+=(y?"-":"")+n,e(y,t,a,v,f,h);s(v,function(){var e,n,r;for(e=a.length-1;e>-1&&a[e];e--)r=a[e],n=t[r],(n===!0||1===n)&&(n=s(f+r+"/"+h)),i(b,n);o(b)})})}}})}(),define("tau/nls/tokens",{root:{TargetProcess:"Targetprocess",board:"board",list:"list","Show in menu to all users":"Show in menu to all users","Remove board":"Remove board","show more":"show more"},"ru-ru":!0}),define("tau/nls/translator",["Underscore","i18n!tau/nls/tokens"],function(e,t){var i=function(i){var n=t.hasOwnProperty(i)?t[i]:i;return e.isFunction(n)?n():n};return i.gettext=i,i}),define("tau/store/services/service.globalSettings",["jQuery","tau/core/class"],function(e,t){var i=null,n=t.extend({init:function(e){this.config=e},resetSettings:function(){i=null},getGlobalSettings:function(t){var n=function(e,t){e&&e.success&&e.success.call(e.scope,t.d)};return i?(n(t,i),e.Deferred().resolve(i.d)):this.sendRequest("GlobalSettingsService","GetGlobalSettings",null,function(e){i=e,n(t,e)},function(e){t.failure&&t.failure.call(t.scope,e)}).then(function(e){return e.d})},sendRequest:function(t,i,n,a,r){var s=this.config.appPath+"/PageServices/"+t+".asmx/"+i,o={contentType:"application/json",type:"POST",success:a,error:r};return n&&(o.data=JSON.stringify(n)),e.ajax(s,o)}});return n}),define("tau/services/service.applicationContext",["Underscore","jQuery","tau/core/class","tau/core/event"],function(e,t,i,n){var a=i.extend({dirtyState:!1,init:function(e){this.configurator=e,this.store=e.getStore(),this.store2=e.getStore2(),this.onApplicationContextRetrieved=t.Callbacks()
},refreshChoice:function(){this.fire("refreshChoice.after")},setCurrentAcid:function(e,t){this.store.save("context",{acid:e}).done(t)},getTeamsProjectsAvailable:function(e){return this.configurator.getStore2().getTeamsProjectsAvailable(e)},appendToContext:function(t,i,n){return n.get({fields:["acid"]}).then(function(e){return this.getApplicationContext({acid:e.acid})}.bind(this)).then(function(n){var a={project:n.selectedProjectIds,team:n.selectedTeamIds};a[t.toLowerCase()]=e.union(a[t.toLowerCase()],i);var r={projectIds:a.project,teamIds:a.team};return this.getApplicationContext(r)}.bind(this)).then(function(e){return n.set({set:{acid:e.acid}})}.bind(this))},findByEntity:function(e){var i=t.Deferred();return this.getApplicationContext({id:e.id},{success:function(e){i.resolve(e)},failure:function(e){i.reject(e)}}),i},markAsDirty:function(){this.dirtyState=!0},_getErrorMessage:function(t){var i=t[0]||{};return e.complexKey(i,"data.response.Message")||"Failed to load application context"},getApplicationContext:function(i,n){var a=t.Deferred(),r=this,s={fields:["id","acid","culture","edition","appContext",{loggedUser:["id","email","isAdministrator"]},{processes:["id","name","terms","practices","customFields"]},{selectedProjects:["id","name",{process:["id","name"]}]},{selectedTeams:["id","name"]}]};i.hasOwnProperty("acid")?s.acid=i.acid:i.hasOwnProperty("ids")&&(s.ids=i.ids),(i.hasOwnProperty("projectIds")||i.hasOwnProperty("projectId"))&&(s.projectIds=i.projectIds||i.projectId),(i.hasOwnProperty("teamIds")||i.hasOwnProperty("teamId"))&&(s.teamIds=i.teamIds||i.teamId),s.id=i.id||i.acid,s.failureGlobal=!1;var o,l;s.id?this.dirtyState?(l=function(){this.dirtyState=!1}.bind(this),o="refresh"):o="get":o="turboGet";var u=function(e,t){e.availableProcesses=t.availableProcesses},c=function(t,i){var n=e(i.teams).pluck("id"),a=e(i.projects).pluck("id");t.teamIdsAvailable=n,t.selectedTeamIdsAvailable=e.intersection(t.selectedTeamIds,n),t.projectIdsAvailable=a,t.selectedProjectIdsAvailable=e.intersection(t.selectedProjectIds,a)
},d=function(t,i){var n=i.projectContext.no?["null"]:[],a=i.teamContext.no?["null"]:[];t.selectedProcessIds=e.pluck(t.processes,"id"),t.selectedProjectIds=e.union(n,e.pluck(t.selectedProjects,"id")),t.selectedTeamIds=e.union(a,e.pluck(t.selectedTeams,"id"))},p=function(e,t){r.isBoardEdition&&(t.push("board"),t.push("hasTeams")),e.edition=t},f=this.configurator;return f.getFeaturesService().isEnabled("context.v2")?this.store2.getApplicationContext(s).done(function(t){var i=f.getSystemInfo(),n=t.context,r={__type:"context",acid:n.acid,appContext:{projectContext:{no:n.isNoProjectIncluded},teamContext:{no:n.isNoTeamIncluded}},culture:i.culture,edition:i.edition,id:n.acid,loggedUser:e.omit(f.getLoggedUser(),"role"),selectedProjects:n.selectedProjects.items,selectedTeams:n.selectedTeams.items,processes:e.map(n.processes,function(e){return{customFields:e.customFields.items,id:e.id,name:e.name,isDefault:e.isDefault,practices:e.practices.items,terms:e.terms.items}})},s={name:"turboGet",type:r.__type,config:{}};this.store.registerWithEvents(r,"__type",s),p(r,[i.edition]),d(r,r.appContext),u(r,n),c(r,t),r.projects=t.projects,r.teams=t.teams,r.programs=t.programs,r.loggedUser=f.getLoggedUser(),a.resolve(r)}.bind(this)).fail(function(e){a.reject(this._getErrorMessage([{data:e}]))}.bind(this)):this.store[o]("context",s).done({success:function(t){var i=t[0].data;e.isArray(i)&&(i=i[0]);var n=i.edition?[i.edition]:[];p(i,n);var s=i.appContext||{};e.defaults(s,{projectContext:{no:!1},teamContext:{no:!1}}),d(i,s),r.getTeamsProjectsAvailable(i.loggedUser.id).done(function(e){u(i,e),c(i,e),a.resolve(i)}).fail(function(e){a.reject(e.statusText)})},failure:function(e){a.reject(this._getErrorMessage(e))}.bind(this)}),a.done(e.compact([function(e){this.onApplicationContextRetrieved.fire(e),n&&n.success&&n.success.apply(null,[e])}.bind(this),l])).fail(function(e){n&&n.failure&&n.failure.apply(null,[e])}),a}});return n.implementOn(a.prototype),a}),define("tau/store/services/service.notifications",["tau/core/class"],function(e){var t=e.extend({init:function(e){this.config=e
},notifyComment:function(e,t,i){i=i||{},this.sendRequest("CommentsNotificationService","Notify",{commentId:e,options:t},function(e){i.success&&i.success.call(i.scope,e.d)},function(e){i.failure&&i.failure.call(i.scope,e)})},sendRequest:function(e,t,i,n,a){var r=this.config.appPath+"/PageServices/"+e+".asmx/"+t,s={contentType:"application/json",type:"POST",success:n,error:a};i&&(s.data=JSON.stringify(i)),$.ajax(r,s)}});return t}),define("tau/store/services/service.actions",["jQuery","Underscore","tau/core/class"],function(e,t,i){var n=i.extend({init:function(e){this.config=e},getActionUrl:function(e){return this.config.appPath+"/PageServices/ActionsService.asmx/"+e},getActiveProjectForEntity:function(e,t,i){var n={generalId:e};this.sendRequest("GetActiveProjectForEntity",n,t,i)},copyGeneralToProject:function(e,t,i,n){var a={generalId:e,projectId:t};this.sendRequest("CopyGeneralToProject",a,i,n)},getProjectIds:function(e,t){var i={};this.sendRequest("GetProjectIds",i,e,t)},moveGeneralToProject:function(e,t,i,n){var a={generalId:e,projectId:t};this.sendRequest("MoveGeneralToProject",a,i,n)},attachGeneralToRequest:function(e,t,i,n){var a={generalId:e,requestId:t};this.sendRequest("AttachGeneralToRequest",a,i,n)},detachRequest:function(i){var n={generalId:i.generalId,requestId:i.requestId};i=t(i).defaults({success:e.noop,error:e.noop}),this.sendRequest("DetachRequestFromGeneral",n,i.success,i.error)},_mapEntityTypes:function(e){return t.map(e.d,function(e){return{id:e.ID,name:e.EntityTypeName,term:e.Name}})},getEntityTypesToConvert:function(e){return this.sendRequestDef("GeneralCanConvertTo",{generalId:e}).then(this._mapEntityTypes)},getEntityTypesToCreateFromRequest:function(e){return this.sendRequestDef("CanCreateFromRequest",{requestId:e}).then(this._mapEntityTypes)},convertGeneralToTask:function(e,t){var i={generalId:e,userStoryId:t};return this.sendRequestDef("ConvertGeneralToTask",i)},createFromRequest:function(e,t){var i={requestId:e,entityTypeId:t};return this.sendRequestDef("CreateFromRequest",i)
},createTaskFromRequest:function(e,t){var i={requestId:e,userStoryId:t};return this.sendRequestDef("CreateTaskFromRequest",i)},convertGeneralToType:function(e,t){var i={generalId:e,entityTypeId:t};return this.sendRequestDef("ConvertGeneralToType",i)},finishIteration:function(e,t,i,n,a){var r={from:e,to:t,useMoveInsteadSplit:i};this.sendRequest("FinishIteration",r,n,a)},finishTeamIteration:function(e,t,i,n,a){var r={from:e,to:t,useMoveInsteadSplit:i};this.sendRequest("FinishTeamIteration",r,n,a)},splitUserStory:function(e,t,i){var n={generalId:e};this.sendRequest("SplitUserStory",n,t,i)},sendFeedback:function(e,t){var i={viewMode:e,message:t};return this.sendRequestDef("SendFeedback",i)},sendRequest:function(t,i,n,a){e.ajax(this.getActionUrl(t),{contentType:"application/json",type:"POST",data:JSON.stringify(i),success:n,error:a})},sendRequestDef:function(t,i){return e.ajax({url:this.getActionUrl(t),contentType:"application/json",type:"POST",data:JSON.stringify(i)})}});return n}),define("tau/core/query",["jQuery","Underscore","libs/json2"],function(e,t){return{find:function(e,i){var n=[],a=this,r=a._formWhere(i,"",function(e,t,i){return{operator:e,key:t,value:i}});return t.each(e,function(e){var i=!1;t.each(r,function(n){if(!i){var r=a._getObjectValue(e,n.key);t.isUndefined(r)&&(i=!0),n.operator.compare(r,n.value)||(i=!0)}}),i||n.push(e)}),n},render:function(e,t){return this._getWhere(e,t)},_initializeDefaultRenders:function(e){t.defaults(e,{defaultRenderer:function(e,i){var n=this,a=[];return t.isArray(i)||(i=[i]),t.each(i,function(t){a.push("("+e+n.name+JSON.stringify(t)+")")}),a},$in:function(e,i){var n=this,a=[];t.isArray(i)||(i=[i]);var r=[];return t(i).each(function(e){r.push(JSON.stringify(e))}),a.push("("+e+" "+n.name+" ["+r.join(",")+"])"),a}})},_getObjectValue:function(e,t){for(var i=t.split("."),n=e,a=0;a<i.length;a++){if(!e.hasOwnProperty(i[a]))return void 0;n=e[i[a]]}return n},_getQueryOperators:function(){var e={};this._initializeDefaultRenders(e);var i={$in:{name:"in",compare:function(e,i){return t.any(i,function(t){return t==e
})}},$ne:{name:"!=",compare:function(e,t){return e!=t}},$eq:{name:"==",compare:function(e,t){return e==t}}};return t.each(t(i).keys(),function(t){var n=i[t];n.render=e.hasOwnProperty(t)?e[t]:e.defaultRenderer}),i},_isQueryValueWithOperator:function(e,i){var n=t(e).keys();if(0===n.length)return!1;var a=i||this._getQueryOperators();return a.hasOwnProperty(n[0])},_formWhere:function(e,i,n){var a=[];n=n||function(e,t,i){return e.render(t,i)};var r=this;i=i||"";var s=r._getQueryOperators();return t.each(t(e).keys(),function(o){if("$"!==o[0]){var l=e[o],u=i+o;if(t.isString(l)||t.isNumber(l)||t.isDate(l)||t.isArray(l)||t.isBoolean(l)||t.isNull(l)){var c=null===l?"$isNull":"$eq";return void(a=a.concat(n(s[c],u,l)))}if(r._isQueryValueWithOperator(l,s))return void t.each(t(l).keys(),function(e){a=a.concat(n(s[e],u,l[e]))});var d=r._formWhere(l,o+".",n);t.each(d,function(e){a.push(e)})}}),a},_getWhere:function(e,t){t=t||function(){return"("+i.join("and")+")"};var i=this._formWhere(e);return 0===i.length?"":t(i)}}}),define("tau/storage/url.resolver",["jQuery","Underscore","app.path","tau/core/query"],function(e,t,i,n){var a=i.get(),r=a+"/storage/v1/";return{resolve:function(e){var i=r+e.$group||"common";e.$key&&(i+="/"+e.$key),i+="?";var a=e.$where&&t.isString(e.$where)?e.$where:n.render(e.$where||{});return a&&(i+="&where="+a),e.$fields&&e.$fields.length&&(i+="&select=new("+e.$fields.join(",")+")"),encodeURI(i)}}}),define("tau/utils/utils.api",["Underscore"],function(e){return{createDeleteAjaxCommandConfig:function(t){return t=t||{},e.extend({},t,{type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:e.wrap(t.beforeSend,function(e,t){t.setRequestHeader("X-HTTP-Method-Override","DELETE"),e&&e(t)})})},convertJsonNode:function(t){t=t||{};var i={};return e.each(t,function(e,t){i[t]=JSON.stringify(e)}),i}}}),define("tau/storage/api.nocache",["tau/core/bus","jQuery","Underscore","./url.resolver","tau/core/event","tau/utils/utils.api"],function(e,t,i,n,a,r){var s=function(e){e=e||{};
var t=["key","ownerIds","scope","id","group","data","userData","publicData"],n=i.difference(i.keys(e),t);return i.each(n,function(t){e[t]=JSON.parse(e[t])}),e.publicData&&(e.publicData=s(e.publicData)),e.userData&&(e.userData=s(e.userData)),e},o=function(e){if(!e)return null;var t=(e?JSON.parse(e):null)||{},n=[];return t.items?(i.each(t.items,function(e){n.push(s(e))}),n):s(t)},l=e.extend({config:null,init:function(e){this.config=e||{},i.defaults(this.config,{service:t.ajax})},getServiceDeferred:function(e){return this.config.service(e)},_makeServiceCall:function(e,t,n){var a=this,r=function(e){n.data=e,e&&(e.publicData||e.userData)&&(n.value=i.extend({},e.publicData,e.userData)),t.resolve(n)};return a.getServiceDeferred(e,t).done(r).fail(function(e){if(0!==e.status){try{e.responseText=JSON.parse(e.responseText)}catch(i){e.responseText={message:e.statusText}}n.data=e,t.reject(n);var r=e.responseText;a.fire("error",r)}}),t},resolve:function(e){var t=e.$config,a=n.resolve(e.$config),s={url:a,dataType:"json",$scope:t,converters:{"text json":o}},l={ajaxConfig:s,config:t};if("DELETE"===t.$actionType)s.type="POST",s.contentType="application/json; charset=utf-8",s.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override","DELETE")};else if(t.$value){var u=i.clone(t.$value);u.userData=r.convertJsonNode(u.userData),u.publicData=r.convertJsonNode(u.publicData),s.type="POST",s.contentType="application/json; charset=utf-8",s.data=JSON.stringify(u)}return this._makeServiceCall(s,e,l)},select:function(e,t){return t.$group=e,this.resolveDeferred(t)},remove:function(e,n){n.$group=e,n.$actionType="DELETE",this.fire("beforeRemove",n);var a=t.Deferred();return a.$config=n,a.always(i.bind(function(){this.fire("afterRemove",n)},this,n)),this.resolve(a),a},data:function(e,n,a,r){if(!e)throw new Error("group is required");i.isObject(n)&&(a=n,n=null),!a||a.hasOwnProperty("publicData")||a.hasOwnProperty("userData")||(a={userData:a}),r=i.extend({},r,{$group:e,$key:n,$value:a});var s={};
s=n?{before:"beforeUpdate",after:"afterUpdate"}:{before:"beforeInsert",after:"afterInsert"},this.fire(s.before,r);var o=t.Deferred();return o.$config=r,o.always(i.bind(function(){this.fire(s.after,r)},this,r)),this.resolve(o)},createDeferredCall:function(e){var i=t.Deferred();return i.$config=e,i},resolveDeferred:function(e){return this.resolve(this.createDeferredCall(e))}});return a.implementOn(l.prototype),l}),define("tau/storage/api",["./api.nocache","jQuery","Underscore"],function(e,t,i){return e.extend({_cache:{},_getCacheKey:function(e,t){var n=this,a=e.url.toLowerCase(),r=t.$config.$key||t.$config.key,s=t.$config.$group||t.$config.group;if(s&&r&&(a=this._createCacheNameFromGroupAndKey(s,r)),r||"POST"!==e.type||(a=null),"POST"===e.type||"DELETE"===e.type){var o=n._cache[n.getGroupCacheKey(s)];if(o){var l=i.keys(o);i.each(l,function(e){delete n._cache[e]}),delete n._cache[n.getGroupCacheKey(s)]}}return a},_makeServiceCall:function(e,t,i){var n=this,a=this._getCacheKey(e,t);return e.type&&"GET"!==e.type||!n._cache.hasOwnProperty(a)?(a&&(n._cache[a]=t),this._super(e,t,i)):n._cache[a]},getGroupCacheKey:function(e){return("group_cache_"+e).toLowerCase()},getServiceDeferred:function(e,t){return this._super(e).done(function(i){this._trySaveCacheByGroupAndKey(i,t)||this._saveCacheByGroupOrUrl(e,t)}.bind(this)).fail(function(){var i=this._getCacheKey(e,t);i&&delete this._cache[i]}.bind(this))},_trySaveCacheByGroupAndKey:function(e,t){return e&&e.group&&e.key?(this._cache[this._createCacheNameFromGroupAndKey(e.group.name,e.key)]=t,!0):!1},_saveCacheByGroupOrUrl:function(e,t){var i=t.$config.$group||t.$config.group,n=this.getGroupCacheKey(i);this._cache.hasOwnProperty(n)||(this._cache[n]={}),this._cache[n][e.url.toLowerCase()]={}},_createCacheNameFromGroupAndKey:function(e,t){return(e+"_"+t).toLowerCase()}})}),define("tau/libs/boardSettings/model.settings.storage",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=function(t,i){var n=new Array(t.length);return function(a){var r=a.uid;
n[r]=a.data,t=e.without(t,r),0===t.length&&i(n)}},a=function(e,t){return function(i){e.callback(i),t.resolve(i)}};return i.extend({init:function(i,n){this.settings=e.defaults(i,{cache:!0}),this.sources=n,this.callbacksMap=[],this.responses=[],this.fieldsRetrieved=[],this.onChange=t.Callbacks(),this.commonCallback=e.bind(function(e,t){var i=this.mergeChanges(e.data,t);if(null!==i){var n=e.cmd||{};this._onBeforeRetrieve(i),this.applyCallback(i,n.isSilent)}},this)},getGroupName:function(){return this.settings.groupName},applyCallback:function(t,i){for(var n=e.keys(t),a=e.clone(this.callbacksMap),r=0;r<a.length;r++){var s=a[r];s.isDeleted||i&&!s.skipSilentCallsFiltering||!this.matchCommandCallback(n,s)||s.callback.call(s.listener,t)}},matchCommandCallback:function(t,i){var n=i.fields;return e.any(t,function(t){return e.indexOf(n,t)>=0})},each:function(t,i){this.sources.length?e.each(this.sources,t):i&&i()},mergeChanges:function(t,i){for(var n=this.settings,a=e.keys(t),r=null,s=0;s<a.length;s++){var o=a[s];this.markFieldsRetrieved(o);var l=t[o];if(!e.isEqual(n[o],l)){r=r||{};var u=e.cloneDeep(l);e.isNumber(i)&&(this.responses[i]=this.responses[i]||{},this.responses[i][o]=u,u=this.getField(o)),r[o]=n[o]=u}}return r},_isValue:function(t){return!e.isNull(t)&&!e.isUndefined(t)&&!e.isNaN(t)},getField:function(e){for(var t=this.responses.length-1;t>=0;t--){var i=(this.responses[t]||{})[e];if(this._isValue(i))return i}},markFieldsRetrieved:function(t){t=e.isString(t)?[t]:t,this.fieldsRetrieved=e.union(this.fieldsRetrieved,t)},selectNotRetrievedFields:function(t){return this.settings.cache?e.difference(t,this.fieldsRetrieved):t},_cmdDefaults:function(i){e.defaults(i,{callback:t.noop,onReceived:t.noop,failure:t.noop})},_onBeforeRetrieve:function(){},_onBeforeSave:function(){},get:function(i){e.isArray(i)&&(i={fields:i}),this._cmdDefaults(i);var r=t.Deferred(),s=a(i,r),o=this.settings,l={},u=e.range(this.sources.length),c=this.selectNotRetrievedFields(i.fields),d=this,p=function(i){d.markFieldsRetrieved(c),e.each(i,function(t,i){d.responses[i]=e.extend(d.responses[i]||{},t);
for(var n=0;n<c.length;n++){var a=c[n],r=null===t[a]?o[a]:t[a];d._isValue(r)&&(l[a]=r)}}),e.extend(o,l);var n={};t.extend(!0,n,o),this._onBeforeRetrieve(n),s(n)}.bind(this);if(0===c.length)p([]);else{var f=n(u,p);this.each(function(e,t){e.get({uid:t,fields:c,callback:f})},function(){p([])})}return r},set:function(i){var r=e.cloneDeep(i.set);this._onBeforeSave(r),this._cmdDefaults(i);var s=t.Deferred(),o=a(i,s),l=this.sources,u=e.range(l.length),c=function(){},d=n(u,c),p=this.mergeChanges(r),f=this;this.each(function(e,t){e.set({uid:t,set:r,_originalBoardData:i._originalBoardData,failure:function(e){f._mergeAndFireChanges(e.data.data,i),o(f.settings),i.failure(e)},callback:function(e){i.onReceived(e),d.call(this,e,t)}})},function(){c([])}),null!==p&&(this._onBeforeRetrieve(p),this.onChange.fire(p),this.applyCallback(p,i.isSilent));var m=e.clone(this.settings);return this._onBeforeRetrieve(m),o(m),s},_mergeAndFireChanges:function(e,t){var i=this.mergeChanges(e);null!==i&&(this._onBeforeRetrieve(i),this.onChange.fire(i),this.applyCallback(i,t.isSilent))},setDef:function(i){var n=e.cloneDeep(i.set);this._onBeforeSave(n);var a=this.sources;return t.when.apply(null,e.map(a,function(e){var i=t.Deferred();return e.set({uid:0,set:n,callback:i.resolve}),i})).done(e.bind(function(){this.commonCallback({data:n,cmd:i})},this))},registerSubscription:function(e){return this.callbacksMap.push(e),this.commonCallback},unregisterSubscription:function(t){this.callbacksMap.length&&(this.callbacksMap=e.reject(this.callbacksMap,function(e){var i=t===e.listener;return i&&(e.isDeleted=!0),i}))},bind:function(e){var t=this.registerSubscription(e);this.each(function(i,n){i.bind({uid:n,fields:e.fields,listener:e.listener,callback:function(e){t.call(this,e,n)}})})},_unbindListener:function(e){var t={listener:e};this.each(function(e){e.unbind(t)})},unbind:function(e){this._unbindListener(e.listener||e),this.unregisterSubscription(e.listener||e)},dispose:function(){this._unbindListener(this),this.callbacksMap=[]
}})}),define("tau/libs/boardSettings/model.definition.storage",["Underscore","jQuery","tau/libs/boardSettings/model.settings.storage"],function(e,t,i){return i.extend({_onBeforeRetrieve:function(t){if(t&&t.zoomLevel){if(!e.isObject(t.zoomLevel))throw Error("Invalid type of zoomLevel");var i=t.viewMode||this.settings.viewMode;if(!e.isString(i))throw Error("viewMode is not defined");for(var n=t.zoomLevel[i],a=e.keys(t.zoomLevel).sort(),r=0;r<a.length&&!e.isNumber(n);r++)n=t.zoomLevel[a[r]];e.isNumber(n)||(n=3),t.zoomLevel=n}},_onBeforeSave:function(t){if(t&&!e.isUndefined(t.zoomLevel)&&!e.isNull(t.zoomLevel)){var i=t.viewMode||this.settings.viewMode;if(!e.isString(i))throw Error("viewMode is not defined");var n=t.zoomLevel;if(e.isObject(n)&&e.isNumber(n[i]))return;if(!e.isNumber(n))throw Error("Invalid type of zoomLevel");t.zoomLevel=e.clone(this.settings.zoomLevel)||{},t.zoomLevel[i]=n}}})}),define("tau/core/async.source.adapter",["tau/core/class"],function(e){var t=function(e,t){if(!e.hasOwnProperty("uid"))throw"required parameter [uid] is missed in command";var i=e.callback,n=function(t){var n={uid:e.uid,data:t};i(n)};e.callback=n,t(e)};return e.extend({init:function(e){this.proxy=e},get:function(e){return t(e,this.proxy.onGet),this},set:function(e){return t(e,this.proxy.onSet),this},bind:function(e){return t(e,this.proxy.onBind),this},unbind:function(e){return this.proxy.onUnbind(e),this}})}),define("tau/libs/boardSettings/asyncSource.stateManager",["Underscore","tau/core/async.source.adapter"],function(e,t){var i=function(e,i){var n=e.getStateManager();return new t({onGet:function(e){n.get({id:i.id,fields:e.fields,callback:e.callback})},onSet:function(e){n.set({id:i.id,set:e.set,callback:e.callback})},onBind:function(e){var t=function(t){var i={};i[t.fieldName]=t.value,e.callback.call(this,i)};n.bind({paramId:i.id,fieldName:e.fields[0],callback:t,listener:e.listener})},onUnbind:function(e){n.unbind(e.listener)}})};return{create:i}}),define("tau/libs/boardSettings/asyncSource.componentSpecific",["Underscore","tau/core/async.source.adapter"],function(e,t){var i=function(e,i){var n=e.getRestStorage();
return new t({onGet:function(e){n.data(i.groupName,i.id).done(function(t){var i=t.data||{};i=i.userData||{};for(var n={},a=0;a<e.fields.length;a++){var r=e.fields[a];i.hasOwnProperty(r)&&(n[r]=i[r])}e.callback(n)})},onSet:function(e){var t=e.set;n.data(i.groupName,i.id,{scope:"Public",userData:t}).done(function(){e.callback(t)})},onBind:function(){},onUnbind:function(){}})};return{create:i}}),define("tau/libs/boardSettings/asyncSource.boardSpecific",["Underscore","tau/core/async.source.adapter"],function(e,t){var i=function(e,i){var n=e.getBoardApiService();return new t({onGet:function(e){n.getBoardData(i.id).done(function(t){for(var i=t.data,n={},a=0;a<e.fields.length;a++){var r=e.fields[a];i.hasOwnProperty(r)&&(n[r]=i[r])}e.callback(n)})},onSet:function(e){var t=e.set;t.isDraft=!1,n.setBoardData(i.id,t,e._originalBoardData).done(function(){e.callback(t)}).fail(function(t){e.failure({data:{data:e._originalBoardData,uid:e.uid},response:t})})},onBind:function(){},onUnbind:function(){}})};return{create:i}}),define("tau/libs/boardSettings/asyncSource.url",["Underscore","tau/core/async.source.adapter","libs/parseUri"],function(e,t,i){return{create:function(e){return new t({onGet:function(t){for(var n=e.getExternal().getHref(),a=i(n),r={},s=0;s<t.fields.length;s++){var o=t.fields[s];a.queryKey.hasOwnProperty(o)&&(r[o]=a.queryKey[o])}t.callback(r)},onSet:function(){},onBind:function(){},onUnbind:function(){}})}}}),define("tau/libs/boardSettings/asyncSource.acid",["Underscore","tau/core/async.source.adapter"],function(e,t){return{create:function(e){return new t({onGet:function(e){e.callback({})},onSet:function(t){t.set.acid&&e.getApplicationContextService().setCurrentAcid(t.set.acid)},onBind:function(){},onUnbind:function(){}})}}}),define("tau/libs/boardSettings/asyncSource.static",["Underscore","tau/core/async.source.adapter"],function(e,t){var i=function(){var i={};return new t({onGet:function(t){var n={};e.each(t.fields,function(e){i.hasOwnProperty(e)&&(n[e]=i[e])}),t.callback(n)
},onSet:function(t){var n=t.set;e.each(n,function(e,t){i[t]=e}),t.callback(n)},onBind:function(){},onUnbind:function(){}})};return{create:i}}),define("tau/libs/boardSettings/factory.board.settings",["Underscore","tau/core/class","tau/libs/boardSettings/model.settings.storage","tau/libs/boardSettings/model.definition.storage","tau/libs/boardSettings/asyncSource.stateManager","tau/libs/boardSettings/asyncSource.componentSpecific","tau/libs/boardSettings/asyncSource.boardSpecific","tau/libs/boardSettings/asyncSource.url","tau/libs/boardSettings/asyncSource.acid","tau/libs/boardSettings/asyncSource.static"],function(e,t,i,n,a,r,s,o,l,u){return t.extend({init:function(e){this.serviceContainer=e},create:function(t){return e.isObject(t)||(t={id:t}),e.defaults(t,this.serviceContainer.getBoardSettingsOptions()),this.createInstance(t)},createInstance:function(e){var t=[],i=this.serviceContainer;return i.isBoardEdition||t.push(a.create(i,e)),t.push(s.create(i,e)),new n(e,t)},createComponentSettings:function(t){var n=[],s=this.serviceContainer;return e.defaults(t,{groupName:"settings"}),n.push(r.create(s,t)),s.isBoardEdition||n.push(a.create(s,t)),new i(t,n)},createAcidSettings:function(t){t=e.defaults(t,{cache:!1});var n=this.serviceContainer;return new i(t,[o.create(n,t),a.create(n,t),l.create(n,t)])},createStaticSettings:function(e){return new i(e,[u.create()])},clear:function(){}})}),define("tau/utils/utils.serverErrorTranslator",["Underscore","jQuery"],function(e,t){function i(e,i,n){var a=t("<span>"+i.join(" ")+"</span>");if(e.loggedUser.isAdministrator){var r=e.getTp2Service();a.on("click","a",function(){r.showPopupToChangeProcessWorkflow(e,t(this),n.EntityType,n.Process.Id)})}return a}var n=[{name:"StateIsNotAllowedByWorkflowException",isMatch:function(t){return/BadRequestException$/i.test(t.Type)&&(e.isObject(t.Error)&&/StateIsNotAllowedByWorkflowException/i.test(t.Error.Type)||e.isObject(t.InnerException)&&/StateIsNotAllowedByWorkflowException/i.test(t.InnerException.Type))
},buildError:function(e){var t=this.config.context.configurator,n=e.InnerException||e.Error,a=n.Details,r=["Possible transitions are:",a.StateName,"&rarr;",a.NextStates.join(", ")+"."];t.loggedUser.isAdministrator&&r.push("You can edit the workflow for",'<a href="#">'+a.Process.Name+"</a> process.");var s=i(t,r,a);return{message:e.Message,details:s}}},{name:"NotWellFormedLangExpressionException",isMatch:function(t){return/BadRequestException$/i.test(t.Type)&&(e.isObject(t.Error)&&/NotWellFormedLangExpressionException$/i.test(t.Error.Type)||e.isObject(t.InnerException)&&/NotWellFormedLangExpressionException$/i.test(t.InnerException.Type))},buildError:function(e){var t=e.InnerException||e.Error,i=t.Details,n=e.Message,a=i.Message;return{message:n,details:a}}},{name:"General HttpException",isMatch:function(t){return/\.HttpException$/i.test(t.Type)&&(e.isObject(t.InnerException)&&t.InnerException.Message||e.isObject(t.Error)&&t.Error.Message)},buildError:function(e){var t=e.InnerException||e.Error;return{message:e.Message,details:t.Message}}},{name:"NoStatesDefinedInProcessException",isMatch:function(t){return/BadRequestException$/i.test(t.Type)&&(e.isObject(t.InnerException)&&/NoStatesDefinedInProcessException/i.test(t.InnerException.Type)||e.isObject(t.Error)&&/NoStatesDefinedInProcessException/i.test(t.Error.Type))},buildError:function(e){var t=this.config.context.configurator,n=e.InnerException||e.Error,a=n.Details,r=[];t.loggedUser.isAdministrator&&r.push("You can add",a.StateDescription,"manually to the",a.EntityName,"workflow.","Edit the workflow for",'<a href="#">'+a.Process.Name+"</a> process.");var s=i(t,r,a);return{message:e.Message,details:s}}},{name:"HttpError",isMatch:function(t){return t.data?e.has(t.data,"response"):!1},buildError:function(e){return a.buildError(e.data.response)}}],a={name:"default",buildError:function(t){if(!t)return{};var i=t.message||"Looks like application is not available. Please check your connection or server availability";i=e.isObject(t)&&e.isString(t.Message)?t.Message:i;
var n=e.isObject(t.InnerException)&&e.isString(t.InnerException.Details)?t.InnerException.Details:e.isObject(t.Error)&&e.isString(t.Error.Details)?t.Error.Details:void 0;return{message:i,details:n}}};return{translateServerError:function(t){var i=e.find(n,function(e){return e.isMatch(t)})||a;return i.buildError.call(this,t)},parseXhrError:function(e){try{return t.parseJSON(e.responseText)}catch(i){return{message:e.statusText}}},translateXhrError:function(e){var t=this.parseXhrError(e);return this.translateServerError(t)}}}),define("template",["text"],function(e){var t={},i={version:"0.0.3",_parseHeader:function(e,t){var i=/^<!--\s*name:\s*([-\w\.]+)(?:,\s*fn:\s*([-\w\./]+))?(?:,\s*deps:\s*\[([-\w\./!,\s]+)\])?\s*-->/,n=t.match(i)||[],a=n[3]?n[3].split(/,\s*/):void 0;return{name:n[1]||e.replace(/^.+\//,"").replace(/^(?:ui\.)?template\./,""),fn:n[2],dependencies:a}},_createDependenciesForDefine:function(e){var t=["tau/core/templates-factory"];return e.fn&&t.push(e.fn),e.dependencies&&e.dependencies.length&&(t=t.concat(e.dependencies)),JSON.stringify(t)},_createFunctionParameterList:function(e){return e.fn?"function(templates, fn)":"function(templates)"},_extractMarkup:function(e){return e=e.replace(/^<!--.+?-->[\s\r\n]*/,"").replace(/\r?\n\s*/g," ").replace(/[\s\r\n]+$/,""),JSON.stringify(e)},load:function(n,a,r,s){var o=".html",l=n+o,u=function(e){try{var a=i._parseHeader(n,e),o=['name: "'+a.name+'"','engine: "jqote2"',"customFunctions: "+(a.fn?"fn":"null"),"markup: "+i._extractMarkup(e)];e=["define("+i._createDependenciesForDefine(a)+", "+i._createFunctionParameterList(a)+" {","var config = {",o.join(s.isBuild?", ":",\n"),"};","return templates.register(config);","});"].join(s.isBuild?"":"\n")}catch(u){r.error(u),e=e+"\n"+u}s.isBuild?t[n]=e:e=e+"\n//# sourceURL="+location.protocol+"//"+location.hostname+s.baseUrl+l,r.fromText(e)};e.load(l,a,u,s)},write:function(e,i,n){if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i];n(a.replace(/^define\(\[/,"define('"+e+"!"+i+"', ["))
}}};return i}),define("tau/core/termProcessor",["Underscore","tau/core/class","tau/store/types.targetprocess"],function(e,t,i){var n=/\$\{(.+?)(?:,(.*?))?(?:,(.*?))?\}/gi,a={lower:function(e){return e.toLowerCase()},camel:e.titleize,capital:e.capitalize,upper:function(e){return e.toUpperCase()},id:function(e){return e}},r={icon:function(e,t){return'<em class="tau-entity-icon tau-entity-icon--icon tau-entity-icon--'+t.toLowerCase().replace(" ","")+'">'+e+"</em>"},abbr:function(t,i,n){return t==("names"==n?e.pluralize(i):i)?t:'<abbr title="'+i+'">'+t+"</abbr>"},id:function(e){return e}};return t.extend({keys:["name","names","iconSmall","iconBig"],init:function(t){this.registry={},e.forEach(i._dictionary,function(i,n){i.terms&&(this.registry[n]=e.inject(this.keys,function(n,a){var r=i.terms[a],s=e.findWhere(t,{wordKey:r.key});return"iconSmall"===a?(n[a]=this.getShortAbbreviation(n.name),n):"iconBig"===a?(n[a]=this.getLongAbbreviation(n.name),n):(n[a]=s?s.value:r.val,n)},{},this))},this)},getTerm:function(e,t){var i=this.getTerms(e);return i?i[t]||i.name:""},getShortAbbreviation:function(t){var i="";t=t||"",t=t.replace(/\s\s+/i," ");var n=e.trim(t).split(" ");return n[0]&&(i=n[0][0].toUpperCase(),n[1]&&(i+=n[1][0].toUpperCase())),i},getLongAbbreviation:function(e){return e},getTerms:function(e){return this.registry[e]},resolve:function(e,t){return this.getTerm(e,"name")||t||e},replaceTermTags:function(t,i){return t?t.replace(n,function(t,n,s,o){var l=n.replace(" ","").toLowerCase();o=o||"name";var u=this.getTerm(l,o)||n,c=a[s||""]||a.id,d=c(u),p=(e.isFunction(i)?i:r[i])||r.id;return p(d,n,o)}.bind(this)):t}})}),function(){var e,t=void 0,i=!0,n=null,a=!1,r=["aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,snow,springgreen,steelblue,tan,teal,thistle,tomato,transparent,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen".split(","),"all-scroll,col-resize,crosshair,default,e-resize,hand,help,move,n-resize,ne-resize,no-drop,not-allowed,nw-resize,pointer,progress,row-resize,s-resize,se-resize,sw-resize,text,vertical-text,w-resize,wait".split(","),"armenian,decimal,decimal-leading-zero,disc,georgian,lower-alpha,lower-greek,lower-latin,lower-roman,square,upper-alpha,upper-latin,upper-roman".split(","),"100,200,300,400,500,600,700,800,900,bold,bolder,lighter".split(","),"block-level,inline-level,table-caption,table-cell,table-column,table-column-group,table-footer-group,table-header-group,table-row,table-row-group".split(","),"condensed,expanded,extra-condensed,extra-expanded,narrower,semi-condensed,semi-expanded,ultra-condensed,ultra-expanded,wider".split(","),"inherit,inline,inline-block,inline-box,inline-flex,inline-grid,inline-list-item,inline-stack,inline-table,run-in".split(","),"behind,center-left,center-right,far-left,far-right,left-side,leftwards,right-side,rightwards".split(","),"large,larger,small,smaller,x-large,x-small,xx-large,xx-small".split(","),"dashed,dotted,double,groove,outset,ridge,solid".split(","),"ease,ease-in,ease-in-out,ease-out,linear,step-end,step-start".split(","),"at,closest-corner,closest-side,ellipse,farthest-corner,farthest-side".split(","),"baseline,middle,sub,super,text-bottom,text-top".split(","),"caption,icon,menu,message-box,small-caption,status-bar".split(","),"fast,faster,slow,slower,x-fast,x-slow".split(","),["above","below","higher","level","lower"],["cursive","fantasy","monospace","sans-serif","serif"],["loud","silent","soft","x-loud","x-soft"],["no-repeat","repeat-x","repeat-y","round","space"],["blink","line-through","overline","underline"],["block","flex","grid","table"],["high","low","x-high","x-low"],["nowrap","pre","pre-line","pre-wrap"],["absolute","relative","static"],["alternate","alternate-reverse","reverse"],["border-box","content-box","padding-box"],["capitalize","lowercase","uppercase"],["child","female","male"],["=","opacity"],["backwards","forwards"],["bidi-override","embed"],["bottom","top"],["break-all","keep-all"],["clip","ellipsis"],["contain","cover"],["continuous","digits"],["end","start"],["flat","preserve-3d"],["hide","show"],["horizontal","vertical"],["inside","outside"],["italic","oblique"],["left","right"],["ltr","rtl"],["no-content","no-display"],["paused","running"],["suppress","unrestricted"],["thick","thin"],[","],["/"],["all"],["always"],["auto"],["avoid"],["both"],["break-word"],["center"],["circle"],["code"],["collapse"],["contents"],["fixed"],["hidden"],["infinite"],["inset"],["invert"],["justify"],["list-item"],["local"],["medium"],["mix"],["none"],["normal"],["once"],["repeat"],["scroll"],["separate"],["small-caps"],["spell-out"],["to"],["visible"]],s={animation:{cssPropBits:517,cssLitGroup:[r[10],r[24],r[29],r[45],r[48],r[54],r[63],r[71],r[72]],cssFns:["cubic-bezier()","steps()"]},"animation-delay":{cssPropBits:5,cssLitGroup:[r[48]],cssFns:[]},"animation-direction":{cssPropBits:0,cssLitGroup:[r[24],r[48],r[72]],cssFns:[]},"animation-duration":"animation-delay","animation-fill-mode":{cssPropBits:0,cssLitGroup:[r[29],r[48],r[54],r[71]],cssFns:[]},"animation-iteration-count":{cssPropBits:5,cssLitGroup:[r[48],r[63]],cssFns:[]},"animation-name":{cssPropBits:512,cssLitGroup:[r[48],r[71]],cssFns:[]},"animation-play-state":{cssPropBits:0,cssLitGroup:[r[45],r[48]],cssFns:[]},"animation-timing-function":{cssPropBits:0,cssLitGroup:[r[10],r[48]],cssFns:["cubic-bezier()","steps()"]},appearance:{cssPropBits:0,cssLitGroup:[r[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[r[7],r[42],r[56]],cssFns:[]},"backface-visibility":{cssPropBits:0,cssLitGroup:[r[59],r[62],r[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[r[0],r[18],r[25],r[31],r[34],r[42],r[48],r[49],r[52],r[56],r[61],r[68],r[71],r[74],r[75]],cssFns:"image(),linear-gradient(),radial-gradient(),repeating-linear-gradient(),repeating-radial-gradient(),rgb(),rgba()".split(",")},"background-attachment":{cssPropBits:0,cssLitGroup:[r[48],r[61],r[68],r[75]],cssFns:[]},"background-color":{cssPropBits:2,cssLitGroup:[r[0]],cssFns:["rgb()","rgba()"]},"background-image":{cssPropBits:16,cssLitGroup:[r[48],r[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"background-position":{cssPropBits:5,cssLitGroup:[r[31],r[42],r[48],r[56]],cssFns:[]},"background-repeat":{cssPropBits:0,cssLitGroup:[r[18],r[48],r[74]],cssFns:[]},"background-size":{cssPropBits:5,cssLitGroup:[r[34],r[48],r[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[r[0],r[9],r[47],r[62],r[64],r[69],r[71]],cssFns:["rgb()","rgba()"]},"border-bottom":"border","border-bottom-color":"background-color","border-bottom-left-radius":{cssPropBits:5,cssFns:[]},"border-bottom-right-radius":"border-bottom-left-radius","border-bottom-style":{cssPropBits:0,cssLitGroup:[r[9],r[62],r[64],r[71]],cssFns:[]},"border-bottom-width":{cssPropBits:5,cssLitGroup:[r[47],r[69]],cssFns:[]},"border-collapse":{cssPropBits:0,cssLitGroup:[r[59],r[76]],cssFns:[]},"border-color":"background-color","border-left":"border","border-left-color":"background-color","border-left-style":"border-bottom-style","border-left-width":"border-bottom-width","border-radius":{cssPropBits:5,cssLitGroup:[r[49]],cssFns:[]},"border-right":"border","border-right-color":"background-color","border-right-style":"border-bottom-style","border-right-width":"border-bottom-width","border-spacing":"border-bottom-left-radius","border-style":"border-bottom-style","border-top":"border","border-top-color":"background-color","border-top-left-radius":"border-bottom-left-radius","border-top-right-radius":"border-bottom-left-radius","border-top-style":"border-bottom-style","border-top-width":"border-bottom-width","border-width":"border-bottom-width",bottom:{cssPropBits:5,cssLitGroup:[r[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[r[60],r[71],r[72]],cssFns:[]},"box-shadow":{cssPropBits:7,cssLitGroup:[r[0],r[48],r[64],r[71]],cssFns:["rgb()","rgba()"]},"box-sizing":{cssPropBits:0,cssLitGroup:[r[25]],cssFns:[]},"caption-side":{cssPropBits:0,cssLitGroup:[r[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[r[42],r[54],r[71]],cssFns:[]},clip:{cssPropBits:0,cssLitGroup:[r[52]],cssFns:["rect()"]},color:"background-color",content:{cssPropBits:8,cssLitGroup:[r[71],r[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[r[71]],cssFns:[]},"cue-after":"cue","cue-before":"cue",cursor:{cssPropBits:16,cssLitGroup:[r[1],r[48],r[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[r[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[r[4],r[6],r[20],r[52],r[67],r[71]],cssFns:[]},"display-extras":{cssPropBits:0,cssLitGroup:[r[67],r[71]],cssFns:[]},"display-inside":{cssPropBits:0,cssLitGroup:[r[20],r[52]],cssFns:[]},"display-outside":{cssPropBits:0,cssLitGroup:[r[4],r[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[r[15]],cssFns:[]},"empty-cells":{cssPropBits:0,cssLitGroup:[r[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:["alpha()"]},"float":{cssPropBits:0,cssLitGroup:[r[42],r[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[r[3],r[8],r[13],r[16],r[41],r[48],r[49],r[69],r[72],r[77]],cssFns:[]},"font-family":{cssPropBits:72,cssLitGroup:[r[16],r[48]],cssFns:[]},"font-size":{cssPropBits:1,cssLitGroup:[r[8],r[69]],cssFns:[]},"font-stretch":{cssPropBits:0,cssLitGroup:[r[5],r[72]],cssFns:[]},"font-style":{cssPropBits:0,cssLitGroup:[r[41],r[72]],cssFns:[]},"font-variant":{cssPropBits:0,cssLitGroup:[r[72],r[77]],cssFns:[]},"font-weight":{cssPropBits:0,cssLitGroup:[r[3],r[72]],cssFns:[]},height:"bottom",left:"bottom","letter-spacing":{cssPropBits:5,cssLitGroup:[r[72]],cssFns:[]},"line-height":{cssPropBits:1,cssLitGroup:[r[72]],cssFns:[]},"list-style":{cssPropBits:16,cssLitGroup:[r[2],r[40],r[57],r[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-image":{cssPropBits:16,cssLitGroup:[r[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-position":{cssPropBits:0,cssLitGroup:[r[40]],cssFns:[]},"list-style-type":{cssPropBits:0,cssLitGroup:[r[2],r[57],r[71]],cssFns:[]},margin:"bottom","margin-bottom":"bottom","margin-left":"bottom","margin-right":"bottom","margin-top":"bottom","max-height":{cssPropBits:1,cssLitGroup:[r[52],r[71]],cssFns:[]},"max-width":"max-height","min-height":{cssPropBits:1,cssLitGroup:[r[52]],cssFns:[]},"min-width":"min-height",opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[r[0],r[9],r[47],r[62],r[64],r[65],r[69],r[71]],cssFns:["rgb()","rgba()"]},"outline-color":{cssPropBits:2,cssLitGroup:[r[0],r[65]],cssFns:["rgb()","rgba()"]},"outline-style":"border-bottom-style","outline-width":"border-bottom-width",overflow:{cssPropBits:0,cssLitGroup:[r[52],r[62],r[75],r[80]],cssFns:[]},"overflow-wrap":{cssPropBits:0,cssLitGroup:[r[55],r[72]],cssFns:[]},"overflow-x":{cssPropBits:0,cssLitGroup:[r[44],r[52],r[62],r[75],r[80]],cssFns:[]},"overflow-y":"overflow-x",padding:"opacity","padding-bottom":"opacity","padding-left":"opacity","padding-right":"opacity","padding-top":"opacity","page-break-after":{cssPropBits:0,cssLitGroup:[r[42],r[51],r[52],r[53]],cssFns:[]},"page-break-before":"page-break-after","page-break-inside":{cssPropBits:0,cssLitGroup:[r[52],r[53]],cssFns:[]},pause:"border-bottom-left-radius","pause-after":"border-bottom-left-radius","pause-before":"border-bottom-left-radius",perspective:{cssPropBits:5,cssLitGroup:[r[71]],cssFns:[]},"perspective-origin":{cssPropBits:5,cssLitGroup:[r[31],r[42],r[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[r[21],r[69]],cssFns:[]},"pitch-range":"border-bottom-left-radius","play-during":{cssPropBits:16,cssLitGroup:[r[52],r[70],r[71],r[74]],cssFns:[]},position:{cssPropBits:0,cssLitGroup:[r[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[r[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[r[39],r[54],r[71]],cssFns:[]},richness:"border-bottom-left-radius",right:"bottom",speak:{cssPropBits:0,cssLitGroup:[r[71],r[72],r[78]],cssFns:[]},"speak-header":{cssPropBits:0,cssLitGroup:[r[51],r[73]],cssFns:[]},"speak-numeral":{cssPropBits:0,cssLitGroup:[r[35]],cssFns:[]},"speak-punctuation":{cssPropBits:0,cssLitGroup:[r[58],r[71]],cssFns:[]},"speech-rate":{cssPropBits:5,cssLitGroup:[r[14],r[69]],cssFns:[]},stress:"border-bottom-left-radius","table-layout":{cssPropBits:0,cssLitGroup:[r[52],r[61]],cssFns:[]},"text-align":{cssPropBits:0,cssLitGroup:[r[42],r[56],r[66]],cssFns:[]},"text-decoration":{cssPropBits:0,cssLitGroup:[r[19],r[71]],cssFns:[]},"text-indent":"border-bottom-left-radius","text-overflow":{cssPropBits:8,cssLitGroup:[r[33]],cssFns:[]},"text-shadow":"box-shadow","text-transform":{cssPropBits:0,cssLitGroup:[r[26],r[71]],cssFns:[]},"text-wrap":{cssPropBits:0,cssLitGroup:[r[46],r[71],r[72]],cssFns:[]},top:"bottom",transform:{cssPropBits:0,cssLitGroup:[r[71]],cssFns:"matrix(),perspective(),rotate(),rotate3d(),rotatex(),rotatey(),rotatez(),scale(),scale3d(),scalex(),scaley(),scalez(),skew(),skewx(),skewy(),translate(),translate3d(),translatex(),translatey(),translatez()".split(",")},"transform-origin":"perspective-origin","transform-style":{cssPropBits:0,cssLitGroup:[r[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[r[10],r[48],r[50],r[71]],cssFns:["cubic-bezier()","steps()"]},"transition-delay":"animation-delay","transition-duration":"animation-delay","transition-property":{cssPropBits:1024,cssLitGroup:[r[48],r[50]],cssFns:[]},"transition-timing-function":"animation-timing-function","unicode-bidi":{cssPropBits:0,cssLitGroup:[r[30],r[72]],cssFns:[]},"vertical-align":{cssPropBits:5,cssLitGroup:[r[12],r[31]],cssFns:[]},visibility:"backface-visibility","voice-family":{cssPropBits:8,cssLitGroup:[r[27],r[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[r[17],r[69]],cssFns:[]},"white-space":{cssPropBits:0,cssLitGroup:[r[22],r[72]],cssFns:[]},width:"min-height","word-break":{cssPropBits:0,cssLitGroup:[r[32],r[72]],cssFns:[]},"word-spacing":"letter-spacing","word-wrap":"overflow-wrap","z-index":"bottom",zoom:"line-height","cubic-bezier()":"animation-delay","steps()":{cssPropBits:5,cssLitGroup:[r[36],r[48]],cssFns:[]},"image()":{cssPropBits:18,cssLitGroup:[r[0],r[48]],cssFns:["rgb()","rgba()"]},"linear-gradient()":{cssPropBits:7,cssLitGroup:[r[0],r[31],r[42],r[48],r[79]],cssFns:["rgb()","rgba()"]},"radial-gradient()":{cssPropBits:7,cssLitGroup:[r[0],r[11],r[31],r[42],r[48],r[56],r[57]],cssFns:["rgb()","rgba()"]},"repeating-linear-gradient()":"linear-gradient()","repeating-radial-gradient()":"radial-gradient()","rgb()":{cssPropBits:1,cssLitGroup:[r[48]],cssFns:[]},"rgba()":"rgb()","rect()":{cssPropBits:5,cssLitGroup:[r[48],r[52]],cssFns:[]},"alpha()":{cssPropBits:1,cssLitGroup:[r[28]],cssFns:[]},"matrix()":"animation-delay","perspective()":"border-bottom-left-radius","rotate()":"border-bottom-left-radius","rotate3d()":"animation-delay","rotatex()":"border-bottom-left-radius","rotatey()":"border-bottom-left-radius","rotatez()":"border-bottom-left-radius","scale()":"animation-delay","scale3d()":"animation-delay","scalex()":"border-bottom-left-radius","scaley()":"border-bottom-left-radius","scalez()":"border-bottom-left-radius","skew()":"animation-delay","skewx()":"border-bottom-left-radius","skewy()":"border-bottom-left-radius","translate()":"animation-delay","translate3d()":"animation-delay","translatex()":"border-bottom-left-radius","translatey()":"border-bottom-left-radius","translatez()":"border-bottom-left-radius"};
for(e in s)"string"==typeof s[e]&&Object.hasOwnProperty.call(s,e)&&(s[e]=s[s[e]]);"undefined"!=typeof window&&(window.cssSchema=s);var o,l;!function(){function e(e){var t=parseInt(e.substring(1),16);return t>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):t==t?String.fromCharCode(t):" ">e[1]?"":e[1]}function t(e,t){return'"'+e.replace(/[\u0000-\u001f\\\"<>]/g,t)+'"'}function i(e){return a[e]||(a[e]="\\"+e.charCodeAt(0).toString(16)+" ")}function n(e){return r[e]||(r[e]=("">e?"%0":"%")+e.charCodeAt(0).toString(16))}var a={"\\":"\\\\"},r={"\\":"%5c"},s=RegExp("\\uFEFF|U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?|url[(][\\t\\n\\f ]*(?:\"(?:'|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*\"|'(?:\"|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*'|(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*)[\\t\\n\\f ]*[)]|(?!url[(])-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*[(]|(?:@?-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))|#)(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*|\"(?:'|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*\"|'(?:\"|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*'|[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)(?:%|-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*)?|<!--|-->|[\\t\\n\\f ]+|/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)|[~|^$*]=|[^\"'\\\\/]|/(?![/*])","gi"),u=RegExp("\\\\(?:(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff])|[\\n\\f])","g"),c=RegExp("^url\\([\\t\\n\\f ]*[\"']?|[\"']?[\\t\\n\\f ]*\\)$","gi");
l=function(t){return t.replace(u,e)},o=function(e){for(var e=(""+e).replace(/\r\n?/g,"\n").match(s)||[],a=0,r=" ",o=0,u=e.length;u>o;++o){var d=l(e[o]),p=d.length,f=d.charCodeAt(0),d=34==f||39==f?t(d.substring(1,p-1),i):47==f&&p>1||"\\"==d||"-->"==d||"<!--"==d||""==d||32>=f?" ":/url\(/i.test(d)?"url("+t(d.replace(c,""),n)+")":d;(r!=d||" "!=d)&&(e[a++]=r=d)}return e.length=a,e}}(),"undefined"!=typeof window&&(window.lexCss=o,window.decodeCss=l);var u=function(){function e(e){return e=(""+e).match(c),e?new s(o(e[1]),o(e[2]),o(e[3]),o(e[4]),o(e[5]),o(e[6]),o(e[7])):n}function t(e,t){return"string"==typeof e?encodeURI(e).replace(t,i):n}function i(e){return e=e.charCodeAt(0),"%"+"0123456789ABCDEF".charAt(e>>4&15)+"0123456789ABCDEF".charAt(15&e)}function a(e){if(e===n)return n;for(var t,e=e.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/"),i=l;(t=e.replace(i,"$1"))!=e;e=t);return e}function r(e,t){var i=e.T(),n=t.K();n?i.ga(t.j):n=t.X(),n?i.da(t.n):n=t.Y(),n?i.ea(t.k):n=t.$();var r=t.g,s=a(r);if(n)i.ca(t.V()),s=s&&s.replace(u,"");else if(n=!!r){if(47!==s.charCodeAt(0))var s=a(i.g||"").replace(u,""),o=s.lastIndexOf("/")+1,s=a((o?s.substring(0,o):"")+a(r)).replace(u,"")}else s=s&&s.replace(u,""),s!==r&&i.G(s);return n?i.G(s):n=t.aa(),n?i.O(t.l):n=t.Z(),n&&i.fa(t.o),i}function s(e,t,i,n,a,r,s){this.j=e,this.n=t,this.k=i,this.h=n,this.g=a,this.l=r,this.o=s}function o(e){return"string"==typeof e&&0<e.length?e:n}var l=RegExp(/(\/|^)(?:[^./][^/]*|\.{2,}(?:[^./][^/]*)|\.{3,}[^/]*)\/\.\.(?:\/|$)/),u=/^(?:\.\.\/)*(?:\.\.$)?/;s.prototype.toString=function(){var e=[];return n!==this.j&&e.push(this.j,":"),n!==this.k&&(e.push("//"),n!==this.n&&e.push(this.n,"@"),e.push(this.k),n!==this.h&&e.push(":",this.h.toString())),n!==this.g&&e.push(this.g),n!==this.l&&e.push("?",this.l),n!==this.o&&e.push("#",this.o),e.join("")},s.prototype.T=function(){return new s(this.j,this.n,this.k,this.h,this.g,this.l,this.o)},s.prototype.W=function(){return this.j&&decodeURIComponent(this.j).toLowerCase()
},s.prototype.ga=function(e){this.j=e?e:n},s.prototype.K=function(){return n!==this.j},s.prototype.da=function(e){this.n=e?e:n},s.prototype.X=function(){return n!==this.n},s.prototype.ea=function(e){this.k=e?e:n,this.G(this.g)},s.prototype.Y=function(){return n!==this.k},s.prototype.V=function(){return this.h&&decodeURIComponent(this.h)},s.prototype.ca=function(e){if(e){if(e=Number(e),e!==(65535&e))throw Error("Bad port number "+e);this.h=""+e}else this.h=n},s.prototype.$=function(){return n!==this.h},s.prototype.U=function(){return this.g&&decodeURIComponent(this.g)},s.prototype.G=function(e){e?(e=""+e,this.g=!this.k||/^\//.test(e)?e:"/"+e):this.g=n},s.prototype.O=function(e){this.l=e?e:n},s.prototype.aa=function(){return n!==this.l},s.prototype.ba=function(e){if("object"==typeof e&&!(e instanceof Array)&&(e instanceof Object||"[object Array]"!==Object.prototype.toString.call(e))){var t,i=[],n=-1;for(t in e){var a=e[t];"string"==typeof a&&(i[++n]=t,i[++n]=a)}e=i}for(var i=[],n="",r=0;r<e.length;)t=e[r++],a=e[r++],i.push(n,encodeURIComponent(t.toString())),n="&",a&&i.push("=",encodeURIComponent(a.toString()));this.l=i.join("")},s.prototype.fa=function(e){this.o=e?e:n},s.prototype.Z=function(){return n!==this.o};var c=/^(?:([^:/?#]+):)?(?:\/\/(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,d=/[#\/\?@]/g,p=/[\#\?]/g;return s.parse=e,s.create=function(e,a,r,o,l,u,c){return e=new s(t(e,d),t(a,d),"string"==typeof r?encodeURIComponent(r):n,o>0?o.toString():n,t(l,p),n,"string"==typeof c?encodeURIComponent(c):n),u&&("string"==typeof u?e.O(u.replace(/[^?&=0-9A-Za-z_\-~.%]/g,i)):e.ba(u)),e},s.N=r,s.ma=a,s.ha={ua:function(t){return/\.html$/.test(e(t).U())?"text/html":"application/javascript"},N:function(t,i){return t?r(e(t),e(i)).toString():""+i}},s}();"undefined"!=typeof window&&(window.URI=u);var c=t,d=t,p=t,f=t;!function(){function e(e){return"string"==typeof e?'url("'+e.replace(b,r)+'")':'url("about:blank")'}function r(e){return y[e]}function o(e,t){return e?u.ha.N(e,t):t
}function h(e,t,i){if(!i)return n;var a=(""+e).match(_);return!a||a[1]&&!x.test(a[1])?n:i(e,t)}function v(e){return e.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,"")}var b=/[\n\f\r\"\'()*<>]/g,y={"\n":"%0a","\f":"%0c","\r":"%0d",'"':"%22","'":"%27","(":"%28",")":"%29","*":"%2a","<":"%3c",">":"%3e"},_=/^(?:([^:/?# ]+):)?/,x=/^(?:https?|mailto)$/i;c=function(){var t={};return function i(n,a,r,u,c){var n=v(n),d=s[n];if(d&&"object"==typeof d){for(var p=d.cssPropBits,f=80&p,m=1536&p,g=0/0,b=0,y=0;b<a.length;++b){var _,x,w,C,S,T,k=a[b].toLowerCase(),I=k.charCodeAt(0);if(32===I)k="";else if(34===I)k=16===f?r?e(h(o(u,l(a[b].substring(1,k.length-1))),n,r)):"":8&p&&!(f&f-1)?k:"";else if("inherit"!==k){if(S=d.cssLitGroup){var D;if(!(D=d.cssLitMap)){D={};for(var P=S.length;0<=--P;)for(var E=S[P],R=E.length;0<=--R;)D[E[R]]=t;D=d.cssLitMap=D}S=D}else S=t;if(T=S,!(T[v(k)]===t))if(35===I&&/^#(?:[0-9a-f]{3}){1,2}$/.test(k))k=2&p?k:"";else if(I>=48&&57>=I)k=1&p?k:"";else if(_=k.charCodeAt(1),x=k.charCodeAt(2),w=_>=48&&57>=_,C=x>=48&&57>=x,43===I&&(w||46===_&&C))k=1&p?(w?"":"0")+k.substring(1):"";else if(45===I&&(w||46===_&&C))k=4&p?(w?"-":"-0")+k.substring(1):1&p?"0":"";else if(46===I&&w)k=1&p?"0"+k:"";else if('url("'===k.substring(0,5))k=r&&16&p?e(h(o(u,a[b].substring(5,k.length-2)),n,r)):"";else if("("===k.charAt(k.length-1))e:{for(S=a,D=b,k=1,P=D+1,I=S.length;I>P&&k;)E=S[P++],k+=")"===E?-1:/^[^"']*\($/.test(E);if(!k)for(k=S[D].toLowerCase(),I=v(k),S=S.splice(D,P-D,""),D=d.cssFns,P=0,E=D.length;E>P;++P)if(D[P].substring(0,I.length)==I){S[0]=S[S.length-1]="",i(D[P],S,r,u),k=k+S.join(" ")+")";break e}k=""}else k=m&&/^-?[a-z_][\w\-]*$/.test(k)&&!/__$/.test(k)?c&&512===m?a[b]+c:1024===m&&s[k]&&"number"==typeof s[k].oa?k:"":/^\w+$/.test(k)&&64===f&&8&p?g+1===y?(a[g]=a[g].substring(0,a[g].length-1)+" "+k+'"',""):(g=y,'"'+k+'"'):""}k&&(a[y++]=k)}1===y&&'url("about:blank")'===a[0]&&(y=0),a.length=y}else a.length=0}}();var w=RegExp("^(active|after|before|blank|checked|default|disabled|drop|empty|enabled|first|first-child|first-letter|first-line|first-of-type|fullscreen|focus|hover|in-range|indeterminate|invalid|last-child|last-of-type|left|link|only-child|only-of-type|optional|out-of-range|placeholder-shown|read-only|read-write|required|right|root|scope|user-error|valid|visited)$"),C={};
C[">"]=C["+"]=C["~"]=C,d=function(e,t,r){function s(s,o){function l(n,r,s){var o,l,u,p,m,h=i;o="",r>n&&(m=e[n],"*"===m?(++n,o=m):/^[a-zA-Z]/.test(m)&&(l=d(m.toLowerCase(),[]))&&("tagName"in l&&(m=l.tagName),++n,o=m));for(p=u=l="";h&&r>n;++n)if(m=e[n],"#"===m.charAt(0))/^#_|__$|[^\w#:\-]/.test(m)?h=a:l+=m+c;else if("."===m)++n<r&&/^[0-9A-Za-z:_\-]+$/.test(m=e[n])&&!/^_|__$/.test(m)?l+="."+m:h=a;else if(r>n+1&&"["===e[n]){++n;var v=e[n++].toLowerCase();m=g.m[o+"::"+v],m!==+m&&(m=g.m["*::"+v]);var b;t.ia?(b=t.ia(o,v),"string"!=typeof b&&(h=a,b=v),h&&m!==+m&&(m=g.d.NONE)):(b=v,m!==+m&&(h=a));var y=v="",_=a;switch(/^[~^$*|]?=$/.test(e[n])&&(v=e[n++],y=e[n++],/^[0-9A-Za-z:_\-]+$/.test(y)?y='"'+y+'"':"]"===y&&(y='""',--n),/^"([^\"\\]|\\.)*"$/.test(y)||(h=a),(_="i"===e[n])&&++n),"]"!==e[n]&&(++n,h=a),m){case g.d.CLASSES:case g.d.LOCAL_NAME:case g.d.NONE:break;case g.d.GLOBAL_NAME:case g.d.ID:case g.d.IDREF:"="!==v&&"~="!==v&&"$="!==v||'""'==y||_?"|="===v||""===v||(h=a):y='"'+y.substring(1,y.length-1)+c+'"';break;case g.d.URI:case g.d.URI_FRAGMENT:""!==v&&(h=a);break;default:h=a}h&&(u+="["+b.replace(/[^\w-]/g,"\\$&")+v+y+(_?" i]":"]"))}else{if(!(r>n&&":"===e[n]))break;if(m=e[++n],!w.test(m))break;p+=":"+m}return n!==r&&(h=a),h&&(n=(o+l).replace(/[^ .*#\w-]/g,"\\$&")+u+p+s)&&f.push(n),h}" "===e[s]&&++s,o-1!==s&&" "===e[o]&&--o;for(var f=[],m=s,h=i,v=s;h&&o>v;++v){var b=e[v];(C[b]===C||" "===b)&&(l(m,v,b)?m=v+1:h=a)}return l(m,o,"")||(h=a),h?(f.length&&(m=f.join(""),u!==n&&(m="."+u+" "+m),p.push(m)),i):!r||r(e.slice(s,o))}var o,l,u=t.na,c=t.L,d=t.Aa,p=[],f=0,m=0;for(o=0;o<e.length;++o)l=e[o],("("==l||"["==l?(++m,!i):")"==l||"]"==l?(m&&--m,!i):" "==e[o]&&(m||C[e[o-1]]===C||C[e[o+1]]===C))||(e[f++]=e[o]);for(e.length=f,f=e.length,o=m=0;f>o;++o)if(","===e[o]){if(!s(m,o))return n;m=o+1}return s(m,f)?p:n},function(){var e=/^\w/,t=RegExp("^(?:(?:(?:(?:only|not) )?(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)|\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))(?: and ?\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))*)(?: , (?:(?:(?:(?:only|not) )?(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)|\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))(?: and ?\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))*))*$","i");
f=function(i){for(var i=i.slice(),n=i.length,a=0,r=0;n>r;++r){var s=i[r];" "!=s&&(i[a++]=s)}return i.length=a,i=i.join(" "),i=i.length?t.test(i)?e.test(i)?i:"not all , "+i:"not all":""}}(),function(){function e(e){var t,i=/^\s*[']([^']*)[']\s*$/,a=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/,r=/^\s*url\s*[(][']([^']*)['][)]\s*$/,s=/^\s*url\s*[(]([^)]*)[)]\s*$/;return(t=/^\s*["]([^"]*)["]\s*$/.exec(e))||(t=i.exec(e))||(t=a.exec(e))||(t=r.exec(e))||(t=s.exec(e))?t[1]:n}function r(s,l,u,p,g,v,b){function y(){C=w.length&&w[w.length-1]===n}var _=t,x=b||[0],w=[],C=a;return m(l,{startStylesheet:function(){_=[]},endStylesheet:function(){},startAtrule:function(t,i){if(C)t=n;else if("@media"===t)_.push("@media"," ",f(i));else if("@keyframes"===t||"@-webkit-keyframes"===t){var a=i[0];1!==i.length||/__$|[^\w\-]/.test(a)?t=n:(_.push(t," ",a+u.L),t="@keyframes")}else if("@import"===t&&0<i.length)if(t=n,"function"==typeof v){var l=f(i.slice(1));if("not all"!==l){++x[0];var c=[];_.push(c);var d=h(o(s,e(i[0])),function(e){var t=r(d,e.qa,u,p,g,v,x);--x[0],e=l?{toString:function(){return"@media "+l+" {"+t.result+"}"}}:t.result,c[0]=e,v(e,!!x[0])},g)}}else window.console&&window.console.log("@import "+i.join(" ")+" elided");C=!t,w.push(t)},endAtrule:function(){w.pop(),C||_.push(";"),y()},startBlock:function(){C||_.push("{")},endBlock:function(){C||(_.push("}"),C=i)},startRuleset:function(e){if(!C){var a=t;"@keyframes"===w[w.length-1]?(a=e.join(" ").match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i),C=!a,a&&(a=a[0].replace(/ +/g,""))):(e=d(e,u),e&&e.length?a=e.join(", "):C=i),C||_.push(a,"{")}w.push(n)},endRuleset:function(){w.pop(),C||_.push("}"),y()},declaration:function(e,t){if(!C){var n=a,r=t.length;r>=2&&"!"===t[r-2]&&"important"===t[r-1].toLowerCase()&&(n=i,t.length-=2),c(e,t,p,s,u.L),t.length&&_.push(e,":",t.join(" "),n?" !important;":";")}}}),{result:{toString:function(){return _.join("")}},va:!!x[0]}}p=function(e,i,n,a){return r(e,i,n,a,t,t).result.toString()}
}()}(),"undefined"!=typeof window&&(window.sanitizeCssProperty=c,window.sanitizeCssSelectorList=d,window.sanitizeStylesheet=p,window.sanitizeMediaQuery=f);var m,h;!function(){function e(e,i,n,a,r){for(var s=i++;n>i&&"{"!==e[i]&&";"!==e[i];)++i;if(n>i&&(r||";"===e[i])){var r=s+1,o=i;n>r&&" "===e[r]&&++r,o>r&&" "===e[o-1]&&--o,a.startAtrule&&a.startAtrule(e[s].toLowerCase(),e.slice(r,o)),i="{"===e[i]?t(e,i,n,a):i+1,a.endAtrule&&a.endAtrule()}return i}function t(i,r,s,o){for(++r,o.startBlock&&o.startBlock();s>r;){var l=i[r].charAt(0);if("}"==l){++r;break}r=" "===l||";"===l?r+1:"@"===l?e(i,r,s,o,a):"{"===l?t(i,r,s,o):n(i,r,s,o)}return o.endBlock&&o.endBlock(),r}function n(e,t,n,a){var s=t,o=r(e,t,n,i);if(0>o)return o=~o,o===s?o+1:o;var u=e[o];if("{"!==u)return o===s?o+1:o;for(t=o+1,o>s&&" "===e[o-1]&&--o,a.startRuleset&&a.startRuleset(e.slice(s,o));n>t;){if(u=e[t],"}"===u){++t;break}t=" "===u?t+1:l(e,t,n,a)}return a.endRuleset&&a.endRuleset(),t}function r(e,t,i,n){for(var a,r=[],s=-1;i>t;++t)if(a=e[t].charAt(0),"["===a||"("===a)r[++s]=a;else if("]"===a&&"["===r[s]||")"===a&&"("===r[s])--s;else if("{"===a||"}"===a||";"===a||"@"===a||":"===a&&!n)break;return s>=0&&(t=~(t+1)),t}function s(e,t,i){for(;i>t&&";"!==e[t]&&"}"!==e[t];)++t;return i>t&&";"===e[t]?t+1:t}function l(e,t,i,n){var o=e[t++];if(!u.test(o))return s(e,t,i);if(i>t&&" "===e[t]&&++t,t==i||":"!==e[t])return s(e,t,i);++t,i>t&&" "===e[t]&&++t;var l=r(e,t,i,a);if(0>l)l=~l;else{for(var c=[],d=0,p=t;l>p;++p)t=e[p]," "!==t&&(c[d++]=t);if(i>l){do{if(t=e[l],";"===t||"}"===t)break;d=0}while(++l<i);";"===t&&++l}d&&n.declaration&&n.declaration(o.toLowerCase(),c)}return l}m=function(t,a){var r=o(t);a.startStylesheet&&a.startStylesheet();for(var s=0,l=r.length;l>s;)s=" "===r[s]?s+1:l>s?"@"===r[s].charAt(0)?e(r,s,l,a,i):n(r,s,l,a):s;a.endStylesheet&&a.endStylesheet()};var u=/^-?[a-z]/i;h=function(e,t){for(var i=o(e),n=0,a=i.length;a>n;)n=" "!==i[n]?l(i,n,a,t):n+1}}(),"undefined"!=typeof window&&(window.parseCssStylesheet=m,window.parseCssDeclarations=h);
var g={d:{NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13}};g.atype=g.d,g.m={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onerror":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::ontouchcancel":2,"*::ontouchend":2,"*::ontouchenter":2,"*::ontouchleave":2,"*::ontouchmove":2,"*::ontouchstart":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::tabindex":0,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,"audio::muted":0,"audio::preload":0,"audio::src":1,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::pattern":0,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,"textarea::rows":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::src":1,"video::width":0},g.ATTRIBS=g.m,g.c={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256},g.eflags=g.c,g.f={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,"var":0,video:0,wbr:2},g.ELEMENTS=g.f,g.Q={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement","var":"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"},g.ELEMENT_DOM_INTERFACES=g.Q,g.P={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2},g.ueffects=g.P,g.J={"a::href":2,"area::href":2,"audio::src":1,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1,"video::src":1},g.URIEFFECTS=g.J,g.M={UNSANDBOXED:2,SANDBOXED:1,DATA:0},g.ltypes=g.M,g.I={"a::href":2,"area::href":2,"audio::src":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1,"video::src":2},g.LOADERTYPES=g.I,"undefined"!=typeof window&&(window.html4=g);
var v=function(e){function r(e){if(T.hasOwnProperty(e))return T[e];var t=e.match(k);return t?String.fromCharCode(parseInt(t[1],10)):(t=e.match(I))?String.fromCharCode(parseInt(t[1],16)):P&&D.test(e)?(P.innerHTML="&"+e+";",t=P.textContent,T[e]=t):"&"+e+";"}function s(e,t){return r(t)}function o(e){return e.replace(R,s)}function l(e){return(""+e).replace(F,"&amp;").replace(N,"&lt;").replace(j,"&gt;").replace(L,"&#34;")}function c(e){return e.replace(M,"&amp;$1").replace(N,"&lt;").replace(j,"&gt;")}function d(e){var t={z:e.z||e.cdata,A:e.A||e.comment,B:e.B||e.endDoc,t:e.t||e.endTag,e:e.e||e.pcdata,F:e.F||e.rcdata,H:e.H||e.startDoc,w:e.w||e.startTag};return function(e,i){var r,s=/(<\/|<\!--|<[!?]|[&<>])/g;if(r=e+"",B)r=r.split(s);else{for(var o,l=[],u=0;(o=s.exec(r))!==n;)l.push(r.substring(u,o.index)),l.push(o[0]),u=o.index+o[0].length;l.push(r.substring(u)),r=l}f(t,r,0,{r:a,C:a},i)}}function p(e,t,i,n,a){return function(){f(e,t,i,n,a)}}function f(t,n,a,r,s){try{t.H&&0==a&&t.H(s);for(var o,l,u,c=n.length;c>a;){var d=n[a++],f=n[a];switch(d){case"&":A.test(f)?(t.e&&t.e("&"+f,s,$,p(t,n,a,r,s)),a++):t.e&&t.e("&amp;",s,$,p(t,n,a,r,s));break;case"</":if(o=/^([-\w:]+)[^\'\"]*/.exec(f))if(o[0].length===f.length&&">"===n[a+1])a+=2,u=o[1].toLowerCase(),t.t&&t.t(u,s,$,p(t,n,a,r,s));else{var g=n,v=a,b=t,y=s,_=$,x=r,w=h(g,v);w?(b.t&&b.t(w.name,y,_,p(b,g,v,x,y)),a=w.next):a=g.length}else t.e&&t.e("&lt;/",s,$,p(t,n,a,r,s));break;case"<":if(o=/^([-\w:]+)\s*\/?/.exec(f))if(o[0].length===f.length&&">"===n[a+1]){a+=2,u=o[1].toLowerCase(),t.w&&t.w(u,[],s,$,p(t,n,a,r,s));var C=e.f[u];C&O&&(a=m(n,{name:u,next:a,c:C},t,s,$,r))}else{var g=n,v=t,b=s,y=$,_=r,S=h(g,a);S?(v.w&&v.w(S.name,S.R,b,y,p(v,g,S.next,_,b)),a=S.c&O?m(g,S,v,b,y,_):S.next):a=g.length}else t.e&&t.e("&lt;",s,$,p(t,n,a,r,s));break;case"<!--":if(!r.C){for(l=a+1;c>l&&(">"!==n[l]||!/--$/.test(n[l-1]));l++);if(c>l){if(t.A){var T=n.slice(a,l).join("");t.A(T.substr(0,T.length-2),s,$,p(t,n,l+1,r,s))}a=l+1}else r.C=i}r.C&&t.e&&t.e("&lt;!--",s,$,p(t,n,a,r,s));
break;case"<!":if(/^\w/.test(f)){if(!r.r){for(l=a+1;c>l&&">"!==n[l];l++);c>l?a=l+1:r.r=i}r.r&&t.e&&t.e("&lt;!",s,$,p(t,n,a,r,s))}else t.e&&t.e("&lt;!",s,$,p(t,n,a,r,s));break;case"<?":if(!r.r){for(l=a+1;c>l&&">"!==n[l];l++);c>l?a=l+1:r.r=i}r.r&&t.e&&t.e("&lt;?",s,$,p(t,n,a,r,s));break;case">":t.e&&t.e("&gt;",s,$,p(t,n,a,r,s));break;case"":break;default:t.e&&t.e(d,s,$,p(t,n,a,r,s))}}t.B&&t.B(s)}catch(k){if(k!==$)throw k}}function m(t,i,n,a,r,s){var o=t.length;z.hasOwnProperty(i.name)||(z[i.name]=RegExp("^"+i.name+"(?:[\\s\\/]|$)","i"));for(var l=z[i.name],u=i.next,d=i.next+1;o>d&&("</"!==t[d-1]||!l.test(t[d]));d++);if(o>d&&(d-=1),o=t.slice(u,d).join(""),i.c&e.c.CDATA)n.z&&n.z(o,a,r,p(n,t,d,s,a));else{if(!(i.c&e.c.RCDATA))throw Error("bug");n.F&&n.F(c(o),a,r,p(n,t,d,s,a))}return d}function h(t,n){var r=/^([-\w:]+)/.exec(t[n]),s={};s.name=r[1].toLowerCase(),s.c=e.f[s.name];for(var l=t[n].substr(r[0].length),u=n+1,c=t.length;c>u&&">"!==t[u];u++)l+=t[u];if(!(u>=c)){for(var d=[];""!==l;)if(r=U.exec(l))if(r[4]&&!r[5]||r[6]&&!r[7]){for(var r=r[4]||r[6],p=a,l=[l,t[u++]];c>u;u++){if(p){if(">"===t[u])break}else 0<=t[u].indexOf(r)&&(p=i);l.push(t[u])}if(u>=c)break;l=l.join("")}else{var f,p=r[1].toLowerCase();if(r[2]){f=r[3];var m=f.charCodeAt(0);(34===m||39===m)&&(f=f.substr(1,f.length-2)),f=o(f.replace(E,""))}else f="";d.push(p,f),l=l.substr(r[0].length)}else l=l.replace(/^[\s\S][^a-z\s]*/,"");return s.R=d,s.next=u+1,s}}function g(i){function r(e,t){o||t.push(e)}var s,o;return d({startDoc:function(){s=[],o=a},startTag:function(a,r,u){if(!o&&e.f.hasOwnProperty(a)){var c=e.f[a];if(!(c&e.c.FOLDABLE)){var d=i(a,r);if(d){if("object"!=typeof d)throw Error("tagPolicy did not return object (old API?)");if(!("attribs"in d))throw Error("tagPolicy gave no attribs");r=d.attribs;var p;if("tagName"in d?(p=d.tagName,d=e.f[p]):(p=a,d=c),c&e.c.OPTIONAL_ENDTAG){var f=s[s.length-1];f&&f.D===a&&(f.v!==p||a!==p)&&u.push("</",f.v,">")}for(c&e.c.EMPTY||s.push({D:a,v:p}),u.push("<",p),a=0,f=r.length;f>a;a+=2){var m=r[a],h=r[a+1];
h!==n&&h!==t&&u.push(" ",m,'="',l(h),'"')}u.push(">"),c&e.c.EMPTY&&!(d&e.c.EMPTY)&&u.push("</",p,">")}else o=!(c&e.c.EMPTY)}}},endTag:function(t,i){if(o)o=a;else if(e.f.hasOwnProperty(t)){var n=e.f[t];if(!(n&(e.c.EMPTY|e.c.FOLDABLE))){if(n&e.c.OPTIONAL_ENDTAG)for(n=s.length;0<=--n;){var r=s[n].D;if(r===t)break;if(!(e.f[r]&e.c.OPTIONAL_ENDTAG))return}else for(n=s.length;0<=--n&&s[n].D!==t;);if(!(0>n)){for(r=s.length;--r>n;){var l=s[r].v;e.f[l]&e.c.OPTIONAL_ENDTAG||i.push("</",l,">")}n<s.length&&(t=s[n].v),s.length=n,i.push("</",t,">")}}}},pcdata:r,rcdata:r,cdata:r,endDoc:function(e){for(;s.length;s.length--)e.push("</",s[s.length-1].v,">")}})}function v(e,t,i,a,r){if(!r)return n;try{var s=u.parse(""+e);if(s&&(!s.K()||q.test(s.W()))){var o=r(s,t,i,a);return o?o.toString():n}}catch(l){}return n}function b(e,t,i,n,a){if(i||e(t+" removed",{S:"removed",tagName:t}),n!==a){var r="changed";n&&!a?r="removed":!n&&a&&(r="added"),e(t+"."+i+" "+r,{S:r,tagName:t,la:i,oldValue:n,newValue:a})}}function y(e,t,i){return t=t+"::"+i,e.hasOwnProperty(t)?e[t]:(t="*::"+i,e.hasOwnProperty(t)?e[t]:void 0)}function _(i,a,r,s,o){for(var l=0;l<a.length;l+=2){var u,c=a[l],d=a[l+1],p=d,f=n;if(u=i+"::"+c,(e.m.hasOwnProperty(u)||(u="*::"+c,e.m.hasOwnProperty(u)))&&(f=e.m[u]),f!==n)switch(f){case e.d.NONE:break;case e.d.SCRIPT:d=n,o&&b(o,i,c,p,d);break;case e.d.STYLE:if("undefined"==typeof C){d=n,o&&b(o,i,c,p,d);break}var m=[];C(d,{declaration:function(t,i){var a=t.toLowerCase();S(a,i,r?function(t){return v(t,e.P.ja,e.M.ka,{TYPE:"CSS",CSS_PROP:a},r)}:n),i.length&&m.push(a+": "+i.join(" "))}}),d=0<m.length?m.join(" ; "):n,o&&b(o,i,c,p,d);break;case e.d.ID:case e.d.IDREF:case e.d.IDREFS:case e.d.GLOBAL_NAME:case e.d.LOCAL_NAME:case e.d.CLASSES:d=s?s(d):d,o&&b(o,i,c,p,d);break;case e.d.URI:d=v(d,y(e.J,i,c),y(e.I,i,c),{TYPE:"MARKUP",XML_ATTR:c,XML_TAG:i},r),o&&b(o,i,c,p,d);break;case e.d.URI_FRAGMENT:d&&"#"===d.charAt(0)?(d=d.substring(1),d=s?s(d):d,d!==n&&d!==t&&(d="#"+d)):d=n,o&&b(o,i,c,p,d);break;default:d=n,o&&b(o,i,c,p,d)
}else d=n,o&&b(o,i,c,p,d);a[l+1]=d}return a}function x(i,n,a){return function(r,s){return e.f[r]&e.c.UNSAFE?void(a&&b(a,r,t,t,t)):{attribs:_(r,s,i,n,a)}}}function w(e,t){var i=[];return g(t)(e,i),i.join("")}var C,S;"undefined"!=typeof window&&(C=window.parseCssDeclarations,S=window.sanitizeCssProperty);var T={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:""},k=/^#(\d+)$/,I=/^#x([0-9A-Fa-f]+)$/,D=/^[A-Za-z][A-za-z0-9]+$/,P="undefined"!=typeof window&&window.document?window.document.createElement("textarea"):n,E=/\0/g,R=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,A=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,F=/&/g,M=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,N=/[<]/g,j=/>/g,L=/\"/g,U=/^\s*([-.:\w]+)(?:\s*(=)\s*((")[^"]*("|$)|(')[^']*('|$)|(?=[a-z][-\w]*\s*=)|[^"'\s]*))?/i,B=3==="a,b".split(/(,)/).length,O=e.c.CDATA|e.c.RCDATA,$={},z={},q=/^(?:https?|mailto)$/i,H={};return H.pa=H.escapeAttrib=l,H.ra=H.makeHtmlSanitizer=g,H.sa=H.makeSaxParser=d,H.ta=H.makeTagPolicy=x,H.wa=H.normalizeRCData=c,H.xa=H.sanitize=function(e,t,i,n){return w(e,x(t,i,n))},H.ya=H.sanitizeAttribs=_,H.za=H.sanitizeWithPolicy=w,H.Ba=H.unescapeEntities=o,H}(g),b=v.sanitize;"undefined"!=typeof window&&(window.html=v,window.html_sanitize=b)}(),define("libs/caja/html-css-sanitizer-minified",function(){}),define("libs/caja/caja-sanitizer",["libs/caja/html-css-sanitizer-minified"],function(){return function(e){return html_sanitize(e,function(e){return e})}}),define("tau/core/templates-factory",["Underscore","jQuery","tau/nls/translator","tau/core/termProcessor","libs/caja/caja-sanitizer"],function(e,t,i,n,a){var r={templates:{},termProcessor:new n,jqote2customFunctions:{sub:function(t,i){var n=r.get(t);e.isArray(i)||(i=[i]);for(var a=[],s=0,o=i.length;o>s;s++)a.push(n.render(null,i[s]));return a.join("")},term:function(t,i,n){return n||(n=r.termProcessor),e.asString(n.getTerm(t,i))},replaceTermTags:function(t,i){return i?r.termProcessor.replaceTermTags(t,i):e.asString(r.termProcessor.replaceTermTags(t))
},cond:function(e,t,i){return(e?t:i)||""},uid:function(t){return e.uniqueId(t||"uid")},_:e,$:t,translate:i,T:i,sanitize:a},setTermProcessor:function(e){this.termProcessor=e},getTermProcessor:function(){return this.termProcessor},get:function(e){var t=this.templates[e];if(!t)throw new Error('Template "'+e+'" was not registered.');return this[t.engine+".get"](e)},"jquery.get":function(i){var n=this;if(!t.template.hasOwnProperty(i))throw new Error('jQuery template "'+i+'" was not found.');var a=function(i,n){var r=t.template(i);n=n||this.data,e.isArray(n)||(n=[n]);for(var s=[],o=0,l=n.length;l>o;o++){var u=r(t,{data:n[o],nest:a});s.push(u.join(""))}return s.join("")};return{render:function(e,t){return a(i,t)},bind:function(e,a){for(var r={},s=n.templates[i],o=s.tags||[],l=0;l<o.length;l++){var u=o[l];u.register(e,r)}var c=t.template[i];return t.tmpl(c,a,r)}}},"jqote2.get":function(i){var n=this.templates[i];if(!n.jqotecmpl)throw new Error('Template "'+i+'" was not compiled.');return{config:n,render:e.bind(function(t,i){var a=n.customFunctions||{};e.extend(a,this.jqote2customFunctions),e.isFunction(n.pre)&&(i=n.pre(i));var r=n.jqotecmpl.call(i,0,0,[i],a);return e.isFunction(n.post)&&(r=n.post(r,i)),r},this),bind:function(e,i){var n=this.render(e,i);return t(n)},bindPure:function(e,t){return this.render(e,t)}}},registerRecursively:function(i,n){n=n||{tags:[]};var a=this.templates[i];if(!a)throw new Error('Template "'+i+'" was not found.');a.tags&&(n.tags=n.tags.concat(a.tags)),t.template.hasOwnProperty(i)||(e.each(a.dependencies||[],function(e){this.registerRecursively(e,n)},this),a.tags=n.tags,t.template(i,a.markup))},"jquery.register":function(e){this.registerRecursively(e.name)},"jqote2.register":function(e){try{e.jqotecmpl=t.jqotec(e.markup)}catch(i){throw new Error('Error in template "'+e.name+'": '+i.message)}},register:function(t){t.markup=e.isArray(t.markup)?t.markup.join(""):t.markup,t.engine=t.engine||"jquery";var i=t.name;return this.templates[i]=t,this[t.engine+".register"](t),{name:i,options:t.options||{},get:this.get.bind(this,i),render:function(e){return this.get(i).bind({},e)
}.bind(this)}}};return r}),define("template!tau/components/board.menu/templates/board.menu.undelete.template",["tau/core/templates-factory"],function(e){var t={name:"board.menu.undelete",engine:"jqote2",customFunctions:null,markup:'<div> <h3>View <%! this.name %> has been deleted.</h3> <p><a class="i-role-undo" style="text-decoration: underline;">Undelete</a></p> </div>'};return e.register(t)}),define("tau/services/boards/service.boards.operations",["require","tau/core/class","Underscore","jQuery","tau/utils/utils.serverErrorTranslator","template!tau/components/board.menu/templates/board.menu.undelete.template"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n=e("jQuery"),a=e("tau/utils/utils.serverErrorTranslator"),r=e("template!tau/components/board.menu/templates/board.menu.undelete.template"),s="current";return t.extend({init:function(e,t,i,n,a,r,s){this._bus=e,this._errorBarService=t,this._configurator=i,this._viewsMenuService=n,this._urlBuilder=a,this._routing=r,this._history=s},createBoardAndRedirect:function(){var e=this._configurator.getBoardDefinitionFactory();return e.createBoard().done(function(e){this._bus.fire("add.board",{board:{id:e.id}}),this._configurator.setConfig("tmpBoardIsJustAdded",!0),this.redirectToBoard(e.id)}.bind(this))},createViewGroup:function(){var e=this._configurator.getBoardDefinitionFactory();return e.createViewGroup().done(function(e){this._bus.fire("add.board.group",{boardGroup:{id:e.key}})}.bind(this))},removeBoard:function(e,t){var i=t||this._getCurrentAcid();return this._viewsMenuService.boardsApi.getViewMenuItem(e).then(function(t){return n.when(t.data,this._viewsMenuService.boardsApi.removeViewMenuItem(e))}.bind(this)).fail(function(e){this._errorBarService.fire("error",a.translateXhrError(e))}.bind(this)).then(function(t){this._bus.fire("remove.board",{board:{id:e}}),this._history.exclude(e),this._showUndeleteMessage(t,i)}.bind(this))},removeBoardAndRedirect:function(e,t,i,n){i=i||s;var a=this.removeBoard(e,t);return this.redirectToBoard(i,n),a
},_showUndeleteMessage:function(e,t){var i=r.render(e);i.on("click",".i-role-undo",function(){var i=e.key||e.id;this._viewsMenuService.boardsApi.restoreViewMenuItem(i,e).done(function(){this.redirectToBoard(i,t)}.bind(this))}.bind(this)),this._errorBarService.fire("notification",{id:"board.removed",className:"tau-system-message-success",$node:i,delay:1e4,disableAutoClose:!1})},_getCurrentAcid:function(){return this._configurator.getAppStateStore().settings.acid},redirectToBoard:function(e,t){var i=this._urlBuilder.getRelativeBoardUrl(e,t);this._routing.redirect(i)},redirectToDefaultBoard:function(){this.redirectToBoard(s)},getNextBoardAfterDeleted:function(e,t){var n=i.chain(e).filter(function(e){return e.key!==t}).groupBy(function(e){return!!e.menuIsVisible}).value(),a=n[!0]||[];return a.length||(a=n[!1]||[]),a[0]}})}),define("tau/services/boards/service.views.menu.utils",["require","tau/storage/api.nocache","tau/storage/api","jQuery","Underscore"],function(e){var t=e("tau/storage/api.nocache"),i=e("tau/storage/api"),n=e("jQuery"),a=e("Underscore"),r={makeServiceCall:function(e){var t=e.$scope||{},i=n.Deferred();return i.$config=t,this._makeServiceCall(e,i,{ajaxConfig:e,config:t}).then(function(e){return e.value=e.data,e})}},s=t.extend(r),o=i.extend(r).extend({init:function(e,t,i){this._super(e),this._storageGroupName=t,this._storageKeyName=i},clearCache:function(){this._cache={}},_trySaveCacheByGroupAndKey:function(e,t){if(e&&e.key){var i=this._storageKeyName+e.key;return this._cache[this._createCacheNameFromGroupAndKey(this._storageGroupName,i)]=t,!0}return!1},saveCacheByGroupAndKey:function(e,t){this._trySaveCacheByGroupAndKey(e,n.Deferred().resolve(t))},mergeCacheByGroupAndKey:function(e){var t=this._storageKeyName+e.key,i=this._createCacheNameFromGroupAndKey(this._storageGroupName,t),n=this._cache[i];n&&"resolved"==n.state()&&n.done(function(t){a.extend(t.data,e)})},clearCacheForViewItem:function(e){var t=this._storageKeyName+e;delete this._cache[this._createCacheNameFromGroupAndKey(this._storageGroupName,t)]
},createStoreRequestConfig:function(e){var t={$group:this._storageGroupName};return e&&(t.$key=this._storageKeyName+e),t}});return{NoCacheStorageApiFacade:s,StorageApiFacade:o}}),define("tau/services/boards/service.views.menu.item.api",["require","Underscore","tau/core/event","tau/core/class","app.path","tau/utils/utils.api","./service.views.menu.utils"],function(e){var t=e("Underscore"),i=e("tau/core/event"),n=e("tau/core/class"),a=e("app.path"),r=e("tau/utils/utils.api"),s=e("./service.views.menu.utils");return i.extend(n.extend({init:function(e){this._storage=new s.StorageApiFacade(e.storageConfig,e.storageKeyPrefix,e.storageKeyPrefix+"_id_"),this._noCacheStorage=new s.NoCacheStorageApiFacade(e.storageConfig),this._itemType=e.itemType,this._apiItemType=e.apiItemType,this._clientId=e.clientId},createViewMenuItem:function(e){return this._setItemDataInternal("",e).then(function(e){return this._notifyItemCreated(e.data),e}.bind(this))},getViewMenuItem:function(e){var t=this._storage.createStoreRequestConfig(e),i=this._createApiAjaxConfig(e,t);return this._storage.makeServiceCall(i)},updateViewMenuItem:function(e,i,n){n&&this._notifyItemUpdating(t.extend({key:e},i));var a=t.union(t.keys(i),["key"]);return this._setItemDataInternal(e,i).fail(function(){n&&this._notifyItemUpdated(t.extend({key:e},n))}.bind(this)).then(function(e){return this._notifyItemUpdated(e.data,a),e}.bind(this))},removeViewMenuItem:function(e){this._notifyItemRemoving(e);var t=this._storage.createStoreRequestConfig(e),i=this._createApiAjaxConfig(e).url,n=r.createDeleteAjaxCommandConfig({url:i,data:JSON.stringify({clientId:this._clientId})});return n.$scope=t,this._storage.makeServiceCall(n).then(this._storage.clearCacheForViewItem.bind(this._storage,e)).then(this._notifyItemRemoved.bind(this,e))},restoreViewMenuItem:function(e,t){return this.updateViewMenuItem(e,t).then(function(e){return this._notifyItemRestored(e.data),e}.bind(this))},prioritizeViewMenuItem:function(e,t,i){var n={url:a.get()+"/api/views/v1/prioritize/"+this._apiItemType,type:"POST",data:{itemId:e,targetItemId:t,placeAfter:!!i,clientId:this._clientId}};
return this._noCacheStorage.makeServiceCall(n)},setViewMenuItemCache:function(e){var t=this._storage.createStoreRequestConfig(e.key),i=this._createApiAjaxConfig(e.key,t),n={ajaxConfig:i,config:t,data:e,value:e};this._storage.saveCacheByGroupAndKey(e,n)},mergeViewMenuItemCache:function(e){this._storage.mergeCacheByGroupAndKey(e)},setViewMenuItemCollectionCache:function(e){t.each(e,this.setViewMenuItemCache,this)},clearViewMenuItemCollectionCache:function(){this._storage.clearCache()},clearCacheForViewMenuItem:function(e){this._storage.clearCacheForViewItem(e)},_setItemDataInternal:function(e,i){i=t.deepClone(i),i.clientId=this._clientId;var n=this._storage.createStoreRequestConfig(e);n.$value=i;var a=this._createApiAjaxConfig(e,n);return a.type="POST",a.data=JSON.stringify(i),this._storage.makeServiceCall(a)},_createApiAjaxConfig:function(e,t){return{url:a.get()+"/api/views/v1/"+this._apiItemType+"/"+e,contentType:"application/json; charset=utf-8",dataType:"json",$scope:t,type:"GET"}},_notifyItemCreated:function(e){this._notifyBase("service.views.api.created",e)},_notifyItemUpdating:function(e){this._notifyBase("service.views.api.updating",e)},_notifyItemUpdated:function(e,i){var n=i&&i.length?t.pick(e,i):e;this._notifyBase("service.views.api.updated",n)},_notifyItemRemoving:function(e){this._notifyBase("service.views.api.removing",e)},_notifyItemRemoved:function(e){this._notifyBase("service.views.api.removed",e)},_notifyItemRestored:function(e){this._notifyBase("service.views.api.restored",e)},_notifyBase:function(e,t){this.fire(e,{type:this._itemType,data:t}),this.fire(e+"."+this._itemType,t)}}))}),define("tau/services/boards/service.boards.api",["require","tau/services/boards/service.views.menu.item.api"],function(e){var t=e("tau/services/boards/service.views.menu.item.api");return t.extend({init:function(e,t){this._super({storageConfig:e,storageKeyPrefix:"__board_legacy",itemType:"board",apiItemType:"board",clientId:t.clientId})},createBoard:function(e){return this.createViewMenuItem(e)
},setBoardData:function(e,t,i){return this.updateViewMenuItem(e,t,i)},getBoardData:function(e){return this.getViewMenuItem(e)},removeBoard:function(e){return this.removeViewMenuItem(e)}})}),define("tau/services/boards/service.views.groups.api",["require","./service.views.menu.item.api"],function(e){var t=e("./service.views.menu.item.api");return t.extend({init:function(e,t){this._super({storageConfig:e,storageKeyPrefix:"__board_group_legacy",itemType:"group",apiItemType:"group",clientId:t.clientId})}})}),define("tau/utils/utils.debug",["Underscore"],function(e){function t(t){return window.appIsInDebugMode?e.isFunction(t)?!t():!t:!1}function i(e,t){var i=Array.prototype.slice.call(t,1);Function.prototype.apply.call(e||console.log,console,i)}return{assertWarn:function(e){t(e)&&i(console.warn,arguments)},assertError:function(e){t(e)&&i(console.error,arguments)}}}),define("tau/components/board.menu/models/board.menu.constants",["require"],function(){return{FAVORITES_GROUP_KEY:"___FICTIVE_FAVORITES_GROUP__KEY___",UNGROUPED_GROUP_KEY:"___FICTIVE_UNGROUPED_GROUP__KEY___",FAVORITES_GROUP_TYPE:"favorite",UNGROUPED_GROUP_TYPE:"ungrouped",FAVORITES_SECTION_TYPE:"favorites",OTHERS_SECTION_TYPE:"other"}}),define("tau/components/board.menu/services/board.menu.transformations.service",["require","Underscore"],function(e){var t=e("Underscore");return{applyBoardFilter:function(e,i){if(!i)return e;i=i.replace(/([^\w\s])/g,"\\$1").split("").join(".*");var n=new RegExp(i,"i");return t.filter(e,function(e){return n.test(e.name)})},getVisibleBoards:function(e,i){var n=this.applyBoardFilter(e,i.filterText);return i.showHidden||i.filterText?n:t.filter(n,function(e){return e.menuIsVisible||e.boardId===i.currentBoardId})},getVisibleViewGroups:function(e,i){return i.showHidden?e:t.filter(e,function(e){return e.menuIsVisible||e.hasBoard(i.currentBoardId)?!0:i.filterText?this.getVisibleBoards(e.boards,i).length:void 0},this)},getDefaultFocusedBoardId:function(e,i){if(!i.filterText)return"";var n=t.flatMap(e,t.property("boards")),a=this.getVisibleBoards(n,i),r=a[0];
return r?r.boardId:""}}}),define("tau/components/board.menu/models/board.menu.section",["require","Underscore","tau/core/class","./board.menu.constants","./../services/board.menu.transformations.service"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=e("./board.menu.constants"),a=e("./../services/board.menu.transformations.service"),r={};return r[n.FAVORITES_SECTION_TYPE]="Favorites",r[n.OTHERS_SECTION_TYPE]="Other",i.extend({init:function(e,i){this._urlService=e,this.viewsMenuSectionUpdated=t.Callbacks(),this.name=r[i.sectionType],this.sectionType=i.sectionType,this.viewMenuGroups=t.sortBy(i.groups,t.property("menuNumericPriority")),t.each(this.viewMenuGroups,function(e){e.viewsMenuGroupUpdated.add(this._onGroupUpdated,this)},this)},getVisibleData:function(e){var i=this.viewMenuGroups,n=a.getVisibleViewGroups(i,e),r=e.filterText?this.getBoardsInSection():t.flatMap(n,t.property("boards")),s=a.getVisibleBoards(r,e);return{groups:n,boards:s}},getIsOthersSection:function(){return this.sectionType===n.OTHERS_SECTION_TYPE},getIsFavoritesSection:function(){return this.sectionType===n.FAVORITES_SECTION_TYPE},_initGroupModel:function(e){e.viewsMenuGroupUpdated.add(this._onGroupUpdated,this)},getBoardsInSection:function(){return t.flatMap(this.viewMenuGroups,t.property("boards"))},addMenuGroup:function(e){return this._initGroupModel(e),this.viewMenuGroups.push(e),this.viewMenuGroups=t.sortBy(this.viewMenuGroups,t.property("menuNumericPriority")),this.viewsMenuSectionUpdated.fire(this),e},moveGroupToSection:function(e,t){this._removeMenuGroupInternal(e),t.addMenuGroup(e)},removeMenuGroup:function(e){var t=this._findGroupById(e);t&&(t.moveAllBoardsToGroup(this.getUngroupedGroup()),this._removeMenuGroupInternal(t))},_removeMenuGroupInternal:function(e){e.viewsMenuGroupUpdated.remove(this),this.viewMenuGroups=t.without(this.viewMenuGroups,e),this.viewsMenuSectionUpdated.fire(this)},getUngroupedGroup:function(){return t.find(this.viewMenuGroups,function(e){return e.getIsUngroupedGroup()
})},_findGroupById:function(e){return t.findWhere(this.viewMenuGroups,{groupId:e})},findGroupIndexById:function(e){return t.findIndex(this.viewMenuGroups,t.matches({groupId:e}))},invalidateGroupsOrder:function(){this.viewMenuGroups=t.sortBy(this.viewMenuGroups,t.property("menuNumericPriority")),this.viewsMenuSectionUpdated.fire(this)},_onGroupUpdated:function(){this.viewsMenuSectionUpdated.fire(this)}})}),define("tau/components/board.menu/board.menu.config",[],function(){return{watchedBoardSettingsFields:["name","isShared","customSharedData","viewMode","acid","menuGroupKey","menuIsVisible","menuNumericPriority","edit","ownerIds","isFavorite"]}}),define("tau/services/service.board.access",["Underscore"],function(e){return{isOwner:function(t,i){return e.contains(t.ownerIds,i.id)},isEditable:function(e,t){return this.isOwner(e,t)||t.isAdministrator}}}),define("tau/components/board.menu/models/board.menu.board",["require","Underscore","tau/core/class","./../board.menu.config","tau/services/service.board.access"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=e("./../board.menu.config"),a=e("tau/services/service.board.access");return i.extend({init:function(e,i){this._urlService=e,this.boardUpdated=t.Callbacks(),this._applyBoardData(i),this.edit=!1},updateBoardData:function(e){this._applyBoardData(e),this.boardUpdated.fire(this)},getUpdatedBoardData:function(e){var i=t.extend(t.deepClone(this.storedBoardData||{}),e);return t.defaults(i,{isFavorite:!1})},getCanChangeGroup:function(e){return a.isEditable(this.storedBoardData,e)},getIsPrivate:function(){return!this.isShared},getIsCustomShared:function(){return this.isShared&&this.customSharedData&&this.customSharedData.isActive},applyGlobalAcid:function(){this._updateLink(),this.boardUpdated.fire(this)},_applyBoardData:function(e){var i=this.getUpdatedBoardData(e);this.storedBoardData=i;var a=t.pick(i,n.watchedBoardSettingsFields);a.boardId=i.key||i.id,a.name=a.name||a.boardId,t.extend(this,a),this._updateLink()},_updateLink:function(){this.link=this._urlService.getBoardUrl(this.storedBoardData)
}})}),define("tau/components/board.menu/models/board.menu.board.group",["require","Underscore","tau/core/class","./board.menu.board","./board.menu.constants"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=e("./board.menu.board"),a=e("./board.menu.constants"),r=["key","name","isExpanded","isFavorite","menuNumericPriority","menuIsVisible","isShared","customSharedData","ownerIds"];return i.extend({init:function(e,i){this._urlService=e,this.viewsMenuGroupUpdated=t.Callbacks(),this.boards=t.chain(i.boards).sortBy(t.property("menuNumericPriority")).map(this._createBoardModel,this).value(),this._applyGroupData(i),this.groupTypes=[];var n=i.key;n===a.FAVORITES_GROUP_KEY&&this.groupTypes.push(a.FAVORITES_GROUP_TYPE,a.UNGROUPED_GROUP_TYPE),n===a.UNGROUPED_GROUP_KEY&&this.groupTypes.push(a.UNGROUPED_GROUP_TYPE)},getIsFavoriteUngroupedGroup:function(){return this.isFavorite&&this.getIsUngroupedGroup()},getIsRegularGroup:function(){return!this.getIsUngroupedGroup()},getIsUngroupedGroup:function(){return t.contains(this.groupTypes,a.UNGROUPED_GROUP_TYPE)},getIsPrivate:function(){return!this.isShared},getIsCustomShared:function(){return this.isShared&&this.customSharedData&&this.customSharedData.isActive},findBoardIndexById:function(e){return t.findIndex(this.boards,t.matches({boardId:e}))},hasBoard:function(e){return this.findBoardIndexById(e)>-1},updateGroupData:function(e){this._applyGroupData(e),this.viewsMenuGroupUpdated.fire(this)},invalidateViewsOrder:function(){this.boards=t.sortBy(this.boards,t.property("menuNumericPriority")),this.viewsMenuGroupUpdated.fire(this)},getUpdatedGroupData:function(e){var i=t.extend(t.deepClone(this._storedGroupData||{}),t.pick(e,r));return t.defaults(i,{isFavorite:!1})},_applyGroupData:function(e){var i=this.getUpdatedGroupData(e);this._storedGroupData=i,t.extend(this,i),this.groupId=i.key},createBoardInGroup:function(e){return this.createBoardsInGroupBatch([e])[0]},createBoardsInGroupBatch:function(e){var i=t.map(e,this._createBoardModel,this);
return this.boards=this.boards.concat(i),this.invalidateViewsOrder(),i},removeBoard:function(e){var i=t.findWhere(this.boards,{boardId:e});return i&&(this.boards=t.without(this.boards,i),this.viewsMenuGroupUpdated.fire(this)),i?i.storedBoardData:null},_removeBoardsBatchInternal:function(e){var i=t.filter(this.boards,function(i){return t.contains(e,i.boardId)});return this.boards=t.difference(this.boards,i),t.map(i,t.property("storedBoardData"))},moveBoardToGroup:function(e,t){var i=this.removeBoard(e);return t.createBoardInGroup(i)},moveBoardsToGroupBatch:function(e,t){var i=this._removeBoardsBatchInternal(e);this.viewsMenuGroupUpdated.fire(this),t.createBoardsInGroupBatch(i)},moveAllBoardsToGroup:function(e){var i=t.map(this.boards,t.property("boardId"));this.moveBoardsToGroupBatch(i,e)},_createBoardModel:function(e){var t=new n(this._urlService,e);return t.boardUpdated.add(this._onBoardUpdated,this),t},_onBoardUpdated:function(){this.viewsMenuGroupUpdated.fire(this)}})}),define("tau/components/board.menu/models/board.menu.section.collection",["require","tau/core/class","Underscore","tau/utils/utils.debug","./board.menu.section","./board.menu.board.group"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n=e("tau/utils/utils.debug"),a=e("./board.menu.section"),r=e("./board.menu.board.group"),s=t.extend({init:function(){this.sectionCollectionUpdated=i.Callbacks(),this.items=[]},setSections:function(e){this.items=e,i.each(e,function(e){e.viewsMenuSectionUpdated.add(this._onSectionUpdated,this)},this),this.sectionCollectionUpdated.fire(this)},applyBoardUpdates:function(e){var t=e.key,i=this.findBoardById(t);if(!i)return!1;var n=i.menuNumericPriority;e=i.getUpdatedBoardData(e);var a=e.menuNumericPriority,r=this.findGroupContainingBoard(t),s=this.findAppropriateGroupForBoard(e);return r&&s&&r!=s&&(i=r.moveBoardToGroup(e.key,s)),i.updateBoardData(e),s&&n!==a&&s.invalidateViewsOrder(),!0},applyGroupUpdates:function(e){var t=e.key,n=this.findGroupById(t);if(!n)return!1;
var a=n.menuNumericPriority;e=n.getUpdatedGroupData(e);var r=e.menuNumericPriority,s=this.findSectionContainingGroup(t),o=this.findAppropriateSectionForGroup(e),l=s&&o&&s!=o,u=n.boards;if(l){var c=o.getUngroupedGroup(),d=i.filter(c.boards,i.matches({menuGroupKey:t}));s.moveGroupToSection(n,o),i.each(d,function(e){c.moveBoardToGroup(e.boardId,n)})}return n.updateGroupData(e),l&&i.each(u,function(e){var t=this.findAppropriateGroupForBoard(e);t!==n&&n.moveBoardToGroup(e.boardId,t)},this),o&&a!==r&&o.invalidateGroupsOrder(),!0},createGroupInSection:function(e){var t=this.findAppropriateSectionForGroup(e);if(t){t.addMenuGroup(e);var n=i.filter(this.getAllBoards(),i.matches({menuGroupKey:e.groupId}));i.each(n,function(t){var i=this.findAppropriateGroupForBoard(t);if(i===e){var n=this.findGroupContainingBoard(t.boardId);n.moveBoardToGroup(t.boardId,i)}},this)}},removeView:function(e){var t=this.findGroupContainingBoard(e);return t?t.removeBoard(e):null},findAppropriateGroupForBoard:function(e){var t=this.findGroupById(e.menuGroupKey);return e.isFavorite?t&&t.isFavorite?t:this._getFavoritesGroup():(t||(t=this._getUngroupedOtherGroup()),t)},findAppropriateSectionForGroup:function(e){return e.isFavorite?this._getFavoritesSection():this.getOtherSection()},findBoardById:function(e){var t=i.flatMap(this.getAllViewGroups(),i.property("boards"));return i.findWhere(t,{boardId:e})},findGroupContainingBoard:function(e){var t=i.matches({boardId:e});return i.find(this.getAllViewGroups(),function(e){return i.some(e.boards,t)})},findSectionContainingGroup:function(e){var t=i.matches({groupId:e});return i.find(this.items,function(e){return i.some(e.viewMenuGroups,t)})},_getFavoritesSection:function(){return i.find(this.items,function(e){return e.getIsFavoritesSection()})},getOtherSection:function(){return i.find(this.items,function(e){return e.getIsOthersSection()})},_getFavoritesGroup:function(){return this._getSingleSectionGroup(this._getFavoritesSection(),function(e){return e.getIsFavoriteUngroupedGroup()
},"There should be one and only one favorites group")},_getUngroupedOtherGroup:function(){return this._getSingleSectionGroup(this.getOtherSection(),function(e){return e.getIsUngroupedGroup()},'There should be one and only one "others" group')},_getSingleSectionGroup:function(e,t,a){var r=i.filter(e.viewMenuGroups,t);return n.assertError(1===r.length,a),r[0]},findGroupById:function(e){return i.findWhere(this.getAllViewGroups(),{groupId:e})},getAllBoards:function(){return i.flatMap(this.getAllViewGroups(),i.property("boards"))},getAllViewGroups:function(){return i.flatMap(this.items,i.property("viewMenuGroups"))},hasHiddenItems:function(){var e=function(e){return!e.menuIsVisible},t=function(t){return e(t)||i.any(t.boards,e)};return i.any(this.items,function(e){return i.any(e.viewMenuGroups,t)})},_onSectionUpdated:function(){this.sectionCollectionUpdated.fire(this)},applyAcidToViews:function(){i.each(this.items,function(e){i.each(e.viewMenuGroups,function(e){i.each(e.boards,function(e){e.applyGlobalAcid()})})})}});return s.createFromMenuStructure=function(e,t){var n=i.filter(e,i.matches({itemType:"section"}));return i.map(n,function(e){var n=i.chain(e.children).filter(i.matches({itemType:"group"})).map(function(e){var n=i.chain(e.children).filter(i.matches({itemType:"board"})).map(i.property("itemData")).value(),a=i.defaults({boards:n},e.itemData);return new r(t,a)},this).value();return new a(t,{sectionType:e.itemData.sectionType,groups:n})},this)},s}),define("tau/services/boards/service.views.menu",["require","Underscore","tau/core/class","./service.boards.api","./service.views.groups.api","app.path","tau/utils/utils.api","./service.views.menu.utils","tau/components/board.menu/models/board.menu.section.collection"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=e("./service.boards.api"),a=e("./service.views.groups.api"),r=e("app.path"),s=e("tau/utils/utils.api"),o=e("./service.views.menu.utils"),l=e("tau/components/board.menu/models/board.menu.section.collection");
return i.extend({boardsApi:null,groupsApi:null,init:function(e,i){this.viewsMenuUrlService=i,this._clientId=t.uniqueId("viewmenu/"+ +new Date+"/"+t.UUID());var r={clientId:this._clientId};this.boardsApi=new n(e,r),this.groupsApi=new a(e,r),this._noCacheStorage=new o.NoCacheStorageApiFacade(e)},getViewsMenuClientId:function(){return this._clientId},getBoardsForUser:function(e){var t={url:r.get()+"/api/boards/v1/visibleForUser/"+e,dataType:"json",type:"GET",$scope:{}};return this._noCacheStorage.makeServiceCall(t)},getApiForType:function(e){switch(e){case"group":return this.groupsApi;case"board":return this.boardsApi;default:throw new Error("Unknown menu item type")}},getViewsMenuForUser:function(){var e={url:r.get()+"/api/views/v1",dataType:"json",type:"GET",$scope:{}};return this.viewsMenuUrlService.acidInitialized.then(function(){return this._noCacheStorage.makeServiceCall(e)}.bind(this)).then(function(e){return l.createFromMenuStructure(e.data.items,this.viewsMenuUrlService)}.bind(this))},removeAllBoards:function(){var e=s.createDeleteAjaxCommandConfig({url:r.get()+"/api/boards/v1/?deleteAll=true",$scope:{}});return this._noCacheStorage.makeServiceCall(e)},removeAllViewMenuItems:function(){var e=s.createDeleteAjaxCommandConfig({url:r.get()+"/api/views/v1/unsafeDeleteAllItems",$scope:{}});return this._noCacheStorage.makeServiceCall(e).then(this.clearViewsMenuCache.bind(this))},clearViewsMenuCache:function(){t.invoke([this.boardsApi,this.groupsApi],"clearViewMenuItemCollectionCache")}})}),define("tau/components/board.menu/services/board.menu.board.url.service",["require","Underscore","jQuery","tau/core/class"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class");return n.extend({init:function(e,n){this._appStateStore=n,this._urlBuilder=e,this.acidInitialized=i.Deferred(),this.acidUpdated=t.Callbacks(),this._lastAcidValue=null,n.get({fields:["acid"],callback:function(e){this.acidInitialized.resolve(),this._setAcid(e.id,e.acid)}.bind(this)}),n.bind({listener:this,fields:["acid"],callback:function(e){this._setAcid(n.settings.id,e.acid),this.acidUpdated.fire(this._lastAcidValue)
}.bind(this)})},_setAcid:function(e,t){this._lastAcidValue={id:e,acid:t}},getBoardUrl:function(e){if("resolved"!==this.acidInitialized.state())return console.error("Acid is not initialized yet"),"";var i=t.clone(this._lastAcidValue);return i.acid=e.acid||i.acid,this._urlBuilder.getRelativeBoardUrl(e.boardId||e.key,i)},destroy:function(){this._appStateStore.unbind({listener:this})}})}),define("tau/services/boards/service.views.menu.comet.listener",["require","tau/core/class","Underscore"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n="board.menu.comet";return t.extend({init:function(e,t,i,n){this._cometApi=e,this._viewsMenuApi=t,this._boardsOperationsService=i,this._featuresService=n},startListen:function(){this._featuresService.isEnabled(n)&&(this._subscription=this._cometApi.listen("view-menu",{parameters:{clientId:this._viewsMenuApi.getViewsMenuClientId()}}).on({batchCallback:this._batchCometCallback.bind(this)}).start())},stopListen:function(){this._subscription&&(this._subscription.stop(),this._subscription=null)},_batchCometCallback:function(e){if(this._featuresService.isEnabled(n)){var t=JSON.parse(e.Data);i.each(t,function(e){switch(e.data.itemType){case"board":return this._handleBoard(e);case"group":return this._handleGroup(e)}},this)}},_handleGroup:function(e){var t=e.data.itemData;switch(e.modificationType.toLowerCase()){case"added":this._viewsMenuApi.groupsApi._notifyItemCreated(t);break;case"updated":this._viewsMenuApi.groupsApi.mergeViewMenuItemCache(t),this._viewsMenuApi.groupsApi._notifyItemUpdated(t);break;case"unavailable":this._viewsMenuApi.groupsApi.clearCacheForViewMenuItem(t.key),this._viewsMenuApi.groupsApi._notifyItemRemoved(t.key)}},_handleBoard:function(e){var t=e.data.itemData;switch(e.modificationType.toLowerCase()){case"added":this._viewsMenuApi.boardsApi._notifyItemCreated(t);break;case"updated":this._viewsMenuApi.boardsApi.mergeViewMenuItemCache(t),this._viewsMenuApi.boardsApi._notifyItemUpdated(t);break;case"unavailable":this._onBoardUnavailable(t.key)
}},_onBoardUnavailable:function(e){this._viewsMenuApi.boardsApi.clearCacheForViewMenuItem(e),this._viewsMenuApi.boardsApi._notifyItemRemoved(e)},destroy:function(){this.stopListen()}})}),define("tau/components/board.menu/services/board.menu.integration.service",["require","Underscore","tau/core/class"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=i.extend({init:function(e){this._onAddItem=e},addReactMenuItem:function(e){this._onAddItem(e)}});return i.extend({init:function(){this._actionsMenuItems=[],this.actionsMenuItemsUpdated=t.Callbacks()},getActionsMenuExtender:function(){return new n(this._onAddMenuItem.bind(this))},getCustomActionsMenuItems:function(){return t.clone(this._actionsMenuItems)},_onAddMenuItem:function(e){this._actionsMenuItems.push(e),this.actionsMenuItemsUpdated.fire()}})}),define("tau/slice/slice.interrupter",["tau/core/save.interrupter"],function(e){return new e}),define("tau/slice/api.cache",["tau/core/class","jQuery","Underscore"],function(e,t,i){var n={NoCache:"NoCache",Static:"Static",Dynamic:"Dynamic",Today:"Today"};return e.extend({init:function(e){this.name=e,this.cache={}},_getCacheEntry:function(e,t){var i=this.cache[e];return i&&i[t]},_setCacheEntry:function(e,t,i){this.cache[e]||(this.cache[e]={}),this.cache[e][t]=i},evict:function(e,t){t?this._setCacheEntry(e,this._getCacheKey(t),void 0):this.cache[e]={}},process:function(e){function t(){s(null).fail(p).done(function(t){JSON.stringify(t.data)===JSON.stringify(c.value.data)?c.timestamp=new Date:(this._sendStatistics(l,{invalidated:!0}),this._setCacheEntry(e.namespace,u,void 0),o())}.bind(this))}function a(){r=s(null),r.fail(p).done(function(t){var a=t.data.metaInfo&&t.data.metaInfo.cacheType||n.NoCache;if(a!=n.NoCache){var r=i.clone(t);r.data=i.deepClone(t.data),this._setCacheEntry(e.namespace,u,{value:r,timestamp:new Date,type:a})}}.bind(this))}var r,s=e.resolver,o=e.invalidatedCallback,l=e.statInfo,u=this._getCacheKey(e.key),c=this._getCacheEntry(e.namespace,u),d=this._getCacheActions(c);
this._sendStatistics(l,d);var p=function(){this._setCacheEntry(e.namespace,u,void 0)}.bind(this);if(d.cacheHit){var f=i.deepClone(c.value);r=s(f),d.needInvalidate&&t.call(this)}else a.call(this);return r},_getCacheKey:function(e){return i.map(e,function(e){return i.isArray(e)?this._getCacheKey.call(this,e):i.isObject(e)?JSON.stringify(e):e}.bind(this)).join("_")},_getCacheActions:function(e){var t,i;if(e){var a=e.type;switch(a){case n.Static:t=!0,i=!1;break;case n.Today:var r=e.timestamp;t=r.getDate()==(new Date).getDate(),i=!1;break;case n.Dynamic:t=!0,i=!0;break;default:t=!1,i=!1}}else t=!1,i=!1;return{cacheHit:t,needInvalidate:i}},_sendStatistics:function(e,t){var n=i.clone(e);i.extend(n,t),taus.track("cache."+this.name,n)}})}),define("tau/slice/api.no.cache",["jQuery"],function(e){return{process:function(e){return e.resolver(null)},evict:e.noop}}),define("tau/services/service.features",["tau/core/class","Underscore"],function(e,t){return e.extend({init:function(e){this.feature=e||window.tauFeatures||{}},isEnabled:function(e){return!!this.feature[e]},set:function(e,t){return t=!!t,this.feature[e]=t,t},setEnabled:function(e){return this.set(e,!0)},setDisabled:function(e){return this.set(e,!1)},getEnabled:function(){return t.chain(this.feature).keys().filter(function(e){return this.isEnabled(e)}.bind(this)).value()}})}),define("tau/slice/api.cache.axes.instance",["./api.cache","./api.no.cache","tau/services/service.features"],function(e,t,i){var n=new i;return n.isEnabled("cache.axis")?new e("axis"):t}),define("tau/slice/api",["tau/core/class","jQuery","Underscore","tau/core/event","tau/slice/slice.interrupter","./api.cache.axes.instance"],function(e,t,i,n,a,r){var s=e.extend({init:function(e,n){this.config=e||{},this.resolver=n,this.id=i.uniqueId("slice/"+ +new Date+"/"+i.UUID()),this._requests={},i.defaults(this.config,{definition:{},service:t.ajax,base64:!1,clientId:this.id,options:{}})},getCometParameters:function(){var e=this,t=e.config,i=e.resolver.resolve(t.definition,{method:"noop"},{base64:t.base64,clientId:t.clientId});
return i.parameters},clone:function(){var e=i.deepClone(this.config),t=new s(e,this.resolver);return t.id=this.id,t},_interruptBatchAction:function(e,t){var n=i.uniq(i.map(t.$set.items,function(e){return e.type}));return this._interruptAction(e,n,t.$set.items)},_interruptSingleAction:function(e,t){var i=t.$set.type||t.$set.entityType,n=[i];return this._interruptAction(e,n,[t.$set])},_interruptAction:function(e,n,r){var s=i.chain(n).map(function(e){return a.getInterruptersByType(e)}).flatten().value();if(s.length>0){var o=i.map(s,function(e){return{callback:e,deferred:t.Deferred()}}),l=i.map(o,function(e){return e.deferred}),u=t.whenList(l).then(function(){return e()}),c=this._getItemsChanges(r);return i.each(o,function(e){e.callback(e.deferred,c)}),u}return e()},_getItemsChanges:function(e){var t=this;return i.map(e,function(e){var n={id:e.itemId,type:e.type||e.entityType,changes:[]};return e.x&&n.changes.push({name:t.config.definition.x.types[0],value:e.x}),e.y&&n.changes.push({name:t.config.definition.y.types[0],value:e.y}),e.values&&i.each(e.values,function(e){n.changes.push({name:e.id,value:e.value})}),n})},_deferredResolved:function(e,t){this.fire("after."+e.command.method,{result:t.data,command:e.command}),e.$deferred.resolve(t)},_deferredRejected:function(e,t){e.$deferred.reject(t)},abort:function(){var e=i.values(this._requests);for(this._requests={};e.length>0;){var t=e.pop();t.abort(),this.fire("abort",t.configAction)}},getCallOptions:function(e){return e=e||{},i.defaults(e,{base64:this.config.base64}),e.sign&&(e.clientId=this.config.clientId),e},resolve:function(e,n){var a=this;e=e||{};var r=e.command||{};n=this.getCallOptions(n);var s,o=this._createApiRequestConfig(r,n),l={},u={type:"POST",url:o.serviceUrl,dataType:"json",data:JSON.stringify(o.parameters),contentType:"application/json; charset=utf-8",$scope:e,beforeSend:function(){l.start=(new Date).getTime(),s=taus.start("slice",{})}},c={ajaxConfig:u,command:r},d=i.uniqueId("ajaxCall"),p=this.config.service(u);
return a._requests[d]=p,a._requests[d].configAction={command:c.command},p.done(function(t,i,n){l.end=(new Date).getTime(),a._requests.hasOwnProperty(d)&&(delete a._requests[d],c.data=t,c.isResolvedFromCache=!1,a.fire("request.completed",{time:l,command:r,response:n,request:o.parameters}),s.stop({"@":"slice-request-completed",command:r,response:n,request:o.parameters}),a._deferredResolved(e,c))}).fail(function(i){if(a._requests.hasOwnProperty(d)){delete a._requests[d];try{i.responseText=t.parseJSON(i.responseText)}catch(n){}c.data=i,a._deferredRejected(e,c)}}),e.$deferred},_createApiRequestConfig:function(e,t){return this.resolver.resolve(this.config.definition,e,t)},isUndefinedAxis:function(e){return 0===this.getTypes(this.config.definition[e]).length},x:function(e,t){return this.axis("x",e,t)},y:function(e,t){return this.axis("y",e,t)},axis:function(e,t,i){var n=this.isUndefinedAxis(e)?{items:[]}:null;if(n)return this.resolveDeferred(e+"axis",t,null,{data:n});var a=this.config.definition[e],s=a&&a.types&&a.types[0];return r.process({namespace:s,key:{axis:e,config:t,definition:this.config.definition},resolver:function(i){return this.resolveDeferred(e+"axis",t,null,i)}.bind(this),invalidatedCallback:i,statInfo:{axis:e,axisType:a&&a.types&&a.types[0]}})},cell:function(e){var t=0===this.getTypes(this.config.definition.cells).length?{data:{items:[]}}:null;return this.resolveDeferred("cells",e,null,t)},size:function(){var e=this.isUndefinedAxis("x")&&this.isUndefinedAxis("y")?{data:{}}:null;return this.resolveDeferred("size",{},null,e)},dataItemTemplate:function(e){return this.resolveDeferred("dataItemTemplate",e)},dataTemplate:function(e){return this.resolveDeferred("dataTemplate",e)},axisDataTemplate:function(e){return this.resolveDeferred("axisDataTemplate",e)},listDataTemplate:function(e){return this.resolveDeferred("listDataTemplate",e)},notifyBoardAccess:function(e){return this.resolveDeferred("notifyBoardAccess",e)},addData:function(e){return this._interruptSingleAction(i.bind(function(){return this.resolveDeferred("addData",e)
},this),e)},axisAddData:function(e){return this._interruptSingleAction(i.bind(function(){var t={sign:!0};return this.resolveDeferred("addAxisData",e,t)},this),e)},listAddData:function(e){return this._interruptSingleAction(i.bind(function(){return this.resolveDeferred("listAddData",e)},this),e)},viewAddData:function(e){return this._interruptSingleAction(i.bind(function(){return this.resolveDeferred("viewAddData",e)},this),e)},cellActions:function(e){return this.resolveDeferred("cellActions",e)},cellActionsV2:function(e){return this.resolveDeferred("cellActionsV2",e)},axesActions:function(e){return this.resolveDeferred("axesActions",e)},viewDataTemplates:function(e){return this.resolveDeferred("ViewDataTemplates",e)},move:function(e){return this.resolveDeferred("move",e)},listModeActionsV2:function(e){return this.resolveDeferred("listModeActionsV2",e)},globalDataTemplates:function(e){return this.resolveDeferred("globalDataTemplates",e)},cardDetails:function(e){var t=this.config.definition.cells,n=this.getTypes(t),a=i(n).filter(function(e){return e.data&&"{}"!==e.data});t.types=a;var r={disableWhereScope:!0},s=0===a.length||0===e.$set.CardsIds.length?{data:{items:[]}}:null;return this.resolveDeferred("cardsDetails",e,r,s)},moveAndPrioritizeBatch:function(e){return this._interruptBatchAction(i.bind(function(){var t={disableWhereScope:!0};return e.$set.items.length>this.config.options.DnDTurnOffCometWhenItemsCountExceed&&(t.sign=!0),this.resolveDeferred("moveAndPrioritizeBatch",e,t)},this),e)},moveBatch:function(e){return this._interruptBatchAction(i.bind(function(){var t={disableWhereScope:!0};return e.$set.items.length>this.config.options.DnDTurnOffCometWhenItemsCountExceed&&(t.sign=!0),this.resolveDeferred("moveBatch",e,t)},this),e)},movePlannedDatesBatch:function(e){return this._interruptBatchAction(i.bind(function(){var t={disableWhereScope:!0};return e.$set.items.length>this.config.options.DnDTurnOffCometWhenItemsCountExceed&&(t.sign=!0),this.resolveDeferred("movePlannedDatesBatch",e,t)
},this),e)},prioritizeBatch:function(e){return this._interruptBatchAction(i.bind(function(){var t={};return e.$set.items.length>this.config.options.DnDTurnOffCometWhenItemsCountExceed&&(t.sign=!0),this.resolveDeferred("prioritizeBatch",e,t)},this),e)},prioritize:function(e){return this.resolveDeferred("prioritize",e)},getCellsUnavailableToMove:function(e){return this.resolveDeferred("getCellsUnavailableToMove",e)},axes:function(){var e=this._createDeferredCall("axes"),i={command:e.command};return t.when(this.x(),this.y()).done(function(t,n){i.data={x:t.data.items,y:n.data.items},e.$deferred.resolve(i)}).fail(function(t){i.data=t,e.$deferred.reject(i)}),e.$deferred},space:function(){return this.resolveDeferred("space",{})},spaceV2:function(){return this.resolveDeferred("spaceV2",{})},getTypes:function(e){return e?i.isArray(e)?e:i.isString(e)?[e]:e.types?i.isArray(e.types)?e.types:i.isString(e.types)?[e.types]:[]:[]:[]},cellCounts:function(e){return this.resolveDeferred("cellCounts",e)},axesCounts:function(e){return this.resolveDeferred("axesCounts",e)},density:function(e){return this.resolveDeferred("density",e)},forecasts:function(e){return this.resolveDeferred("forecasts",e)},list:function(e){var t=0===this.getTypes(this.config.definition.cells).length?{data:{items:[]}}:null;return this.resolveDeferred("list",e,null,t)},_createDeferredCall:function(e,i){var n=t.Deferred();return{$deferred:n,command:{config:i,method:e}}},resolveDeferred:function(e,t,i,n){var a=this._createDeferredCall(e,t);if(n)return this._deferredResolved(a,n),a.$deferred;var r=this;return r.fire("before."+e,t),this.resolve(a,i).fail(function(t){if(0!==t.data.status){var i,n="";t.data.readyState?(i=t.data.responseText,n=i.Message):i={message:n},i.cmd=t.command,r.fire("error",i);var a=n||"unknown slice issue";taus.error({"@":["slice-detailed-error"],message:a,method:e,definition:r.config.definition}),taus.track({"@":["slice-detailed-error"],tags:["error","slice"],name:a,method:e,definition:r.config.definition})
}})}});return n.implementOn(s.prototype),s}),define("tau/slice/slice.space.cached",["Underscore","tau/slice/api"],function(e,t){var i={};return t.extend({space:function(){var e={method:"space"},t=this.getCallOptions({}),n=this.resolver.resolve(this.config.definition,e,t),a=n.url;return i.hasOwnProperty(a)||(i[a]=this.resolveDeferred("space",{})),i[a]}})}),define("tau/slice/slice.definition.transformations",["Underscore"],function(e){return{createSliceDefinitionFromBoardSettings:function(t){var i=t.global?t.global.acid:null,n=t.global?t.global.entityId:null,a={global:{acid:i,entityId:n}};if(t.hasOwnProperty("x")){var r=this._convertToDefinitionItem(t.x);r&&(a.x=r)}if(t.hasOwnProperty("user")){var s=e.cloneDeep(t.user);s&&(a.user=s)}if(t.hasOwnProperty("y")){var o=this._convertToDefinitionItem(t.y);o&&(a.y=o)}return t.hasOwnProperty("cells")&&(a.cells=this._convertToDefinitionCells(t.cells)),t.hasOwnProperty("entityId")&&t.hasOwnProperty("entityType")&&(a.entityId=t.entityId,a.entityType=t.entityType,a.templateTypesFilter=t.templateTypesFilter),a},_convertToDefinitionItem:function(t){if(!t)return null;t=e.cloneDeep(t);var i={};if(e.isString(t)&&(t=[t]),e.isArray(t))i.id=t.length?t[0]:null,i.filter=null,i.ordering=null;else if(e.isObject(t)){var n=t.type||t.types;i.id=e.isArray(n)?n.length?n[0]:null:n,e.isString(t.data)&&(i.data=t.data),this._convertFilterAndOrdering(t,i)}return i},_convertToDefinitionCells:function(t){if(!t)return null;t=e.cloneDeep(t);var i={};return e.isArray(t)?i.items=t:e.isObject(t)&&(i.items=t.items||t.types||t.type,this._convertFilterAndOrdering(t,i)),e.each(i.items,function(e,t){i.items[t]=this._convertToDefinitionItem(e)},this),i},_convertFilterAndOrdering:function(e,t){e.useFilter!==!1&&(t.filter=e.filter||null),t.ordering=e.ordering&&e.ordering.name?e.ordering:null}}}),define("tau/slice/url.resolver",["jQuery","Underscore","tau/core/class","app.path","tau/core/query","tau/slice/slice.definition.transformations"],function(e,t,i,n,a,r){var s=n.get(),o=s+"/slice/v1/";
return i.extend({init:function(e){this.prefix=e.prefix},resolve:function(i,n,s){var o=this.resolveUrl(n.method),l=t.clone(n.config||{});t.defaults(l,{});var u={base64:s.base64||!1};if(s.clientId&&(u.clientId=s.clientId),u.take=l.$take,l.$skip&&(u.skip=l.$skip),!s.disableWhereScope){var c=a.render(l);c&&(u.where=c);var d=a.render(l.$whereX||{});d&&(u.whereX=d);var p=a.render(l.$whereY||{});p&&(u.whereY=p)}l.$set&&t.forEach(l.$set,function(e,t){u[t]=e}),u.definition=r.createSliceDefinitionFromBoardSettings(i);var f=t.clone(u);return delete f.clientId,{serviceUrl:o,parameters:u,url:o+"?"+e.param(f)}},resolveUrl:function(e){return[o,this.prefix,"/",e].join("")}})}),define("tau/slice/slice.factory",["Underscore","tau/core/class","tau/slice/slice.space.cached","tau/slice/url.resolver"],function(e,t,i,n){return t.extend({init:function(e){this.defaults=e||{}},create:function(t){var a=t||{};return e.defaults(a,this.defaults),new i(a,new n({prefix:"matrix"}))}})}),define("tau/utils/utils.titleManager",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(t){this.config=e.defaults(t||{},{window:window,delimiter:" ",source:""}),this.config.source=this.config.source||e.asString(this.config.window.document.title)},set:function(t){this.config.window.document.title=e.asString(t)},getTitle:function(){return this.config.window.document.title},setTitle:function(t){this.set(e.asString(t)+this.config.delimiter+this.config.source)},restoreDefault:function(){this.set(this.config.source)}});return i}),define("tau/utils/utils.base64hashEncoder",["Underscore","libs/base64/base64"],function(e,t){return{encode:function(i){return e.isObject(i)?t.encode(JSON.stringify(i)):i},decode:function(e){var i=t.decode(e);return i="{"===i.charAt(0)&&"}"===i.charAt(i.length-1)?JSON.parse(i):e},encodeName:function(e){return t.encode(e).replace(/\+/g,"__1").replace(/\//g,"__2").replace(/=/g,"__3")},decodeName:function(e){return t.decode(e.replace(/__1/g,"+").replace(/__2/g,"/").replace(/__3/g,"="))
}}}),define("tau/services/service.componentBuilder",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(e){this.requireLoader=e.getRequireLoader()},create:function(i,n){e.isString(i)&&(i={name:i,path:i});var a;if(i.path)a=i.path;else{if(!i.type)throw new Error("Configuration error: type or path is missing");e.defaults(i,{namespace:"tau"}),a=i.namespace+"/components/component."+i.type}var r=t.Deferred();return this.requireLoader([a],function(t){r.resolve(t.create(e.defaults(i,n||{})))},function(e){r.reject(e)}),r},createAsChild:function(i,n){return t.when(this.create(i)).then(function(t){return n.on("refresh",e.bind(t.fire,t,"destroy")),n.on("destroy",e.bind(t.fire,t,"destroy")),t})}})}),define("tau/libs/clipboard/clipboard.manager",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(t,i){var n=this;n.restStorage=t,n.options=e.defaults(i||{},{}),n._cache={}},set:function(e,t){this._cache={},this.add(e,t)},add:function(t,i){var n=this,a=this._sanitize(t),r=e.values(n._cache).length;e.forEach(a,function(e){var t=n._createKey(e);n._cache[t]=e}),e.values(n._cache).length!=r&&this._save(n._cache,i)},update:function(t,i){var n=this,a=this._sanitize(t);e.forEach(a,function(e){var t=n._createKey(e);n._cache[t]=e}),this._save(n._cache,i)},remove:function(t,i){var n=this,a=e.values(n._cache).length,r=this._sanitize(t);e.forEach(r,function(e){var t=n._createKey(e);delete n._cache[t]}),e.values(n._cache).length!=a&&this._save(n._cache,i)},removeAll:function(e){self._cache={},this._save([],e)},getAll:function(t){var i=this;this._get(function(n,a){e.forEach(a,function(e){i._cache[i._createKey(e)]=e}),t(n,a)})},unbind:function(e){this.restStorage.unbind({listener:e})},bind:function(e,t){this.restStorage.bind({listener:e,fields:["items"],callback:function(e){t&&t(null,e.items||[])}})},_save:function(t,i){this.restStorage.set({set:{items:e.values(t)},callback:function(e){i&&i(null,e.items)}})},_get:function(e){this.restStorage.get({fields:["items"],callback:function(t){e&&e(null,t.items||[])
}})},_sanitize:function(t){var i=this,n=function(t){return t=e.deepClone(t||{}),t=e.pick(t,"id","data","isSelected"),t._id=i._createKey(t),t.data=e.defaults(t.data||{},{id:"",type:""}),t.data.type=t.data.type.toLowerCase(),t};return e.map(e.isArray(t)?t:[t],n)},_createKey:function(e){return"_"+e.data.type+"_"+e.id+"_"}});return i}),define("tau/ui/templateRenderer",["Underscore","jQuery"],function(e,t){return t.extend(t.tmpl.tag,{"@":{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while(!$__t.$tau && $__t.parent){","$__t = $__t.parent","}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")},tauKey:{_default:{$1:"id",$2:"null"},open:['_=_.concat(new String(window._.complexKey($2["data"], $1) || "").toString());'].join("")}}),t}),define("tau/ui/templateRenderer.extensions",["Underscore","tau/core/class","tau/core/termProcessor"],function(e,t,i){var n=t.extend({init:function(e){this.termProc=new i(e.terms)},terms:function(e){return this.termProc.getTerms(e)},text_implode:function(t){var i=new String(t);if(e.isString(t))i=t;else if(e.isArray(t)){var n=e.clone(t),a=n.pop();i=e.filter([n.join(", "),a],function(e){return 0!=e}).join(" &amp; ")}return i},key:function(){}});return n}),define("tau/ui/ui.templateFactory",["tau/core/templates-factory","tau/ui/templateRenderer","tau/ui/templateRenderer.extensions"],function(e){return e}),define("tau/utils/utils.redirect",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(e,t){this.window=e,this.appPath=t},_process:function(e,i){var n=null;if(e.match(/^http(s)?:\/\//i))n=e;else if("#"==e[0])n=e;else{var a=this.appPath;"/"!==e[0]&&(e="/"+e),n=a+e}return i&&(n=t.tmpl(n,i).text()),n},_redirect:function(e,t){t.location.href=e},redirect:function(e,i,n){var a=this.window;if(i){var r=t(document),s={scrollbars:1,width:.8*r.width(),height:.8*r.height(),top:50},o=[],l=null;for(l in s)o.push(l+"="+s[l]);var u=o.join(",");return void(a=this.window.open(this._process(e,n),i,u))}this._redirect(this._process(e,n),a)
},back:function(){this.window.history&&this.window.history.back&&this.window.history.back()},reload:function(){if(this.window.location&&this.window.location.reload){var t=e.bind(function(){this.window.location.reload()},this);setTimeout(t,1)}}})}),define("libs/date.js/build/xdate",[],function(){var e=function(e,t,i,n){function a(){return r(this instanceof a?this:new a,arguments)}function r(t,i){var n,r=i.length;if(j(i[r-1])&&(n=i[--r],i=A(i,0,r)),r)if(1==r){var s=i[0];s instanceof e||N(s)?t[0]=new e(+s):s instanceof a?t[0]=S(s):M(s)&&(t[0]=new e(0),t=h(s,n||!1,t))}else t[0]=new e(tt.apply(e,i)),n||(t[0]=D(t[0]));else t[0]=new e;return j(n)&&o(t,n),t}function s(e){return e[0].toString===it}function o(t,i,n){return i?s(t)||(n&&(t[0]=I(t[0])),t[0].toString=it):s(t)&&(t[0]=n?D(t[0]):new e(+t[0])),t}function l(e,t,i,n,a){var r=R(T,e[0],a),s=R(k,e[0],a),o=t==O?i%12:r(O),l=!1;2==n.length&&j(n[1])&&(l=n[1],n=[i]),s(t,n),l&&r(O)!=o&&(s(O,[r(O)-1]),s($,[P(r(B),r(O))]))}function u(e,i,n,a){n=Number(n);var r=t.floor(n);e["set"+X[i]](e["get"+X[i]]()+r,a||!1),r!=n&&V>i&&u(e,i+1,(n-r)*Z[i],a)}function c(e,i,n){e=e.clone().setUTCMode(!0,!0),i=a(i).setUTCMode(!0,!0);var r=0;if(n==B||n==O){for(var s=V;s>=n;s--)r/=Z[s],r+=T(i,!1,s)-T(e,!1,s);n==O&&(r+=12*(i.getFullYear()-e.getFullYear()))}else if(n==$){var o=e.toDate().setUTCHours(0,0,0,0),l=i.toDate().setUTCHours(0,0,0,0);r=t.round((l-o)/Q)+(i-l-(e-o))/Q}else r=(i-e)/[36e5,6e4,1e3,1][n-3];return r}function d(e){return p(e(B),e(O),e($))}function p(i,n,a){var r=new e(tt(i,n,a)),s=f(i),o=s;if(s>r)o=f(i-1);else{var l=f(i+1);r>=l&&(o=l)}return t.floor(t.round((r-o)/Q)/7)+1}function f(t){var i=new e(tt(t,0,4));return i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+6)%7),i}function m(e,t,i,a){var r=R(T,e,a),s=R(k,e,a),o=f(i===n?r(B):i);a||(o=D(o)),e.setTime(+o),s($,[r($)+7*(t-1)])}function h(t,i,n){for(var r,s=a.parsers,o=0;o<s.length;o++)if(r=s[o](t,i,n))return r;return n[0]=new e(t),n}function g(t,i,n){var a=t.match(/^(\d{4})(-(\d{2})(-(\d{2})([T ](\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/);
if(a){var r=new e(tt(a[1],a[3]?a[3]-1:0,a[5]||1,a[7]||0,a[8]||0,a[10]||0,a[12]?1e3*Number("0."+a[12]):0));return a[13]?a[14]&&r.setUTCMinutes(r.getUTCMinutes()+("-"==a[15]?1:-1)*(60*Number(a[16])+(a[18]?Number(a[18]):0))):i||(r=D(r)),n.setTime(+r)}}function v(e,t,i,n,r){function s(e){return i[e]||u[e]}function o(e){if(n)for(var t=(e==G?$:e)-1;t>=0;t--)n.push(c(t));return c(e)}var l=a.locales,u=l[a.defaultLocale]||{},c=R(T,e,r);return i=(M(i)?l[i]:i)||{},b(e,t,o,s,r)}function b(e,t,i,n,a){for(var r,s,o="";r=t.match(et);)o+=t.substr(0,r.index),r[1]?o+=y(e,r[1],i,n,a):r[3]?(s=b(e,r[4],i,n,a),parseInt(s.replace(/\D/g,""),10)&&(o+=s)):o+=r[7]||"'",t=t.substr(r.index+r[0].length);return o+t}function y(e,t,i,a,r){for(var s,o=t.length,l="";o>0;)s=_(e,t.substr(0,o),i,a,r),s!==n?(l+=s,t=t.substr(o),o=t.length):o--;return l+t}function _(e,t,i,n,r){var s=a.formatters[t];if(M(s))return b(e,s,i,n,r);if(L(s))return s(e,r||!1,n);switch(t){case"fff":return U(i(V),3);case"s":return i(H);case"ss":return U(i(H));case"m":return i(q);case"mm":return U(i(q));case"h":return i(z)%12||12;case"hh":return U(i(z)%12||12);case"H":return i(z);case"HH":return U(i(z));case"d":return i($);case"dd":return U(i($));case"ddd":return n("dayNamesShort")[i(G)]||"";case"dddd":return n("dayNames")[i(G)]||"";case"M":return i(O)+1;case"MM":return U(i(O)+1);case"MMM":return n("monthNamesShort")[i(O)]||"";case"MMMM":return n("monthNames")[i(O)]||"";case"yy":return(i(B)+"").substring(2);case"yyyy":return i(B);case"t":return w(i,n).substr(0,1).toLowerCase();case"tt":return w(i,n).toLowerCase();case"T":return w(i,n).substr(0,1);case"TT":return w(i,n);case"z":case"zz":case"zzz":return r?"Z":x(e,t);case"w":return d(i);case"ww":return U(d(i));case"S":var o=i($);return o>10&&20>o?"th":["st","nd","rd"][o%10-1]||"th"}}function x(e,i){var n=e.getTimezoneOffset(),a=0>n?"+":"-",r=t.floor(t.abs(n)/60),s=t.abs(n)%60,o=r;return"zz"==i?o=U(r):"zzz"==i&&(o=U(r)+":"+U(s)),a+o}function w(e,t){return t(e(z)<12?"amDesignator":"pmDesignator")
}function C(e){return!isNaN(+e[0])}function S(t){var i=new e(+t[0]);return s(t)&&(i.toString=it),i}function T(e,t,i){return e["get"+(t?"UTC":"")+X[i]]()}function k(e,t,i,n){e["set"+(t?"UTC":"")+X[i]].apply(e,n)}function I(t){return new e(tt(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))}function D(t){return new e(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function P(t,i){return 32-new e(tt(t,i,32)).getUTCDate()}function E(e){return function(){return e.apply(n,[this].concat(A(arguments)))}}function R(e){var t=A(arguments,1);return function(){return e.apply(n,t.concat(A(arguments)))}}function A(e,t,a){return i.prototype.slice.call(e,t||0,a===n?e.length:a)}function F(e,t){for(var i=0;i<e.length;i++)t(e[i],i)}function M(e){return"string"==typeof e}function N(e){return"number"==typeof e}function j(e){return"boolean"==typeof e}function L(e){return"function"==typeof e}function U(e,t){for(t=t||2,e+="";e.length<t;)e="0"+e;return e}var B=0,O=1,$=2,z=3,q=4,H=5,V=6,G=7,W=8,Q=864e5,K="yyyy-MM-dd'T'HH:mm:ss(.fff)",Y=K+"zzz",X=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds","Day","Year"],J=["Years","Months","Days"],Z=[12,31,24,60,60,1e3,1],et=new RegExp("(([a-zA-Z])\\2*)|(\\((('.*?'|\\(.*?\\)|.)*?)\\))|('(.*?)')"),tt=e.UTC,it=e.prototype.toUTCString,nt=a.prototype;return nt.length=1,nt.splice=i.prototype.splice,nt.getUTCMode=E(s),nt.setUTCMode=E(o),nt.getTimezoneOffset=function(){return s(this)?0:this[0].getTimezoneOffset()},F(X,function(e,t){nt["get"+e]=function(){return T(this[0],s(this),t)},t!=W&&(nt["getUTC"+e]=function(){return T(this[0],!0,t)}),t!=G&&(nt["set"+e]=function(e){return l(this,t,e,arguments,s(this)),this},t!=W&&(nt["setUTC"+e]=function(e){return l(this,t,e,arguments,!0),this},nt["add"+(J[t]||e)]=function(e,i){return u(this,t,e,i),this},nt["diff"+(J[t]||e)]=function(e){return c(this,e,t)}))}),nt.getWeek=function(){return d(R(T,this,!1))
},nt.getUTCWeek=function(){return d(R(T,this,!0))},nt.setWeek=function(e,t){return m(this,e,t,!1),this},nt.setUTCWeek=function(e,t){return m(this,e,t,!0),this},nt.addWeeks=function(e){return this.addDays(7*Number(e))},nt.diffWeeks=function(e){return c(this,e,$)/7},a.parsers=[g],a.parse=function(e){return+a(""+e)},nt.toString=function(e,t,i){return e!==n&&C(this)?v(this,e,t,i,s(this)):this[0].toString()},nt.toUTCString=nt.toGMTString=function(e,t,i){return e!==n&&C(this)?v(this,e,t,i,!0):this[0].toUTCString()},nt.toISOString=function(){return this.toUTCString(Y)},a.defaultLocale="",a.locales={"":{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],amDesignator:"AM",pmDesignator:"PM"}},a.formatters={i:K,u:Y},F(["getTime","valueOf","toDateString","toTimeString","toLocaleString","toLocaleDateString","toLocaleTimeString","toJSON"],function(e){nt[e]=function(){return this[0][e]()}}),nt.setTime=function(e){return this[0].setTime(e),this},nt.valid=E(C),nt.clone=function(){return new a(this)},nt.clearTime=function(){return this.setHours(0,0,0,0)},nt.toDate=function(){return new e(+this[0])},a.now=function(){return+new e},a.today=function(){return(new a).clearTime()},a.UTC=tt,a.getDaysInMonth=P,"undefined"!=typeof module&&module.exports&&(module.exports=a),a}(Date,Math,Array);return e}),define("libs/date.js/build/date",["./xdate"],function(e){var t="www.datejs.com";return e[t]?e:(e.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]},function(){var t=e,i=t.prototype,n=t.CultureInfo,a=function(e,t){return t||(t=2),("000"+e).slice(-1*t)
};i.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},i.setTimeToNow=function(){var t=new e;return this.setHours(t.getHours()),this.setMinutes(t.getMinutes()),this.setSeconds(t.getSeconds()),this.setMilliseconds(t.getMilliseconds()),this},t.today=function(){return(new e).clearTime()},t.compare=function(t,i){if(isNaN(t)||isNaN(i))throw new Error(t+" - "+i);if(t instanceof e&&i instanceof e)return i>t?-1:t>i?1:0;throw new TypeError(t+" - "+i)},t.equals=function(e,t){return 0===e.compareTo(t)},t.getDayNumberFromName=function(e){for(var t=n.dayNames,i=n.abbreviatedDayNames,a=n.shortestDayNames,r=e.toLowerCase(),s=0;s<t.length;s++)if(t[s].toLowerCase()==r||i[s].toLowerCase()==r||a[s].toLowerCase()==r)return s;return-1},t.getMonthNumberFromName=function(e){for(var t=n.monthNames,i=n.abbreviatedMonthNames,a=e.toLowerCase(),r=0;r<t.length;r++)if(t[r].toLowerCase()==a||i[r].toLowerCase()==a)return r;return-1},t.isLeapYear=function(e){return e%4===0&&e%100!==0||e%400===0},t.getDaysInMonth=function(e,i){return[31,t.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][i]},t.getTimezoneAbbreviation=function(e){for(var t=n.timezones,i=0;i<t.length;i++)if(t[i].offset===e)return t[i].name;return null},t.getTimezoneOffset=function(e){for(var t=n.timezones,i=0;i<t.length;i++)if(t[i].name===e.toUpperCase())return t[i].offset;return null},i.clone=function(){return new e(this.getTime())},i.compareTo=function(t){return e.compare(this,t)},i.equals=function(t){return e.equals(this,t||new e)},i.between=function(e,t){return this.getTime()>=e.getTime()&&this.getTime()<=t.getTime()},i.isAfter=function(t){return 1===this.compareTo(t||new e)},i.isBefore=function(t){return-1===this.compareTo(t||new e)},i.isToday=function(){return this.isSameDay(new e)},i.isSameDay=function(e){return this.clone().clearTime().equals(e.clone().clearTime())},i.addMilliseconds=function(e){return this.setMilliseconds(this.getMilliseconds()+e),this},i.addSeconds=function(e){return this.addMilliseconds(1e3*e)
},i.addMinutes=function(e){return this.addMilliseconds(6e4*e)},i.addHours=function(e){return this.addMilliseconds(36e5*e)},i.addDays=function(e){return this.setDate(this.getDate()+e),this},i.addWeeks=function(e){return this.addDays(7*e)},i.addMonths=function(e){var i=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(i,t.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},i.addYears=function(e){return this.addMonths(12*e)},i.add=function(e){if("number"==typeof e)return this._orient=e,this;var t=e;return t.milliseconds&&this.addMilliseconds(t.milliseconds),t.seconds&&this.addSeconds(t.seconds),t.minutes&&this.addMinutes(t.minutes),t.hours&&this.addHours(t.hours),t.weeks&&this.addWeeks(t.weeks),t.months&&this.addMonths(t.months),t.years&&this.addYears(t.years),t.days&&this.addDays(t.days),this};var r,s,o;i.getWeek=function(){var e,t,i,n,a,l,u,c,d,p;return r=r?r:this.getFullYear(),s=s?s:this.getMonth()+1,o=o?o:this.getDate(),2>=s?(e=r-1,t=(e/4|0)-(e/100|0)+(e/400|0),i=((e-1)/4|0)-((e-1)/100|0)+((e-1)/400|0),d=t-i,a=0,l=o-1+31*(s-1)):(e=r,t=(e/4|0)-(e/100|0)+(e/400|0),i=((e-1)/4|0)-((e-1)/100|0)+((e-1)/400|0),d=t-i,a=d+1,l=o+(153*(s-3)+2)/5+58+d),u=(e+t)%7,n=(l+u-a)%7,c=l+3-n|0,p=0>c?53-((u-d)/5|0):c>364+d?1:(c/7|0)+1,r=s=o=null,p},i.getISOWeek=function(){return r=this.getUTCFullYear(),s=this.getUTCMonth()+1,o=this.getUTCDate(),a(this.getWeek())},i.setWeek=function(e){return this.moveToDayOfWeek(1).addWeeks(e-this.getWeek())},t._validate=function(e,t,i,n){if("undefined"==typeof e)return!1;if("number"!=typeof e)throw new TypeError(e+" is not a Number.");if(t>e||e>i)throw new RangeError(e+" is not a valid value for "+n+".");return!0},t.validateMillisecond=function(e){return t._validate(e,0,999,"millisecond")},t.validateSecond=function(e){return t._validate(e,0,59,"second")},t.validateMinute=function(e){return t._validate(e,0,59,"minute")},t.validateHour=function(e){return t._validate(e,0,23,"hour")},t.validateDay=function(e,i,n){return t._validate(e,1,t.getDaysInMonth(i,n),"day")
},t.validateMonth=function(e){return t._validate(e,0,11,"month")},t.validateYear=function(e){return t._validate(e,0,9999,"year")},i.set=function(e){return t.validateMillisecond(e.millisecond)&&this.addMilliseconds(e.millisecond-this.getMilliseconds()),t.validateSecond(e.second)&&this.addSeconds(e.second-this.getSeconds()),t.validateMinute(e.minute)&&this.addMinutes(e.minute-this.getMinutes()),t.validateHour(e.hour)&&this.addHours(e.hour-this.getHours()),t.validateMonth(e.month)&&this.addMonths(e.month-this.getMonth()),t.validateYear(e.year)&&this.addYears(e.year-this.getFullYear()),t.validateDay(e.day,this.getFullYear(),this.getMonth())&&this.addDays(e.day-this.getDate()),e.timezone&&this.setTimezone(e.timezone),e.timezoneOffset&&this.setTimezoneOffset(e.timezoneOffset),e.week&&t._validate(e.week,0,53,"week")&&this.setWeek(e.week),this},i.moveToFirstDayOfMonth=function(){return this.set({day:1})},i.moveToLastDayOfMonth=function(){return this.set({day:t.getDaysInMonth(this.getFullYear(),this.getMonth())})},i.moveToNthOccurrence=function(e,t){var i=0;if(t>0)i=t-1;else if(-1===t)return this.moveToLastDayOfMonth(),this.getDay()!==e&&this.moveToDayOfWeek(e,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(e,1).addWeeks(i)},i.moveToDayOfWeek=function(e,t){var i=(e-this.getDay()+7*(t||1))%7;return this.addDays(0===i?i+=7*(t||1):i)},i.moveToMonth=function(e,t){var i=(e-this.getMonth()+12*(t||1))%12;return this.addMonths(0===i?i+=12*(t||1):i)},i.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new e(this.getFullYear(),0,1))/864e5)+1},i.getTimezone=function(){return t.getTimezoneAbbreviation(this.getUTCOffset())},i.setTimezoneOffset=function(e){var t=this.getTimezoneOffset(),i=-6*Number(e)/10;return this.addMinutes(i-t)},i.setTimezone=function(e){return this.setTimezoneOffset(t.getTimezoneOffset(e))},i.hasDaylightSavingTime=function(){return e.today().set({month:0,day:1}).getTimezoneOffset()!==e.today().set({month:6,day:1}).getTimezoneOffset()
},i.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&(new e).getTimezoneOffset()===e.today().set({month:6,day:1}).getTimezoneOffset()},i.getUTCOffset=function(){var e,t=-10*this.getTimezoneOffset()/6;return 0>t?(e=(t-1e4).toString(),e.charAt(0)+e.substr(2)):(e=(t+1e4).toString(),"+"+e.substr(1))},i.getElapsed=function(t){return(t||new e)-this},i.toISOString||(i.toISOString=function(){function e(e){return 10>e?"0"+e:e}return'"'+this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+'Z"'});var l=i.toString,u=function(e){var t=this;if(e&&1==e.length){var i=n.formatPatterns;switch(t.t=t.toString,e){case"d":return t.t(i.shortDate);case"D":return t.t(i.longDate);case"F":return t.t(i.fullDateTime);case"m":return t.t(i.monthDay);case"r":return t.t(i.rfc1123);case"s":return t.t(i.sortableDateTime);case"t":return t.t(i.shortTime);case"T":return t.t(i.longTime);case"u":return t.t(i.universalSortableDateTime);case"y":return t.t(i.yearMonth)}}var r=function(e){switch(1*e){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return e?e.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(e){if("\\"===e.charAt(0))return e.replace("\\","");switch(t.h=t.getHours,e){case"hh":return a(t.h()<13?0===t.h()?12:t.h():t.h()-12);case"h":return t.h()<13?0===t.h()?12:t.h():t.h()-12;case"HH":return a(t.h());case"H":return t.h();case"mm":return a(t.getMinutes());case"m":return t.getMinutes();case"ss":return a(t.getSeconds());case"s":return t.getSeconds();case"yyyy":return a(t.getFullYear(),4);case"yy":return a(t.getFullYear());case"dddd":return n.dayNames[t.getDay()];case"ddd":return n.abbreviatedDayNames[t.getDay()];case"dd":return a(t.getDate());case"d":return t.getDate();case"MMMM":return n.monthNames[t.getMonth()];case"MMM":return n.abbreviatedMonthNames[t.getMonth()];case"MM":return a(t.getMonth()+1);
case"M":return t.getMonth()+1;case"t":return t.h()<12?n.amDesignator.substring(0,1):n.pmDesignator.substring(0,1);case"tt":return t.h()<12?n.amDesignator:n.pmDesignator;case"S":return r(t.getDate());default:return e}}):l.apply(this,arguments)};i.toString=u}(),function(){var t=e,i=t.prototype,n=t.CultureInfo,a=Number.prototype;i._orient=1,i._nth=null,i._is=!1,i._same=!1,i._isSecond=!1,a._dateElement="day",i.next=function(){return this._orient=1,this},t.next=function(){return t.today().next()},i.last=i.prev=i.previous=function(){return this._orient=-1,this},t.last=t.prev=t.previous=function(){return t.today().last()},i.is=function(){return this._is=!0,this},i.same=function(){return this._same=!0,this._isSecond=!1,this},i.today=function(){return this.same().day()},i.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},i.at=function(e){return"string"==typeof e?t.parse(this.toString("d")+" "+e):this.set(e)},a.fromNow=a.after=function(t){var i={};return i[this._dateElement]=this,(t?t.clone():new e).add(i)},a.ago=a.before=function(t){var i={};return i[this._dateElement]=-1*this,(t?t.clone():new e).add(i)};var r,s="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),o="january february march april may june july august september october november december".split(/\s/),l="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),u="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),c="final first second third fourth fifth".split(/\s/);i.toObject=function(){for(var e={},t=0;t<l.length;t++)e[l[t].toLowerCase()]=this["get"+u[t]]();return e},t.fromObject=function(t){return t.week=null,e.today().set(t)};for(var d=function(e){return function(){if(this._is)return this._is=!1,this.getDay()==e;if(null!==this._nth){this._isSecond&&this.addSeconds(-1*this._orient),this._isSecond=!1;var i=this._nth;this._nth=null;var n=this.clone().moveToLastDayOfMonth();if(this.moveToNthOccurrence(e,i),this>n)throw new RangeError(t.getDayName(e)+" does not occur "+i+" times in the month of "+t.getMonthName(n.getMonth())+" "+n.getFullYear()+".");
return this}return this.moveToDayOfWeek(e,this._orient)}},p=function(e){return function(){var i=t.today(),a=e-i.getDay();return 0===e&&1===n.firstDayOfWeek&&0!==i.getDay()&&(a+=7),i.addDays(a)}},f=0;f<s.length;f++)t[s[f].toUpperCase()]=t[s[f].toUpperCase().substring(0,3)]=f,t[s[f]]=t[s[f].substring(0,3)]=p(f),i[s[f]]=i[s[f].substring(0,3)]=d(f);for(var m=function(e){return function(){return this._is?(this._is=!1,this.getMonth()===e):this.moveToMonth(e,this._orient)}},h=function(e){return function(){return t.today().set({month:e,day:1})}},g=0;g<o.length;g++)t[o[g].toUpperCase()]=t[o[g].toUpperCase().substring(0,3)]=g,t[o[g]]=t[o[g].substring(0,3)]=h(g),i[o[g]]=i[o[g].substring(0,3)]=m(g);for(var v=function(t){return function(){if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;for(var i=this.toObject(),n=(arguments[0]||new e).toObject(),a="",r=t.toLowerCase(),s=l.length-1;s>-1;s--){if(a=l[s].toLowerCase(),i[a]!=n[a])return!1;if(r==a)break}return!0}return"s"!=t.substring(t.length-1)&&(t+="s"),this["add"+t](this._orient)}},b=function(e){return function(){return this._dateElement=e,this}},y=0;y<l.length;y++)r=l[y].toLowerCase(),i[r]=i[r+"s"]=v(l[y]),a[r]=a[r+"s"]=b(r);i._ss=v("Second");for(var _=function(e){return function(t){return this._same?this._ss(arguments[0]):t||0===t?this.moveToNthOccurrence(t,e):(this._nth=e,2!==e||void 0!==t&&null!==t?this:(this._isSecond=!0,this.addSeconds(this._orient)))}},x=0;x<c.length;x++)i[c[x]]=_(0===x?-1:x)}(),function(){e.Parsing={Exception:function(e){this.message="Parse error at '"+e.substring(0,10)+" ...'"}};for(var t=e.Parsing,i=t.Operators={rtoken:function(e){return function(i){var n=i.match(e);if(n)return[n[0],i.substring(n[0].length)];throw new t.Exception(i)}},token:function(){return function(e){return i.rtoken(new RegExp("^s*"+e+"s*"))(e)}},stoken:function(e){return i.rtoken(new RegExp("^"+e))},until:function(e){return function(t){for(var i=[],n=null;t.length;){try{n=e.call(this,t)}catch(a){i.push(n[0]),t=n[1];
continue}break}return[i,t]}},many:function(e){return function(t){for(var i=[],n=null;t.length;){try{n=e.call(this,t)}catch(a){return[i,t]}i.push(n[0]),t=n[1]}return[i,t]}},optional:function(e){return function(t){var i=null;try{i=e.call(this,t)}catch(n){return[null,t]}return[i[0],i[1]]}},not:function(e){return function(i){try{e.call(this,i)}catch(n){return[null,i]}throw new t.Exception(i)}},ignore:function(e){return e?function(t){var i=null;return i=e.call(this,t),[null,i[1]]}:null},product:function(){for(var e=arguments[0],t=Array.prototype.slice.call(arguments,1),n=[],a=0;a<e.length;a++)n.push(i.each(e[a],t));return n},cache:function(e){var i={},n=null;return function(a){try{n=i[a]=i[a]||e.call(this,a)}catch(r){n=i[a]=r}if(n instanceof t.Exception)throw n;return n}},any:function(){var e=arguments;return function(i){for(var n=null,a=0;a<e.length;a++)if(null!=e[a]){try{n=e[a].call(this,i)}catch(r){n=null}if(n)return n}throw new t.Exception(i)}},each:function(){var e=arguments;return function(i){for(var n=[],a=null,r=0;r<e.length;r++)if(null!=e[r]){try{a=e[r].call(this,i)}catch(s){throw new t.Exception(i)}n.push(a[0]),i=a[1]}return[n,i]}},all:function(){var e=arguments,t=t;return t.each(t.optional(e))},sequence:function(e,n,a){return n=n||i.rtoken(/^\s*/),a=a||null,1==e.length?e[0]:function(i){for(var r=null,s=null,o=[],l=0;l<e.length;l++){try{r=e[l].call(this,i)}catch(u){break}o.push(r[0]);try{s=n.call(this,r[1])}catch(c){s=null;break}i=s[1]}if(!r)throw new t.Exception(i);if(s)throw new t.Exception(s[1]);if(a)try{r=a.call(this,r[1])}catch(d){throw new t.Exception(r[1])}return[o,r?r[1]:i]}},between:function(e,t,n){n=n||e;var a=i.each(i.ignore(e),t,i.ignore(n));return function(e){var t=a.call(this,e);return[[t[0][0],r[0][2]],t[1]]}},list:function(e,t,n){return t=t||i.rtoken(/^\s*/),n=n||null,e instanceof Array?i.each(i.product(e.slice(0,-1),i.ignore(t)),e.slice(-1),i.ignore(n)):i.each(i.many(i.each(e,i.ignore(t))),px,i.ignore(n))},set:function(e,n,a){return n=n||i.rtoken(/^\s*/),a=a||null,function(r){for(var s=null,o=null,l=null,u=null,c=[[],r],d=!1,p=0;p<e.length;p++){l=null,o=null,s=null,d=1==e.length;
try{s=e[p].call(this,r)}catch(f){continue}if(u=[[s[0]],s[1]],s[1].length>0&&!d)try{l=n.call(this,s[1])}catch(m){d=!0}else d=!0;if(d||0!==l[1].length||(d=!0),!d){for(var h=[],g=0;g<e.length;g++)p!=g&&h.push(e[g]);o=i.set(h,n).call(this,l[1]),o[0].length>0&&(u[0]=u[0].concat(o[0]),u[1]=o[1])}if(u[1].length<c[1].length&&(c=u),0===c[1].length)break}if(0===c[0].length)return c;if(a){try{l=a.call(this,c[1])}catch(v){throw new t.Exception(c[1])}c[1]=l[1]}return c}},forward:function(e,t){return function(i){return e[t].call(this,i)}},replace:function(e,t){return function(i){var n=e.call(this,i);return[t,n[1]]}},process:function(e,t){return function(i){var n=e.call(this,i);return[t.call(this,n[0]),n[1]]}},min:function(e,i){return function(n){var a=i.call(this,n);if(a[0].length<e)throw new t.Exception(n);return a}}},n=function(e){return function(){var t=null,i=[];if(arguments.length>1?t=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(t=arguments[0]),!t)return e.apply(null,arguments);for(var n=0,a=t.shift();n<a.length;n++)return t.unshift(a[n]),i.push(e.apply(null,t)),t.shift(),i}},a="optional not ignore cache".split(/\s/),s=0;s<a.length;s++)i[a[s]]=n(i[a[s]]);for(var o=function(e){return function(){return arguments[0]instanceof Array?e.apply(null,arguments[0]):e.apply(null,arguments)}},l="each any all".split(/\s/),u=0;u<l.length;u++)i[l[u]]=o(i[l[u]])}(),function(){var t=e,i=(t.prototype,t.CultureInfo),n=function(e){for(var t=[],i=0;i<e.length;i++)e[i]instanceof Array?t=t.concat(n(e[i])):e[i]&&t.push(e[i]);return t};t.Grammar={},t.Translator={hour:function(e){return function(){this.hour=Number(e)}},minute:function(e){return function(){this.minute=Number(e)}},second:function(e){return function(){this.second=Number(e)}},meridian:function(e){return function(){this.meridian=e.slice(0,1).toLowerCase()}},timezone:function(e){return function(){var t=e.replace(/[^\d\+\-]/g,"");t.length?this.timezoneOffset=Number(t):this.timezone=e.toLowerCase()}},day:function(e){var t=e[0];
return function(){this.day=Number(t.match(/\d+/)[0])}},month:function(e){return function(){this.month=3==e.length?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(e)/4:Number(e)-1}},year:function(e){return function(){var t=Number(e);this.year=e.length>2?t:t+(t+2e3<i.twoDigitYearMax?2e3:1900)}},rday:function(e){return function(){switch(e){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(i){i=i instanceof Array?i:[i];for(var n=0;n<i.length;n++)i[n]&&i[n].call(this);var a=new e;if(!this.hour&&!this.minute||this.month||this.year||this.day||(this.day=a.getDate()),this.year||(this.year=a.getFullYear()),this.month||0===this.month||(this.month=a.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.meridian&&this.hour&&("p"==this.meridian&&this.hour<12?this.hour=this.hour+12:"a"==this.meridian&&12==this.hour&&(this.hour=0)),this.day>t.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var r=new e(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?r.set({timezone:this.timezone}):this.timezoneOffset&&r.set({timezoneOffset:this.timezoneOffset}),r},finish:function(i){if(i=i instanceof Array?n(i):[i],0===i.length)return null;for(var a=0;a<i.length;a++)"function"==typeof i[a]&&i[a].call(this);var r=t.today();if(this.now&&!this.unit&&!this.operator)return new e;this.now&&(r=new e);var s,o,l,u=!!(this.days&&null!==this.days||this.orient||this.operator);if(l="past"==this.orient||"subtract"==this.operator?-1:1,this.now||-1=="hour minute second".indexOf(this.unit)||r.setTimeToNow(),(this.month||0===this.month)&&-1!="year day hour minute second".indexOf(this.unit)&&(this.value=this.month+1,this.month=null,u=!0),!u&&this.weekday&&!this.day&&!this.days){var c=e[this.weekday]();this.day=c.getDate(),this.month||(this.month=c.getMonth()),this.year=c.getFullYear()
}if(u&&this.weekday&&"month"!=this.unit&&(this.unit="day",s=t.getDayNumberFromName(this.weekday)-r.getDay(),o=7,this.days=s?(s+l*o)%o:l*o),this.month&&"day"==this.unit&&this.operator&&(this.value=this.month+1,this.month=null),null!=this.value&&null!=this.month&&null!=this.year&&(this.day=1*this.value),this.month&&!this.day&&this.value&&(r.set({day:1*this.value}),u||(this.day=1*this.value)),this.month||!this.value||"month"!=this.unit||this.now||(this.month=this.value,u=!0),u&&(this.month||0===this.month)&&"year"!=this.unit&&(this.unit="month",s=this.month-r.getMonth(),o=12,this.months=s?(s+l*o)%o:l*o,this.month=null),this.unit||(this.unit="day"),!this.value&&this.operator&&null!==this.operator&&this[this.unit+"s"]&&null!==this[this.unit+"s"]?this[this.unit+"s"]=this[this.unit+"s"]+("add"==this.operator?1:-1)+(this.value||0)*l:(null==this[this.unit+"s"]||null!=this.operator)&&(this.value||(this.value=1),this[this.unit+"s"]=this.value*l),this.meridian&&this.hour&&("p"==this.meridian&&this.hour<12?this.hour=this.hour+12:"a"==this.meridian&&12==this.hour&&(this.hour=0)),this.weekday&&!this.day&&!this.days){var c=e[this.weekday]();this.day=c.getDate(),c.getMonth()!==r.getMonth()&&(this.month=c.getMonth())}return!this.month&&0!==this.month||this.day||(this.day=1),this.orient||this.operator||"week"!=this.unit||!this.value||this.day||this.month?(u&&this.timezone&&this.day&&this.days&&(this.day=this.days),u?r.add(this):r.set(this)):e.today().setWeek(this.value)}};var a,r=t.Parsing.Operators,s=t.Grammar,o=t.Translator;s.datePartDelimiter=r.rtoken(/^([\s\-\.\,\/\x27]+)/),s.timePartDelimiter=r.stoken(":"),s.whiteSpace=r.rtoken(/^\s*/),s.generalDelimiter=r.rtoken(/^(([\s\,]|at|@|on)+)/);var l={};s.ctoken=function(e){var t=l[e];if(!t){for(var n=i.regexPatterns,a=e.split(/\s+/),s=[],o=0;o<a.length;o++)s.push(r.replace(r.rtoken(n[a[o]]),a[o]));t=l[e]=r.any.apply(null,s)}return t},s.ctoken2=function(e){return r.rtoken(i.regexPatterns[e])},s.h=r.cache(r.process(r.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),o.hour)),s.hh=r.cache(r.process(r.rtoken(/^(0[0-9]|1[0-2])/),o.hour)),s.H=r.cache(r.process(r.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),o.hour)),s.HH=r.cache(r.process(r.rtoken(/^([0-1][0-9]|2[0-3])/),o.hour)),s.m=r.cache(r.process(r.rtoken(/^([0-5][0-9]|[0-9])/),o.minute)),s.mm=r.cache(r.process(r.rtoken(/^[0-5][0-9]/),o.minute)),s.s=r.cache(r.process(r.rtoken(/^([0-5][0-9]|[0-9])/),o.second)),s.ss=r.cache(r.process(r.rtoken(/^[0-5][0-9]/),o.second)),s.hms=r.cache(r.sequence([s.H,s.m,s.s],s.timePartDelimiter)),s.t=r.cache(r.process(s.ctoken2("shortMeridian"),o.meridian)),s.tt=r.cache(r.process(s.ctoken2("longMeridian"),o.meridian)),s.z=r.cache(r.process(r.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),o.timezone)),s.zz=r.cache(r.process(r.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),o.timezone)),s.zzz=r.cache(r.process(s.ctoken2("timezone"),o.timezone)),s.timeSuffix=r.each(r.ignore(s.whiteSpace),r.set([s.tt,s.zzz])),s.time=r.each(r.optional(r.ignore(r.stoken("T"))),s.hms,s.timeSuffix),s.d=r.cache(r.process(r.each(r.rtoken(/^([0-2]\d|3[0-1]|\d)/),r.optional(s.ctoken2("ordinalSuffix"))),o.day)),s.dd=r.cache(r.process(r.each(r.rtoken(/^([0-2]\d|3[0-1])/),r.optional(s.ctoken2("ordinalSuffix"))),o.day)),s.ddd=s.dddd=r.cache(r.process(s.ctoken("sun mon tue wed thu fri sat"),function(e){return function(){this.weekday=e
}})),s.M=r.cache(r.process(r.rtoken(/^(1[0-2]|0\d|\d)/),o.month)),s.MM=r.cache(r.process(r.rtoken(/^(1[0-2]|0\d)/),o.month)),s.MMM=s.MMMM=r.cache(r.process(s.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),o.month)),s.y=r.cache(r.process(r.rtoken(/^(\d\d?)/),o.year)),s.yy=r.cache(r.process(r.rtoken(/^(\d\d)/),o.year)),s.yyy=r.cache(r.process(r.rtoken(/^(\d\d?\d?\d?)/),o.year)),s.yyyy=r.cache(r.process(r.rtoken(/^(\d\d\d\d)/),o.year)),a=function(){return r.each(r.any.apply(null,arguments),r.not(s.ctoken2("timeContext")))},s.day=a(s.d,s.dd),s.month=a(s.M,s.MMM),s.year=a(s.yyyy,s.yy),s.orientation=r.process(s.ctoken("past future"),function(e){return function(){this.orient=e}}),s.operator=r.process(s.ctoken("add subtract"),function(e){return function(){this.operator=e}}),s.rday=r.process(s.ctoken("yesterday tomorrow today now"),o.rday),s.unit=r.process(s.ctoken("second minute hour day week month year"),function(e){return function(){this.unit=e}}),s.value=r.process(r.rtoken(/^\d\d?(st|nd|rd|th)?/),function(e){return function(){this.value=e.replace(/\D/g,"")}}),s.expression=r.set([s.rday,s.operator,s.value,s.unit,s.orientation,s.ddd,s.MMM]),a=function(){return r.set(arguments,s.datePartDelimiter)},s.mdy=a(s.ddd,s.month,s.day,s.year),s.ymd=a(s.ddd,s.year,s.month,s.day),s.dmy=a(s.ddd,s.day,s.month,s.year),s.date=function(e){return(s[i.dateElementOrder]||s.mdy).call(this,e)},s.format=r.process(r.many(r.any(r.process(r.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(e){if(s[e])return s[e];throw t.Parsing.Exception(e)}),r.process(r.rtoken(/^[^dMyhHmstz]+/),function(e){return r.ignore(r.stoken(e))}))),function(e){return r.process(r.each.apply(null,e),o.finishExact)});var u={},c=function(e){return u[e]=u[e]||s.format(e)[0]};s.formats=function(e){if(e instanceof Array){for(var t=[],i=0;i<e.length;i++)t.push(c(e[i]));return r.any.apply(null,t)}return c(e)},s._formats=s.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),s._start=r.process(r.set([s.date,s.time,s.expression],s.generalDelimiter,s.whiteSpace),o.finish),s.start=function(e){try{var t=s._formats.call({},e);
if(0===t[1].length)return t}catch(i){}return s._start.call({},e)},t._parse=t.parse,t.parse=function(i){var n=null;if(!i)return null;if(i instanceof e)return i;if(i instanceof window.Date)return new e(i);try{n=t.Grammar.start.call({},i.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(a){return null}var r=0===n[1].length?n[0]:null;return r&&(r=new e(r)),r},t.getParseFunction=function(e){var i=t.Grammar.formats(e);return function(e){var t=null;try{t=i.call({},e)}catch(n){return null}return 0===t[1].length?t[0]:null}},t.parseExact=function(e,i){return t.getParseFunction(i)(e)}}(),e[t]=!0,e)}),define("tau/utils/utils.date/utils.date.wrapper",["libs/date.js/build/date"],function(e){return e.prototype.getDaysInMonth=function(){return e.getDaysInMonth(this.getFullYear(),this.getMonth())},e}),define("tau/utils/utils.date/utils.date.formats",[],function(){var e={};return e={date:{"short":"d-MMM-yyyy",iso:"yyyy-MM-dd"},time:{"short":"HH:mm",iso:"HH:mm:ss"},datetime:{"short":"d-MMM-yyyy HH:mm",full:"d-MMM-yyyy HH:mm:ss",iso:"yyyy-MM-ddTHH:mm:ss"}}}),define("tau/utils/utils.translation",["Underscore"],function(e){var t={pluralize:function(t,i){var n=e.isArray(t)?t:t.split("|"),a=function(e){return 1===e?0:1},r=a(i);return n[r]?n[r]:n[0]},BAD_SHORTENINGS:{ass:!0},shorten:function(t,i){t=e.trim(t||""),i=i||3;var n=e.trim(t.slice(0,i));return this.BAD_SHORTENINGS[n.toLowerCase()]&&(n=n.replace(/.$/,".")),n}};return t}),define("libs/date.js/build/time.special",[],function(){TimeSpan=function(e,t){this.days=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0;var i=0>e?-1:1;return this.milliseconds=Math.abs(e),t=t||Math.floor,this.days=t(this.milliseconds/864e5)*i,this.milliseconds=this.milliseconds%864e5,this.hours=t(this.milliseconds/36e5)*i,this.milliseconds=this.milliseconds%36e5,this.minutes=t(this.milliseconds/6e4)*i,this.milliseconds=this.milliseconds%6e4,this.seconds=t(this.milliseconds/1e3)*i,this.milliseconds=this.milliseconds%1e3,this.milliseconds=this.milliseconds*i,this
},TimeSpan.prototype.compare=function(e){var t,i=new Date(1970,1,1,this.hours(),this.minutes(),this.seconds());return t=null===e?new Date(1970,1,1,0,0,0):new Date(1970,1,1,e.hours(),e.minutes(),e.seconds()),i>t?1:t>i?-1:0},TimeSpan.prototype.add=function(e){return null===e?this:this.addSeconds(e.getTotalMilliseconds()/1e3)},TimeSpan.prototype.subtract=function(e){return null===e?this:this.addSeconds(-e.getTotalMilliseconds()/1e3)},TimeSpan.prototype.addDays=function(e){return new TimeSpan(this.getTotalMilliseconds()+24*e*60*60*1e3)},TimeSpan.prototype.addHours=function(e){return new TimeSpan(this.getTotalMilliseconds()+60*e*60*1e3)},TimeSpan.prototype.addMinutes=function(e){return new TimeSpan(this.getTotalMilliseconds()+60*e*1e3)},TimeSpan.prototype.addSeconds=function(e){return new TimeSpan(this.getTotalMilliseconds()+1e3*e)},TimeSpan.prototype.addMilliseconds=function(e){return new TimeSpan(this.getTotalMilliseconds()+e)},TimeSpan.prototype.getTotalMilliseconds=function(){return 864e5*this.days()+36e5*this.hours()+6e4*this.minutes()+1e3*this.seconds()},TimeSpan.prototype.get12HourHour=function(){return(h=this.hours()%12)?h:12},TimeSpan.prototype.getDesignator=function(){return this.hours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator},TimeSpan.prototype.toString=function(e){function t(e){return e.toString().length<2?"0"+e:e}var i=this;return e?e.replace(/d|dd|HH|H|hh|h|mm|m|ss|s|tt|t/g,function(e){switch(e){case"d":return i.days();case"dd":return t(i.days());case"H":return i.hours();case"HH":return t(i.hours());case"h":return i.get12HourHour();case"hh":return t(i.get12HourHour());case"m":return i.minutes();case"mm":return t(i.minutes());case"s":return i.seconds();case"ss":return t(i.seconds());case"t":return(this.hours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return this.hours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()};var e=function(e,t,i){this.years=0,this.months=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0;
var n=e.clone(),a=t.clone(),r=n.clone(),s=n>a?-1:1;if(this.years=a.getFullYear()-n.getFullYear(),r.addYears(this.years),1==s?r>a&&0!==this.years&&this.years--:a>r&&0!==this.years&&this.years++,n.addYears(this.years),1==s)for(;a>n&&n.clone().addDays(n.getDaysInMonth())<=a;)n.addMonths(1),this.months++;else for(;n>a&&n.clone().addDays(-n.getDaysInMonth())>=a;)n.addMonths(-1),this.months--;var o=a-n;if(0!==o){var l=new TimeSpan(o,i);this.days=l.days,this.hours=l.hours,this.minutes=l.minutes,this.seconds=l.seconds,this.milliseconds=l.milliseconds}return this.months>=1&&this.months<11&&this.days>14&&(this.months+=1),this.years>=1&&this.months>5&&(this.years+=1),this};return{TimePeriod:e,TimeSpan:TimeSpan}}),define("tau/utils/utils.date",["Underscore","tau/utils/utils.date/utils.date.wrapper","tau/utils/utils.date/utils.date.formats","tau/utils/utils.translation","libs/date.js/build/time.special"],function(e,t,i,n,a){var r={},s="/Date",o=/^\/Date\((-?\d+)(([+-])(\d{2})(\d{2}))\)\//,l=function(e){return function(t){var i=r.parse(t);return i?r._format(i,e):""}};return r={Date:t,format:{date:{"short":l(i.date.short),iso:l(i.date.iso)},time:{"short":l(i.time.short),iso:l(i.time.iso)},datetime:{"short":l(i.datetime.short),full:l(i.datetime.full),iso:l(i.datetime.iso)}},_format:function(e,t){return e.toString(t)||""},formatAs:function(e,i){return e instanceof t||(e=new t(e)),this._format(e,i)},_getServerTimezonOffset:function(){var e=window.tauServerInfo||{timeZoneOffsetInMilliseconds:0};return e.timeZoneOffsetInMilliseconds},_convertToServerTime:function(e){return new t(e.getTime()-this._getServerTimezonOffset())},getServerNow:function(){return this.__now||this._convertToServerTime(new t)},lockNow:function(e){this.__now=new t(e)},unlockNow:function(){this.__now=null},parse:function(i){if(e.isString(i)&&0===i.indexOf(s)){var n=i.match(o),a=parseInt(n[1]),r=(60*parseInt(n[4])+parseInt(n[5]))*parseInt(n[3]+"1");i=new t(a),i.sourceOffset=r}return t.parse(i)},convertToTimezone:function(e,i){if(e=r.parse(e),!e)return e;
if(!i){var n=e.sourceOffset;i=null!==n&&void 0!==n?n:null}if(null===i||void 0===i)return e;var a=e.getTimezoneOffset(),s=60*(i+a)*1e3;return e=new t(e.getTime()+s)},getFormatData:function(){return i},getAge:function(i,r){i=t.parse(i),r=t.parse(r);var s={isZero:!0,value:0,unit:"sec",direction:r>i?"ago":"after",toString:function(){return this.isZero?"now":this.value+" "+this.unit+" "+this.direction}},o=new a.TimePeriod(i,r,function(e){return 1===e?1:1>e?0:Math.round(e)}),l=[{func:"years",units:"year|years"},{func:"months",units:"month|months"},{func:"days",units:"day|days"},{func:"hours",units:"hour|hours"},{func:"minutes",units:"min"},{func:"seconds",units:"sec"}],u=e.detect(l,function(e){var t=o[e.func];return 0!==t?(e.value=Math.abs(t),e.unit=n.pluralize(e.units,t),!0):void 0});return u&&(s.isZero=!1,s.value=u.value,s.unit=u.unit),s},addDays:function(e,i){return new t(e.getTime()+864e5*i)},getDiff:function(e,t){return e-t-60*e.getTimezoneOffset()*1e3+60*t.getTimezoneOffset()*1e3},getDiffInDays:function(e,t){return Math.ceil(this.getDiff(e,t)/864e5)},getDiffInMinutes:function(e,t){return Math.ceil(this.getDiff(e,t)/6e4)},addMinutes:function(e,i){return new t(e.getTime()+6e4*i)},sameDay:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},parseTimestamp:function(e){var t=6,i=e.length-2,n=e.substring(t,i);return parseInt(n)},parseTimestampToDate:function(e){return new t(this.parseTimestamp(e))},toTimestamp:function(e){return"/Date("+e.valueOf()+"+0000)/"},between:function(e,i,n){var a=new t(e.getYear(),e.getMonth(),e.getDate()),r=new t(i.getYear(),i.getMonth(),i.getDate()),s=new t(n.getYear(),n.getMonth(),n.getDate()+1);return a>=r&&s>a},getNow:function(){return new t}}}),define("tau/utils/utils.constants",["jQuery"],function(){return function(){var e={},t=Object.prototype.hasOwnProperty,i={string:1,number:1,"boolean":1,regexp:1};return e.emailRegexp=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,{define:function(n,a){return this.defined(n)?!1:t.call(i,$.type(a))?(e[n]=a,!0):!1
},defined:function(i){return t.call(e,i)},get:function(t){return this.defined(t)?e[t]:null}}}()}),define("tau/services/service.avatar",["tau/core/class","tau/core/tau"],function(e,t){var i=e.extend({init:function(e){this.appPath=e,this.service=$.ajax},getCropRect:function(e){return this.service({url:this.appPath+"/avatar.ashx?userid="+e+"&operation=CropRect&"+(new Date).getTime()+t.getTokenParameterFromQueryString("&")}).then(function(e){return JSON.parse(e).CropRect},function(e){return JSON.parse(e.responseText)})},crop:function(e){return this.service({url:e}).then(function(e){return JSON.parse(e)},function(e){return JSON.parse(e.responseText)})},remove:function(e){return this.service({url:e}).then(function(e){return JSON.parse(e)},function(e){return JSON.parse(e.responseText)})}});return i}),define("tau/services/comet/comet.subscriber",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(i,n){this.subscriptionIds=[],this.resourceProxy=n.get(i),this.aborted=t.Deferred(),this.resourceProxy.onStatus.progress(e.bind(function(t){var i=e.difference(this.subscriptionIds,t);i.length>0&&this.aborted.resolve()},this))},subscribe:function(t,i){var n=e.bind(function(e,t,i){this.subscriptionIds=e.union(this.subscriptionIds,i),t(this.subscriptionIds)},this,e,i);this.resourceProxy.subscribe(t,n)},unsubscribe:function(e){this.resourceProxy.unsubscribe(this.subscriptionIds,e),this.subscriptionIds=[]}})}),define("tau/services/comet/comet.connection",["require","jQuery","Underscore","tau/core/class","./comet.subscriber"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("tau/core/class"),a=e("./comet.subscriber");return n.extend({init:function(e){this._featureService=e,this._callbacksAsyncProxyDisconnected=t.Callbacks(),this._$asyncProxyStarted=t.Deferred(),this._lockOpenForInitialization=!0,this.disconnectedOnce=this._callbacksAsyncProxyDisconnected.add,this._namespace=".cometConnection"+i.uniqueId(),t(window).on("beforeunload"+this._namespace,function(){this._callbacksAsyncProxyDisconnected.disable()
}.bind(this))},startAsync:function(i){this._featureService.isEnabled("comet.notifications")&&(i=i||t.noop,this._$asyncProxyStarted.done(i),this._lockOpenForInitialization&&(this._lockOpenForInitialization=!1,e(["tp/serverNotifications"],function(e){e&&(e.disconnected(function(){this._lockOpenForInitialization=!0,this._$asyncProxyStarted=t.Deferred(),this._callbacksAsyncProxyDisconnected.fire().empty()}.bind(this)),e.start(function(){var t={createSubscriber:function(t){return new a(t,e)}};this._$asyncProxyStarted.resolve(t)}.bind(this)))}.bind(this))))},clearSubscriptions:function(){this._callbacksAsyncProxyDisconnected.empty()},destroy:function(){this.clearSubscriptions(),t(window).off(this._namespace)}})}),define("tau/services/comet/comet.subscription",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(i,n,a){this.connection=a,e.isArray(n)||(n=[n]),this.deferDisconnected=t.Deferred(),this.$cmdOnAbort=t.Deferred(),this.$cmdStart=t.Deferred(),this.$cmdStarted=t.Deferred(),this.$cmdStop=t.Deferred(),this.$cmdStopped=t.Deferred(),this.$cmdNotify=t.Deferred(),this.$cmdBatchNotify=t.Deferred(),this.params=e.map(n,e.bind(function(e){return e.callback=this.$cmdNotify.notify,e.batchCallback=this.$cmdBatchNotify.notify,e.clientId=e.parameters.clientId,e},this)),this.connection.disconnectedOnce(this.deferDisconnected.resolve),this.connection.startAsync(e.bind(function(e){this.setSubscriber(e.createSubscriber(i))},this))},disconnected:function(e){return this.deferDisconnected.done(e),this},aborted:function(e){return this.$cmdOnAbort.done(e),this},start:function(e){return this.$cmdStarted.done(e),this.$cmdStart.resolve(this.params),this},stop:function(e){this.deferDisconnected=t.Deferred(),this.$cmdStopped.done(e),this.$cmdStarted.done(this.$cmdStop.resolve),this.connection.clearSubscriptions()},on:function(i){var n={},a=function(e){var t=n["*"];t&&t.notify(e);var i=(e.data.modification||"").toLowerCase(),a=n[i];a&&a.notify(e)},r=t.Deferred(),s=function(e){r.notify(e)
};this.$cmdNotify.progress(a),this.$cmdBatchNotify.progress(s);var o=(i.eventName||"*").toLowerCase(),l=i.callback||t.noop,u=i.batchCallback||t.noop;e.has(n,o)||(n[o]=t.Deferred()),r.progress(u);var c=n[o];return c.progress(l),this},setSubscriber:function(t){this.subscriber=t,this.subscriber.aborted.done(this.$cmdOnAbort.resolve),this.$cmdStop.done(e.bind(function(){this.subscriber.unsubscribe(this.$cmdStopped.resolve)},this)),this.$cmdStart.done(e.bind(function(e){this.subscriber.subscribe(e,this.$cmdStarted.resolve)},this))}})}),define("tau/services/comet/service.comet",["Underscore","tau/core/class","./comet.subscription"],function(e,t,i){return t.extend({init:function(e){this._cometConnection=e},listen:function(e,t){return new i(e,t,this._cometConnection)}})}),define("tau/services/service.tp2",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({showPopupToChangeProcessWorkflow:function(e,i,n,a){i.tauIFramePopup({url:e.getUrlBuilder().getAdminWorkflowEdit(a)}),i.on("tauiframepopupload",function(e,i){var a=t((i[0].contentDocument||i[0].contentWindow.document).body),r=a.find("._entities"),s=r.find("option").filter(function(e,i){return t(i).attr("value").toLowerCase()=="tp.businessobjects."+n.toLowerCase()});r.val(s.attr("value")),r.trigger("change")}),i.tauIFramePopup("show")},showEditProcessPopup:function(e,i){t("<i>").tauIFramePopup({url:e.getUrlBuilder().getAdminProcessEdit(i)}).tauIFramePopup("show").on("tauiframepopuphide",function(){t(this).remove()})}})}),define("tau/services/service.boardCacheData",["tau/core/class"],function(e){var t={},i=e.extend({setData:function(e){t=e},getData:function(){return t},evict:function(){t={}}});return i}),define("tau/models/board.customize.units/const.entity.types.names",[],function(){var e={GENERAL:"general",US:"userstory",BUG:"bug",FEATURE:"feature",EPIC:"epic",TASK:"task",REQUEST:"request",TEST_CASE:"testcase",TEST_CASE_RUN:"testcaserun",IMPEDIMENT:"impediment",USER:"user",ASSIGNED_USER:"assigneduser",TEAM:"team",TIME:"time",PROJECT:"project",ITERATION:"iteration",TEAM_ITERATION:"teamiteration",RELEASE:"release",TEST_PLAN:"testplan",TEST_PLAN_RUN:"testplanrun",BUILD:"build",PROJECT_MEMBER:"projectmember",INBOUND_RELATIONS:"inboundrelations",OUTBOUND_RELATIONS:"outboundrelations",PROGRAM:"program",ANY_TYPE:"anytype"};
return e.STORY=e.US,e}),define("tau/models/board.customize.units/const.card.sizes",["Underscore"],function(e){var t={XS:"xs",S:"s",M:"m",L:"l",XL:"xl",LIST:"list"},i={2:t.XS,3:t.S,4:t.M,5:t.L,6:t.XL},n=function(){e.extend(this,t)};return n.prototype.has=function(t){return e.isString(t)&&this[t.toUpperCase()]},n.prototype.zoomToSize=function(e){return i[e]},n.prototype.sizeToZoom=function(t){var n=e.chain(e.pairs(i)).filter(function(e){return e[1]==t.toLowerCase()}).map(function(e){return parseInt(e[0])}).value();return n&&n[0]},new n}),define("tau/models/board.customize.units/const.sorting.applying",["Underscore"],function(){return{ALL:"all",NONE:"none",SINGLE:"single"}}),define("tau/models/board.customize.units/board.customize.units.base",["Underscore","app.path"],function(e,t){return{url:function(e){return t.get()+e},pushClones:function(t,i,n){e.each(n,function(n){t.push(e.extend(e.deepClone(i),n))})},createUnitValueWrapperTemplate:function(e){return[].concat('<div class="tau-board-unit__value">',e,"</div>")}}}),define("tau/models/board.customize.units/board.customize.units.simple",["Underscore","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/const.sorting.applying","tau/models/board.customize.units/board.customize.units.base","app.path","tau/utils/utils.date"],function(e,t,i,n,a,r,s){var o=[i.XS,i.S,i.M,i.L,i.XL],l=[i.XS,i.S,i.M,i.L,i.XL,i.LIST],u={daysOrHoursValue:function(e,t){return this.precise_round(1>e?24*e:e,t||1)},daysOrHoursUnit:function(e){return 1>e?"h":"d"}},c=function(e){return['<div class="tau-board-unit__value_type_day"><%=fn.formatDayShort(this.data.{{DATE}})%></div>','<div class="tau-board-unit__value_type_month"><%=fn.formatDate(this.data.{{DATE}}, "MMM")%></div>','<div class="tau-board-unit__value_type_year"><%=fn.formatDate(this.data.{{DATE}}, "yyyy")%></div>'].join("").replace(new RegExp("{{DATE}}","g"),e)},d=['<div class="tau-board-unit_type_date-range__start-date <% if (this.data.isCurrent) { %>tau-date-range_current<%}%>">',"<% if (this.data.startDate) {%>",'<div class="tau-board-unit__value_type_day"><%= fn.formatDayShort(this.data.startDate)%></div>','<div class="tau-board-unit__value_type_month"><%= fn.formatDate(this.data.startDate, "MMM")%></div>',"<% } else {%>",'<div class="tau-board-unit__value_type_unknown">not set</div>',"<%}%>","</div>",'<div class="tau-board-unit_type_date-range__end-date <%if (this.data.isCurrent) {%>tau-date-range_current<%}%>">',"<% if(this.data.endDate) {%>",'<div class="tau-board-unit__value_type_day"><%= fn.formatDayShort(this.data.endDate)%></div>','<div class="tau-board-unit__value_type_month"><%= fn.formatDate(this.data.endDate, "MMM")%></div>',"<% } else {%>",'<div class="tau-board-unit__value_type_unknown">not set</div>',"<%}%>","</div>"],p=['<div class="tau-board-unit_type_date-range__start-date <% if (this.data.isActive) { %>tau-date-range_current<%}%>">',"<% if (this.data.startDate) {%>",'<div class="tau-board-unit__value_type_day"><%= fn.formatDate(this.data.startDate, "dd") %></div>','<div class="tau-board-unit__value_type_month"><%=fn.formatDate(this.data.startDate, "MMM")%></div>','<div class="tau-board-unit__value_type_year"><%=fn.formatDate(this.data.startDate, "yyyy")%></div>',"<% } else {%>",'<div class="tau-board-unit__value_type_unknown">not set</div>',"<%}%>","</div>",'<div class="tau-board-unit_type_date-range__end-date <% if (this.data.isActive) { %>tau-date-range_current<%}%>">',"<% if (this.data.endDate) {%>",'<div class="tau-board-unit__value_type_day"><%= fn.formatDate(this.data.endDate, "dd")%></div>','<div class="tau-board-unit__value_type_month"><%=fn.formatDate(this.data.endDate, "MMM")%></div>','<div class="tau-board-unit__value_type_year"><%=fn.formatDate(this.data.endDate, "yyyy")%></div>',"<% } else {%>",'<div class="tau-board-unit__value_type_unknown">not set</div>',"<%}%>","</div>"],f=a.createUnitValueWrapperTemplate.bind(a),m=function(e){return r.get()+e
},h=function(t,i){var n=e.isUndefined(t);return n?i||"skipped":t?"passed":"failed"},g=[{id:"general_entity_id",classId:"tau-board-unit_type_id",name:"Id",header:"ID",rank:100,settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST]},{types:[t.GENERAL,t.INBOUND_RELATIONS,t.OUTBOUND_RELATIONS],sizes:[i.LIST]}],template:['<div class="tau-board-unit__value">','<%= fn.generateEntityLink(this, this.data, this.data.entityType.name, { className: "" }) %>',"</div>"],sampleData:{id:193011,entityType:{name:"userstory"}},listSettings:{title:'<%= fn.term(this.data.entityType.name, "name") + " #" + this.data.id %>'}},{id:"user_entity_id",classId:"tau-board-unit_type_id",name:"Id",header:"ID",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value">','<%= fn.generateEntityLink(this, this.data, "user", { className: "" }) %>',"</div>"],sampleData:{id:193011},listSettings:{title:'<%= fn.term(this.type, "name") + " #" + this.data.id %>'}},{id:"entity_name_1line",classId:"tau-board-unit_type_entity-name",name:"Name",settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],sizes:[i.M,i.L,i.XL,i.LIST]},{types:[t.GENERAL,t.INBOUND_RELATIONS,t.OUTBOUND_RELATIONS],sizes:[i.LIST]}],sections:1,rank:101,isNameUnit:!0,template:['<div class="tau-board-unit__value tau-name i-role-name"><%!this.data.name%></div>'],sampleData:{name:"Chances are you'll remember information printed in a font like this one better than information presented in a font like this, because less legible fonts make you concentrate harder."},editorConfig:{type:"title",template:{name:"title.simple"}}},{id:"entity_name_small_sizes",classId:"tau-board-unit_type_entity-name-extended-small",name:"Name",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],sizes:o,sections:1,isStretchable:!1,template:['<div class="tau-board-unit__value tau-name i-role-name"><%!this.data.name%></div>'],sampleData:{name:"Chances are you'll remember information printed in a font like this one better than information presented in a font like this, because less legible fonts make you concentrate harder."}},{id:"entity_name_3lines",classId:"tau-board-unit_type_entity-name-extended",name:"Name",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],sizes:[i.S,i.M,i.L,i.XL],sections:2,template:['<div class="tau-board-unit__value tau-name i-role-name"><%!this.data.name%></div>'],sampleData:{name:"Chances are you'll remember information printed in a font like this one better than information presented in a font like this"}},{id:"entity_name_5lines",classId:"tau-board-unit_type_entity-name-extended-plus",name:"Name",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],sizes:[i.M],sections:3,template:['<div class="tau-board-unit__value tau-name i-role-name"><%!this.data.name%></div>'],sampleData:{name:"Chances are you'll remember information printed in a font like this one better than information presented in a font like this. Cras tristique at lacus pretium rutrum. Sed suscipit aliquam diam, nec feugiat quam pharetra ac. Suspendisse vel neque laoreet"}},{id:"team_project_name_short",classId:"tau-board-unit_type_entity-name",name:"Name",types:[t.TEAM,t.PROJECT],sizes:[i.XS,i.M,i.L,i.XL],template:['<div class="tau-board-unit__value tau-name i-role-name"><%!fn.trim(this.data.name,15)%></div>'],sampleData:{name:"Custom Graphic Reports"},editorConfig:{type:"title",template:{name:"title.simple"}}},{id:"team_project_name_long",classId:"tau-board-unit_type_entity-name",name:"Name",types:[t.TEAM,t.PROJECT],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],sections:1,rank:101,isNameUnit:!0,template:['<div class="tau-board-unit__value tau-name i-role-name"><%!this.data.name%></div>'],sampleData:{name:"Custom Graphic Reports"},editorConfig:{type:"title",template:{name:"title.simple"}}},{id:"user_name",classId:"tau-board-unit_type_user-name",name:"Full name",header:"Full Name",isNameUnit:!0,settings:[{types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"firstName,lastName,email",sortConfig:{field:"lastName,firstName,email"}},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"user.firstName,user.lastName,user.email",sortConfig:{field:"user.lastName,user.firstName,user.email"}}],template:['<div class="tau-board-unit__value tau-name i-role-name">','<%! (this.data.firstName && this.data.lastName || this.data.empty)? [this.data.firstName, this.data.lastName].join(" ") : this.data.email %></div>'],sampleData:{firstName:"Uladzimir",lastName:"Karatkievich",email:"u.karatkievich@writer.com"}},{id:"effort_spent_total",classId:"tau-board-unit_type_effort-todo-total",name:"Todo/total effort",header:"Effort",types:[t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN,t.FEATURE,t.EPIC],sizes:l,sortConfig:{allowed:n.NONE},template:['<div class="tau-board-unit__value-todo"><%=fn.precise_round(this.data.effortToDo||0,1)%></div>','<div class="tau-board-unit__value-total"><%=fn.precise_round(this.data.effort||0,1)%></div>','<div class="tau-board-unit__points"><%=this.data.units%></div>'],sampleData:{effortToDo:20.5,effort:55.5,units:"pt"},listSettings:{title:["<%= fn.precise_round(this.data.effortToDo || 0, 1) %>"," / ","<%= fn.precise_round(this.data.effort || 0, 1) %><%= this.data.units %>"]}},{id:"effort_total",classId:"tau-board-unit_type_effort-total",name:"Total effort",header:"Effort",types:[t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN,t.FEATURE,t.EPIC],sizes:l,template:['<div class="tau-board-unit__value"><%=fn.precise_round(this.data.effort||0,1)%></div>','<div class="tau-board-unit__points"><%=this.data.units%></div>'],sampleData:{effort:10.5,units:"pt"},editorConfig:{type:"effort",isEditable:function(e){return"feature"!==e.type&&"epic"!==e.type
}}},{id:"create_date",classId:"tau-board-unit_type_date tau-board-unit_type_creation-date",hideIf:function(e){return!e.createDate},name:"Created",settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:l},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST]}],template:f(c("createDate")),sampleData:{createDate:"/Date(1385350733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.createDate, "dd MMM yyyy")%>'}},{id:"last_login_date",classId:"tau-board-unit_type_time-last-login",name:"Last login",header:"Last Login",settings:[{types:[t.USER],sizes:[i.M,i.L,i.XL,i.LIST]}],template:['<div class="tau-board-unit__value">',"<% if (this.data.lastLoginDate) { %>",c("lastLoginDate"),"<% } else { %>",'<span class="tau-board-unit_type_time-last-login-never">unknown</span>',"<% } %>","</div>"],sampleData:{lastLoginDate:"/Date(1385350733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.lastLoginDate, "dd MMM yyyy")%>'}},{id:"start_date",classId:"tau-board-unit_type_date tau-board-unit_type_start-date",hideIf:function(e){return!e.startDate},name:"Started",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.PROJECT,t.PROGRAM],sizes:l,template:f(c("startDate")),sampleData:{startDate:"/Date(1385360733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.startDate, "dd MMM yyyy")%>'}},{id:"dates",classId:"tau-board-unit_type_date-range",hideIf:function(e){return!e.startDate&&!e.endDate},name:"Started  Finished",sortConfig:{allowed:n.NONE},types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:l,template:f(d),listSettings:{title:["<% if (this.data.startDate || this.data.endDate) { %>",'<%= this.data.startDate ? fn.formatDate(this.data.startDate, "dd MMM") : "..."%>',"  ",'<%= this.data.endDate ? fn.formatDate(this.data.endDate, "dd MMM") : "..."%>',"<% } %>"]},sampleData:{startDate:"/Date(1385360733000-0500)/",endDate:"/Date(1305360733000-0500)/",isCurrent:!1}},{id:"pm_dates",classId:"tau-board-unit_type_date-range",hideIf:function(e){return!e.startDate&&!e.endDate
},name:"Started  Finished",sortConfig:{allowed:n.NONE},types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:f(p),sampleData:{startDate:"/Date(1305360733000-0500)/",endDate:"/Date(1385360733000-0500)/"},model:"startDate:membershipStartDate,endDate:membershipEndDate",listSettings:{title:['<%= fn.cond(this.data.startDate, fn.formatDate(this.data.startDate, "dd MMM yyyy"), "not set") %>',"  ",'<%= fn.cond(this.data.endDate, fn.formatDate(this.data.endDate, "dd MMM yyyy"), "not set") %>']}},{id:"long_dates",classId:"tau-board-unit_type_date-range",hideIf:function(e){return!e.startDate&&!e.endDate},name:"Started  Finished",types:[t.PROJECT,t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],sortConfig:{allowed:n.NONE},template:f(p),sampleData:{startDate:"/Date(1305360733000-0500)/",endDate:"/Date(1385360733000-0500)/"},listSettings:{title:['<%= fn.cond(this.data.startDate, fn.formatDate(this.data.startDate, "dd MMM yyyy"), "not set") %>',"  ",'<%= fn.cond(this.data.endDate, fn.formatDate(this.data.endDate, "dd MMM yyyy"), "not set") %>']}},{id:"end_date",classId:"tau-board-unit_type_date tau-board-unit_type_end-date",hideIf:function(e){return!e.endDate},name:"Finished",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN_RUN,t.PROJECT,t.PROGRAM],sizes:l,template:f(c("endDate")),sampleData:{endDate:"/Date(1305360733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.endDate, "dd MMM yyyy")%>'}},{id:"build_date",classId:"tau-board-unit_type_date tau-board-unit_type_build-date",name:"${Build,capital} date",header:"${Build,camel} Date",types:[t.BUILD],sizes:l,template:f(['<div class="tau-board-unit_type_build-date__date">',c("buildDate"),"</div>",'<div class="tau-board-unit_type_build-date__time">','<div class="tau-board-unit__value_type_hours"><%=fn.formatDate(this.data.buildDate, "HH")%></div>','<div class="tau-board-unit__value_type_minutes"><%=fn.formatDate(this.data.buildDate, "mm")%></div>',"</div>"]),sampleData:{buildDate:"/Date(1305360733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.buildDate, "dd MMM yyyy HH:mm")%>'}},{id:"cycle_time",classId:"tau-board-unit_type_time-cycle",name:"Cycle time",header:"Cycle Time",types:[t.STORY,t.BUG,t.TASK,t.TEST_PLAN_RUN,t.FEATURE,t.EPIC],sizes:l,sortConfig:{allowed:n.NONE},template:{customFunctions:u,markup:['<div class="tau-board-unit__value"><%=fn._.isUndefined(this.data.cycleTime)?"n/a":fn.daysOrHoursValue(this.data.cycleTime)%></div>','<div class="tau-board-unit__points"><%=fn._.isUndefined(this.data.cycleTime)?"":fn.daysOrHoursUnit(this.data.cycleTime)%></div>']},sampleData:{cycleTime:356.2}},{id:"lead_time",classId:"tau-board-unit_type_time-lead",name:"Lead time",header:"Lead Time",types:[t.STORY,t.BUG,t.TASK,t.TEST_PLAN_RUN,t.FEATURE,t.EPIC],sizes:l,sortConfig:{allowed:n.NONE},template:{customFunctions:u,markup:['<div class="tau-board-unit__value"><%=fn.daysOrHoursValue(this.data.leadTime||0)%></div>','<div class="tau-board-unit__points"><%=fn.daysOrHoursUnit(this.data.leadTime||0)%></div>']},sampleData:{leadTime:324.85}},{id:"time_spent_remain",name:"Time spent/time remaining",header:"Time",classId:"tau-board-unit_type_time-remain-spent",types:[t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN,t.FEATURE,t.EPIC],sizes:l,sortConfig:{allowed:n.NONE},template:f(['<div class="tau-board-unit__value-spent"><%=fn.precise_round(this.data.timeSpent||0,1)%></div>','<div class="tau-board-unit__value-remain"><%=fn._.isUndefined(this.data.timeRemain) ? "n/a" : fn.precise_round(this.data.timeRemain||0,1)%></div>']),listSettings:{title:["Spent: <%=fn.precise_round(this.data.timeSpent||0,1)%>"," / ",'remain: <%=fn._.isUndefined(this.data.timeRemain) ? "n/a" : fn.precise_round(this.data.timeRemain||0,1)%>']},sampleData:{timeSpent:322.47,timeRemain:320.8}},{id:"t_spent_remain",name:"Time spent/time remaining",header:"Spent/Remaining",classId:"tau-board-unit_type_time-remain-spent",types:[t.TIME],sizes:[i.LIST],sortConfig:{allowed:n.NONE},template:f(['<div class="tau-board-unit__value-spent"><%=fn.precise_round(this.data.spent||0,1)%></div>','<div class="tau-board-unit__value-remain"><%=fn._.isUndefined(this.data.remain) ? "n/a" : fn.precise_round(this.data.remain||0,1)%></div>']),listSettings:{title:["Spent: <%=fn.precise_round(this.data.spent||0,1)%>"," / ",'remain: <%=fn._.isUndefined(this.data.remain) ? "n/a" : fn.precise_round(this.data.remain||0,1)%>']},sampleData:{spent:322.47,remain:320.8},editorConfig:{type:"time",isEditable:function(e){return"time"===e.type
}}},{id:"tc_last_run_date",classId:"tau-board-unit_type_date tau-board-unit_type_last-run-date",hideIf:function(e){return!e.lastRunDate},name:"Last run",types:[t.TEST_CASE],sizes:o,template:f(c("lastRunDate")),sampleData:{lastRunDate:"/Date(1305360733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.lastRunDate, "dd MMM yyyy")%>'}},{id:"last_comment_date",classId:"tau-board-unit_type_date tau-board-unit_type_last-comment-date",hideIf:function(e){return!e.lastCommentDate},name:"Last commented",header:"Last Commented",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:l,template:f(c("lastCommentDate")),sampleData:{lastCommentDate:"/Date(1335360733000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.lastCommentDate, "dd MMM yyyy")%>'}},{id:"project_project_icon",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e.color},name:"Project color",header:"Color",types:[t.PROJECT],sizes:l,template:['<i class="tau-icon tau-icon_type_color" style="background-color:<%=this.data.color||\'transparent\'%>;"></i>'],sampleData:{color:"#f9d9d1",name:"CodeGuard 3"},listSettings:{title:"<%= this.data.name %>"}},{id:"project_project_abbr",classId:"tau-board-unit_type_project_abbr",name:"Abbreviation",header:"Abbr.",types:[t.PROJECT],sizes:l,sortConfig:{field:"abbreviation"},template:['<div class="tau-board-unit__value_type_abbr" style="background-color:<%=this.data.color||\'transparent\'%>;"><%!this.data.abbreviation%></div>'],sampleData:{color:"#f9d9d1",abbreviation:"CG3",name:"CodeGuard 3"},listSettings:{title:"<%= this.data.name %>"}},{id:"team_team",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e.icon},name:"Team icon",header:"Icon",types:[t.TEAM],sizes:l,template:['<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= this.data.icon %>"></i>'],sampleData:{icon:"ufo",name:"United Future Organization"},listSettings:{title:"<%! this.data.icon && this.data.name %>"}},{id:"request_private",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e.isPrivate
},name:"Private",settings:[{types:[t.REQUEST,t.IMPEDIMENT],sizes:l}],template:['<i class="tau-icon tau-icon_type_svg tau-icon_name_lock"></i>'],sampleData:{isPrivate:!0},listSettings:{title:'<%= fn.cond(this.data && this.data.isPrivate, "Private", "") %>'}},{id:"progress_short",classId:"tau-board-unit_type_progress",name:"Progress",types:[t.PROJECT,t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:o,template:['<div class="tau-board-unit__value"><%= fn.precise_round(this.data.progress * 100, 0) %></div>'],sampleData:{progress:1}},{id:"progress_long",classId:"tau-board-unit_type_progress",name:"Progress",types:[t.PROJECT,t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:l,sortConfig:{allowed:n.NONE},template:['<div class="tau-progress tau-v-<%= fn.precise_round(this.data.progress * 10, 0) * 10 %>"></div>','<div class="tau-board-unit__value"><%= fn.precise_round(this.data.progress * 100, 0) %></div>'],listSettings:{title:"<%= fn.precise_round(this.data.progress * 100, 0) %>%"},sampleData:{progress:1}},{id:"user_avatar",classId:"tau-board-unit_type_avatar",name:"Avatar",sortConfig:{allowed:n.NONE},settings:[{types:[t.USER,t.ASSIGNED_USER],sizes:l,model:"avatarUri,fullName,email"},{types:[t.PROJECT_MEMBER],sizes:l,model:"user.avatarUri,user.fullName,user.email"}],template:['<div class="tau-avatar"><img src="<%= this.data.avatarUri %>24"></div>'],listSettings:{title:"<%= this.data.fullName || this.data.email %>"},sampleData:{avatarUri:m("/javascript/tau/css/images/icons/user.png?size=")}},{id:"user_email_short",classId:"tau-board-unit_type_user-email",name:"Email",settings:[{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"email"},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"user.email"}],template:['<div class="tau-board-unit__value tau-board-unit-not-selectable">','<a <% if (!this.settings.isDesignMode) { %>href="mailto:<%! this.data.email %>"<%}%> ><%! fn.trim(this.data.email, 15) %></a>',"</div>"],sampleData:{email:"u.karatkievich@writer.com"}},{id:"user_email_long",classId:"tau-board-unit_type_user-email",name:"Email",settings:[{types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL],model:"email",sortConfig:{field:"email"}},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL],model:"user.email",sortConfig:{field:"user.email"}}],sections:1,template:['<div class="tau-board-unit__value tau-board-unit-not-selectable">','<a <% if (!this.settings.isDesignMode) { %>href="mailto:<%! this.data.email %>"<%}%> ><%! this.data.email %></a>',"</div>"],sampleData:{email:"u.karatkievich@writer.com"}},{id:"user_login",classId:"tau-board-unit_type_user-login",name:"Login",settings:[{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"login",sortConfig:{field:"login"}},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"user.login",sortConfig:{field:"user.login"}}],template:['<div class="tau-board-unit__value"><%! fn.trim(this.data.login, 15) %></div>'],sampleData:{login:"uladzimir.karatkievich"}},{id:"user_login_long",classId:"tau-board-unit_type_user-login",name:"Login",settings:[{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL],model:"login"},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL],model:"user.login"}],sections:1,template:['<div class="tau-board-unit__value"><%! this.data.login %></div>'],sampleData:{login:"uladzimir.karatkievich"}},{id:"allocation",classId:"tau-board-unit_type_allocation",name:"Allocation",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%= fn.precise_round(this.data.currentAllocation, 0) %></div>'],sampleData:{currentAllocation:150},listSettings:{title:"<%= fn.precise_round(this.data.currentAllocation, 0) %>%"}},{id:"user_is_active",classId:function(e){return"tau-board-unit_type_status-"+(e&&e.isActive?"active":"inactive")
},data:{label:'<%= this.data.isActive ? "Active" : "Inactive" %>'},name:"Active",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:[],listSettings:{title:'<%= fn.cond(this.data && this.data.isActive, "Active", "Inactive") %>'},sampleData:{isActive:!0}},{id:"user_observer",classId:"tau-board-unit_type_status-observer",data:{label:"Observer"},hideIf:function(e){return!e.isObserver},name:"Observer",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:[],listSettings:{title:'<%= fn.cond(this.data && this.data.isObserver, "Observer", "") %>'},sampleData:{isObserver:!0}},{id:"user_admin",classId:"tau-board-unit_type_status-admin",data:{label:"Admin"},hideIf:function(e){return!e.isAdministrator},name:"Administrator",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:[],listSettings:{title:'<%= fn.cond(this.data && this.data.isAdministrator, "Administrator", "") %>'},sampleData:{isAdministrator:!0}},{id:"user_big_details",classId:"tau-board-unit_type_user-info",name:"Large avatar with some details (role, name)",sections:2,types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL],model:"avatarUri,fullName,email,role",template:['<img class="tau-board-unit_type_user-info__avatar" src="<%= this.data.avatarUri %>">','<div class="tau-board-unit_type_user-info__name">',"<%! _.trim(this.data.fullName) || this.data.email %>","</div>",'<div class="tau-board-unit_type_user-info__role"><%! this.data.role.name %></div>'],sampleData:{fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:m("/Javascript/tau/css/images/icons/user.png"),role:{name:"Writer"}}},{id:"t_user_details",classId:"tau-board-unit_type_user-info tau-board-unit_type_time_user-info",sections:2,name:"User",types:[t.TIME],sizes:[i.LIST],model:"user.avatarUri,user.fullName,user.email,role",template:['<img class="tau-board-unit_type_time_user-info__avatar" src="<%= this.data.avatarUri %>24">',"<div><%! _.trim(this.data.fullName) || this.data.email %></div>","<div><%! this.data.role.name %></div>"],sampleData:{fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:m("/Javascript/tau/css/images/icons/user.png"),role:{name:"Writer"}}},{id:"request_is_replied",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e.isReplied
},name:"Replied",types:[t.REQUEST],sizes:l,template:['<i class="tau-icon tau-icon_type_svg tau-icon_name_back-arrow"></i>'],listSettings:{title:'<%= fn.cond(this.data && this.data.isReplied, "Replied", "") %>'},sampleData:{isReplied:!0}},{id:"request_email",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e||!e.sourceType||"none"===e.sourceType.toLowerCase()},name:"Request source (email, phone etc.)",header:"Request Source",types:[t.REQUEST],sizes:l,template:{customFunctions:{sourceToIcon:function(e){switch(e.toLowerCase()){case"phone":return"phone";case"email":return"email";case"internal":return"rect-in";case"external":return"rect-out";default:return"undefined"}},sourceToText:function(e){switch(e.toLowerCase()){case"phone":return"Phone call";case"email":return"Email";case"internal":return"Internal source";case"external":return"External source";default:return""}}},markup:['<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= fn.sourceToIcon(this.data.sourceType) %>"></i>']},listSettings:{title:"<%= fn.sourceToText(this.data.sourceType) %>"},sampleData:{sourceType:"email"}},{id:"tc_note_message_short",classId:"tau-board-unit_type_note-comment",hideIf:function(e){return!e.lastFailureComment},name:"Most recent note",header:"Last Note",types:[t.TEST_CASE],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%! fn.trim(this.data.lastFailureComment, 15) %></div>'],sampleData:{lastFailureComment:"The font is not legible at all"}},{id:"tc_note_message_long",classId:"tau-board-unit_type_note-comment",hideIf:function(e){return!e.lastFailureComment},name:"Most recent note",types:[t.TEST_CASE],sizes:o,sections:1,template:['<div class="tau-board-unit__value"><%! this.data.lastFailureComment %></div>'],sampleData:{lastFailureComment:"The font is not legible at all"}},{id:"tc_last_status",classId:"tau-board-unit_type_icon",name:"Last run result",header:"Last Run Result",types:[t.TEST_CASE],sizes:l,template:{customFunctions:{getLastRunResult:h},markup:["<i class=\"tau-icon tau-icon_type_svg tau-icon_name_status-<%= fn.getLastRunResult(this.data.lastStatus, 'ignored') %>\"></i>"]},listSettings:{title:["<%= _.capitalize(fn.getLastRunResult(this.data.lastStatus)) %>"]},sampleData:{lastStatus:!0}},{id:"iteration_velocity",classId:"tau-board-velocity",name:"Velocity",types:[t.ITERATION,t.TEAM_ITERATION],sizes:l,template:['<div class="tau-board-unit__value"><%=fn.precise_round(this.data.velocity||0,1)%></div>','<div class="tau-board-unit__points"><%=this.data.units%></div>'],sampleData:{velocity:2853.9,units:"pt"}},{id:"tasks_total",classId:"tau-board-unit_type_effort-total-e",name:"Total tasks effort",header:"Tasks Effort",types:[t.STORY],sizes:l,sortConfig:{allowed:n.NONE},hideIf:function(e){return!e.effort
},template:['<div class="tau-board-unit__label">Tasks</div>','<div class="tau-board-unit__value"><%=fn.precise_round(this.data.effort||0,1)%></div>','<div class="tau-board-unit__points">h</div>'],sampleData:{effort:324.9},model:"effort:tasks.Sum(effort)",listSettings:{title:["<%=fn.precise_round(this.data.effort||0,1)%>h"]}},{id:"tc_last_run_date",classId:"tau-board-tc_last_run_date tau-board-unit_type_date",name:"Last run date",header:"Last Run Date",settings:[{types:[t.TEST_PLAN],model:"lastRun:LastRunDateForTestPlan",sizes:l,sortConfig:{allowed:n.NONE}},{types:[t.TEST_CASE],model:"lastRun:lastRunDate",sizes:l,sortConfig:{field:"lastRunDate"}}],hideIf:function(e){return!e.lastRun},template:f(c("lastRun")),sampleData:{lastRun:"/Date(1363986000000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.lastRun, "dd MMM yyyy")%>'}},{id:"project_is_active",classId:function(e){return"tau-board-unit_type_status-"+(e&&e.isActive?"active":"inactive")},data:{label:'<%= this.data.isActive ? "Active" : "Inactive" %>'},name:"Active",types:[t.PROJECT],sizes:l,template:[],listSettings:{title:'<%= fn.cond(this.data && this.data.isActive, "Active", "Inactive") %>'},sampleData:{isActive:!0}},{id:"percent",classId:"tau-board-unit_type_percent-participating",name:"Percent participating",header:"Percent Participating",hideIf:function(e){return"undefined"==typeof e.allocation},types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-pie-progress tau-v-<%= fn.precise_round(this.data.allocation/10,0)*10 %>"></div> ','<div class="tau-board-unit__value"><%= this.data.allocation %>%</div>'],listSettings:{title:"<%= this.data.allocation %>%"},sampleData:{allocation:33}},{id:"planned_dates",classId:function(e){var t=s.getServerNow(),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=!(e.startDate&&s.convertToTimezone(e.startDate)>i||e.endDate&&s.convertToTimezone(e.endDate)<i);return"tau-board-unit_type_planned_dates"+(n?" tau-board-unit_type_planned_dates-green":"")
},hideIf:function(e){return!e.startDate&&!e.endDate},sortConfig:{allowed:n.NONE},data:{startDate:new Date},name:"Planned dates",header:"Planned Dates",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN,t.TEST_PLAN_RUN,t.IMPEDIMENT],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:f(d),listSettings:{title:["<% if (this.data.startDate || this.data.endDate) { %>",'<%= this.data.startDate ? fn.formatDate(this.data.startDate, "dd MMM") : "..."%>',"  ",'<%= this.data.endDate ? fn.formatDate(this.data.endDate, "dd MMM") : "..."%>',"<% } %>"]},sampleData:{startDate:"/Date(1385360733000-0500)/",endDate:"/Date(1305360733000-0500)/"},model:"startDate:PlannedStartDate,endDate:PlannedEndDate"},{id:"name_unit",classId:"tau-board-unit_type_simple-name",name:"Name",header:"Name",rank:100,isNameUnit:!0,settings:[{types:["tag","severity","requesttype","role","process"],model:"name:name",sizes:[i.LIST],sortConfig:{field:"name"}},{types:["enddate","datetime","createdate","startdate","effort"],model:"name:it.HumanFormat()",sizes:[i.LIST],sortConfig:{field:"name"}},{types:["priority"],model:"name:it.Key",sizes:[i.LIST],sortConfig:{field:"name"}},{types:["entitystate"],model:"name:it.Key.name",sizes:[i.LIST],sortConfig:{field:"name"}},{types:["source","requestsourceenum"],model:"name:it.ToString()",sizes:[i.LIST],sortConfig:{allowed:n.NONE}}],template:['<div class="tau-board-unit__value i-role-name"><%! this.data.name %></div>'],sampleData:{name:"Open"}},{id:"tcr_id",classId:"tau-board-unit_type_id",name:"Id",header:"ID",types:[t.TEST_CASE_RUN],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value">','<%= fn.generateEntityLink(this, this.data, "testcaserun", { className: "" }) %>',"</div>"],sampleData:{id:1},listSettings:{title:'<%= "TestCaseRun #" + this.data.id %>'}},{id:"tcr_name",classId:"tau-board-unit_type_entity-name",name:"Test Case Run Name",header:"Name",isNameUnit:!0,types:[t.TEST_CASE_RUN],sizes:l,template:{customFunctions:{getRunResult:h},markup:['<div class="tau-board-unit__value tau-name i-role-name"><%!this.data.name%></div>','<i class="tau-icon_type_svg tau-icon-floating-status ',"tau-icon_name_status-<%= fn.getRunResult(this.data.passed, 'ignored') %>\" ",'title="<%= _.capitalize(fn.getRunResult(this.data.passed)) %>"></i>']},sampleData:{name:"Test Case Run 1.",passed:!0}},{id:"tcr_run_date",classId:"tau-board-tcr_run_date tau-board-unit_type_date",name:"Run date",header:"Run Date",types:[t.TEST_CASE_RUN],sizes:l,hideIf:function(e){return!e.runDate
},template:f(c("runDate")),sampleData:{runDate:"/Date(1363986000000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.runDate, "dd MMM yyyy")%>'}},{id:"tcr_run_result",classId:"tau-board-unit_type_icon",name:"Run result",header:"Run Result",types:[t.TEST_CASE_RUN],sizes:l,template:{customFunctions:{getRunResult:h},markup:["<i class=\"tau-icon tau-icon_type_svg tau-icon_name_status-<%= fn.getRunResult(this.data.passed, 'ignored') %>\"></i>"]},listSettings:{title:["<%= _.capitalize(fn.getRunResult(this.data.passed)) %>"]},sampleData:{passed:!0}},{id:"unit_time",classId:"tau-board-unit_type_date",name:"Spent date",header:"Spent Date",rank:100,isNameUnit:!0,types:[t.TIME],model:"date",sizes:[i.LIST],hideInLibrary:!0,template:f(c("date")),sampleData:{date:"/Date(1363986000000-0500)/"},listSettings:{title:'<%=fn.formatDate(this.data.date, "dd MMM yyyy")%>'},editorConfig:{type:"date",template:{name:"date.simple"}}},{id:"t_description_1line",classId:"tau-board-unit_type_role",name:"Description",types:[t.TIME],sizes:[i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.description,30)%></div>'],listSettings:{title:"<%= this.data.description %>"},sampleData:{description:"Chances are you'll remember information printed in a font like this one better than information presented in a font like this, because less legible fonts make you concentrate harder."},editorConfig:{type:"time.description.edit",template:{name:"description.simple"}}},{id:"action_delete",classId:"ui-menu__item-action-delete",name:"Actions",types:[t.TIME,t.FEATURE],sizes:[i.LIST],sortConfig:{allowed:n.NONE},template:['<div class="tau-board-unit__value"><button type="button" class="tau-btn tau-btn-red tau-btn_hidden i-role-actiondelete">Delete</button></div>'],sampleData:{id:193011},editorConfig:{type:"entity.delete",isEditable:function(e){return"time"===e.type||"feature"===e.type}}},{id:"name_unit_default",classId:"tau-board-unit_type_simple-name",name:"Name",header:"Name",rank:100,isNameUnit:!0,types:[t.ANY_TYPE],model:"name:it.ToString()",sizes:[i.LIST],hideInLibrary:!0,template:['<div class="tau-board-unit__value"><%! this.data.name %></div>'],sampleData:{name:"Open"}}];
return e.each(g,function(e){e.category="simple"}),g}),define("tau/models/board.customize.units/board.customize.units.oneToOne",["Underscore","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/const.sorting.applying","app.path","tau/models/board.customize.units/board.customize.units.base","tau/services/service.features"],function(e,t,i,n,a,r,s){var o=[i.XS,i.S,i.M,i.L,i.XL],l=[i.XS,i.S,i.M,i.L,i.XL,i.LIST],u={type:"choice",expandable:!0,filter:!0,filterPosition:"top",showEmptyDataMessage:!0,hideDefaultValue:!0,allowToReset:!0,fullModeLabel:"show old&hellip;",emptyDataMessage:"No items found",maxHeight:300},c=function(t,i){return t&&e.find(t.items,function(e){return e.name===i})},d=[{id:"team_name_short",sizes:[i.M,i.L,i.XL,i.LIST],types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEAM_ITERATION,t.TEST_PLAN_RUN,t.TEST_PLAN],classId:"tau-board-unit_type_team-name",hideIf:function(e){return!e.team||!e.team.name},name:"Team name",header:"Team",template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.team.name,15)%></div>'],sampleData:{team:{name:"Customize cards team"}}},{id:"team_name_long",sizes:o,sections:1,types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEAM_ITERATION,t.TEST_PLAN_RUN,t.TEST_PLAN],classId:"tau-board-unit_type_team-name",hideIf:function(e){return!e.team||!e.team.name},name:"Team name",header:"Team",sortConfig:{field:"team.name"},template:['<div class="tau-board-unit__value"><%!this.data.team.name%></div>'],sampleData:{team:{name:"Customize cards team"}},model:"team:{name:team.name},id:team.id"},{id:"state_short",classId:"tau-board-unit_type_state",name:"State",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.IMPEDIMENT,t.TEST_PLAN_RUN,t.TEST_PLAN],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.entityState.name,19)%></div>'],sampleData:{entityState:{name:"Ready for release"}},editorConfig:{type:"choice.entityState"}},{id:"state_full_length",classId:"tau-board-unit_type_state",name:"State",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.IMPEDIMENT,t.TEST_PLAN_RUN,t.TEST_PLAN],sizes:o,sections:1,sortConfig:{field:"entityState.name"},template:['<div class="tau-board-unit__value"><%!this.data.entityState.name%></div>'],sampleData:{entityState:{name:"Ready for release"}},editorConfig:{type:"choice.entityState"}},{id:"release_id",classId:"tau-board-unit_type_id tau-board-unit_type_release-id",hideIf:function(e){return!e.release||!e.release.id
},name:"${Release,capital} id",header:"${Release,camel} Id",types:[t.FEATURE,t.STORY,t.BUG,t.ITERATION,t.TEST_PLAN_RUN,t.BUILD,t.TASK],sizes:l,sortConfig:{field:"release.id"},template:['<%= fn.generateEntityLink(this, this.data.release, "release") %>'],term:"release",sampleData:{release:{id:120188,name:"Release #1 (Minimal wow effect)"}},listSettings:{title:["<%! this.data.release && this.data.release.name %>"]}},{id:"release_short",classId:"tau-board-unit_type_release",hideIf:function(e){return!e.release||!e.release.name},name:"${Release,capital}",header:"${Release,camel}",types:[t.FEATURE,t.STORY,t.TASK,t.BUG,t.ITERATION,t.TEST_PLAN_RUN,t.BUILD],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.release.name,19)%></div>'],term:"release",sampleData:{release:{name:"Release #1 (Minimal wow effect)"}}},{id:"release_long",classId:"tau-board-unit_type_release",name:"${Release,capital}",header:"${Release,camel}",hideIf:function(e){return!e.release||!e.release.name},types:[t.FEATURE,t.STORY,t.TASK,t.BUG,t.ITERATION,t.TEST_PLAN_RUN,t.BUILD],sizes:o,sections:1,sortConfig:{field:"release.name"},template:['<div class="tau-board-unit__value"><%!this.data.release.name%></div>'],term:"release",sampleData:{release:{name:"Release #1 (Minimal wow effect)"}},model:"release:{name:release.name},id:release.id",editorConfig:e.extend({},u,{listType:"release",emptyDataMessage:"No ${release,lower,names} found",isEditable:function(e){return"task"!==e.type},clearValueLabel:"(no ${release,lower,names})"})},{id:"iteration_id",classId:"tau-board-unit_type_id tau-board-unit_type_iteration-id",hideIf:function(e){return!e.iteration||!e.iteration.id},name:"${Iteration,capital} id",header:"${Iteration,camel} Id",types:[t.STORY,t.BUG,t.TEST_PLAN_RUN,t.BUILD,t.TASK],sizes:l,sortConfig:{field:"iteration.id"},template:['<%= fn.generateEntityLink(this, this.data.iteration, "iteration") %>'],term:"iteration",sampleData:{iteration:{id:130387,name:"Iteration #1.2 (Research/Concept)"}},listSettings:{title:["<%! this.data.iteration && this.data.iteration.name %>"]}},{id:"iteration_short",classId:"tau-board-unit_type_iteration",hideIf:function(e){return!e.iteration||!e.iteration.name
},name:"${Iteration,capital}",header:"${Iteration,camel}",types:[t.STORY,t.TASK,t.BUG,t.TEST_PLAN_RUN,t.BUILD],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.iteration.name,19)%></div>'],term:"iteration",sampleData:{iteration:{name:" Iteration #1.2 (Research/Concept)"}}},{id:"iteration_long",classId:"tau-board-unit_type_iteration",hideIf:function(e){return!e.iteration||!e.iteration.name},name:"${Iteration,capital}",header:"${Iteration,camel}",types:[t.STORY,t.TASK,t.BUG,t.TEST_PLAN_RUN,t.BUILD],sizes:o,sections:1,sortConfig:{field:"iteration.name"},template:['<div class="tau-board-unit__value"><%!this.data.iteration.name%></div>'],term:"iteration",sampleData:{iteration:{name:" Iteration #1.2 (Research/Concept)"}},model:"iteration:{name:iteration.name},id:iteration.id,practices:project.process.practices",editorConfig:e.extend({},u,{listType:"iteration",emptyDataMessage:"No ${iteration,lower,names} found",isEditable:function(e){return"task"!==e.type&&c(e.data.practices,"Iterations")},clearValueLabel:"(no ${iteration,lower})"})},{id:"feature_id",classId:"tau-board-unit_type_id tau-board-unit_type_feature-id",hideIf:function(e){return!e.feature||!e.feature.id},name:"${Feature,capital} id",header:"${Feature,camel} Id",settings:[{types:[t.STORY,t.BUG],sizes:l,model:"feature:{feature.id,feature.name}",sortConfig:{field:"feature.id"}},{types:[t.TASK],sizes:l,model:"feature:{userStory.feature.id,userStory.feature.name}",sortConfig:{field:"userStory.feature.id"}}],template:['<%= fn.generateEntityLink(this, this.data.feature, "feature") %>'],term:"feature",sampleData:{feature:{id:91283,name:"Reports: High Level Report"}},listSettings:{title:["<%! this.data.feature && this.data.feature.name %>"]}},{id:"feature_short",classId:"tau-board-unit_type_feature",hideIf:function(e){return!e.feature||!e.feature.name},name:"${Feature,capital}",header:"${Feature,camel}",sortConfig:{field:"feature.name"},settings:[{types:[t.STORY,t.BUG],sizes:[i.M,i.L,i.XL,i.LIST],model:"feature:{feature.name}"},{types:[t.TASK],sizes:[i.M,i.L,i.XL,i.LIST],model:"feature:{userStory.feature.name}"}],term:"feature",template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.feature.name,19)%></div>'],sampleData:{feature:{name:"Reports: High Level Report"}}},{id:"feature_long",classId:"tau-board-unit_type_feature",hideIf:function(e){return!e.feature||!e.feature.name
},name:"${Feature,capital}",header:"${Feature,camel}",term:"feature",settings:[{types:[t.STORY,t.BUG],sizes:o,model:"feature:{feature.name},id:feature.id,practices:project.process.practices",sortConfig:{field:"feature.name"}},{types:[t.TASK],sizes:o,model:"feature:{userStory.feature.name}",sortConfig:{field:"userStory.feature.name,practices:project.process.practices"}}],sections:1,template:['<div class="tau-board-unit__value"><%!this.data.feature.name%></div>'],sampleData:{feature:{name:"Reports: High Level Report"}},model:"feature:{feature.name},id:feature.id",editorConfig:{type:"finder.entity",propertyName:"feature",isEditable:function(e){var t=e.type;return("userstory"==t||"bug"==t)&&c(e.data.practices,"Requirements")},allowToReset:!0,clearValueLabel:"(no ${feature,lower})"}},{id:"project_icon",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e.project||!e.project.id},name:"Project color",header:"Project Color",settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:l},{types:[t.PROJECT_MEMBER],sizes:l}],template:['<i class="tau-icon tau-icon_type_color" style="background-color: <%= this.data.project.color || "transparent"%>;"></i>'],sampleData:{project:{id:1,color:"#f9d9d1",name:"CodeGuard 3"}},listSettings:{title:"<%= this.data.project.name %>"}},{id:"project_abbr",classId:"tau-board-unit_type_project_abbr",hideIf:function(e){return!e.project||!e.project.abbreviation},name:"Project abbreviation",header:"Project",sortConfig:{field:"project.abbreviation"},settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:l},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST]},{types:[t.GENERAL,t.INBOUND_RELATIONS,t.OUTBOUND_RELATIONS],sizes:[i.LIST]}],template:['<div class="tau-board-unit__value_type_abbr"',' style="background-color: <%=this.data.project.color||"transparent"%>;">',"<%!this.data.project.abbreviation%>","</div>"],sampleData:{project:{color:"#f9d9d1",abbreviation:"CGR",name:"CodeGuard 3"}},listSettings:{title:"<%= this.data.project.name %>"}},{id:"project_short",classId:"tau-board-unit_type_project",hideIf:function(e){return!e.project||!e.project.name
},name:"Project name",header:"Project",sortConfig:{field:"project.name"},settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:[i.M,i.L,i.XL,i.LIST]},{types:[t.PROJECT_MEMBER],sizes:[i.M,i.L,i.XL,i.LIST]}],template:['<div class="tau-board-unit__value" style="background-color: <%= this.data.project.color || "transparent"%>;">',"<%! fn.trim(this.data.project.name, 15) %>","</div>"],sampleData:{project:{name:"Custom Graphic Reports",color:"#f9d9d1"}}},{id:"project_long",classId:"tau-board-unit_type_project",hideIf:function(e){return!e.project||!e.project.name},name:"Project name",header:"Project",sortConfig:{field:"project.name"},settings:[{types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:o},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL]}],sections:1,template:['<div class="tau-board-unit__value" style="background-color: <%= this.data.project.color || "transparent"%>;">',"<%! this.data.project.name %>","</div>"],sampleData:{project:{name:"Custom Graphic Reports",color:"#f9d9d1"}},model:"project:{name:project.name,color:project.color},id:project.id"},{id:"program_name",classId:"tau-board-unit_type_program",hideIf:function(e){return!e.program||!e.program.name},name:"Program name",header:"Program",settings:[{types:[t.PROJECT],sizes:l}],template:['<div class="tau-board-unit__value">',"<%! this.data.program.name %>","</div>"],sampleData:{program:{name:"Marketing"}}},{id:"severity_short",classId:"tau-board-unit_type_severity",name:"Severity",types:[t.BUG],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.severity.name,15)%></div>'],sampleData:{severity:{name:"Annoyance & Frustration - Easy workaround"}}},{id:"severity_long",classId:"tau-board-unit_type_severity",name:"Severity",types:[t.BUG],sizes:o,sections:1,sortConfig:{field:"severity.name"},template:['<div class="tau-board-unit__value"><%!this.data.severity.name%></div>'],sampleData:{severity:{name:"Annoyance & Frustration - Easy workaround"}},model:"severity:{name:severity.name},id:severity.id",editorConfig:{type:"choice",listType:"severity"},listSettings:{minWidth:110}},{id:"business_value_short",classId:"tau-board-unit_type_business-value",name:"Business value",header:"Business Value",types:[t.EPIC,t.FEATURE,t.STORY,t.BUG,t.TEST_CASE,t.REQUEST],sizes:[i.M,i.L,i.XL,i.LIST],sortConfig:{field:"priority.importance",inverseOrder:!0},template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.priority.name,15)%></div>'],sampleData:{priority:{name:"Nice to have"}}},{id:"business_value_long",classId:"tau-board-unit_type_business-value",name:"Business value",header:"Business Value",types:[t.EPIC,t.FEATURE,t.STORY,t.BUG,t.REQUEST,t.TEST_CASE],sizes:o,sortConfig:{field:"priority.importance",inverseOrder:!0},sections:1,template:['<div class="tau-board-unit__value"><%!this.data.priority.name%></div>'],sampleData:{priority:{name:"Nice to have"}},model:"priority:{name:priority.name},id:priority.id",editorConfig:{type:"choice",listType:"priority"}},{id:"priority_short",classId:"tau-board-unit_type_priority",name:"Priority",header:"Priority",types:[t.IMPEDIMENT],sizes:[i.M,i.L,i.XL,i.LIST],sortConfig:{field:"priority.importance",inverseOrder:!0},template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.priority.name,15)%></div>'],sampleData:{priority:{name:"Critical"}}},{id:"priority_long",classId:"tau-board-unit_type_priority",name:"Priority",header:"Priority",types:[t.IMPEDIMENT],sizes:o,sortConfig:{field:"priority.importance",inverseOrder:!0},sections:1,template:['<div class="tau-board-unit__value"><%!this.data.priority.name%></div>'],sampleData:{priority:{name:"Critical"}},model:"priority:{name:priority.name},id:priority.id",editorConfig:{type:"choice",listType:"priority"}},{id:"team",classId:"tau-board-unit_type_icon",hideIf:function(e){return!e.team||!e.team.id
},name:"Team icon",header:"Team",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEAM_ITERATION,t.TEST_PLAN_RUN],sizes:l,template:['<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= this.data.team.icon||"trihead" %>"></i>'],sampleData:{team:{id:1,icon:"ufo",name:"Ufo team"}},listSettings:{title:'<%= this.data.team.name || "" %>'}},{id:"owner",classId:"tau-board-unit_type_avatar",name:"Owner",sortConfig:{field:"owner.fullName"},types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:l,template:['<div class="tau-avatar tau-owner-avatar">',"<% var owner = this.data.owner; %>",'<img src="<%= owner.avatarUri %>20" <% if (!this.settings.isDesignMode) { %>title="<%! _.trim(owner.fullName) || owner.email %>"<% } %>>',"</div>"],model:"owner:{owner.avatarUri,owner.fullName,owner.email}",sampleData:{owner:{avatarUri:r.url("/Javascript/tau/css/images/icons/user.png?size="),fullName:"Owner's Full Name"}}},{id:"teamiteration_id",classId:"tau-board-unit_type_id tau-board-unit_type_teamiteration-id",hideIf:function(e){return!e.teamIteration||!e.teamIteration.id},name:"${Team iteration,capital} id",header:"${Team Iteration,camel} Id",sortConfig:{field:"teamIteration.id"},types:[t.STORY,t.BUG,t.TEST_PLAN_RUN,t.TASK],sizes:l,template:['<%= fn.generateEntityLink(this, this.data.teamIteration, "teamiteration") %>'],term:"teamiteration",sampleData:{teamIteration:{id:270707,name:"Team iteration #1.1 (Research/Concept)"}},listSettings:{title:["<%! this.data.teamIteration && this.data.teamIteration.name %>"]}},{id:"team_iteration_short",classId:"tau-board-unit_type_teamiteration",hideIf:function(e){return!e.teamIteration||!e.teamIteration.name},name:"${Team iteration,capital}",header:"${Team Iteration,camel}",types:[t.STORY,t.BUG,t.TEST_PLAN_RUN,t.TASK],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.teamIteration.name,19)%></div>'],term:"teamiteration",sampleData:{teamIteration:{name:"Team iteration #1.1 (Research/Concept)"}}},{id:"team_iteration_long",classId:"tau-board-unit_type_teamiteration",name:"${Team iteration,capital}",header:"${Team Iteration,camel}",hideIf:function(e){return!e.teamIteration||!e.teamIteration.name
},types:[t.STORY,t.BUG,t.TEST_PLAN_RUN,t.TASK],sizes:o,sections:1,sortConfig:{field:"teamIteration.name"},template:['<div class="tau-board-unit__value"><%!this.data.teamIteration.name%></div>'],term:"teamiteration",sampleData:{teamIteration:{name:"Team iteration #1.1 (Research/Concept)"}},model:"teamIteration:{name:teamIteration.name},id:teamIteration.id",editorConfig:e.extend({},u,{listType:"teamIteration",emptyDataMessage:"No ${team iteration,lower,names} found",isEditable:function(e){return"task"!==e.type},clearValueLabel:"(no ${team iteration,lower})"})},{id:"last_commented_user_icon",classId:"tau-board-unit_type_avatar",hideIf:function(e){return!e.lastCommentedUser||!e.lastCommentedUser.avatarUri},name:"Last commented user",header:"Last Commented User",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:l,sortConfig:{field:"lastCommentedUser.fullName"},template:['<div class="tau-avatar tau-last-commented-user-avatar">','<img <% if (this.data.lastCommentedUser.avatarUri) { %> src="<%= this.data.lastCommentedUser.avatarUri %>" <% } %> >',"</div>"],listSettings:{title:["<% var user = this.data.lastCommentedUser, title = user.fullName || user.email; %>",'<%= fn.cond(title, title, "") %>']},sampleData:{lastCommentedUser:{avatarUri:r.url("/Javascript/tau/css/images/icons/user.png"),fullName:"Johnny Depp",email:"j.depp@email.com"}}},{id:"user_total_allocation",classId:"tau-board-unit_type_allocation",name:"Total user allocation",header:"User Allocation",types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],sortConfig:{field:"user.currentAllocation"},template:['<div class="tau-board-unit__value"><%= fn.precise_round(this.data.user.currentAllocation, 0) %></div>'],listSettings:{title:"<%= fn.precise_round(this.data.user.currentAllocation, 0) %>%"},sampleData:{user:{currentAllocation:150}}},{id:"build_id",classId:"tau-board-unit_type_id tau-board-unit_type_build-id",name:"${Build,capital} id",header:"${Build,camel} Id",hideIf:function(e){return!e.build||!e.build.id
},types:[t.BUG,t.TEST_PLAN_RUN],sizes:l,template:['<%= fn.generateEntityLink(this, this.data.build, "build") %>'],term:"build",sampleData:{build:{id:314159,name:"Build 2.21.9 acceptance testing"}},listSettings:{title:["<%! this.data.build && this.data.build.name %>"]}},{id:"build_short",classId:"tau-board-unit_type_build",name:"${Build,capital}",header:"${Build,camel}",hideIf:function(e){return!e.build||!e.build.name},types:[t.BUG,t.TEST_PLAN_RUN],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.build.name,19)%></div>'],term:"build",sampleData:{build:{name:"Build 2.21.9 acceptance testing"}}},{id:"build_long",classId:"tau-board-unit_type_build",hideIf:function(e){return!e.build||!e.build.name},name:"${Build,capital}",header:"${Build,camel}",types:[t.BUG,t.TEST_PLAN_RUN],sizes:o,sections:1,template:['<div class="tau-board-unit__value"><%!this.data.build.name%></div>'],term:"build",sampleData:{build:{name:"Build 2.21.9 acceptance testing"}}},{id:"userstory_id",classId:"tau-board-unit_type_id tau-board-unit_type_userstory-id",hideIf:function(e){return!e.userStory||!e.userStory.id},name:"${User story,capital} id",header:"${User Story,camel} Id",types:[t.TASK,t.BUG,t.TEST_CASE],sizes:l,sortConfig:{field:"userStory.id"},template:['<%= fn.generateEntityLink(this, this.data.userStory, "userstory") %>'],term:"userstory",sampleData:{userStory:{id:240685,name:"Add audit history for Team and Team Iteration"}},listSettings:{title:["<%!this.data.userStory && this.data.userStory.name %>"]}},{id:"us_name_short",classId:"tau-board-unit_type_userstory",hideIf:function(e){return!e.userStory||!e.userStory.name},name:"${User story,capital}",header:"${User Story,camel}",types:[t.TASK,t.BUG,t.TEST_CASE],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.userStory.name,19)%></div>'],term:"userstory",sampleData:{userStory:{name:"Add audit history for Team and Team Iteration"}}},{id:"us_name_long",classId:"tau-board-unit_type_userstory",hideIf:function(e){return!e.userStory||!e.userStory.name
},name:"${User story,capital}",header:"${User Story,camel}",types:[t.TASK,t.BUG,t.TEST_CASE],sizes:o,sections:1,sortConfig:{allowed:n.SINGLE,field:"userStory.name"},template:['<div class="tau-board-unit__value"><%!this.data.userStory.name%></div>'],term:"userstory",sampleData:{userStory:{name:"Add audit history for Team and Team Iteration"}},model:"userStory:{userStory.name},id:userStory.id",editorConfig:{type:"finder.entity",propertyName:"userstory",isEditable:function(e){var t=e.type;return"bug"==t||"task"==t||"testcase"==t},allowToReset:function(e){return"task"!==e.type.toLowerCase()},clearValueLabel:"(no ${user story,lower})"}},{id:"role_short",classId:"tau-board-unit_type_role",name:"Role",settings:[{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"roleName:role.name"},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"roleName:role.name"}],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.roleName,19)%></div>'],sampleData:{roleName:"Product Owner / Scrum Master"}},{id:"role_long",classId:"tau-board-unit_type_role",name:"Role",settings:[{types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL],model:"roleName:role.name"},{types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL],model:"roleName:role.name"}],sections:1,sortConfig:{field:"role.name"},template:['<div class="tau-board-unit__value"><%!this.data.roleName%></div>'],sampleData:{roleName:"Product Owner / Scrum Master"}},{id:"request_question",classId:"tau-board-unit_type_icon",name:"Request type (issue, idea or question)",header:"Req. Type",types:[t.REQUEST],sizes:l,template:{customFunctions:{typeToIcon:function(e){var t=e.data.requestType.name.toLowerCase();switch(t){case"issue":return"warning";case"idea":return"lightbulb";case"question":return"question";default:return"undefined"}}},markup:['<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= fn.typeToIcon(this)%>" title="<%= this.data.requestType.name%>"></i>']},sampleData:{requestType:{name:"Issue"}},listSettings:{title:["<%!this.data.requestType.name%>"]}},{id:"testplan_id",classId:"tau-board-unit_type_id tau-board-unit_type_testplan-id",hideIf:function(e){return!e.testPlan||!e.testPlan.id
},name:"Test plan id",header:"Test Plan Id",types:[t.TEST_PLAN_RUN],sizes:l,sortConfig:{field:"testPlan.id"},template:['<%= fn.generateEntityLink(this, this.data.testPlan, "testplan") %>'],term:"testplan",sampleData:{testPlan:{id:271828,name:"Smoke test: email integration"}},listSettings:{title:["<%! this.data.testPlan && this.data.testPlan.name %>"]}},{id:"test_plan_short",classId:"tau-board-unit_type_testplan",hideIf:function(e){return!e.testPlan||!e.testPlan.name},name:"Test plan",header:"Test Plan",types:[t.TEST_PLAN_RUN],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.testPlan.name,19)%></div>'],term:"testplan",sampleData:{testPlan:{name:"Smoke test: email integration"}}},{id:"test_plan_long",classId:"tau-board-unit_type_testplan",hideIf:function(e){return!e.testPlan||!e.testPlan.name},name:"Test plan",types:[t.TEST_PLAN_RUN],sizes:o,sections:1,template:['<div class="tau-board-unit__value"><%!this.data.testPlan.name%></div>'],term:"testplan",sampleData:{testPlan:{name:"Smoke test: email integration"}}},{id:"related_entity_short",classId:function(e){return"tau-board-unit_type_"+(e&&e.assignable.entityType.name||"").toLowerCase()},hideIf:function(e){return!e.assignable||!e.assignable.name},name:"Related entity",header:"Related Entity",types:[t.IMPEDIMENT],sizes:[i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.assignable.name,19)%></div>'],sampleData:{assignable:{name:"Custom Reports: Inline editor should work",entityType:{name:"UserStory"}}}},{id:"related_entity_long",classId:function(e){return"tau-board-unit_type_"+(e&&e.assignable.entityType.name||"").toLowerCase()},hideIf:function(e){return!e.assignable||!e.assignable.name},name:"Related entity",header:"Related Entity",types:[t.IMPEDIMENT],sizes:o,sections:1,template:['<div class="tau-board-unit__value"><%!this.data.assignable.name%></div>'],sampleData:{assignable:{name:"Custom Reports: Inline editor should work",entityType:{name:"UserStory"}}}},{id:"pm_big_details",classId:"tau-board-unit_type_user-info",name:"Large avatar with some details (name, role, project)",types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL],sections:2,template:['<img class="tau-board-unit_type_user-info__avatar" src="<%= this.data.user.avatarUri %>">','<div class="tau-board-unit_type_user-info__name"><%! _.trim(this.data.user.fullName) || this.data.user.email %></div>','<div class="tau-board-unit_type_user-info__role"><%! this.data.role.name %> in <%! this.data.project.abbreviation || this.data.project.name %></div>'],sampleData:{role:{name:"Writer"},project:{abbreviation:"CGR",name:"Custom Graphic Reports"},user:{fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:r.url("/Javascript/tau/css/images/icons/user.png")}}},{id:"pm_big_details_role",classId:"tau-board-unit_type_user-info",name:"Large avatar with some details (name, role)",types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL],sections:2,template:['<img class="tau-board-unit_type_user-info__avatar" src="<%= this.data.user.avatarUri %>">','<div class="tau-board-unit_type_user-info__name"><%! _.trim(this.data.user.fullName) || this.data.user.email %></div>','<div class="tau-board-unit_type_user-info__role"><%! this.data.role.name %></div>'],sampleData:{role:{name:"Writer"},user:{fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:r.url("/Javascript/tau/css/images/icons/user.png")}}},{id:"pm_big_details_project",classId:"tau-board-unit_type_user-info",name:"Large avatar with some details (name, project)",types:[t.PROJECT_MEMBER],sizes:[i.S,i.M,i.L,i.XL],sections:2,template:['<img class="tau-board-unit_type_user-info__avatar" src="<%= this.data.user.avatarUri %>">','<div class="tau-board-unit_type_user-info__name"><%! _.trim(this.data.user.fullName) || this.data.user.email %></div>','<div class="tau-board-unit_type_user-info__role">in <%! this.data.project.abbreviation || this.data.project.name %></div>'],sampleData:{project:{abbreviation:"CGR",name:"Custom Graphic Reports"},user:{fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:r.url("/Javascript/tau/css/images/icons/user.png")}}},{id:"responsible_person",classId:"tau-board-responsible-person",name:"Responsible person",header:"Responsible Person",types:[t.IMPEDIMENT],sizes:l,model:"user:{responsible.id,responsible.avatarUri,responsible.fullName,responsible.email}",template:['<div class="tau-avatar">','<img src="<%=this.data.user.avatarUri%>20"',"<% if (!this.settings.isDesignMode) { %>",'title="<%=_.escape(_.trim(this.data.user.fullName) || this.data.user.email) %>"',"<% } %>",'">',"</div>"],sampleData:{user:{id:1,fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:r.url("/Javascript/tau/css/images/icons/users/karat.png?size=")}},listSettings:{title:["<%! _.escape(_.trim(this.data.user.fullName) || this.data.user.email) %>"]}},{id:"process_short",classId:"tau-board-unit_type_process",name:"Process",types:[t.PROJECT],sizes:[i.M,i.L,i.XL,i.LIST],template:["<%if (this.configurator.loggedUser.isAdministrator) {%>",'<%= fn.generateEntityLink(this, this.data.process, "process", { text: this.data.process.name, maxTextLength: 15, title: "", href: "" }) %>',"<%} else {%>",'<div class="tau-board-unit__value"><%!fn.trim(this.data.process.name,15)%></div>',"<% } %>"],sampleData:{process:{id:"",name:"Scrum"}},listSettings:{title:["<%! _.escape(_.trim(this.data.process.name)) %>"]}},{id:"process_long",classId:"tau-board-unit_type_process",name:"Process",types:[t.PROJECT],sizes:o,sections:1,template:["<%if (this.configurator.loggedUser.isAdministrator) {%>",'<%= fn.generateEntityLink(this, this.data.process, "process", { text: this.data.process.name, title: "", href: "" }) %>',"<%} else {%>",'<div class="tau-board-unit__value"><%!this.data.process.name%></div>',"<% } %>"],sampleData:{process:{id:"",name:"Scrum"}},listSettings:{title:["<%! _.escape(_.trim(this.data.process.name)) %>"]}},{id:"t_work_on",classId:function(e){return"tau-board-unit_type_"+(e&&e.assignable.entityType.name||"").toLowerCase()
},name:"Work on",header:"Work On",types:[t.TIME],sizes:[i.LIST],sections:1,template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.assignable.name,30)%></div>'],sampleData:{assignable:{name:"Task #1 Design for mobile application",entityType:{name:"Task"}}}}],p=new s;return p.isEnabled("entity.epics")&&d.push([{id:"epic_id",classId:"tau-board-unit_type_id tau-board-unit_type_epic-id",hideIf:function(e){return!e.epic||!e.epic.id},name:"${Epic,capital} id",header:"${Epic,camel} Id",settings:[{types:[t.FEATURE],sizes:l,model:"epic:{epic.id,epic.name}",sortConfig:{field:"epic.id"}}],template:['<%= fn.generateEntityLink(this, this.data.epic, "epic") %>'],term:"epic",sampleData:{epic:{id:91283,name:"Custom Reports"}},listSettings:{title:["<%! this.data.epic && this.data.epic.name %>"]}},{id:"epic_short",classId:"tau-board-unit_type_epic",hideIf:function(e){return!e.epic||!e.epic.name},name:"${Epic,capital}",header:"${Epic,camel}",sortConfig:{field:"epic.name"},settings:[{types:[t.FEATURE],sizes:[i.M,i.L,i.XL,i.LIST],model:"epic:{epic.name}"}],term:"epic",template:['<div class="tau-board-unit__value"><%!fn.trim(this.data.epic.name,19)%></div>'],sampleData:{epic:{name:"Custom Reports"}}},{id:"epic_long",classId:"tau-board-unit_type_epic",hideIf:function(e){return!e.epic||!e.epic.name},name:"${Epic,capital}",header:"${Epic,camel}",term:"epic",settings:[{types:[t.FEATURE],sizes:o,model:"epic:{epic.name},id:epic.id,practices:project.process.practices",sortConfig:{field:"epic.name"}}],sections:1,template:['<div class="tau-board-unit__value"><%!this.data.epic.name%></div>'],sampleData:{epic:{name:"Custom Reports"}},model:"epic:{epic.name},id:epic.id",editorConfig:{type:"finder.entity",propertyName:"epic",isEditable:function(e){var t=e.type;return"feature"==t&&c(e.data.practices,"Requirements")},allowToReset:!0,clearValueLabel:"(no ${epic,lower})"}}]),e.each(d,function(e){e.category="one to one"}),d}),define("tau/models/board.customize.units/board.customize.units.collections",["Underscore","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.base","tau/services/service.features"],function(e,t,i,n,a){var r={users:[{id:1,fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:n.url("/Javascript/tau/css/images/icons/users/karat.png?size="),isActive:!0},{id:2,fullName:"Janka Kupala",email:"ja.kupala@writer.com",avatarUri:n.url("/Javascript/tau/css/images/icons/users/kupala.png?size="),isActive:!0},{id:3,fullName:"Adam Mickiewicz",email:"a.mickiewicz@writer.com",avatarUri:n.url("/Javascript/tau/css/images/icons/users/mick.png?size="),isActive:!0},{id:4,fullName:"Uladzimir Karatkievich",email:"u.karatkievich@writer.com",avatarUri:n.url("/Javascript/tau/css/images/icons/user.png?size="),isActive:!0}],currentStateResponsiblePersons:[1,2,3,4]},s=function(t,i,n){for(var a=[],r=Math.min(t.length,i),s=0;r>s;s++)a.push('<div class="tau-board-unit_type_list__item">'),a.push(n(t[s])),a.push("</div>");
return t.length>i&&(a.push('<div class="tau-board-unit_type_list__others-counter">'),a.push(t.length-i),a.push("</div>")),e.flatten(a,!0).join("")},o=function(t){return e.map(t.tags,function(t){return'<div class="tau-board-unit_type_list__item">'+e.escape(t)+"</div>"}).join(", ")},l=function(e,t){return s(e.projects,t,function(e){return['<i style="background-color: ',e.color||"transparent",'" class="tau-icon tau-icon_type_color"></i>']})},u=function(t,i){return s(t.projects,i,function(t){return['<div class="tau-board-unit__value_type_abbr" style="background-color: ',t.color||"transparent",'">',e.escape(t.abbr),"</div>"]})},c=function(e,t){return s(e.teams,t,function(e){return['<i class="tau-icon tau-icon_type_svg tau-icon_name_',e.icon||"trihead",'"></i>']})},d=function(e){return e.openAssignables+e.openBlockers+e.others},p=function(e){return!e||!d(e)},f=function(e){return{markup:["<%= fn.assignedPeople(this.data, "+e+", this.settings) %>"],customFunctions:{assignedPeople:function(e,t,i){var n=this.isResponsible.bind(this,e),a=this.getUserText.bind(this),r=this.getPeopleOrdered(e);return s(r,t,function(e){return['<div class="tau-avatar',n(e)?"":" tau-avatar-not-currentResponsible",'">','<img src="'+e.avatarUri+'20"',i.isDesignMode?"":' title="'+a(e)+'"',">","</div>"]})}}}},m=function(t,i){var n=function(n){var a=e.escape(i.getUserName(n));return i.isResponsible(t,n)?'<b class="tau-board-unit__value">'+a+"</b>":'<span class="tau-board-unit__value">'+a+"</span>"},a=i.getPeopleOrdered(t);return e.map(a,n).join(", ")},h=function(e){return['<div class="tau-board-unit__value-open"><%= this.data.open{{FIELD}}Count%></div>','<div class="tau-board-unit__value-total"><%= this.data.total{{FIELD}}Count%></div>'].join("").replace(new RegExp("{{FIELD}}","g"),e)},g=function(e){return["<% if (this.data.open{{FIELD}}Count || this.data.total{{FIELD}}Count) { %>","Open: <%= this.data.open{{FIELD}}Count %> / total: <%= this.data.total{{FIELD}}Count %>","<% } %>"].join("").replace(new RegExp("{{FIELD}}","g"),e)
},v=[{id:"progress_short_release_iteration",classId:"tau-board-unit_type_progress",name:"Progress",types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%= fn.precise_round(this.data.progress*100, 0) %></div>'],sampleData:{progress:1},listSettings:{title:"<%= fn.precise_round(this.data.progress*100, 0) %>%"}},{id:"progress_long_release_iteration",classId:"tau-board-unit_type_progress",name:"Progress",types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-progress tau-v-<%= fn.precise_round(this.data.progress*10, 0)*10 %>"></div>','<div class="tau-board-unit__value"><%= fn.precise_round(this.data.progress*100, 0) %></div>'],sampleData:{progress:1},listSettings:{title:"<%= fn.precise_round(this.data.progress*100, 0) %>%"}},{id:"progress_short_program",classId:"tau-board-unit_type_progress",name:"Progress",settings:[{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalStoriesCount:userStoriesCount(),openStoriesCount:openUserStoriesCount()"}],template:['<div class="tau-board-unit__value"><%= fn.precise_round(fn.programProgress(this.data)*100, 0) %></div>'],sampleData:{totalStoriesCount:10,openStoriesCount:5},listSettings:{title:"<%= fn.precise_round(fn.programProgress(this.data)*100, 0) %>%"}},{id:"progress_long_program",classId:"tau-board-unit_type_progress",name:"Progress",settings:[{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalStoriesCount:userStoriesCount(),openStoriesCount:openUserStoriesCount()"}],template:['<div class="tau-progress tau-v-<%= fn.precise_round(fn.programProgress(this.data)*10, 0)*10 %>"></div>','<div class="tau-board-unit__value"><%= fn.precise_round(fn.programProgress(this.data)*100, 0) %></div>'],sampleData:{totalStoriesCount:10,openStoriesCount:5},listSettings:{title:"<%= fn.precise_round(fn.programProgress(this.data)*100, 0) %>%"}},{id:"test_cases",classId:"tau-board-unit_type_testcases-detailed-counter",hideIf:function(e){return!e.testCaseStats||!e.testCaseStats.passed&&!e.testCaseStats.failed&&!e.testCaseStats.ignored
},name:"Test cases stats",header:"Test Cases Stats",settings:[{types:[t.TEST_PLAN],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"TestCaseStats:{passed:testCases.Count(lastStatus == true),failed:testCases.Count(lastStatus == false),ignored:testCases.Count(lastStatus == null)}"},{types:[t.STORY],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"TestCaseStats:{passed:testCases.Count(lastStatus == true),failed:testCases.Count(lastStatus == false),ignored:testCases.Count(lastStatus == null)}"},{types:[t.TEST_PLAN_RUN],sizes:[i.S,i.M,i.L,i.X,i.XL,i.LIST],model:"TestCaseStats:{passed:PassedCount,failed:FailedCount,ignored:NotRunCount}"}],template:["<% var testCaseStats = this.data.testCaseStats || {}; %>",'<div class="tau-board-unit__value-passed <% if(!testCaseStats.passed){ %>  tau-board-unit__value--null <% } %>"><%= testCaseStats.passed || "" %></div>','<div class="tau-board-unit__value-failed <% if(!testCaseStats.failed){ %>  tau-board-unit__value--null <% } %>"><%= testCaseStats.failed || "" %></div>','<div class="tau-board-unit__value-ignored <% if(!testCaseStats.ignored){ %> tau-board-unit__value--null <% } %>"><%= testCaseStats.ignored || "" %></div>'],listSettings:{title:["<% var testCaseStats = this.data.testCaseStats || {}; %>","<% if (testCaseStats.passed || testCaseStats.failed || testCaseStats.ignored) { %>","Passed: <%= testCaseStats.passed || 0 %>, ","failed: <%= testCaseStats.failed || 0 %>, ","ignored: <%= testCaseStats.ignored || 0 %>","<% } %>"]},sampleData:{testCaseStats:{passed:830,failed:110,ignored:120}}},{id:"assignments_big_2",classId:"tau-board-unit_type_avatars-list",hideIf:function(e){return!(e.user||e.users&&e.users.length)},name:"Assigned people",header:"Assignments",settings:[{types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"users:assignedUser.Select({id,avatarUri,fullName,email}),currentStateResponsiblePersons"}],template:f(2),listSettings:{title:'<%= _.map(fn.getPeopleOrdered(this.data), fn.getUserText).join("&#10;") %>'},sampleData:r,editorConfig:{type:"assignments"}},{id:"assigned_users",classId:"tau-board-unit_type_avatars-list",hideIf:function(e){return!e.users||!e.users.length
},name:"Assigned people",header:"Assignments",settings:[{types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:[i.M,i.L,i.XL,i.LIST],model:"users:assignedUser.Select({id,avatarUri,fullName,email}),currentStateResponsiblePersons"}],template:f(3),listSettings:{title:'<%= _.map(fn.getPeopleOrdered(this.data), fn.getUserText).join("&#10;") %>'},sampleData:r,editorConfig:{type:"assignments"}},{id:"assigned_users_name_initials",classId:"tau-board-unit_type_assigned_users_names",hideIf:function(e){return!e.users||!e.users.length},name:"Assigned people",header:"Assignments",settings:[{types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:[i.M,i.L,i.XL,i.LIST],model:"users:assignedUser.Select({id,firstName,lastName,fullName}),currentStateResponsiblePersons"}],template:{markup:["<%= fn.assignedUsersInitials(this.data, this.settings) %>"],customFunctions:{getUserName:function(t){var i=e.trim(t.firstName||""),n=e.trim(t.lastName||"");return i&&n?i[0]+n[0]:i[0]||n[0]},assignedUsersInitials:function(e){return m(e,this)}}},listSettings:{title:'<%= _.map(fn.getPeopleOrdered(this.data), fn.getUserText).join("&#10;") %>'},sampleData:{users:[{id:1,firstName:"Uladzimir",lastName:"Karatkievich",fullName:"Uladzimir Karatkievich",isActive:!0},{id:2,firstName:"Janka",lastName:"Kupala",fullName:"Janka Kupala",isActive:!0},{id:3,firstName:"Adam",lastName:"Mickiewicz",fullName:"Adam Mickiewicz",isActive:!0},{id:4,firstName:"Uladzimir",lastName:"Karatkievich",fullName:"Uladzimir Karatkievich",isActive:!0}],currentStateResponsiblePersons:[]},editorConfig:{type:"assignments"}},{id:"assigned_users_last_name",classId:"tau-board-unit_type_assigned_users_names",hideIf:function(e){return!e.users||!e.users.length},name:"Assigned people",header:"Assignments",settings:[{types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:[i.LIST],model:"users:assignedUser.Select({id,firstName,lastName,fullName}),currentStateResponsiblePersons"}],template:{markup:["<%= fn.assignedUsersLastName(this.data, this.settings) %>"],customFunctions:{getUserName:function(t){var i=e.trim(t.firstName||""),n=e.trim(t.lastName||"");
return i&&n?i[0]+". "+n:i||n},assignedUsersLastName:function(e){return m(e,this)}}},listSettings:{title:'<%= _.map(fn.getPeopleOrdered(this.data), fn.getUserText).join("&#10;") %>',maxWidth:300},sampleData:{users:[{id:1,firstName:"Adam",lastName:"Mickiewicz",fullName:"Adam Mickiewicz"},{id:2,firstName:"Janka",lastName:"Kupala",fullName:"Janka Kupala"}],currentStateResponsiblePersons:[]},editorConfig:{type:"assignments"}},{id:"assigned_users_full_name",classId:"tau-board-unit_type_assigned_users_names",hideIf:function(e){return!e.users||!e.users.length},name:"Assigned people",header:"Assignments",settings:[{types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:[i.LIST],model:"users:assignedUser.Select({id,fullName}),currentStateResponsiblePersons"}],template:{markup:["<%= fn.assignedUsersFullName(this.data, this.settings) %>"],customFunctions:{getUserName:function(t){return e.trim(t.fullName)},assignedUsersFullName:function(e){return m(e,this)}}},listSettings:{title:'<%= _.map(fn.getPeopleOrdered(this.data), fn.getUserText).join("&#10;") %>',maxWidth:300},sampleData:{users:[{id:1,fullName:"Adam Mickiewicz"},{id:2,fullName:"Janka Kupala"}],currentStateResponsiblePersons:[]},editorConfig:{type:"assignments"}},{id:"attachments",classId:"tau-board-unit_type_attachments-counter",hideIf:function(e){return!e.attachmentsCount},name:"Attachments count",header:"Attachments",types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!this.data.attachmentsCount%></div>'],sampleData:{attachmentsCount:3},model:"attachmentsCount:attachments.Count()"},{id:"comments_count",classId:"tau-board-unit_type_comments-counter",hideIf:function(e){return!e.commentsCount},name:"Comments count",header:"Comments",types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!this.data.commentsCount%></div>'],sampleData:{commentsCount:27},model:"commentsCount:comments.Count()"},{id:"requests_open",classId:"tau-board-unit_type_requesters-counter",hideIf:function(e){return!e.requestersCount
},name:"Requesters count",header:"Requesters",types:[t.REQUEST],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%!this.data.requestersCount%></div>'],sampleData:{requestersCount:43},model:"requestersCount:requesters.Count()"},{id:"tasks",classId:"tau-board-unit_type_tasks-counter-open-total",hideIf:function(e){return!e.totalTasksCount},name:"Open/total tasks",header:"Tasks",types:[t.STORY],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:[h("Tasks")],term:"task",listSettings:{title:g("Tasks")},sampleData:{totalTasksCount:43,openTasksCount:26},model:"totalTasksCount:tasks.Count(),openTasksCount:tasks.Where(entityState.isFinal != true).Count()"},{id:"story_bugs",classId:"tau-board-unit_type_bugs-counter-open-total",hideIf:function(e){return!e.totalBugsCount},name:"Open/total ${bug,lower,names}",header:"${Bug,camel,names}",types:[t.STORY],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:[h("Bugs")],term:"bug",listSettings:{title:g("Bugs")},sampleData:{totalBugsCount:43,openBugsCount:26},model:"totalBugsCount:bugs.Count(),openBugsCount:bugs.Where(entityState.isFinal != true and project.isActive = true).Count()"},{id:"bugs",classId:"tau-board-unit_type_bugs-counter-open-total-e",hideIf:function(e){return!e.totalBugsCount},name:"Open/total ${bug,lower,names}",header:"${Bug,camel,names}",settings:[{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"totalBugsCount:bugs.Where(project.isActive == true).Count(),openBugsCount:bugs.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.BUILD],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalBugsCount:bugs.Count(),openBugsCount:bugs.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalBugsCount:bugsCount(),openBugsCount:openBugsCount()"}],template:[h("Bugs")],term:"bug",listSettings:{title:g("Bugs")},sampleData:{totalBugsCount:431,openBugsCount:261}},{id:"tasks_badge",classId:"tau-board-unit_type_tasks-counter",hideIf:function(e){return!e.openTasksCount
},name:"Open tasks",header:"Open Tasks",settings:[{types:[t.STORY],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openTasksCount:tasks.Where(entityState.isFinal != true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"openTasksCount:tasks.Where(entityState.isFinal != true and project.isActive == true).Count()"}],template:['<div class="tau-board-unit__value  tau-entity-icon tau-entity-icon--task"><%!this.data.openTasksCount%></div>'],sampleData:{openTasksCount:26}},{id:"story_bugs_badge",classId:"tau-board-unit_type_bugs-counter",hideIf:function(e){return!e.openBugsCount},name:"Open ${bug,lower,names}",header:"Open ${bug,camel,names}",types:[t.STORY],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--bug"><%!this.data.openBugsCount%></div>'],sampleData:{openBugsCount:42},model:"openBugsCount:bugs.Where(entityState.isFinal != true).Count()"},{id:"bugs_badge",classId:"tau-board-unit_type_bugs-counter-e",hideIf:function(e){return!e.openBugsCount},name:"Open ${bug,lower,names}",header:"Open ${bug,camel,names}",settings:[{types:[t.PROJECT,t.TEAM,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.BUILD],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openBugsCount:bugs.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"openBugsCount:bugs.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openBugsCount:openBugsCount()"}],template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--bug"><%!this.data.openBugsCount%></div>'],sampleData:{openBugsCount:421}},{id:"teams_badge",classId:"tau-board-unit_type_teams-counter",hideIf:function(e){return!e.teamsCount},name:"Teams",settings:[{types:[t.PROJECT],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"teamsCount:teamProjects.Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"teamsCount:teamMembers.Count()"}],template:['<div class="tau-board-unit__value"><%!this.data.teamsCount%></div>'],sampleData:{teamsCount:24}},{id:"us_count",classId:"tau-board-unit_type_userstories-counter",hideIf:function(e){return!e.userStoriesCount
},name:"Open ${user story,lower,names}",header:"Open ${User Story,camel,names}",settings:[{types:[t.FEATURE,t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"userStoriesCount:userStories.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"userStoriesCount:userStories.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"userStoriesCount:openUserStoriesCount()"}],template:['<div class="tau-board-unit__value  tau-entity-icon tau-entity-icon--userstory"><%!this.data.userStoriesCount%></div>'],sampleData:{userStoriesCount:425}},{id:"request_badge",classId:"tau-board-unit_type_requests-counter",hideIf:function(e){return!e.requestsCount},name:"Open requests",header:"Open Requests",settings:[{types:[t.PROJECT,t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"requestsCount:requests.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"requestsCount:assignedRequests.Where(entityState.isFinal != true and project.isActive == true).Count()"}],template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--request"><%!this.data.requestsCount%></div>'],sampleData:{requestsCount:43}},{id:"dependencies",classId:"tau-board-unit_type_relations-counter-in-out",hideIf:function(e){return p(e.inbound)&&p(e.outbound)},name:"Relations",types:[t.FEATURE,t.EPIC,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:{markup:n.createUnitValueWrapperTemplate(["<% var inboundCount = fn.count(this.data.inbound); %>","<% var outboundCount = fn.count(this.data.outbound); %>",'<div class="tau-board-unit__value-in <%=this.data.inbound.openBlockers > 0 ? "tau-board-unit__value-blocker":"" %>"><%= inboundCount %></div>','<div class="tau-board-unit__value-out <%=this.data.outbound.openBlockers > 0 ? "tau-board-unit__value-blocker":"" %>"><%= outboundCount %></div>']),customFunctions:{count:d}},listSettings:{title:["<% var inboundCount = fn.count(this.data.inbound); %>","<% var outboundCount = fn.count(this.data.outbound); %>","<% if (inboundCount || outboundCount) { %>","In: <%= inboundCount %>, out: <%= outboundCount %>","<% } %>"]},sampleData:{inbound:{openAssignables:22,openBlockers:0,others:18},outbound:{openAssignables:43,openBlockers:0,others:4}},model:"inbound:masterRelations.activeMasterRelationsCount,outbound:slaveRelations.activeSlaveRelationsCount"},{id:"test_run_short",classId:"tau-board-unit_type_testruns-counter-open-total",hideIf:function(e){return!e.totalTestRunsCount
},name:"Open/total test plan runs",header:"Test Plan Runs",types:[t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.BUILD],sizes:[i.M,i.L,i.XL,i.LIST],template:[h("TestRuns")],term:"testplanrun",listSettings:{title:g("TestRuns")},sampleData:{totalTestRunsCount:403,openTestRunsCount:286},model:"totalTestRunsCount:testPlanRuns.Count(),openTestRunsCount:testPlanRuns.Where(entityState.isFinal != true).Count()"},{id:"test_run_badge",classId:"tau-board-unit_type_testruns-counter",hideIf:function(e){return!e.openTestRunsCount},name:"Open test plan runs",header:"Open Test Plan Runs",types:[t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.BUILD],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--testrun"><%!this.data.openTestRunsCount%></div>'],sampleData:{openTestRunsCount:286},model:"openTestRunsCount:testPlanRuns.Where(entityState.isFinal != true).Count()"},{id:"feature_icon",classId:"tau-board-unit_type_features-counter-open-total",hideIf:function(e){return!e.totalFeaturesCount},name:"Open/total ${feature,lower,names}",header:"${Feature,camel,names}",settings:[{types:[t.EPIC,t.PROJECT,t.RELEASE,t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalFeaturesCount:features.Count(),openFeaturesCount:features.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"totalFeaturesCount:features.Where(project.isActive == true).Count(),openFeaturesCount:features.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalFeaturesCount:featuresCount(),openFeaturesCount:openFeaturesCount()"}],template:[h("Features")],term:"feature",listSettings:{title:g("Features")},sampleData:{totalFeaturesCount:286,openFeaturesCount:204}},{id:"feature_badge",classId:"tau-board-unit_type_features-counter",hideIf:function(e){return!e.openFeaturesCount},name:"Open ${feature,lower,names}",header:"Open ${Feature,camel,names}",settings:[{types:[t.EPIC,t.PROJECT,t.RELEASE,t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openFeaturesCount:features.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"openFeaturesCount:features.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openFeaturesCount:openFeaturesCount()"}],template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--feature"><%!this.data.openFeaturesCount%></div>'],sampleData:{openFeaturesCount:286}},{id:"us_opentotal",classId:"tau-board-unit_type_userstories-counter-open-total",hideIf:function(e){return!e.totalStoriesCount
},name:"Open/total ${user story,lower,names}",header:"${User Story,camel,names}",settings:[{types:[t.FEATURE,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalStoriesCount:userStories.Count(),openStoriesCount:userStories.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"totalStoriesCount:userStories.Where(project.isActive == true).Count(),openStoriesCount:userStories.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalStoriesCount:userStoriesCount(),openStoriesCount:openUserStoriesCount()"}],template:[h("Stories")],listSettings:{title:g("Stories")},sampleData:{totalStoriesCount:281,openStoriesCount:201}},{id:"effort_total_collection",classId:"tau-board-unit_type_effort-total-e",name:"Total effort",header:"Effort",types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%=fn.precise_round(this.data.effort||0,1)%></div>','<div class="tau-board-unit__points"><%=this.data.units%></div>'],sampleData:{effort:255.5,units:"pt"},model:"effort:bugs.Sum(effort)+userStories.Sum(effort),units:units"},{id:"effort_complete_collection",classId:"tau-board-unit_type_effort-total-e tau-board-unit_type_effort-complete",name:"Completed effort",header:"Completed Effort",types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value"><%=fn.precise_round(this.data.effort||0,1)%></div>','<div class="tau-board-unit__points"><%=this.data.units%></div>'],sampleData:{effort:201.3,units:"pt"},model:"effort:bugs.Sum(effort)+userStories.Sum(effort)-bugs.Sum(effortToDo)-userStories.Sum(effortToDo),units:units"},{id:"effort_spent_total_collection",classId:"tau-board-unit_type_effort-todo-total-e",name:"Todo/total effort",header:"Effort",types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],template:['<div class="tau-board-unit__value-todo"><%=fn.precise_round(this.data.effortToDo||0,1)%></div>','<div class="tau-board-unit__value-total"><%=fn.precise_round(this.data.effort||0,1)%></div>','<div class="tau-board-unit__points"><%=this.data.units%></div>'],sampleData:{effortToDo:253.7,effort:380.3,units:"pt"},model:"effort:bugs.Sum(effort)+userStories.Sum(effort),effortToDo:bugs.Sum(effortToDo)+userStories.Sum(effortToDo),units:units",listSettings:{title:["<%= fn.precise_round(this.data.effortToDo || 0, 1) %>"," / ","<%= fn.precise_round(this.data.effort || 0, 1) %><%= this.data.units %>"]}}],b=new a;
return b.isEnabled("entity.epics")&&v.push([{id:"epic_icon",classId:"tau-board-unit_type_epics-counter-open-total",hideIf:function(e){return!e.totalEpicsCount},name:"Open/total ${epic,lower,names}",header:"${Epic,camel,names}",settings:[{types:[t.PROJECT,t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalEpicsCount:epics.Count(),openEpicsCount:epics.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"totalEpicsCount:epics.Where(project.isActive == true).Count(),openEpicsCount:epics.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"totalEpicsCount:epicsCount(),openEpicsCount:openEpicsCount()"}],template:[h("Epics")],term:"epic",listSettings:{title:g("Epics")},sampleData:{totalEpicsCount:28,openEpicsCount:20}},{id:"epic_badge",classId:"tau-board-unit_type_epics-counter",hideIf:function(e){return!e.openEpicsCount},name:"Open ${epic,lower,names}",header:"Open ${Epic,camel,names}",settings:[{types:[t.PROJECT,t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openEpicsCount:epics.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"openEpicsCount:epics.Where(entityState.isFinal != true and project.isActive == true).Count()"},{types:[t.PROGRAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"openEpicsCount:openEpicsCount()"}],template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--epic"><%!this.data.openEpicsCount%></div>'],sampleData:{openEpicsCount:20}}]),n.pushClones(v,{hideIf:function(e){return!e.tags||!e.tags.length},name:"Tags",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.TEAM,t.PROJECT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROGRAM],template:{markup:['<div class="tau-board-unit_type_tags-list__wrapper">',"<%=fn.tags(this.data)%>","</div>"],customFunctions:{tags:o}},sampleData:{tags:["UX","Design","Prototype","Javascript"]},model:"tags:tagObjects.Select(name)",editorConfig:{type:"tagsInline"},listSettings:{title:'<%= this.data.tags.join("&#10;") %>',minWidth:70,maxWidth:600}},[{id:"tags_short",classId:"tau-board-unit_type_list tau-board-unit_type_tags-list-s",sizes:[i.M,i.L,i.XL,i.LIST]},{id:"tags_short_xs",classId:"tau-board-unit_type_list tau-board-unit_type_tags-list-xs",sizes:[i.M,i.L,i.XL]},{id:"tags_long",classId:"tau-board-unit_type_list tau-board-unit_type_tags-list",sizes:[i.XS,i.S,i.M,i.L,i.XL],sections:1}]),n.pushClones(v,{hideIf:function(e){return!(e.testCasesCount||e.passedCount||e.failedCount||e.notRunCount)
},name:"Total test cases",header:"Test Cases",settings:[{types:[t.STORY,t.TEST_PLAN],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"testCasesCount:testCases.Count()"},{types:[t.TEST_PLAN_RUN],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"testCasesCount:passedCount+failedCount+notRunCount"}],sampleData:{testCasesCount:142}},[{id:"test_case_badge",classId:"tau-board-unit_type_testcases-counter",template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--testcase"><%!this.data.testCasesCount%></div>']},{id:"test_case_icon",classId:"tau-board-unit_type_testcases-counter-alt",template:['<div class="tau-board-unit__value"><%!this.data.testCasesCount%></div>'],term:"testcase"}]),n.pushClones(v,{hideIf:function(e){return!e.impedimentsCount},name:"Open ${impediment,lower,names}",header:"Open ${Impediment,camel,names}",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_PLAN_RUN],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],sampleData:{impedimentsCount:7},model:"impedimentsCount:masterRelations.activeMasterRelationsCount.openBlockers"},[{id:"impediments",classId:"tau-board-unit_type_impediments-counter-alt",template:['<div class="tau-board-unit__value"><%!this.data.impedimentsCount%></div>']},{id:"impediments_badge",classId:"tau-board-unit_type_impediments-counter",template:['<div class="tau-board-unit__value tau-entity-icon tau-entity-icon--impediment"><%!this.data.impedimentsCount%></div>']}]),n.pushClones(v,{classId:"tau-board-unit_type_list tau-board-unit_type_projects-abbrs-list",hideIf:function(e){return!e.projects||!e.projects.length},name:"Projects abbreviations",header:"Projects",template:{markup:["<%=fn.projects(this.data, 2)%>"],customFunctions:{projects:u}},sampleData:{projects:[{color:"#f9d9d1",abbr:"MMM",name:"MMM"},{color:"#fbe9d6",abbr:"MWO",name:"MWO"},{color:"#fbe9d6",abbr:"MWO",name:"MWO"},{color:"#fbe9d6",abbr:"MWO",name:"MWO"}]},listSettings:{title:'<%= _.pluck(this.data.projects, "name").join("&#10;") %>'}},[{id:"project_abbrs_team",types:[t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"projects:TeamProjects.Where(project.IsActive == true).Select({project.color,abbr:project.abbreviation,name:project.name})"},{id:"project_abbrs_user",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"projects:ProjectMembers.Where(project.IsActive == true).Select({project.color,abbr:project.abbreviation,name:project.name})"}]),n.pushClones(v,{classId:"tau-board-unit_type_list tau-board-unit_type_projects-list",hideIf:function(e){return!e.projects||!e.projects.length
},name:"Projects",template:{markup:["<%=fn.projects(this.data, 3)%>"],customFunctions:{projects:l}},sampleData:{projects:[{color:"#f9d9d1",abbr:"MMM",name:"MMM"},{color:"#fbe9d6",abbr:"MWO",name:"MWO"},{color:"#fbe9d6",abbr:"MWO",name:"MWO"},{color:"#fbe9d6",abbr:"MWO",name:"MWO"}]},listSettings:{title:'<%= _.pluck(this.data.projects, "name").join("&#10;") %>'}},[{id:"project_icons_team",types:[t.TEAM],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"projects:TeamProjects.Where(project.IsActive == true).Select({project.color,abbr:project.abbreviation,name:project.name})"},{id:"project_icons_user",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"projects:ProjectMembers.Where(project.IsActive == true).Select({project.color,abbr:project.abbreviation,name:project.name})"}]),n.pushClones(v,{classId:"tau-board-unit_type_list tau-board-unit_type_teams-list",hideIf:function(e){return!e.teams||!e.teams.length},name:"Teams",template:{markup:["<%=fn.teams(this.data, 3)%>"],customFunctions:{teams:c}},sampleData:{teams:[{icon:"apple",name:"Apple Team"},{icon:"windows",name:"Windows Team"},{icon:"linux",name:"Linux Team"},{name:"Anonymous"}]},listSettings:{title:'<%= _.pluck(this.data.teams, "name").join("&#10;") %>'}},[{id:"teams_user",types:[t.USER,t.ASSIGNED_USER],sizes:[i.S,i.M,i.L,i.XL,i.LIST],model:"teams:teamMembers.Select({team.icon,team.name})"},{id:"teams_project",types:[t.PROJECT],sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST],model:"teams:TeamProjects.Select({team.icon,team.name})"}]),n.pushClones(v,{classId:"tau-board-unit_type_list tau-board-unit_type_avatars-list",sections:1,hideIf:function(e){return!e.users||!e.users.length},name:"People",sizes:[i.M,i.L,i.XL,i.LIST],template:["<% var users = this.data.users, count = users.length;%>",'<div class="tau-board-unit_type_list__total-counter"><%= count %></div>',"<% for (var i = 0; i < count; i++) {%>","<% var user = users[i]; %>",'<div class="tau-board-unit_type_list__item">','<div class="tau-avatar <%=user.isActive?"":"tau-avatar-not-active"%>">','<img src="<%= user.avatarUri %>20" <% if (!this.settings.isDesignMode) { %>title="<%! _.trim(user.fullName) || user.email %>"<% } %>>',"</div>","</div>","<% }%>"],sampleData:r,listSettings:{title:'<%= _.map(fn.getPeopleOrdered(this.data), fn.getUserText).join("&#10;") %>'}},[{id:"people_icons_project",types:[t.PROJECT],model:"users:projectMembers.Select({user.avatarUri,user.fullName,user.email,user.isActive})"},{id:"people_icons_team",types:[t.TEAM],model:"users:teamMembers.Select({user.avatarUri,user.fullName,user.email,user.isActive})"}]),n.pushClones(v,{classId:"tau-board-unit_type_projects-counter",hideIf:function(e){return!e.projectsCount
},name:"Projects",template:['<div class="tau-board-unit__value"><%!this.data.projectsCount%></div>'],sampleData:{projectsCount:24}},[{id:"projects_badge_team",types:[t.TEAM],model:"projectsCount:teamProjects.Where(project.IsActive == true).Count()",sizes:[i.XS,i.S,i.M,i.L,i.XL,i.LIST]},{id:"projects_badge_user",types:[t.USER,t.ASSIGNED_USER],model:"projectsCount:projectMembers.Where(project.IsActive == true).Count()",sizes:[i.S,i.M,i.L,i.XL,i.LIST]},{id:"projects_badge_program",types:[t.PROGRAM],model:"projectsCount:projects.Where(IsActive == true).Count()",sizes:[i.S,i.M,i.L,i.XL,i.LIST]}]),e.each(v,function(e){e.category="collection",e.lazy=!0}),v}),define("tau/models/board.customize.units/board.customize.units.visualization",["Underscore","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.base"],function(e,t,i,n){var a=[{id:"openClosed",lazy:!0,classId:"tau-board-unit_type_stories-bugs-sparklines",name:"User Stories and Bugs sparklines.",types:[t.TEAM,t.PROJECT],sizes:[i.M,i.L,i.XL],sections:2,template:['<div <%if (!this.settings.isDesignMode) { %>title="User Stories sparkline provides an overview of progress over the last 16 weeks. Top: done user stories per week. Bottom: added user stories per week."<%}%> class="tau-board-unit_type_stories-bugs-sparklines__us-chart">',"<%if (this.settings.isDesignMode) { %>",'   <img src="<%=this.data.usUrl%>">',"<% } else { %>","   <svg class=\"tau-sparkline i-role-sparkline\" data-source='<%= JSON.stringify(this.data.sparklines.userStories) %>' />","<%}%>","</div>",'<div <%if (!this.settings.isDesignMode) { %>title="Bugs sparkline provides an overview of progress over the last 16 weeks. Top: closed bugs per week. Bottom: added bugs per week."<%}%> class="tau-board-unit_type_stories-bugs-sparklines__bugs-chart">',"<%if (this.settings.isDesignMode) { %>",'   <img src="<%=this.data.bugUrl%>">',"<% } else { %>","   <svg class=\"tau-sparkline tau-sparkline-bugs i-role-sparkline\" data-source='<%= JSON.stringify(this.data.sparklines.bugs) %>' />","<%}%>","</div>"],sampleData:{id:"visualization",bugUrl:n.url("/Javascript/tau/css/images/icons/bug-chart.png"),usUrl:n.url("/Javascript/tau/css/images/icons/us-chart.png")},model:"{ userStories.Sparkline(16) AS userStories, bugs.Sparkline(16) AS bugs } as sparklines"},{id:"burndownlink",classId:"tau-board-unit_type_burndownlink",name:"Burn down link",header:"Burn Down",types:[t.ITERATION,t.TEAM_ITERATION,t.RELEASE],sizes:[i.S,i.M,i.L,i.XL,i.LIST],template:['<span class="tau-board-unit_type_burndown-trigger__control tau-label__burnDown" data-entity-id="<%= this.data.id %>" data-entity-type="<%= this.data.entityType.toLowerCase() %>"></span>'],sampleData:{id:15,entityType:"release"},model:"id, entityType.Name as entityType"}];
return e.each(a,function(e){e.category="visualization"}),a}),define("tau/services/customize/templateRegistrators/templateRegistrator.functions",["Underscore"],function(e){var t=function(e,t,n){return[e,'="'+i(t,n)+'"'].join("")},i=function(e,t){return['<%=fn.term("',e,'","',t,'")%>'].join("")},n=function(t){var i={};return i=e.isString(t.term)?{name:t.term,iconType:"iconSmall",titleType:"name"}:e.defaults(t.term,{iconType:"iconSmall",titleType:"name"})};return{getAdditionalAttributes:function(i){var a=[];if(i.data&&(a=e.map(i.data,function(e,t){return"data-"+t+'="'+i.data[t]+'"'})),i.term){var r=n(i);r.titleType&&a.push(t("title",r.name,r.titleType))}return a.join(" ")},createTerm:function(e){if(e.term){var t=n(e);return['<span class="tau-entity-icon tau-entity-icon--',t.name.toLowerCase(),'">',i(t.name,t.iconType),"</span>"].join("")}return""}}}),define("tau/services/customize/templateRegistrators/cardTemplateRegistrator",["jQuery","Underscore","tau/core/class","tau/core/templates-factory","tau/services/customize/templateRegistrators/templateRegistrator.functions"],function(e,t,i,n,a){return i.extend({registerUnit:function(e){var i={name:"unit."+e.id,engine:"jqote2",customFunctions:t.extend({createClassName:function(i){var n=["i-role-card-content-"+e.id,this.unitClass(i),t.isFunction(e.classId)?e.classId(i.data):e.classId];return n.join(" ")},_hideIf:function(e){return!e.data||this.hideIf(e.data)}},e.template.customFunctions),markup:t.flatten(["<% if (!fn._hideIf(this)) { %>",'<div class="<%= fn.createClassName(this) %>" ',"<%= fn.unitData(this) %> ",a.getAdditionalAttributes(e),">",a.createTerm(e),e.template.markup||e.template,"</div>","<% } %>"])};return n.register(i),{card:i.name}}})}),define("tau/models/board.customize.units/board.customize.units.settings.default.generated",[],function(){return{feature:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"impediments",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"us_count",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"dependencies",alignment:"alt"},{id:"us_opentotal",alignment:"alt"}],[{id:"attachments",alignment:"base"},{id:"team",alignment:"alt"},{id:"release_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"state_short",alignment:"base"},{id:"release_short",alignment:"base"},{id:"business_value_short",alignment:"base"},{id:"team_name_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tags_short",alignment:"base"}]]},epic:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"impediments",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"dependencies",alignment:"alt"}],[{id:"attachments",alignment:"base"},{id:"team",alignment:"alt"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"state_short",alignment:"base"},{id:"business_value_short",alignment:"base"},{id:"team_name_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tags_short",alignment:"base"}]]},userstory:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"impediments",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"story_bugs_badge",alignment:"alt"},{id:"tasks_badge",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"dependencies",alignment:"alt"},{id:"story_bugs_badge",alignment:"alt"},{id:"tasks_badge",alignment:"alt"}],[{id:"attachments",alignment:"base"},{id:"team",alignment:"alt"},{id:"feature_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"state_short",alignment:"base"},{id:"release_short",alignment:"base"},{id:"iteration_short",alignment:"base"},{id:"business_value_short",alignment:"base"},{id:"team_name_short",alignment:"base"},{id:"team_iteration_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tags_short",alignment:"base"}]]},task:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"impediments",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"userstory_id",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"assigned_users",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"dependencies",alignment:"alt"}],[{id:"attachments",alignment:"base"},{id:"team",alignment:"alt"},{id:"us_name_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"state_short",alignment:"base"},{id:"us_name_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tags_short",alignment:"base"}]]},bug:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"impediments",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assigned_users",alignment:"base"},{id:"effort_total",alignment:"base"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"assignments_big_2",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"dependencies",alignment:"alt"},{id:"userstory_id",alignment:"alt"}],[{id:"attachments",alignment:"base"},{id:"team",alignment:"alt"},{id:"severity_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"effort_total",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"state_short",alignment:"base"},{id:"us_name_short",alignment:"base"},{id:"release_short",alignment:"base"},{id:"iteration_short",alignment:"base"},{id:"business_value_short",alignment:"base"},{id:"team_name_short",alignment:"base"},{id:"team_iteration_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tags_short",alignment:"base"}]]},request:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"requests_open",alignment:"base"},{id:"request_is_replied",alignment:"base"},{id:"request_question",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"request_question",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"requests_open",alignment:"base"},{id:"request_is_replied",alignment:"base"},{id:"create_date",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"requests_open",alignment:"base"},{id:"create_date",alignment:"base"},{id:"dependencies",alignment:"alt"}],[{id:"request_is_replied",alignment:"base"},{id:"attachments",alignment:"base"},{id:"comments_count",alignment:"base"},{id:"team",alignment:"alt"},{id:"assignments_big_2",alignment:"alt"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"state_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"create_date",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"last_comment_date",alignment:"base"},{id:"last_commented_user_icon",alignment:"base"},{id:"request_question",alignment:"base"},{id:"request_private",alignment:"base"},{id:"owner",alignment:"base"}]]},testcase:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"tc_last_status",alignment:"base"},{id:"owner",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"tc_last_status",alignment:"base"},{id:"create_date",alignment:"base"},{id:"owner",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"tc_last_status",alignment:"base"},{id:"tc_last_run_date",alignment:"base"},{id:"us_name_short",alignment:"base"},{id:"owner",alignment:"alt"}],[{id:"tc_note_message_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tc_last_status",alignment:"base"},{id:"us_name_short",alignment:"base"},{id:"tags_short",alignment:"base"}]]},impediment:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"responsible_person",alignment:"base"},{id:"owner",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"request_private",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"responsible_person",alignment:"base"},{id:"related_entity_long",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"request_private",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"responsible_person",alignment:"base"},{id:"owner",alignment:"alt"},{id:"related_entity_long",alignment:"alt"}],[{id:"dependencies",alignment:"base"},{id:"priority_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"state_short",alignment:"base"},{id:"related_entity_short",alignment:"base"},{id:"responsible_person",alignment:"base"},{id:"request_private",alignment:"base"},{id:"owner",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"priority_short",alignment:"base"},{id:"tags_short",alignment:"base"}]]},user:{xs:[[{id:"user_avatar",alignment:"base"}]],s:[[{id:"user_big_details",alignment:"base"}],null],m:[[{id:"user_big_details",alignment:"base"}],null,[{id:"projects_badge_user",alignment:"base"},{id:"teams_badge",alignment:"base"},{id:"allocation",alignment:"alt"}]],l:[[{id:"user_big_details",alignment:"base"}],null,[{id:"allocation",alignment:"base"},{id:"projects_badge_user",alignment:"base"},{id:"teams_badge",alignment:"base"},{id:"user_is_active",alignment:"alt"},{id:"bugs_badge",alignment:"alt"},{id:"us_count",alignment:"alt"}]],xl:[[{id:"user_avatar",alignment:"base"},{id:"user_name",alignment:"base"},{id:"user_email_short",alignment:"alt"}],[{id:"teams_user",alignment:"base"},{id:"project_abbrs_user",alignment:"base"},{id:"bugs_badge",alignment:"alt"},{id:"us_count",alignment:"alt"}]],list:[[{id:"user_name",alignment:"base"},{id:"user_entity_id",alignment:"base"},{id:"user_avatar",alignment:"base"},{id:"user_email_short",alignment:"base"},{id:"user_is_active",alignment:"base"},{id:"user_observer",alignment:"base"},{id:"user_admin",alignment:"base"},{id:"role_short",alignment:"base"},{id:"teams_user",alignment:"base"},{id:"project_abbrs_user",alignment:"base"}]]},team:{xs:[[{id:"team_team",alignment:"base"},{id:"team_project_name_long",alignment:"base"}]],s:[[{id:"team_project_name_long",alignment:"base"}],[{id:"team_team",alignment:"base"},{id:"project_abbrs_team",alignment:"alt"}]],m:[[{id:"team_team",alignment:"base"},{id:"project_abbrs_team",alignment:"alt"},{id:"team_project_name_long",alignment:"base"}],[{id:"people_icons_team",alignment:"base"}],[{id:"feature_badge",alignment:"base"},{id:"us_count",alignment:"base"},{id:"bugs_badge",alignment:"base"},{id:"owner",alignment:"alt"}]],l:[[{id:"team_team",alignment:"base"},{id:"project_abbrs_team",alignment:"alt"},{id:"team_project_name_long",alignment:"base"}],[{id:"people_icons_team",alignment:"base"}],[{id:"feature_badge",alignment:"base"},{id:"us_count",alignment:"base"},{id:"bugs_badge",alignment:"base"},{id:"owner",alignment:"alt"}],[{id:"openClosed",alignment:"base"}],null],xl:[[{id:"general_entity_id",alignment:"base"},{id:"team_team",alignment:"base"},{id:"project_abbrs_team",alignment:"alt"},{id:"team_project_name_short",alignment:"base"}],[{id:"people_icons_team",alignment:"base"}]],list:[[{id:"team_project_name_long",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"team_team",alignment:"base"},{id:"people_icons_team",alignment:"base"},{id:"project_abbrs_team",alignment:"base"}]]},project:{xs:[[{id:"project_project_abbr",alignment:"base"},{id:"team_project_name_long",alignment:"base"}]],s:[[{id:"team_project_name_long",alignment:"base"}],[{id:"project_project_icon",alignment:"base"},{id:"teams_project",alignment:"alt"}]],m:[[{id:"project_project_icon",alignment:"base"},{id:"teams_project",alignment:"alt"},{id:"team_project_name_long",alignment:"base"}],[{id:"people_icons_project",alignment:"base"}],[{id:"feature_badge",alignment:"base"},{id:"us_count",alignment:"base"},{id:"bugs_badge",alignment:"base"},{id:"owner",alignment:"alt"}]],l:[[{id:"project_project_icon",alignment:"base"},{id:"teams_project",alignment:"alt"},{id:"team_project_name_long",alignment:"base"}],[{id:"people_icons_project",alignment:"base"}],[{id:"feature_badge",alignment:"base"},{id:"us_count",alignment:"base"},{id:"bugs_badge",alignment:"base"},{id:"owner",alignment:"alt"}],[{id:"openClosed",alignment:"base"}],null],xl:[[{id:"general_entity_id",alignment:"base"},{id:"project_project_icon",alignment:"base"},{id:"teams_project",alignment:"alt"},{id:"team_project_name_long",alignment:"base"}],[{id:"people_icons_project",alignment:"base"}]],list:[[{id:"team_project_name_long",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_project_abbr",alignment:"base"},{id:"process_short",alignment:"base"},{id:"long_dates",alignment:"base"},{id:"owner",alignment:"base"},{id:"project_is_active",alignment:"base"}]]},iteration:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}],[{id:"entity_name_1line",alignment:"base"}],[{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_total_collection",alignment:"base"},{id:"bugs_badge",alignment:"alt"},{id:"us_count",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}],[{id:"entity_name_1line",alignment:"base"}],[{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"bugs",alignment:"alt"},{id:"us_opentotal",alignment:"alt"}],[{id:"project_abbr",alignment:"alt"},{id:"release_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"release_short",alignment:"base"},{id:"project_abbr",alignment:"base"}]]},teamiteration:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}],[{id:"entity_name_1line",alignment:"base"}],[{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_total_collection",alignment:"base"},{id:"bugs_badge",alignment:"alt"},{id:"us_count",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}],[{id:"entity_name_1line",alignment:"base"}],[{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"bugs",alignment:"alt"},{id:"us_opentotal",alignment:"alt"}],[{id:"team",alignment:"alt"},{id:"team_name_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"team_name_short",alignment:"base"}]]},release:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}],[{id:"entity_name_1line",alignment:"base"}],[{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_total_collection",alignment:"base"},{id:"feature_badge",alignment:"alt"},{id:"bugs_badge",alignment:"alt"},{id:"us_count",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"burndownlink",alignment:"alt"}],[{id:"entity_name_1line",alignment:"base"}],[{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"feature_icon",alignment:"alt"},{id:"bugs",alignment:"alt"},{id:"us_opentotal",alignment:"alt"}],[{id:"project_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"dates",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"project_abbr",alignment:"base"}]]},testplan:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"test_cases",alignment:"base"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"test_run_short",alignment:"base"},{id:"test_case_icon",alignment:"base"},{id:"test_cases",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"test_run_short",alignment:"base"},{id:"test_case_icon",alignment:"base"},{id:"test_cases",alignment:"alt"}],[{id:"owner",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"test_case_icon",alignment:"base"},{id:"tags_short",alignment:"base"}]]},testplanrun:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"test_cases",alignment:"base"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"assignments_big_2",alignment:"base"},{id:"test_cases",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"assignments_big_2",alignment:"base"},{id:"dependencies",alignment:"alt"},{id:"test_cases",alignment:"alt"}],[{id:"team",alignment:"alt"},{id:"test_plan_long",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"state_short",alignment:"base"},{id:"test_plan_short",alignment:"base"},{id:"build_short",alignment:"base"},{id:"iteration_short",alignment:"base"},{id:"release_short",alignment:"base"},{id:"tags_short",alignment:"base"}]]},build:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"build_date",alignment:"base"}]],m:[[{id:"general_entity_id",alignment:"base"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"build_date",alignment:"base"},{id:"test_run_badge",alignment:"alt"},{id:"bugs_badge",alignment:"alt"}]],l:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_3lines",alignment:"base"}],null,[{id:"build_date",alignment:"base"},{id:"test_run_short",alignment:"alt"},{id:"bugs",alignment:"alt"}],[{id:"release_id",alignment:"base"},{id:"iteration_id",alignment:"base"}]],xl:[[{id:"entity_name_1line",alignment:"base"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"build_date",alignment:"base"},{id:"iteration_short",alignment:"base"},{id:"release_short",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"tags_short",alignment:"base"}]]},projectmember:{xs:[[{id:"user_avatar",alignment:"base"}]],s:[[{id:"pm_big_details",alignment:"base"}],null],m:[[{id:"pm_big_details",alignment:"base"}],null,[{id:"pm_dates",alignment:"base"},{id:"percent",alignment:"base"}]],l:[[{id:"pm_big_details",alignment:"base"}],null,[{id:"pm_dates",alignment:"base"},{id:"percent",alignment:"base"}]],xl:[[{id:"user_avatar",alignment:"base"},{id:"user_name",alignment:"base"},{id:"percent",alignment:"base"},{id:"role_short",alignment:"base"}],[{id:"pm_dates",alignment:"base"},{id:"project_abbr",alignment:"base"}]],list:[[{id:"user_name",alignment:"base"},{id:"user_avatar",alignment:"base"},{id:"project_short",alignment:"base"},{id:"percent",alignment:"base"},{id:"role_short",alignment:"base"},{id:"pm_dates",alignment:"base"}]]},teammembership:{xs:[[{id:"user_avatar",alignment:"base"}]],s:[[{id:"tm_big_details",alignment:"base"}],null],m:[[{id:"tm_big_details",alignment:"base"}],null,[{id:"pm_dates",alignment:"base"},{id:"percent",alignment:"base"},{id:"team_name_short",alignment:"alt"}]],l:[[{id:"tm_big_details",alignment:"base"}],null,[{id:"pm_dates",alignment:"base"},{id:"percent",alignment:"base"},{id:"team_name_short",alignment:"alt"}],[{id:"activity",alignment:"base"}],null],xl:[[{id:"user_avatar",alignment:"base"},{id:"user_name",alignment:"base"},{id:"percent",alignment:"base"},{id:"role_short",alignment:"base"},{id:"pm_dates",alignment:"base"},{id:"team",alignment:"base"}]],list:[[{id:"user_name",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"user_avatar",alignment:"base"},{id:"percent",alignment:"base"},{id:"role_short",alignment:"base"},{id:"pm_dates",alignment:"base"},{id:"team",alignment:"base"}]]},program:{xs:[[{id:"entity_name_small_sizes",alignment:"base"}]],s:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"tags_long",alignment:"base"}]],m:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"tags_long",alignment:"base"}],[{id:"long_dates",alignment:"base"},{id:"dependencies",alignment:"alt"}]],l:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"tags_long",alignment:"base"}],[{id:"long_dates",alignment:"base"},{id:"dependencies",alignment:"alt"}]],xl:[[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"long_dates",alignment:"base"},{id:"dependencies",alignment:"alt"}]],list:[[{id:"entity_name_1line",alignment:"base"},{id:"start_date",alignment:"base"},{id:"end_date",alignment:"base"}]]}}
}),define("tau/models/board.customize.units/board.customize.units.settings.default.additional",[],function(){return{process:{list:[[{id:"name_unit"}]]},entitystate:{list:[[{id:"name_unit"}]]},enddate:{list:[[{id:"name_unit"}]]},datetime:{list:[[{id:"name_unit"}]]},time:{list:[[{id:"unit_time"}]]},createdate:{list:[[{id:"name_unit"}]]},startdate:{list:[[{id:"name_unit"}]]},tag:{list:[[{id:"name_unit"}]]},assigneduser:{list:[[{id:"user_name",alignment:"base"},{id:"user_entity_id",alignment:"base"},{id:"user_email_long",alignment:"base"},{id:"user_is_active",alignment:"base"},{id:"user_observer",alignment:"base"},{id:"user_admin",alignment:"base"},{id:"role_long",alignment:"base"},{id:"teams_user",alignment:"base"},{id:"project_abbrs_user",alignment:"base"},{id:"user_avatar",alignment:"base"}]]},priority:{list:[[{id:"name_unit"}]]},effort:{list:[[{id:"name_unit"}]]},severity:{list:[[{id:"name_unit"}]]},source:{list:[[{id:"name_unit"}]]},requestsourceenum:{list:[[{id:"name_unit"}]]},requesttype:{list:[[{id:"name_unit"}]]},inboundrelations:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"}]]},outboundrelations:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"}]]},role:{list:[[{id:"name_unit"}]]},program:{list:[[{id:"name_unit"}]]}}}),define("tau/models/board.customize.units/board.customize.units.settings.default",["Underscore","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.settings.default.generated","tau/models/board.customize.units/board.customize.units.settings.default.additional"],function(e,t,i,n,a){return{get:function(e,t){return n[t]&&n[t][e]||a[t]&&a[t][e]||[]}}}),define("tau/ui/templates/board.plus/customized/ui.template.boardplus.card-fake.customized",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"boardplus.card-fake.customized",engine:"jqote2",markup:['<div class="tau-ui-size-<%=this.size%>" style="visibility: hidden">','<div class="i-role-card tau-card-v2 tau-card-v2_type_<%=this.type%>">',"<%for(var i = 0;i<this.countSections;i++) {%>",'<div class="tau-card-v2__section"></div>',"<%}%>","</div>","</div>"],dependencies:[]};
return t.register(i)}),define("tau/utils/utils.convertUserName",["Underscore"],function(e){return{getFullName:function(t){var i=e.asString(t.firstName)+" "+e.asString(t.lastName);return e.trim(i)||(i=t.email||""),i}}}),define("tau/ui/extensions/board.plus/ui.board.plus.utils",["Underscore","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/models/board.customize.units/board.customize.units.settings.default","tau/ui/templates/board.plus/customized/ui.template.boardplus.card-fake.customized","tau/models/board.customize.units/const.card.sizes","tau/utils/utils.convertUserName"],function(e,t,i,n,a,r){var s=["epic","feature","userstory","task","bug","request","testcase","testcaserun","testplan","testplanrun","impediment","user","team","project","release","iteration","teamiteration","build","projectmember","program"],o={},l=function(t){return e.trim(t)},u={};return{esc:l,getDomNodeByIdFast:function(e,t){return window.document.getElementById(t)},generateId:function(e){var t=[];return e.hasOwnProperty("x")&&(t.push("x"),t.push(e.x),t.push("-")),e.hasOwnProperty("y")&&(t.push("y"),t.push(e.y),t.push("-")),l(t.join(""))},generateHolderId:function(e){return"ch_"+this.generateId(e)},generateElementData:function(t){var i=[];return e.forEach(t,function(t,n){e.isUndefined(t)||i.push("data-"+n.toLowerCase()+'="'+e.escape(t)+'"')}),i.join(" ")},getCardIds:function(e){return u[e.id]||[]},getCardId:function(e){return u[e.id]||[]},getLatestCardId:function(e){var t=u[e];return t[t.length-1]},resetCardIds:function(){u={}},getCardSeed:function(e){return e.type.toLowerCase()+"-"+e.id},generateCardId:function(e){var t=u[e.id]=u[e.id]||[],i=this.getCardSeed(e)+"-"+t.length;return t.push(i),i},dimension:function(e,t){var i=e.attr("id");o[i]={};var n=o[i],a={x:t.attr("data-x"),y:t.attr("data-y")},r=t.attr("role");n.all||(n.all=e.find(".i-role-"+r));var s=function(){return!1};a.x&&(s=function(){return this.getAttribute("data-x")==a.x}),a.y&&(s=function(){return this.getAttribute("data-y")==a.y
});var l=t.attr("id");return n[l]||(n[l]=n.all.filter(s)),n[l]},isHidden:function(e){return e.attr("data-is-hidden")||!1},isSupportedCardForView:function(t){var i=e.isString(t)?t:t.entityType;return e.include(s,i.toLowerCase())},convertCellAxisData:function(t){var i,n=t.dynamic&&t.dynamic.items&&t.dynamic.items.length?t.dynamic.items[0]:null;return n?(i={id:n.id,name:this._getCellAxisName(n),itemData:this._getItemDataTypeSpecificAugmented(n),entity:{id:this._getEntityId(n),type:this._getEntityType(n)}},i.isEntity=!(!i.entity.id||!i.entity.type),i.isSupportView=i.isEntity&&this.isSupportedCardForView({entityType:i.entity.type})):i={id:null,name:"",itemData:{},entity:{id:null,type:null},isEntity:!1,isSupportView:!1},e.extend(t,i)},getOperationLocation:function(e){var t=(e.items[0].location||"card").toLowerCase(),i=t;return"card"!==t&&(i=t.charAt(0)),i},isCardReBuildOperation:function(t){var i=this.getOperationLocation(t);return e.contains(["updated","added","cascade"],t.name)&&"card"===i},getClassForCustomizeSection:function(e){var t="";return e.forEach(function(e){2==e.unit.sections?t="tau-card-v2__section_double":3==e.unit.sections&&(t="tau-card-v2__section_triple")}),t},orderListUnits:function(t){return e.sortBy(t,function(e){return-e.rank})},getListKeyByTypes:function(e){return e=e||[],"list_"+e.join("_")},getCardRenderData:function(e,t,i){return t?{dataItem:e,layout:t,configurator:i}:e},getCardSize:e.memoize(function(e,t,r){var s=r||0,o=i.get(t,e).length,l=n.get().bind({},{size:t,countSections:o,type:e});l.appendTo("body");var u,c=l.find(".i-role-card");u=t===a.XL?parseInt(c.css("minWidth"),10):c.outerWidth();var d={width:Math.ceil(u+s),height:Math.ceil(c.outerHeight()+2*s)};return l.remove(),d},function(e,t,i){return e+t+i}),_getItemDataTypeSpecificAugmented:function(t){var i=t.data;return"team"==t.type.toLowerCase()&&(i.users=i.users||[],i.users=e.map(i.users,function(t){return e.extend(t,{name:r.getFullName(t),avatarUri:t.avatarUri})})),i},_getCellAxisName:function(t){var i=t.name||"",n=t.data;
return n&&(n.name?i=n.name:e.isArray(n.names)?i=n.names.join(", "):("user"==n.type.toLowerCase()||n.hasOwnProperty("firstName")&&n.hasOwnProperty("lastName"))&&(i=r.getFullName(n))),i},_getEntityId:function(e){return e.data&&e.data.id?e.data.id:null},_getEntityType:function(e){return e.data&&e.data.type?e.data.type.toLowerCase():e.type?e.type.toLowerCase():""}}}),define("tau/utils/utils.customFields.list",["Underscore"],function(e){return{getListHeader:function(t){var i=t.lastIndexOf(" custom field");i>0&&(t=t.substring(0,i));var n=e.map(t.split(" "),function(e){return e.length>0?e[0].toUpperCase()+(e.length>1?e.substring(1,e.length):""):e});return n.join(" ")}}}),define("tau/components/board.new.list/views/sortingItem",["Underscore","tau/core/class"],function(e,t){return t.extend({NON_SORTED_CLASS:"tau-unit-non_sorted",ASC_SORTED_CLASS:"tau-unit-asc_sorted",DESC_SORTED_CLASS:"tau-unit-desc_sorted",HEADER_SELECTOR_PART:".tau-list-caption .tau-elems-table-level-",ASC:"asc",DESC:"desc",init:function(e,t){this.nodeCollection=t,this._$el=e,this._direction=this._$el.hasClass(this.ASC_SORTED_CLASS)?this.DESC:this._$el.hasClass(this.DESC_SORTED_CLASS)?null:this.ASC,this._inverseOrder=this._$el.data("inverseSortOrder"),this._field=this._$el.data("sort")},getOrdering:function(){return this._direction?{name:this._getField(),direction:this._direction}:null},_getField:function(){return this._inverseOrder?this._field+" "+(this._direction===this.ASC?this.DESC:this.ASC):this._field}})}),define("tau/services/customize/templateRegistrators/listTemplateRegistrator.functions",["jQuery","Underscore","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/utils/utils.base64hashEncoder","tau/utils/utils.customFields.list","tau/models/board.customize.units/const.sorting.applying","tau/components/board.new.list/views/sortingItem"],function(e,t,i,n,a,r,s){function o(e){return"tau-list-"+e+"-cell"}return{itemFunctions:function(e){return{isApplicable:function(t){return e.isApplicableByType(t.type)
},isEditable:function(t){return e.editorConfig?e.editorConfig.isEditable?e.editorConfig.isEditable(t):!0:!1},isEmptyUnit:function(e){return this.hideIf(e.data||{})},isNoValueUnit:function(e){return e.data&&e.data.empty},createCellClassName:function(e){var t=["tau-elems-cell"],i=this.isApplicable(e);return i||t.push("tau-elems-cell_unit-not-applicable"),e.first&&t.push("ui-resizable"),this.isNoValueUnit(e)?t.push("tau-elems-cell-no-value"):i&&this.isEditable(e)&&t.push("tau-elems-cell_unit-editable"),t.join(" ")},canDisplayNameControls:function(e){return e.first},canDisplayOpenDetailsButton:function(e){return!this.isNoValueUnit(e)&&i.isSupportedCardForView(e.type)},createUnitClassName:function(i){var n=[this.unitClass(i),o(i.unit?i.unit.id:e.id),"tau-board-unit_overflow",t.isFunction(e.classId)?e.classId(i.data):e.classId];return n.join(" ").replace(" tau-board-unit_format_max "," ")},LIST_UNIT_TITLE_PREFIX:'<div title="',LIST_UNIT_TITLE_SUFFIX:'"></div>',LIST_UNIT_TITLE_REGEX:/<[^<%>]+(<%[^%>]+%>[^<%>]*)*[^<%>]*>/g,getTitleTemplateName:function(){return"list.unit."+e.id+".title"},createTitleTemplateMarkup:function(){var i=t.complexKey(e,"listSettings.title")||(e.template.markup||e.template).join("").replace(this.LIST_UNIT_TITLE_REGEX,"");return t.flatten([this.LIST_UNIT_TITLE_PREFIX,"<% if (fn.isApplicable(this)) { %>",i,"<% } %>",this.LIST_UNIT_TITLE_SUFFIX])},createTitle:function(e){if(e.first)return"";var i=this.sub(this.getTitleTemplateName(),e).slice(this.LIST_UNIT_TITLE_PREFIX.length,-this.LIST_UNIT_TITLE_SUFFIX.length);return'title="'+t.escape(i).replace(/&amp;#10;/g,"&#10;")+'"'}}},headerFunctions:function(e){return{isResizable:function(e){return!!e.first},createCellClassName:function(e){var t=["tau-elems-cell",o(e.unit.id)];return e.first&&t.push("tau-name-cell"),this.isResizable(e)&&t.push("ui-resizable"),t.join(" ")},createListSettings:function(t){var i=[];return e.listSettings&&e.listSettings.minWidth&&i.push('data-min-width="'+e.listSettings.minWidth+'"'),e.listSettings&&e.listSettings.maxWidth&&i.push('data-max-width="'+e.listSettings.maxWidth+'"'),i.push('data-unit-id="'+t.unit.id+'"'),i.join(" ")
},getLevelTitle:function(e){return"priority"===e?"Business Values":this.term(e,"names")},getUnitHeader:function(t){return void 0!==e.header?this.replaceTermTags(e.header):"{{name}}"===e.name?a.getListHeader(t.unit.name):e.name},getUnitTitle:function(){return void 0!==e.title?this.replaceTermTags(e.title):void 0!==e.header&&e.header.toLowerCase()!==e.name.toLowerCase()?this.replaceTermTags(e.name):""},getSortedField:function(t){if("simple"!==e.category&&"one to one"!==e.category)return null;var i=this._tryGetSortFieldFromConfig(t);if("undefined"!=typeof i)return i;var n=this._tryGetSortFieldFromSettings(t);return"undefined"!=typeof n?n:null},sortableTemplateHeader:function(e){var t=this.getSortedField(e);if(t&&e.renderSortingHeaders){var i=s.prototype,n=i.NON_SORTED_CLASS,a=e.ordering?e.ordering.name.replace(" "+i.ASC,"").replace(" "+i.DESC,"").toLowerCase():null;return a&&a===t.field.toLowerCase()&&(n=e.ordering.direction.toLowerCase()===i.ASC?i.ASC_SORTED_CLASS:i.DESC_SORTED_CLASS),'<span class="i-role-card-sorting tau-unit-sorting '+n+'" data-sort="'+t.field+'" data-inverse-sort-order="'+t.inverseOrder+'"><span class="i-role-card-sorting-title tau-unit-sorting-title">'}return""},sortableTemplateFooter:function(e){var t=this.getSortedField(e);return t?"</span></span>":""},_tryGetSortFieldFromConfig:function(i){if(e.sortConfig&&e.sortConfig.allowed===r.NONE)return null;if(i.cardTypes.length>1){if(e.sortConfig&&e.sortConfig.allowed===r.SINGLE)return null;var n=t.flatMap(e.settings,function(e){return e.types}),a=t.map(i.cardTypes,function(e){return e.typeId});if(t.intersection(n,a).length!=a.length)return null}if(e.sortConfig&&e.sortConfig.field)return{field:e.sortConfig.field,inverseOrder:e.sortConfig.inverseOrder||!1};var s=t.any(e.settings,function(e){return e.sortConfig});return s?void 0:e.sampleData.name?{field:"name",inverseOrder:!1}:{field:t.keys(e.sampleData)[0],inverseOrder:!1}},_tryGetSortFieldFromSettings:function(i){if(1!==i.cardTypes.length)return null;var n=t.find(e.settings,function(e){var n=t.map(e.types,function(e){return e.toLowerCase()
});return t.contains(n,i.cardTypes[0].typeId.toLowerCase())});return n&&n.sortConfig&&n.sortConfig.field?{field:n.sortConfig.field,inverseOrder:n.sortConfig.inverseOrder||!1}:void 0}}}}}),define("tau/services/customize/templateRegistrators/listTemplateRegistrator",["jQuery","Underscore","tau/core/class","tau/models/board.customize.units/const.card.sizes","tau/core/templates-factory","tau/services/customize/templateRegistrators/templateRegistrator.functions","tau/services/customize/templateRegistrators/listTemplateRegistrator.functions"],function(e,t,i,n,a,r,s){return i.extend({registerItemTitleTemplate:function(e,t){a.register({name:t.getTitleTemplateName(),engine:"jqote2",customFunctions:t,markup:t.createTitleTemplateMarkup()})},createItemTemplate:function(e){var i=t.extend(s.itemFunctions(e),e.template.customFunctions);return this.registerItemTitleTemplate(e,i),{name:"list.unit."+e.id,engine:"jqote2",customFunctions:i,markup:t.flatten(['<div class="<%= fn.createCellClassName(this) %>">',"<% if (fn.isEmptyUnit(this)) { %>",'<div class="tau-elems-cell_unit-empty-text">click to edit</div>',"<% } %>",'<div class="<%! fn.createUnitClassName(this) %>" data-id="<%= this.unit.id %>" ',"<%= fn.createTitle(this) %> ",r.getAdditionalAttributes(e),">","<% if (fn.isApplicable(this)) { %>",r.createTerm(e),e.template.markup||e.template,"<% } %>","<% if (fn.canDisplayNameControls(this)) { %>",'<span class="tau-board-unit_name-controls">',"<% if (fn.canDisplayOpenDetailsButton(this)) { %>","<% if (this.renderDetailsTrigger) { %>",'<span title="Click for details" class="tau-board-list-view_details-view-trigger tau-icon tau-icon_name_newwindow i-role-details-trigger"></span>',"<% } %>","<% } %>",'<span class="tau-counter tau-counter-hidden"></span>',"</span>","<% } %>","</div>","</div>"])}},createHeaderTemplate:function(e){return{name:"list.header."+e.id,engine:"jqote2",customFunctions:t.extend(s.headerFunctions(e),e.template.customFunctions),markup:['<div class="<%= fn.createCellClassName(this) %>" <%= fn.createListSettings(this) %> title="<%= fn.getUnitTitle(this) %>">',"<%= fn.cond(fn.isResizable(this), '<div class=\"tau-list-caption-cell__overflow-helper\">') %>","<%= fn.sortableTemplateHeader(this) %>","<% if (this.first) { %>","<% this.cardTypes.forEach(function(item, index) { %>","<% if (index > 0) { %>",'<span class="tau-cap">, </span>',"<% } %>",'<span class="tau-cap tau-text_type_<%=item.typeId%>"><%! fn.getLevelTitle(item.typeId) || item.typeName %></span>',"<% }); %>","<% if (this.parentEntityType) { %>",'<span class="tau-cap"> for <%! fn.term(this.parentEntityType, "name") %></span>',"<% }; %>","<%= fn.sortableTemplateFooter(this) %>","<% } else { %>","<%! fn.getUnitHeader(this) %>","<% } %>","<%= fn.sortableTemplateFooter(this) %>","<%= fn.cond(fn.isResizable(this), '</div>') %>","<% if (this.first) { %>",'<span class="tau-list-quick-add-holder i-role-quick-add-holder"></span>',"<% } %>","</div>"]}
},registerUnit:function(e){var t=this.createItemTemplate(e),i=this.createHeaderTemplate(e);return a.register(t),a.register(i),{list:t.name,header:i.name}}})}),define("tau/models/board.customize.units/board.customize.units.fn",["Underscore","tau/utils/utils.date"],function(e,t){function i(t,i){return!e.isUndefined(i)&&t&&t.length>i?t.substr(0,i)+"&hellip;":t}function n(t,n){return["<a ",t?"":'href="'+e.escape(n.href)+'" ',!t&&n.title?'title="'+e.escape(n.title)+'" ':"",!t&&n.target?'target="'+n.target+'" ':"",'class="tau-board-unit-link tau-board-unit-not-selectable ',n.className||"",'" ',n.attributes||"",">",i(e.escape(n.text),n.maxTextLength),"</a>"].join("")}return function(a){return{_:e,dateUtils:t,trim:i,formatDate:function(i,n){return e.isString(i)&&(i=t.convertToTimezone(i)),i?t.formatAs(i,n):""},formatDayShort:function(i){return e.isString(i)&&(i=t.convertToTimezone(i)),i?i.getDate():""},precise_round:function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i},unitClass:function(t){var i=["tau-board-unit"];return e.each(t.settings&&t.settings.classes||[],function(e){i.push("tau-board-unit_"+e)}),a.sections&&i.push("tau-board-unit_format_max"),t.settings&&t.settings.metaData&&t.settings.metaData.alignment&&i.push("tau-board-unit_alignment_"+t.settings.metaData.alignment),i.join(" ")},unitData:function(t){var i=[],n=t.settings&&t.settings.metaData;return n&&(n.title&&i.push('title="'+e.escape(this.replaceTermTags(n.title))+'"'),n.id&&i.push('data-unit-id="'+e.escape(n&&n.id)+'"'),n.alignment&&i.push('data-alignment="'+e.escape(n&&n.alignment)+'"'),a.sections&&(i.push('data-sections="'+a.sections+'"'),1==a.sections&&i.push('data-is-stretchable="'+(a.isStretchable!==!1)+'"'))),i.join(" ")},generateEntityLink:function(t,i,a,r){r=r||{};var s=t.settings&&t.settings.isDesignMode,o=s?"":t.configurator.getUrlBuilder().getNewViewUrl(i.id,a,!0);return e.defaults(r,{text:i.id,title:i.name,href:o,className:"tau-board-unit__value tau-related-id",attributes:'data-entity-id="'+i.id+'" data-entity-type="'+a+'" '}),r.className="tau-id "+(r.className||""),n(s,r)
},buildLink:function(e,t,i){if(t.cf&&t.cf.value){var a=n(e.settings&&e.settings.isDesignMode,{text:t.cf.value.label,title:i?t.cf.value.label:"",href:t.cf.value.uri,target:"_blank"});return i?a:this.trim(t.cf.name,10)+": "+a}return""},getUserText:function(t){return e.escape(e.trim(t.fullName)||t.email)},getPeopleOrdered:function(t){var i=t.users||[t.user],n="responsible",a="others",r=e.groupBy(i,function(e){return this.isResponsible(t,e)?n:a},this);return e.concat([r[n],r[a]])},programProgress:function(e){return 0===e.totalStoriesCount?0:(e.totalStoriesCount-e.openStoriesCount)/e.totalStoriesCount},isResponsible:function(e,t){return!e.currentStateResponsiblePersons||e.currentStateResponsiblePersons.indexOf(t.id)>=0}}}}),define("tau/services/customize/service.customize.units.helper",["Underscore","tau/core/class","tau/models/board.customize.units/board.customize.units.fn","tau/models/board.customize.units/const.entity.types.names"],function(e,t,i,n){var a=function(){return""};return t.extend({init:function(e){this._templateRegistrators=e},_getKeyMap:function(t,i){return e.isObject(t)?(i=i?i+".":"",e.map(t,function(t,n){var a=this._getKeyMap(t,i+n);return e.isArray(a)?n+":{"+a.join(",")+"}":a},this)):i},getKeys:function(e){return this._getKeyMap(e).join(",")},processSettings:function(t,i){var n=t.model||this.getKeys(t.sampleData);t.settings?e.each(t.settings,function(e){e.model=e.model||n}):t.settings=[{types:t.types,sizes:t.sizes,model:n}],i&&e.each(t.settings,function(e){e.model=i(n)})},processIsApplicable:function(t){t.isApplicableByTypeAndSize=function(e,t){return null!=this.getModelByTypeAndSize(e,t)},t.isApplicableByType=function(t){var i=e.find(this.settings,function(i){return e.contains(i.types,t)||e.contains(i.types,n.ANY_TYPE)});return i?i.model:null},t.getModelByTypeAndSize=function(t,i){var a=e.find(this.settings,function(a){var r=e.contains(a.types,t)||e.contains(a.types,n.ANY_TYPE),s=!i||e.contains(a.sizes,i);return r&&s});return a?a.model:null}},processCustomFunctions:function(e){e.template.customFunctions=$.extend(e.template.customFunctions||{},i(e)),e.template.customFunctions.hideIf=e.hideIf||a
},processTemplates:function(t){var i=e.reduce(this._templateRegistrators,function(i,n){var a=n.registerUnit(t);return e.extend(i,a)},{});t.getTemplateName=function(e){return i[e]}}})}),define("tau/services/customize/service.customize.units.registry",["Underscore","tau/core/class","tau/models/board.customize.units/board.customize.units.simple","tau/models/board.customize.units/board.customize.units.oneToOne","tau/models/board.customize.units/board.customize.units.collections","tau/models/board.customize.units/board.customize.units.visualization","tau/services/customize/templateRegistrators/cardTemplateRegistrator","tau/services/customize/templateRegistrators/listTemplateRegistrator","tau/services/customize/service.customize.units.helper","tau/models/board.customize.units/const.entity.types.names"],function(e,t,i,n,a,r,s,o,l,u){return t.extend({init:function(t){this.unitsHelper=new l([new s,new o]),t=t||e.flatten([i,n,a,r]),t=this.mappingTypes(t),this.units=this.register(t)},_mappingAssignedUserOnUser:function(t){return e.contains(t,u.USER)?e.union(t,u.ASSIGNED_USER):t},mappingTypes:function(t){return e.each(t,function(t){e.each(t.settings,function(e){e.types=this._mappingAssignedUserOnUser(e.types)},this)},this),t},register:function(t){return e.object(e.map(t,e.bind(function(e){return this.unitsHelper.processCustomFunctions(e),this.unitsHelper.processTemplates(e),this.unitsHelper.processSettings(e),this.unitsHelper.processIsApplicable(e),[e.id,e]},this)))},getUnitById:function(e){return this.units[e]}})}),define("tau/models/board.customize.units/const.customField.types",["Underscore"],function(){return{TEXT:"text",DROP_DOWN:"dropdown",CHECK_BOX:"checkbox",URL:"url",DATE:"date",RICH_TEXT:"richtext",NUMBER:"number",ENTITY:"entity",MULTIPLE_LIST:"multipleselectionlist",TEMPLATED:"templatedurl",MULTIPLE_ENTITIES:"multipleentities"}}),define("tau/services/customize/service.customize.units.customField.sampleData",["tau/models/board.customize.units/const.customField.types"],function(e){var t={};
return t[e.TEXT]="{{name}}",t[e.DROP_DOWN]="{{name}}",t[e.CHECK_BOX]=1,t[e.URL]={url:"http://targetprocess.com/",label:"{{name}}"},t[e.DATE]="{{name}}",t[e.NUMBER]="{{name}}",t[e.ENTITY]={id:831209,name:"{{name}}",entityKind:"UserStory"},t[e.MULTIPLE_LIST]="{{name}}",t[e.TEMPLATED]={url:"http://example.com/?query={0}&test=test",value:"{{name}}"},t[e.MULTIPLE_ENTITIES]="{{name}}",t}),define("tau/models/board.customize.units/board.customize.units.customFields",["Underscore","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/const.customField.types","tau/services/customize/service.customize.units.customField.sampleData","tau/models/board.customize.units/board.customize.units.base"],function(e,t,i,n,a,r){var s=[i.XS,i.S,i.M,i.L,i.XL],o=s.concat(i.LIST),l={formatText:function(t,i,a){if(!t)return"";var r=t.value;if(i&&i.isDesignMode)a&&(r="Value for "+r);else if(t.type.toLowerCase()==n.DATE)return['<div class="tau-board-unit__value_type_day">',this.formatDayShort(r),"</div>",'<div class="tau-board-unit__value_type_month">',this.formatDate(r,"MMM"),"</div>",'<div class="tau-board-unit__value_type_year">',this.formatDate(r,"yyyy"),"</div>"].join("");return e.escape(r)},formatTextForTitle:function(t){if(!t)return"";var i=t.value;return t.type.toLowerCase()==n.DATE?[this.formatDayShort(i),this.formatDate(i,"MMM"),this.formatDate(i,"yyyy")].join(" "):e.escape(i)},type:function(e){var t=e.cf;return t&&t.value&&t.value.entityKind?t.value.entityKind.toLowerCase():"none"},getRelationsCount:function(e){return(e.cf.value||"").split(",").length}},u=function(e){var t=e.cf,i=t&&t.value&&t.value.entityKind&&t.value.entityKind.toLowerCase();return"tau-board-unit_type_"+i},c=function(e){return e&&e.cf&&e.cf.value?"tau-board-unit_type_custom-checkbox-checked":"tau-board-unit_type_custom-checkbox"},d=[{id:"custom_field__long__{{name}}",classId:"tau-board-unit_type_custom_field_long",customFieldTypes:[n.TEXT,n.DATE,n.NUMBER,n.MULTIPLE_LIST,n.DROP_DOWN],sizes:s,sections:1,template:{markup:['<div class="tau-board-unit__value">',"<%!fn.trim(this.data.cf.name,10)%>: ","<%=fn.formatText(this.data.cf, this.settings, true)%>","</div>"]}},{id:"custom_field__short__{{name}}",classId:"tau-board-unit_type_custom_field_short",sizes:s,customFieldTypes:[n.TEXT,n.DATE,n.NUMBER,n.DROP_DOWN],template:{markup:['<div class="tau-board-unit__value">',"<%=fn.formatText(this.data.cf, this.settings)%>","</div>"]}},{id:"custom_field__100__{{name}}",sections:1,classId:"tau-board-unit_type_custom_field_100",customFieldTypes:[n.TEXT,n.DATE,n.NUMBER,n.MULTIPLE_LIST,n.DROP_DOWN],listSettings:{title:"<%=fn.formatTextForTitle(this.data.cf)%>"},template:{markup:['<div class="tau-board-unit__value">',"<%=fn.formatText(this.data.cf, this.settings)%>","</div>"]}},{id:"custom_field__entity_id__{{name}}",classId:function(e){return"tau-board-unit_type_custom-related-entity tau-board-unit_type_id "+u(e)+"-id"
},customFieldTypes:[n.ENTITY],template:{markup:["<% if (this.data.cf && this.data.cf.value && this.data.cf.value.entityKind){ %>","<%= fn.generateEntityLink(this, this.data.cf.value, this.data.cf.value.entityKind) %>","<% } %>"]},listSettings:{title:'<%= this.data.cf && this.data.cf.value ? this.data.cf.value.name : ""%>'}},{id:"custom_field__url_short__{{name}}",classId:"tau-board-unit_type_custom-url",customFieldTypes:[n.URL],template:{markup:['<div class="tau-board-unit__value">',"<%=fn.buildLink(this, this.data, true)%>","</div>"]},listSettings:{title:'<%= this.data.cf && this.data.cf.value ? this.data.cf.value.label : ""%>'}},{id:"custom_field__url_line__{{name}}",classId:"tau-board-unit_type_custom-url",customFieldTypes:[n.URL],sections:1,sizes:s,template:{markup:['<div class="tau-board-unit__value">',"<%=fn.buildLink(this, this.data, false)%>","</div>"]}},{id:"custom_field__checkbox_short__{{name}}",classId:function(e){return"tau-board-unit_type_custom-checkbox-short "+c(e)},customFieldTypes:[n.CHECK_BOX],template:{markup:[""]},hideIf:function(e){return!e||!e.cf||!e.cf.name}},{id:"custom_field__checkbox__{{name}}",classId:c,sizes:s,customFieldTypes:[n.CHECK_BOX],template:{markup:['<div class="tau-board-unit__value"><%!fn.trim(this.data.cf.name,15)%></div>']},hideIf:function(e){return!e||!e.cf||!e.cf.name}},{id:"custom_field__checkbox_long__{{name}}",classId:c,customFieldTypes:[n.CHECK_BOX],sections:1,sizes:s,template:{markup:['<div class="tau-board-unit__value"><%! this.data.cf.name %></div>']},hideIf:function(e){return!e||!e.cf||!e.cf.name}}];r.pushClones(d,{classId:function(e){return"tau-board-unit_type_custom-related-entity "+u(e)},customFieldTypes:[n.ENTITY],template:{markup:['<div class="tau-board-unit__value">',"<% if (this.data.cf && this.data.cf.value) { %>","<%!this.data.cf.value.name%>","<% } %>","</div>"]}},[{id:"custom_field__entity_long__{{name}}",sections:1,sizes:s},{id:"custom_field__entity_name__{{name}}",sizes:o}]);var p=function(e){return null===e.cf.value||void 0===e.cf.value||""===e.cf.value
};return e.each(d,function(i){i=e.defaults(i,{category:"custom fields",priority:1,model:'cf:CustomValues.Get("{{name}}")',name:"{{name}}",types:[t.EPIC,t.FEATURE,t.STORY,t.TASK,t.BUG,t.REQUEST,t.TEST_CASE,t.IMPEDIMENT,t.ITERATION,t.TEAM_ITERATION,t.RELEASE,t.TEST_PLAN,t.TEST_PLAN_RUN,t.BUILD,t.PROJECT],sizes:o,hideIf:p}),i.template.customFunctions=l,i.sampleData||(i.sampleData={cf:{name:"{{name}}",type:i.customFieldTypes[0],value:a[i.customFieldTypes[0]]}}),i.hideIf=e.wrap(i.hideIf,function(e,t){return!t.cf||i.customFieldTypes.indexOf(t.cf.type.toLowerCase())<0||e(t)})}),d}),define("tau/services/customize/service.customize.units.customField.factory",["Underscore","tau/core/class","tau/utils/utils.base64hashEncoder","tau/models/board.customize.units/board.customize.units.customFields","tau/services/customize/templateRegistrators/cardTemplateRegistrator","tau/services/customize/templateRegistrators/listTemplateRegistrator","tau/services/customize/service.customize.units.customField.sampleData","tau/services/customize/service.customize.units.helper"],function(e,t,i,n,a,r,s,o){return t.extend({prefix:"custom_field__",init:function(e){this.unitIdRegex=new RegExp("^"+this.prefix+"(.+?)__(.+)$","i"),this.unitsHelper=new o([new a,new r]),this.units=this.register(n),this.configurator=e},register:function(t){return e.object(e.map(t,e.bind(function(e){return this.unitsHelper.processSettings(e),this.unitsHelper.processIsApplicable(e),this.unitsHelper.processCustomFunctions(e),this.unitsHelper.processTemplates(e),[e.id,e]},this)))},getUnitById:function(e){var t=this.unitIdRegex.exec(e);if(null===t)return null;var n=t[1],a=t[2],r=this.units[this.prefix+n+"__{{name}}"];return r?this.createUnit(r,i.decodeName(a)):this.units[e]},createUnit:function(t,n){var a=e.deepClone(t);return this.unitsHelper.processSettings(a,function(e){return e.replace("{{name}}",n)}),this.unitsHelper.processIsApplicable(a),a.name=n+" custom field",a.sampleData.cf.name=n,a.sampleData.cf.value=this._prepareSampleValue(a.sampleData.cf.value,n),a.id=a.id.replace("{{name}}",i.encodeName(n.toLowerCase())),a
},_prepareSampleValue:function(t,i){var n,a=function(t){return e.isString(t)?t.replace("{{name}}",i):t};return e.isString(t)?n=a(t):(n=e.deepClone(t),t.name?n.name=a(t.name):t.label?n.label=a(t.label):t.value&&(n.value=a(t.value))),n},_createUnitsFromCustomField:function(t){var i=t.name,n=t.type.toLowerCase();return e.chain(this.units).filter(function(t){return e.contains(t.customFieldTypes,n)}).map(e.bind(function(e){var a=this.createUnit(e,i);return a.sampleData.cf.value=this._prepareSampleValue(s[n],i),a.sampleData.cf.type=n,a.types=[t.entityKind.toLowerCase()],a.settings[0].types=a.types,a},this)).value()},_getCustomFields:function(){var t=this.configurator;return t.getAppStateStore().get({fields:["acid"]}).then(function(e){return t.getApplicationContextService().getApplicationContext({acid:e.acid})}).then(function(t){return e.chain(t.processes).pluck("customFields").flatten().value()})},getAllUnits:function(){return this._getCustomFields().then(e.bind(function(t){return e.chain(t).map(e.bind(this._createUnitsFromCustomField,this)).flatten().groupBy("id").map(this._groupCustomFields).value()},this))},_groupCustomFields:function(t){return e.foldl(t,function(t,i){return t?(t.types=e.unique(t.types.concat(i.types)),t.settings[0].types=t.types):t=i,t},null)}})}),define("tau/core/event2",["Underscore"],function(e){var t=function(t){return t.name?[t.data]:e.pluck(e.values(t),"data")},i=function(){};return i.implementOn=function(e){var t=i.prototype;for(var n in t)void 0==e[n]&&(e[n]=t[n]);return e},i.parseName=function(t){t=e.trim(t),t=t.replace(/\s*\+\s*/g,"+").replace(/\s*>\s*/g,">");var i=!!t.match(/[+>]/),n=(t.match(/\s(\d+)$/)||0,[t]),a=!1;if(i){if(t.indexOf("+")>0&&t.indexOf(">")>0)throw new Error("Only + or > is accepted");n=t.split(/\s+/g)[0].split(/[+>]/g),a=t.indexOf(">")>0}return n=e.map(n,function(e){var t=e.split(":");return{name:t[0],rule:t[1]}}),{name:t,isCombination:i,isOrdered:a,parts:n,priority:0}},i.signUp=function(t,n,a,r){var s=i.parseName(n),o=s.parts;
if(s.isCombination)for(var l=s.isOrdered,u=[],c=e.pluck(o,"name"),d=function(t){var i=e.indexOf(c,t.name);if(!(l&&e.compact(u).length<i)&&(u[i]||(u[i]=e.pick(o[i],"name","rule")),u[i].event=t,e.compact(u).length===o.length)){var n={};u=e.map(u,function(e){return n[e.name]=e.event,"last"===e.rule?e:void 0}),n=[n].concat(e.map(n,function(e){return e.data})),a.apply(r,n)}},p=0,f=o.length;f>p;p++)t._on(o[p].name,d,r,null,0);else t._on(o[0].name,a,r,null,s.priority)},i.subscribeOn=function(t){var n=e.functionsExt(t);e.each(t,function(a){if(a&&e.isFunction(a.on))for(var r=0,s=n.length;s>r;r++){var o=n[r],l=o.split(/\s/);i.signUp(a,l[1],t[o],t)}})},i.unSubscribe=function(t){e.each(t,function(i){i&&e.isFunction(i.removeAllListeners)&&i.removeAllListeners(t)})},i.prototype=function(){var n=function(e){var t=e.getPrivate&&e.getPrivate()||e._||(e._={});return t.events||(t.events={})},a=function(e){this.name=e,this.listeners=[]};a.prototype={},a.prototype.getListenerIndex=function(e,t){for(var i=0,n=this.listeners;i<n.length;i++)if(!(n[i].fn!=e||n[i].scopeObj!==t&&(n[i].scopeObj||1!=arguments.length&&t)))return i;return-1};var r={on:function(e,t,n){return i.signUp(this,e,t,n),this},_on:function(i,r,s,o,l){if(e.isArray(i)){var u=arguments.callee,c=this;return e.each(i,function(e){u.call(c,e,r,s,o,l)}),this}var d=n(this),p=d[i]||(d[i]=new a(i));if(p.getListenerIndex(r,s)<0){var f=p.listeners;s||(s=this),isNaN(l)&&(l=10);var m=this,h=function(e,n,a,l,u){var c={name:i,sender:this,caller:e,data:n,listenerData:o,stop:a,cancel:l,suspendMain:function(){u&&u.lock()},cancelMain:function(){u&&u.cancel()},resumeMain:function(){u&&u.unlock()},removeListener:function(){m.removeListener(i,r,s)}},d=[c].concat(t(c));return r.apply(s,d),c.data};h.fn=r,h.scopeObj=s,h.priority=l;for(var g=f.length-1;g>=0;g--)if(f[g].priority<=l)return f.splice(g+1,0,h),this;f.unshift(h)}return this},fire:function(){var e=!1,t=function(){e=!0},i=!1,a=function(){i=!0};return function(r,s,o,l){var u=n(this)[r],c=e,d=i;
if(e=i=!1,u){var p=u.listeners;if(p.length){p=p.slice(0);for(var f=0;f<p.length;f++){var m=p[f].call(this,o,s,t,a,l);if("undefined"!=typeof m&&(s=m),e||i)break}}}var h=i||("undefined"==typeof s?!1:s);return e=c,i=d,h}}(),fireOnce:function(e,t,i){var a=this.fire(e,t,i);return delete n(this)[e],a},removeListener:function(e,t,i){var a=n(this)[e];if(a){var r=a.getListenerIndex(t,i);r>=0&&a.listeners.splice(r,1)}},removeAllListeners:function(e){var t=n(this);for(var i in t)if(t[i].listeners)if(e){for(var a=t[i].listeners,r=[],s=0;s<a.length;s++)a[s].scopeObj!=e&&r.push(a[s]);t[i].listeners=r}else delete t[i].listeners,delete t[i]},hasListeners:function(e){var t=n(this)[e];return t&&t.listeners.length>0},getListeners:function(){var e=n(this),t=[];for(var i in e){var a=e[i].listeners;if(a&&a.length>0){for(var r=[],s=0;s<a.length;s++){var o=a[s],l={name:"unknown",item:o};o.scopeObj&&o.scopeObj.bus&&o.scopeObj.bus.name?l.name=o.scopeObj.bus.name:o.scopeObj&&o.scopeObj.name&&(l.name=o.scopeObj.name),r.push(l)}t.push({name:i,items:a,count:a.length,listeners:r})}}return t},getListenersCount:function(){var e=n(this),t=0;for(var i in e)e[i].listeners&&(t+=e[i].listeners.length);return t}};return r.addEventListener=r.on,r}(),i}),define("tau/services/service.help-scenario-runner",["jQuery","Underscore","tau/core/class","tau/core/event"],function(e,t,i,n){var a=i.extend({init:function(){this.data={}},get:function(e){return this.data[e]},set:function(e,t){this.data[e]=t}}),r=i.extend({init:function(e){var i=this;i.configurator=e.configurator,i.globalBus=e.configurator.getGlobalBus(),i.scenarioContext=new a,i.general_setup=e.methods.setup,i.general_teardown=e.methods.teardown,i._defaultsStep();var n=t.deepClone(e.scenario);i.scenario=t(n.sections).reduce(function(e,i,n){var a={id:n,name:i.name};return t(i.steps).each(function(e){e.section=a}),e.concat(i.steps)},[]),i.processStep=t.bind(i.processStep,i)},_defaultsStep:function(){var e=this;e.step=null,e.stepIndex=-1,e.stepTargetDefer=null,e.stepCompleteDefer=null
},next:function(){this.stepIndex++,this.step=this.scenario[this.stepIndex],this.step?(t.defaults(this.step,{teardown:e.noop,rollbackDepth:1,scenarioContext:this.scenarioContext,configurator:this.configurator}),this.stepTargetDefer=this.step.target(this.step),this.stepTargetDefer.done(this.processStep)):(this._defaultsStep(),this.fire("done"))},processStep:function(e){this.fire("next",this.step);var i=this.general_setup(e,this.step),n=t.bind(this.rollbackStep,this,i),a=t.bind(this.completeStep,this,i);this.stepCompleteDefer=this.step.complete(i).fail(n).done(a)},rollbackStep:function(e,t){this._teardownContext(e),t?(this._defaultsStep(),this.fire("abort")):(this.fire("rollback",this.step),this.stepIndex-=this.step.rollbackDepth,this.next())},completeStep:function(e){this._teardownContext(e),this.next()},_teardownContext:function(e){this.step.teardown(e),this.general_teardown(e)},start:function(){this.next()},abort:function(){this.stepTargetDefer&&this.stepTargetDefer.reject(),this.stepCompleteDefer&&this.stepCompleteDefer.reject(!0)}});return n.implementOn(r.prototype),r}),define("tau/services/help-scenarios/base",["jQuery","Underscore"],function(e,t){function i(n,a,r){a=a||e.Deferred();var s=t.isFunction(n)?n.call(null):e(n);return s.length&&e.contains(document.documentElement,s[0])&&(r||s.is(":visible"))?a.resolve(s):"pending"===a.state()&&t.delay(i,250,n,a,r),a}var n=function(e){var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e},a=function(e,t,i){e.descriptor=setTimeout(function(){t(),null!==e.descriptor&&a(e,t,i)},i)},r=function(e){clearTimeout(e.descriptor),e.descriptor=null},s=function(e){var t=e.offset();return t.w=e[0].clientWidth,t.h=e[0].clientHeight,t},o=e("<div></div>").appendTo("body"),l={descriptor:null},u=function(e,i,n){e.addClass("tau-help-attention");var r=['<div style="display: block;" class="i-role-help-drop-target tau-bubble tau-warning-bubble i-state_visible i-role-taububble-ignore">','   <div class="tau-bubble__inner" role="content"></div>',"</div>"].join(""),u={alignTo:e,content:"<p>"+i+"</p>",zIndex:10001,template:r,showOnCreation:!0,className:"tau-warning-bubble",showEvent:null,hideEvent:null,mode:"bubble",onPositionConfig:function(e){e.my="center top",e.at="center center"
},onShow:function(t){var i=s(e.closest(".i-role-grid")),n=s(e),a=t.height(),r=i.top+i.h-n.top;if(a>r)t.hide();else{var o=n.top+(r-a)/2;t.css("top",o)}},stackName:"help-flow-drop-target",dontCloseSelectors:["body"]};n&&(u=t.extend(u,n)),o.tauBubble(u);var c=function(){o.tauBubble("show")};a(l,c,500)},c=function(e){r(l),o.tauBubble("hide"),e.removeClass("tau-help-attention")},d=function(e){return".tau-teams-projects-manager-wrapper .tau-teams-projects-manager-holder "+e},p=function(e,t){e.scenarioContext.set("project-created",t)},f=function(e){return e.scenarioContext.get("project-created")},m=function(e){t.defer(e.resolve)},h=function(i){return function(){var n=e(".tau-teams-projects-manager-wrapper .i-role-section-projects .i-role-item"),a=n.filter(function(){return t.trim(e(this).text())===i});a.is(":visible")&&a.addClass("tau-active-item");var r=a.find(".i-role-selecttrigger");return 0===r.length?e():r.eq(0)}},g={liveSelect:i,complete:n,resolveCtx:m,markDropTarget:u,unMarkDropTarget:c,fieldInCtxAddProject:d,selectorOnVisibleBubble:function(e){return".i-role-bubble.i-state_visible "+e},hideTooltipOnCardDnD:function(t){var i=t.$node;i.on("mousedown",function(){i.addClass("i-role-help-disable-tooltip"),e("body").one("mouseup",function(){i.removeClass("i-role-help-disable-tooltip")})})},extractJustAddedEntityId:function(t){var i=e(t).data("id");return parseInt(i)},stepVideoIntro:function(t){var i,n;return{custom:!0,target:function(){return i=e.Deferred(),n=e.Deferred(),require(["tau/components/component.video-intro.popup"],function(e){e.create({url:t.url,showNextButton:!0,destroy:i,render:n})}),n},complete:function(){return i}}},stepContextPromptToSeeExistingProjectsAndTeams:function(){return{message:["<p>Open the Teams and Projects menu.</p>"].join(""),target:function(){return i(".tau-context-filter")},complete:function(t){return e(".tau-bubble-board.tau-teams-projects-manager-wrapper").is(":visible")?m(t):t.$node.one("click",t.resolve),t}}},stepContextExplainProjects:function(e){return e=e?" "+e+" ":" ",{message:["<p>Select which Project you want to see on the"+e+"board. This is your current project context. The project context can be a combination of teams-projects.</p>","<p>You can change it at any time. We will limit our context to just one project for now.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),rollbackDepth:2,target:function(){var e=".tau-teams-projects-manager-wrapper .i-role-section-projects";
return i(e)},complete:function(e){var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e}}},stepContextApplyExistingProject:function(t){return{message:["<p>Click to show the work from your chosen project context on the current board.</p>"].join(""),rollbackDepth:3,target:function(e){p(e,t);var n=h(t);return i(n)},complete:function(e){return e.$node.one("click",e.resolve),e},teardown:function(){var t=e(".tau-teams-projects-manager-wrapper .i-role-section-projects .i-role-item.tau-active-item");t.removeClass("tau-active-item")}}},stepContextPromptToAddNewProject:function(){return{message:"Click to add a new project.",rollbackDepth:2,target:function(){var e=".tau-teams-projects-manager-wrapper .i-role-section-projects .i-role-formtrigger:visible";return i(e)},complete:function(e){return e.$node.hasClass("tau-active")?m(e):e.$node.one("click",e.resolve),e}}},stepContextTypeProjectName:function(){return{message:"Enter project name.",rollbackDepth:3,target:function(){var e=d(".tau-new-entity-info .tau-new-entity-name");return i(e)},complete:function(e){var t=e.$node.val()||"";return t.length>0?m(e):e.$node.one("keypress",e.resolve),e}}},stepContextSelectProcess:function(e){return{message:"Select <strong>"+e+"</strong> process.",rollbackDepth:4,target:function(){var e=d(".tau-new-entity-process .tau-select");return i(e)},complete:function(t){var i=t.$node.find("option:selected").text();return i.toLowerCase()===e.toLowerCase()?m(t):t.$node.on("change",function(){var i=t.$node.find("option:selected").text();i.toLowerCase()===e.toLowerCase()&&t.resolve()}),t}}},stepContextInvitePeopleToProject:function(){return{message:["<p>Invite some people who will work on this project. Type their emails (optional).</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),rollbackDepth:5,target:function(){var e=d(".tau-invite-widget .tau-invite-field");return i(e)},complete:function(t){t.step.scenarioContext.set("isProjectAlreadyCreated",!1);
var i=d(".tau-teams-projects-manager .i-role-form");e(i).one("entity.add.completed",function(){t.step.scenarioContext.set("isProjectAlreadyCreated",!0),t.resolve()});var n=t.$node.find(".i-role-member").text();if(n.length>0)m(t);else{var a=t.$holder.tauBubble("getContent");a.on("click",".i-role-next",t.resolve)}return t}}},stepContextCreateProject:function(){return{message:"Click here to create a project.",rollbackDepth:6,target:function(t){var n=t.scenarioContext.get("isProjectAlreadyCreated"),a=e.Deferred();if(n)a.resolve(e("<div></div>"));else{var r=d(".tau-new-entity-form .tau-success");a=i(r)}return a},complete:function(t){var i=t.step.scenarioContext.get("isProjectAlreadyCreated");if(i)p(t.step,e(d(".tau-new-entity-info .tau-new-entity-name")).val()),m(t);else{var n=d(".tau-teams-projects-manager .i-role-form");e(n).one("entity.add.completed",function(){p(t.step,e(d(".tau-new-entity-info .tau-new-entity-name")).val()),t.resolve()})}return t}}},stepContextHighlightCreatedProject:function(){return{message:"The project you've created was added to the list of projects.",target:function(e){var n=".tau-teams-projects-manager-wrapper .i-role-section-projects .i-role-item.tau-added";return i(n).then(function(i){return p(e,t.trim(i.text())),i})},complete:function(e){return t.delay(e.resolve,3e3),e}}},stepContextApplyCreatedProject:function(){return{message:["<p>Click to apply the selected context to the current board.</p>",'<p class="tau-help-apply-project"></p>'].join(""),target:function(e){var t=f(e),n=h(t);return i(n)},complete:function(e){return e.$node.one("click",e.resolve),e},teardown:function(){var t=e(".tau-teams-projects-manager-wrapper .i-role-section-projects .i-role-item.tau-active-item");t.removeClass("tau-active-item")}}},stepContextCloseContextMenu:function(){return{message:"Click to close this menu.",offset:10,target:function(){return i(".tau-context-filter")},complete:function(t){var i=e(".tau-teams-projects-manager-wrapper").is(":visible");return i?t.$node.on("click",t.resolve):m(t),t
}}},stepOpenBoard:function(n){var a=n.boardName.toLowerCase(),r=-1===a.indexOf("board")?" board":"",s=n.message?n.message:"Open the "+n.boardName+r+".",o=function(){var t=this,i=t.boardName,n=e('.tau-app-secondary-pane .i-role-board-menu-item:contains("'+i+'") .i-role-item-name');return n.filter(function(){return e(this).text()===i}).eq(0)},l=function(){var t=this,i=t.boardName,n=e('.tau-app-secondary-pane .i-role-board-menu-item-active:contains("'+i+'") .i-role-item-name');return n.filter(function(){return e(this).text()===i}).eq(0)};return{message:s,boardName:n.boardName,target:function(n){var a=e.Deferred(),r=t.bind(o,n),s=r();return s.size()>0?a.resolve(s):n.configurator.getHelpScenarioService().createBoardFromTemplate(this.boardName).done(function(){t.delay(i,1500,r,a)}),a},complete:function(n){if(n.$node.hasClass("i-role-board-menu-item-active"))t.delay(n.resolve,2e3);else{var a=t.bind(l,n.step),r=e.Deferred();r.done(function(){t.delay(n.resolve,2e3)}),i(a,r)}return n}}},stepSelectYourProject:function(n,a){var r={message:"Select the project you've just created.",target:function(){return i(n)},complete:function(t){var i=f(t.step),n=t.$node.find("option:selected").text();return t.$node.is(":disabled")||n.toLowerCase()===i.toLowerCase()?m(t):(t.$node.find("option").each(function(){var t=e(this),n=t.text();n.toLowerCase()===i.toLowerCase()&&t.html("<b>"+n+"</b>")}),t.$node.on("change",function(){var e=t.$node.find("option:selected").text();e.toLowerCase()===i.toLowerCase()&&t.resolve()})),t}};return t.extend(r,a)},stepSelectToday:function(e,n){var a={message:"<p>Let's assume that it starts <b>today</b>. You can change the start date later.</p>",target:function(){return i(e)},complete:function(e){return e.$node.on("change",function(){var t=e.$node.val(),i=t.replace(/-/g," "),n=new Date(Date.parse(i));(new Date).toDateString()===n.toDateString()&&e.resolve()}),e}};return t.extend(a,n)},stepClickOrEscToClose:function(n){var a={message:"Click to close this screen.",direction:"none",targetSelector:".tau-cover-view_page .close:visible",target:function(){return i(this.targetSelector)
},complete:function(i){return window.scrollTo(0,0),i.$node.on("click",i.resolve),i.escHandler=t.bind(function(e){27===e.keyCode&&this.resolve()},i),e(document).on("keydown",i.escHandler),i},teardown:function(t){e(document).off("keydown",t.escHandler)}};return t.extend(a,n)},stepClickForQuickAdd:function(n){var s={quickAddRoleClass:"i-role-ch-quickadd-target",target:function(n){var r=this.quickAddRoleClass,s=e(this.todoCellSelector);e(".i-role-board-body").find("."+r).not(s).addClass(r+"-help-depressed").removeClass(r);var o=t.bind(function(){var t=e(this.todoCellSelector);t.find(" .tau-quick-add .tau-add").is(":visible")||t.mouseenter()},this),l={descriptor:null};a(l,o,250),n.scenarioContext.set("quick-add-inductor-process",l);var u=this.todoCellSelector+" .tau-quick-add .tau-add";return i(u)},complete:function(e){var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e.$node.off("click",e.resolve).one("click",e.resolve),e},teardown:function(t){var i=t.step.scenarioContext.get("quick-add-inductor-process");r(i);var n=this.quickAddRoleClass,a=n+"-help-depressed";e(".i-role-board-body").find("."+a).addClass(n).removeClass(a)}};return t.extend(s,n)},stepFinish:function(e){e=e||{};var n=e.processName?" "+e.processName+" ":" ",a={message:["<p>Thanks! You're done with the"+n+"tour now.</p>","<p>One important note before you move on:</p>","<p>As you create and remove boards from your screen, you simply change how you see one and the same data set.</p>","<p>You do not actually remove or delete anything, all your information is safe. So, don't be scared to experiment.</p>","<p>Try various mixes of vertical and horizontal lanes or use the predefined templates to get a clear view of what you want to focus on.</p>","<p>Play with the boards!</p>",'<p class="tau-help-continue"><button class="i-role-got-it tau-btn tau-primary">Got it, thanks</button></p>'].join(""),target:function(){return i(".tau-app-secondary-pane .i-role-add-board-button")},complete:function(e){var t=e.$holder.tauBubble("getContent");
return e.$node.click(e.resolve),t.on("click",".i-role-got-it",e.resolve),e}};return t.extend(a,e)},flowUserGuide:{name:"User Guide",steps:[{message:["<p>Read User Guide to learn more about concepts and User Interface.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">OK! I\'m done</button></p>'].join(""),direction:"none",target:function(){return e(".tau-flow-info-panel").tauBubble("hide"),e(".tau-flow-info").removeClass("tau-flow-started tau-flow-info"),e(".i-role-settings").tauBubble("show"),i(".i-role-user-guide")},complete:function(e){e.$node.one("click",e.resolve);var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e}}]}};return g.flowIntroVideo={name:"Watch video",steps:[g.stepVideoIntro({url:"//www.youtube.com/embed/Lxl2sTEyYaE"})]},g}),define("tau/services/help-scenarios/basic-intro",["jQuery","Underscore","tau/services/help-scenarios/base"],function(e,t,i){var n=i.liveSelect,a=[i.flowIntroVideo,{name:"Projects and Teams",steps:[{message:["<p>Here you can select projects and teams to see related work. New projects can be added here as well.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),offset:35,target:function(){return n(".tau-context-filter")},complete:i.complete}]},{name:"Quick Add",steps:[{message:["<p>Add new items: Releases, Sprints, User Stories, Bugs, etc.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),offset:30,target:function(){var e='.tau-app-secondary-pane .tau-quick-add[role="action-quick-add"]';return n(e)},complete:i.complete}]},{name:"Boards",steps:[{message:["<p>This area contains boards added by Admin or other people. Board is just a way to see and manipulate data.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),target:function(){var t=e('.tau-app-secondary-pane .tau-quick-add[role="action-quick-add"]');
t.data("ui-tauBubble")&&t.tauBubble("hide");var i=".i-role-board-menu";return n(i)},complete:i.complete}]},{name:"Create board",steps:[{message:["<p>You can create your own private boards to see relevant information.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),offset:20,target:function(){return n(".tau-app-secondary-pane .i-role-add-board-button")},complete:i.complete}]},i.flowUserGuide];return a}),define("tau/services/help-scenarios/kanban",["jQuery","Underscore","tau/services/help-scenarios/base"],function(e,t,i){var n=i.liveSelect,a=i.markDropTarget,r=i.unMarkDropTarget,s=i.selectorOnVisibleBubble,o=[i.flowIntroVideo,{name:"Select/add project(s) and/or team(s)",steps:[i.stepContextPromptToSeeExistingProjectsAndTeams(),i.stepContextExplainProjects("Kanban"),i.stepContextApplyExistingProject("Tau Product - Kanban #1")]},{name:"Kanban Board",steps:[i.stepOpenBoard({boardName:"Kanban Board",message:["<p>Now open the Kanban board. Kanban is a simple process. You don't have to plan iterations here.</p>","<p>Just visualize your dev flow and limit Work In Progress (WIP). You'll do this later.</p>"].join("")}),i.stepClickForQuickAdd({message:"<p>Click the green + to add a new user story to the project.</p>",isScrollTo:!1,todoCellSelector:".tau-grid tr:first-child .tau-cellholder:first-child"}),{message:'<p>Enter a user story name, e.g. "As a user I want to log in"</p>',direction:"left",rollbackDepth:2,target:function(){return n(".tau-quick-add-dialog input.Name")},complete:function(e){return e.$node.on("keypress",e.resolve),e}},i.stepSelectYourProject(".tau-quick-add-dialog select.project",{direction:"left",rollbackDepth:3}),{message:"<p>Click here to add this user story to the Kanban board.</p>",direction:"left",rollbackDepth:4,target:function(){return n(".tau-quick-add-dialog .tau-add-item")},complete:function(e){return e.$node.one("click",function(){n(s(".i-role-quick-add-success-message"),e,!0)}),e
}},{message:["<p>Here's your new story card.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),pin:!1,target:function(e){var t=i.extractJustAddedEntityId(s(".i-role-quick-add-success-message"));return e.scenarioContext.set("step_EntityId",t),n(".i-role-card[data-entity-id="+t+"]")},complete:i.complete},{message:"<p>We will customize the Kanban board now. Click here.</p>",direction:"none",target:function(){return n(".tau-actions-btn")},complete:function(e){return e.$node.on("click",e.resolve),e}},{message:"<p>And here.</p>",direction:"none",target:function(){return n(".actions-menu-items .tau-board-settings-toggle")},complete:function(e){return e.$node.on("click",e.resolve),e}},{message:["<p>You can limit your Work in Progress in this tab.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Got it, thanks</button></p>'].join(""),direction:"right",target:function(){return n('.i-role-tabheader[data-label="limits"]')},complete:i.complete},{message:["<p>Let's get back to the Board Setup now.</p>"].join(""),direction:"none",target:function(){return n('.i-role-tabheader[data-label="setup"]')},complete:function(e){return e.$node.hasClass("tau-active")?i.resolveCtx(e):e.$node.one("click",e.resolve),e}},{message:"<p>Select Person to see work assigned to all the people.</p>",target:function(){return n(".tau-select[name=y_types]")},complete:function(e){return"assigneduser"===e.$node.val()?i.resolveCtx(e):e.$node.on("change",function(){"assigneduser"===e.$node.val()&&e.resolve()}),e}},{message:['<p>We\'ve set "State" for the vertical lanes, and "Person" for the horizontal lanes, so you see the Person/State swimlanes now.</p>',"<p>This means who's working on what, and what's the progress. You can mix the lanes later as you wish.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Got it, thanks</button></p>'].join(""),target:function(){return n(".tau-x-header .tau-cell:eq(0)")
},complete:function(e){var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e}},{message:"<p>Click here to get back to the Kanban board.</p>",direction:"none",target:function(){return n(".tau-settings-close")},complete:function(e){return e.$node.on("click",e.resolve),e}},{message:["<p>Let's see how to assign stories to people in the Person/State swimlanes. This can be done with drag-n-drop.</p>",'<p class="tau-help-card-dnd-vertical"></p>'].join(""),target:function(t){var i=t.scenarioContext.get("step_EntityId"),r=".i-role-card[data-entity-id="+i+"]",s=e('.i-role-cellaxis-viewtrigger[data-entity-type="user"][data-entity-id="'+window.loggedUser.id+'"]'),o=s.data("id"),l=e('.i-role-header .i-role-cellholder.tau-collapsed .i-role-cell[data-y="'+o+'"] .i-role-collapser');l.click();var u='.i-role-grid .i-role-cellholder[data-y="'+o+'"]:eq(0)',c=e(u),d={onPositionConfig:function(e){e.my="center center",e.at="center center"},onShow:e.noop};return a(c,"Drop the card here to assign it to yourself.",d),t.scenarioContext.set("step_CurrentUserCellHolderSelector",u),n(r)},complete:function(e){i.hideTooltipOnCardDnD(e);var t=e.step.scenarioContext.get("step_EntityId"),a=e.step.scenarioContext.get("step_CurrentUserCellHolderSelector");return n(a+" .i-role-card[data-entity-id="+t+"]",e),e},teardown:function(t){var i=t.step.scenarioContext.get("step_CurrentUserCellHolderSelector"),n=e(i);r(n)}},{message:["<p>Double-click the story card for more details.</p>",'<p class="tau-help-card-dblclick"></p>'].join(""),target:function(e){var t=e.scenarioContext.get("step_EntityId");return n(".i-role-card[data-entity-id="+t+"]")},complete:function(e){return e.$node.on("dblclick",e.resolve),e}},i.stepClickOrEscToClose({message:"<p>Click to get back to the board.</p>"})]},{name:"My Work",steps:[i.stepOpenBoard({message:"<p>You can manage your work items from a personal board as well. Click here to open it.</p>",boardName:"Personal Kanban"}),{message:["<p>Drag-n-drop the card to In Progress to start work.</p>",'<p class="tau-help-card-dnd-horizontal"></p>'].join(""),target:function(t){var i=t.scenarioContext.get("step_EntityId"),r=".i-role-grid .i-role-card[data-entity-id="+i+"]",s='.i-role-header .i-role-cellholder:contains("In Progress")',o=e(s),l=o.data("x"),u='.i-role-grid .i-role-cellholder[data-x="'+l+'"]';
t.scenarioContext.set("inProgressCellHolderSelector",u);var c=e(u);return a(c,"Drop the card to this column"),n(r)},complete:function(e){i.hideTooltipOnCardDnD(e);var t=e.step.scenarioContext.get("step_EntityId"),a=e.step.scenarioContext.get("inProgressCellHolderSelector");return n(a+" .i-role-card[data-entity-id="+t+"]",e),e},teardown:function(t){var i=t.step.scenarioContext.get("inProgressCellHolderSelector"),n=e(i);r(n)}}]},i.flowUserGuide];return o}),define("tau/services/help-scenarios/scrum",["jQuery","Underscore","tau/services/help-scenarios/base"],function(e,t,i){var n=i.liveSelect,a=i.markDropTarget,r=i.unMarkDropTarget,s=i.selectorOnVisibleBubble,o=[i.flowIntroVideo,{name:"Select/add project(s) and/or team(s)",steps:[i.stepContextPromptToSeeExistingProjectsAndTeams(),i.stepContextExplainProjects(),i.stepContextApplyExistingProject("Tau Product Web Site - Scrum #1")]},{name:"Create a backlog/add stories to backlog",steps:[i.stepOpenBoard({boardName:"Story Mapping",message:"<p>Let's create a backlog. You can add Features and User Stories, and break Features into Stories here.</p>"}),i.stepClickForQuickAdd({message:"<p>Click to add a new user story.</p>",direction:"none",isScrollTo:!1,todoCellSelector:".tau-grid tr:first-child .tau-cellholder:first-child"}),{message:"<p>Enter a user story name.</p>",rollbackDepth:2,direction:"left",target:function(){return n(".tau-quick-add-dialog input.Name")},complete:function(e){return e.$node.on("keypress",e.resolve),e}},i.stepSelectYourProject(".tau-quick-add-dialog select.project",{rollbackDepth:3,direction:"left"}),{message:"<p>Click to add this user story to the Story Mapping board.</p>",rollbackDepth:4,direction:"left",target:function(){return n(".tau-quick-add-dialog .tau-add-item")},complete:function(e){return e.$node.one("click",function(){n(s(".i-role-quick-add-success-message"),e,!0)}),e}},{message:["<p>Here's your new user story.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),pin:!1,direction:"left",target:function(e){var t=i.extractJustAddedEntityId(s(".i-role-quick-add-success-message"));
return e.scenarioContext.set("step_EntityId",t),n(".i-role-card[data-entity-id="+t+"]")},complete:i.complete}]},{name:"Estimate work",steps:[i.stepOpenBoard({boardName:"Estimation",message:["<p>Let's estimate work before planning a release.</p>"].join("")}),{message:['<p>The "0" column has unestimated items, ',"the 1-2-3+ columns contain stories and bugs with the estimated effort of 1-2-3+ hrs.</p>","<p>(you can switch to pts later)</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),isScrollTo:!1,target:function(){return n(".i-role-header.tau-cols-header .i-role-name")},complete:function(e){var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e}},{message:['<p>Drag-n-drop this story to the "2" column to give it a 2 hr estimate.</p>','<p class="tau-help-card-dnd-horizontal"></p>'].join(""),target:function(t){var i=t.scenarioContext.get("step_EntityId"),r=".i-role-grid .i-role-card[data-entity-id="+i+"]",s=e('.i-role-header.tau-cols-header .i-role-cellholder .i-role-focustrigger:contains("2"):eq(0)').closest(".i-role-cellholder"),o=s.data("x"),l='.i-role-grid .i-role-cellholder[data-x="'+o+'"]',u=e(l);return a(u,"Drop card to this column"),t.scenarioContext.set("step_EffortCellHolderSelector",l),n(r)},complete:function(e){i.hideTooltipOnCardDnD(e);var t=e.step.scenarioContext.get("step_EntityId"),a=e.step.scenarioContext.get("step_EffortCellHolderSelector");return n(a+" .i-role-card[data-entity-id="+t+"]",e),e},teardown:function(t){var i=t.step.scenarioContext.get("step_EffortCellHolderSelector");r(e(i))}},{message:["<p>You can repeat this step to estimate all the work.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),targetCellSelector:".i-role-grid .i-role-cellholder:eq(0) .i-role-cell:eq(0)",target:function(){var e=this.targetCellSelector;return n(e)},complete:function(t){var n=this.targetCellSelector+" .i-role-card";
if(0===e(n).size())i.resolveCtx(t);else{var a=t.$holder.tauBubble("getContent");a.on("click",".i-role-next",t.resolve)}return t}}]},{name:"Add a release",steps:[{message:["<p>We're done with the estimation, and it's time to plan a release. Click +Add to add a new release first.</p>","<p>You can create several releases for one project.</p>"].join(""),offset:40,target:function(){var e='.tau-app-secondary-pane .tau-quick-add[role="action-quick-add"]';return n(e)},complete:function(e){return e.$node.click(e.resolve),e}},{message:"<p>Click here.</p>",rollbackDepth:2,target:function(){var e='.tau-quick-add-dialog-general .quick-add__entity-items .i-role-entity-selector[data-type="Release"]';return n(e)},complete:function(e){return e.$node.click(e.resolve),e}},{message:"<p>Give a name to your release, e.g. Ship Happens.</p>",rollbackDepth:3,target:function(){var e='.tau-quick-add-dialog-general .tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Release"] input[data-fieldname="Name"]';return n(e)},complete:function(e){return e.$node.on("keypress",e.resolve),e}},i.stepSelectYourProject('.tau-quick-add-dialog-general .tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Release"] [data-fieldname="project"]',{rollbackDepth:4}),i.stepSelectToday('.tau-quick-add-dialog-general .tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Release"] [data-fieldname="StartDate"]',{rollbackDepth:5}),{message:"<p>Pick your release end date.</p>",rollbackDepth:6,target:function(){var e='.tau-quick-add-dialog-general .tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Release"] [data-fieldname="EndDate"]';return n(e)},complete:function(e){return e.$node.one("change",e.resolve),e}},{message:"<p>Click Add to create a release.</p>",rollbackDepth:7,target:function(){var e='.tau-quick-add-dialog-general .tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Release"] .tau-add-item';return n(e)},complete:function(e){return e.$node.click(e.resolve),e
}},{message:"<p>Click here to hide the Quick Add screen. We will now proceed to the iteration planning.</p>",offset:30,target:function(){var e='.tau-app-secondary-pane .tau-quick-add[role="action-quick-add"]';return n(e)},complete:function(e){return e.$node.click(e.resolve),e}}]},{name:"Plan an Iteration",steps:[i.stepOpenBoard({boardName:"Iteration Plan",message:"<p>Let's open this board and break the release into iterations, as usually is done in Scrum planning.</p>"}),i.stepClickForQuickAdd({message:"<p>Click here to create a new iteration. You can create several iterations for one release.</p>",direction:"left",isScrollTo:!1,todoCellSelector:".i-role-board-body .i-role-header"}),{message:"<p>Give a name to your iteration, e.g. Iteration 0.</p>",rollbackDepth:2,direction:"left",target:function(){var e='.tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Iteration"] input[data-fieldname="Name"]';return n(e)},complete:function(e){return e.$node.on("keypress",e.resolve),e}},i.stepSelectYourProject('.tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Iteration"] [data-fieldname="project"]',{rollbackDepth:3,direction:"left"}),{message:"<p>Select the release you've just added.</p>",direction:"left",rollbackDepth:4,target:function(){var e='.tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Iteration"] .tau-field:eq(2)';return n(e)},complete:function(e){return e.$node.one("click",".tau-userStorySelector__control",e.resolve),e}},i.stepSelectToday('.tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Iteration"] [data-fieldname="StartDate"]',{rollbackDepth:5,direction:"left"}),{message:"<p>How long will your iteration be?</p>",rollbackDepth:6,direction:"left",target:function(){var e='.tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Iteration"] [data-fieldname="Duration"]';return n(e)},complete:function(e){return e.$node.on("keypress",e.resolve),e}},{message:"<p>Click Add. You can repeat these steps to create more iterations in the release.</p>",rollbackDepth:7,direction:"left",target:function(){var e='.tau-quick-add-dialog .tau-entity-controls .tau-control-set[data-type="Iteration"] .tau-add-item';
return n(e)},complete:function(t){var a=s(".i-role-quick-add-success-message"),r=e.Deferred();return r.done(function(){var e=i.extractJustAddedEntityId(a);t.step.scenarioContext.set("step_IterationEntityId",e),i.resolveCtx(t)}),n(a,r,!0),t}},{message:"<p>Click here to hide the Quick Add screen.</p>",rollbackDepth:0,direction:"left",isScrollTo:!1,todoCellSelector:".i-role-board-body .i-role-header",target:function(){var e=this.todoCellSelector+" .tau-quick-add .tau-add";return n(e)},complete:function(e){return e.$node.one("click",function(){t.delay(e.resolve,3e3)}),e}},{message:["<p>Click here to see your new iteration.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),direction:"none",isScrollTo:!1,target:function(i){var a=i.scenarioContext.get("step_IterationEntityId"),r='.i-role-cellaxis-viewtrigger[data-entity-id="'+a+'"]',s=e.Deferred();return s.done(t.bind(function(t){var i=this,n=e(t).data("id");i.scenarioContext.set("step_IterationSliceId",n)},i,r)),n(r,s),s},complete:function(e){var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e}},{message:["<p>Expand the column. We will soon drag-n-drop cards here to plan this iteration.</p>"].join(""),direction:"none",isScrollTo:!1,target:function(t){var i=t.scenarioContext.get("step_IterationEntityId"),n='.i-role-cellaxis-viewtrigger[data-entity-id="'+i+'"]',a=e(n).closest(".i-role-cell").find(".i-role-axis-mark-collapser"),r=e.Deferred();return r.resolve(a),r},complete:function(e){return e.$node.one("click",e.resolve),e}},{message:["<p>Select the story cards you want to assign to this iteration.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),direction:"right",isScrollTo:!1,targetCellSelector:".i-role-grid .i-role-cellholder .i-role-cell:eq(0)",target:function(){var e=this.targetCellSelector+" .i-role-card:eq(0) .i-role-name";return n(e)},complete:i.complete},{message:["<p>Drag-n-drop the selected cards to the iteration.</p>",'<p class="tau-help-card-dnd-horizontal"></p>'].join(""),direction:"none",isScrollTo:!1,targetCellSelector:".i-role-grid .i-role-cellholder .i-role-cell:eq(0)",target:function(i){var r=i.scenarioContext.get("step_IterationSliceId"),s='.i-role-grid .i-role-cellholder[data-x="'+r+'"]:eq(0)',o=e(s);
return a(o,"Drop the cards here"),n(t.bind(function(){var t=e(this.targetCellSelector+" .i-role-card.tau-selected:eq(0)");return t.length?t:e(this.targetCellSelector+" .i-role-card:eq(0)")},this))},complete:function(e){i.hideTooltipOnCardDnD(e);var t=e.step.scenarioContext.get("step_IterationSliceId"),a='.i-role-grid .i-role-cellholder[data-x="'+t+'"]:eq(0) .i-role-card';return n(a,e),e},teardown:function(t){var i=t.step.scenarioContext.get("step_IterationSliceId"),n=e('.i-role-grid .i-role-cellholder[data-x="'+i+'"]:eq(0)');r(n)}},{message:["<p>Take a look at the iteration burn down chart.</p>"].join(""),direction:"none",isScrollTo:!1,target:function(e){var t=e.scenarioContext.get("step_IterationSliceId"),i='.i-role-header .i-role-cellholder[data-x="'+t+'"] .tau-icon_name_burn-down';return n(i)},complete:function(e){return e.$node.one("click",e.resolve),e}},{message:["<p>You can use this chart later to check how close the real progress is to what you've planned.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),direction:"none",target:function(){return n(".ui-popup.ui-popup_active_true.tau-page-entity .i-role-tabheaders .i-role-tabheader.selected")},complete:function(e){window.scrollTo(0,0);var t=e.$holder.tauBubble("getContent");return t.on("click",".i-role-next",e.resolve),e}},i.stepClickOrEscToClose({message:"<p>Click to get back to the board.</p>",targetSelector:".ui-popup.ui-popup_active_true.tau-page-entity .close"})]},{name:"Break stories into tasks (optional)",steps:[i.stepOpenBoard({boardName:"Task Board",message:["<p>Sometimes you need to break User Stories into Tasks, e.g. for a more accurate planning.</p>","<p>Let's open the Task Board to see how this is done.</p>"].join("")}),i.stepClickForQuickAdd({message:"<p>Click to add a task to this user story. The task will appear in the ToDo (Open) state.</p>",direction:"right",offset:-15,isScrollTo:!1,todoCellSelector:".tau-grid tr:eq(1) .tau-cellholder:eq(0)"}),{message:"<p>Give a name to your task.</p>",rollbackDepth:2,direction:"left",target:function(){return n(".tau-quick-add-dialog input.Name")
},complete:function(e){return e.$node.one("keypress",e.resolve),e}},i.stepSelectYourProject(".tau-quick-add-dialog select.project",{rollbackDepth:3,direction:"left"}),{message:"<p>Click to add this task to your user story. You can repeat these steps to add more tasks.</p>",rollbackDepth:4,direction:"left",target:function(){return n(".tau-quick-add-dialog .tau-add-item")},complete:function(e){return e.$node.one("click",function(){n(s(".i-role-quick-add-success-message"),e,!0)}),e}},{message:["<p>Here's your new task.</p>",'<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Continue</button></p>'].join(""),pin:!1,target:function(e){var t=i.extractJustAddedEntityId(s(".i-role-quick-add-success-message"));e.scenarioContext.set("step_justAddedTaskId",t);var a='.tau-grid tr:eq(1) .tau-cellholder:eq(0) .i-role-card[data-entity-id="'+t+'"]';return n(a)},complete:function(e){var t=e.$holder.tauBubble("getContent");return t.one("click",".i-role-next",e.resolve),e}},{message:["<p>Double-click the task card for details.</p>",'<p class="tau-help-card-dblclick"></p>'].join(""),target:function(e){var t=e.scenarioContext.get("step_justAddedTaskId"),i='.tau-grid tr:eq(1) .tau-cellholder:eq(0) .i-role-card[data-entity-id="'+t+'"]';return n(i)},complete:function(e){return e.$node.one("dblclick",e.resolve),e}},{message:'<p>You can assign this task to yourself. Click "Assign to Me".</p>',direction:"left",target:function(){var e=".tau-page-entity .additional-info .assignments-table .add-btn:eq(0)";return n(e)},complete:function(e){window.scrollTo(0,0);var t='.tau-page-entity .additional-info .assignments-table .user-list [role="user"]';return n(t,e),e}},i.stepClickOrEscToClose({message:"<p>Click to get back to the board</p>"}),i.stepClickForQuickAdd({message:["<p>Click + to add more tasks (optional).</p>",'<p><button class="i-role-next tau-btn tau-primary">Got it, thanks</button></p>'].join(""),isScrollTo:!1,direction:"left",offset:-5,todoCellSelector:".tau-grid tr:eq(1) .tau-cellholder:eq(0)",complete:i.complete})]},i.flowUserGuide];
return o}),define("tau/services/help-scenarios",["jQuery","Underscore","tau/services/help-scenarios/basic-intro","tau/services/help-scenarios/kanban","tau/services/help-scenarios/scrum"],function(e,t,i,n,a){function r(t){t.$holder=e("<div></div>").appendTo("body");var i={alignTo:t.$node,content:"<span>"+t.message+"</span>",zIndex:10001,template:c,showOnCreation:!0,className:"tau-warning-bubble"+(t.step.pin===!1?"":" i-role-taububble-ignore"),showEvent:null,hideEvent:null,mode:"bubble",stackName:"help-flow",dontCloseSelectors:["body"]},n=t.step.hasOwnProperty("offset")?t.step.offset:-5;"left"===t.step.direction?i.onPositionConfig=function(e){return e.at="left center",e.my="right center",e.offset="0 "+n,e}:"none"!==t.step.direction&&(i.onPositionConfig=function(e){return e.at="right center",e.my="left center",e.offset="0 "+n,e}),t.$holder.tauBubble(i)}function s(e){if(e.step.attractor!==!1){var i=f(e),n=i.direction,a=i.position;if(a.top*a.left!==0){var r=t.bind(function(e,t){var i="r"===t,n=i?"right-15 center":"center center";e.$node.is(":visible")&&e.$attractor.position({my:"center",at:n,of:e.$node,collision:"none"})},this,e,n),s=e.$attractor.offset(),o=t.max([Math.abs(s.top-a.top),Math.abs(s.left-a.left)]);e.$attractor.animate(a,{complete:r,queue:!0,duration:o>300?1e3:600})}}}function o(e){if(e.step.attractor!==!1){var t=f(e),i=t.direction,n="r"===i,a=n?"right-15 center":"center center";e.$attractor.position({my:"center",at:a,of:e.$node,collision:"none"})}}function l(e){d=setTimeout(function(){e.$attractor.removeClass("tau-animated-attractor")},500)}function u(i){function n(){a&&(i.$node.hasClass("i-role-help-disable-tooltip")?i.$holder.tauBubble("hide"):i.$node.is(":visible")?(o(i),i.$holder.tauBubble("show")):(e.contains(document.documentElement,i.$node[0]),i.reject()),t.delay(n,500))}var a=!0;t.delay(n,500),i.stopMonitoring=function(){a=!1}}var c=['<div class="tau-bubble">','    <div class="tau-bubble__arrow" role="arrow"></div>','    <div class="tau-bubble__inner tau-container">','        <div role="content"></div>',"    </div>","</div>"].join(""),d=null,p=function(){clearTimeout(d);
var t=e(".i-role-attention-attractor");return 0===t.length&&(t=e('<div class="i-role-attention-attractor tau-help-attention-attractor"></div>'),t.appendTo("body")),t},f=function(e){e.$attractor=p(),e.$attractor.addClass("tau-animated-attractor");var t=e.$node.offset(),i=e.$node.width(),n=e.$node.height(),a=i>100?"r":"c",r="r"===a?i-15:i/2;return t.left+=10+r,t.top+=n/2,{position:t,direction:a}},m={},h={get:function(e){return m[e]},set:function(e,t){return m[e]=t}},g={setup:function(i,n){var a=t.extend(e.Deferred(),{$node:i,globalBus:this.globalBus,message:n.message,step:n,scenarioContext:h});return n.isScrollTo!==!1&&a.$node[0].scrollIntoView(!1),n.custom!==!0&&(r(a),u(a),s(a)),a},teardown:function(e){e.step.custom!==!0&&(e.stopMonitoring(),e.$holder.tauBubble("destroy").remove(),l(e))}},v=[{id:"",name:"Select Help Scenario",sections:[{name:"Select help flow above ",steps:[]}]},{id:"scratch",requiredProject:null,requiredProjectName:null,name:"Basic Intro",sections:i},{id:"scrum",requiredProject:13,requiredProjectName:"Tau Product Web Site - Scrum #1",name:"Scrum Getting Started",sections:a},{id:"kanban",requiredProject:2,requiredProjectName:"Tau Product - Kanban #1",name:"Kanban Getting Started",sections:n}];return{utils:g,scenarios:t.toObject(v,"id")}}),define("tau/services/service.help-scenarios",["jQuery","Underscore","tau/core/class","tau/core/event2","tau/services/service.help-scenario-runner","tau/services/help-scenarios"],function(e,t,i,n,a,r){var s=i.extend({_defaultsScenarios:function(){this.currentSectionId=-1,this.scenarios=t.deepClone(r.scenarios)},init:function(e){var t=this;t.configurator=e.configurator,t._state=0,t.currentFlowId=null,t._defaultsScenarios(),t.stateTypes={Stopped:0,ToBeStarted:1,InProgress:2,Aborted:3,Done:4}},createBoardFromTemplate:function(i){var n=e.Deferred(),a=this.configurator,r={$where:'publicData.name=="\\"'+i+'\\""',$fields:["key","publicData.name","publicData.definition"],$limit:{start:0,max:50}};return a.getRestStorage().select("boardTemplates",r).done(function(e,i){var a=i.data[0];
if(!a)return void n.reject();var r=this.configurator.getBoardDefinitionFactory(),s=r.createForLoggedUser();s.name=a.name,r.createBoard(s).done(function(e){var i=this.configurator.getBoardSettingsFactory().create(e),r=t.extend({isDraft:!1},e,a.definition);i.setDef({set:r}).done(n.resolve)}.bind(this))}.bind(this,n)),n.promise()},setState:function(e){this._state=e},getState:function(){return this._state},run:function(e){var i=this,n=i.getScenarioById(e);i.scenarioRunner=new a({configurator:i.configurator,scenario:n,methods:{setup:r.utils.setup,teardown:r.utils.teardown}}),i.scenarioRunner.on("next",t.bind(i.handleNextStep,i)),i.scenarioRunner.on("done",t.bind(i.handleDoneStep,i)),i.scenarioRunner.start(),i.setState(i.stateTypes.InProgress),i.fire("run.scenario",{scenarioId:e})},abort:function(){this.scenarioRunner&&this.scenarioRunner.abort(),this.setState(this.stateTypes.Aborted),this._defaultsScenarios(),this.fire("abort.scenario")},handleDoneStep:function(){this.markSection("done"),this.setState(this.stateTypes.Done),this.fire("done.scenario",{})},handleNextStep:function(e){var t=e.data,i=t.section.id;this.currentSectionId!=i&&(this.markSection("done"),this.currentSectionId=i,this.markSection("active"),this.fire("next.section",{})),this.fire("next.step",{})},markSection:function(e){var t=this.getScenarioById(this.currentFlowId).sections[this.currentSectionId];t&&(t.state=e)},getAvailableFlows:function(){return t.toObject(this.scenarios,"id")},setCurrentFlow:function(e){this.currentFlowId=e},getCurrentFlow:function(){return this.currentFlowId},getScenarios:function(){return t.map(this.scenarios,t.identity)},checkScenarioPrerequisites:function(e,i){var n=i.requiredProject,a=t.contains(e.selectedProjectIds||[],i.requiredProject),r=t.contains(t(e.selectedProjects||[]).pluck("name"),i.requiredProjectName);return!n||a&&r},getScenarioById:function(e){var i=this.scenarios[e]||{};return t.defaults(i,{sections:[]})},getSubFlows:function(e){var i=this.getScenarioById(e);return t(i.sections).map(function(e,t){return{id:t,name:e.name,state:e.state}
})}});return n.implementOn(s.prototype),s}),define("tau/components/board.changelog/templates/template.board.changelog",["Underscore","tau/core/templates-factory"],function(e,t){var i={engine:"jqote2",name:"template.board.changelog",markup:['<div class="tau-changelog" style="display: none;">','<div class="popup-header">','<div id="changeLogPopupHeader" class="popup-title">What\'s new in build <span class="tau-changelog-version">&hellip;</span></div>',"</div>",'<div class="tau-changelog-iframe-holder">','<iframe class="tau-changelog-iframe"></iframe>',"</div>",'<div class="paging">','<a href="#" class="button tau-changelog-prev disable">&hellip;</a>','<a href="#" class="button tau-changelog-next disable">&hellip;</a>','<a href="http://targetprocess.com/agileproductblog/" class="blog-link" target="_blank">Product blog</a>',"</div>","</div>"]};return t.register(i)}),define("tau/components/board.changelog/views/view.board.changelog",["Underscore","tau/core/class","tau/components/board.changelog/templates/template.board.changelog"],function(e,t,i){return t.extend({init:function(){this._isShown=!1,this.onPopupClosed=e.Callbacks(),this._$popup=i.render(),this._$popup.find(".tau-changelog-prev").click(this._move.bind(this,function(e){return e+1})),this._$popup.find(".tau-changelog-next").click(this._move.bind(this,function(e){return e-1})),this._$popup.tauPopup({className:"tau-changelog-popup",hideOnEscape:!0,popupContent:this._$popup,hide:this.hidePopup.bind(this)}),this._widget=this._$popup.tauPopup("widget"),this._widget.tauProgressIndicator()},showPopup:function(){this._isShown||(this._isShown=!0,this._widget.tauProgressIndicator("show"),this._$popup.tauPopup("show"))},hidePopup:function(){this._isShown&&(this._isShown=!1,this._$popup.tauPopup("widget").find(".tau-changelog").hide(),this._$popup.tauPopup("hide"),this._versions=null,this.onPopupClosed.fire())},setPopupData:function(e){if(0===e.length)throw new Error("It should be at least 1 version");this._versions=e,this._showVersion(0)
},_move:function(e){var t=e(this._$popup.tauPopup("widget").data("current"));if(0>t||t>=this._versions.length)throw new Error("Index is out of range");this._showVersion(t)},_processButton:function(e,t,i,n){t>=0&&t<this._versions.length?i.removeClass("disable").html(n(this._versions[t].version)):i.addClass("disable").html(this._versions[e].version)},_showVersion:function(e){this._widget.tauProgressIndicator("show"),this._processButton(e,e-1,this._widget.find(".tau-changelog-next"),function(e){return e+"&nbsp;&gt;"}),this._processButton(e,e+1,this._widget.find(".tau-changelog-prev"),function(e){return"&lt;&nbsp;"+e}),this._widget.find(".tau-changelog-version").text(this._versions[e].version),this._widget.find(".tau-changelog-iframe").hide().load(function(e){this._widget.find(".tau-changelog").show(),this._widget.tauProgressIndicator("hide"),$(e.target).show()}.bind(this)).attr({src:this._versions[e].url}),this._widget.find(".tau-changelog").show(),this._$popup.tauPopup("widget").data("current",e)}})}),define("tp/gateway",["jQuery"],function(e){function t(){}return t.prototype={postJSON:function(t,i,n,a,r){e.ajax({url:t,data:i?JSON.stringify(i):i,success:function(e,t,i){e=JSON.parse(e||'""'),n(e,t,i)},error:e.proxy(function(e){if(e&&e.getResponseHeader){var t=e.getResponseHeader("content-type");t&&(-1!=t.indexOf("application/json")?400==e.status&&a?a(e):500==e.status&&r&&r(e):r&&r(e))}},this),type:"POST",dataType:"text",contentType:"application/json"})},getJSON:function(t,i){return e.ajax({url:t,dataType:"json",contentType:"application/json",success:i})}},new t}),define("tau/components/board.changelog/models/model.board.changelog",["Underscore","jQuery","tau/core/class","tp/gateway","app.path"],function(e,t,i,n,a){return i.extend({retrieveData:function(){return n.getJSON(a.get()+"/changelogs")},setSeen:function(e){return n.postJSON(a.get()+"/changelogs",{version:e})}})}),define("tau/components/board.changelog/controllers/controller.board.changelog",["Underscore","tau/core/class","tau/components/board.changelog/views/view.board.changelog","tau/components/board.changelog/models/model.board.changelog"],function(e,t,i,n){return t.extend({init:function(t){this.onError=e.Callbacks(),this._model=t||new n,this._view=new i,this._view.onPopupClosed.add(this._updateSeenVersion.bind(this))
},checkNewVersion:function(){this._model.retrieveData().done(function(e){e.newVersion&&(this._newVersion=e.newVersion,this._view.showPopup(),this._view.setPopupData(e.versions))}.bind(this))},show:function(){this._view.showPopup(),this._model.retrieveData().done(function(e){this._newVersion=null,this._view.setPopupData(e.versions)}.bind(this)).fail(this._serverError.bind(this))},_serverError:function(){this._view.hidePopup();var e=["Targetprocess was updated. See ",'<a style="font-size:20px !important" target="_blank" href="http://www.targetprocess.com/agileproductblog/tag/changelog">what\'s new</a>'].join("");this.onError.fire({message:e,type:"information"})},_updateSeenVersion:function(){this._newVersion&&this._model.setSeen(this._newVersion)}})}),define("tau/store/services/service.auditHistory",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=i.extend({init:function(e){this.baseUrl=e+"/Services/AuditHistoryService.asmx/"},getActionUrl:function(e){return this.baseUrl+e},getChangeGroups:function(e,t){var i={generalId:e,keys:t};return this.sendRequest("GetChangeGroups",i)},getAuditRecordsLimited:function(e,t,i){var n={entityID:e,start:t,limit:i};return this.sendRequest("GetAuditRecordsLimited",n)},sendRequest:function(e,i){return t.ajax({url:this.getActionUrl(e),contentType:"application/json",type:"POST",data:JSON.stringify(i)})}});return n}),define("tau/libs/store2/store2",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=i.extend({init:function(e){this.loggedUser=e.getLoggedUser(),this.path=e.getApplicationPath()+"/api/v2/",this.service=t.ajax},escapeExpressionArgument:function(t){return encodeURIComponent(this._jsEscape(e.asString(t)))},getTeamsProjectsAvailable:e.memoize(function(t){var i="User?select={AvailableProjects() as projects, AvailableTeams() as teams, AvailableProcesses() as availableProcesses}&where=(id == "+t+")",n=this.path+i;return this.service({url:n}).then(function(t){var i={projects:[],teams:[]};return 1===t.items.length?e.defaults(t.items[0],i):i
})}),getApplicationContext:function(i){var n=function(t){if(t.acid)return"acid="+t.acid;t.ids=t.id||t.ids,t.ids||(t.projectIds=t.projectIds||t.projectId||"*",t.teamIds=t.teamIds||t.teamId||"*");var i=["fields","failureGlobal","id"];return e.chain(t).keys().filter(function(e){return i.indexOf(e)<0&&t[e]}).map(function(e){return e+"="+t[e]}).value().join("&")},a=n(i);return this.service({url:this.path+"Context?"+a,contentType:"application/json; charset=utf-8",dataType:"json"}).then(function(e){return{context:e,projects:e.availableProjects,teams:e.availableTeams,programs:e.availablePrograms}}).fail(function(e){e.response=t.parseJSON(e.responseText||null)})},findAll:function(e){return this.service({url:this.path+e}).then(function(e){return e.items})},_jsEscape:function(e){return e.replace(/(["'\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")}});return n.prototype.arg=n.prototype.escapeExpressionArgument,n}),define("tau/services/service.prototypeContextEntity",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(){this._currentPrototype={}},updateContextPrototype:function(t){var i=e.clone(this._currentPrototype);this._currentPrototype=t,this._extendProcess(this._currentPrototype,i.processes)},_extendProcess:function(t,i){var n=t.processes,a=e.pluck(n,"id"),r=e.pluck(i,"id"),s=e.difference(r,a);if(0!==s.length){var o=e.reduce(i,function(t,i){return e.contains(s,i.id)&&t.push(i),t},[]);this._currentPrototype.processes=n.concat(o)}},tryBuildContextFromContextPrototype:function(t,i){var n=this._currentPrototype;if(e.isEmpty(n)||void 0===t)return!1;var a=e.clone(n);a.projectIdsAvailable=[t||null],a.teamIdsAvailable=[i||null],a.selectedProjects=e.filter(a.selectedProjects,function(e){return e.id==t}),a.selectedTeams=e.filter(a.selectedTeams,function(e){return e.id==i});var r;if(t){var s=e.find(a.selectedProjects,function(e){return e.id==t}),o=s&&s.process&&s.process.id;r=function(e){return e.id==o
}}else r=function(e){return e.isDefault===!0};return a.processes=e.filter(n.processes,r),0===a.processes.length?!1:a}})}),define("tau/services/service.diagnostics",["Underscore","tau/core/class","tau/core/event"],function(e,t,i){var n=t.extend({storage:{},init:function(e){window.performance&&window.performance.timing&&(this.storage.page={server:window.performance.timing.responseEnd-window.performance.timing.navigationStart,client:window.performance.timing.loadEventEnd-window.performance.timing.responseEnd}),this._configurator=e.configurator,this._window=this._configurator.getWindow()},set:function(e,t){this.storage[e]=t,this.fire(e,t)},remove:function(e){delete this.storage[e]},get:function(e){return this.storage[e]},page:function(){return this.get("page")},networkLatency:function(){var t=e.range(10).map(function(){return this._networkLatencyCall()}.bind(this));return $.whenList(t).then(function(){var t=e.chain(arguments).filter(function(e){return"success"===e.status}),i=t.reduce(function(e,t){return e+t.latency},0).value()/t.value().length,n=t.map(function(e){return e.timestamp}).first().value();return{timestamp:n,latency:i}})},_networkLatencyCall:function(){var e;return $.ajax({url:this._getDiagnosticsUrl("ServerTime"),dataType:"json",contentType:"application/json",async:!1,beforeSend:function(){e=(new Date).getTime()}}).then(function(t,i){return{timestamp:"success"===i?new Date(t):"N/A",status:i,latency:(new Date).getTime()-e}})},networkSpeed:function(){var e;return $.ajax({url:this._getDiagnosticsUrl("SampleFile"),contentType:"image/png",async:!1,beforeSend:function(){e=(new Date).getTime()}}).then(function(){var t=(new Date).getTime()-e,i=this.complete&&"undefined"!=typeof this.naturalWidth&&0!==this.naturalWidth?"success":"failed";return{status:i,speed:t}})},jsBenchmark:function(){for(var e=1e7,t=0,i=1,n=(new Date).getTime(),a=0;e>=a;a++)t=t+4/i-4/(i+2),i+=4;return(new Date).getTime()-n},serverUsage:function(){return $.ajax({url:this._getDiagnosticsUrl("usage"),dataType:"json",contentType:"application/json"}).then(function(e){return e
})},memoryUsage:function(){if(this._window.performance&&this._window.performance.memory){var e=1048576;return{jsHeapSizeLimit:this._window.performance.memory.jsHeapSizeLimit/e,usedJSHeapSize:this._window.performance.memory.usedJSHeapSize/e,totalJSHeapSize:this._window.performance.memory.totalJSHeapSize/e}}return null},_detectBrowser:function(){var e=this._window.navigator.userAgent;return/Firefox[\/\s](\d+\.\d+)/.test(e)?"Firefox "+new Number(RegExp.$1):/MSIE (\d+\.\d+);/.test(e)||/Trident.*rv[ :]*(\d+)/.test(e)?"IE "+new Number(RegExp.$1):/Opera[\/\s](\d+\.\d+)/.test(e)||/OPR[\/\s](\d+\.\d+)/.test(e)?"Opera "+new Number(RegExp.$1):/Chrome[\/\s](\d+\.\d+)/.test(e)?"Chrome "+new Number(RegExp.$1):/Version\/(\d+).*Safari/.test(e)||/Safari[\/\s](\d+\.\d+)/.test(e)?"Safari "+new Number(RegExp.$1):e},browser:function(){var e=this.jsBenchmark(),t=this.page(),i=t?{processing:t.client,network:t.server}:null;return{language:this._window.navigator.language,platform:this._window.navigator.platform,userAgent:this._detectBrowser(),benchmark:e,timing:i,memory:this.memoryUsage()}},sendReport:function(e){return $.ajax({url:this._getDiagnosticsUrl("SendReport"),data:JSON.stringify(e),type:"POST",dataType:"json",contentType:"application/json"})},_getDiagnosticsUrl:function(e){return this._configurator.getApplicationPath()+"/diagnostics/v1/"+e}});return i.implementOn(n.prototype),n}),define("tau/services/service.sample.data.api",["Underscore","tau/core/class","tau/core/event"],function(e,t,i){var n=t.extend({storage:{},init:function(e){this._configurator=e.configurator},sampleData:function(){return $.ajax({url:this._getCallUrl("data"),dataType:"json",type:"GET"})},clearSampleData:function(e){return $.ajax({url:this._getCallUrl("clear"),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e)})},_getCallUrl:function(e){return this._configurator.getApplicationPath()+"/sampleData/v1/"+e}});return i.implementOn(n.prototype),n}),define("tau/service.container",["require","Underscore","libs/jquery/jquery","tau/core/class","tau/core/bus","tau/core/bus.reg","tau/core/global.bus","tau/store/factory","tau/services/keyboard.manager","tau/services/state.manager","tau/services/service.routing","tau/services/service.hash","tau/utils/utils.routing","tau/utils/utils.history","tau/utils/utils.urlBuilder.service","libs/parseUri","tau/nls/translator","tau/store/services/service.globalSettings","tau/services/service.applicationContext","tau/store/services/service.notifications","tau/store/services/service.actions","tau/storage/api","tau/libs/boardSettings/factory.board.settings","tau/services/boards/service.boards.operations","tau/services/boards/service.views.menu","tau/components/board.menu/services/board.menu.board.url.service","tau/services/boards/service.views.menu.comet.listener","tau/components/board.menu/services/board.menu.integration.service","tau/slice/slice.factory","tau/utils/utils.titleManager","tau/utils/utils.base64hashEncoder","tau/services/service.componentBuilder","tau/core/bus.collection","tau/libs/clipboard/clipboard.manager","tau/ui/ui.templateFactory","tau/utils/utils.redirect","tau/utils/utils.date/utils.date.wrapper","tau/utils/utils.date","tau/utils/utils.constants","tau/services/service.avatar","tau/services/service.features","tau/services/comet/comet.connection","tau/services/comet/service.comet","tau/services/service.tp2","tau/services/service.boardCacheData","tau/services/customize/service.customize.units.registry","tau/services/customize/service.customize.units.customField.factory","tau/services/service.help-scenarios","tau/services/service.board.access","tau/components/board.changelog/controllers/controller.board.changelog","tau/store/services/service.auditHistory","tau/libs/store2/store2","tau/services/service.prototypeContextEntity","tau/services/service.diagnostics","tau/services/service.sample.data.api"],function(e){var t=e("Underscore"),i=e("libs/jquery/jquery"),n=e("tau/core/class"),a=e("tau/core/bus"),r=e("tau/core/bus.reg"),s=e("tau/core/global.bus"),o=e("tau/store/factory"),l=e("tau/services/keyboard.manager"),u=e("tau/services/state.manager"),c=e("tau/services/service.routing"),d=e("tau/services/service.hash"),p=e("tau/utils/utils.routing"),f=e("tau/utils/utils.history"),m=e("tau/utils/utils.urlBuilder.service"),h=e("libs/parseUri"),g=e("tau/nls/translator"),v=e("tau/store/services/service.globalSettings"),b=e("tau/services/service.applicationContext"),y=e("tau/store/services/service.notifications"),_=e("tau/store/services/service.actions"),x=e("tau/storage/api"),w=e("tau/libs/boardSettings/factory.board.settings"),C=e("tau/services/boards/service.boards.operations"),S=e("tau/services/boards/service.views.menu"),T=e("tau/components/board.menu/services/board.menu.board.url.service"),k=e("tau/services/boards/service.views.menu.comet.listener"),I=e("tau/components/board.menu/services/board.menu.integration.service"),D=e("tau/slice/slice.factory"),P=e("tau/utils/utils.titleManager"),E=e("tau/utils/utils.base64hashEncoder"),R=e("tau/services/service.componentBuilder"),A=e("tau/core/bus.collection"),F=e("tau/libs/clipboard/clipboard.manager"),M=e("tau/ui/ui.templateFactory"),N=e("tau/utils/utils.redirect"),j=e("tau/utils/utils.date/utils.date.wrapper"),L=e("tau/utils/utils.date"),U=e("tau/utils/utils.constants"),B=e("tau/services/service.avatar"),O=e("tau/services/service.features"),$=e("tau/services/comet/comet.connection"),z=e("tau/services/comet/service.comet"),q=e("tau/services/service.tp2"),H=e("tau/services/service.boardCacheData"),V=e("tau/services/customize/service.customize.units.registry"),G=e("tau/services/customize/service.customize.units.customField.factory"),W=e("tau/services/service.help-scenarios"),Q=e("tau/services/service.board.access"),K=e("tau/components/board.changelog/controllers/controller.board.changelog"),Y=e("tau/store/services/service.auditHistory"),X=e("tau/libs/store2/store2"),J=e("tau/services/service.prototypeContextEntity"),Z=e("tau/services/service.diagnostics"),et=e("tau/services/service.sample.data.api"),tt=n.extend({_config:{},isBoardEdition:!1,init:function(){this.registeredServices={hashEncoder:E},this.registerService("urlBuilder",new m(this)),this.registerService("errorBar",new a)
},getUrlBuilder:function(){return this.service("urlBuilder")},setLoggedUser:function(e){this.loggedUser=e},getLoggedUser:function(){return this.loggedUser||this.getWindow().loggedUser},setSystemInfo:function(e){this.systemInfo=e},getSystemInfo:function(){var e=this.systemInfo||this.getWindow().tauSystemInfo;return t.clone(e)},setRequireLoader:function(e){this.require=e},getRequireLoader:function(){return this.require||window.require},getComponentBuilder:function(){return this.componentBuilder=this.componentBuilder||new R(this),this.componentBuilder},require:function(e,t){var i=this.require||window.require;i(e,t)},setRestStorage:function(e){this.restStorage=e},getRestStorage:function(){return this.restStorage||(this.restStorage=new x({service:this.getRestStorageService()})),this.restStorage},setRestStorageService:function(e){this.restStorageService=e},getRestStorageService:function(){return this.restStorageService||(this.restStorageService=i.ajax),this.restStorageService},setBoardSettingsOptions:function(e){this.boardSettingsOptions=e},getBoardSettingsOptions:function(){return this.boardSettingsOptions},getBoardSettingsFactory:function(){return this._boardSettingsFactory||(this._boardSettingsFactory=new w(this)),this._boardSettingsFactory},getViewsMenuCometListener:function(){return this._viewsMenuCometListener||(this._viewsMenuCometListener=new k(this.getComet(),this.getViewsMenuService(),this.getBoardOperationsService(),this.getFeaturesService())),this._viewsMenuCometListener},getBoardOperationsService:function(){return this._boardOperationsService||(this._boardOperationsService=new C(this.getGlobalBus(),this.service("errorBar"),this,this.getViewsMenuService(),this.getUrlBuilder(),this.getRouting(),this.getHistory())),this._boardOperationsService},getBoardApiService:function(){return this.getViewsMenuService().boardsApi},getViewsMenuService:function(){return this._viewsMenuService||(this._viewsMenuService=new S({service:this.getRestStorageService()},this.getViewsMenuUrlService())),this._viewsMenuService
},getInternalViewsMenuIntegrationService:function(){return this._viewsMenuIntegrationService||(this._viewsMenuIntegrationService=new I),this._viewsMenuIntegrationService},getViewsMenuActionsIntegrationService:function(){return this.getInternalViewsMenuIntegrationService().getActionsMenuExtender()},setViewsMenuService:function(e){this._viewsMenuService=e},getViewsMenuUrlService:function(){return this._viewsMenuUrlService||(this._viewsMenuUrlService=new T(this.getUrlBuilder(),this.getAppStateStore())),this._viewsMenuUrlService},getStoreFactory:function(){return this.storeFactory||(this.storeFactory=new o),this.storeFactory},setStoreFactory:function(e){this.storeFactory=e},setSliceFactoryOptions:function(e){this.sliceFactoryOptions=e||{}},mergeSliceFactoryOptions:function(e){this.sliceFactoryOptions=t.extend(this.sliceFactoryOptions||{},e)},getSliceFactoryOptions:function(){return t.defaults(this.sliceFactoryOptions||{},{base64:!0,options:{DnDTurnOffCometWhenItemsCountExceed:50},service:this.getSliceService()})},getSliceFactory:function(){if(!this.sliceFactory){var e=this.getSliceFactoryOptions();this.sliceFactory=new D(e)}return this.sliceFactory},setSliceService:function(e){this.sliceService=e},getSliceService:function(){return this.sliceService||(this.sliceService=i.ajax),this.sliceService},getKeyBoardManager:function(){if(!this.keyboardManager){this.keyboardManager=new l;var e={handleKeyDown:function(e){e.keyCode==i.ui.keyCode.ESCAPE&&(e.preventDefault(),e.stopPropagation())}};this.keyboardManager.pushHandler(e)}return this.keyboardManager},setGlobalSettingsService:function(e){this.globalSettingsService=e},getGlobalSettingsService:function(){if(!this.globalSettingsService){var e={appPath:this.getApplicationPath()};this.globalSettingsService=new v(e)}return this.globalSettingsService},setApplicationContextService:function(e){this.applicationContextService=e},getApplicationContextService:function(){return this.applicationContextService||(this.applicationContextService=new b(this),this.applicationContextService.isBoardEdition=this.isBoardEdition),this.applicationContextService
},setNotificationService:function(e){this.notificationService=e},getNotificationService:function(){if(!this.notificationService){var e={appPath:this.getApplicationPath()};this.notificationService=new y(e)}return this.notificationService},setActionsService:function(e){this.actionsService=e},getActionsService:function(){if(!this.actionsService){var e={appPath:this.getApplicationPath()};this.actionsService=new _(e)}return this.actionsService},clearSingles:function(){this.getStoreFactory().clearSingles()},clear:function(){this.clearSingles(),delete this.currentDate,delete this.external,delete this.window,delete this.routing,delete this.stateManager,this.getStoreFactory().clear(),this.getBoardSettingsFactory().clear(),this.getBusRegistry().clear()},getAppStateStore:function(){return this.acidStore=this.acidStore||this.getBoardSettingsFactory().createAcidSettings({id:"appConfig"}),this.acidStore},getAuditHistoryService:function(){return this.auditHistoryService=this.auditHistoryService||new Y(this.getApplicationPath()),this.auditHistoryService},getCurrentAcid:function(){var e="",t=this.getWindow();return t.location&&t.location.href&&(e=h(t.location.href).queryKey.acid||e),e},setWindow:function(e){this.window=e},getWindow:function(){return this.window||window},getHistory:function(){return this.history||(this.history=new f),this.history},createRouting:function(){var e={window:this.getWindow()};return new p(e)},getRouting:function(){return this.routing||(this.routing=this.createRouting()),this.routing},getTitleManager:function(){return this.titleManager||(this.titleManager=new P({window:this.getWindow()})),this.titleManager},getTranslator:function(){return g},setCurrentDate:function(e){this.currentDate=new j(e)},getCurrentDate:function(){return this.currentDate?this.currentDate:L.getServerNow()},getGlobalBus:function(){return s.get()},getBusRegistry:function(){return r},getComponentBusRegistry:function(){return this.componentBusRegistry||(this.componentBusRegistry=new A),this.componentBusRegistry
},setApplicationPath:function(e){this.getStoreFactory().setApplicationPath(e)},getApplicationPath:function(){return this.getStoreFactory().getApplicationPath()},getCkPath:function(){return this.ckPath||(this.ckPath=this.getApplicationPath()+"/Ckeditor"),this.ckPath},setCkPath:function(e){this.ckPath=e},setInitialData:function(e){this.getStoreFactory().setInitialData(e)},setService:function(e){this.getStoreFactory().setService(e)},getService:function(){return this.getStoreFactory().getService()},getRestPath:function(){return this.getStoreFactory().getRestPath()},setProxy:function(e){this.getStoreFactory().setProxy(e)},getProxy:function(){return this.getStoreFactory().getProxy()},disableRules:function(){this.getStoreFactory().disableRules()},enableRules:function(){this.getStoreFactory().enableRules()},initRules:function(){this.getStoreFactory().initRules()},getStore:function(e){return e=e||{},e.services=e.services||this,this.getStoreFactory().getStore(e)},getStore2:function(){return this.store2=new X(this),this.store2},setConfig:function(e,t){this._config[e]=t},getConfig:function(e,t){return this._config.hasOwnProperty(e)?this._config[e]:t},setHashEncoder:function(e){return this.registerService("hashEncoder",e)},getHashEncoder:function(){return this.service("hashEncoder")},getStateManager:function(){var e=this;if(!e.stateManager){var t=e.getExternal(),i=new c({external:t});e.stateManager=new u({service:i,state:t.hashParams()});var n=function(){var i=t.hashParams();e.stateManager?e.stateManager.update(i):t.unbindHashChange(n)};t.onHashChange(n)}return e.stateManager},getSettingsManager:function(){return this.settingsManager=this.settingsManager||this.getBoardSettingsFactory().createComponentSettings({id:"board"}),this.settingsManager},setClipboardManagerOptions:function(e){this.clipboardManagerOptions=e},getClipboardManagerOptions:function(){return t.defaults(this.clipboardManagerOptions||{},{id:"clipboard"})},getClipboardManager:function(){return this.clipboardManager||(this.clipboardManager=new F(this.getBoardSettingsFactory().createComponentSettings(this.getClipboardManagerOptions()))),this.clipboardManager
},setRedirect:function(e){this.redirect=e},getRedirect:function(){return this.redirect||(this.redirect=new N(this.getWindow(),this.getApplicationPath())),this.redirect},getTemplateFactory:function(){return M},getConstObject:function(){return U},getAvatarService:function(){return this.avatarService||(this.avatarService=new B(this.getApplicationPath())),this.avatarService},setAvatarService:function(e){this.avatarService=e},createChild:function(){var e=new tt;return e.getStoreFactory().setStore(this.getStore()),e.isBoardEdition=this.isBoardEdition,e.featuresService=this.getFeaturesService(),e.acidStore=this.getAppStateStore(),e.setPrototypeContextEntityService(this.getPrototypeContextEntityService()),e.applicationContextService=this.getApplicationContextService(),e.loggedUser=this.getLoggedUser(),e},getFeaturesService:function(e){return this.featuresService||(this.featuresService=new O(e)),this.featuresService},setFeaturesService:function(e){return this.featuresService=new O(e),this.featuresService},getCometConnection:function(){var e="comet-connection";return this.registeredServices.hasOwnProperty(e)||this.registerService(e,new $(this.getFeaturesService())),this.service(e)},getComet:function(){return this.cometApi||(this.cometApi=new z(this.getCometConnection()),this.cometApi.logging=this.getFeaturesService().isEnabled("comet.collect-server-statistics")),this.cometApi},registerService:function(e,t){this.registeredServices[e]=t},service:function(e){if(!this.registeredServices.hasOwnProperty(e))throw new Error("Service ["+e+"] is not registered");return this.registeredServices[e]},setHashService:function(e){this.registerService("hash",e)},getHashService:function(){return this.registeredServices.hasOwnProperty("hash")||this.registerService("hash",new d(this)),this.service("hash")},createExternal:function(e){var t=this.getHashService();return t.setWindow(e),t},setExternal:function(e){this.setHashService(this.createExternal(e))},getExternal:function(){return this.getHashService()
},setExternalService:function(e){return this.setHashService(e)},getTp2Service:function(){return this.registeredServices.hasOwnProperty("tp2")||this.registerService("tp2",new q(this)),this.service("tp2")},getBoardCacheService:function(){return this.registeredServices.hasOwnProperty("boardCacheData")||this.registerService("boardCacheData",new H(this)),this.service("boardCacheData")},getPrototypeContextEntityService:function(){return this.registeredServices.hasOwnProperty("prototypeContextEntity")||this.registerService("prototypeContextEntity",new J),this.service("prototypeContextEntity")},setPrototypeContextEntityService:function(e){return this.registerService("prototypeContextEntity",e),this.service("prototypeContextEntity")},getChangelogController:function(){if(!this.registeredServices.hasOwnProperty("changelog")){var e=new K,t=this.service("errorBar");e.onError.add(t.fire.bind(t,"error")),this.registerService("changelog",e)}return this.service("changelog")},getUnitsRegistry:function(){return this.unitsRegistry||(this.unitsRegistry=new V),this.unitsRegistry},setUnitsRegistry:function(e){return this.unitsRegistry=e,this.unitsRegistry},getHelpScenarioService:function(){return this.registeredServices.hasOwnProperty("flow-help")||this.registerService("flow-help",new W({configurator:this})),this.service("flow-help")},getCustomFieldsUnitsFactory:function(){return this.customFieldsUnitsRegistry||(this.customFieldsUnitsRegistry=new G(this)),this.customFieldsUnitsRegistry},getBoardAccessService:function(){return Q},getDiagnosticsService:function(){return this.diagnosticsService||(this.diagnosticsService=new Z({configurator:this})),this.diagnosticsService},getSampleDataService:function(){return this.sampleDataService||(this.sampleDataService=new et({configurator:this})),this.sampleDataService}});return tt}),define("tau/store/factory.instance",["tau/store/factory"],function(e){return new e}),define("tau/configurator",["Underscore","tau/service.container","tau/store/factory.instance"],function(e,t,i){var n=new t;
return n.setStoreFactory(i),n._id=e.uniqueId("global_"),n}),define("tau/core/component-base",["Underscore","tau/core/class","tau/core/bus","tau/configurator"],function(e,t,i,n){return t.extend({init:function(t){return this.config=e.extend({},t),this.config.context=this.config.context||{},e.defaults(this.config.context,{configurator:n}),this.bus=new i({name:this.config.name,globalBus:this.config.context.configurator.getGlobalBus(),"queue.bus":this.config["queue.bus"]||this.config.queuedBus}),e.defaults(this.config,{bus:this.bus}),this},attach:function(t,i){i=i||{};var n=[];e.isObject(t)&&e.has(t,"extType")&&e.has(t,"args")&&(n=t.args,t=t.extType);var a=this.config.disabledExtensionCategories;if(a){var r=t.prototype.category;if(r&&e.contains(a,r))return this}var s=e.clone(this.config);i.hasOwnProperty("onCreate")||(s=e.extend(s,i));var o=n.length?this.applyConstruct(t,[s].concat(n)):new t(s);return i.onCreate&&i.onCreate(o),this},extendWithArgs:function(e,t){return{ExtType:e,args:t}},applyConstruct:function(e,t){function i(){}var n,a;return i.prototype=e.prototype,n=new i,n.constructor=e,a=e.apply(n,t),null===a||"object"!=typeof a&&"function"!=typeof a||(n=a),n}})}),define("tau/core/extension.base",["Underscore","tau/core/class","tau/core/event"],function(e,t,i){return t.extend({resetLifecycle:!1,noop:function(){},init:function(e){this.bus=e.bus,i.subscribeOn(this)},"bus refresh":function(){this.lifeCycleCleanUp()},"bus destroy":function(){this.on=this.noop,this.fire=this.noop,this.destroy()},on:function(){this.bus.on.apply(this.bus,arguments)},fire:function(){return this.bus.fire.apply(this.bus,arguments)},lifeCycleCleanUp:function(){this.resetLifecycle&&this.resetSubscriptions()},resetSubscriptions:function(){i.unSubscribe(this),i.subscribeOn(this)},safeCallback:function(e){return function(){this._safeExecute(e,arguments)}.bind(this)},_safeExecute:function(e,t){e.apply(this,t)},destroy:function(){this._safeExecute=this.noop;var t=this.bus.getGlobalBus();t&&t.removeAllListeners(this),i.unSubscribe(this),e.each(this,function(e,t,i){0===t.indexOf("bus ")&&(i[t]=null)
}),this.bus={fire:this.noop,on:this.noop,getGlobalBus:this.noop,removeListener:this.noop}},_isComponentConfig:function(e){return e.hasOwnProperty("type")||e.hasOwnProperty("name")||e.hasOwnProperty("component")||e.hasOwnProperty("context")},_extractOptions:function(t,i){var n={};return e.isObject(t)&&(t.hasOwnProperty("options")?n=e.deepClone(t.options||{}):this._isComponentConfig(t)||(n=e.deepClone(t))),n=e.deepMerge(i,n)}})}),define("tau/core/view-base",["Underscore","jQuery","tau/core/extension.base","tau/ui/templateRenderer.extensions","tau/core/templates-factory","tau/ui/templateRenderer"],function(e,t,i,n,a){var r=i.extend({name:"view-base",init:function(e){this._super(e),this.config=e||{}},"bus initialize":function(e){this.startLifeCycle(e)},"bus refresh":function(e){this._super();var t=e.data||{},i=t.refreshSelector;this.startLifeCycle(e,i)},"bus show":function(){this.show()},"bus hide":function(){this.hide()},"bus applyTo":function(e){this.element=e.data.element},"bus afterInit+dataBind":function(e,t,i){this.render(i,t)},"bus render":function(e,t){this.fireBeforeRender({data:t.data}),this.doRender(t.data,!1,t.template),this.fireAfterRender({data:t.data})},destroy:function(){this._super(),this.element&&this.element.remove(),delete this.element,delete this.config},merge:function(i,n){if(n&&this.element){e.isArray(n)||(n=[n]);var a=n,r=this.element;e.forEach(a,function(e){var n=r.find(e),a=i.find(e);n.each(function(e){t(this).replaceWith(a.eq(e))})})}return this.element},bindTemplate:function(t,i){var n;if(e.isObject(i))n=a.process(i,this.config,t);else{var r;if(this.config.template.get&&this.config.template.render)r=this.config.template.get();else{var s=e.isString(i)?i:this.config.template.name;r=a.get(s)}n=r.bind(this.config,t)}return n},updateElement:function(e,t){return this.element&&t?this.merge(e,t):(this.element&&(e.length?this.element.replaceWith(e):this.element.remove()),this.element=e),this.element},doRender:function(e,t,i){var n=this.bindTemplate(e,i);
this.element=this.updateElement(n,t),this.toggleBase(this.element,this.config.visible)},fireAfterInit:function(e){this.fire("afterInit",{config:this.config,refreshSelector:e})},initialize:function(e){this.fireAfterInit(e)},setDefaultConfig:function(){e.defaults(this.config,{visible:!0})},"bus refreshData":function(e){this.doRender(e.data),this.fire("elementRefreshedWithData",{element:this.element,data:e.data,view:this})},startLifeCycle:function(t,i){this.setDefaultConfig(),e.extend(this.config,t.data),this.fire("beforeInit",{config:this.config}),this.initialize(i)},show:function(){this.element&&this.showElement(this.element),this.config.visible=!0},showElement:function(e){this.toggle(e,!0)},hide:function(){this.element&&this.hideElement(this.element),this.config.visible=!1},hideElement:function(e){this.toggle(e,!1)},toggleBase:function(e,t){this.config.visibilityClassName?e.toggleClass(this.config.visibilityClassName,t):t?e.removeAttr("hidden"):e.attr("hidden","hidden")},toggle:function(e,t){this.toggleBase(e,t)},render:function(e,t){this.fireBeforeRender({data:e}),this.doRender(e,t.refreshSelector),this.fireAfterRender({data:e})},fireBeforeRender:function(e){e=e||{},this.fire("beforeRender",{data:e.data,view:this,element:this.element})},fireAfterRender:function(e){e=e||{},this.fire("afterRender",{data:e.data,view:this,element:this.element})}});return r}),define("tau/core/extension.base.stateful",["Underscore","tau/core/extension.base"],function(e,t){var i=t.extend({init:function(e){if(this.config=e,e.context&&e.context.configurator){var t=e.context.configurator;this.config.store=t.getStore()}this.store=this.config.store,this._super(e)},"bus    beforeInit":function(t,i){i=i||{};var n=null;this.config.context&&(n=this.config.context.configurator),i.config&&(this.config=e.extend(this.config,i.config)),this.config.context&&(n=this.config.context.configurator||n,this.config.context.configurator=n),n&&(this.store=n.getStore(),this.config.store=this.store),this.onInit(this.config)
},onInit:function(){},destroy:function(){this._super(),this.config=null,this.store.unbind(this),this.store=null,e.each(this,function(t,i,n){"bus"===i||e.isFunction(t)||(n[i]=null)})}});return i}),define("tau/components/extensions/component.extension.base",["Underscore","tau/core/extension.base.stateful"],function(e,t){var i=t.extend({"bus afterRender":function(e){this.element=e.data.element},createComponents:function(e,t){var i={bus:this.bus,config:e,create:function(){this.bus.on("componentsCreated",this.onComponentCreated,this),this.bus.fire("createComponents",this.config,this)},onComponentCreated:function(e){e.caller===this&&(e.removeListener(),t(e.data))}};i.create()},isEntityInContext:function(e){var t=this.config.context.entity.id;return t==(e.data.entity||e.data.assignable).id}});return i}),define("tau/ui/extensions/ui.extension.domOperationsBase",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({name:"ui.extension.domOperationsBase","bus markElementToBeDeleted":function(e){var t=e.data,i=t.element;i.addClass("deleting")},"bus deleteElement":function(e){var t=e.data.element,i=e.data.callback;t.fadeOut(750,i)},"bus markElementToBeUpdated":function(e){var t=e.data,i=t.element;i.addClass("updating")},"bus cancelUpdateElement":function(e){var t=e.data.element;this._highlightElement(t,"#EE5757",1500)},"bus updateElement":function(e){var i=this,n=e.data.element;n.each(function(){var n=t(this);i._highlightElement(n,e.data.color||"#FFFFD3",e.data.duration||1500)})},_highlightElement:function(e,t,i){e.stop(!0,!0),e.removeClass("updating"),e.addClass("before-animate");var n=this._getElementBgColor(e),a=(e.css("backgroundColor"),function(){e.css("backgroundColor","")});e.removeClass("before-animate"),e.css({backgroundColor:t}).animate({backgroundColor:n},i,a)},_getElementBgColor:function(e){for(var t="transparent";e.length>0&&e.parent()&&("transparent"==(t=e.css("backgroundColor"))||void 0==t||"rgba(0, 0, 0, 0)"==t||0==t.length)&&(e=e.parent(),!e.is("body")););return("transparent"==t||0==t.length)&&(t="#ffffff"),t
}})}),define("tau/components/component.creator",["Underscore","tau/core/component-base","tau/core/view-base","tau/ui/extensions/ui.extension.domOperationsBase","tau/ui/ui.templateFactory"],function(e,t,i,n,a){return{create:function(r,s){var o=s||{};r=r||{},e.defaults(o,{name:r.name}),r.template&&(o.template=r.template),o.template&&o.template.markup&&(o.template=a.register(o.template));var l=new t(o);o=l.config;var u=o.context.configurator;e.defaults(o,{store:u.getStore()});var c=r.ViewType||i;if(l.attach(c),r.ModelType&&l.attach(r.ModelType),l.attach(n),r.extensions&&e.isArray(r.extensions))for(var d=0;d<r.extensions.length;d++){var p=r.extensions[d];if(!p)throw new Error("Extension ["+d+"] for component "+o.name+" is not defined");p.hasOwnProperty("type")&&p.hasOwnProperty("config")?l.attach(p.type,p.config):l.attach(p)}var f=l.bus;return u.getComponentBusRegistry().register(f),f.on("destroy",function(){u.getComponentBusRegistry().unregister(this)}),f}}}),define("tau/core/event-dispatcher",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e){this.components=e,this.eventArgsQueue={},this.dictionaryQueue={}},listen:function(t,i){var n=this;n.dictionaryQueue.hasOwnProperty(t)||(n.dictionaryQueue[t]=e(n.components).clone(),n.eventArgsQueue[t]=[]);var a=function(t){var a=t.sender;t.removeListener();var r=e(n.components).indexOf(a);if(n.eventArgsQueue[t.name][r]=t.data,n.dictionaryQueue[t.name]=e(n.dictionaryQueue[t.name]).without(a),e.isEmpty(n.dictionaryQueue[t.name])){var s={eventName:t.name,argsArr:n.eventArgsQueue[t.name]};i(s)}};e(n.components).each(function(e){e.on(t,a,null,{},1e3)})}});return i}),define("tau/ui/templates/container/ui.template.container.list",["tau/core/templates-factory"],function(e){var t={name:"container.list",markup:['<div class="tau-container ${cssClass}">',"</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/container/ui.template.container.table",["tau/core/templates-factory"],function(e){var t={name:"container.table",markup:['<table class="${cssClass} container-table">',"   <tr></tr>","</table>"],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/container/ui.template.container.replaceable",["tau/core/templates-factory"],function(e){var t={name:"container.replaceable",engine:"jqote2",markup:["<div>","</div>"]};return e.register(t)}),define("tau/views/view.container",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher","tau/ui/templates/container/ui.template.container.list","tau/ui/templates/container/ui.template.container.table","tau/ui/templates/container/ui.template.container.replaceable"],function(e,t,i,n){return i.extend({init:function(e){this._loaded=!1,this._super(e)},"bus initialize":function(e,t){this.startLifeCycle(e,t)},"bus refresh":function(e,t){this.startLifeCycle(e,t)},"bus componentCreated":function(e){var t=e.data.component;this.fire("childComponentCreated",t),this.children.push(t)},"bus afterRender + afterRenderLazy":function(e,t){this.fire("afterRenderAll",t)},"bus afterInit + internalChildrenRendered":function(t,i,n){var a=this._getRenderConfig();this.fireBeforeRender({data:a}),this.doRender(a),e.extend(n,{config:this.config}),this.fire("childrenRendered",n),this.config.visibility&&this.fire("visibility.on"),this.fireAfterRender({data:a})},"bus afterInit + internalChildrenRenderedLazy":function(t,i,n){e.extend(n,{config:this.config}),this.fire("childrenRenderedLazy",n),this.config.visibility&&this.fire("visibility.on")},"bus componentsCreated:last + sendEventToComponents":function(t,i,n){e.forEach(i,function(e){e.component.fire(n.name,n.data)})},"bus componentsCreated":function(t,i){this.fire("beforeComponentsInitialize",t.data);var n={};e.forEach(i,function(t,i){var a=t.config,r=t.component;e.has(a,"label")?n[a.label]=r:n[i]=r}),this.fire("childrenBuses.ready",n),this.initializeComponents(t),this.fire("afterComponentsInitialize",t.data)},"bus show":function(){this.show(),this._loaded||this.fire("initialize")},"bus hide":function(){this.hide()},"bus $children.rendered":function(e,t){this._fireVisibilityChanged(t,this.config.visible)
},completeInitializationWithoutChildren:function(){this.fire("afterInit",{}),this._fireChildrenRendered({children:[],childrenEvtArgs:[]})},completeInitializationWithoutChildrenLazy:function(){this._fireChildrenRenderedLazy({children:[],childrenEvtArgs:[]})},setDefaultConfig:function(){this._super(),e.defaults(this.config,{template:{name:"container."+(this.config.layout||"list")}})},_fireChildrenRendered:function(e){this.fire("internalChildrenRendered",e)},_fireChildrenRenderedLazy:function(e){this.fire("internalChildrenRenderedLazy",e)},initializeComponents:function(t){var i=e.pluck(t.data,"config"),n=this.separateChildComponents(this.children,i);this.listenContainerChildren(n.containerComponents),n.lazyComponents.components.length>0&&this.fire("existLazyChildren"),this.bus.on("internalChildrenRendered",e.bind(function(){this.initializeLazyComponents(n.lazyComponents)},this)),this.initializeFastComponents(n.fastComponents)},separateChildComponents:function(t,i){var n={components:[],configs:[]},a={components:[],configs:[]},r={components:[],configs:[]};return e.each(this.children,function(e,t){var s=i[t];s.lazy?(n.components.push(e),n.configs.push(s)):(a.components.push(e),a.configs.push(s));var o=this.config.visible!==!1&&s.visible!==!1,l="tabs"===s.type||s.children&&0!==s.children.length;l&&o&&(r.components.push(e),r.configs.push(e))},this),{lazyComponents:n,fastComponents:a,containerComponents:r}},initializeFastComponents:function(t){return 0===t.components.length?void this.completeInitializationWithoutChildren():(this.dispatcher=new n(t.components),this.dispatcher.listen("afterInit",e.bind(function(e){this.fire(e.eventName)},this)),this.dispatcher.listen("afterRender",e.bind(function(e){var i=e.argsArr,n={children:t.components,childrenEvtArgs:i};this._fireChildrenRendered(n)},this)),void e.forEach(t.components,e.bind(function(e,t,i){t.fire("initialize",e[i])},this,t.configs)))},initializeLazyComponents:function(t){return 0===t.components.length?void this.completeInitializationWithoutChildrenLazy():(this.dispatcherLazy=new n(t.components),this.dispatcherLazy.listen("afterRender",e.bind(function(e){var i=e.argsArr,n={children:t.components,childrenEvtArgs:i};
this._fireChildrenRenderedLazy(n)},this)),void this.config.store.freeze(!0).done(e.bind(function(t){this.fire("storeFreeze.ready",t);var i=["afterInit"];e.forEach(i,e.bind(function(i){this.dispatcherLazy.listen(i,e.bind(function(){t.unfreeze()},this))},this))},this)).done(e.bind(function(){e.forEach(t.components,function(e,i){e.fire("initialize",t.configs[i])})},this)))},"bus storeFreeze.ready + destroy":function(e,t){t.unfreeze()},"bus storeFreeze.ready + refresh":function(e,t){t.unfreeze()},listenContainerChildren:function(i){var a=t.Deferred(),r=t.Deferred(),s=t.Deferred(),o=t.Deferred(),l=t.Deferred();return l.done(e.bind(function(){this.fire(this.fire("afterRenderLazy"))},this)),this.bus.on("afterRender",e.bind(function(e,t){r.resolve(t)},this)),this.bus.on("internalChildrenRenderedLazy",e.bind(function(){s.resolve()},this)),this.dispatcherContainers=new n(i.components),this.dispatcherContainers.listen("afterRenderLazy",e.bind(function(){o.resolve()},this)),a.done(e.bind(function(i){this.fire("isLazy",i),this.config.lazy&&t.when(r,s).done(e.bind(function(){this.fire("afterRenderLazy")},this)),i&&!this.config.lazy?t.when(r,o,s).done(e.bind(function(){this.fire("afterRenderLazy")},this)):t.when(r,s).done(e.bind(function(){this.fire("afterRenderLazy")},this))},this)),this.config.lazy?void a.resolve(!0):0===i.components.length?void a.resolve(!1):void this.dispatcherContainers.listen("isLazy",e.bind(function(t){var i=!0;-1===e.indexOf(t.argsArr,!0)&&(i=!1),a.resolve(i)},this))},lifeCycleCleanUp:function(){this.destroyChildren()},startLifeCycle:function(t,i){this.setDefaultConfig(),e.extend(this.config,i||{}),this.fire("beforeInit",{config:this.config});var n=this.config.children;this.children=[];var a=e.isArray(n)&&e.size(n)>0&&this.config.visible;if(a){var r=this.config.children,s=this.config.context||{};this.fire("createComponents",{components:r,context:s})}else this.completeInitializationWithoutChildren(),this.completeInitializationWithoutChildrenLazy()},toggle:function(e,i,n){var a=this.config.useAnimation!==!1&&!t.fx.off&&n!==!1,r=t.contains(document.documentElement,e[0]);
a&&this._loaded&&r&&!e.parents(".tau-bubble:first").length?i?e.slideDown(200,this._fireVisibilityChanged.bind(this,e,i)):e.slideUp(200,this._fireVisibilityChanged.bind(this,e,i)):(this._super(e,i),this._fireVisibilityChanged(e,i))},_fireVisibilityChanged:function(t,i){var n=i?"show.completed":"hide.completed",a=i?"container.show.completed":"container.hide.completed";this.fire(n,t),e.each(this.children,function(e){e.fire(a,t)},this)},_getRenderConfig:function(){var e=this.config;return e.visible&&(this._loaded=!0),e},destroyChildren:function(){this.children&&this.children.length&&e.invoke(this.children,"destroy"),this.children=null},destroy:function(){this.dispatcher=null,this.dispatcherLazy=null,this.dispatcherContainers=null,this.destroyChildren(),this._super()}})}),define("tau/components/extensions/additionalInfo/extension.additionalInfo.editable",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit",editableIndexes:null,init:function(t){this._super(t),this.onRowClickProxy=e.proxy(this.onRowClick,this)},"bus beforeComponentsInitialize":function(e,t){this.editableIndexes=[],this.createComponentList(t),this.attachListeners()},"bus afterRender":function(e){this.$el=e.data.element,this.addEditableBehaviour()},"bus refresh":function(){this.clearComponent()},createComponentList:function(e){this.components=[];for(var t=1;t<e.length;t+=2)this.components.push(e[t].component)},addEditableBehaviour:function(){for(var e=0;e<this.editableIndexes.length;e++)this.doEditableRow(this.editableIndexes[e])},attachListeners:function(){var e=this.components;if(e)for(var t=0;t<e.length;t++)e[t].on("permissionsReady",this.onPermissionsReady,this,{index:t})},removeListeners:function(){var e=this.components;if(e)for(var t=0;t<e.length;t++)e[t].removeListener("permissionsReady",this.onPermissionsReady,this)},onRowClick:function(t){var i=e(t.target);i.is("a")||i.parent().is("a")||(t.stopPropagation(),t.data.component.fire("edit"))},doEditableRow:function(e){var t=this.$el.find(" > tbody > tr").eq(e);
t.off("click",this.onRowClickProxy),t.on("click",{component:this.components[e]},this.onRowClickProxy),t.addClass("ui-additionalinfo_editable_true")},onPermissionsReady:function(e){if(e.data.editable){var t=e.listenerData.index;this.$el?this.doEditableRow(t):this.editableIndexes.push(t)}},clearComponent:function(){this.removeListeners(),delete this.components,delete this.editableIndexes,delete this.$el},destroy:function(){this.clearComponent(),this._super()}})}),define("tau/components/extensions/additionalInfo/extension.additionalInfo.updateAnimation",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit",init:function(){this._super.apply(this,arguments)},"bus beforeComponentsInitialize":function(e){var t=this.createComponentList(e.data);this.fire("componentsList.ready",t)},"bus afterRender + componentsList.ready":function(e){var t=e.afterRender.data.element,i=e["componentsList.ready"].data;this.attachListeners(i,t)},createComponentList:function(e){for(var t=[],i=1;i<e.length;i+=2)t.push(e[i].component);return t},attachListeners:function(e,t){if(e)for(var i=0;i<e.length;i++){var n=e[i];n.on("beforeChangeProperty",this.createOnBeforeChangePropertyHandler({$el:t}),this,{index:i}),n.on("propertyChanged",this.createOnPropertyChangedHandler({$el:t}),this,{index:i,component:e[i]},1)}},createOnPropertyChangedHandler:function(e){var t=this;return function(i){var n=i.listenerData.index,a=i.listenerData.component;a.on("afterRender",function(i){i.removeListener();var a=e.$el.find(" > tbody > tr").eq(n).find(">td");t.fire("updateElement",{element:a})},a)}},createOnBeforeChangePropertyHandler:function(e){var t=this;return function(i){var n=i.listenerData.index,a=e.$el.find(" > tbody > tr").eq(n).find(">td");t.fire("markElementToBeUpdated",{element:a})}}})}),define("tau/components/extensions/component.creator.extension",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus createComponents":function(t){var i=t.data,n=t.caller;
e.isArray(i.components)||(i.components=[i.components]);var a=this.getDependencies(i.components);requireSync(a,this.createDependenciesLoadedCallback(i,n))},getDependencies:function(t){var i=[];return e.forEach(t,function(t){if(t.path)i.push(t.path);else{if(!t.type)throw new Error("Configuration error: type or path is missing");e.defaults(t,{namespace:"tau"});var n=t.namespace+"/components/component."+t.type;i.push(n)}}),i},_createComponent:function(e){return e.name||(e.name="",e.type&&(e.name=e.type),e.id&&(e.name+=":"+e.id)),e.component.create(e)},childrenLoadedCallback:function(t,i){var n=[];e.forEach(t,function(e){var t=this._createComponent(e);this.fire("componentCreated",{component:t}),n.push({config:e,component:t})},this),this.fire("componentsCreated",n,i)},createDependenciesLoadedCallback:function(t,i){var n=this,a=t.components,r=t.context;return function(){var t=arguments;e.forEach(a,function(e,i){e.component=t[i],e.context=r}),n.childrenLoadedCallback(a,i)}}})}),define("tau/ui/extensions/layout/ui.extension.layout",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender + existLazyChildren":function(t,i){var n=e.defaults(this.config.spinnerConfigForLazy||{},{delay:500,isShow:!1,height:10,selectorForHeight:null});n.isShow&&this.setSpinnerForLazyContainer(i.element,n)},setSpinnerForLazyContainer:function(e,i){function n(){clearTimeout(r),a.reject()}e.tauProgressIndicator();var a=t.Deferred();a.done(function(e){e.data("ui-tauProgressIndicator")&&e.tauProgressIndicator("hide")});var r=setTimeout(function(){if("pending"===a.state()&&e.data("ui-tauProgressIndicator")){var t=i.selectorForHeight&&e.closest(i.selectorForHeight).height()||i.height;e.css({height:t}),e.tauProgressIndicator("show")}},i.delay);this.bus.on("refresh",n),this.bus.on("destroy",n),this.bus.on("childrenRenderedLazy",function(){e.css({height:""}),a.resolve(e)})},appendChildren:function(t,i,n){var a=this;a.element=i.element;var r=t.childrenEvtArgs;
a.config.layout=a.config.layout||"list";var s=a.config,o=["_add",s.layout,"item"].join(" ");s.childrenContainerSelector=s.childrenContainerSelector||("list"===s.layout?null:"> tbody > tr"),e.each(r,function(e){var t=e.element,i={element:t,data:e};a.fire("append.child.element",i),a[o](i.element,e.view?e.view.config:{})}),a.element&&(i.element=a.element),!n&&this.fire("$children.rendered",this.element)},"bus childrenRendered + afterRender":function(e,t,i){this.appendChildren(t,i,!1)},"bus childrenRenderedLazy + afterRender":function(e,t,i){this.appendChildren(t,i,!0)},"_add list item":function(e){var t=e.jquery?e:e.element,i=this.config.childrenContainerSelector?this.element.find(this.config.childrenContainerSelector):this.element;i.append(t)},getTableItemContainer:function(){var e=this,i=e.config,n=e.element.find(i.childrenContainerSelector+":last");if(i.hasOwnProperty("columnCount")){var a=n.children("td").size();a>=i.columnCount&&(n=t("<tr></tr>"),e.element.children("tbody").append(n))}return n},"_add table item":function(e){var i=this,n=e.jquery?e:e.element,a=i.config,r=this.getTableItemContainer(),s=r.children("td").length,o=a.cellsCssClass&&a.cellsCssClass[s]||"";t("<td></td>").addClass(o).append(n).appendTo(r)},"_add selectable item":function(e,t){var i=this.element,n=t.selector||"[role=main]",a=i.filter(n);0==a.length&&(a=i.find(n)),0==a.length?(console.log(i),console.error('No element for selector "'+n+'"')):a.eq(0).append(e)},"_add replaceable item":function(e){var t=e.jquery?e:e.element,i=this.element;i.parent().length?i.replaceWith(t):this.element=t}})}),define("tau/ui/extensions/spinner/ui.extension.spinner",["tau/components/extensions/component.extension.base"],function(e){return e.extend({options:{spinnerClass:"ui-spinner"},"bus beforeInit":function(){var e=this;this.config.spinner!==!1&&e.element&&e.element.addClass(e.options.spinnerClass)},"bus afterRender":function(e){var t=this;t.element=e.data.element,this.config.spinner!==!1&&t.element.removeClass(t.options.spinnerClass)
}})}),define("tau/components/component.additionalInfo",["Underscore","tau/components/component.creator","tau/views/view.container","tau/components/extensions/additionalInfo/extension.additionalInfo.editable","tau/components/extensions/additionalInfo/extension.additionalInfo.updateAnimation","tau/components/extensions/component.creator.extension","tau/ui/templates/container/ui.template.container.table","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/spinner/ui.extension.spinner"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){u=u||{};var c=[];e.forEach(u.children,function(e){e.label&&e.field?(e.label.disabledExtensionCategories=u.disabledExtensionCategories,c.push(e.label),e.field.disabledExtensionCategories=u.disabledExtensionCategories,c.push(e.field)):(e.disabledExtensionCategories=u.disabledExtensionCategories,c.push(e))}),u.children=c,e.defaults(u,{template:s,cssClass:"additional-info-table",columnCount:2,cellsCssClass:["ui-additionalinfo__label","ui-additionalinfo__value"],layout:"table"});var d={extensions:[r,o,a,l,n],ViewType:i};return t.create(d,u)}}}),define("tau/models/dataprocessor/model.processor.context",["Underscore","tau/store/types"],function(e,t){function i(i){return e.isUndefined(i)||e.isNull(i)?null:(i.checkPractice=b,i.isPracticeAvailable=b,i.getTimeTrackingPolicies=a,i.getEffortPoint=r,i.getTerms=s,i.getCustomFields=o,i.getPractices=l,i.getEdition=d,i.hasEdition=p,i.getTeam=c,i.getTeamId=v,i.getProject=u,i.getProjectId=g,i.getProcess=f,i.getLoggedUser=m,i.getProcessId=h,i.hoursOnlyEntityTypes=e.chain(t.getDictionary()).filter(e.matches({effortInHours:!0})).map(function(e){return e.name.toLowerCase()}).union().value(),i)}var n=function(e,t){for(var i=null,n=e.processes[0].practices,a=0;a<n.length;a++)n[a].name.toLowerCase()===t.toLowerCase()&&(i=n[a]);return i},a=function(){var e=n(this.applicationContext,"Time Tracking"),t=!e;return{disableSpentRemain:t}},r=function(t){var i=n(this.applicationContext,"Planning")||{},t=t?t:this.entity.entityType.name.toLowerCase(),a=e.contains(this.hoursOnlyEntityTypes,t)?"Hour":i.effortPoints;
if(a){var r="point"===a.toLowerCase()?"pt":"h";return{name:a,shortName:r}}return{}},s=function(){var t=this.applicationContext;if(t&&t.processes&&t.processes.length>0){var i=e.find(t.processes,function(e){return e.isDefault});return(i||e.sortBy(t.processes,function(e){return e.name})[0]).terms}return[]},o=function(){var e=this.applicationContext;return e&&e.processes&&e.processes.length>0?e.processes[0].customFields:[]},l=function(){var e=this.applicationContext;return e&&e.processes&&e.processes.length>0?e.processes[0].practices:[]},u=function(){var e=this.applicationContext;return e&&e.selectedProjects&&e.selectedProjects.length>0?e.selectedProjects[0]:null},c=function(){var e=this.applicationContext;return e&&e.selectedTeams&&e.selectedTeams.length>0?e.selectedTeams[0]:null},d=function(){var t=this.applicationContext,i=t&&t.edition?t.edition:[];return e.isArray(i)?i:[i]},p=function(t){return e.indexOf(this.getEdition(),t)>=0},f=function(){var e=this.applicationContext;return e&&e.processes&&e.processes.length>0?e.processes[0]:null},m=function(){var e=this.applicationContext;return e&&e.loggedUser?e.loggedUser:null},h=function(){var e=this.getProcess();return e?e.id:null},g=function(){var e=this.getProject();return e?e.id:null},v=function(){var e=this.getTeam();return e?e.id:null},b=function(e){return null!==n(this.applicationContext,e)};return i}),define("libs/modernizr/modernizr",[],function(){return window.Modernizr=function(e,t,i){function n(e){b.cssText=e}function a(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function s(e,t){for(var n in e){var a=e[n];if(!r(a,"-")&&b[a]!==i)return"pfx"==t?a:!0}return!1}function o(e,t,n){for(var r in e){var s=t[e[r]];if(s!==i)return n===!1?e[r]:a(s,"function")?s.bind(n||t):s}return!1}function l(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+x.join(n+" ")+n).split(" ");return a(t,"string")||a(t,"undefined")?s(r,t):(r=(e+" "+w.join(n+" ")+n).split(" "),o(r,t,i))}var u,c,d,p="2.8.2",f={},m=!0,h=t.documentElement,g="modernizr",v=t.createElement(g),b=v.style,y=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),_="Webkit Moz O ms",x=_.split(" "),w=_.toLowerCase().split(" "),C={svg:"http://www.w3.org/2000/svg"},S={},T=[],k=T.slice,I=function(e,i,n,a){var r,s,o,l,u=t.createElement("div"),c=t.body,d=c||t.createElement("body");
if(parseInt(n,10))for(;n--;)o=t.createElement("div"),o.id=a?a[n]:g+(n+1),u.appendChild(o);return r=["&#173;",'<style id="s',g,'">',e,"</style>"].join(""),u.id=g,(c?u:d).innerHTML+=r,d.appendChild(u),c||(d.style.background="",d.style.overflow="hidden",l=h.style.overflow,h.style.overflow="hidden",h.appendChild(d)),s=i(u,e),c?u.parentNode.removeChild(u):(d.parentNode.removeChild(d),h.style.overflow=l),!!s},D={}.hasOwnProperty;d=a(D,"undefined")||a(D.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return D.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=k.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var r=new a,s=t.apply(r,i.concat(k.call(arguments)));return Object(s)===s?s:r}return t.apply(e,i.concat(k.call(arguments)))};return n}),S.flexbox=function(){return l("flexWrap")},S.cssanimations=function(){return l("animationName")},S.csstransforms=function(){return!!l("transform")},S.csstransforms3d=function(){var e=!!l("perspective");return e&&"webkitPerspective"in h.style&&I("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},S.csstransitions=function(){return l("transition")},S.svg=function(){return!!t.createElementNS&&!!t.createElementNS(C.svg,"svg").createSVGRect},S.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==C.svg};for(var P in S)d(S,P)&&(c=P.toLowerCase(),f[c]=S[P](),T.push((f[c]?"":"no-")+c));return f.addTest=function(e,t){if("object"==typeof e)for(var n in e)d(e,n)&&f.addTest(n,e[n]);else{if(e=e.toLowerCase(),f[e]!==i)return f;t="function"==typeof t?t():t,"undefined"!=typeof m&&m&&(h.className+=" mod-"+(t?"":"no-")+e),f[e]=t}return f},n(""),v=u=null,f._version=p,f._prefixes=y,f._domPrefixes=w,f._cssomPrefixes=x,f.testProp=function(e){return s([e])
},f.testAllProps=l,f.testStyles=I,f.prefixed=function(e,t,i){return t?l(e,t,i):l(e,"pfx")},h.className=h.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(m?" mod-js mod-"+T.join(" mod-"):""),f}(this,this.document),function(e,t,i){function n(e){return"[object Function]"==g.call(e)}function a(e){return"string"==typeof e}function r(){}function s(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function o(){var e=v.shift();b=1,e?e.t?m(function(){("c"==e.t?p.injectCss:p.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),o()):b=0}function l(e,i,n,a,r,l,u){function c(t){if(!f&&s(d.readyState)&&(y.r=f=1,!b&&o(),d.onload=d.onreadystatechange=null,t)){"img"!=e&&m(function(){x.removeChild(d)},50);for(var n in k[i])k[i].hasOwnProperty(n)&&k[i][n].onload()}}var u=u||p.errorTimeout,d=t.createElement(e),f=0,g=0,y={t:n,s:i,e:r,a:l,x:u};1===k[i]&&(g=1,k[i]=[]),"object"==e?d.data=i:(d.src=i,d.type=e),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){c.call(this,g)},v.splice(a,0,y),"img"!=e&&(g||2===k[i]?(x.insertBefore(d,_?null:h),m(c,u)):k[i].push(d))}function u(e,t,i,n,r){return b=0,t=t||"j",a(e)?l("c"==t?C:w,e,t,this.i++,i,n,r):(v.splice(this.i++,0,e),1==v.length&&o()),this}function c(){var e=p;return e.loader={load:u,i:0},e}var d,p,f=t.documentElement,m=e.setTimeout,h=t.getElementsByTagName("script")[0],g={}.toString,v=[],b=0,y="MozAppearance"in f.style,_=y&&!!t.createRange().compareNode,x=_?f:h.parentNode,f=e.opera&&"[object Opera]"==g.call(e.opera),f=!!t.attachEvent&&!f,w=y?"object":f?"script":"img",C=f?"script":w,S=Array.isArray||function(e){return"[object Array]"==g.call(e)},T=[],k={},I={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};p=function(e){function t(e){var t,i,n,e=e.split("!"),a=T.length,r=e.pop(),s=e.length,r={url:r,origUrl:r,prefixes:e};for(i=0;s>i;i++)n=e[i].split("="),(t=I[n.shift()])&&(r=t(r,n));for(i=0;a>i;i++)r=T[i](r);return r}function s(e,a,r,s,o){var l=t(e),u=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(a&&(a=n(a)?a:a[e]||a[s]||a[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,a,r,s,o):(k[l.url]?l.noexec=!0:k[l.url]=1,r.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":i,l.noexec,l.attrs,l.timeout),(n(a)||n(u))&&r.load(function(){c(),a&&a(l.origUrl,o,s),u&&u(l.origUrl,o,s),k[l.url]=2
})))}function o(e,t){function i(e,i){if(e){if(a(e))i||(d=function(){var e=[].slice.call(arguments);p.apply(this,e),f()}),s(e,d,t,0,u);else if(Object(e)===e)for(l in o=function(){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}(),e)e.hasOwnProperty(l)&&(!i&&!--o&&(n(d)?d=function(){var e=[].slice.call(arguments);p.apply(this,e),f()}:d[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),f()}}(p[l])),s(e[l],d,t,l,u))}else!i&&f()}var o,l,u=!!e.test,c=e.load||e.both,d=e.callback||r,p=d,f=e.complete||r;i(u?e.yep:e.nope,!!c),c&&i(c)}var l,u,d=this.yepnope.loader;if(a(e))s(e,0,d,0);else if(S(e))for(l=0;l<e.length;l++)u=e[l],a(u)?s(u,0,d,0):S(u)?p(u):Object(u)===u&&o(u,d);else Object(e)===e&&o(e,d)},p.addPrefix=function(e,t){I[e]=t},p.addFilter=function(e){T.push(e)},p.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",d=function(){t.removeEventListener("DOMContentLoaded",d,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=o,e.yepnope.injectJs=function(e,i,n,a,l,u){var c,d,f=t.createElement("script"),a=a||p.errorTimeout;f.src=e;for(d in n)f.setAttribute(d,n[d]);i=u?o:i||r,f.onreadystatechange=f.onload=function(){!c&&s(f.readyState)&&(c=1,i(),f.onload=f.onreadystatechange=null)},m(function(){c||(c=1,i(1))},a),l?f.onload():h.parentNode.insertBefore(f,h)},e.yepnope.injectCss=function(e,i,n,a,s,l){var u,a=t.createElement("link"),i=l?o:i||r;a.href=e,a.rel="stylesheet",a.type="text/css";for(u in n)a.setAttribute(u,n[u]);s||(h.parentNode.insertBefore(a,h),m(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("csscalc",function(){var e="width:",t="calc(10px);",i=document.createElement("div");return i.style.cssText=e+Modernizr._prefixes.join(t+e),!!i.style.length}),Modernizr}),define("libs/modernizr/modernizr.hidpr",["libs/modernizr/modernizr"],function(e){var t=2;e.addTest("hidpr",function(){return window.devicePixelRatio>=t
})}),define("Modernizr",["libs/modernizr/modernizr","libs/modernizr/modernizr.hidpr"],function(e){return e}),define("tau/models/application/model.application.main",["Underscore","jQuery","tau/core/extension.base","tau/core/tau","tau/core/termProcessor","tau/models/dataprocessor/model.processor.context","Modernizr"],function(e,t,i,n,a,r,s){var o=n.Error;return i.extend({init:function(e){var t=e.context.configurator,i=t.getAppStateStore(),n=t.getApplicationContextService(),s=function(e){e.acid&&n.getApplicationContext({acid:e.acid},{success:function(e){var i=r({applicationContext:e});t.getTemplateFactory().setTermProcessor(new a(i.getTerms()))}})};i.bind({fields:["acid"],listener:this,callback:s}),i.get({fields:["acid"]}).then(s),this._super(e)},"bus initialize":function(t,i){var n=this._extractOptions(i,{applicationId:e.uniqueId("app"),turnOffLoadingIndicator:!1,integration:{showInPopup:!1,keepAlive:!1,appendTo:null},routing:{silent:!1,executeOnStart:!0},comet:{enabled:!1}}),a=i.context.configurator;this.fire("configurator.ready",a),this.fire("options.ready",n),this.checkCompatibility(a).done(e.bind(function(){this.fire("routing.enable")},this)).fail(e.bind(function(e){this.fire("routing.disable"),this.fire("routing.forward",{url:"error",args:{error:e}})},this))},"bus initialize + destroy":function(e,t){var i=t.context.configurator,n=i.getAppStateStore();n.unbind({listener:this})},"bus afterInit":function(){this.fire("dataBind",{})},getCompatibilityMessage:function(t){var i={ieDocMode:"Targetprocess 3 does not support Internet Explorer in %s document mode. Please, turn standards mode.",other:'Targetprocess 3 supports the two most recent versions of the following browsers:</p><div class="msg"><ul><li style=""><a href="http://www.google.com/chrome/">Google Chrome</a> (recommended)</li><li><a href="http://www.mozilla.com/firefox/">Mozilla Firefox</a></li><li><a href="http://www.microsoft.com/windows/Internet-explorer/">Internet Explorer</a></li><li><a href="http://www.apple.com/safari/download/">Safari</a></li></ul></div><p>'};
if(t){var a=e.all(["csscalc","flexbox","inlinesvg","svg"],function(e){return s[e]}),r=/PhantomJS/.test(navigator.userAgent);if(a||r)return null}else{var o=n.getIEVersion();if(o>=9){var l=9;if("BackCompat"===document.compatMode)return e.sprintf(i.ieDocMode,"Quirks");var u=document.documentMode||6;return l>u?l>o?i.other:e.sprintf(i.ieDocMode,"IE"+u):null}if(!o)return null}return i.other},checkCompatibility:function(e){var i=t.Deferred(),n=this.getCompatibilityMessage(e.isBoardEdition);return n?i.reject(new o("We're sorry, but this browser is not supported",n)):i.resolve(),i}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.routing",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready + beforeInit":function(t,i,n){var a=n.config.routes;a.unshift({pattern:/error/,host:{name:"error_page",type:"page.error"},type:{type:"label",text:""}});var r=e.map(a,e.bind(function(e){return this.processRoute(e,i)},this));this.currentValue=!0,this.fire("routes.ready",r)},"bus configurator.ready + options.ready + routes.ready + afterRender":function(e,t,i,n){this.bindToRoutes(t,i,n),i.routing.executeOnStart&&t.getHashService().triggerHashChange(),this.fire("routes.bound",n)},"bus configurator.ready + destroy":function(e,t){this.currentValue=null,t.getHashService().removeAllListeners(this)},"bus application.exit":function(){this.currentValue=null},"bus routes.bound:last + configurator.ready:last+routing.forward":function(e,t,i,n){this._onHashChanged(i,t,n.url,n.args)},"bus routing.disable":function(){this.disabled=!0},"bus routing.enable":function(){this.disabled=!1},bindToRoutes:function(e,t,i){var n=t.applicationId,a=e.getHashService();a.on("changed",function(){if(!this.disabled){var t=n?a.getHashParam(n):a.getHash().split("&")[0];this._onHashChanged(e,i,t)}},this)},_onHashChanged:function(t,i,n,a){if(this.currentValue!==n){this.currentValue=n;var r=e.find(i,function(e){return e.pattern.test(n)});if(r){var s=r.pattern.exec(n).slice(1).concat(e.toArray(a));
r.callback.apply(null,s),t.getRouting().setReferer(t.service("navigator").getCurrent())}else this.fire("error","URL is not found")}},processRoute:function(t,i){return{name:t.name,pattern:e.isString(t.pattern)?new RegExp(t.pattern):t.pattern,callback:this.createPatternCallback(t,i)}},createPatternCallback:function(t,i){var n=e.bind(function(n){n=n||{},i.getRouting().setCurrentRoute({route:t,args:n}),this.fire("application.navigate",{host:t.host,type:t.type,requestArgs:e.defaults(n,{handlers:{onPageLoaded:e.identity}})})},this),a=e.bind(this.fire,this);return function(){t.adapter?t.adapter.apply({fire:a,configurator:i,resolve:n},arguments):(t.host.request=e.toArray(arguments),t.type.request=e.toArray(arguments),n())}}})}),define("tau/ui/behaviour/common/ui.behaviour.progressIndicator",["Underscore","jQuery"],function(e){return{get:function(t){var i=t.tauProgressIndicator();return{show:e.bind(function(e){var n=this;e=e||{};var a=i;if(e.delay>0){var r=setTimeout(function(){n.data("ui-tauProgressIndicator")&&n.tauProgressIndicator("show",e)},e.delay);t.data("tauProgressIndicator-timeoutDescriptor",r)}else a=n.tauProgressIndicator("show",e);return a},t),hide:e.bind(function(){var e=this,t=e.data("tauProgressIndicator-timeoutDescriptor");return t&&clearTimeout(t),e.tauProgressIndicator("hide")},t)}}}}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.controller",["Underscore","jQuery","tau/core/extension.base","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tau/core/event-dispatcher"],function(e,t,i,n,a){return i.extend({"bus beforeInit":function(){this.fire("controller.hostType",null),this.fire("controller.app.host.prev",null),this.fire("controller.app.page.prev",null)},"bus controller.app.host.prev > controller.app.host":function(e){var t=e["controller.app.host"].data,i=e["controller.app.host.prev"].data;i&&i.destroy(),this.fire("controller.app.host.prev",t)},"bus controller.app.page.prev > controller.app.page":function(e){var t=e["controller.app.page"].data,i=e["controller.app.page.prev"].data;
i&&i.destroy(),this.fire("controller.app.page.prev",t)},"bus configurator.ready:last + application.navigate":function(e,t){t.service("errorBar").fire("clearError")},"bus controller.hostType:last + application.navigate":function(t,i,n){var a=n.requestArgs||{},r=a.entity,s=a.action,o=e.isObject(r)?r.type:e.asString(r);n.requestArgs&&n.requestArgs.cssClass||!(o&&s||"reports"==r)||(n.applicationClassName="tau-page-entity"),n.requestArgs&&n.requestArgs.applicationClassName&&(n.applicationClassName=n.requestArgs.applicationClassName);var l=n.host,u=!i||l.name!==i.name;u&&this.fire("controller.hostType",l);var c=u?"full":"partial";this.fire("controller.load."+c,n)},"bus options.ready:last + configurator.ready:last + controller.load.full":function(i,n,r,s){var o=r.getComponentBuilder(),l=s.requestArgs,u=l.handlers||{},c=this._getInitConfig(r,n,e.omit(l,"handlers"));t.when(o.create(s.host,c),o.create(s.type,c)).done(e.bind(function(t,i){this.fire("controller.preExecute",{}),this.fire("controller.app.host",t),this.fire("controller.app.page",i),this.addListeners(t,"Host"),this.addListeners(i,"Page");var n=new a([t,i]);n.listen("afterRender",e.bind(function(t){var n=t.argsArr[0].element,a=t.argsArr[1].element;this.fire("innerContentRendered",{element:n,$host:n,$page:a,applicationClassName:s.applicationClassName}),this.fire("host.ready"),i.on("afterRender",e.bind(function(e,t){this.fire("innerContentRendered",{element:this.$host,$host:this.$host,$page:t.element,applicationClassName:s.applicationClassName})},this),this),i.on("afterRenderAll",e.bind(function(e,t){this.fire("innerContentRenderedAll",{element:this.$host,$host:this.$host,$page:t.element,applicationClassName:s.applicationClassName}),u.onPageLoaded&&u.onPageLoaded()},this),this)},this)),t.initialize(c),i.initialize(c),this.fire("controller.postExecute",{})},this))},"bus options.ready:last + configurator.ready:last + host.ready:last + controller.load.partial":function(i,n,a,r,s){var o=a.getComponentBuilder(),l=s.requestArgs,u=l.handlers||{},c=this._getInitConfig(a,n,e.omit(l,"handlers"));
t.when(o.create(s.type,c)).done(e.bind(function(t){this.fire("controller.preExecute",{}),this.fire("controller.app.page",t),this.addListeners(t,"Page"),t.on("afterRender",e.bind(function(e,t){this.fire("innerContentRendered",{element:this.$host,$host:this.$host,$page:t.element,applicationClassName:s.applicationClassName}),u.onPageLoaded&&u.onPageLoaded()},this),this),t.initialize(c),this.fire("controller.postExecute",{})},this))},"bus afterRender:last + innerContentRendered":function(e,t,i){var n=t.element,a=i.$host,r=i.$page;a.is(this.$host)&&r.is(this.$page)||(a.is(this.$host)||(this._appendHost(n,a),this.$host=a,this._appendPage(n,a,r),this.$page=r),r.is(this.$page)||(this._appendPage(n,this.$host,r),this.$page=r),this.fire("applyClasses",{$el:n,controllersRenderData:i}),this.fire("controller.appContent.rendered",n),this.fire("contentRendered",{element:n}))},"bus view.dom.ready:last + applyClasses":function(e,t,i){var n=i.$el,a=i.controllersRenderData,r=n.parents(".ui-popup:first");r=r.length?n.add(r):n,a.applicationClassName?n.data("classname")!=a.applicationClassName&&(r.removeClass(r.data("classname")||""),r.addClass(a.applicationClassName),r.data("classname",a.applicationClassName)):(r.removeClass(r.data("classname")||""),r.data("classname",""))},"bus controller.load.partial > controller.host.rendered":function(e,t,i){this.toggleProgressIndicator(i.element,!0)},"bus controller.load.partial > controller.host.rendered > innerPageRendered":function(e,t,i){this.toggleProgressIndicator(i.element,!1)},toggleProgressIndicator:function(e,t){var i=e.find("[role=main]"),a=this.config.integration||{};!0!==a.disableProgressIndicator&&n.get(i).toggle(!!t)},"bus configurator.ready:last + controller.app.page":function(e,t,i){i.on("entity.beforeDelete",function(){this.fire("initProgress")},this),i.on("entity.deleted",function(){t.service("navigator").back()},this),i.on("error",function(e){this.fire("application.error",e.data)},this)},"bus view.dom.ready:last + controller.app.host:last + innerHostRendered + controller.appContent.rendered":function(e,t,i){i.fire("view.dom.ready",t)
},"bus view.dom.ready:last + controller.app.page:last + innerPageRendered + controller.appContent.rendered":function(e,t,i){i.fire("view.dom.ready",t)},"bus controller.app.host:last > destroy":function(e,t){t.fire("destroy")},"bus controller.app.page:last > destroy":function(e,t){t.fire("destroy")},"bus controller.app.page:last > application.exit":function(e,t){t.fire("destroy"),taus.track({action:"close entity",tags:["entity","close entity"]})},_getInitConfig:function(t,i,n){var a=e.defaults({context:{configurator:t}},n);return a.turnOffLoadingIndicator=i.turnOffLoadingIndicator||!1,a.comet=i.comet||{},a},_appendHost:function(e,t){e.empty().append(t)},_appendPage:function(e,t,i){t.find("[role=main]").append(i)},addListeners:function(t,i){return t.on("afterRender",e.bind(function(e){this.fire("inner"+i+"Rendered",e.data)},this),this),t}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.navigation",["Underscore","jQuery","tau/core/class","tau/core/extension.base","libs/parseUri"],function(e,t,i,n,a){return n.extend({"bus initialize":function(){this._id=e.uniqueId("navigator")},"bus options.ready:last + view.dom.ready:last + configurator.ready:last + afterRender":function(i,n,r,s,o){if(n.routing.silent){var l=o.element;l.parent().off("click."+this._id,"a"),l.parent().on("click."+this._id,"a",e.bind(function(i,n){if(!n.ctrlKey&&!n.metaKey){var r=t(n.currentTarget),s=e.asString(r.attr("href"));if("#"!==s){var o="";"#"===s.charAt(0)?o=s.substr(1):r.data("target")||r.attr("target")||(o=a(s).anchor),o&&(n.preventDefault(),n.stopPropagation(),i.service("navigator").to(o))}}},this,s))}},"bus configurator.ready:last + routes.bound:last + application.navigate.entity":function(t,i,n,a){var r=e.compact([a.entity||a.type,a.id,a.action]).join("/");i.service("navigator").to(r)},"bus configurator.ready":function(t,i){i.service("navigator").on("back",e.bind(function(t){var n=i.getHistory(),r=n.pop();r?(n.setCurrent(null),i.service("navigator").to(a(r.url).anchor)):this.fire("application.exit"),t.data.clearNotification&&e.delay(e.bind(this.fire,this,"clearError"),100)
},this),this)},"bus configurator.ready:last + destroy":function(e,t){t.service("navigator").removeAllListeners(this)},"bus contentRendered + destroy":function(e,t){var i=t.element;i.parent().off("click."+this._id,"a")}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.history",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready":function(e,t){this.setHandler(t)},"bus configurator.ready:last + application.exit + application.navigate.entity":function(e,t){this.setHandler(t)},"bus configurator.ready:last + history.reset":function(e,t){t.getHistory().reset()},"bus configurator.ready:last + controller.preExecute":function(e,t){t.getHistory().process()},"bus configurator.ready:last + application.exit":function(e,t){this.clear(t)},"bus configurator.ready:last + destroy":function(e,t){this.clear(t)},setHandler:function(t){var i=e.bind(function(){var e=t.getHistory().getCurrent();e&&e.title&&t.getTitleManager().set(e.title)},this);t.getHistory().on("setCurrent",i,this)},clear:function(e){e.getTitleManager().restoreDefault();var t=e.getHistory();t.reset(),t.removeAllListeners(this)}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.integration",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus beforeInit + configurator.ready":function(t,i,n){var a=e.bind(function(e){var t=e.data,i={project:{id:t.project.id}},n={id:t.entity.id,changes:i,cmd:{config:{$set:i}}};this.fire("integration.react",n)},this),r=e.bind(function(e){var t=e.data,i={},n={id:t.bugId,changes:i,cmd:{config:{$set:i}}};this.fire("integration.react",n)},this),s=n.getGlobalBus();s.removeAllListeners(this),s.on("bugWasMarkedAsDuplicate",r,this),s.on("entityWasMovedToProject",a,this);var o=n.getStore();o.unbind(this);var l=e.bind(function(e){this.fire("integration.react",e.data)},this),u=["general","assignment","roleEffort"];e.each(u,e.bind(function(e){o.on({type:e,eventName:"afterSave",listener:this},l),o.on({type:e,eventName:"afterRemove",listener:this},l)
},this))},"bus options.ready + beforeInit":function(e,i){t("body").delegate("a[href=#]","click",function(e){e.preventDefault()});var n=i.integration.reloadCallback,a=i.integration.progress;a&&this.fire("progress.ready",a),n&&this.fire("reloadCallback.ready",n)},"bus progress.ready:last + initProgress":function(e,t){t.show("Reloading...")},"bus progress.ready:last + application.error":function(e,t){t.hide()},"bus reloadCallback.ready:last + integration.react":function(e,t,i){t({data:i})},"bus configurator.ready > destroy":function(e,t){t.getStore().unbind(this),t.getGlobalBus().removeAllListeners(this)}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.errorBar",["jQuery","Underscore","tau/core/extension.base","tau/core/bus"],function(e,t,i){return i.extend({"bus initialize":function(t,i){var n=i.context.configurator,a=e("body"),r=n.service("errorBar");r.on("error",function(e){this.showError(a,e.data)},this),r.on("notification",function(e){this.showNotification(a,e.data)},this),r.on("clearError",function(e){this.clearError(a,e.data)},this),this.fire("$notified.ready",a),this.on("destroy",function(){r.removeAllListeners(this),a=null}.bind(this))},"bus $notified.ready:last + clearError":function(e,t,i){this.clearError(t,i)},"bus $notified.ready:last + error":function(e,t,i){this.showError(t,i)},"bus $notified.ready:last + notification":function(e,t,i){this.showNotification(t,i)},clearError:function(e,t){e.notifyBar("remove",t)},showError:function(e,i){this.notify({id:i.id,type:i.type||"error",message:t.isString(i)?i:i.message||"Error",details:i.details,$node:i.$node,delay:i.delay,disableAutoClose:i.disableAutoClose===!0,button:i.button},e)},showNotification:function(e,t){this.notify({id:t.id,type:t.type,message:t.message,$node:t.$node,delay:t.delay,disableAutoClose:t.disableAutoClose===!0,button:t.button},e)},notify:function(i,n){if(!i.$node&&(i.$node=e('<div class="tau-system-message-body-inner"></div>'),i.$node.append("<h3>"+t.asString(i.message)+"</h3>"),i.details)){var a=e("<p></p>").append(i.details);
i.$node.append(a)}var r=i.type||"success",s="success"===r,o=i.disableAutoClose,l=s?5e3:i.delay||1e5;s&&void 0===o&&(o=!1),n.notifyBar({id:i.id,className:"tau-system-message-"+r,$node:i.$node,delay:l,disableAutoClose:o,button:i.button})}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.popup",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus options.ready + beforeInit":function(e,t){this.initContainer(t)},init:function(e){this._super(e),this.$element=this.createElement()},createElement:function(){return t("<div></div>")},setWidget:function(e){this.$element.tauPopup({hideOnEscape:!0,hide:function(){this.fire(e.integration.keepAlive?"application.exit":"destroy")}.bind(this)})},showWidget:function(){this.$element.tauPopup("show")},hideWidget:function(){this.$element.tauPopup("hide")},getWidget:function(){return this.$element.tauPopup("widget")},initContainer:function(e){this.setWidget(e),this.$widget=this.getWidget(),this.$widget.on("transitionend webkitTransitionEnd",function(){t(window).trigger("resize")}),e.integration.cssClass&&this.$widget.addClass(e.integration.cssClass),this.fire("$popup.ready",this.$element)},"bus $popup.ready > contentRendered":function(e,t,i){this.fire("popup.open",i)},"bus popup.close > contentRendered":function(e,t,i){this.fire("popup.open",i)},"bus configurator.ready:last + $popup.ready:last + popup.open":function(e,i,n,a){var r=a.element;r.addClass("ui-popup-content"),this.showWidget(),this.$widget.append(r),this.fire("view.dom.ready",t("body"))},"bus application.exit":function(){this.fire("popup.close")},"bus configurator.ready:last + $popup.ready:last + popup.close":function(){this.$widget.is(":visible")&&this.hideWidget()},"bus $popup.ready > destroy":function(){this.hideWidget()}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.coverView",["Underscore","jQuery","tau/ui/extensions/application.generic/ui.extension.application.generic.popup"],function(e,t,i){return i.extend({createElement:function(){return t('<div class="tau-cover-view_page tau-cover-view-hide"></div>').appendTo("body")
},showWidget:function(){this.$element.tauCoverView("show")},hideWidget:function(){this.$element.tauCoverView("hide")},setWidget:function(e){this.$element.tauCoverView({showCloseButton:!0,overlay:{show:!0,hideViewOnClick:!0},autoHide:{onEscape:!0},hide:function(){this.fire(e.integration.keepAlive?"application.exit":"destroy")}.bind(this),keyBoardManager:this.config.context.configurator.getKeyBoardManager()})},getWidget:function(){return this.$element.tauCoverView("widget")},"bus $popup.ready > destroy":function(){this.$element.remove()}})}),define("tau/ui/templates/application/ui.template.application.generic",["tau/core/templates-factory"],function(e){var t={name:"application.generic",engine:"jqote2",markup:['<div role="application" class="tau-app i-role-application',"<% if (/chrome|webkit/i.test(window.navigator.userAgent)) { %> i-browser_engine_webkit<% } %>","<% else if (fn.$.ui.ie) { %> i-browser_engine_ie<% } %>",'">',"</div>"]};return e.register(t)}),define("tau/components/component.application.generic",["Underscore","tau/service.container","tau/core/component-base","tau/models/application/model.application.main","tau/core/view-base","tau/ui/extensions/application.generic/ui.extension.application.generic.routing","tau/ui/extensions/application.generic/ui.extension.application.generic.controller","tau/ui/extensions/application.generic/ui.extension.application.generic.navigation","tau/ui/extensions/application.generic/ui.extension.application.generic.history","tau/ui/extensions/application.generic/ui.extension.application.generic.integration","tau/ui/extensions/application.generic/ui.extension.application.generic.errorBar","tau/ui/extensions/application.generic/ui.extension.application.generic.popup","tau/ui/extensions/application.generic/ui.extension.application.generic.coverView","tau/ui/templates/application/ui.template.application.generic"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return{create:function(m){m=m||{onCreate:function(){}};var h=m.context.configurator||new t,g=new i({name:m.name,queuedBus:!0,context:{configurator:h},template:f}),v=[n,a,r,s,o,l,u,c],b=m.integration||m.options&&m.options.integration||{};
b.showInPopup===!0?v.push(d):b.showInCoverView===!0&&v.push(p),v=v.concat(m.extensions||[]),e.forEach(v,function(e){g.attach(e,m)});var y=g.bus;return h.getComponentBusRegistry().register(y),y.on("destroy",function(){h.getComponentBusRegistry().unregister(this)}),y}}}),define("tau/services/service.navigator",["Underscore","jQuery","tau/core/class","tau/core/event"],function(e,t,i,n){var a=i.extend({init:function(t,i){this.hashService=t.getHashService(),this.options=e.defaults(i||{},{parameterName:null})},to:function(e){this.options.parameterName?this.hashService.setHashParam(this.options.parameterName,e):this.hashService.setHash(e)},back:function(e){this.fire("back",{clearNotification:e})},getCurrent:function(){return this.options.parameterName?this.hashService.getHashParam(this.options.parameterName):this.hashService.getHash()}});return n.implementOn(a.prototype),a}),define("tau/core/model-base",["Underscore","tau/core/extension.base.stateful"],function(e,t){var i=t.extend({isCommandForEntityInContext:function(e){var t=e.data,i=t.cmd?t.cmd.config.id:t.obj?t.obj.id:null;return i===this.config.context.entity.id},isPropertyChanged:function(t,i){var n=i.changes,a=i.cmd&&i.cmd.config.$set||{};return e.any(t,function(e){return n&&n.hasOwnProperty(e)||a.hasOwnProperty(e)})},attachToChangePropertiesOfCurrentEntity:function(t){var i=e.isArray(t)?t:[t],n=this.config.context.entity.id,a=this,r=function(e){var t=e.data;a.isPropertyChanged(i,t)&&a.fire("propertyChanged",t)},s=function(e){var t=e.data;a.isPropertyChanged(i,t)&&a.fire("beforeChangeProperty",t)},o=function(e){var t=e.data;t.cmd.config.id==n&&a.isPropertyChanged(i,t)&&a.fire("propertyChanged",t)};a.store.unbind(a);var l=this.config.context.entity.entityType.name||"general";a.store.on({type:l,eventName:"afterSave",filter:{id:n},listener:a},r),a.store.on({type:l,eventName:"beforeSave",filter:{id:n},listener:a},s),a.store.on({eventName:"failure",listener:a},o),t[this.propertyName]=[this.displayField,this.valueField]},"bus evictData":function(){var e=this.config.entity||this.config.context.entity,t=e.id;
this.store.config.proxy.evictPersistedObject(t,"context"),this.store.config.proxy.evictPersistedObject(t,e.type||e.entityType.name)}});return i}),define("tau/models/model.extension",["tau/core/model-base"],function(e){var t=e.extend({onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction")}});return t}),define("tau/models/model.duplicateBugList",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({_retrieveEntity:function(){var e=this.config.context,t=e.entity.entityType.name,i=e.entity.id,n={id:i,fields:["id"]};this.store.get(t,n,{scope:this,success:this.onEntityRetrieved}).done()},convertServerDataModelData:function(e){return{__type:e.__type,id:e.id,name:e.name,state:{name:e.entityState.name},url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)}},onEntityRetrieved:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction")},"bus duplicateBugRetrieved":function(t){var i=t.data.items,n=e.map(i,this.convertServerDataModelData,this);n=e.compact(n);var a={items:n};this.bus.fire("dataBind",a)},onInit:function(){this.config.disableModel||this._retrieveEntity()}});return i}),define("tau/models/model.duplicateBugCountCalculator",["tau/models/model.duplicateBugList"],function(e){var t=e.extend({"bus duplicateBugRetrieved":function(e){var t=e.data.items;this.fire("duplicateBugCountRetrieved",{count:t.length})}});return t}),define("tau/models/model.duplicateBugRetriever",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({init:function(){this._super.apply(this,arguments)},convertServerDataModelData:function(e){return{__type:e.__type,id:e.id,name:e.name,state:{name:e.entityState.name}}},"bus registerStoreRequest":function(){var e=this.config.context,t=e.entity.entityType.name,i=e.entity.id,n={fields:["id","name",{entityState:["name"]}],$query:{tags:{$contains:"duplicateOf#"+i}}};this.fire("find",{type:t,query:n,callback:{scope:this,success:this.onDuplicateBugsRetrieved}})},onDuplicateBugsRetrieved:function(t){var i=e.sortBy(t.data,function(e){return e.id
}),n={items:i};this.fire("duplicateBugRetrieved",n)}});return i}),define("tau/components/extensions/duplicateBugList/extension.duplicateBugList.visibilityController",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus afterRender":function(e){e.data.element.hide()},"bus componentsCreated+duplicateBugCountRetrieved":function(e){var t=e.duplicateBugCountRetrieved.data.count,i=e.componentsCreated.data,n=i[0].component;n.fire("sendEventToComponents",{name:"setBadgeData",data:t.toString()})},"bus componentsCreated+duplicateBugRetrieved":function(e){var t=e.duplicateBugRetrieved.data.items,i=e.componentsCreated.data,n=i[1].component;"duplicateBugListPanel inner"!=n.name&&n.fire("duplicateBugRetrieved",{items:t})},"bus afterRender+duplicateBugCountRetrieved":function(e){if(e.duplicateBugCountRetrieved.data.count>0){var t=e.afterRender.data.element;this.config.disableAnimation?t.show():t.slideDown("slow")}}})}),define("tau/models/assignmentsList/extension.model.store.operations",["Underscore","tau/core/model-base","tau/core/event"],function(e,t){var i=t.extend({category:"store operations","bus commitTransaction":function(e){var t=this.transaction||this.store;delete this.transaction,t.done(e.data)},"bus get":function(e){var t=this.transaction=this.transaction||this.store,i=e.data||{};this.transaction=t.get(i.type,i.query,i.callback)},"bus find":function(e){var t=this.transaction=this.transaction||this.store,i=e.data||{};this.transaction=t.find(i.type,i.query,i.callback)},destroy:function(){this._super.apply(this,arguments),this.destroy=function(){}}});return i}),define("tau/ui/extensions/list/extension.bubble.nodata.event",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus childComponentCreated":function(e,t){t.on("noData",this.fire.bind(this,"noData"))}})}),define("tau/ui/extensions/list/extension.list.empty.entity.hider",["tau/ui/extensions/list/extension.bubble.nodata.event"],function(e){return e.extend({"bus noData":function(){this.fire("hide")
}})}),define("tau/configurations/converters/converter.print",["Underscore","tau/models/model.extension","tau/models/model.duplicateBugCountCalculator","tau/models/model.duplicateBugRetriever","tau/components/extensions/duplicateBugList/extension.duplicateBugList.visibilityController","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor","tau/ui/extensions/list/extension.list.empty.entity.hider","tau/ui/extensions/list/extension.bubble.nodata.event"],function(e,t,i,n,a,r,s,o,l){var u={duplicateBugListPanel:function(t,o){var l=new s(o.getTerms());return e.extend(t,{compId:"duplicateBugs",type:"container",layout:"list",cssClass:"b-section",disableAnimation:!0,children:[{type:"label",text:"Duplicate "+l.getTerms("Bug").names,hideCounter:!0},{type:"duplicateBugList",disableModel:!0}],extensions:[a,n,i,r]}),t},tabs:function(t){return t=e.extend(t,{type:"container",children:[],cssClass:"b-tabs"}),delete t.additionalHeaders,e.forEach(t.tabs,function(i){i=e.extend(i,{type:"container",children:i.items,cssClass:"b-tab",isTopContainer:!0,bubbleNoDataEvent:!0});var n=!e.isUndefined(i.children)&&i.children.length&&"revisionList"===i.children[0].type;n||(!e.isUndefined(i.header)&&i.header.length&&i.children.unshift({type:"label",text:i.header[0].text}),t.children.push(i))}),t},container:function(t){return(t.isChildContainer||t.isTopContainer)&&(t.containsNestedContainers?t.bubbleNoDataEvent=!1:t.isNestedTopContainer&&(t.bubbleNoDataEvent=!0),t.bubbleNoDataEvent&&(t.extensions=t.extensions||[],t.extensions.push(t.isTopContainer||t.isNestedTopContainer?o:l)),e.each(t.children,function(e){"container"===e.type&&(e.isChildContainer=!0,e.bubbleNoDataEvent=t.bubbleNoDataEvent)})),t},collapsible:function(t){return t=e.extend(t,{type:"container",children:[],cssClass:"b-section"}),t.children=t.items,!e.isUndefined(t.header)&&t.header.length&&t.children.unshift({type:"label",text:t.header[0].text}),t}},c=function(t,i){var n=null;if(e.isArray(t)){var a=0;for(n=function(e){t.splice(e,1),a--
},a=0;a<t.length;a++)i(t[a],a,n)}else{n=function(e){delete t[e]};for(var r=e(t).keys(),s=null;s=r.pop();)i(t[s],s,n)}},d=function(t,i){return c(t,function(n,a,r){if(n.type){if(n.printable===!1)return void r(a);e.isFunction(u[n.type])&&(t[a]=u[n.type](n,i)),n.children&&(t[a].children=d(n.children,i)),n.items&&(t[a].items=d(n.items,i)),t[a].disabledExtensionCategories=["edit"]}else"children"==a&&(t[a]=d(n,i))}),t};return{convert:function(e){return e=d(e,e.context),e.children&&e.children.length&&(e.children[0].cssClass="main-container main-container-print i-print"),e}}}),define("tau/ui/extensions/page/ui.extension.page.print",["tau/core/extension.base","tau/configurations/converters/converter.print"],function(e,t){return e.extend({"bus onConfigContainerCreated":function(e){var i=e.data;t.convert(i),i.children.push({type:"print"})},"bus afterRender":function(e){var t=e.data.element,i=t.find("a");i.removeAttr("href"),t.find("[role=attachment]").removeAttr("role"),$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!0),$("body").addClass("print-mode")}})}),define("tau/components/component.application",["Underscore","jQuery","tau/components/component.application.generic","tau/services/service.navigator","tau/ui/extensions/page/ui.extension.page.print","libs/parseUri","tau/configurations/const.page.entity.actions"],function(e,t,i,n,a,r,s){return{create:function(o){var l=o.context.configurator;l.registerService("navigator",new n(l,{parameterName:o.options.applicationId||null}));var u="entity component",c=function(e,t,i){taus.track({"@":["--save-last-view-entity-context"],action:"view entity",name:"view "+e+" #"+t,tags:["view entity"],type:e,id:t});var n=taus.start("statistics_view",{"@":["--add-last-view-entity-context",function(e){var t="@timing";return e.loadTime=e[t],delete e[t],e}],entity:{id:t,type:e.toLowerCase()}});this.resolve({entity:{id:parseInt(t,10),type:e},action:i,handlers:{onPageLoaded:function(){n.stop()}}})},d=function(i,n,a){var r=this.configurator,s=r.getStore(),o=r.getBoardSettingsFactory().createComponentSettings({id:"project"}),l=t.Deferred();
s.find("projectmember",{id:n,fields:[{project:["id"]}]}).done({success:function(t){var i=e.find(t[0].data[0],function(e){return e.id==n});l.resolve(i&&i.project?i.project.id:n)},failure:function(){l.resolve(n)}});var u=t.Deferred();o.set({set:{generalTab:"people"},callback:function(){u.resolve()}});var d=c.bind(this);t.when(l,u).done(function(e){d("project",e,a)})},p=function(t,i,n){var a="projectmember"==t.toLowerCase()?d:c;e.bind(a,this)(t,i,n||s.SHOW)};return o.routes=[{pattern:/^$/,adapter:function(){var e=this.configurator.getRouting().getReferer();e?this.configurator.service("navigator").to(e):this.fire("application.exit")},host:{name:"empty_host",type:"master.empty"},type:{name:u,type:"page.entity"}},{pattern:/finish-(\w+)\/([0-9]+)/,adapter:function(e,t){this.resolve({entity:{id:parseInt(t,10),type:e},applicationClassName:"tau-info-popup"})},host:{name:"empty_host",type:"master.empty"},type:{name:"entity component",type:"page.finish-iteration"}},{pattern:/(\w+)\/([0-9]+)($|\s|&)/,adapter:function(t,i){e.bind(p,this)(t,i)},host:{name:"empty_host",type:"master.empty"},type:{name:u,type:"page.entity"}},{pattern:new RegExp("(\\w+)\\/([0-9]+)\\/"+s.SILENT),adapter:function(t,i){e.bind(p,this)(t,i)},host:{name:"empty_host",type:"master.empty",turnOffLoadingIndicator:!0},type:{name:u,type:"page.entity",turnOffLoadingIndicator:!0}},{pattern:new RegExp("(\\w+)\\/([0-9]+)\\/"+s.PRINT),adapter:function(t,i){var n=r(window.location.href);"Print.aspx"==n.file?e.bind(p,this)(t,i,s.PRINT):this.configurator.service("navigator").to("#"+t+"/"+i)},host:{name:"empty_host",type:"master.empty"},type:{name:u,type:"page.entity",hostClassName:"tau-page-entity",extensions:[a]}},{pattern:/(\w+)\/([0-9]+)\/(\w+)[&|]*.*/,adapter:function(t,i,n){e.bind(p,this)(t,i,n)},host:{name:"empty_host",type:"master.empty"},type:{name:u,type:"page.entity",hostClassName:"tau-page-entity"}}],i.create(o)}}}),define("tau/models/model.iteration.progressBar",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({name:"Iteration Progress Bar",afterSaveRoleEffort:function(){this.fire("roleEffortChanged")
},onDataUpdate:function(){this.fire("refresh")},floatToString:function(e){return e.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},_getDefaultFields:function(){return["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"]},onInit:function(){var t=this.config.context.entity,i=t.entityType.name,n=t.id,a=this._getDefaultFields();this.store.unbind(this),this.store.on({eventName:"afterSave",type:"roleEffort",listener:this,filter:{assignable:{id:n}}},e.bind(this.afterSaveRoleEffort,this)),this.store.on({eventName:"afterSave",type:i,listener:this,filter:{id:n},hasChanges:[a.join("|")]},e.bind(this.onDataUpdate,this));var r={id:n,fields:a};this.store.get(i,r,{success:this.safeCallback(this.onEntityRetrieved)}).done({success:this.safeCallback(this.done)})},calculatePercentCompleted:function(){var e=Math.round(100*parseFloat(this.effortToDo)+100*parseFloat(this.effortCompleted))/100,t=Math.round(1e4*(this.effortCompleted/e))/100;t=isNaN(t)?0:t,t=t>100?100:t,this.percentCompleted=t},onEntityRetrieved:function(e){var t=e.data,i=t["bugs-effortToDo-sum"]+t["userStories-effortToDo-sum"],n=t["bugs-effortCompleted-sum"]+t["userStories-effortCompleted-sum"];this.effortToDo=i,this.effortCompleted=n,this.calculatePercentCompleted()},done:function(){this.fire("dataBind",{effortToDo:this.floatToString(this.effortToDo),effortCompleted:this.floatToString(this.effortCompleted),percentCompleted:this.percentCompleted,totalEffort:this.floatToString(this.effortToDo+this.effortCompleted),point:this._getEffortPoints()})}});return i}),define("tau/ui/templates/label/ui.template.assignmentEffort.label",["tau/core/templates-factory"],function(e){var t={name:"assignment-effort-label",markup:['<div><span class="property"><span class="effort">${totalEffort}&nbsp;${point}</span></span>']};return e.register(t)}),define("tau/components/component.assignedEffort",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/label/ui.template.assignmentEffort.label"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};
return e.create(a,n)}}}),define("tau/ui/templates/inviter/ui.template.inviter.widget.members",["tau/core/templates-factory"],function(e){var t={name:"inviter.widget.members",engine:"jqote2",markup:['<div class="tau-invite-field i-role-members-widget">','<ul class="tau-invite-field__inner">','<li class="tau-inputholder">',"<div>",'<input class="tau-input i-role-input" type="text" />','<span class="tau-input-sizer i-role-sizer"></span>','<span class="tau-input-systemhelper i-role-placeholder">',"Start typing name(s) or email(s)","</span>",'<span class="tau-input-systemhelper i-role-systemhelper"><s></s><span></span></span>',"</div>","</li>","</ul>","</div>"]};return e.register(t)}),define("tau/ui/extensions/user/jquery.tauUserAutocomplete",["Underscore","jQuery","tau/core/templates-factory","tau/utils/utils.convertUserName"],function(e,t,i,n){var a={position:{my:"left top",at:"left bottom+5",collision:"none"},rejectUserIdsGetter:function(){return[]},itemRenderer:{_itemTemplate:null,renderItem:function(e){return this._itemTemplate||(this._itemTemplate=i.register({name:"ui.tauUsersAutocomplete.item",engine:"jqote2",markup:["<li>",'<a class="tau-item">','<img width="20" height="20" alt="" src="<%= this.avatarUri%>20" />',"<span><%! this.name %></span>","</a>","</li>"]})),this._itemTemplate.render(e)}},itemLoadingRenderer:{_itemTemplate:null,renderItem:function(e){return this._itemTemplate||(this._itemTemplate=i.register({name:"ui.tauUsersAutocomplete.item.loading",engine:"jqote2",markup:['<li  class="tau-menu-item">','<a class="tau-item tau-loader">',"</a>","</li>"]})),this._itemTemplate.render(e)}}};return t.widget("ui.tauUserAutocomplete",t.ui.autocomplete,{options:{store2:null,minLength:2,autoFocus:!0,showLoading:!1,autocompleteQueryAdd:"",autocompleteFieldsQueryAdd:"",autocompleteTakeQueryAdd:"",position:a.position,delayLoading:250,userTypes:["User"],rejectUserIdsGetter:a.rejectUserIdsGetter,itemRenderer:a.itemRenderer,itemLoadingRenderer:a.itemLoadingRenderer,focus:function(){return!1
},source:function(t,i){if(" "!=e.last(t.term)){var n=e.last(e.compact(e.trim(t.term).split(/[\s,]+/)))||"",a=null;this.options.showLoading&&(a=e.delay(function(){i([{isLoading:!0}])},this.options.delayLoading)),this._trigger("found",null,{term:"",items:[]}),this._getData(n).done(e.bind(function(e){e.length?(e=this._processItems(e,n),this._trigger("found",null,{term:n,items:e})):(this.close(),this._trigger("nothing",null,{term:n})),i(e)},this)).fail(function(){i([])}).always(function(){clearTimeout(a)})}}},_create:function(){this._super()},_getData:function(i){var n="?select={"+["id",'"User" as __type',"firstName","lastName","email","login","avatarUri"].join(",")+this.options.autocompleteFieldsQueryAdd+"}&where=("+this._getUserIdsQueryFilter()+'(firstName.startsWith("'+this.options.store2.arg(i)+'")  OR lastName.startsWith("'+this.options.store2.arg(i)+'")  OR email.startsWith("'+this.options.store2.arg(i)+'")) '+this.options.autocompleteQueryAdd+" AND deleteDate == NULL AND isActive == True )"+this.options.autocompleteTakeQueryAdd,a=e.map(this.options.userTypes,function(e){return this.options.store2.findAll(e+n)},this);return t.when.all(a).then(function(t){return e.flatten(t)})},_getUserIdsQueryFilter:function(){var e=this.options.rejectUserIdsGetter();return e&&e.length>0?"(not (id in ["+e.join(",")+"])) AND ":""},_renderMenu:function(i,n){t(i).addClass("tau-user-autocomplete").css({maxHeight:.5*t(window).height(),zIndex:this.element.zIndex()+1}),e.each(n,e.bind(function(e){this._renderItem(i,e)},this))},_renderItem:function(e,t){var i=t.isLoading?this.options.itemLoadingRenderer:this.options.itemRenderer;return i.renderItem(t).data("ui-autocomplete-item",t).appendTo(e)},_processItems:function(t,i){var a=i.toLowerCase();return e.chain(t).map(e.bind(function(e){return e.name=n.getFullName(e),e},this)).sortBy(function(t){var i=t.name.toLowerCase();return(e.startsWith(i,a)?"0":"1")+i}).value()}})}),define("tau/ui/extensions/inviter/jquery.tauInviter",["Underscore","jQuery","tau/core/class","tau/libs/store2/store2","tau/utils/utils.constants","tau/ui/templates/inviter/ui.template.inviter.widget.members","tau/ui/extensions/user/jquery.tauUserAutocomplete"],function(e,t,i,n,a,r){var s=i.extend({init:function(t){this.options=e.defaults(e.extend({},t),{allowEmails:!1}),this.data=[]
},_containsUser:function(t){return e.some(this.data,function(e){return t.id&&e.id==t.id||e.email===t.email})},add:function(e){return this._containsUser(e)?!1:(this.data.push(e),!0)},addBatch:function(t){e.map(t,this.add,this)},addByString:function(t){var i=this.split(e.trim(t)),n=[],a=[];return e.forEach(i,e.bind(function(e){if(this.options.allowEmails&&this.isEmail(e)){var t={id:null,email:e,name:e,firstName:null,lastName:null,login:e,type:"invited",state:"notconfirmed"};this.add(t)&&a.push(t)}else n.push(e)},this)),{items:a,rest:n.join(" ")}},split:function(t){return e.compact(e.trim(t).split(/[\s,]+/))},remove:function(t){this.data=e.reject(this.data,function(e){return e.id==t.id})},isEmpty:function(){return!this.data.length},getAll:function(){return this.data},isEmail:function(e){return e.match(a.get("emailRegexp"))}});return t.widget("ui.tauInviter",{options:{configurator:null,autocompleteQueryAdd:"",autocompleteFieldsQueryAdd:"",autocompletePosition:{},messagePosition:{},allowEmails:!1,minLength:2,bubblesAppendTo:null,processItems:null,canDelete:function(){return!0},reforwardingOption:["autocompleteQueryAdd","autocompleteFieldsQueryAdd","minLength","autocompleteTakeQueryAdd","showLoading"]},_setOption:function(t,i){"reforwardingOption"===t&&(i=this.options.reforwardingOption.concat(i)),e.contains(this.options.reforwardingOption,t)&&this.$inp.tauUserAutocomplete("option",t,i),this._super(t,i)},_create:function(){this.configurator=this.options.configurator,this.$el=this.element,this.openInnerBubble=!1,this.model=new s({allowEmails:this.options.allowEmails}),this._initTemplates(),this._initWidget()},_initTemplates:function(){var e=this.configurator.getTemplateFactory();e.register({name:"board.context.filter.members-widget.selectedItem",engine:"jqote2",markup:["<li class=\"tau-user tau-user-<%! this.type || 'existing' %> i-role-member\">","<% if (this.avatarUri) { %>",'<img class="tau-user__avatar" width="20" height="20" alt="" src="<%= this.avatarUri%>20" />',"<% } %>",'<span class="tau-user__name"><%! this.name %></span>','<i class="tau-delete i-role-action-delete"></i>',"</li>"]}),e.register({name:"board.context.filter.members-widget.popupContent",engine:"jqote2",markup:["<span><%! this.main %></span>","<% if (this.sub) { %>",'<div class="tau-message <%! this.type %>"><%! this.sub %></div>',"<% } %>"]})
},_initWidget:function(){this.$widget=this.configurator.getTemplateFactory().get(r.name).bind({},{}),this.$el.hide(),this.$el.after(this.$widget);var i=this.$widget,n=i.find(".i-role-input");this.$inp=n,this.$inpLi=n.closest("li"),this.$helper=i.find(".i-role-systemhelper"),this.$sizer=i.find(".i-role-sizer"),this.$placeholder=i.find(".i-role-placeholder");var a=this.$el.attr("placeholder");a&&this.$placeholder.text(a),this.initBubbled(),i.on("click",function(){n.focus()}),i.on("click",".i-role-action-delete",e.bind(function(e){var i=t(e.currentTarget).closest("li");this.removeItem(i,function(){this.$placeholder.toggle(this.model.isEmpty())}.bind(this))},this)),i.on("process",e.bind(this.processInput,this,!1)),this.initInput(),this.initAutocomplete()},initBubbled:function(){var t=e.defaults(this.options.messagePosition,{my:"left top",at:"left bottom+5",collision:"none"});this.$bubbled=this.$widget.tauBubble({template:['<div class="tau-invite-widget-tooltip">','    <div class="i-role-content" role="content"></div>',"</div>"].join(""),stackName:"members-widget",showEvent:"nothing",hideEvent:"nothing",appendTo:this.options.bubblesAppendTo,onPositionConfig:function(i){return e.extend(i,t)}})},initInput:function(){var i=(this.$helper,this.$placeholder),n=this.$inp;n.on("input",function(){i.hide()}),this.model.isEmpty()||i.hide(),n.focusin(e.bind(function(){this.model.isEmpty()||i.hide(),this.hideMessage()},this)),n.focusout(e.bind(function(){""===n.val()&&this.model.isEmpty()&&i.show()},this)),n.on("keydown",function(e){var i="";switch(e.which){case t.ui.keyCode.ESCAPE:if(this.openInnerBubble)return this.hideMessage(),e.stopPropagation(),e.preventDefault(),!1;break;case t.ui.keyCode.ENTER:if(i="enter",""===n.val())return;e.stopPropagation(),e.preventDefault();break;case t.ui.keyCode.BACKSPACE:i="backspace";break;case t.ui.keyCode.SPACE:i="whitespace"}return i&&(n.trigger("keydown:"+i,e),"enter"==i)?!1:void 0}.bind(this)),n.on("keydown:enter",e.bind(function(){this.processInput(),this.resetSize()
},this)),n.on("keydown:whitespace",e.bind(function(){this.processInput(),n.tauUserAutocomplete("close"),this.hideMessage()},this)),n.on("keydown:backspace",e.bind(function(){if(!n.val().length){var e=n.closest("li").prev();this.removeItem(e,function(){this.resetSize()}.bind(this))}this.hideMessage()},this)),n.on("keyup",e.bind(function(){this.refreshHelper(),this.syncSize()},this)),n.on("paste",e.bind(function(){setTimeout(e.bind(function(){this.processInput(),this.syncSize()},this),1)},this))},setValue:function(e){this.model.data=[],this.model.addBatch(e),this.syncFromModel()},syncFromModel:function(){this.$widget.find(".i-role-member").remove(),this.addItems(this.model.getAll()),this.$placeholder.toggle(this.model.isEmpty())},addItems:function(t){e.forEach(t,e.bind(function(e){var t=this.createItem(e);this.$inpLi.before(t)},this))},getValue:function(e){return e&&this.processInput(),this.model.data},processInput:function(e){var t=this.$inp.val();if(t.length>0){var i=this.model.addByString(t);this.addItems(i.items),this.$inp.val(i.rest),e!==!1&&this.$inp.focus(),this.emptyHelper(),this.hideMessage(),this._trigger("change")}},showMessage:function(e){var t=this.bt("board.context.filter.members-widget.popupContent",e);this.$bubbled.tauBubble("option","content",t).tauBubble("option","alignTo",this.$inp).tauBubble("show"),this.openInnerBubble=!0},hideMessage:function(){this.$bubbled.data("ui-tauBubble")&&this.$bubbled.tauBubble("hide"),this.openInnerBubble=!1},split:function(t){return e.compact(e.trim(t).split(/[\s,]+/))},resultBubble:function(t){var i=e.last(this.split(t));if(i&&i.length>=this.options.minLength||0===t.length&&0===this.options.minLength){var n;n=this.options.allowEmails?this.isEmail(i)?{main:"The invitation will be sent to",sub:i,type:"tau-valid"}:{main:"There's no one with this name. Please, enter the email address of the person you want to invite.",sub:i+" is invalid email",type:"tau-error"}:{main:"There's no one with this name or email.",sub:"",type:"tau-error"},this.showMessage(n)
}else this.hideMessage()},refreshHelper:function(t){t=t||""===t?t:this.$helper.text();var i=this.$inp.val();if(i&&e.startsWith(t.toLowerCase(),i.toLowerCase())){var n=t.slice(i.length);this.$helper.find("s").text(i),this.$helper.find("span").text(n)}else this.emptyHelper()},emptyHelper:function(){this.$helper.find("s").text(""),this.$helper.find("span").text("")},syncSize:function(){var e=this.$widget.width()-10;this.$sizer.text(this.$inp.val());var t=this.$sizer.width();if(!(t<=this.$inp.width()-8)){var i=this.$inp[0].getBoundingClientRect().left,n=e-i,a=n;e>t&&(a=n>t?n:e),this.$inp.width()!=a&&this.$inp.width(a)}},resetSize:function(){this.$inp.width("10")},bt:function(e,t){return this.configurator.getTemplateFactory().get(e).bind({},t)},createItem:function(e){return this.bt("board.context.filter.members-widget.selectedItem",e).data("id",e.id)},removeItem:function(e,t){var i=e.data();this.options.canDelete(i)&&(this.model.remove(i),this._trigger("change"),e.remove(),t())},initAutocomplete:function(){var t=e.defaults(this.options.autocompletePosition,{my:"left top",at:"left bottom",collision:"none"});if(this.$inp.tauUserAutocomplete({store2:new n(this.configurator),autocompleteQueryAdd:this.options.autocompleteQueryAdd,appendTo:this.options.bubblesAppendTo,rejectUserIdsGetter:e.bind(function(){return e.compact(e.pluck(this.model.getAll(),"id"))},this),focus:e.bind(function(e,t){return this.refreshHelper(t.item.name),!1},this),open:function(){this.openInnerBubble=!0}.bind(this),position:t,select:e.bind(function(e,t){var i=t.item;if(i.isLoading)return!1;this.model.add(i),this._trigger("change");var n=this.createItem(i);return this.$inpLi.before(n),this.$inp.val(""),this.emptyHelper(),this.hideMessage(),!1},this),close:e.bind(function(){this.emptyHelper(),this.openInnerBubble=!1},this),found:e.bind(function(){this.hideMessage()},this),nothing:e.bind(function(e,t){this.resultBubble(t.term)},this)}),this.options.processItems){var i=this.$inp.data("ui-tauUserAutocomplete");
i._processItems=e.wrap(i._processItems,this.options.processItems)}},widget:function(){return this.$widget},isEmail:function(e){return e.match(a.get("emailRegexp"))},reset:function(){this.model.data=[],this.syncFromModel()}})}),define("tau/ui/extensions/assignments/ui.extension.assignments",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/inviter/jquery.tauInviter"],function(e,t,i){return i.extend({init:function(e,t,i,n,a,r){return this.model=n,this.configurator=t,this.templateForm=a,this.entity=i,this.$within=r||window,0===this.$within.length&&(this.$within=window),this._super(e)},"bus beforeInit":function(){t.when(this.model.load()).then(e.bind(function(e){this.fire("dataBind",{groups:e})},this))},"bus afterRender":function(i,n){var a=n.element;a.on("click",".i-role-formtrigger",e.bind(function(i){var n=t(i.currentTarget);t.when(this.closeFormAll(a,n)).then(e.bind(this.startEdit,this,n,a))},this)),a.on("click","form",e.bind(function(e){e.stopPropagation()},this)),1==this.model.groups.length&&this.startEdit(a.find(".i-role-formtrigger"),a)},startEdit:function(i,n){return i.hasClass("tau-assignments__group_state_edit")?void this.closeForm(i,i.find("form")):t.when(this.createForm(i,n)).then(e.bind(this.appendFormToGroup,this,i)).then(e.bind(this.handleForm,this,i)).then(this.domModified.bind(this))},domModified:function(){this.fire("dom.modified")},handleForm:function(t,i){i.on("submit",e.bind(function(e){e.preventDefault();var n=this.serializeForm(i);return this.model.processFormData(n),1==this.model.groups.length?(this.fire("complete"),!1):(this.closeForm(t,i),!1)},this))},serializeForm:function(t){var i=t.serializeArray();return i=e.object(e.pluck(i,"name"),e.pluck(i,"value")),i.users=t.find("[name=users]").tauInviter("getValue"),i},createForm:function(i,n){var a=i.data("id"),r=this.model.findGroupById(a),s=this.configurator.getTemplateFactory().get(this.templateForm.name).bind({},{data:{roleId:r.role.id,groupId:r.id,users:r.users}}),o=s.find("[name=users]");
return o.tauInviter({configurator:this.configurator,allowEmails:!1,autocompletePosition:{my:"left top",at:"left bottom",collision:"flipfit flipfit",within:this.$within},messagePosition:{my:"left top",at:"left bottom+5",collision:"flipfit flipfit",within:this.$within},bubblesAppendTo:n,processItems:function(t,i,n){var a=function(e){var t=e.projectRoles&&e.projectRoles[0],i=e.teamRoles&&e.teamRoles[0];return(t||i)!==r.role.id},s=function(e,t){return t},o=function(e,i){return e.concat(t(i,n))};return e.chain(i).groupBy(a).sortBy(s).reduce(o,[]).value()}}),o.tauInviter("setValue",r.users),o.on("tauinviterchange",e.bind(function(){s.find(":text").trigger("focus"),this.fire("assignment.editor.saving"),this.model.processFormData(this.serializeForm(s)).then(this.fire.bind(this,"assignment.editor.saved")).then(this.domModified.bind(this))},this)),t.when(this.createAutocompleteQuery()).then(e.bind(function(e){o.length&&o.data("ui-tauInviter")&&o.tauInviter("option",{autocompleteQueryAdd:e.where,autocompleteFieldsQueryAdd:e.select,minLength:0,showLoading:!0,autocompleteTakeQueryAdd:"&take=1000"})},this)),{$form:s,$inviter:o}},createAutocompleteQuery:function(){var i=t.Deferred();return this.configurator.getStore().get(this.entity.entityType.name,{id:this.entity.id,fields:["id",{project:["id"]},{team:["id"]}]}).done(function(t){var n=t[0].data,a=[],r="",s=[],o="";n.project&&n.project.id&&(a.push(e.sprintf("ProjectMembers.Count(project.id==%d) > 0 ",n.project.id)),s.push(e.sprintf("ProjectMembers.Where(Project.Id==%d).Select(Role.id) as projectRoles",n.project.id))),n.team&&n.team.id&&(a.push(e.sprintf("TeamMembers.Count(team.id==%d) > 0",n.team.id)),s.push(e.sprintf("TeamMembers.Where(Team.Id==%d).Select(Role.id) as teamRoles",n.team.id))),a.length&&(r=" AND ("+a.join(" OR ")+")"),s.length&&(o=","+s.join(",")),i.resolve({where:r,select:o})}),i},appendFormToGroup:function(t,i){t.toggleClass("tau-assignments__group_state_edit",!0),t.append(i.$form);var n=i.$form.find(":text");this.domModified();
var a=e.debounce(function(){n.data("ui-tauUserAutocomplete")&&n.tauUserAutocomplete("search",n.val())},100);return n.on("focus",a),n.focus(),i.$form},closeForm:function(e,t){t.remove(),e.toggleClass("tau-assignments__group_state_edit",!1),this.domModified()},closeFormAll:function(i,n){i.find(".i-role-group").not(n).each(e.bind(function(e,i){var n=t(i);this.closeForm(n,n.find("form"))},this))}})}),function(){var e,t,i,n,a=function(e,t){return function(){return e.apply(t,arguments)}},r=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1},s=[].slice,o={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e={binders:{},components:{},formatters:{},adapters:{},config:{prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,handler:function(e,t,i){return this.call(e,t,i.view.models)}}},"jQuery"in window?(n="on"in jQuery.prototype?["on","off"]:["bind","unbind"],t=n[0],i=n[1],e.Util={bindEvent:function(e,i,n){return jQuery(e)[t](i,n)},unbindEvent:function(e,t,n){return jQuery(e)[i](t,n)},getInputValue:function(e){var t;return t=jQuery(e),"checkbox"===t.attr("type")?t.is(":checked"):t.val()}}):e.Util={bindEvent:function(){return"addEventListener"in window?function(e,t,i){return e.addEventListener(t,i,!1)}:function(e,t,i){return e.attachEvent("on"+t,i)}}(),unbindEvent:function(){return"removeEventListener"in window?function(e,t,i){return e.removeEventListener(t,i,!1)}:function(e,t,i){return e.detachEvent("on"+t,i)}}(),getInputValue:function(e){var t,i,n,a;if("checkbox"===e.type)return e.checked;if("select-multiple"===e.type){for(a=[],i=0,n=e.length;n>i;i++)t=e[i],t.selected&&a.push(t.value);return a}return e.value}},e.View=function(){function t(t,i,n){var r,s,o,l,u,c,d,p,f;for(this.els=t,this.models=i,this.options=null!=n?n:{},this.update=a(this.update,this),this.publish=a(this.publish,this),this.sync=a(this.sync,this),this.unbind=a(this.unbind,this),this.bind=a(this.bind,this),this.select=a(this.select,this),this.build=a(this.build,this),this.componentRegExp=a(this.componentRegExp,this),this.bindingRegExp=a(this.bindingRegExp,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),d=["config","binders","formatters","adapters"],u=0,c=d.length;c>u;u++){if(s=d[u],this[s]={},this.options[s]){p=this.options[s];
for(r in p)o=p[r],this[s][r]=o}f=e[s];for(r in f)o=f[r],null==(l=this[s])[r]&&(l[r]=o)}this.build()}return t.prototype.bindingRegExp=function(){return new RegExp("^"+this.config.prefix+"-")},t.prototype.componentRegExp=function(){return new RegExp("^"+this.config.prefix.toUpperCase()+"-")},t.prototype.build=function(){var t,i,n,a,s,o,l,u,c,d=this;for(this.bindings=[],o=[],t=this.bindingRegExp(),n=this.componentRegExp(),i=function(t,i,n,a){var r,s,o,l,u,c,p;return u={},p=function(){var e,t,i,n;for(i=a.split("|"),n=[],e=0,t=i.length;t>e;e++)c=i[e],n.push(c.trim());return n}(),r=function(){var e,t,i,n;for(i=p.shift().split("<"),n=[],e=0,t=i.length;t>e;e++)s=i[e],n.push(s.trim());return n}(),l=r.shift(),u.formatters=p,(o=r.shift())&&(u.dependencies=o.split(/\s+/)),d.bindings.push(new e[t](d,i,n,l,u))},s=function(a){var l,u,c,p,f,m,h,g,v,b,y,_,x,w,C,S,T,k,I,D,P,E,R,A,F,M,N,j,L,U;if(r.call(o,a)<0){if(3===a.nodeType){if(g=e.TextTemplateParser,(f=d.config.templateDelimiters)&&(_=g.parse(a.data,f)).length&&(1!==_.length||_[0].type!==g.types.text)){for(C=0,I=_.length;I>C;C++)y=_[C],b=document.createTextNode(y.value),a.parentNode.insertBefore(b,a),1===y.type&&i("TextBinding",b,null,y.value);a.parentNode.removeChild(a)}}else if(n.test(a.tagName))x=a.tagName.replace(n,"").toLowerCase(),d.bindings.push(new e.ComponentBinding(d,a,x));else if(null!=a.attributes){for(F=a.attributes,S=0,D=F.length;D>S;S++)if(l=F[S],t.test(l.name)){if(x=l.name.replace(t,""),!(c=d.binders[x])){M=d.binders;for(m in M)w=M[m],"*"!==m&&-1!==m.indexOf("*")&&(v=new RegExp("^"+m.replace("*",".+")+"$"),v.test(x)&&(c=w))}if(c||(c=d.binders["*"]),c.block){for(N=a.childNodes,T=0,P=N.length;P>T;T++)h=N[T],o.push(h);u=[l]}}for(j=u||a.attributes,k=0,E=j.length;E>k;k++)l=j[k],t.test(l.name)&&(x=l.name.replace(t,""),i("Binding",a,x,l.value))}for(L=function(){var e,t,i,n;for(i=a.childNodes,n=[],t=0,e=i.length;e>t;t++)h=i[t],n.push(h);return n}(),U=[],A=0,R=L.length;R>A;A++)p=L[A],U.push(s(p));return U}},c=this.els,l=0,u=c.length;u>l;l++)a=c[l],s(a)
},t.prototype.select=function(e){var t,i,n,a,r;for(a=this.bindings,r=[],i=0,n=a.length;n>i;i++)t=a[i],e(t)&&r.push(t);return r},t.prototype.bind=function(){var e,t,i,n,a;for(n=this.bindings,a=[],t=0,i=n.length;i>t;t++)e=n[t],a.push(e.bind());return a},t.prototype.unbind=function(){var e,t,i,n,a;for(n=this.bindings,a=[],t=0,i=n.length;i>t;t++)e=n[t],a.push(e.unbind());return a},t.prototype.sync=function(){var e,t,i,n,a;for(n=this.bindings,a=[],t=0,i=n.length;i>t;t++)e=n[t],a.push(e.sync());return a},t.prototype.publish=function(){var e,t,i,n,a;for(n=this.select(function(e){return e.binder.publishes}),a=[],t=0,i=n.length;i>t;t++)e=n[t],a.push(e.publish());return a},t.prototype.update=function(e){var t,i,n,a,r,s,o;null==e&&(e={});for(i in e)n=e[i],this.models[i]=n;for(s=this.bindings,o=[],a=0,r=s.length;r>a;a++)t=s[a],o.push(t.update(e));return o},t}(),e.Binding=function(){function t(e,t,i,n,r){this.view=e,this.el=t,this.type=i,this.keypath=n,this.options=null!=r?r:{},this.update=a(this.update,this),this.unbind=a(this.unbind,this),this.bind=a(this.bind,this),this.publish=a(this.publish,this),this.sync=a(this.sync,this),this.set=a(this.set,this),this.eventHandler=a(this.eventHandler,this),this.formattedValue=a(this.formattedValue,this),this.setBinder=a(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.model=void 0,this.setBinder()}return t.prototype.setBinder=function(){var e,t,i,n;if(!(this.binder=this.view.binders[this.type])){n=this.view.binders;for(e in n)i=n[e],"*"!==e&&-1!==e.indexOf("*")&&(t=new RegExp("^"+e.replace("*",".+")+"$"),t.test(this.type)&&(this.binder=i,this.args=new RegExp("^"+e.replace("*","(.+)")+"$").exec(this.type),this.args.shift()))}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},t.prototype.formattedValue=function(e){var t,i,n,a,r,o;for(o=this.formatters,a=0,r=o.length;r>a;a++)i=o[a],t=i.split(/\s+/),n=t.shift(),i=this.view.formatters[n],(null!=i?i.read:void 0)instanceof Function?e=i.read.apply(i,[e].concat(s.call(t))):i instanceof Function&&(e=i.apply(null,[e].concat(s.call(t))));
return e},t.prototype.eventHandler=function(e){var t,i;return i=(t=this).view.config.handler,function(n){return i.call(e,this,n,t)}},t.prototype.set=function(e){var t;return e=this.formattedValue(e instanceof Function&&!this.binder["function"]?e.call(this.model):e),null!=(t=this.binder.routine)?t.call(this,this.el,e):void 0},t.prototype.sync=function(){var t,i,n,a,r,s,o,l,u;if(this.model!==this.observer.target){for(o=this.dependencies,n=0,r=o.length;r>n;n++)i=o[n],i.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(l=this.options.dependencies)?l.length:void 0))for(u=this.options.dependencies,a=0,s=u.length;s>a;a++)t=u[a],i=new e.Observer(this.view,this.model,t,this.sync),this.dependencies.push(i)}return this.set(this.observer.value())},t.prototype.publish=function(){var t,i,n,a,r,o,l,u,c;for(a=e.Util.getInputValue(this.el),l=this.formatters.slice(0).reverse(),r=0,o=l.length;o>r;r++)i=l[r],t=i.split(/\s+/),n=t.shift(),(null!=(u=this.view.formatters[n])?u.publish:void 0)&&(a=(c=this.view.formatters[n]).publish.apply(c,[a].concat(s.call(t))));return this.observer.publish(a)},t.prototype.bind=function(){var t,i,n,a,r,s,o;if(null!=(r=this.binder.bind)&&r.call(this,this.el),this.observer=new e.Observer(this.view,this.view.models,this.keypath,this.sync),this.model=this.observer.target,null!=this.model&&(null!=(s=this.options.dependencies)?s.length:void 0))for(o=this.options.dependencies,n=0,a=o.length;a>n;n++)t=o[n],i=new e.Observer(this.view,this.model,t,this.sync),this.dependencies.push(i);return this.view.config.preloadData?this.sync():void 0},t.prototype.unbind=function(){var e,t,i,n,a;for(null!=(n=this.binder.unbind)&&n.call(this,this.el),this.observer.unobserve(),a=this.dependencies,t=0,i=a.length;i>t;t++)e=a[t],e.unobserve();return this.dependencies=[]},t.prototype.update=function(e){var t;return null==e&&(e={}),this.model=this.observer.target,null!=(t=this.binder.update)?t.call(this,e):void 0},t}(),e.ComponentBinding=function(t){function i(t,i,n){var s,o,l,u,c;
for(this.view=t,this.el=i,this.type=n,this.unbind=a(this.unbind,this),this.bind=a(this.bind,this),this.update=a(this.update,this),this.locals=a(this.locals,this),this.component=e.components[this.type],this.attributes={},this.inflections={},u=this.el.attributes||[],o=0,l=u.length;l>o;o++)s=u[o],c=s.name,r.call(this.component.attributes,c)>=0?this.attributes[s.name]=s.value:this.inflections[s.name]=s.value}return l(i,t),i.prototype.sync=function(){},i.prototype.locals=function(e){var t,i,n,a,r,s,o,l,u;null==e&&(e=this.view.models),r={},l=this.inflections;for(i in l)for(t=l[i],u=t.split("."),s=0,o=u.length;o>s;s++)a=u[s],r[i]=(r[i]||e)[a];for(i in e)n=e[i],null==r[i]&&(r[i]=n);return r},i.prototype.update=function(e){var t;return null!=(t=this.componentView)?t.update(this.locals(e)):void 0},i.prototype.bind=function(){var t,i;return null!=this.componentView?null!=(i=this.componentView)?i.bind():void 0:(t=this.component.build.call(this.attributes),(this.componentView=new e.View(t,this.locals(),this.view.options)).bind(),this.el.parentNode.replaceChild(t,this.el))},i.prototype.unbind=function(){var e;return null!=(e=this.componentView)?e.unbind():void 0},i}(e.Binding),e.TextBinding=function(e){function t(e,t,i,n,r){this.view=e,this.el=t,this.type=i,this.keypath=n,this.options=null!=r?r:{},this.sync=a(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[]}return l(t,e),t.prototype.binder={routine:function(e,t){return e.data=null!=t?t:""}},t.prototype.sync=function(){return t.__super__.sync.apply(this,arguments)},t}(e.Binding),e.KeypathParser=function(){function e(){}return e.parse=function(e,t,i){var n,a,s,o,l,u;for(o=[],a={"interface":i,path:""},s=l=0,u=e.length;u>l;s=l+=1)n=e.charAt(s),r.call(t,n)>=0?(o.push(a),a={"interface":n,path:""}):a.path+=n;return o.push(a),o},e}(),e.TextTemplateParser=function(){function e(){}return e.types={text:0,binding:1},e.parse=function(e,t){var i,n,a,r,s,o,l;for(o=[],r=e.length,i=0,n=0;r>n;){if(i=e.indexOf(t[0],n),0>i){o.push({type:this.types.text,value:e.slice(n)});
break}if(i>0&&i>n&&o.push({type:this.types.text,value:e.slice(n,i)}),n=i+t[0].length,i=e.indexOf(t[1],n),0>i){s=e.slice(n-t[1].length),a=o[o.length-1],(null!=a?a.type:void 0)===this.types.text?a.value+=s:o.push({type:this.types.text,value:s});break}l=e.slice(n,i).trim(),o.push({type:this.types.binding,value:l}),n=i+t[1].length}return o},e}(),e.Observer=function(){function t(e,t,i,n){this.view=e,this.model=t,this.keypath=i,this.callback=n,this.unobserve=a(this.unobserve,this),this.realize=a(this.realize,this),this.value=a(this.value,this),this.publish=a(this.publish,this),this.read=a(this.read,this),this.set=a(this.set,this),this.adapter=a(this.adapter,this),this.update=a(this.update,this),this.initialize=a(this.initialize,this),this.parse=a(this.parse,this),this.parse(),this.initialize()}return t.prototype.parse=function(){var t,i,n,a,s,o;return t=function(){var e,t;e=this.view.adapters,t=[];for(i in e)s=e[i],t.push(i);return t}.call(this),o=this.keypath[0],r.call(t,o)>=0?(a=this.keypath[0],n=this.keypath.substr(1)):(a=this.view.config.rootInterface,n=this.keypath),this.tokens=e.KeypathParser.parse(n,t,a),this.key=this.tokens.pop()},t.prototype.initialize=function(){return this.objectPath=[],this.target=this.realize(),null!=this.target?this.set(!0,this.key,this.target,this.callback):void 0},t.prototype.update=function(){var e,t;return(e=this.realize())!==this.target&&(null!=this.target&&this.set(!1,this.key,this.target,this.callback),null!=e&&this.set(!0,this.key,e,this.callback),t=this.value(),this.target=e,this.value()!==t)?this.callback():void 0},t.prototype.adapter=function(e){return this.view.adapters[e["interface"]]},t.prototype.set=function(e,t,i,n){var a;return a=e?"subscribe":"unsubscribe",this.adapter(t)[a](i,t.path,n)},t.prototype.read=function(e,t){return this.adapter(e).read(t,e.path)},t.prototype.publish=function(e){return null!=this.target?this.adapter(this.key).publish(this.target,this.key.path,e):void 0},t.prototype.value=function(){return null!=this.target?this.read(this.key,this.target):void 0
},t.prototype.realize=function(){var e,t,i,n,a,r,s,o;for(e=this.model,a=null,o=this.tokens,t=r=0,s=o.length;s>r;t=++r)n=o[t],null!=e?(null!=this.objectPath[t]?e!==(i=this.objectPath[t])&&(this.set(!1,n,i,this.update),this.set(!0,n,e,this.update),this.objectPath[t]=e):(this.set(!0,n,e,this.update),this.objectPath[t]=e),e=this.read(n,e)):(null==a&&(a=t),(i=this.objectPath[t])&&this.set(!1,n,i,this.update));return null!=a&&this.objectPath.splice(a),e},t.prototype.unobserve=function(){var e,t,i,n,a,r;for(r=this.tokens,e=n=0,a=r.length;a>n;e=++n)i=r[e],(t=this.objectPath[e])&&this.set(!1,i,t,this.update);return null!=this.target?this.set(!1,this.key,this.target,this.callback):void 0},t}(),e.binders.text=function(e,t){return null!=e.textContent?e.textContent=null!=t?t:"":e.innerText=null!=t?t:""},e.binders.html=function(e,t){return e.innerHTML=null!=t?t:""},e.binders.show=function(e,t){return e.style.display=t?"":"none"},e.binders.hide=function(e,t){return e.style.display=t?"none":""},e.binders.enabled=function(e,t){return e.disabled=!t},e.binders.disabled=function(e,t){return e.disabled=!!t},e.binders.checked={publishes:!0,bind:function(t){return e.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return e.Util.unbindEvent(t,"change",this.publish)},routine:function(e,t){var i;return e.checked="radio"===e.type?(null!=(i=e.value)?i.toString():void 0)===(null!=t?t.toString():void 0):!!t}},e.binders.unchecked={publishes:!0,bind:function(t){return e.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return e.Util.unbindEvent(t,"change",this.publish)},routine:function(e,t){var i;return e.checked="radio"===e.type?(null!=(i=e.value)?i.toString():void 0)!==(null!=t?t.toString():void 0):!t}},e.binders.value={publishes:!0,bind:function(t){return e.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return e.Util.unbindEvent(t,"change",this.publish)},routine:function(e,t){var i,n,a,s,o,l,u;if(null!=window.jQuery){if(e=jQuery(e),(null!=t?t.toString():void 0)!==(null!=(s=e.val())?s.toString():void 0))return e.val(null!=t?t:"")
}else if("select-multiple"===e.type){if(null!=t){for(u=[],n=0,a=e.length;a>n;n++)i=e[n],u.push(i.selected=(o=i.value,r.call(t,o)>=0));return u}}else if((null!=t?t.toString():void 0)!==(null!=(l=e.value)?l.toString():void 0))return e.value=null!=t?t:""}},e.binders["if"]={block:!0,bind:function(e){var t,i;return null==this.marker?(t=[this.view.config.prefix,this.type].join("-").replace("--","-"),i=e.getAttribute(t),this.marker=document.createComment(" rivets: "+this.type+" "+i+" "),e.removeAttribute(t),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e)):void 0},unbind:function(){var e;return null!=(e=this.nested)?e.unbind():void 0},routine:function(t,i){var n,a,r,s,o;if(!!i==(null==this.nested)){if(i){r={},o=this.view.models;for(n in o)a=o[n],r[n]=a;return s={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:this.view.options.config},(this.nested=new e.View(t,r,s)).bind(),this.marker.parentNode.insertBefore(t,this.marker.nextSibling)}return t.parentNode.removeChild(t),this.nested.unbind(),delete this.nested}},update:function(e){var t;return null!=(t=this.nested)?t.update(e):void 0}},e.binders.unless={block:!0,bind:function(t){return e.binders["if"].bind.call(this,t)},unbind:function(){return e.binders["if"].unbind.call(this)},routine:function(t,i){return e.binders["if"].routine.call(this,t,!i)},update:function(t){return e.binders["if"].update.call(this,t)}},e.binders["on-*"]={"function":!0,unbind:function(t){return this.handler?e.Util.unbindEvent(t,this.args[0],this.handler):void 0},routine:function(t,i){return this.handler&&e.Util.unbindEvent(t,this.args[0],this.handler),e.Util.bindEvent(t,this.args[0],this.handler=this.eventHandler(i))}},e.binders["each-*"]={block:!0,bind:function(e){var t;return null==this.marker?(t=[this.view.config.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],e.removeAttribute(t),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e)):void 0
},unbind:function(){var e,t,i,n,a;if(null!=this.iterated){for(n=this.iterated,a=[],t=0,i=n.length;i>t;t++)e=n[t],a.push(e.unbind());return a}},routine:function(t,i){var n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b,y,_,x,w,C,S,T,k;if(c=this.args[0],i=i||[],this.iterated.length>i.length)for(w=Array(this.iterated.length-i.length),g=0,y=w.length;y>g;g++)r=w[g],h=this.iterated.pop(),h.unbind(),this.marker.parentNode.removeChild(h.els[0]);for(s=v=0,_=i.length;_>v;s=++v)if(u=i[s],a={index:s},a[c]=u,null==this.iterated[s]){C=this.view.models;for(l in C)u=C[l],null==a[l]&&(a[l]=u);p=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,d={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:{}},S=this.view.options.config;for(o in S)m=S[o],d.config[o]=m;d.config.preloadData=!0,f=t.cloneNode(!0),h=new e.View(f,a,d),h.bind(),this.iterated.push(h),this.marker.parentNode.insertBefore(f,p.nextSibling)}else this.iterated[s].models[c]!==u&&this.iterated[s].update(a);if("OPTION"===t.nodeName){for(T=this.view.bindings,k=[],b=0,x=T.length;x>b;b++)n=T[b],k.push(n.el===this.marker.parentNode&&"value"===n.type?n.sync():void 0);return k}},update:function(e){var t,i,n,a,r,s,o,l;t={};for(i in e)n=e[i],i!==this.args[0]&&(t[i]=n);for(o=this.iterated,l=[],r=0,s=o.length;s>r;r++)a=o[r],l.push(a.update(t));return l}},e.binders["class-*"]=function(e,t){var i;return i=" "+e.className+" ",!t==(-1!==i.indexOf(" "+this.args[0]+" "))?e.className=t?""+e.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim():void 0},e.binders["*"]=function(e,t){return null!=t?e.setAttribute(this.type,t):e.removeAttribute(this.type)},e.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(e){var t;return null==e[this.id]&&(t=this.counter++,this.weakmap[t]={callbacks:{}},Object.defineProperty(e,this.id,{value:t})),this.weakmap[e[this.id]]},stubFunction:function(e,t){var i,n,a;return n=e[t],i=this.weakReference(e),a=this.weakmap,e[t]=function(){var t,r,s,o,l,u,c,d,p,f;
o=n.apply(e,arguments),c=i.pointers;for(s in c)for(r=c[s],f=null!=(d=null!=(p=a[s])?p.callbacks[r]:void 0)?d:[],l=0,u=f.length;u>l;l++)(t=f[l])();return o}},observeMutations:function(e,t,i){var n,a,s,o,l,u;if(Array.isArray(e)){if(s=this.weakReference(e),null==s.pointers)for(s.pointers={},a=["push","pop","shift","unshift","sort","reverse","splice"],l=0,u=a.length;u>l;l++)n=a[l],this.stubFunction(e,n);if(null==(o=s.pointers)[t]&&(o[t]=[]),r.call(s.pointers[t],i)<0)return s.pointers[t].push(i)}},unobserveMutations:function(e,t,i){var n,a;return Array.isArray(e&&null!=e[this.id])&&(n=null!=(a=this.weakReference(e).pointers)?a[t]:void 0)?n.splice(n.indexOf(i),1):void 0},subscribe:function(e,t,i){var n,a,s=this;return n=this.weakReference(e).callbacks,null==n[t]&&(n[t]=[],a=e[t],Object.defineProperty(e,t,{enumerable:!0,get:function(){return a},set:function(r){var o,l,u;if(r!==a){for(a=r,u=n[t],o=0,l=u.length;l>o;o++)(i=u[o])();return s.observeMutations(r,e[s.id],t)}}})),r.call(n[t],i)<0&&n[t].push(i),this.observeMutations(e[t],e[this.id],t)},unsubscribe:function(e,t,i){var n;return n=this.weakmap[e[this.id]].callbacks[t],n.splice(n.indexOf(i),1),this.unobserveMutations(e[t],e[this.id],t)},read:function(e,t){return e[t]},publish:function(e,t,i){return e[t]=i}},e.factory=function(t){return t._=e,t.binders=e.binders,t.components=e.components,t.formatters=e.formatters,t.adapters=e.adapters,t.config=e.config,t.configure=function(t){var i,n;null==t&&(t={});for(i in t)n=t[i],e.config[i]=n},t.bind=function(t,i,n){var a;return null==i&&(i={}),null==n&&(n={}),a=new e.View(t,i,n),a.bind(),a}},"object"==typeof exports?e.factory(exports):"function"==typeof define&&define.amd?define("libs/rivets",["exports"],function(t){return e.factory(this.rivets=t),t}):e.factory(this.rivets={})}.call(this),define("tau/ui/extensions/assignments/ui.extension.assignments.view",["Underscore","jQuery","tau/core/view-base","libs/rivets"],function(e,t,i,n){return i.extend({doRender:function(e,t,i){this._super(e,t,i);
var a=this.element;this.fire("view.bound",n.bind(a,{data:e}))},"bus view.bound > refresh":function(e,t){t.unbind()},"bus view.bound:last + destroy":function(e,t){t.unbind()}})}),define("tau/ui/extensions/assignments/model",["Underscore","jQuery","tau/core/class","tau/core/event","tau/utils/utils.translation","tau/utils/utils.convertUserName"],function(e,t,i,n,a,r){var s=["feature","epic"];return n.extend(i.extend({init:function(e,t,i,n,a){this.store=e,this.store2=t,this.contextService=i,this.groups=[],this.entity=n,a&&this.listenServer()},load:function(){return t.when(this.loadGroups()).then(e.bind(this.loadAssignments,this))},loadGroups:function(){return t.when(this.loadRoles()).then(e.bind(this.createGroupsFromRoles,this))},loadRoles:function(){var t=this.entity.entityType.name.toLowerCase();return e.contains(s,t)?this._loadRolesByProcess(t):this.loadEntityRoles()},loadEntityRoles:function(){var e=t.Deferred();return this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:[{roleEfforts:[{role:["id","name"]}]}]}).done(function(t){e.resolve(t[0].data.roleEfforts)}.bind(this)),e},_loadRolesByProcess:function(i){var n=t.Deferred();return t.when(this.loadProcessId()).then(function(){this.store.get("process",{id:this.processId,nested:!0,fields:[{entityStates:["id",{role:["id","name","hasEffort"]},{entityType:["id","name"]}],list:!0}]}).done(function(t){var a=e.filter(t[0].data.entityStates,function(e){return e.role&&e.entityType.name.toLowerCase()===i});n.resolve(a)}.bind(this))}.bind(this)),n},loadProcessId:function(){return t.when(this.contextService.findByEntity(this.entity)).then(e.bind(function(e){return this.processId=e.processes[0].id,this.processId},this))},ASSIGNMENT_FIELDS:["id",{role:["id","name"]},{generalUser:["id","firstName","lastName","avatarUri","email"]}],loadAssignments:function(){var i=t.Deferred();return this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:[{assignments:this.ASSIGNMENT_FIELDS}]}).done(e.bind(function(e){this.assignments=e[0].data.assignments,this.groups=this.processAssignments(this.assignments),i.resolve(this.groups)
},this)),i},createGroupsFromRoles:function(t){this.groups=e.chain(t).pluck("role").compact().uniq(function(e){return e.id}).map(this.createGroupFromRole).value()},createGroupFromRole:function(e){return{id:e.id,name:a.shorten(e.name),role:e,users:[]}},processAssignments:function(t){return e.forEach(t,function(t){var i=e.find(this.groups,function(e){return e.role.id==t.role.id});if(!i){var n=this.createGroupFromRole(t.role);this.groups.push(n),i=n}this.addToGroup(i,this.processUser(t.generalUser))},this),this.groups},processUser:function(t){var i=r.getFullName(t);return t=e.extend(e.pick(t,"id","firstName","lastName","email","avatarUri"),{name:i,_avatarUri:t._avatarUri||t.avatarUri}),t.avatarUri=t._avatarUri+"20",t},findGroupById:function(t){return e.findWhere(this.groups,{id:t})},processFormData:function(i){var n,a=this.findGroupById(parseInt(i.groupId,10)),r=a.users,s=i.users,o=this.store,l=[],u=Math.max(r.length,s.length);for(n=0;u>n;n++){var c=r[n],d=s[n];if(c&&d&&c.id!=d.id||!c||!d)break}var p=r.slice(n),f=s.slice(n);e.forEach(p,e.bind(function(t){this.removeFromGroup(a,t),l.push(e.bind(function(t,i){this.store2.findAll(e.sprintf("Assignment?where=(GeneralUser.id=%d and Assignable.id=%d and Role.id=%d)",t.id,this.entity.id,a.id)).then(function(t){e.forEach(t,function(e){o.remove("assignments",{id:e.id}).done({success:function(){},failure:function(){}})}),i()})},this,t))},this)),e.forEach(f,e.bind(function(t){this.addToGroup(a,this.processUser(t)),l.push(e.bind(function(t,i){var n={role:{id:a.role.id},generalUser:{id:t.id},assignable:{id:this.entity.id}};o.save("assignments",{$set:n}).done({success:function(){i()},failure:e.bind(function(){this.removeFromGroup(a,t),i()},this)})},this,t))},this));var m=t.Deferred();return e.series(l,function(){m.resolve()}),m},listenServer:function(){this.store.unbind(this),this.store.on({eventName:"afterSave",type:"assignment",listener:this},e.bind(function(i){var n=i.data.obj.id;t.when(this.findOwnAssignmentById(n)).then(e.bind(function(e){e&&this.addChangedAssignment(e)
},this))},this)),this.store.on({eventName:"afterRemove",type:"assignment",listener:this},e.bind(function(i){var n=i.data.obj.id;t.when(this.findOwnAssignmentById(n)).then(e.bind(function(e){e&&this.removeChangedAssignment(e)},this))},this))},findOwnAssignmentById:function(i){var n=e.findWhere(this.assignments,{id:i});if(n)return n;var a=t.Deferred();return this.store.get("assignment",{id:i,fields:this.ASSIGNMENT_FIELDS,errorHandler:function(){return!1}}).done({success:e.bind(function(e){this.assignments.push(e[0].data),a.resolve(e[0].data)},this),failure:e.bind(function(){a.resolve(null)},this)}),a},addChangedAssignment:function(t){var i=e.find(this.groups,function(e){return e.role.id==t.role.id});if(i){var n=e.find(i.users,function(e){return e.id==t.generalUser.id});n||this.addToGroup(i,this.processUser(t.generalUser))}},removeChangedAssignment:function(t){var i=e.find(this.groups,function(e){return e.role.id==t.role.id});if(i){var n=e.find(i.users,function(e){return e.id==t.generalUser.id});n&&this.removeFromGroup(i,n)}},addToGroup:function(e,t){e.users.push(t)},removeFromGroup:function(t,i){var n=e.findWhere(t.users,{id:i.id});n&&(t.users=e.without(t.users,n))}}))}),define("tau/ui/templates/assignments/ui.template.assignments.bound",["tau/core/templates-factory"],function(e){return e.register({name:"assignments",engine:"jqote2",markup:['<div class="tau-assignments">','<div class="i-role-group i-role-formtrigger tau-assignments__group" rv-each-group="data.groups" rv-data-id="group.id" tabindex="-1">','<span class="tau-assignments__grouptitle" rv-text="group.name" rv-title="group.role.name"></span>','<div class="tau-assignments__users">','<span class="i-role-user tau-assignments__user tau-avatar" rv-each-user="group.users">','<img rv-src="user.avatarUri" rv-title="user.name" />',"</span>","</div>","</div>","</div>"]})}),define("tau/ui/templates/assignments/ui.template.assignments.form",["tau/core/templates-factory"],function(e){return e.register({name:"assignments.form",engine:"jqote2",markup:['<form role="i-role-form tau-assignments__form" action="">','<input type="hidden" name="groupId" value="<%= this.data.groupId %>" />','<input type="hidden" name="roleId" value="<%= this.data.roleId %>" />','<div class="tau-invite-widget">','<textarea name="users" placeholder="Type a name or email" />',"</div>","</form>"]})
}),define("tau/components/component.assignments",["tau/components/component.creator","tau/ui/extensions/assignments/ui.extension.assignments","tau/ui/extensions/assignments/ui.extension.assignments.view","tau/ui/extensions/assignments/model","tau/ui/templates/assignments/ui.template.assignments.bound","tau/ui/templates/assignments/ui.template.assignments.form","tau/libs/store2/store2"],function(e,t,i,n,a,r,s){return{create:function(o){var l=o.context.configurator,u=o.context.entity,c={ViewType:i,extensions:[{extType:t,args:[l,u,new n(l.getStore(),new s(l),l.getApplicationContextService(),u,!0),r,o.$within]}],template:a};return e.create(c,o)}}}),define("tau/models/extension.model.base",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"extension model base",floatToString:function(e){return e||(e=0),e.toFixed(2).replace(".00","")},destroy:function(){this._super(),this.destroy=function(){}}})}),define("tau/models/assignmentsList/extension.model.effortRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){return t.extend({category:"model effort retriver","bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}};this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:["effort","effortToDo"]},callback:{scope:this,success:this.onEffortRetrieved}})},"bus extendDataToBind":function(e){var t=e.data||{},i=this.entity||{};t.totalEffort={effort:this.floatToString(i.effort),remain:this.floatToString(i.effortToDo)}},onEffortRetrieved:function(e){this.entity=e.data},destroy:function(){delete this.entity,this._super()}})}),define("tau/models/assignmentsList/extension.model.effortPointsRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){return t.extend({category:"model effort points extension",_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},"bus extendDataToBind":function(e){var t=e.data||{};t.effortPoints=this._getEffortPoints()
}})}),define("tau/models/assignmentsList/extension.model.assignmentsRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){return t.extend({category:"model extension assignments retriever","bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}},t={generalUser:["id","firstName","lastName","avatarUri","email"]};this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:[{assignments:["id",{role:["id","name"]},t],list:!0}]},callback:{scope:this,success:this.onAssignmentsRetrieved}})},onAssignmentsRetrieved:function(e){var t=e.data.assignments;this.fire("assignmentsReady",t)}})}),define("tau/models/assignmentsList/extension.model.entityRolesRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){return t.extend({category:"model entity roles retriever extension","bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}},t={role:["id","name","hasEffort"]};this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:[{roleEfforts:["id","effort","effortToDo",t,{assignable:["id"]}],list:!0},{entityState:[{role:["id"]}]}]},callback:{scope:this,success:this.onRoleEffortsRetrieved}})},"bus userGroupWasCreated":function(t){var i=t.data||{},n=i.role||{};if(n.hasEffort){var a=this.entity.roleEfforts;e.each(a,function(e){return e.role.id==n.id?(i.roleEffort={effort:this.floatToString(e.effort),remain:this.floatToString(e.effortToDo),id:e.id},!0):void 0},this),this.fire("roleEffortsReady",a)}else i.roleEffort=null},getRoles:function(t){var i=t.entityState.role&&t.entityState.role.id;return e(t.roleEfforts).map(function(e){var t=e.role;return t.isResponsible=t.id==i,t})},onRoleEffortsRetrieved:function(e){this.entity=e.data;var t=this.getRoles(this.entity);this.fire("rolesReady",t)},"bus extendDataToBind":function(e){e.data||{}}})}),define("tau/models/assignmentsList/extension.model.featureRolesRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){return t.extend({category:"model feature roles retriever extension","bus registerStoreRequest":function(){var e=this.config.context.getProcessId();
this.fire("get",{type:"process",query:{id:e,nested:!0,fields:[{entityStates:["id",{role:["id","name","hasEffort"]},{entityType:["id","name"]}],list:!0}]},callback:{scope:this,success:this.onEntityStatesRetrieved}})},onEntityStatesRetrieved:function(t){if(this.config){var i=t.data.entityStates,n=this.roles=[],a={},r=this.config.context.entity.entityType.name.toLocaleLowerCase();e.each(i,function(e){var t=e.role;t&&e.entityType.name.toLowerCase()===r&&(a.hasOwnProperty(t.id)||(a[t.id]=!0,n.push(t)))}),this.fire("rolesReady",n)}}})}),define("tau/models/assignmentsList/extension.model.assignmentToRolesMapper",["Underscore","tau/models/extension.model.base","tau/utils/utils.convertUserName"],function(e,t,i){return t.extend({category:"model assignment to role mapper","bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}},t={generalUser:["id","firstName","lastName"]};this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:[{assignments:["id",{role:["id","name"]},t],list:!0}]},callback:{scope:this,success:this.onAssignmentsRetrieved}})},"bus assignmentsReady+rolesReady+extendDataToBind":function(e){for(var t=(e.assignmentsReady||{}).data,i=(e.rolesReady||{}).data,n=(e.extendDataToBind||{}).data,a=[],r=0;r<i.length;r++){var s=i[r],o={role:s,users:this.getUsersInRole(t,s),allowAdd:!0};this.fire("userGroupWasCreated",o),a.push(o)}n.assignments={groups:a}},_convertUserDataToViewData:function(e){var t=e.avatarUri+"32";return{id:e.id,name:i.getFullName(e),avatar:t}},getUsersInRole:function(t,i){t=e.sortBy(t,function(e){return e.id});for(var n=[],a=0,r=t.length;r>a;a++){var s=t[a];if(s.role.id==i.id){var o=this._convertUserDataToViewData(s.generalUser);o.assignmentId=s.id,o.roleId=i.id,n.push(o)}}return n}})}),define("tau/models/assignmentsList/extension.model.taskEffortRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){return t.extend({category:"model task EffortRetriever","bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}};
this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:["tasks-count","tasks-effort-sum","tasks-effortToDo-sum"]},callback:{scope:this,success:this.onTaskEffortRetrieved}})},"bus extendDataToBind":function(e){var t=e.data||{},i=this.entity||{};i["tasks-count"]>0&&(t.tasksEffort={effort:this.floatToString(i["tasks-effort-sum"]),remain:this.floatToString(i["tasks-effortToDo-sum"])})},onTaskEffortRetrieved:function(e){this.entity=e.data},destroy:function(){delete this.entity,this._super()}})}),define("tau/models/model.assignmentsList",["require","Underscore","tau/store/types","tau/core/model-base","tau/models/assignmentsList/extension.model.effortRetriever","tau/models/assignmentsList/extension.model.store.operations","tau/models/assignmentsList/extension.model.effortPointsRetriever","tau/models/assignmentsList/extension.model.assignmentsRetriever","tau/models/assignmentsList/extension.model.entityRolesRetriever","tau/models/assignmentsList/extension.model.featureRolesRetriever","tau/models/assignmentsList/extension.model.assignmentToRolesMapper","tau/models/assignmentsList/extension.model.taskEffortRetriever"],function(e){var t=e("Underscore"),i=e("tau/store/types"),n=e("tau/core/model-base"),a=e("tau/models/assignmentsList/extension.model.effortRetriever"),r=e("tau/models/assignmentsList/extension.model.store.operations"),s=e("tau/models/assignmentsList/extension.model.effortPointsRetriever"),o=e("tau/models/assignmentsList/extension.model.assignmentsRetriever"),l=e("tau/models/assignmentsList/extension.model.entityRolesRetriever"),u=e("tau/models/assignmentsList/extension.model.featureRolesRetriever"),c=e("tau/models/assignmentsList/extension.model.assignmentToRolesMapper"),d=e("tau/models/assignmentsList/extension.model.taskEffortRetriever");return n.extend({"bus assignmentsReady":function(e){this.assignments=e.data},"bus assignmentsReady:last+userAvatarChanged":function(e,i,n){var a=t.find(i,function(e){return e.generalUser.id==n.id});void 0!==a&&this.fire("avatarChanged",n)
},"bus roleEffortsReady":function(e){this.roleEfforts=e.data},destroyExtensions:function(){var e=this.extensions||[];if(e.length>0){{this.config.context.entity.id,this.bus}t.each(e,function(e){e.destroy("destroy")})}delete this.extensions},initExtensions:function(){this.destroyExtensions();var e=i.findByKeyword(this.config.context.entity.entityType.name),t=this._getRetriever(e.name),n=new t(this.config);this.extensions=[new a(this.config),new r(this.config),new s(this.config),new o(this.config),n,new c(this.config)],"userstory"==e.name.toLowerCase()&&this.extensions.push(new d(this.config))},_getRetriever:function(e){switch(e.toLowerCase()){case"feature":case"epic":return u;default:return l}},onInit:function(){this.clearData();var e=this;e.store.unbind(e),e.initExtensions(),e.fire("registerStoreRequest"),e.fire("commitTransaction",{success:e.done,scope:e}),this.bindStoreListeners()},done:function(){var e={};this.bus.fire("extendDataToBind",e),this.bus.fire("dataBind",e),this.destroyExtensions()},bindStoreListeners:function(){var e=this;e.store.on({eventName:"afterSave",type:"assignment",listener:e},function(){e.afterAssignmentSaved.apply(e,arguments)}),e.store.on({eventName:"afterSave",type:"user",hasChanges:["avatarUri"],listener:e},function(){e.afterUserSaved.apply(e,arguments)}),e.store.on({eventName:"beforeSave",type:"assignment",listener:e},function(){e.beforeSaveAssignment.apply(e,arguments)}),e.store.on({eventName:"beforeSave",type:"roleEffort",listener:e},function(){e.beforeSaveRoleEffort.apply(e,arguments)}),e.store.on({eventName:"afterSave",type:"roleEffort",listener:e},function(){e.afterSaveRoleEffort.apply(e,arguments)}),e.store.on({eventName:"beforeRemove",type:"assignment",listener:e},function(){e.beforeRemoveAssignment.apply(e,arguments)}),e.store.on({eventName:"afterRemove",type:"assignment",listener:e},function(){e.afterAssignmentRemoved.apply(e,arguments)});var i=this.config.context.entity.id,n=this.config.context.entity.entityType.name,a={id:i};e.store.on({eventName:"beforeRemove",type:n,listener:e,filter:a},function(){e.store.unbind(e)
}),e.store.on({eventName:"beforeSave",type:n,listener:e,filter:a,hasChanges:["entityState"]},t.bind(e.beforeEntityEntityStateChanged,e)),e.store.on({eventName:"afterSave",type:n,listener:e,filter:a,hasChanges:["entityState"]},t.bind(e.afterEntityEntityStateChanged,e)),e.store.on({eventName:"afterSave",type:n,listener:e,filter:a,hasChanges:["effort|effortToDo|effortCompleted|tasks-count|tasks-effort-sum|tasks-effortToDo-sum"]},t.bind(e.onDataUpdate,e))},beforeEntityEntityStateChanged:function(){this.fire("beforeStateChanged")},afterEntityEntityStateChanged:function(){this.fire("afterStateChanged")},onDataUpdate:function(){this.fire("dataDidUpdated")},beforeSaveRoleEffort:function(e){var i=e.data.id;if(t.isNumber(i)&&this.isRoleEffortOfCurrentEntity(i)){var n=e.data.cmd;n.config.fields=n.config.fields||[],n.config.fields.push("effortToDo"),this.fire("beforeSaveRoleEffort",{roleEffortId:i})}},afterSaveRoleEffort:function(e){var i=e.data.id;t.isNumber(i)&&this.isRoleEffortOfCurrentEntity(i)&&this.fire("afterSaveRoleEffort",{roleEffortId:i})},beforeRemoveAssignment:function(e){this.fireEventIfAssignmentFromCurrentEntity(e,"beforeRemoveAssignment")},afterAssignmentRemoved:function(e){this.fireEventIfAssignmentFromCurrentEntity(e,"afterAssignmentRemoved")},beforeSaveAssignment:function(e){t.isNumber(e.data.id)?this.fireEventIfAssignmentFromCurrentEntity(e,"beforeSaveAssignment"):this.fireEventIfAssignmentFromCurrentEntity(e,"beforeAddAssignment")},afterAssignmentSaved:function(e){var i=e.data,n=i.cmd?i.cmd.config.id:i.obj?i.obj.id:null;t.isNumber(n)?this.fireEventIfAssignmentFromCurrentEntity(e,"afterAssignmentSaved"):this.fireEventIfAssignmentFromCurrentEntity(e,"afterAssignmentAdded")},afterUserSaved:function(e){this.fire("userAvatarChanged",e.data)},fireEventIfAssignmentFromCurrentEntity:function(e,i){var n=e.data.id,a=e.data.changes||e.data.obj;if(this.isAssignmentOfCurrentEntity(n)||((a||{}).assignable||{}).id===this.config.context.entity.id){var r=t.extend({assignmentId:n},a);
this.fire(i,r)}},isRoleEffortOfCurrentEntity:function(e){return t.any(this.roleEfforts,function(t){return t.id===e})},isAssignmentOfCurrentEntity:function(e){return t.any(this.assignments,function(t){return t.id===e})},clearData:function(){delete this.assignments,delete this.roleEfforts},destroy:function(){this.clearData(),this._super.apply(this,arguments)}})}),define("tau/core/model.editable.base",["tau/core/model-base"],function(e){return e.extend({"bus save":function(e,t){var i=this.config.context?this.config.context.entity:{};this.handleSave(t||{},i)},"bus remove":function(e){var t=this,i=t.config.context.entity,n=e.data||{},a=n.typeName||i.entityType.name;t.fire("beforeRemove",n),t.store.remove(a,{id:n.id},{success:function(e){t.fire("afterRemove",e.data)},failure:function(){}}).done()},handleSave:function(e,t){var i=e.$set||e,n=e.$include,a=e.hasOwnProperty("id")?e.id:t.id,r=e.typeName||t.entityType.name,s={$set:i,fields:n};a&&(s.id=a);var o={type:r,cmd:s,validation:{isValid:!0,isError:function(){return!1}}};this.fire("validate",o),this.fire("afterValidate",o);var l=o.validation;if(l.isValid===!1||l.isError&&l.isError())return void this.fire("validationFailed",o);this.fire("beforeSave",o);var u=this;this.store.save(r,s,{success:function(e){u.fire("afterSave",{type:e.command.type,cmd:s,data:e.data})},failure:function(e){u.fire("saveFailed",{type:e.command.type,cmd:s})}}).done()}})}),define("tau/models/model.assignmentsList.editable",["tau/core/model.editable.base"],function(e){var t=e.extend({"bus dataBind":function(){this.fire("permissionsReady",{editable:!0})}});return t}),define("tau/models/userList/extension.model.unassignAction",["Underscore","tau/core/model-base"],function(e,t){return t.extend({name:"Model Extension Unassign Action","bus extendDataToBind":function(e){var t=e.data;t.headerActions.push({id:"unassign",title:"Unassign"})}})}),define("tau/models/userList/extension.model.showMore",["Underscore","tau/core/model-base"],function(e,t){return t.extend({name:"Model Extension Unassign Action","bus extendDataToBind":function(e){var t=e.data;
t.moreAvailable=this.isMoreAvailable()},filterIsEmpty:function(){return!this.filterIsNotEmpty()},isMoreAvailable:function(){var e=this.config.data;return this.filterIsEmpty()&&e.showMore!==!0&&(e.hasOwnProperty("roleId")||e.hasOwnProperty("role"))},filterIsNotEmpty:function(){return this.config.data.filter&&this.config.data.filter.length}})}),define("tau/components/extensions/assignmentsList/extension.assignmentsList.editable",["Underscore","jQuery","tau/core/model-base"],function(e,t,i){return i.extend({category:"edit",init:function(){var e=this;e._super.apply(e,arguments),e.animations=[]},"bus dataBind":function(e){this.bindedData=e.data},"bus afterRender":function(e){this.refresh=this._innerRefresh,this.$el=e.data.element,this.startAnimations()},"bus permissionsReady+afterRender":function(e){var t=e.permissionsReady.data;if(t.editable){var i=this;i.$el.removeClass("assignments-table-readonly"),i.$el.find(".group .effort").editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(e){var t=this.$element.parents(".group").tmplItem().data,n=i.normalizeEffort(t.roleEffort.effort),a=i.normalizeEffort(e);if(n===a)return this.restoreInitialText(),!1;var r={typeName:"roleEffort",$include:["id"],id:t.roleEffort.id,$set:{effort:a}};i.bus.fire("save",r)},onEditStart:function(){this.$element.data("points",this.$element.find("span").detach())},onEditEnd:function(){this.$element.append(this.$element.data("points"))}})}},"bus beforeSaveAssignment":function(e){var t,i,n=this,a=e.data.assignmentId;a&&(t=this.getAssignmentSelector(a),i=this.$el.find(t),i&&(this.fire("markElementToBeUpdated",{element:i}),this.addAnimation(function(){n.fire("updateElement",{element:n.$el.find(t)})})))},"bus beforeStateChanged":function(){var e=this;e.fire("markElementToBeUpdated",{element:this.$el}),e.addAnimation(function(){e.fire("updateElement",{element:e.$el})})},"bus dataDidUpdated":function(){this.refresh()},"bus avatarChanged":function(){this.refresh()},"bus afterSaveRoleEffort":function(e){var t=e.data.roleEffortId,i=this;
i.addAnimation(function(){var e=i.findRoleEffortElementByRoleEffortId(t);i.fire("updateElement",{element:e}),i.fire("updateElement",{element:i.$el.find(".total-row .effort-cell span")})}),this.refresh()},"bus afterAssignmentSaved":function(){this.refresh()},"bus afterAssignmentRemoved":function(){this.refresh()},"bus afterStateChanged":function(){this.refresh()},"bus afterAssignmentAdded":function(){this.refresh()},"bus beforeAddAssignment":function(e){var i=e.data,n=this,a=n.generateAssignmentIdForNewAssignment(i),r={name:"",role:{},assignmentId:a};t.tmpl("user",r).appendTo(n.$el.find(".group[roleId="+i.role.id+"]"));var s=n.getUserSelector({roleId:i.role.id,id:i.generalUser.id});n.addAnimation(function(){n.fire("updateElement",{element:n.$el.find(s)})})},"bus beforeRemoveAssignment":function(e){var t=e.assignmentId,i=this.$el.find(this.getAssignmentSelector(t));this.fire("markElementToBeDeleted",{element:i})},"bus beforeSaveRoleEffort":function(e){var t=e.data,i=t.roleEffortId,n=this.findRoleEffortElementByRoleEffortId(i);this.fire("markElementToBeUpdated",{element:n})},getUserSelector:function(e){return".group[roleId="+e.roleId+"] .user[userId="+e.id+"]"},getAssignmentSelector:function(e){var t,i=this,n=".user",a=i.$el.find(n);return a.each(function(i){var r=a.eq(i);return r.tmplItem().data.assignmentId==e?(t=r,n+=":eq("+i+")",!1):void 0}),n},generateAssignmentIdForNewAssignment:function(e){return[this.config.context.entity.id,e.role.id,e.generalUser.id].join(",")},findRoleEffortElementByRoleEffortId:function(e){var i=this.$el.find(".role-effort .effort"),n=t();return i.each(function(){var i=t(this),a=i.parents(".group"),r=a.tmplItem().data;return r.roleEffort=r.roleEffort||{},r.roleEffort.id===e?(n=i,!1):void 0}),n},addAnimation:function(e){this.animations.push(e)},startAnimations:function(){e.each(this.animations,function(e){e()}),this.animations=[]},_innerRefresh:function(){this.refresh=function(){},this.fire("refresh")},refresh:function(){},normalizeEffort:function(e){return Math.abs(Math.round(100*parseFloat(e))/100)||0
},destroy:function(){delete this.$el,delete this.bindedData,delete this.animations,this._super()}})}),define("tau/components/extensions/bubble/extension.bubble.creator",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({category:"edit",init:function(e){this._super(e),this.containers=[]},"bus initBubble":function(t,i){var n=this.config.context,a=e.defaults(i,{closeOnStoreActions:!0});this.initBubble(a,e.defaults(a.context||{},n))},"bus $target.ready:last + toggleBubble":function(e,i){window.appIsInDebugMode&&!t.contains(document.documentElement,i[0])&&window.console.error("$target.ready:last - bubble target is detached",i[0]),i.tauBubble("toggle")},initBubble:function(i,n){this.destroyContainers();var a=t(i.target);i.destroyExistingBubble&&a.data("ui-tauBubble")&&a.tauBubble("destroy"),this.fire("$target.ready",a);var r=e.extend({},i,{alignTo:i.alignTo||a,content:i.html,onHide:function(e){i.cleanupOnHide&&a.data("bubbleLoaded",!1),i.onHide&&i.onHide(e)},onBeforeShow:e.bind(this.onBeforeShowBubble,this,i,a),onShow:e.bind(this.onShowBubble,this,n,i,a)});a.tauBubble(r),i.applyBubbleClasses!==!1&&(a.addClass("tau-bubble-target"),a.tauBubble("getAlignTo").addClass("ui-link"))},onBeforeShowBubble:function(e,t,i){var n=!0;return e.onBeforeShow&&(n=e.onBeforeShow(i)),t.data("bubbleLoaded")!==!0&&(this.destroyContainers(),t.tauBubble("setContent",'<div class="ui-loading-message-container"><div class="ui-loading-message">Loading&hellip;</div></div>')),n},onShowBubble:function(e,t,i,n){t.onShow&&t.onShow(n),t.componentsConfig&&i.data("bubbleLoaded")!==!0&&this.createContainer(i,n,t,e)},createContainer:function(e,i,n,a){var r=this,s=n.componentsConfig;s.store=this.config.store,s.context=a,r.createComponents(s,function(a){var o=a[0].component,l=a[0].config;r.fire("childComponentCreated",o),r.addContainer(o,e),r.processContainer(e,i,o,n,l),l.context=s.context,l.store=s.store;var u=l.onBeforeInitializeComponent||t.noop;u.apply(l,[o]),o.initialize(l),o.fire("$outerBubbled.ready",e)
})},processContainer:function(e,t,i,n,a){var r=this._getComponentEventNamespace(i),s=function(){e.data("ui-tauBubble")&&e.tauBubble("adjust")};i.on("afterRender",function(t,n){t.removeListener();var a=n.element;a.css("visibility","hidden"),e.data("bubbleLoaded",!0),e.tauBubble("setContent",a),i.fire("focus.before",{}),i.fire("popupResize",e),a.css("visibility","visible"),s(),i.fire("focus",{}),e.trigger("taububbleloadcontent")}),i.on("afterRender",s),i.on("dataRendered",function(){i.fire("popupResize",e),i.fire("focus"),s()}),e.on("show"+r,function(){i.fire("$outerBubbled.show")}),e.on("close"+r,function(){i.fire("blur",{})});var o=function(t){e.data("ui-tauBubble")&&(t.data&&t.data.animated?e.tauBubble("widget").fadeOut(function(){e.tauBubble("empty")}):e.tauBubble("empty"))},l=function(){e.data("ui-tauBubble")&&e.tauBubble("destroy"),i.destroy()};i.on("close",o),i.on("reset",l),n.closeOnStoreActions&&(i.on("beforeSave",o),i.on("beforeRemove",o),i.on("afterSave",l),i.on("afterRemove",l));var u=a.handleComponentEvents;if(u){var c=function(e,t,n){i.on(e,t.bind(n||null))},d={closeBubble:o,destroyBubble:l};u(c,d)}i.on("adjustPosition",s)},destroy:function(){this.destroyContainers(),this._super()},addContainer:function(e,t){this.containers.push({component:e,$target:t})},destroyContainers:function(){e.each(this.containers,function(e){var t=this._getComponentEventNamespace(e.component);e.$target.off(t),e.component.destroy()},this),this.containers=[]},_getComponentEventNamespace:function(e){return".bubbleComponent"+e.__objectId}})}),define("tau/components/extensions/bubble/extension.bubble.creator.direct",["Underscore","jQuery","tau/components/extensions/bubble/extension.bubble.creator"],function(e,t,i){return i.extend({category:"edit","bus afterInit":function(){this.onEditActivated()},"bus afterRender + applyPopups":function(i,n,a){var r=n.element,s=this;e.forEach(a,function(i){var n=r.find(i.target),a=r.find(i.alignTo),o=n.length>1;n.each(function(n){var r=t(this);r.addClass("tau-bubble-target");
var l=e.deepClone(i);l.targetCssClass&&r.addClass(l.targetCssClass),l.target=r,l.alignTo=r.find(l.alignTo),l.alignTo=l.alignTo.length?l.alignTo:a.eq(n),l.componentsConfig.components[0].data=e.deepClone(r.tmplItem().data),o&&(l.cleanupOnHide=!0),l.stackName=i.stackName,s.fire("initBubble",l)})})},onEditActivated:function(){this.fire("applyPopups",this.config.popupEditorContainer)}})}),define("tau/models/assignment/model.property.assignUser.editable.base",["Underscore","tau/core/model.editable.base"],function(e,t){return t.extend({"bus assignToLoggedUser":function(){this.assignTo(this.getLoggedUser().id)},"bus changeAssignment":function(e){var t=e.data.user.id;this.assignTo(t)},getLoggedUser:function(){return this.config.context.getLoggedUser()},assignTo:function(){},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/assignment/model.assignment.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(e,t){return t.extend({"bus removeAssignment":function(){var e={id:this.config.data.assignmentId,typeName:"assignment"};this.fire("remove",e)},assignTo:function(t){var i={typeName:"assignment",$include:[{generalUser:["id","firstName","lastName"]},{role:["id","name"]},{assignable:["id"]}]};this.config.data.hasOwnProperty("assignmentId")&&e.extend(i,{id:this.config.data.assignmentId,$set:{generalUser:{id:t}}}),this.fire("save",i)},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/assignment/model.add.assignment.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(e,t){return t.extend({assignTo:function(t){var i={typeName:"assignment",$include:[{generalUser:["id","firstName","lastName"]},{role:["id","name"]},{assignable:["id"]}]};this.config.data.role&&e.extend(i,{id:null,$set:{generalUser:{id:t},assignable:{id:parseInt(this.config.context.entity.id)},role:{id:this.config.data.role.id}}}),this.fire("save",i)},destroy:function(){this.project=null,this.entity=null,this._super()
}})}),define("tau/ui/extensions/ui.extension.tooltip",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({name:"ui.extension.tooltip",category:"edit","bus afterRender":function(t){var i=t.data.element;i.find(".tau-extension-tooltip").each(function(){var t=e(this),i=t.prop("title");i&&t.prop("title","").tauBubble({content:'<div class="tau-tooltip-title">'+i+"</div>",zIndex:9999,className:"tau-bubble-tooltip",showEvent:"mouseenter",hideEvent:"mouseleave",mode:"tooltip",stackName:"tooltip"})})}})}),define("tau/ui/templates/common/ui.template.userName",["tau/core/templates-factory"],function(e){return e.register({name:"user-name",markup:"<span {{if name}} class='user-name'{{/if}} role='username'>${name}</span><br/>"})}),define("tau/ui/templates/common/ui.template.user",["tau/core/templates-factory","tau/ui/templates/common/ui.template.userName"],function(e){return e.register({name:"user",markup:["<table class='user' role='user' userId='${id}'><tr>","<td class='user-avatar-container'>","{{if avatar}}<img src='${avatar}' class='user-avatar'/>{{/if}}","</td>","<td class='user-info'>","   {{tmpl 'user-name'}}","{{if role}}","<span class='user-role'>${role.name}</span>","{{/if}}","</td>","</tr></table>"].join(""),dependencies:["user-name"]})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn",["tau/core/templates-factory"],function(e){var t={name:"assignments-add-btn",markup:['<button class="add-btn',"{{if allowAdd == false}}"," disabled","{{/if}}",'" type="button"><div>AddAssignment</div></button>'].join(""),dependencies:[]};return e.register(t)}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(e){var t={name:"assignments-user-list",markup:['<div class="group {{if role.isResponsible}}assignments-responsible{{/if}}" roleId="${role.id}">','<table class="role-header">',"   <tr>",'   <td class="role-title">','   {{tmpl "assignments-add-btn"}}',"&nbsp;${role.name}","   </td>",'   <td class="role-effort">',"{{if roleEffort}}",'       <div class="effort">${roleEffort.effort}<span class="point">${$item.effortPoints}</span></div>',"{{/if}}","   </td>","</tr>","</table>",'{{tmpl(users) "user"}}',"</div>"].join(""),dependencies:["user","assignments-add-btn"]};
return e.register(t)}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList","tau/ui/templates/common/ui.template.user"],function(e){var t={name:"assignments-list",markup:['<table class="box assignments-table-readonly assignments-table">','   <tr class="title">','       <td class="assignments-title"></td>','       <td class="effort title-cell">Effort</td>',"    </tr>",'    <tr class="title-row">','       <td class="user-list" colspan="2">','               {{tmpl(assignments.groups, {effortPoints: effortPoints}) "assignments-user-list"}}',"       </td>","   </tr>",'   <tr class="head-row">',"       <td></td>","       <td></td>","   </tr>","{{if tasksEffort}}",'   <tr class="tasks-row">','       <td class="task-title">Tasks</td>','       <td class="effort-cell">${tasksEffort.effort} h</td>',"   </tr>","{{/if}}",'   <tr class="total-row">','       <td class="total-title">Total</td>','       <td class="effort-cell"><span>${totalEffort.effort} ${effortPoints}</span></td>',"   </tr>",'   <tr class="title-row" style="display: none;">','       <td class="owner title-cell">Owner</td>',"       <td></td>","   </tr>","</table>"].join(""),dependencies:["assignments-user-list","user"]};return e.register(t)}),define("tau/components/component.assignmentsList",["Underscore","tau/components/component.creator","tau/models/model.assignmentsList","tau/models/model.assignmentsList.editable","tau/models/userList/extension.model.unassignAction","tau/models/userList/extension.model.showMore","tau/components/extensions/assignmentsList/extension.assignmentsList.editable","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator.direct","tau/models/assignment/model.assignment.editable","tau/models/assignment/model.add.assignment.editable","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/assignmentsList/ui.template.assignmentsList"],function(e,t,i,n,a,r,s,o,l,u,c,d,p){return{create:function(f){var m={extensions:e.concat([i,o,n,s,d,{type:l,config:{popupEditorContainer:e.map([{target:".user-list .user",alignTo:".user-name",componentsConfig:{components:[{type:"userList",extensions:[u,a,r]}]}},{target:".owner-cell .user-name",componentsConfig:{components:[{type:"userList",extensions:[r]}]}},{target:".add-btn:not(.disabled)",targetCssClass:"ui-link",componentsConfig:{components:[{type:"userList",extensions:[c,r]}]}}],function(t){return e.defaults(t,{stackName:"add-assignments-editor",className:"i-role-taububble-ignore"})
})}},f.extensions]),template:f.template||p};return t.create(m,f)}}}),define("tau/models/model.attachments",["tau/core/model-base","tau/utils/utils.date","tau/utils/utils.convertUserName"],function(e,t,i){var n=function(){return!0};return e.extend({init:function(e,t,i){this.name="Attachment Model",this._super.apply(this,arguments),this.filter=this.config.filter||i||n},_getAttachmentFields:function(){return["id","date","name","description","mimeType","uri","thumbnailUri",{owner:["id","firstName","lastName"]}]},onInit:function(){var e=this.config.context.entity,t=[{attachments:this._getAttachmentFields()}];this.store.get(e.entityType.name,{id:e.id,fields:t},{scope:this,success:this.onAssignableRetrieved}).done()},"bus attachmentUploaded":function(e){var t=this,i=[{general:["id"]}].concat(this._getAttachmentFields());t.store.save("attachment",{id:e.data.data.id,$set:{},fields:i}).done({success:function(){t.bus.fire("attachmentUploadCompleted",{element:e.data.element})}})},onAssignableRetrieved:function(e){for(var t=e.data.attachments,i=this.config&&this.config.selected,n={items:[]},a=0,r=t.length;r>a;a++){var s=t[a];if(this.filter(s)){var o=this.attachmentDTOToModelAttachment(s);n.items.push(o),i&&s.id===i.id&&(o.selected=!0,n.selected=o)}}this.bus.fire("dataBind",n)},attachmentDTOToModelAttachment:function(e){var n=t.parse(t.convertToTimezone(e.date)),a=e.owner||{},r=e.name!==e.description?e.description:null;return{id:e.id,name:e.name,description:r,mimeType:e.mimeType,ownerName:i.getFullName(a),date:t.format.date.short(n),thumbnailUri:e.thumbnailUri,uri:e.uri}}})}),define("tau/models/model.attachments.editable",["Underscore","tau/core/model.editable.base"],function(e,t){function i(e,t){return e===t.id}return t.extend({category:"edit",name:"Editable attachment",onInit:function(){this.store.on({eventName:"afterRemove",listener:this,type:"attachment"},e.bind(this._afterAttachmentRemove,this))},"bus dataBind":function(e){this.bus.fire("permissionsReady",{editable:!0,deletable:!0}),this._attachments||(this._attachments=e.data.items,this._fireAttachmentsEvent())
},"bus attachmentUploaded":function(e){this._addAttachment(e.data.data),this._fireAttachmentsEvent()},_afterAttachmentRemove:function(e){var t=parseInt(e.data.cmd.config.id,10);this._isValidAttachmentId(t)&&(this._removeAttachment(t),this.bus.fire("afterAttachmentRemove",{id:t}),this._fireAttachmentsEvent())},_addAttachment:function(e){this._attachments.push(e)},_removeAttachment:function(t){this._attachments=e.reject(this._attachments,e.bind(i,null,t))},_isValidAttachmentId:function(t){return e.any(this._attachments,e.bind(i,null,t))},_fireAttachmentsEvent:function(){this.bus.fire("attachments",this._attachments)}})}),function(e){"use strict";"function"==typeof define&&define.amd?define("libs/jquery/jquery.fileupload",["jQuery"],e):e(window.jQuery)}(function(e){"use strict";e.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.widget("blueimp.fileupload",{widgetEventPrefix:"fileupload",options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,formData:function(e){return e.serializeArray()},add:function(t,i){(i.autoUpload||i.autoUpload!==!1&&(e(this).data("blueimp-fileupload")||e(this).data("fileupload")).options.autoUpload)&&i.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var n=e-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=(t-this.loaded)*(1e3/n)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)
},_getFormData:function(t){var i;return"function"==typeof t.formData?t.formData(t.form):e.isArray(t.formData)?t.formData:t.formData?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(e){e._progress={loaded:0,total:0,bitrate:0}},_onProgress:function(e,t){if(e.lengthComputable){var i,n=+new Date;if(t._time&&t.progressInterval&&n-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=n,i=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=i-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=i,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(n,i,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,this._progress)}},_initProgressListener:function(t){var i=this,n=t.xhr?t.xhr():e.ajaxSettings.xhr();n.upload&&(e(n.upload).bind("progress",function(e){var n=e.originalEvent;e.lengthComputable=n.lengthComputable,e.loaded=n.loaded,e.total=n.total,i._onProgress(e,t)}),t.xhr=function(){return n})},_initXHRData:function(t){var i,n=t.files[0],a=t.multipart||!e.support.xhrFileUpload,r=t.paramName[0];t.headers=t.headers||{},t.contentRange&&(t.headers["Content-Range"]=t.contentRange),a?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:r,value:t.blob}):e.each(t.files,function(e,n){i.push({name:t.paramName[e]||r,value:n})})):(t.formData instanceof FormData?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"',i.append(r,t.blob,n.name)):e.each(t.files,function(e,n){(window.Blob&&n instanceof Blob||window.File&&n instanceof File)&&i.append(t.paramName[e]||r,n,n.name)})),t.data=i):(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"',t.contentType=n.type,t.data=t.blob||n),t.blob=null
},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&e("<a></a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e,"iframe")},_getParamName:function(t){var i=e(t.fileInput),n=t.paramName;return n?e.isArray(n)||(n=[n]):(n=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",a=(t.prop("files")||[1]).length;a;)n.push(i),a-=1}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,n){var a=e.Deferred(),r=a.promise();return i=i||this.options.context||r,t===!0?a.resolveWith(i,n):t===!1&&a.rejectWith(i,n),r.abort=a.promise,this._enhancePromise(r)},_addConvenienceMethods:function(e,t){var i=this;t.submit=function(){return"pending"!==this.state()&&(t.jqXHR=this.jqXHR=i._trigger("submit",e,this)!==!1&&i._onSend(e,this)),this.jqXHR||i._getXHRPromise()},t.abort=function(){return this.jqXHR?this.jqXHR.abort():this._getXHRPromise()},t.state=function(){return this.jqXHR?i._getDeferredState(this.jqXHR):void 0
},t.progress=function(){return this._progress}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),n=i&&i.length>1&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(t,i){var n,a,r=this,s=t.files[0],o=s.size,l=t.uploadedBytes=t.uploadedBytes||0,u=t.maxChunkSize||o,c=s.slice||s.webkitSlice||s.mozSlice,d=e.Deferred(),p=d.promise();return this._isXHRUpload(t)&&c&&(l||o>u)&&!t.data?i?!0:l>=o?(s.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,t.context,[null,"error",s.error])):(a=function(){var i=e.extend({},t),p=i._progress.loaded;i.blob=c.call(s,l,l+u,s.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+o,r._initXHRData(i),r._initProgressListener(i),n=(r._trigger("chunksend",null,i)!==!1&&e.ajax(i)||r._getXHRPromise(!1,i.context)).done(function(n,s,u){l=r._getUploadedBytes(u)||l+i.chunkSize,i._progress.loaded===p&&r._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=n,i.textStatus=s,i.jqXHR=u,r._trigger("chunkdone",null,i),r._trigger("chunkalways",null,i),o>l?a():d.resolveWith(i.context,[n,s,u])}).fail(function(e,t,n){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,r._trigger("chunkfail",null,i),r._trigger("chunkalways",null,i),d.rejectWith(i.context,[e,t,n])})},this._enhancePromise(p),p.abort=function(){return n.abort()},a(),p):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),t._progress||(t._progress={}),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,n,a){var r=a._progress.total;a._progress.loaded<r&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:r,total:r}),a),a.result=t,a.textStatus=i,a.jqXHR=n,this._trigger("done",null,a)
},_onFail:function(e,t,i,n){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,this._trigger("fail",null,n),n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total)},_onAlways:function(e,t,i,n){this._active-=1,this._trigger("always",null,n),0===this._active&&this._trigger("stop")},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var n,a,r,s,o=this,l=o._getAJAXSettings(i),u=function(){return o._sending+=1,l._bitrateTimer=new o._BitrateTimer,n=n||((a||o._trigger("send",t,l)===!1)&&o._getXHRPromise(!1,l.context,a)||o._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){o._onDone(e,t,i,l)}).fail(function(e,t,i){o._onFail(e,t,i,l)}).always(function(e,t,i){if(o._sending-=1,o._onAlways(e,t,i,l),l.limitConcurrentUploads&&l.limitConcurrentUploads>o._sending)for(var n=o._slots.shift();n;){if("pending"===o._getDeferredState(n)){n.resolve();break}n=o._slots.shift()}})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(r=e.Deferred(),this._slots.push(r),s=r.pipe(u)):s=this._sequence=this._sequence.pipe(u,u),s.abort=function(){return a=[void 0,"abort","abort"],n?n.abort():(r&&r.rejectWith(l.context,a),u())},this._enhancePromise(s)):u()},_onAdd:function(t,i){var n,a,r,s,o=this,l=!0,u=e.extend({},this.options,i),c=u.limitMultiFileUploads,d=this._getParamName(u);if((u.singleFileUploads||c)&&this._isXHRUpload(u))if(!u.singleFileUploads&&c)for(r=[],n=[],s=0;s<i.files.length;s+=c)r.push(i.files.slice(s,s+c)),a=d.slice(s,s+c),a.length||(a=d),n.push(a);else n=d;else r=[i.files],n=[d];return i.originalFiles=i.files,e.each(r||i.files,function(a,s){var u=e.extend({},i);return u.files=r?s:[s],u.paramName=n[a],o._initProgressObject(u),o._addConvenienceMethods(t,u),l=o._trigger("add",t,u)}),l},_replaceFileInput:function(t){var i=t.clone(!0);e("<form></form>").append(i)[0].reset(),t.after(i).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,n){return n===t[0]?i[0]:n
}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var n,a=this,r=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),r.resolve([e])};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(e){e.relativePath=i,r.resolve(e)},s):t.isDirectory?(n=t.createReader(),n.readEntries(function(e){a._handleFileTreeEntries(e,i+t.name+"/").done(function(e){r.resolve(e)}).fail(s)},s)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var n=this;return e.when.apply(e,e.map(t,function(e){return n._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,n,a=t.prop("webkitEntries")||t.prop("entries");if(a&&a.length)return this._handleFileTreeEntries(a);if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(n=t.prop("value"),!n)return e.Deferred().resolve([]).promise();i=[{name:n.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,n={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(n.fileInput).always(function(e){n.files=e,i.options.replaceFileInput&&i._replaceFileInput(n.fileInput),i._trigger("change",t,n)!==!1&&i._onAdd(t,n)})},_onPaste:function(t){var i=t.originalEvent.clipboardData,n=i&&i.items||[],a={files:[]};return e.each(n,function(e,t){var i=t.getAsFile&&t.getAsFile();
i&&a.files.push(i)}),this._trigger("paste",t,a)===!1||this._onAdd(t,a)===!1?!1:void 0},_onDrop:function(e){var t=this,i=e.dataTransfer=e.originalEvent.dataTransfer,n={};i&&i.files&&i.files.length&&e.preventDefault(),this._getDroppedFiles(i).always(function(i){n.files=i,t._trigger("drop",e,n)!==!1&&t._onAdd(e,n)})},_onDragOver:function(t){var i=t.dataTransfer=t.originalEvent.dataTransfer;return this._trigger("dragover",t)===!1?!1:void(i&&-1!==e.inArray("Files",i.types)&&(i.dropEffect="copy",t.preventDefault()))},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var n=-1!==e.inArray(t,this._refreshOptionsList);n&&this._destroyEventHandlers(),this._super(t,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_create:function(){var t=this.options;e.extend(t,e(this.element[0].cloneNode(!1)).data()),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,n,a=this,r=e.Deferred(),s=r.promise();
return s.abort=function(){return n=!0,i?i.abort():(r.reject(null,"abort","abort"),s)},this._getFileInputFiles(t.fileInput).always(function(e){n||(t.files=e,i=a._onSend(null,t).then(function(e,t,i){r.resolve(e,t,i)},function(e,t,i){r.reject(e,t,i)}))}),this._enhancePromise(s)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";"function"==typeof define&&define.amd?define("libs/jquery/jquery.iframe-transport",["jQuery"],e):e(window.jQuery)}(function(e){"use strict";var t=0;e.ajaxTransport("iframe",function(i){if(i.async){var n,a,r;return{send:function(s,o){n=e('<form style="display:none;"></form>'),n.attr("accept-charset",i.formAcceptCharset),r=/\?/.test(i.url)?"&":"?","DELETE"===i.type?(i.url=i.url+r+"_method=DELETE",i.type="POST"):"PUT"===i.type?(i.url=i.url+r+"_method=PUT",i.type="POST"):"PATCH"===i.type&&(i.url=i.url+r+"_method=PATCH",i.type="POST"),a=e('<iframe src="javascript:false;" name="iframe-transport-'+(t+=1)+'"></iframe>').bind("load",function(){var t,r=e.isArray(i.paramName)?i.paramName:[i.paramName];a.unbind("load").bind("load",function(){var t;try{if(t=a.contents(),!t.length||!t[0].firstChild)throw new Error}catch(i){t=void 0}o(200,"success",{iframe:t}),e('<iframe src="javascript:false;"></iframe>').appendTo(n),n.remove()}),n.prop("target",a.prop("name")).prop("action",i.url).prop("method",i.type),i.formData&&e.each(i.formData,function(t,i){e('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(n)}),i.fileInput&&i.fileInput.length&&"POST"===i.type&&(t=i.fileInput.clone(),i.fileInput.after(function(e){return t[e]}),i.paramName&&i.fileInput.each(function(t){e(this).prop("name",r[t]||i.paramName)}),n.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),n.submit(),t&&t.length&&i.fileInput.each(function(i,n){var a=e(t[i]);e(n).prop("name",a.prop("name")),a.replaceWith(n)})}),n.append(a).appendTo(document.body)
},abort:function(){a&&a.unbind("load").prop("src","javascript".concat(":false;")),n&&n.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&e.parseJSON(e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),define("tau/ui/templates/attachments/ui.template.attachments.fileupload",["tau/core/templates-factory"],function(e){var t={name:"attachments.fileupload",engine:"jqote2",markup:['<div class="uploader-toolbar">','<span class="fileBrowser">','<span class="uploader-text">','<span class="ico"></span>',"<%!fn.T(this.uploaderText)%>","</span>",'<span class="uploader-text-active"><%!fn.T(this.uploaderTextActive)%></span>','<input class="i-role-fileinput" type="file" <%=this.multiple%>/>',"</span>","</div>"]};return e.register(t)}),define("tau/ui/templates/attachments/ui.template.attachments.attachment",["tau/core/templates-factory"],function(e){var t={name:"attachments.attachment",engine:"jqote2",customFunctions:{descriptionText:function(e){return e?" ("+e+")":""}},markup:['<div id="attach-<%= this.id %>" ','class="ui-attach" ','title="<%! this.name %><%! fn.descriptionText(this.description) %> by <%! this.ownerName %> on <%! this.date %>" data-id="<%= this.id %>" ',">",'<div class="inner i-role-attachment" role="attachment">','<a class="preview" href="<%= this.uri %>" target="_blank">',"<% if (this.thumbnailUri){ %>",'<img src="<%= this.thumbnailUri %>" />',"<% } %>","</a>",'<p class="name"><%! this.name %></p>','<p class="owner">by <%! this.ownerName %></p>','<p class="date">on <%! this.date %></p>','<p class="toolbar">','<a class="download" href="<%= this.uri %>" target="_blank">download</a>',"</p>","</div>","</div>"]};return e.register(t)}),define("tau/components/extensions/attachments/extension.attachments.uploader",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","libs/jquery/jquery.fileupload","libs/jquery/jquery.iframe-transport","tau/ui/templates/attachments/ui.template.attachments.fileupload","tau/ui/templates/attachments/ui.template.attachments.attachment"],function(e,t,i,n,a,r,s,o){var l=/<title\b[^>]*>(.*?)<\/title>/,u=!!window.FileReader;
return i.extend({"bus permissionsReady+afterRender":function(e,t,i){this._initialized||(this._initialized=!0,this.element=i.element,t.editable&&t.deletable&&this._initUploader())},"bus afterRender":function(t,i){var n=i.element,a=e.bind(function(){n.parents("body").length?this.fire("view.dom.ready"):e.delay(a,100)},this);a()},"bus view.dom.ready + afterRender":function(e,t,i){if(u){var n=i.element.find(".uploader-toolbar"),a=n.closest(".tau-app-main-pane");a.length||(a=n.closest(".i-role-application")),n.on("dragover.uploader",function(e){var t=e.originalEvent;return t.dataTransfer.dropEffect="copy",!1}),n.on("dragenter.uploader",function(){n.addClass("hover")}),a.on("dragleave.uploader",function(e){var t=this.getBoundingClientRect(),i=e.originalEvent.clientX-t.left,a=e.originalEvent.clientY-t.top,r=0>=i||0>=a||i>=t.width||a>=t.height;r&&n.removeClass("dragged-over hover")}),a.on("dragenter.uploader",function(){n.addClass("dragged-over")}),a.on("drop.uploader",function(){n.removeClass("dragged-over hover")}),a.on("dragover.uploader",".cke",function(){return!1}),a.on("dragover.uploader",function(e){var t=e.originalEvent;t.dataTransfer.dropEffect="none",n.removeClass("hover"),e.preventDefault()}),this.on("destroy",function(){a.off(".uploader")})}},_initUploader:function(){var t={uploaderText:u?"Drag and drop files here or click to select files":"Click here to select files",uploaderTextActive:u?"Drop here...":"",multiple:/\bapple\b/i.test(navigator.vendor)?"":"multiple"},i=s.render(t);i.find(".i-role-fileinput").fileupload({url:this._getUploadUrl(),formData:this._getFormData(),add:e.bind(this._onFileAdd,this),dropZone:this.element,pasteZone:this.element}),i.appendTo(this.element)},_getUploadUrl:function(){return this.config.context.configurator.getApplicationPath()+"/UploadFile.ashx"},_getFormData:function(){return[{name:"generalId",value:this._getGeneralId()}]},_getGeneralId:function(){return this.config.context.entity.id},_onFileAdd:function(e,t){var i=this;if(this.element.find(".uploader-toolbar").removeClass("dragged-over"),t.files&&0!==t.files.length){var n=this._createAttachmentDummy(t.files[0].name);
n.appendTo(this._getAttachmentsPlaceholder()),t.submit().success(function(e){var t,a=i._getResponseText(e);try{t=i._parseResponse(a)}catch(r){return void i._onAttachmentUploadFail(n)}i.bus.fire("attachmentUploaded",{element:i._updateAttachmentElement(n,t),data:t})}).error(function(e){var t,a=e.responseText.match(l);t=a&&a.length>0?a[1]:"Looks like application is not available. Please check your connection or server availability",i._onAttachmentUploadFail(n,t)})}},_updateAttachmentElement:function(e,t){var i=this._createAttachmentElement(t);return e.replaceWith(i),i},_onAttachmentUploadFail:function(e,t){this._deleteFailedAttachmentElement(e,t)},_getResponseText:function(e){var t="";return"string"==typeof e?t=e:e.jquery&&(t=e.text()),t},_createAttachmentDummy:function(e){var t=this._createAttachmentElement({name:e});return t.addClass("uploading").find(".toolbar").remove(),t},_deleteFailedAttachmentElement:function(e,i){i=i||"Upload failed",this.fire("error",{message:i}),e.addClass("failed"),t('<p class="error">Upload failed</p>').insertAfter(e.find(".name")),e.fadeOut(1500,function(){e.remove()})},_getAttachmentsPlaceholder:function(){return this.element.find(".ui-attachments-content")},_createAttachmentElement:function(e){return o.render(e)},_parseResponse:function(e){var t;try{t=JSON.parse(e),t=t.items||t,t=t.pop()}catch(i){}var a=n.parse(n.convertToTimezone(t[1]));return{id:t[0],uri:t[4],thumbnailUri:t[5],mimeType:t[3],name:t[2],ownerName:t[6][1]+" "+t[6][2],date:n.format.date.short(a)}}})}),define("tau/components/extensions/attachments/extension.attachments.selectable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(t){var i=t.data.element;i.on("click",".i-role-attachment",e.bind(this._onAttachmentClick,this))},_onAttachmentClick:function(e){var i=t(e.target),n=0!==i.closest(".toolbar").length;if(!n){e.preventDefault();var a=i.closest(".ui-attach");this.bus.fire("attachmentSelected",a.data("id"))
}}})}),define("tau/components/extensions/attachments/extension.attachments.showPreview",["Underscore","tau/components/extensions/component.creator.extension"],function(e,t){return t.extend({"bus initialize":function(e){var t=e.data.context,i=t.entity,n={entityType:i.entityType,id:i.id};this.contextForPreview={applicationContext:t.applicationContext,entity:n,configurator:t.configurator}},"bus beforeInit":function(t,i){i.config.context.configurator.getComponentBusRegistry().getByName("imagePreview").done(e.bind(function(e){this.fire("previewBus.ready",e)},this))},"bus previewBus.ready:last + attachments:last + image.selected":function(t,i,n,a){i.fire("refresh",{items:e.filter(n,function(e){return e.mimeType&&0===e.mimeType.indexOf("image/")}),selectedId:a.id})},"bus attachments:last + attachmentSelected":function(t,i,n){var a=e.find(i,function(e){return e.id===n});a.mimeType&&0===a.mimeType.indexOf("image/")?this.fire("image.selected",a):window.open(a.uri,"_blank")}})}),define("tau/components/extensions/attachments/extension.attachments.thumbProxy",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var i=e.data.element.find(".ui-attach .preview img");i.each(function(){var e=t(this);if(!e.prop("complete")){var i=e.parent();i.addClass("loading"),e.load(function(){i.removeClass("loading")})}})}})}),define("tau/components/extensions/attachments/extension.attachments.deletable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus permissionsReady+afterRender":function(t,i,n){this.$element=n.element,i.deletable&&(this._createDeleteTriggers(),this.$element.on("click",".ui-attach.deletable .delete",e.bind(this._onAttachmentDeleteClick,this)))},"bus attachmentUploaded":function(){this._createDeleteTriggers()},"bus afterAttachmentRemove":function(e){var t=e.data.id,i=this.$element.find("#attach-"+t);i.animate({opacity:0},{complete:function(){i.remove()
}})},_createDeleteTriggers:function(){this.$element.find(".ui-attach:not(.deletable)").each(function(e,i){t(i).addClass("deletable").find(".toolbar").append(t('<button class="delete" type="button">delete</button>'))})},_onAttachmentDeleteClick:function(e){var i=this._findUpConfirmationPlaceholder(t(e.target));this._showConfirmation(i)},_findUpConfirmationPlaceholder:function(e){return e.closest(".ui-attach").children(".inner")},_findUpAttachElement:function(e){return e.closest(".ui-attach")},_createConfirmation:function(t){t.confirmation({message:"Delete attachment?",ok:e.bind(this._deleteAttachment,this),cancel:e.bind(this._cancelAttachmentDelete,this)})},_showConfirmation:function(e){e.data("confirmation")||this._createConfirmation(e),e.confirmation("show")},_hideConfirmation:function(e){e.confirmation("hide")},_deleteAttachment:function(e){var i=t(e.target);this._hideConfirmation(this._findUpConfirmationPlaceholder(i));var n=this._findUpAttachElement(i),a=n.data("id");this.bus.fire("markElementToBeDeleted",{element:n}),this.bus.fire("remove",{id:a,typeName:"attachment"})},_cancelAttachmentDelete:function(e){this._hideConfirmation(this._findUpConfirmationPlaceholder(t(e.target)))}})}),define("tau/components/extensions/error/extension.errorBar",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({"bus initialize":function(e,i){t.has(i.context.configurator.registeredServices,"errorBar")&&this.fire("errorBar.ready",i.context.configurator.service("errorBar"))},"bus errorBar.ready:last + clearError":function(e,t,i){t.fire("clearError",i)},"bus errorBar.ready:last + error":function(e,t,i){t.fire("error",i)},"bus errorBar.ready:last + notification":function(e,t,i){t.fire("notification",i)}})}),define("tau/ui/templates/attachments/ui.template.attachments",["tau/core/templates-factory","tau/ui/templates/attachments/ui.template.attachments.attachment"],function(e){var t={name:"attachments",engine:"jqote2",options:{contentSelector:".ui-attachments-content"},markup:['<div class="ui-attachments-control">','<div class="ui-attachments-content">','<%= fn.sub("attachments.attachment", this.items) %>',"</div>","</div>"]};
return e.register(t)}),define("tau/components/component.attachments",["tau/components/component.creator","tau/models/model.attachments","tau/models/model.attachments.editable","tau/components/extensions/attachments/extension.attachments.uploader","tau/components/extensions/attachments/extension.attachments.selectable","tau/components/extensions/attachments/extension.attachments.showPreview","tau/components/extensions/attachments/extension.attachments.thumbProxy","tau/components/extensions/attachments/extension.attachments.deletable","tau/components/extensions/error/extension.errorBar","tau/ui/templates/attachments/ui.template.attachments"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){var d=c||{},p={extensions:[t,i,n,a,r,s,o,l],template:u};return e.create(p,d)}}}),define("tau/models/model.attachmentsPreview",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t,i){var n=i.config.items||[],a=i.config.selectedId||null,r={};a||(r=n.length?e.first(n):{},a=r.id),n=e.map(n,function(e){return e.selected=!1,e.id===a&&(e.selected=!0,r=e),e}),this.fire("dataBind",{selected:r,items:n})}})}),define("tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus beforeInit + afterRender":function(i,n,a){var r=a.element;this.fire("$el.ready",r);var s=r.find(".i-role-thumb");this.fire("$thumbs.ready",s),r.on("click",".i-role-thumb",e.bind(function(e){this.fire("thumb.selected",t(e.currentTarget).data("id"))},this)),r.on("click","a",e.bind(function(e){e.preventDefault(),e.stopPropagation()},this)),r.on("click",".toolbar .prev",e.bind(function(e){e.stopPropagation(),this.fire("prev")},this)),r.on("click",".toolbar .next",e.bind(function(e){e.stopPropagation(),this.fire("next")},this)),r.on("click",e.bind(function(e){t(e.target).is("img")||this.fire("close")},this));var o=n.config.context.configurator;this.fire("configurator.ready",o),s.length&&o.getKeyBoardManager().pushHandler({handleKeyDown:e.bind(function(e){e.keyCode==t.ui.keyCode.ESCAPE&&this.fire("close"),e.keyCode==t.ui.keyCode.LEFT&&this.fire("prev"),e.keyCode==t.ui.keyCode.RIGHT&&this.fire("next")
},this)}),e.delay(e.bind(function(){this.fire("afterChangeImage")},this),100)},"bus $el.ready:last + $thumbs.ready:last + thumb.selected":function(t,i,n,a){var r=n.filter(".selected");if(a!=r.data("id")){n.toggleClass("selected",!1),r=n.filter("[data-id="+a+"]").toggleClass("selected",!0);var s=i.find(".ui-attachment-view-image");s.on("load",e.bind(function(){this.fire("afterChangeImage")},this)),s.attr("src",r.data("big-src"))}},"bus afterRender:last + afterChangeImage":function(e,t){var i=t.element,n=i.find(".ui-attachment-view-image");i.toggleClass("ui-attachments-preview-control_mode_full",!1),i.toggleClass("ui-attachments-preview-control_mode_short",!0),n.unbind("click.resize"),n.data("ui-draggable")&&(n.draggable("destroy"),n.css("position","static"));var a=n.parent().width(),r=n.parent().height();parseInt(n[0].naturalWidth,10)>a||parseInt(n[0].naturalHeight,10)>r?(n.toggleClass("ui-attachment-view-image_resize_true",!0),n.one("click.resize",function(){i.toggleClass("ui-attachments-preview-control_mode_full"),i.toggleClass("ui-attachments-preview-control_mode_short"),n.draggable()})):n.toggleClass("ui-attachment-view-image_resize_true",!1)},"bus configurator.ready:last + $el.ready:last + $thumbs.ready:last + close":function(e,t,i,n){i.hide(),n.length&&t.getKeyBoardManager().popHandler(),this.fire("closed")},"bus $thumbs.ready:last + next":function(e,t){var i=t.index(t.filter(".selected"))+1;i>=t.length&&(i=0),this.fire("thumb.selected",t.eq(i).data("id"))},"bus $thumbs.ready:last + prev":function(e,t){var i=t.index(t.filter(".selected"))-1;0>i&&(i=t.length-1),this.fire("thumb.selected",t.eq(i).data("id"))}})}),define("tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview.animations",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var i=this;i.element=e.data.element,t(window).bind("resize",function(){i._resizeImage()});var n=i.element.find(".ui-attachment-wait"),a=i.element.find(".ui-attachment-view-image");
a.hide(),n.show(),this.element.find(".ui-attachment-view-image").bind("load",function(){i._onImageLoad()});var r=function(){t(this).parent().removeClass("ui-thumbnail-loading"),t(this).unbind("load",r),t(this).fadeIn("slow")};this.element.find(".thumbnail-nav li").addClass("ui-thumbnail-loading"),this.element.find(".thumbnail-nav li > img").each(function(){this.complete?r.call(this):t(this).bind("load",r).hide()})},_onImageLoad:function(){var e=this,t=e.element.find(".ui-attachment-wait"),i=e.element.find(".ui-attachment-view-image");e._resizeImage(),i.fadeIn("slow",function(){t.hide()})},_resizeImage:function(){var e=this,t=e.element;if(t){var i=e.element.find(".ui-attachment-wait"),n=e.element.find(".ui-attachment-view-image"),a=t.find(".image-view");n.width(""),n.height("");var r=a.width(),s=a.height(),o=n.width(),l=n.height();if(o>r||l>s){var u=s/l*o,c=r/o*l;r>u?(n.width(u),n.height(s)):(n.width(r),n.height(c))}return{$wait:i,$image:n}}},"bus beforeChangeImage":function(e){var t=this,i=t.element.find(".ui-attachment-wait"),n=t.element.find(".ui-attachment-view-image");i.show();var a=e.data;n.fadeOut("slow",function(){n.attr("src",a)}),e.data=!1}})}),define("tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview.thumbnail",["tau/core/templates-factory"],function(e){var t={name:"attachmentsPreview.thumbnail",engine:"jqote2",markup:["<li >",'<a href="<%= this.uri %>">','<img class="ui-attach-thumbnail i-role-thumb <% if (this.selected){ %> selected<% } %>" src="<%= this.thumbnailUri %>" data-id="<%= this.id %>" data-big-src="<%= this.uri %>" />',"</a>","</li>"]};return e.register(t)}),define("tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview",["tau/core/templates-factory","tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview.thumbnail"],function(e){var t={name:"attachmentsPreview",engine:"jqote2",markup:['<div class="ui-attachments-preview-control ui-attachments-preview-control_mode_short" <% if (this.items.length == 0){%> style="display:none" <%}%>>','<div class="toolbar">','<button class="close" type="button">&times;</button>',"<% if (this.items.length > 1) { %>",'<button class="prev" type="button">&larr;</button>','<button class="next" type="button">&rarr;</button>',"<% } %>","</div>",'<div class="swap-view">','<div class="image-view">','<div class="ui-attachment-wait"></div>','<img class="ui-attachment-view-image" src="<%= this.selected.uri || "" %>">',"</div>","</div>",'<ul class="thumbnail-nav">','<%= fn.sub("attachmentsPreview.thumbnail", this.items) %>',"</ul>","</div>"]};
return e.register(t)}),define("tau/components/component.attachmentsPreview",["tau/components/component.creator","tau/models/model.attachmentsPreview","tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview","tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview.animations","tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview"],function(e,t,i,n,a){return{create:function(n){var r=function(){},s={ModelType:t,extensions:[i],template:a};return n.filter=n.filter||r,e.create(s,n)}}}),define("tau/models/auditHistory/model.auditHistory",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/store/services/service.auditHistory","tau/utils/utils.date"],function(e,t,i,n,a){return i.extend({REQUEST_SOURCE_TYPE_MAP:{0:"None",1:"Email",2:"Phone",3:"Internal",4:"External"},"bus afterInit":function(){var e=this.config.context.configurator;this.auditHistoryService=e.getAuditHistoryService(),this.urlBuilder=e.getUrlBuilder(),this.fire("dataBind")},"bus getAuditRecords":function(e,t){var i=this.config.context.entity.id;this.auditHistoryService.getAuditRecordsLimited(i,t.start,t.limit).done(function(e){var t=e.d,i=this._convertRawAuditRecords(t);this.fire("auditRecords.ready",{auditRecords:i})}.bind(this)).fail(function(e){this.fire("auditRecords.ready",{}),this._handleError(e)}.bind(this))},"bus getAuditRecordsChanges":function(t,i){var n=e.map(i.records,function(e){return{historyId:e.historyId,entityTypeName:e.entityTypeName}},this),a=this.config.context.entity.id;this.auditHistoryService.getChangeGroups(a,n).done(function(e){var t=e.d;this.fire("auditRecordsChanges.ready",this._convertRawChangeGroups(t))}.bind(this)).fail(function(e,t){this.fire("auditRecordsChanges.ready",this._convertKeysToNoChangeGroups(e)),this._handleError(t)}.bind(this,n))},_convertRawAuditRecords:function(t){return e.map(t,function(e){var t=a.parseTimestampToDate(e.Date);return{historyId:e.ID,entityTypeName:e.InnerEntity||e.Entity,date:{year:t.toString("yyyy"),month:t.toString("MMM"),day:t.toString("dd"),time:t.toString("h:mm tt")},description:e.Description,avatarUrl:this.urlBuilder.getAvatarUrl(e.ModifierID,15),user:e.Modifier}
},this)},_convertKeysToNoChangeGroups:function(t){return e.map(t,function(e){return{historyId:e.historyId,entityTypeName:e.entityTypeName}},this)},_convertRawChangeGroups:function(t){return e.map(t,this._convertRawChangeGroup,this)},_convertRawChangeGroup:function(e){return{historyId:e.Key.HistoryId,entityTypeName:e.Key.EntityTypeName,changes:this._convertRawChanges(e.Changes)}},_convertRawChanges:function(t){return e.map(t,function(e){return{fieldName:e.Field,oldValue:this._formatValue(e.OldValue,e.ChangeID),newValue:this._formatValue(e.NewValue,e.ChangeID)||"Empty",toBeEncoded:!("Description"==e.NativeField&&-1==e.ChangeID.indexOf("Attachment-Description")||e.ChangeID.indexOf("TestCase-Success")>0||e.ChangeID.indexOf("TestCase-Steps")>0)}},this)},_formatValue:function(e,t){return t.indexOf("Request-SourceType")>0?this.REQUEST_SOURCE_TYPE_MAP[e]||e:e},_handleError:function(e){this.fire("error",e.statusText.toString())}})}),define("tau/ui/templates/auditHistory/ui.template.auditHistory.records",["tau/core/templates-factory"],function(e){var t={name:"auditHistory.records",engine:"jqote2",markup:["<% _.each(this.auditRecords, function(auditRecord) { %>",'<tr data-history-id="<%! auditRecord.historyId %>" data-entity-type-name="<%! auditRecord.entityTypeName %>">','<td class="tau-date"><%! auditRecord.date %></td>','<td class="tau-time"><%! auditRecord.time %></td>','<td class="tau-description i-role-description" ><%! auditRecord.description %></td > ','<td class="tau-person"><img src="<%! auditRecord.avatarUrl %>" title="<%! auditRecord.user %>"><span><%! auditRecord.user %></span></td>',"</tr>","<% }); %>"]};return e.register(t)}),define("tau/ui/templates/auditHistory/ui.template.auditHistory.record.changes",["tau/core/templates-factory"],function(e){var t={name:"auditHistory.record.changes",engine:"jqote2",markup:['<div class="tau-updates i-role-changes" style="display: none">',"<% if (this.changes.length) {%>","<% _.each(this.changes, function(change) { %>",'<div class="tau-txt">',"<b><%! change.fieldName%></b>","<% if (change.oldValue) { %>","<% if (change.toBeEncoded) { %>",' changed from <span class="tau-old-data"><%! change.oldValue%></span> to ',"<% } else { %>",' changed from <span class="tau-old-data"><%= change.oldValue%></span> to ',"<% } %>","<% } else { %>",": ","<% } %>","<% if (change.toBeEncoded) { %>",'<span class="tau-new-data"><%! change.newValue %></span><br/>',"<% } else { %>",'<span class="tau-new-data"><%= change.newValue %></span><br/>',"<% } %>","</div>","<% }); %>","<% } else { %>",'<div class="tau-txt"><b>no details...</b></div>',"<% } %>","</div>"]};
return e.register(t)}),define("tau/ui/extensions/auditHistory/ui.extension.auditHistory",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/auditHistory/ui.template.auditHistory.records","tau/ui/templates/auditHistory/ui.template.auditHistory.record.changes"],function(e,t,i,n,a){return i.extend({init:function(e){this._super(e),this.limit=e.limit||10},"bus afterRender":function(e,t){var i=t.element;this._bindLoadMore(i),this._bindExpandCollapse(i),this.fire("loadedAuditRecords",{count:0}),this.fire("loadAuditRecords")},"bus afterRender:last + loadedAuditRecords:last + loadAuditRecords":function(e,t,i){this._showProgress(t.element.find(".i-role-more")),this.fire("getAuditRecords",{start:i.count,limit:this.limit})},"bus afterRender:last + loadedAuditRecords:last + auditRecords.ready":function(t,i,n,a){var r=i.element,s=r.find(".i-role-more");if(this._tryHideProgress(s),a.auditRecords)if(e.isEmpty(a.auditRecords))this._switchToNoMore(s,!0);else{var o=a.auditRecords.length;o<this.limit&&this._switchToNoMore(s);var l=this._buildAuditRecordsBindModel(a.auditRecords,n.lastRecordDate),u=this._$renderRecords(l.auditRecords);u.appendTo(this._$getRecordsHolder(this._$getRecords(r))),n.count>0&&this._scrollToLoadedRecords(u),this.fire("loadedAuditRecords",{count:n.count+o,lastRecordDate:l.lastRecordDate})}},"bus afterRender:last + auditRecordsChanges.ready":function(t,i,n){var a=this._$getRecords(i.element),r=this._$getRecordsHolder(a);this._tryHideProgress(this._$getChangesProgressHolder(a,n)),e.each(n,function(e){var t=this._$getRecord(r,e.historyId,e.entityTypeName);t.removeClass("i-role-expanding"),e.changes?this._showRecordChanges(t,e.changes):this._$toggleRecordsOpened(t,!1)},this)},"bus afterRender:last + getAuditRecordsChanges":function(e,t,i){var n=this._$getChangesProgressHolder(this._$getRecords(t.element),i.records);this._showProgress(n)},_bindLoadMore:function(e){e.find(".i-role-more-trigger").on("click",function(){this.fire("loadAuditRecords")
}.bind(this))},_bindExpandCollapse:function(e){var i=this._$getRecordsHolder(this._$getRecords(e));i.on("click","td:not(.tau-date)",function(e){var i=t(e.currentTarget).parent();i.has(".i-role-changes:visible").length?this._collapse(i):this._expand(i)}.bind(this)),e.find(".i-role-expandAll").on("click",function(e,t){t.preventDefault(),this._expandAll(e)}.bind(this,i)),e.find(".i-role-collapseAll").on("click",function(e,t){t.preventDefault(),this._collapseAll(e)}.bind(this,i))},_expandAll:function(e){this._expand(this._$getRecordsItems(e))},_expand:function(e){this._$toggleRecordsOpened(e,!0).find(".i-role-changes").slideDown("fast");var i=this._$filterRecordsItemsToGetChanges(e);i.addClass("i-role-expanding");var n=i.map(function(e,i){var n=t(i);return{historyId:n.data("historyId"),entityTypeName:n.data("entityTypeName")}}.bind(this)).get();n.length>0&&this.fire("getAuditRecordsChanges",{records:n})},_collapseAll:function(e){this._collapse(this._$getRecordsItems(e))},_collapse:function(e){this._$toggleRecordsOpened(e,!1).find(".i-role-changes").slideUp("fast")},_scrollToLoadedRecords:function(e){var t=e.last();t.scrollParent().scrollTo(t,1e3)},_showProgress:function(e){e.data("ui-tauProgressIndicator")||e.tauProgressIndicator();var t=e.data("progress-timeout");t||e.data("progress-timeout",setTimeout(function(e){e.tauProgressIndicator("show",{hover:!0})}.bind(this,e),200))},_tryHideProgress:function(e,t){if(e.data("ui-tauProgressIndicator")){var i=e.data("progress-timeout");i&&(clearTimeout(i),e.removeData("progress-timeout")),e.tauProgressIndicator("hide"),t&&e.tauProgressIndicator("destroy")}},_switchToNoMore:function(e,t){e.find(".i-role-more-trigger").hide(),t&&(e.find(".i-role-no-more").fadeIn(400),e.fadeOut(2e3,"linear"))},_buildAuditRecordsBindModel:function(t,i){var n,a=i,r=e.map(t,function(e){return n=e.date.month+" "+e.date.day+", "+e.date.year,a&&n==a?n=null:a=n,{historyId:e.historyId,entityTypeName:e.entityTypeName,date:n,time:e.date.time,description:e.description,avatarUrl:e.avatarUrl,user:e.user}
},this);return{auditRecords:r,lastRecordDate:a}},_showRecordChanges:function(e,t){var i=this._$getRecordDescription(e),n=this._$renderRecordChanges(t);n.appendTo(i),n.slideDown("fast")},_$filterRecordsItemsToGetChanges:function(e){return e.filter(":not(.i-role-expanding):not(:has(.i-role-changes))")},_$getChangesProgressHolder:function(t,i){var n=1==i.length;if(n){var a=e.first(i);return this._$getRecordDescription(this._$getRecord(this._$getRecordsHolder(t),a.historyId,a.entityTypeName))}return t},_$getRecords:function(e){return e.find(".i-role-records")},_$getRecordsHolder:function(e){return e.find(".i-role-records-holder")},_$getRecord:function(e,t,i){return e.find('[data-history-id="'+t+'"][data-entity-type-name="'+i+'"]')},_$getRecordDescription:function(e){return e.find(".i-role-description")},_$getRecordsItems:function(e){return e.find("tr")},_$renderRecords:function(e){return n.get().bind(null,{auditRecords:e})},_$renderRecordChanges:function(e){return a.get().bind(null,{changes:e})},_$toggleRecordsOpened:function(e,t){return e.toggleClass("tau-open",t)}})}),define("tau/ui/templates/auditHistory/ui.template.auditHistory",["tau/core/templates-factory"],function(e){var t={name:"auditHistory",engine:"jqote2",markup:['<div class="tau-audit-history">','<div class="tau-actions"><a href="" class="tau-expand i-role-expandAll">Expand all</a><span>/</span><a href="" class="tau-collapse i-role-collapseAll">Collapse all</a></div>','<table class="tau-audit-history-info i-role-records">','<tbody class="i-role-records-holder">',"</tbody>","</table>",'<div class="tau-more i-role-more"><a class="i-role-more-trigger">Load more records</a><span class="tau-more i-role-no-more" style="display: none">No more records</span></div>',"</div>"]};return e.register(t)}),define("tau/components/component.auditHistory",["tau/components/component.creator","tau/models/auditHistory/model.auditHistory","tau/ui/extensions/auditHistory/ui.extension.auditHistory","tau/components/extensions/error/extension.errorBar","tau/ui/templates/auditHistory/ui.template.auditHistory"],function(e,t,i,n,a){return{create:function(r){var s={extensions:[t,i,n],template:a};
return e.create(s,r)}}}),define("tau/models/model.avatar",["jQuery","tau/core/model.editable.base","app.path","tau/core/tau"],function(e,t,i,n){return t.extend({onInit:function(){var e=this.config,t=e.context.entity;e.store.get("user",{id:t.id,fields:["avatarUri"]}).done(this.safeCallback(this.onUserDataRetrieved));var i=e.context.configurator.getAvatarService();i.getCropRect(t.id).done(function(e){this.fire("model.crop.ready",e)}.bind(this)),e.store.unbind(this),e.store.on({eventName:"afterSave",type:"user",hasChanges:["avatarUri"],listener:this},function(){this.fire("avatarChanged")}.bind(this))},onUserDataRetrieved:function(e){var t=e[0].data,i=this.config.context.avatarSize||64;this.fire("dataBind",{url:t.avatarUri+i+n.getTokenParameterFromQueryString("&"),id:t.id})}})}),define("libs/jquery/jquery.Jcrop",["libs/jquery/jquery.ui"],function(e){!function(e){e.Jcrop=function(t,i){function n(e){return e+"px"}function a(e){return L.baseClass+"-"+e}function r(){return e.fx.step.hasOwnProperty("backgroundColor")}function s(t){var i=e(t).offset();return[i.left,i.top]}function o(e){return[e.pageX-j[0],e.pageY-j[1]]}function l(t){"object"!=typeof t&&(t={}),L=e.extend(L,t),e.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof L[t]&&(L[t]=function(){})})}function u(e,t){if(j=s(q),mt.setCursor("move"===e?e:e+"-resize"),"move"===e)return mt.activateHandlers(d(t),g);var i=dt.getFixed(),n=p(e),a=dt.getCorner(p(n));dt.setPressed(dt.getCorner(n)),dt.setCurrent(a),mt.activateHandlers(c(e,i),g)}function c(e,t){return function(i){if(L.aspectRatio)switch(e){case"e":i[1]=t.y+1;break;case"w":i[1]=t.y+1;break;case"n":i[0]=t.x+1;break;case"s":i[0]=t.x+1}else switch(e){case"e":i[1]=t.y2;break;case"w":i[1]=t.y2;break;case"n":i[0]=t.x2;break;case"s":i[0]=t.x2}dt.setCurrent(i),ft.update()}}function d(e){var t=e;return ht.watchKeys(),function(e){dt.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,ft.update()}}function p(e){switch(e){case"n":return"sw";case"s":return"nw";
case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function f(e){return function(t){return L.disabled?!1:"move"!==e||L.allowMove?(j=s(q),nt=!0,u(e,o(t)),t.stopPropagation(),t.preventDefault(),!1):!1}}function m(e,t,i){var n=e.width(),a=e.height();n>t&&t>0&&(n=t,a=t/e.width()*e.height()),a>i&&i>0&&(a=i,n=i/e.height()*e.width()),tt=e.width()/n,it=e.height()/a,e.width(n).height(a)}function h(e){return{x:e.x*tt,y:e.y*it,x2:e.x2*tt,y2:e.y2*it,w:e.w*tt,h:e.h*it}}function g(){var e=dt.getFixed();e.w>L.minSelect[0]&&e.h>L.minSelect[1]?(ft.enableHandles(),ft.done()):ft.release(),mt.setCursor(L.allowSelect?"crosshair":"default")}function v(e){if(L.disabled)return!1;if(!L.allowSelect)return!1;nt=!0,j=s(q),ft.disableHandles(),mt.setCursor("crosshair");var t=o(e);return dt.setPressed(t),ft.update(),mt.activateHandlers(b,g),ht.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function b(e){dt.setCurrent(e),ft.update()}function _(){var t=e("<div></div>").addClass(a("tracker"));return e.ui.ie&&t.css({opacity:0,backgroundColor:"white"}),t}function w(e){G.removeClass().addClass(a("holder")).addClass(e)}function C(e,t){function i(){window.setTimeout(b,d)}var n=e[0]/tt,a=e[1]/it,r=e[2]/tt,s=e[3]/it;if(!at){var o=dt.flipCoords(n,a,r,s),l=dt.getFixed(),u=[l.x,l.y,l.x2,l.y2],c=u,d=L.animationDelay,p=o[0]-u[0],f=o[1]-u[1],m=o[2]-u[2],h=o[3]-u[3],g=0,v=L.swingSpeed;x=c[0],y=c[1],r=c[2],s=c[3],ft.animMode(!0);var b=function(){return function(){g+=(100-g)/v,c[0]=x+g/100*p,c[1]=y+g/100*f,c[2]=r+g/100*m,c[3]=s+g/100*h,g>=99.8&&(g=100),100>g?(T(c),i()):(ft.done(),"function"==typeof t&&t.call(gt))}}();i()}}function S(e){T([e[0]/tt,e[1]/it,e[2]/tt,e[3]/it]),L.onSelect.call(gt,h(dt.getFixed())),ft.enableHandles()}function T(e){dt.setPressed([e[0],e[1]]),dt.setCurrent([e[2],e[3]]),ft.update()}function k(){return h(dt.getFixed())}function I(){return dt.getFixed()}function D(e){l(e),N()}function P(){L.disabled=!0,ft.disableHandles(),ft.setCursor("default"),mt.setCursor("default")
}function E(){L.disabled=!1,N()}function R(){ft.done(),mt.activateHandlers(null,null)}function A(){G.remove(),O.show(),O.css("visibility",""),e(t).removeData("Jcrop")}function F(e,t){ft.release(),P();var i=new Image;i.onload=function(){var n=i.width,a=i.height,r=L.boxWidth,s=L.boxHeight;q.width(n).height(a),q.attr("src",e),W.attr("src",e),m(q,r,s),H=q.width(),V=q.height(),W.width(H).height(V),ot.width(H+2*st).height(V+2*st),G.width(H).height(V),pt.resize(H,V),E(),"function"==typeof t&&t.call(gt)},i.src=e}function M(e,t,i){var n=t||L.bgColor;L.bgFade&&r()&&L.fadeTime&&!i?e.animate({backgroundColor:n},{queue:!1,duration:L.fadeTime}):e.css("backgroundColor",n)}function N(e){L.allowResize?e?ft.enableOnly():ft.enableHandles():ft.disableHandles(),mt.setCursor(L.allowSelect?"crosshair":"default"),ft.setCursor(L.allowMove?"move":"default"),L.hasOwnProperty("trueSize")&&(tt=L.trueSize[0]/H,it=L.trueSize[1]/V),L.hasOwnProperty("setSelect")&&(S(L.setSelect),ft.done(),delete L.setSelect),pt.refresh(),L.bgColor!=lt&&(M(L.shade?pt.getShades():G,L.shade?L.shadeColor||L.bgColor:L.bgColor),lt=L.bgColor),ut!=L.bgOpacity&&(ut=L.bgOpacity,L.shade?pt.refresh():ft.setBgOpacity(ut)),X=L.maxSize[0]||0,J=L.maxSize[1]||0,Z=L.minSize[0]||0,et=L.minSize[1]||0,L.hasOwnProperty("outerImage")&&(q.attr("src",L.outerImage),delete L.outerImage),ft.refresh()}var j,L=e.extend({},e.Jcrop.defaults),U=!1;"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof i&&(i={}),l(i);var B={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},O=e(t),$=!0;if("IMG"==t.tagName){if(0!=O[0].width&&0!=O[0].height)O.width(O[0].width),O.height(O[0].height);else{var z=new Image;z.src=O[0].src,O.width(z.width),O.height(z.height)}var q=O.clone().removeAttr("id").css(B).show();q.width(O.width()),q.height(O.height()),O.after(q).hide()}else q=O.css(B).show(),$=!1,null===L.shade&&(L.shade=!0);m(q,L.boxWidth,L.boxHeight);var H=q.width(),V=q.height(),G=e("<div />").width(H).height(V).addClass(a("holder")).css({position:"relative",backgroundColor:L.bgColor}).insertAfter(O).append(q);
L.addClass&&G.addClass(L.addClass);var W=e("<div />"),Q=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),K=e("<div />").width("100%").height("100%").css("zIndex",320),Y=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=dt.getFixed();L.onDblClick.call(gt,e)}).insertBefore(q).append(Q,K);$&&(W=e("<img />").attr("src",q.attr("src")).css(B).width(H).height(V),Q.append(W)),U&&Y.css({overflowY:"hidden"});var X,J,Z,et,tt,it,nt,at,rt,st=L.boundary,ot=_().width(H+2*st).height(V+2*st).css({position:"absolute",top:n(-st),left:n(-st),zIndex:290}).mousedown(v),lt=L.bgColor,ut=L.bgOpacity;j=s(q);var ct=function(){function e(){var e,t={},i=["touchstart","touchmove","touchend"],n=document.createElement("div");try{for(e=0;e<i.length;e++){var a=i[e];a="on"+a;var r=a in n;r||(n.setAttribute(a,"return;"),r="function"==typeof n[a]),t[i[e]]=r}return t.touchstart&&t.touchend&&t.touchmove}catch(s){return!1}}function t(){return L.touchSupport===!0||L.touchSupport===!1?L.touchSupport:e()}return{createDragger:function(e){return function(t){return t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,L.disabled?!1:"move"!==e||L.allowMove?(nt=!0,u(e,o(t)),t.stopPropagation(),t.preventDefault(),!1):!1}},newSelection:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,v(e)},isSupported:e,support:t()}}(),dt=function(){function e(e){e=s(e),m=p=e[0],h=f=e[1]}function t(e){e=s(e),c=e[0]-m,d=e[1]-h,m=e[0],h=e[1]}function i(){return[c,d]}function n(e){var t=e[0],i=e[1];0>p+t&&(t-=t+p),0>f+i&&(i-=i+f),h+i>V&&(i+=V-(h+i)),m+t>H&&(t+=H-(m+t)),p+=t,m+=t,f+=i,h+=i}function a(e){var t=r();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function r(){if(!L.aspectRatio)return l();var e,t,i,n,a=L.aspectRatio,r=L.minSize[0]/tt,s=L.maxSize[0]/tt,c=L.maxSize[1]/it,d=m-p,g=h-f,v=Math.abs(d),b=Math.abs(g),y=v/b;
return 0===s&&(s=10*H),0===c&&(c=10*V),a>y?(t=h,i=b*a,e=0>d?p-i:i+p,0>e?(e=0,n=Math.abs((e-p)/a),t=0>g?f-n:n+f):e>H&&(e=H,n=Math.abs((e-p)/a),t=0>g?f-n:n+f)):(e=m,n=v/a,t=0>g?f-n:f+n,0>t?(t=0,i=Math.abs((t-f)*a),e=0>d?p-i:i+p):t>V&&(t=V,i=Math.abs(t-f)*a,e=0>d?p-i:i+p)),e>p?(r>e-p?e=p+r:e-p>s&&(e=p+s),t=t>f?f+(e-p)/a:f-(e-p)/a):p>e&&(r>p-e?e=p-r:p-e>s&&(e=p-s),t=t>f?f+(p-e)/a:f-(p-e)/a),0>e?(p-=e,e=0):e>H&&(p-=e-H,e=H),0>t?(f-=t,t=0):t>V&&(f-=t-V,t=V),u(o(p,f,e,t))}function s(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>H&&(e[0]=H),e[1]>V&&(e[1]=V),[e[0],e[1]]}function o(e,t,i,n){var a=e,r=i,s=t,o=n;return e>i&&(a=i,r=e),t>n&&(s=n,o=t),[a,s,r,o]}function l(){var e,t=m-p,i=h-f;return X&&Math.abs(t)>X&&(m=t>0?p+X:p-X),J&&Math.abs(i)>J&&(h=i>0?f+J:f-J),et/it&&Math.abs(i)<et/it&&(h=i>0?f+et/it:f-et/it),Z/tt&&Math.abs(t)<Z/tt&&(m=t>0?p+Z/tt:p-Z/tt),0>p&&(m-=p,p-=p),0>f&&(h-=f,f-=f),0>m&&(p-=m,m-=m),0>h&&(f-=h,h-=h),m>H&&(e=m-H,p-=e,m-=e),h>V&&(e=h-V,f-=e,h-=e),p>H&&(e=p-V,h-=e,f-=e),f>V&&(e=f-V,h-=e,f-=e),u(o(p,f,m,h))}function u(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var c,d,p=0,f=0,m=0,h=0;return{flipCoords:o,setPressed:e,setCurrent:t,getOffset:i,moveOffset:n,getCorner:a,getFixed:r}}(),pt=function(){function t(e,t){m.left.css({height:n(t)}),m.right.css({height:n(t)})}function i(){return a(dt.getFixed())}function a(e){m.top.css({left:n(e.x),width:n(e.w),height:n(e.y)}),m.bottom.css({top:n(e.y2),left:n(e.x),width:n(e.w),height:n(V-e.y2)}),m.right.css({left:n(e.x2),width:n(H-e.x2)}),m.left.css({width:n(e.x)})}function r(){return e("<div />").css({position:"absolute",backgroundColor:L.shadeColor||L.bgColor}).appendTo(f)}function s(){p||(p=!0,f.insertBefore(q),i(),ft.setBgOpacity(1,0,1),W.hide(),o(L.shadeColor||L.bgColor,1),ft.isAwake()?u(L.bgOpacity,1):u(1,1))}function o(e,t){M(d(),e,t)}function l(){p&&(f.remove(),W.show(),p=!1,ft.isAwake()?ft.setBgOpacity(L.bgOpacity,1,1):(ft.setBgOpacity(1,1,1),ft.disableHandles()),M(G,0,1))}function u(e,t){p&&(L.bgFade&&!t?f.animate({opacity:1-e},{queue:!1,duration:L.fadeTime}):f.css({opacity:1-e}))
}function c(){L.shade?s():l(),ft.isAwake()&&u(L.bgOpacity)}function d(){return f.children()}var p=!1,f=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),m={top:r(),left:r().height(V),right:r().height(V),bottom:r()};return{update:i,updateRaw:a,getShades:d,setBgColor:o,enable:s,disable:l,resize:t,refresh:c,opacity:u}}(),ft=function(){function t(t){var i=e("<div />").css({position:"absolute",opacity:L.borderOpacity}).addClass(a(t));return Q.append(i),i}function i(t,i){var n=e("<div />").mousedown(f(t)).css({cursor:t+"-resize",position:"absolute",zIndex:i}).addClass("ord-"+t);return ct.support&&n.bind("touchstart.jcrop",ct.createDragger(t)),K.append(n),n}function r(e){var t=L.handleSize;return i(e,I++).css({opacity:L.handleOpacity}).width(t).height(t).addClass(a("handle"))}function s(e){return i(e,I++).addClass("jcrop-dragbar")}function o(e){var t;for(t=0;t<e.length;t++)E[e[t]]=s(e[t])}function l(e){var i,n;for(n=0;n<e.length;n++){switch(e[n]){case"n":i="hline";break;case"s":i="hline bottom";break;case"e":i="vline right";break;case"w":i="vline"}D[e[n]]=t(i)}}function u(e){var t;for(t=0;t<e.length;t++)P[e[t]]=r(e[t])}function c(e,t){L.shade||W.css({top:n(-t),left:n(-e)}),Y.css({top:n(t),left:n(e)})}function d(e,t){Y.width(e).height(t)}function p(){var e=dt.getFixed();dt.setPressed([e.x,e.y]),dt.setCurrent([e.x2,e.y2]),m()}function m(e){return k?g(e):void 0}function g(e){var t=dt.getFixed();d(t.w,t.h),c(t.x,t.y),L.shade&&pt.updateRaw(t),k||b(),e?L.onSelect.call(gt,h(t)):L.onChange.call(gt,h(t))}function v(e,t,i){(k||t)&&(L.bgFade&&!i?q.animate({opacity:e},{queue:!1,duration:L.fadeTime}):q.css("opacity",e))}function b(){Y.show(),L.shade?pt.opacity(ut):v(ut,!0),k=!0}function y(){C(),Y.hide(),L.shade?pt.opacity(1):v(1),k=!1,L.onRelease.call(gt)}function x(){R&&K.show()}function w(){return R=!0,L.allowResize?(K.show(),!0):void 0}function C(){R=!1,K.hide()}function S(e){at===e?C():w()}function T(){S(!1),p()}var k,I=370,D={},P={},E={},R=!1;L.dragEdges&&e.isArray(L.createDragbars)&&o(L.createDragbars),e.isArray(L.createHandles)&&u(L.createHandles),L.drawBorders&&e.isArray(L.createBorders)&&l(L.createBorders),e(document).bind("touchstart.jcrop-ios",function(t){e(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()
});var A=_().mousedown(f("move")).css({cursor:"move",position:"absolute",zIndex:360});return ct.support&&A.bind("touchstart.jcrop",ct.createDragger("move")),Q.append(A),C(),{updateVisible:m,update:g,release:y,refresh:p,isAwake:function(){return k},setCursor:function(e){A.css("cursor",e)},enableHandles:w,enableOnly:function(){R=!0},showHandles:x,disableHandles:C,animMode:S,setBgOpacity:v,done:T}}(),mt=function(){function t(){ot.css({zIndex:450}),ct.support&&e(document).bind("touchmove.jcrop",s).bind("touchend.jcrop",l),p&&e(document).bind("mousemove.jcrop",n).bind("mouseup.jcrop",a)}function i(){ot.css({zIndex:290}),e(document).unbind(".jcrop")}function n(e){return c(o(e)),!1}function a(e){return e.preventDefault(),e.stopPropagation(),nt&&(nt=!1,d(o(e)),ft.isAwake()&&L.onSelect.call(gt,h(dt.getFixed())),i(),c=function(){},d=function(){}),!1}function r(e,i){return nt=!0,c=e,d=i,t(),!1}function s(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,n(e)}function l(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,a(e)}function u(e){ot.css("cursor",e)}var c=function(){},d=function(){},p=L.trackDocument;return p||ot.mousemove(n).mouseup(a).mouseout(a),q.before(ot),{activateHandlers:r,setCursor:u}}(),ht=function(){function t(){L.keySupport&&(r.show(),r.focus())}function i(){r.hide()}function n(e,t,i){L.allowMove&&(dt.moveOffset([t,i]),ft.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function a(e){if(e.ctrlKey||e.metaKey)return!0;rt=e.shiftKey?!0:!1;var t=rt?10:1;switch(e.keyCode){case 37:n(e,-t,0);break;case 39:n(e,t,0);break;case 38:n(e,0,-t);break;case 40:n(e,0,t);break;case 27:L.allowSelect&&ft.release();break;case 9:return!0}return!1}var r=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}),s=e("<div />").css({position:"absolute",overflow:"hidden"}).append(r);return L.keySupport&&(r.keydown(a).blur(i),U||!L.fixedSupport?(r.css({position:"absolute",left:"-20px"}),s.append(r).insertBefore(q)):r.insertBefore(q)),{watchKeys:t}
}();ct.support&&ot.bind("touchstart.jcrop",ct.newSelection),K.hide(),N(!0);var gt={setImage:F,animateTo:C,setSelect:S,setOptions:D,tellSelect:k,tellScaled:I,setClass:w,disable:P,enable:E,cancel:R,release:ft.release,destroy:A,focus:ht.watchKeys,getBounds:function(){return[H*tt,V*it]},getWidgetSize:function(){return[H,V]},getScaleFactor:function(){return[tt,it]},getOptions:function(){return L},ui:{holder:G,selection:Y}};return e.ui.ie&&G.bind("selectstart",function(){return!1}),O.data("Jcrop",gt),gt},e.fn.Jcrop=function(t,i){var n;return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"}),n=e.Jcrop(this,t),e.isFunction(i)&&i.call(n)}):(e(this).css({display:"block",visibility:"hidden"}),n=e.Jcrop(this,t),e.isFunction(i)&&i.call(n))}),this},e.Jcrop.Loader=function(t,i,n){function a(){s.complete?(r.unbind(".jcloader"),e.isFunction(i)&&i.call(s)):window.setTimeout(a,50)}var r=e(t),s=r[0];r.bind("load.jcloader",a).bind("error.jcloader",function(){r.unbind(".jcloader"),e.isFunction(n)&&n.call(s)}),s.complete&&e.isFunction(i)&&(r.unbind(".jcloader"),i.call(s))},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:7,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(e)}),define("tau/ui/behaviour/overlay/ui.behaviour.overlay",["Underscore","jQuery"],function(e,t){t.widget("ui.tauOverlay",{options:{showOnCreation:!0},_create:function(){this.$target=this.element,this.options.showOnCreation&&this.show()
},showLarge:function(){this._show("ui-spinner-centered")},show:function(){this._show("ui-overlay")},_show:function(e){var i=this;i.$overlay=i.overlay||t(['<div class="',e,'"></div>'].join("")),i.$overlay.detach(),i.$target.addClass("ui-overlay-container");var n=t("body");n="relative"===i.$target.css("position")?i.$target:i.$target.offsetParent(),n.append(i.$overlay)},hide:function(){var e=this;e.destroy()},destroy:function(){var e=this;e.$target.removeClass("ui-overlay-container"),e.$overlay&&e.$overlay.remove(),t.Widget.prototype.destroy.apply(this,arguments)}})}),define("tau/ui/extensions/avatar/ui.extension.avatar.editor",["app.path","Underscore","jQuery","tau/components/extensions/component.extension.base","tau/core/tau","libs/jquery/jquery.fileupload","libs/jquery/jquery.iframe-transport","libs/jquery/jquery.Jcrop","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(e,t,i,n,a){return n.extend({"bus afterRender":function(e){e.data.element.find(".file-input").fileupload({url:this._getUploadUrl(),formData:this._getFormData(),add:t.bind(this._onFileAdd,this)}),this.avatarService=this.config.context.configurator.getAvatarService(),e.data.element.find(".crop-avatar").click(t.bind(this.onCropClick,this)),e.data.element.find(".remove-avatar").click(t.bind(this.onRemoveClick,this)),e.data.element.find(".tau-save-crop").click(t.bind(this.onSaveClick,this)),e.data.element.find(".tau-cancel-crop").click(t.bind(this.onCancelClick,this));var i=e.data.element.find(".tau-avatar-crop-container"),n=i.css("max-width");this.fire("view.max.width.calculated",n)},onCancelClick:function(){this.fire("view.save.cancel")},onSaveClick:function(){this.fire("view.save.crop")},onRemoveClick:function(){this.fire("view.lock"),this.fire("view.remove.avatar")},onCropClick:function(){this.fire("view.initialize.crop")},"bus model.crop.ready:last+view.initialize.crop":function(e,t){this.fire("view.lock"),this.fire("view.edit.avatar.with.url",{url:this.getOriginAvatarUrl(this._getGeneralId()),cropRect:t})
},"bus view.edit.avatar.with.url:last+view.crop.selected:last+afterRender:last+view.save.crop":function(e,t,n,a){{var r=a.element.find(".tau-avatar-crop-container .tau-img:visible"),s=r[0].naturalWidth/r.width(),o=r[0].naturalHeight/r.height(),l=this.getCropAvatarUrl(t.url,{x:parseInt(n.x*s),y:parseInt(n.y*o),w:parseInt(n.w*o),h:parseInt(n.h*o)});r.width()/r[0].naturalWidth}this.fire("view.image.will.crop"),this.avatarService.crop(l).done(i.proxy(function(e){this.fire("view.image.did.cropped",e),this.fire("model.crop.ready",{x:l.x,y:l.y,width:l.w,height:l.h})},this)).fail(i.proxy(function(e){this.fire("error",{message:e.Message,disableAutoClose:!0}),this.fire("view.hide.avatar.editor"),this.fire("view.unlock")},this))},"bus afterRender:last+view.hide.avatar.editor":function(e,t,i){var n=this;t.element.find(".tau-avatar-crop-container").slideUp(function(){i&&1==i.close&&n.fire("close",{animated:!0})}),t.element.find(".drop-down-list__inner").show()},"bus afterRender:last+view.show.avatar.editor":function(e,t){t.element.find(".tau-avatar-crop-container").slideDown(),t.element.find(".drop-down-list__inner").hide()},"bus afterRender:last+view.lock":function(e,t){t.element.tauOverlay()},"bus afterRender:last+view.unlock":function(e,t){t.element.tauOverlay("hide")},"bus afterRender:last+view.save.cancel":function(){this.fire("view.hide.avatar.editor")},"bus jcrop.api.ready+view.image.will.crop":function(e,t){t.destroy(),this.fire("view.lock")},"bus avatar.did.removed":function(e,t){this.store.registerWithEvents([{id:t.Id,__type:"user",avatarUri:t.AvatarUri}]),this.fire("view.unlock")},"bus view.image.did.cropped":function(e){var t=e.data;this.store.registerWithEvents([{id:t.Id,__type:"user",avatarUri:t.AvatarUri}]),this.fire("view.hide.avatar.editor",{close:!0}),this.fire("view.unlock")},"bus view.remove.avatar":function(){this.fire("view.lock");var e=this.getRemoveAvatarUrl(this._getGeneralId());this.avatarService.remove(e).done(i.proxy(function(e){this.fire("avatar.did.removed",e)
},this)).fail(i.proxy(function(e){this.fire("error",{message:e.Message,disableAutoClose:!0}),this.fire("view.unlock")},this))},"bus view.files.selected":function(e,t){function i(e){var t=JSON.parse(e.responseText);n.fire("error",{message:t.Message,disableAutoClose:!0}),n.fire("view.unlock")}var n=this;n.fire("view.lock"),t.submit().done(function(e,t,a){try{e=JSON.parse(e)}catch(r){e=e.find("body").text(),a.responseText=e,e=JSON.parse(e)}e.Success===!0?n.fire("view.file.did.upload"):i(a)}).fail(i)},"bus afterRender:last+view.crop.selected":function(e,t){t.element.find(".tau-save-crop").attr("disabled",!1)},"bus jcrop.api.ready>before_view.file.did.upload":function(e,t){t.destroy()},"bus afterRender:last+view.crop.released":function(e,t){t.element.find(".tau-save-crop").attr("disabled",!0)},getTempAvatarUrl:function(t){var i=e.get()+"/Avatar.ashx?UserID="+t+"&source=temp&"+(new Date).getTime();return this._appendToken(i)},getRemoveAvatarUrl:function(t){var i=e.get()+"/Avatar.ashx?operation=remove&UserID="+t;return this._appendToken(i)},getOriginAvatarUrl:function(t){var i=e.get()+"/Avatar.ashx?UserID="+t+"&source=original&"+(new Date).getTime();return this._appendToken(i)},getCropAvatarUrl:function(e,t){var i=e+"&operation=crop&"+["x="+t.x,"y="+t.y,"width="+t.w,"height="+t.h].join("&");return this._appendToken(i)},_appendToken:function(e){var t=e;return e.indexOf("?token=")<0&&e.indexOf("&token=")<0&&(t+=a.getTokenParameterFromQueryString("&")),t},"bus afterRender:last+view.file.did.upload":function(){var e=this._getGeneralId(),t=this.getTempAvatarUrl(e);this.fire("view.hide.avatar.editor"),this.fire("view.edit.avatar.with.url",{url:t})},"bus jcrop.api.ready>before_view.edit.avatar.with.url":function(e,t){t.destroy()},"bus afterRender:last+view.max.width.calculated:last+view.edit.avatar.with.url":function(e,t,n,a){var r=this,s=t.element.find(".tau-avatar-crop-container");s.css("max-width",n);var o=t.element.find(".tau-avatar-crop-container .tau-img:first-child");o.css("width","").css("height","").prop("src",a.url);
var l=a.cropRect,u=function(){if(0==t.element.is(":visible"))return void r.fire("view.unlock");r.fire("view.show.avatar.editor"),t.element.find(".tau-save-crop").attr("disabled",!0);var e=o.width(),n=o.height(),a=48,u=t.element,c=u.offset(),d=i(window).height()-50-c.top;if(n>d){var p=d*e/n;s.css("max-width",p),e=o.width(),n=o.height()}var f=o.width()/o[0].naturalWidth,m=null;l&&(m=[l.x*f,l.y*f,l.width*f,l.height*f],m[2]+=m[0],m[3]+=m[1]),o.Jcrop({aspectRatio:1,minSize:[a,a],setSelect:m?m:[0,0,e,n],onSelect:function(e){r.fire("view.crop.selected",e)},onChange:function(e){r.fire("view.crop.selected",e)},onRelease:function(){r.fire("view.crop.released")}},function(){r.fire("view.unlock"),r.fire("jcrop.api.ready",this)})};o.on("load",u)},_getUploadUrl:function(){return e.get()+"/Avatar.ashx?UserID="+this._getGeneralId()+a.getTokenParameterFromQueryString("&")},_getFormData:function(){return[]},_getGeneralId:function(){return this.config.context.entity.id},_onFileAdd:function(e,t){t.files&&0!=t.files.length&&this.fire("view.files.selected",t)}})}),define("tau/ui/templates/avatar/ui.template.avatar.editor",["tau/core/templates-factory"],function(e){var t={name:"user.avatar.editor",markup:['<div class="ui-menu-actions tau-avatar-editor">','<div class="drop-down-list drop-down-list__inner i-inner">','<div class="ui-menu__item drop-down-option upload-photo" role="option">',"<span>Upload Image",'<input type="file" class="file-input" accept="image/*">',"</span>","</div>",'<div class="ui-menu__item drop-down-option crop-avatar">Edit Avatar</div>','<div class="ui-menu__item drop-down-option remove-avatar" role="option">Remove</div>',"</div>",'<div class="tau-avatar-crop-container" style="display: none; max-width: 600px;">','<img class="tau-img"  width="100%;" />','<div class="tau-avatar-button-panel">','<button type="button" class="tau-btn tau-save-crop tau-primary">Update Avatar</button> ','<button type="button" class="tau-btn tau-cancel-crop">Cancel</button> ',"</div>","</div>","</div>"].join("")};
return e.register(t)}),define("tau/components/component.avatar.editor",["tau/components/component.creator","tau/models/model.avatar","tau/ui/extensions/avatar/ui.extension.avatar.editor","tau/components/extensions/error/extension.errorBar","tau/ui/templates/avatar/ui.template.avatar.editor"],function(e,t,i,n,a){return{create:function(r){var s={name:"avatar.editor",extensions:[t,i,n],template:a};return r["queue.bus"]=!0,e.create(s,r)}}}),define("tau/ui/extensions/avatar/ui.extension.avatar",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var i=e.data.element,n=function(e){e.at="center bottom-10",e.my="center top"},a={target:i,onPositionConfig:n,onArrowPositionConfig:n,showEvent:this.config.editorConfig.showEvent||"mouseenter",hideEvent:"click",showCloseButton:!1,delay:100,onShow:function(){var e=this.target.tauBubble("widget");e.find(".tau-bubble__inner").attr("tabindex",-1).css("outline","none").focus(),e.on("keydown",function(i){i.keyCode==t.ui.keyCode.ESCAPE&&(e.hide().off("keydown"),i.stopPropagation())})},componentsConfig:{components:[{type:"avatar.editor"}],context:this.config.context},stackName:"avatar"};this.fire("initBubble",a)},"bus avatarChanged":function(){this.fire("refresh")}})}),define("tau/ui/templates/avatar/ui.template.avatar",["tau/core/templates-factory"],function(e){var t={name:"user.avatar",markup:['<div class="box ui-avatar tau-avatar_${id}">','<img src="${url}" /> ',"</div>"].join("")};return e.register(t)}),define("tau/components/component.avatar",["tau/components/component.creator","tau/models/model.avatar","tau/ui/extensions/avatar/ui.extension.avatar","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/avatar/ui.template.avatar"],function(e,t,i,n,a,r){return{create:function(s){s.isEdit&&(s.extensions=(s.extensions||[]).concat(n||[])),s.editorConfig=_.extend({},s.editorConfig);
var o={name:"avatar",extensions:[t,a,i].concat(s.extensions||[]),template:r};return e.create(o,s)}}}),define("tau/components/board.core/models/model.board.core",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(){},getMarks:function(e,t,i){return i.slice(0,t.size[e])},isLastPage:function(e,t,i){var n=this.getPageLimit(e,i);return t.length<n},getPageLimit:function(e,t){return Math.floor(1.25*t.size[e])+1},getSlicePagingArgs:function(e,t){var i=this.getPageLimit(e,t);return{$take:i,$skip:t.size[e]*t[e]}},isConfigured:function(t){return t?e.isString(t)?!0:t.id?!0:e.isArray(t.types)?t.types.length>0:!1:!1},getPagesCountForAxis:function(e,t){var i=Math.floor(e/t),n=e-i*t;return n>0&&n>.25*t&&i++,0===i&&(i=1),i},getEmptyModelInfoArgs:function(e){return{viewMode:"board",marksX:[],definition:e,x:this.getAxisNullPagingObject(),y:this.getAxisNullPagingObject(),zoomLevel:e.zoomLevel||3,marksY:[],page:{x:0,y:0}}},getAxisPagingObject:function(e,t,i){var n=this,a=n.isLastPage(e,t,i),r=a?n.getPageLimit(e,i):i.size[e],s=t.slice(0,r),o=i[e],l=0===o;return{isNull:!1,currentPage:o,isFirst:l,isLast:a,hasPrev:!l,prevPage:l?null:o-1,hasNext:!a,nextPage:a?null:o+1,data:s,onPage:s.length,maxOnPage:i.size[e]}},getAxisNullPagingObject:function(){return{currentPage:0,isFirst:!0,isLast:!0,hasPrev:!1,prevPage:null,hasNext:!1,nextPage:null,data:[],start:0,end:0,onPage:0,maxOnPage:0,total:0,totalPages:1}}})}),define("tau/components/board.new.list/models/model.new.list",["Underscore","tau/components/board.core/models/model.board.core"],function(e,t){return t.extend({init:function(){this.treeModelCreated=e.Callbacks()},findCardById:function(e){var t=this._rootModel.hierarchy.findChildByCardId(e);return t.card},setup:function(e,t){this._rootModel=e,this._definition=t,this.treeModelCreated.fire(e)},isNotConfigured:function(){var t=!e.any([this._definition.x,this._definition.y],this.isConfigured,this),i=!this.isConfigured(this._definition.cells);return t&&i},getIsEmptyObject:function(t){var i={isEmpty:t.isEmpty(),noCards:!1,noValuableAxis:!1,noCardsSetup:!1,noLanesSetup:!1,noSetup:!1};
return t.isCellLevel()?i.noCards=i.isEmpty:i.noValuableAxis=i.isEmpty,i.noLanesSetup=!e.any([this._definition.x,this._definition.y],this.isConfigured.bind(this)),i.noCardsSetup=!this.isConfigured(this._definition.cells),i.noSetup=i.noLanesSetup&&i.noCardsSetup,i},deleteCard:function(e,t){this._rootModel.deleteDescendantsByCardIdAndType(e,t)},refreshCard:function(e,t){this._rootModel.refreshDescendantsByCardIdAndType(e,t)},getEmptyModelInfoArgs:function(e){return{viewMode:"newlist",marksX:[],definition:e,x:this.getAxisNullPagingObject(),y:this.getAxisNullPagingObject(),zoomLevel:e.zoomLevel||3,marksY:[],page:{x:0,y:0}}}})}),define("tau/services/customize/service.customize.card.layout.factory",["jQuery","Underscore","tau/core/class","tau/models/board.customize.units/board.customize.units.settings.default","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n,a){return i.extend({name:"board",sizes:a,defaultSettings:n,init:function(e,t){this.configurator=e,this.boardSettings=t,this.unitProviders=[e.getUnitsRegistry(),e.getCustomFieldsUnitsFactory()]},getLayoutFactory:function(){return this.boardSettings.get({fields:["cells","cardSettings","zoomLevel"]}).then(t.bind(function(e){return this.createFactory(e)},this))},patch:function(e){return e&&e.impediment&&t.each(e.impediment,function(e){t.each(e,function(e){t.each(e,function(e){"assignments_big_2"==e.id&&(e.id="responsible_person")})})}),e},createFactory:function(e){var i=this.patch(e.cardSettings),n=this._zoomToSize(e.zoomLevel);return t.bind(function(e,t,i,n){return this.getLayout(e,i,n||t)},this,i,n)},getLayout:function(e,i,n){var a=t.chain(t.isArray(i)?i:[i]).compact().map(function(e){return e.toLowerCase()}).value(),r=this.findSettings(e,a,[n]),s=t.object(t.map(r,function(e,i){return[i,t.find(e,function(e,t){return t===n})||[]]}));return t.isArray(i)?s:s[a[0]]},getCardLayoutByType:function(e){return this.getCardLayoutByTypeAndSize(e)},getCardLayoutsByTypesAndSize:function(e,t){return this.getLayoutFactory().then(function(i){return i(e,t)
})},getCardLayoutByTypeAndSize:function(e,t){return this.getCardLayoutsByTypesAndSize([e],t).then(function(t){return t[e]})},getSavedSetting:function(e,t,i,n,a){return e&&e[n]&&e[n][a]},findSettings:function(e,i,n){var a=this,r=this.defaultSettings;return t.object(t.map(i,function(s){return s=s.toLowerCase(),[s,t.object(t.map(n,function(o){var l=a.getSavedSetting(e,i,n,s,o),u=!1;return l||(l=r.get(o,s),u=!0),l=t.map(l,function(e){return e=t.map(e,function(e){return t.extend({unit:a.findUnitById(e.id)},e)}),e=t.filter(e,function(e){return e.unit})}),l.isDefault=u,[o,l]}))]}))},_zoomToSize:function(e){return a.zoomToSize(e)},findUnitById:function(e){return t.chain(this.unitProviders).map(function(t){return t.getUnitById(e)}).compact().first().value()}})}),define("tau/services/customize/service.customize.card.layout.factory.newlist",["jQuery","Underscore","./service.customize.card.layout.factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n){return i.extend({name:"newlist",createFactory:function(e){return t.bind(function(e,t){var i=this.findSettings(e.cardSettings,t,[this.sizes.LIST]),n=this.getSavedSetting(e.cardSettings,t);return i=this.processOrderAndEmptyFields(i,n)},this,e)},getSavedSetting:function(e,t){var i=n.getListKeyByTypes(t);return e&&e[i]&&e[i].list},_replaceShortUnitsWithLong:function(e){var i=["long","full_length"];return t.map(e,function(e){var n=e,a=/.+_short$/;if(a.test(e.id))for(var r=0;r<i.length;r++){var s=e.id.replace(/(.+)_short$/,"$1_"+i[r]),o=this.findUnitById(s);if(o){n=t.defaults({id:s,unit:o},e);break}}return n}.bind(this))},processOrderAndEmptyFields:function(e,i){var n=this.sizes.LIST,a=function(e){var i=t.countBy(e,function(e){return e.id});return t.each(e,function(e){e.rank=i[e.id],e.unit.rank&&(e.rank=e.unit.rank)}),e},r=function(e,i){var n=i[0].reverse();return t.each(e,function(e){for(var t=0;t<n.length;t++)if(e.id==n[t].id){e.rank=t;break}}),e},s=t.chain(e).map(function(e){return e[n]}).flatten().value();s=i?r(s,i):a(s);
var o=t.chain(s).flatten().unique(function(e){return e.id}).value();return t.reduce(e,function(e,i,a){return e[a]=t.filter(o,function(e){return e.unit.isApplicableByTypeAndSize(a,n)}),0===e[a].length&&(e[a]=[{id:"name_unit_default",unit:this.findUnitById("name_unit_default"),isDefault:!0}]),e[a]=this._replaceShortUnitsWithLong(e[a]),e}.bind(this),{})}})}),define("tau/components/board.new.list/extensions/extension.new.list.cardLayout",["Underscore","tau/core/extension.base","tau/services/customize/service.customize.card.layout.factory.newlist"],function(e,t,i){return t.extend({"bus configurator.ready:last + boardSettings.ready":function(e,t,n){this.fire("cardLayoutFactory.ready",new i(t,n.boardSettings))}})}),define("tau/components/board.new.list/extensions/extension.new.list.selection",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $selectable.ready":function(e,t){t.tauSelectable("option",{triggerSelector:":checkbox",items:".i-role-nosuchcard"})}})}),define("tau/components/board.new.list/models/card.prioritizer",["Underscore"],function(e){return{isCardOnPage:function(t,i,n,a){if(!i.length)return!0;var r,s,o=a.pageSize===i.length,l=!o&&e.isNumber(a.prevOrderingValue)?a.prevOrderingValue:e.first(i),u=!o&&e.isNumber(a.nextOrderingValue)?a.nextOrderingValue:e.last(i),c=t;return n?(s=c>l,r=u>c):(s=l>c,r=c>u),s=s&&a.hasPrev,r=r&&a.hasNext,!s&&!r}}}),define("tau/components/board.new.list/models/node.modification.strategies",["Underscore","tau/core/class","./card.prioritizer"],function(e,t,i){var n=t.extend({addCard:function(e,t){var i=e.hierarchy.findChildByCardId(t.id);return i?!1:(this._addCardInternal(e.nodes,t,!0),!0)},_addCardInternal:function(e,t,i){var n=e.createChildNode(t);e.items.push(n),i&&e.sortCards(),e.cardAdded.fire({nodeModel:n,card:n.card,index:e.findCardIndex(n.card)})},updateCard:function(e,t,i){var n=e.createCard(i),a=t.card,r=!!a,s=this._isOnPage(e,n),o=e.isPrioritizable,l=o&&s;r?s||!o?e.updateCardWith(n,a,l):e.removeCardFromView(a):l&&this._addCardInternal(e,n,!0)
},_isOnPage:function(t,n){if("Rank"!=t.ordering.name)return!0;var a=e.chain(t.items).filter(function(e){return!e.hasNoValueCard()&&e.card.id!==n.id}).map(function(e){return e.card.orderingValue}).value(),r="asc"==t.ordering.direction.toLowerCase();return i.isCardOnPage(n.orderingValue,a,r,t.pagingModel)}}),a=n.extend({addCard:function(e,t){var i=!e.nodes;if(i)return this._increaseCount(e,t),!1;var n=e.hierarchy.findChildByCardId(t.id);if(n)return!1;var a=this._isOnPage(e.nodes,t);return a?(this._addCardInternal(e.nodes,t,e.nodes.isPrioritizable),!0):(this._increaseCount(e,t),!1)},_increaseCount:function(e,t){e.countsModel.increaseCount(t.type)}});return{regular:new n,comet:new a}}),define("tau/components/board.new.list/models/comet.dispatcher",["Underscore","./node.modification.strategies"],function(e,t){return{tryDispatchOperations:function(t,i){if(!i)return!1;var n=e.flatMap(i,function(i){if(i.shouldBePropagated){var n=t.hierarchy.getAllNodesAtLevel(i.level);return e.map(n,function(t){var n=e.deepClone(i);return n.path=t.hierarchy.getPath(),n})}return[i]}),a=e.groupBy(n,e.property("name"));return e.reduce(a,function(e,i,n){return this._executeOperations(t,i,n)||e},!1,this)},_executeOperations:function(e,t,i){var n={added:this._onAdded,updated:this._onUpdated,deleted:this._onDeleted,notinslice:this._onNotInSlice},a=n[i];return a?(a.call(this,e,t),!0):!1},_onAdded:function(i,n){e.each(n,function(e){var n=i.hierarchy.findNodeByPath(e.path);n&&t.comet.addCard(n,e.card)})},_onUpdated:function(i,n){var a=e.groupBy(n,e.property("level"));e.each(a,function(n,a){a=parseFloat(a);var r=e.chain(n).pluck("card").uniq(function(e){return e.id+";"+e.type}).value(),s=e.flatMap(r,function(e){return this._getNodesAtLevel(i,a,e)},this),o=e.map(n,function(e){return{dataItem:e.card,path:e.path}});i.applyCardsChanges(t.comet,s,{data:o})},this)},_onDeleted:function(t,i){e.each(i,function(e){t.deleteDescendantsByCardIdAndType(e.card.id,e.card.type)})},_onNotInSlice:function(t,i){e.each(i,function(i){var n=this._getNodesAtLevel(t,i.level,i.card);
e.each(n,function(e){e.parent.nodes.deleteCard(e.card)})},this)},_getNodesAtLevel:function(t,i,n){var a=t.hierarchy.findAllDescendantNodesByCardIdAndType(n.id,n.type);return e.filter(a,function(e){return e.level===i})}}}),define("tau/components/board.new.list/extensions/extension.new.list.operations",["Underscore","jQuery","tau/core/extension.base","tau/components/board.new.list/models/comet.dispatcher"],function(e,t,i,n){return i.extend({init:function(e,t){this.model=t,this._super(e)},"bus comet.tick":function(e,t){this.fire("operation.execute",t.data)},"bus configurator.ready:last + operation.execute":function(e,t,i){this.executeCometOperation(i)},executeCometOperation:function(t){var i=e.map(t.items,this._getOperationData.bind(this,t));this._executeOperations(i)},_getOperationData:function(t,i){var n=e.cloneDeep(i.data);return n.path=n.path||[],{name:(i.modification||t.name).toLowerCase(),path:n.path,card:n.dataItem||n.data,levelType:i.levelType,shouldBePropagated:i.shouldBePropagated,level:i.level,options:t.options,items:t.items,reason:t.reason}},_executeOperations:function(e){n.tryDispatchOperations(this.model._rootModel,e)&&this.fire("operation.execute.done")}})}),define("tau/components/board.new.list/templates/template.new.list",["tau/core/templates-factory"],function(e){var t={name:"new.list",engine:"jqote2",markup:['<div class="i-role-board-body tau-board-body" id="<%=fn.uid(\'boardBody\')%>">','<div class="i-role-grid tau-board-list-view i-role-board-body">','<div class="tau-board-list-view__inner">','<div class="i-role-list-root-container">','<div class="tau-board-list-view-resizer"></div>',"</div>","</div>",'<div class="i-role-pagingholder tau-list-pagingholder"></div>',"</div>","</div>"]};return e.register(t)}),define("tau/components/board.new.list/templates/template.new.list.subtree",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"new.list.subtree",engine:"jqote2",customFunctions:{getLevelId:function(){return e.uniqueId("tau-list-level-")
},getListLevelClassName:function(e){return"tau-list-level tau-list-level-"+e.level+(0===e.items.length?" tau-list-level-empty":"")}},markup:['<div id="<%= fn.getLevelId() %>" class="<%= fn.getListLevelClassName(this) %>" data-list-parent-id="<%= this.cardId %>" data-list-level="<%= this.level %>" data-list-level-key="<%= this.getLevelKey() %>">','<div class="i-role-headerholder textSelectionDisabled"></div>','<div class="i-role-cardsholder"></div>',"</div>"]};return t.register(i)}),define("tau/ui/extensions/board.plus/ui.board.plus.dom.utils",["Underscore","jQuery"],function(e,t){return{createDragNDropPlaceholderContent:function(e){var t;return t=e===!0?"Prioritization on":e===!1?"Prioritization off":"shift"===e?'Hold <span class="shiftButton"></span> to prioritize':""},animated:function(e,i){var n=t.Deferred();return e.animateWithCss({cssClassName:i,complete:n.resolve.bind(null,e)}),n.promise()},redirectEvent:function(e,t){return t.target=null,e.trigger(t),!1}}}),define("tau/components/board.new.list/templates/template.new.list.header",["tau/core/templates-factory"],function(e){var t={name:"new.list.header",engine:"jqote2",markup:["<div class=\"tau-list-caption <%= fn.cond(!this.enable, 'tau-list-caption-disabled') %>\">",'<div class="tau-elems-table tau-elems-table-level-<%= this.levelKey %>">','<div class="tau-drag-handler-cell"></div>',"<% if (this.renderCollapser) { %>",'<div class="tau-list-collapser-cell"><button class="i-role-header-collapser tau-v-collapser tau-v-header-collapser"></button></div>',"<% } %>","<% _.each(this.layout, function(item, index) { %>",'<%= fn.sub(item.unit.getTemplateName("header"), _.extend({unit: item.unit, first: !index, ordering: this.ordering, renderSortingHeaders:this.renderSortingHeaders}, this)) %>',"<% }, this); %>","</div>","</div>"]};return e.register(t)}),define("tau/ui/extensions/board.plus/ui.board.plus.cards-custom-functions",["Underscore","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t){function i(e){return function(t,i){return e==t?void 0:i
}}return{_:e,generateDataAttributes:function(e){var n=e.data.cardData,a={id:e.id,"entity-type":n.type.toLowerCase(),"ordering-value":e.orderingValue,"entity-id":n.id,"card-data":JSON.stringify(n),"data-item":JSON.stringify(e,i("data"))};return e._id&&(a._id=e._id),t.generateElementData(a)},generateCardId:e.bind(t.generateCardId,t),generateFinalStateClass:function(e){return e.isFinal?"tau-card-v2_final-state":""},generateIsInPastClass:function(e){return e.isInPast?"tau-card-v2_isInPast":""}}}),define("tau/ui/templates/board.plus/customized/ui.template.boardplus.card.section.customized",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i){var n={name:"boardplus.card.section.customized",engine:"jqote2",customFunctions:{getSectionAdditionalClass:i.getClassForCustomizeSection,isLazy:function(e,t){return e===!1?!1:t.unit.lazy},getData:function(e,t,i){return t.unit.lazy?e===!1?i[t.unit.id]:t.unit.sampleData:i[t.unit.id]}},markup:["<% var data = this.data, configurator = this.configurator; %>",'<div class="tau-card-v2__section <%=fn.getSectionAdditionalClass(this.section)%>">',"<%this.section.forEach(function(item){%>",'<%= fn.sub(item.unit.getTemplateName("card"), [{settings:{ metaData:{ alignment:item.alignment } }, data:data[item.unit.id], configurator:configurator}])%>',"<%});%>","</div>"],dependencies:[]};return t.register(n)}),define("tau/components/board.new.list/templates/template.new.list.card.customized",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/extensions/board.plus/ui.board.plus.cards-custom-functions","tau/ui/templates/board.plus/customized/ui.template.boardplus.card.section.customized"],function(e,t,i,n){var a=e.extend({},n,{generateCardClass:function(e,t){return["i-role-card","tau-list-entity",this.generateFinalStateClass(t),this.generateIsInPastClass(t),this.generateListClass(e,t)].join(" ")},generateListClass:function(e,t){var n="tau-list-"+t.type.toLowerCase(),a=e.data.empty;
return a&&(n+=" tau-axis-card-no-value"),i.isSupportedCardForView(t.type.toLowerCase())||(n+=" tau-axis-card-no-view"),n},generateHandlerClass:function(e){var t=e.isNoValueCard();return"tau-drag-handler tau-drag-handler-level-"+e.levelKey+(t?" tau-drag-handler-disabled":" tau-drag-handler-enabled")},generateFinalStateClass:function(e){return e.isFinal?this.getFinalStateClass():""},generateIsInPastClass:function(e){return e.isInPast?this.getIsInPastClass():""},getFinalStateClass:function(){return"tau-list-entity_final-state"},getIsInPastClass:function(){return"tau-list-entity_isInPast"},generateCardCollapserClass:function(e){var t="tau-list-collapser-cell";return e.isCollapserEnabled||(t+=" disabled"),t}}),r={engine:"jqote2",customFunctions:a,name:"new.list.card.customized",markup:["<% var dataItem = this.dataItem, configurator = this.configurator; %>","<% var cardData = dataItem.data.cardData || { id: dataItem.id, type: dataItem.type }; %>","<% dataItem.data.cardData = cardData; %>",'<div role="card" id="<%= fn.generateCardId(cardData) %>" class="<%= fn.generateCardClass(dataItem, cardData) %>" <%= fn.generateDataAttributes(dataItem) %>>','<div class="tau-list-line">','<div class="tau-elems-table tau-elems-table-level-<%= dataItem.levelKey %>">','<div class="tau-drag-handler-cell i-role-dragndrop-handler">','<div class="<%= fn.generateHandlerClass(dataItem) %>"></div>',"</div>","<% if (dataItem.renderCollapser) { %>",'<div class="<%= fn.generateCardCollapserClass(dataItem) %>"><button class="i-role-card-collapser tau-v-collapser"></button></div>',"<% } %>","<% var type = cardData.type.toLowerCase(); %>","<% _.each(this.layout, function(item, index) { %>","<% var data = dataItem.data[item.unit.id]; %>","<% if (dataItem.data.empty) { %>","<% if (!item.unit.isNameUnit) {","<% return; %>","<% } %>","<% data = dataItem.data; %>","<% } %>","<% var itemData = {type: type, settings: {width: item.width},data: data, configurator: configurator, first: !index, unit: item, renderDetailsTrigger: dataItem.renderDetailsTrigger}; %>",'<%= fn.sub(item.unit.getTemplateName("list"), [itemData]) %>',"<% }, this); %>","</div>","</div>","</div>"]};
return t.register(r)}),define("tau/ui/templates/board.plus/ui.template.board.plus.emptyMessage",["tau/core/templates-factory"],function(e){return e.register({name:"board.plus.emptyMessage",engine:"jqote2",markup:['<% var isEmpty = this.type == "isEmpty"; %>','<div class="tau-no-data-in-slice <% if (!isEmpty) { %>tau-notconfigured<% } %> i-role-empty-message">','<div class="tau-empty-message">','<h2 class="<% if (isEmpty) { %>tau-no-data_empty<% } %> i-role-empty-message-text">',"<%! this.message %>","</h2>","<% if (!isEmpty) { %>",'<div class="tau-col">','<div class="tau-txt">Select the cards you want<br />to see in the View</div>','<div class="tau-step-pic tau-step1-pic"></div>',"</div>",'<div class="tau-col">','<div class="tau-txt">Set horizontal<br />and vertical lanes</div>','<div class="tau-step-pic tau-step2-pic"></div>',"</div>",'<div class="tau-col">','<div class="tau-txt">Use filters</div>','<div class="tau-step-pic tau-step3-pic"></div>',"</div>","<% } %>","</div>","</div>"]})}),define("tau/components/board.new.list/views/editors/editor.utils",[],function(){return{toggleElementBusyIndicator:function(e,t){return e.toggleClass("tau-elems-cell_unit-busy",t)}}}),define("tau/components/board.new.list/views/editors/view.new.list.editor",["Underscore","jQuery","tau/core/class","tau/components/board.new.list/views/editors/editor.utils"],function(e,t,i,n){return i.extend({init:function(t){this._$el=t,this.unitClicked=e.Callbacks()},startListen:function(){this._$el.on("click.newlist-editor-view",".tau-elems-cell_unit-editable:not(.disabled)",function(e){var i=t(e.currentTarget);if(i.not(".tau-elems-cell_unit-busy")){var n=i.closest(".i-role-card"),a=i.find(".tau-board-unit");this.unitClicked.fire({$card:n,$unit:i,$unitData:a,cardId:n.data("id").toString(),unitId:a.data("id").toString()}),e.stopPropagation()}}.bind(this))},toggleUnitBusyIndicator:function(e,t){n.toggleElementBusyIndicator(e,t)}})}),define("tau/components/board.new.list/views/units/unit",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=t.ui.ie&&function(e){e=e.toLowerCase();
var t=/(msie) ([\w.]+)/.exec(e)||[],i=parseInt(t[2])||0;return 11>i}(navigator.userAgent);return i.extend({MIN_UNIT_WIDTH:90,MAX_UNIT_WIDTH:600,init:function(e,i,n){var a=t(e).data()||{};this.unitId=a.unitId,this.minWidth=a.minWidth||0,this.maxWidth=a.maxWidth||Number.MAX_VALUE,this.className=".tau-list-"+this.unitId+"-cell",this.layoutKey=i,this.$items=n.find(".i-role-card "+this.generateCssSelector()),this.hasItems=this.$items.length>0,this.headerLayoutItem=e},_getElementWidth:n?function(e){var t=Math.ceil(e.getBoundingClientRect().width||0),i=e.scrollWidth;return Math.min(t,i+1)}:function(e){var t=Math.ceil(e.getBoundingClientRect().width||0);return t},generateCssSelector:function(){return".tau-elems-table-level-"+this.layoutKey+" "+this.className},getHeaderWidth:function(){return this._getElementWidth(this.headerLayoutItem)},getContentWidth:function(){var t=this.hasItems?e.map(this.$items,this._getElementWidth,this):[0];return Math.max.apply(Math,t)},calculateWidth:function(){var e=this.getHeaderWidth(),t=this.getContentWidth(),i=Math.max(e,t,this.minWidth,this.MIN_UNIT_WIDTH);return i=Math.min(i,this.maxWidth,this.MAX_UNIT_WIDTH),{selector:this.generateCssSelector(),hasItems:this.hasItems,header:e,content:t,calculated:i}}})}),define("tau/components/board.new.list/views/units/nameUnit",["tau/components/board.new.list/views/units/unit"],function(e){var t=e.extend({MIN_UNIT_WIDTH:300,LEVEL_INDENTATION:25,COLLAPSER_WIDTH:15,init:function(e,t,i){this._super(e,t,i),this.$container=i},setupWidth:function(e,t){var i,n=this.getHeaderWidth(),a=this.getContentWidth(),r=Math.max(this.minWidth,this.MIN_UNIT_WIDTH,n);if(r>a)i=r;else{var s=e.width(),o=s-t;i=o>a?a:Math.max(o,r)}return this.setupForcedWidth(i)},setupForcedWidth:function(e){return{selector:this.generateCssSelector(),calculated:this.adjustNameColumnWidthForLevel(e)}},adjustNameColumnWidthForLevel:function(e){return e-t.getLevelIndentation(this.layoutKey,this.$container)}});return t.getLevelIndentation=function(e,i){if("0"===e)return 0;
var n=i.find(".tau-list-caption .tau-elems-table-level-"+e+" .tau-list-collapser-cell"),a=n.length?0:t.prototype.COLLAPSER_WIDTH,r=e.indexOf("_"),s=r>0?e.substring(0,r):e,o=parseInt(s,10);return o*t.prototype.LEVEL_INDENTATION-a},t}),define("tau/components/board.new.list/views/view.new.list.tree.quickAdd",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(t,i){this.treeView=t,this.quickAddModel=i,this.showQuickAddClicked=e.Callbacks(),this.quickAddModel.dataLoaded.add(this.renderPossibleActions,this),this.renderPossibleActions()},renderPossibleActions:function(){if(this.quickAddModel.data){var i=this.treeView.findHeaderHolder(),n=i.find(".i-role-quick-add-holder");n.find("button.tau-list-quick-add").remove();var a=t('<button class="tau-list-quick-add tau-btn tau-success"></button>');n.append(a),a.on("click",this._onShowQuickAddClicked.bind(this,{target:a})),i.on("dblclick",this._onShowQuickAddClicked.bind(this,{target:a}));var r=a.closest(".tau-board-list-view__inner");r.on("scroll",e.debounce(function(){a.data("ui-tauBubble")&&a.tauBubble("adjustPosition")},200))}},_onShowQuickAddClicked:function(e){e.target.parent().hasClass("tau-quick-add_expand")||this.showQuickAddClicked.fire(e)},destroy:function(){this.quickAddModel.dataLoaded.remove(this)}})}),define("tau/components/board.new.list/views/view.new.list.tree.counts",["Underscore","jQuery","tau/core/class","tau/ui/ui.templateFactory"],function(e,t,i,n){return i.extend({init:function(e,t,i){this.treeView=e,this.treeModel=i,this.countsModel=t,this.termProcessor=n.getTermProcessor(),this.treeModel.applyAndObserve(function(e){e.countsModel.dataLoaded.add(this.refreshCount.bind(this,e.countsModel))}.bind(this)),this.treeModel.cardUpdated.add(this._onCardUpdated.bind(this))},_onCardUpdated:function(e){var t=this.treeModel.hierarchy.findChildByCardId(e.card.id);this.refreshCount(t.countsModel)},_getTitle:function(t){var i;return t.data&&t.data.types&&(i=e.map(t.data.types,function(e){var t=this._getTypePluralizedName(e.type);
return(""===t?e.typeName:t)+": "+e.count},this).join(" / ")),i},refreshCount:function(e){var t=this._getTitle(e),i=e.getAllCount(),n=this._getCounter(e.treeModel.card);n.text(i),n[0].title=t,n.toggleClass("tau-counter-hidden",!i)},_getCounter:function(e){var t=this.treeView.findChildCardById(e.id);return t.find(".tau-counter").first()},_getTypePluralizedName:function(e){return this.termProcessor.getTerm(e,"names")},destroy:function(){}})}),define("tau/components/board.new.list/views/view.new.list.tree",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/components/board.new.list/templates/template.new.list.header","tau/components/board.new.list/templates/template.new.list.card.customized","tau/components/board.new.list/templates/template.new.list.subtree","tau/ui/templates/board.plus/ui.template.board.plus.emptyMessage","./editors/view.new.list.editor","tau/components/board.new.list/views/units/unit","tau/components/board.new.list/views/units/nameUnit","tau/components/board.new.list/views/view.new.list.tree.quickAdd","tau/components/board.new.list/views/view.new.list.tree.counts"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return i.extend({_cardTypes:[],init:function(t,i,n,a,r){this.skeleton=a,this.configurator=a.configurator,this.eventAggregator=a.eventAggregator,this.parentView=n,this.treeModel=t,this.level=this.treeModel.level,this.$el=i,this.$treeContainer=this.$el.find(".i-role-cardsholder").first(),this.columnWidthService=r,this.expansionStateToggled=e.Callbacks(),this.collapseAllClicked=e.Callbacks(),this.openCardDetailsClicked=e.Callbacks(),this.subViews=[]},renderTree:function(){return this._renderTreeNode(this.treeModel).done(this._updateEmptyLevelState.bind(this))},_renderTreeNode:function(e){if(this._cardTypes=e.getCardTypes(),!e.items.length&&!this._cardTypes.length)return t.Deferred().resolve().promise();this._attachCardBehaviors();var i=this.$treeContainer;return t.when(this.renderHeader()).then(this.appendHeader.bind(this)).then(this.updateHeaderExpansionState.bind(this)).then(this.renderCards.bind(this,e.items)).then(this.insertCards.bind(this,i)).promise()
},getListLayout:function(){var i=e.pluck(this._cardTypes,"typeId");return t.when(this.skeleton.cardLayoutFactory.getLayoutFactory()).then(this._createLayout.bind(this,i))},_createLayout:function(t,i){var n=e.chain(i(t)).toArray().flatten().uniq(e.property("id")).value();return a.orderListUnits(n)},renderHeader:function(){return t.when(this.getListLayout()).then(function(t){var i=e.extend(a.getCardRenderData({},t,this.configurator),{cardTypes:this._cardTypes,enable:!0,level:this.level,levelKey:this.treeModel.getLevelKey(),renderSortingHeaders:!this.treeModel.isInnerCollectionsLevel(),renderCollapser:this.treeModel.canExpandCard(),isCollapserEnabled:!0,parentEntityType:this.treeModel.hierarchyMetaInfo.parentEntityType,ordering:this.treeModel.hierarchyMetaInfo.ordering,renderDetailsTrigger:!this.treeModel.isShowDetailsDisabled()});return r.render(i)}.bind(this))},renderCards:function(i){return t.when(this.getListLayout()).then(function(n){return t.when.all(e.map(i,function(e){return this.renderCard(e.card,n)},this))}.bind(this)).then(function(e){return e.join("")})},renderCard:function(t,i){var n=e.extend({},t,{levelKey:this.treeModel.getLevelKey(),renderCollapser:this.treeModel.canExpandCard(),isCollapserEnabled:this.treeModel.canExpandCard(t.type),renderDetailsTrigger:!this.treeModel.isShowDetailsDisabled(t.type)}),r=this.configurator.getTemplateFactory().get(s.name);return r.bindPure({},a.getCardRenderData(n,i,this.configurator))},_updateEmptyLevelState:function(){this.$el.toggleClass("tau-list-level-empty",!this.treeModel.items.length)},findHeaderHolder:function(){var e=".i-role-headerholder";return this.$treeContainer.siblings(e)},_findHeaderCollapser:function(){return this.findHeaderHolder().find(".i-role-header-collapser")},appendHeader:function(e){var t=this.findHeaderHolder();t.append(e)},insertCards:function(e,t){e.append(t)},_attachCardBehaviors:function(){this.$el.off("click.newlist"),this.$el.on("click.newlist",".i-role-card-collapser",function(e){var i=t(e.target),n=i.closest(".tau-list-entity"),a=n.data("id").toString();
this.expansionStateToggled.fire(a),e.stopPropagation()}.bind(this)),this.$el.on("click.newlist",".i-role-header-collapser",function(e){this.collapseAllClicked.fire(),e.stopPropagation()}.bind(this)),this.$treeContainer.off("click.newlist"),this.$treeContainer.on("click.newlist",".i-role-details-trigger",function(e){var i=t(e.target),n=i.closest(".tau-list-entity");this.openCardDetailsClicked.fire({cardData:n.data(),$card:n}),e.stopPropagation()}.bind(this))},appendNodes:function(e){return this.renderCards(e).then(function(e){return this.$treeContainer.append(e)}.bind(this))},updateHeaderExpansionState:function(){var t=e.any(this.treeModel.items,function(e){return e.getIsExpanded()});this._findHeaderCollapser().toggleClass("tau-v-collapser-expanded",t)},calculateColumnWidths:function(){this.skeleton.calculateColumnWidthsForLevel(this.treeModel.level)},createTreeView:function(e){var t=o.render(e),i=this._getParentNodeByCardId(e.cardId);i.after(t);var n=this._getViewConstructor(),a=new n(e,t,this,this.skeleton,this.columnWidthService);return this.subViews.push(a),this.skeleton.treeViewCreated.fire(a),a},findView:function(t){if(0===t.length)return this;var i=e.find(this.subViews,function(e){return e.treeModel.cardId===t[0]});return i?i.findView(e.rest(t)):null},_getViewConstructor:function(){return null},setExpandedStateForCardId:function(e){var t=this._getParentNodeByCardId(e);t.addClass("tau-list-entity-open")},removeChildTreeNodeView:function(t){var i=this._getParentNodeByCardId(t);i.removeClass("tau-list-entity-open");var n=this._getSubNodesForCard(t);n.remove();var a=e.findIndex(this.subViews,function(e){return e.treeModel.cardId===t});a>=0&&(this.subViews[a].destroy(),this.subViews.splice(a,1))},_getParentNodeByCardId:function(e){var t='> .tau-list-entity[data-id="'+e+'"]';return this.$treeContainer.find(t).eq(0)},updateCardUnit:function(t,i,n){var a=this._findUnit(t.id,i);if(e.contains(["orderingValue","cardData"],i))return void a.$card.data(i,n);var r=a.$cell,s=this.skeleton.cardLayoutFactory.findUnitById(i);
if(r.length&&s){var o=this.configurator.getTemplateFactory().get(s.getTemplateName("list")).bind({},{type:t.type.toLowerCase(),configurator:this.configurator,settings:{},data:n,unit:s,first:r.is(":has(.i-role-name)")||s.isNameUnit,renderDetailsTrigger:!this.treeModel.isShowDetailsDisabled(t.type)});o.html()!=r.html()&&(r.children().remove(),r.append(o.children())),r.toggleClass("tau-board-unit_updating",!1)}},_findUnit:function(e,t){var i=this.findChildCardById(e),n=i.find(".tau-board-unit[data-id="+t+"]"),a=n.closest(".tau-elems-cell");return{$card:i,$unit:n,$cell:a}},moveCard:function(e,t){var i=this.findChildCardById(e.id),a=this._getSubNodesForCard(e.id);i.detach(),a.detach();var r=null!==t;r&&this.insertCardByIndex(this.$treeContainer,i,a,t),n.animated(i,"tau-operation_card_updated")},_getSubNodesForCard:function(e){var t='div[data-list-parent-id="'+e+'"]';return this.$el.find(t)},removeCardsSilent:function(t){e.each(t,function(e){this.removeCard(e.card,!0)},this)},removeCard:function(e,i){var a=this.findChildCardById(e.id);return a.removeClass("i-role-card"),t.when(i?!0:n.animated(a,"tau-operation_card_deleted")).then(function(){a.remove(),this.removeChildTreeNodeView(e.id)}.bind(this)).then(this._updateEmptyLevelState.bind(this))},addCard:function(e,i,a){return t.when(this.getListLayout()).then(this.renderCard.bind(this,i)).then(function(e){var i=t(e);this.insertCardByIndex(this.$treeContainer,i,null,a),n.animated(i,"tau-operation_card_added")}.bind(this)).then(this._updateEmptyLevelState.bind(this))},insertCardByIndex:function(e,t,i,n){if(n>=0){var a=e.children(".i-role-card").eq(n);a.length?a.before(t):e.append(t)}else e.append(t);i&&t.after(i)},createEditorView:function(){return new u(this.$treeContainer)},createCountsView:function(e){var t=this._getCountsViewConstructor();this.countsView=new t(this,e,this.treeModel)},createQuickAddView:function(e){this.quickAddView=new p(this,e)},_getCountsViewConstructor:function(){return f},toggleNodeExpansionProgress:function(e,t){var i=this.findChildCardById(e),n=i.find(".i-role-card-collapser");
n.toggleClass("tau-loading",t)},highlightCard:function(e){var t=this.findChildCardById(e);n.animated(t,"tau-operation_card_added")},findChildCardById:function(e){return this.$treeContainer.children('.i-role-card[data-id="'+e+'"]')},updateCardFinalState:function(e,t){var i=this.findChildCardById(e);i.toggleClass(s.get().config.customFunctions.getFinalStateClass(),!!t)},destroy:function(){this.quickAddView&&this.quickAddView.destroy(),this.countsView&&this.countsView.destroy()}})}),define("tau/components/board.new.list/views/view.new.list.paging.node",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(t){this._$container=t,this.nextPageClicked=e.Callbacks(),this.prevPageClicked=e.Callbacks(),this.pageSizeChanged=e.Callbacks()},render:function(i){if(i.pagingModel.hasNext){var n=t('<div class="tau-list-more"><div class="tau-list-more-inner"><a>show more</a></div></div>');n.appendTo(this._$container),n.on("click",".tau-list-more-inner a",e.bind(function(){this.nextPageClicked.fire({pagingType:"showMore",direction:"next"})},this))}},showProgress:function(){var e=t('<div class="tau-loader"></div>');e.appendTo(this._$container.children(".tau-list-more").find(".tau-list-more-inner"))},update:function(e){var t=this._$container.children(".tau-list-more");e.pagingModel.hasNext?t.find(".tau-loader").remove():t.remove()}})}),define("tau/components/board.new.list/views/view.new.list.tree.node",["Underscore","jQuery","tau/components/board.new.list/views/view.new.list.tree","tau/components/board.new.list/views/view.new.list.paging.node"],function(e,t,i,n){var a=i.extend({createPagingView:function(){return new n(this.$el)},_getViewConstructor:function(){return a}});return a}),define("tau/components/board.new.list/templates/template.new.list.paging",["tau/core/templates-factory"],function(e){var t={name:"new.list.paging",engine:"jqote2",markup:["<% if (this.isEnabled) { %>",'<div class="tau-list-paging">','<div class="tau-pages-navigator">',"<% if (this.hasPrev) { %>",'<span class="i-role-cell-paging-link i-role-cell-paging-first-link tau-first" data-direction="first"></span>','<span class="i-role-cell-paging-link i-role-cell-paging-prev-link tau-prev" data-direction="prev">Prev</span>',"<% } %>",'<span class="tau-paging-info">','<b class="i-role-current-page-counts"><%= this.getFrom() %>  <%= this.getTo() %></b>','<b class="i-role-all-root-count">',"<% if (this.totalCount) { %>"," of <%= this.totalCount %>","<% } %>","</b>","</span>","<% if (this.hasNext) { %>",'<span class="i-role-cell-paging-link i-role-cell-paging-more-link tau-next" data-direction="next">Next</span>','<span class="i-role-cell-paging-link i-role-cell-paging-last-link tau-last" data-direction="last"></span>',"<% } %>","</div>",'<div class="tau-page-items">','<span class="tau-txt">Entities per page</span>',"<% _.each(this.availablePageSizes, function(v) { %>",'<span class="i-role-option-onpage tau-count <%= fn.cond(v == this.pageSize, \'tau-active\') %>" data-value="<%= v %>">',"<%= v %>","</span>","<% }, this); %>","</div>","</div>","<% } %>"]};
return e.register(t)}),define("tau/components/board.new.list/views/view.new.list.paging.root",["Underscore","jQuery","tau/core/class","tau/components/board.new.list/templates/template.new.list.paging"],function(e,t,i,n){return i.extend({init:function(t){this._$container=t,this.nextPageClicked=e.Callbacks(),this.prevPageClicked=e.Callbacks(),this.lastPageClicked=e.Callbacks(),this.firstPageClicked=e.Callbacks(),this.pageSizeChanged=e.Callbacks()},render:function(i){var a=n.render(i.pagingModel);a.on("click",".i-role-cell-paging-link",e.bind(function(e){var i,n=t(e.target).data("direction");"prev"===n?i=this.prevPageClicked:"next"===n?i=this.nextPageClicked:"last"===n?i=this.lastPageClicked:"first"===n&&(i=this.firstPageClicked),i.fire({pagingType:"root paging",direction:n})},this)),a.on("click",".i-role-option-onpage",e.bind(function(e){var i=t(e.currentTarget).data("value");this.pageSizeChanged.fire(i)},this)),this._$container.html(a)},showProgress:function(){},update:function(e){this.render(e)}})}),define("tau/components/board.new.list/views/view.new.list.tree.root",["Underscore","jQuery","tau/components/board.new.list/views/view.new.list.tree","tau/components/board.new.list/views/view.new.list.tree.node","tau/components/board.new.list/views/view.new.list.paging.root"],function(e,t,i,n,a){return i.extend({createPagingView:function(){return new a(this.skeleton.findRootPagingContainer())},_getViewConstructor:function(){return n}})}),define("tau/components/board.new.list/views/columnWidthService",["Underscore","jQuery","tau/core/class","tau/utils/utils.debug","tau/components/board.new.list/views/units/unit","tau/components/board.new.list/views/units/nameUnit"],function(e,t,i,n,a,r){return i.extend({COLUMN_WIDTHS_STYLE_ID:"-list-columns-level-",SETTING_NAME:"listUserSettings",init:function(e){this.resetCache(),this.boardSettings=e},resetCache:function(){this.layout={items:{}}},setElementScope:function(e){this.$boardBody=e,this.boardBodyId=e.attr("id"),n.assertError(!!this.boardBodyId,"board body id should be set")
},calculateColumnWidths:function(i,n){var a=taus.start("statistics_newlist_columnWidths",this._createStatsDataFromRequests(i)),r=e.chain(i).groupBy(function(e){return e.levelKey}).map(function(i,a){var r=t(e.map(i,function(e){return e.levelContainer})),s="0"===a?this._calculateRootLevel(r):this._calculateNestedLevel(a,r,n);return t.when(s).then(function(e){return{levelKey:a,cssRules:e}})}.bind(this)).value();return t.when.all(r).then(function(t){var i=e.filter(t,function(e){return!!e.cssRules});this._createColumnWidthStyles(i),a.stop()}.bind(this))},_calculateRootLevel:function(e){return t.when(this.layout.name?this.layout:this._getColumnSizeSettings()).then(function(t){this.layout.name=t.name,this._calculateUnitWidths("0",e);var i=this._generateCssRules("0"),n=this._getForLevel("0");return this.layout.name=n&&n.name&&n.name.calculated,i}.bind(this))},_calculateNestedLevel:function(e,t,i){return this._shouldSkipCalculationFor(e,t,i)?void 0:(this._calculateUnitWidths(e,t),this._generateCssRules(e))},_calculateUnitWidths:function(t,i){var n=".tau-elems-table-level-"+t,s=i.eq(0).find(".i-role-headerholder "+n);if(!s.length)return console.warn("_calculateUnitWidths: empty level "+t),void this._setForLevel(t,null);this._removeColumnWidthsStyle(t),this.layout.dragHandler=this.layout.dragHandler||s.find(".tau-drag-handler-cell").width();var o=this.layout.dragHandler,l={},u=s.find(".tau-elems-cell"),c=e.tail(u);e.each(c,function(e){var n=new a(e,t,i),r=n.calculateWidth();l[n.unitId]=r,l.hasItems=l.hasItems||n.hasItems,o+=r.calculated},this);var d=new r(u[0],t,i);if(this.layout.name)l.name=d.setupForcedWidth(this.layout.name);else{var p=this.$boardBody.find(".tau-board-list-view__inner");l.name=d.setupWidth(p,o)}this._setForLevel(t,l)},_generateCssRule:function(e){return"#"+this.boardBodyId+" "+e.selector+" { width: "+e.calculated+"px; }"},_generateCssRules:function(t){var i=[],n=this._getForLevel(t);return n?(e.each(n,function(e,t){e.hasItems&&"name"!==t&&i.push(this._generateCssRule(e))
},this),i.push(this._generateCssRule(n.name)),i):(console.warn("_generateCssRules: empty level "+t),i)},resize:function(){},setNameWidth:function(t,i){return this._setColumnSizeSettings({name:t}).then(function(){this.layout.name=t;var n=i.closest(".i-role-board-body");e.each(this.layout.items,function(e,t){var i=new r(null,t,n);e.name.calculated=i.setupForcedWidth(this.layout.name).calculated;var a=this._generateCssRules(t);this._createColumnWidthStyles([{levelKey:t,cssRules:a}])},this)}.bind(this))},_getColumnSizeSettings:function(){return this._getListUserSettings().then(function(e){return e.columnSizes||{}}.bind(this))},_setColumnSizeSettings:function(e){return this._setListUserSettings({columnSizes:e})},_getListUserSettings:function(){return this.boardSettings.get([this.SETTING_NAME]).then(function(e){return e[this.SETTING_NAME]||{}}.bind(this))},_setListUserSettings:function(t){return this._getListUserSettings().then(function(i){e.extend(i,t);var n={};return n[this.SETTING_NAME]=i,n}.bind(this)).then(function(e){return this.boardSettings.set({set:e})}.bind(this))},_getForLevel:function(e){return this.layout.items[e]},_setForLevel:function(e,t){this.layout.items[e]=t},_createColumnWidthStyles:function(i){e.each(i,function(e){this._removeColumnWidthsStyle(e.levelKey)},this);var n=e.map(i,function(e){var t=this._createColumnWidthStyleId(e.levelKey);return'<style id="'+t+'">'+e.cssRules.join("\n")+"</style>"},this).join("\n");t(n).appendTo(this.$boardBody)},_removeColumnWidthsStyle:function(e){t("#"+this._createColumnWidthStyleId(e)).remove()},_createColumnWidthStyleId:function(e){return this.boardBodyId+this.COLUMN_WIDTHS_STYLE_ID+e},_shouldSkipCalculationFor:function(e,t,i){var n=this._getForLevel(e);if(!n)return!1;if(i){if(n.hasItems)return!0;if(n.hasItems===!1&&!t.find(".i-role-card:first-child").length)return!0}return!1},_createStatsDataFromRequests:function(t){return e.chain(t).groupBy(function(e){return e.levelKey}).reduce(function(e,t,i){return e[i]=t.length,e
},{}).value()}})}),define("tau/components/board.new.list/views/view.new.list.skeleton",["Underscore","jQuery","tau/core/class","tau/components/board.new.list/templates/template.new.list","tau/components/board.new.list/templates/template.new.list.subtree","tau/components/board.new.list/views/view.new.list.tree.root","tau/ui/templates/board.plus/ui.template.board.plus.emptyMessage","tau/components/board.new.list/views/columnWidthService","tau/ui/behaviour/common/ui.behaviour.progressIndicator"],function(e,t,i,n,a,r,s,o,l){"use strict";return i.extend({$el:null,_$currentRoot:t(),columnWidthService:null,cardLayoutFactory:null,_rootView:null,_eventNamespace:".newlist",init:function(t,i){this.configurator=t,this.eventAggregator=i,this.treeViewCreated=e.Callbacks()},setCardLayoutFactory:function(e){this.cardLayoutFactory=e},buildSkeleton:function(i,a,r){return this._boardSettings=r,t.when(n.render(a)).then(e.bind(function(e){return this.columnWidthService=new o(r),this.eventAggregator.skeletonBuilt.fire(e),this._setElement(i,e),e},this)).promise()},_setElement:function(e,t){this.$el&&this.$el.replaceWith(t),this.$el=t},createTreeView:function(i){return t(this.configurator.getWindow()).off("resize"+this._eventNamespace).on("resize"+this._eventNamespace,e.throttle(this.resize.bind(this),250)),this._$currentRoot.remove(),this._$currentRoot=a.render(i),this.columnWidthService.setElementScope(this._$currentRoot),i.cardAdded.add(this.updateEmptyListMessage,this),i.cardDeleted.add(this.updateEmptyListMessage,this),this._rootView=new r(i,this._$currentRoot,null,this,this.columnWidthService),this.treeViewCreated.fire(this._rootView),this._rootView},appendRoot:function(){var e=this.$el.find(".i-role-list-root-container");e.css("opacity",0),e.append(this._$currentRoot),this.calculateColumnWidths(),e.css("opacity",1)},findBoardContainer:function(){return this.$el.find(".tau-board-list-view__inner")},findRootPagingContainer:function(){return this.$el.find(".i-role-pagingholder").eq(0)},findView:function(e){return this._rootView.findView(e)
},getAllTreeViews:function(){if(!this._rootView)return[];var t=function(i){return(i.subViews||[]).concat(e.flatMap(i.subViews,t))};return[this._rootView].concat(t(this._rootView))},showNotConfiguredMessage:function(){var e={message:"Set up your list View",type:"notConfigured"},i=s.render(e);this.$el.prepend(i),this.eventAggregator.treeRendered.fire(t())},updateEmptyListMessage:function(){var e=this._rootView.treeModel,t=this.$el.find(".i-role-board-body");if(e.items&&e.items.length)t.find(".i-role-empty-message").remove();else{var i={message:"Yikes...! Nothing in there :-|",type:"isEmpty"};s.render(i).appendTo(t)}this.eventAggregator.hasDataInSliceChanged.fire(e)},calculateColumnWidths:function(){this.columnWidthService.resetCache(),t.when(this._calculateColumnWidthsFor(".tau-list-level",!1)).then(function(){taus.track({action:"name column width calculate",width:this.columnWidthService.layout.name,tags:["newlist"]})}.bind(this))},calculateColumnWidthsForLevel:function(e,t){this.calculateColumnWidthsForMultipleLevels([e],t)},calculateColumnWidthsForMultipleLevels:function(t,i){var n=e.map(t,function(e){return".tau-list-level-"+e}).join(", ");this._calculateColumnWidthsFor(n,i)},_calculateColumnWidthsFor:function(i,n){var a=e.map(this.$el.find(i),function(e){var i=t(e);return{levelKey:i.data("listLevelKey"),levelContainer:e}});return this.columnWidthService.calculateColumnWidths(a,n)},toggleProgress:function(e){var t=l.get(this.$el);e?t.show():t.hide(),this.$el.find(".i-role-board-body").css("opacity",e?.5:1)},resize:function(){this.columnWidthService.resize(this.$el)},cleanup:function(){this._rootView=null,this.treeViewCreated.empty(),t(this.configurator.getWindow()).off(this._eventNamespace)},destroy:function(){this.cleanup()}})}),define("tau/components/board.new.list/bus.new.list.event.aggregator",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(){this.acidRetrieved=e.Callbacks(),this.boardSettingsRetrieved=e.Callbacks(),this.definitionReady=e.Callbacks(),this.sliceServiceCreated=e.Callbacks(),this.sliceInfoRetrieved=e.Callbacks(),this.skeletonBuilt=e.Callbacks(),this.cellModelLoaded=e.Callbacks(),this.hasDataInSliceChanged=e.Callbacks(),this.treeRendered=e.Callbacks(),this.cardRemoved=e.Callbacks(),this.itemAddedToContext=e.Callbacks(),this.entityDetailsViewRequested=e.Callbacks(),this.expansionStateChanged=e.Callbacks()
}})}),define("tau/models/board.plus/model.board.slice.comet",["Underscore","tau/core/class","tau/core/extension.base"],function(e,t,i){var n=function(t){window.appIsInDebugMode&&window.console&&(window.console.group&&window.console.table?(console.group("board comet tick"),console.log("Raw: %o",t),console.log("Reason: %o",t.data.reason),console.table(e.map(t.data.items,function(t){var i=e.pick(t,"modification","location","x","y");return i.type=t.data.type,i.id=t.data.id,i})),console.groupEnd()):console.log("board comet tick",t))},a=t.extend({init:function(){this._queue=[],this.onTickCb=$.noop()},add:function(e){this._queue.push(e),this.postponeFlush()},flush:function(e){this._queue.push(e),this.executeFlush()},reset:function(){this.timeout&&clearTimeout(this.timeout),this.queue=[]},postponeFlush:function(){clearTimeout(this.timeout),this.timeout=setTimeout(e.bind(this.onFlush,this),100)},executeFlush:function(){clearTimeout(this.timeout),this.onFlush()},onFlush:function(){var t=this._queue;for(this._queue.length>1&&(t=e.map(t,function(t){return t.data.items=e.map(t.data.items,function(e){return"NotInSlice"!=e.modification&&(e.modification="cascade"),e}),t}),this._queue=t);t.length;)this.doTick(t.shift())},doTick:function(){this.onTickCb.apply(null,e.toArray(arguments))},onTick:function(e){this.onTickCb=e}});return i.extend({STATUS_ONLINE:"online",STATUS_OFFLINE:"offline",resetLifecycle:!0,init:function(t,i,r,s,o){this.configurator=i,this.hubName=r||"slice",this.debounceInterval=e.isUndefined(s)?100:s,this.reconnectInterval=e.isUndefined(o)?1e4:o,this.templateMessageReconnect=this.configurator.getTemplateFactory().register({name:"connection.restore",markup:['<div class="tau-system-message-body-inner">',"<h3>Connection is restored.</h3>",'<div>Please, <a class="tau-target-link i-role-actionrefresh"">refresh</a> View to apply changes from server.<div>',"</div>"]}).get(),this.templateMessageOffline=this.configurator.getTemplateFactory().register({name:"connection.lost",markup:['<div class="tau-system-message-body-inner">',"<h3>Connection lost.</h3>","<div>Cannot connect to the server.<div>","</div>"]}).get(),this.status=null,this.cometState={},this.queue=new a,this._super(t),this.queue.onTick(e.bind(function(e){n(e),this.fireCometTick(e)
},this))},fireCometTick:function(e){this.fire("comet.tick",e)},"bus start.lifecycle + comet.parameters":function(e,t,i){this.status=this.STATUS_ONLINE,this.initSubscription(i)},"bus subscription.started:last > comet.parameters":function(e,t,i){clearTimeout(this.timeoutId);var n=setTimeout(function(){t.stop(),this.status=this.STATUS_ONLINE,this.initSubscription(i)}.bind(this),this.debounceInterval);this.timeoutId=n;var a=clearTimeout.bind(window,n);this.on("refresh",a),this.on("destroy",a)},"bus netStatus.changed":function(e,t){var i=this.status;i!==t&&(t===this.STATUS_ONLINE?(this.reconnectIntervalId&&clearInterval(this.reconnectIntervalId),i===this.STATUS_OFFLINE&&this.notifyReconnected()):t===this.STATUS_OFFLINE&&(this.notifyDisconnected(),this.reconnectIntervalId=setInterval(this.fire.bind(this,"reconnect"),this.reconnectInterval)),this.status=t)},"bus comet.parameters > active.subscription.ready > reconnect":function(e,t){this.initSubscription(t)},"bus subscription.started:last + before_destroy":function(e,t){t.stop()},"bus subscription.started:last + before_refresh":function(e,t){t.stop()},initSubscription:function(t){this.cometState={},this.queue.reset();var i=this.configurator.getComet().listen(this.hubName,{parameters:t});i.on({callback:this.handleData.bind(this),batchCallback:this.handleBatchData.bind(this)}).aborted(this.fire.bind(this,"subscription.aborted",i)).disconnected(this.fire.bind(this,"subscription.disconnected",i)).start(this.fire.bind(this,"subscription.ready",i)),e.defer(this.fire.bind(this,"subscription.started",i))},"bus subscription.ready + subscription.started:last":function(e,t,i){t===i&&this.fire("active.subscription.ready",t)},"bus active.subscription.ready":function(e,t){this.fire("comet.subscription.ready",t),this.fire("netStatus.changed",this.STATUS_ONLINE)},"bus active.subscription.disconnected":function(){this.fire("netStatus.changed",this.STATUS_OFFLINE)},"bus active.subscription.aborted + comet.parameters:last":function(t,i,n){e.defer(e.bind(this.initSubscription,this,n))
},"bus subscription.disconnected + subscription.started:last":function(e,t,i){t.stop(),t===i&&this.fire("active.subscription.disconnected",t)},"bus subscription.aborted + subscription.started:last":function(e,t,i){t.stop(),t===i&&this.fire("active.subscription.aborted")},isStateDeprecated:function(e,t){var i=this.cometState[t]||0,n=!1;return i>e&&(n=!0),n},handleBatchData:function(e){this.fire("comet.batch",e)},handleData:function(t){{var i=e.first(t.data.items),n=(i.data.id||"").toLowerCase(),a=t.timestamp;this.cometState[n]||0}this.isStateDeprecated(a,n)||(this.cometState[n]=t.timestamp,this.isOperationToMerge(t)?this.queue.add(t):this.queue.flush(t))},isOperationToMerge:function(t){var i=e.first(t.data.items),n=(i.location||"").toLowerCase(),a=t.data.reason,r=i.modification.toLowerCase(),s=!e.difference(["NumericPriority"],a).length,o="updated"===r&&"card"===n&&s;return o},notifyDisconnected:function(){var e=this.templateMessageOffline.bind({},{});this.fire("error",{$node:e,disableAutoClose:!0})},notifyReconnected:function(){var t=this.templateMessageReconnect.bind({},{});t.on("click",".i-role-actionrefresh",e.bind(function(){this.fire("refresh")},this)),this.fire("notification",{$node:t,disableAutoClose:!0})}})}),define("tau/components/board.new.list/views/view.new.list.tree.dragndrop",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.dom.utils"],function(e,t,i,n){return i.extend({PRIORITIZATION_OPTIONS:{enabled:{prioritizationPossible:!0,content:"Prioritization on",isMovedWithPrioritization:function(){return!0}},disabled:{prioritizationPossible:!1,content:"Prioritization off",isMovedWithPrioritization:function(){return!1}},shift:{prioritizationPossible:!0,content:'Hold <span class="shiftButton"></span> to prioritize',isMovedWithPrioritization:function(e){return e.shiftKey}}},options:{},init:function(e,t){this.$treeContainer=e.$treeContainer,this.treeModel=e.treeModel,this.dndOptions=t.dndOptions,this.applyDndMove=t.applyDndMove.bind(t),this.containment=t.skeletonView.$el.find(".tau-board-list-view__inner"),this.level=this.treeModel.level,this.isDataPrioritizable()&&this._makeSortable()
},_makeSortable:function(){var e=this.isDndPossible(),t=this.treeModel.level;this.$scrollParent=this.$treeContainer.scrollParent(),this.$treeContainer.toggleClass("tau-sortable",e).sortable({disabled:!e,items:"> .i-role-card:not(.tau-axis-card-no-value), > .tau-list-level",handle:".tau-drag-handler-enabled.tau-drag-handler-level-"+t,axis:"y",opacity:.8,containment:this.containment,scrollSensitivity:33,tolerance:this.dndOptions.tolerance||"intersect",placeholder:this._createPlaceholder(),helper:this._createHelper.bind(this),create:function(){var e=this._getSortableInstance();this._fixWidgetIntersectionLogic(e),this._fixWidgetScrollLogic(e),this._fixWidgetContainmentLogic(e)}.bind(this),start:function(e,t){var i=t.item;i.hasClass("tau-list-entity-open")&&this._refreshPositions(),i.data("list-startCoordinates",this._getCoordinates(i))}.bind(this),stop:function(e,t){this.$treeContainer.find(".tau-list-sortable-placeholder-fixed").remove(),this._moveCardWithSubTree(t.item)}.bind(this)})},_getSortableInstance:function(){return this.$treeContainer.data("ui-sortable")},_getPrioritizationOptions:function(){return this.PRIORITIZATION_OPTIONS[this.dndOptions.prioritization]},_createPlaceholderElement:function(t){var i=this._getPrioritizationOptions().content,n=e.compact(["i-role-card","tau-list-entity",t]);return'<div class="'+n.join(" ")+'"><div class="tau-list-line"><div class="tau-elems-table tau-sortable__placeholder-inner">'+i+"</div></div></div>"},_createPlaceholder:function(){return{element:function(e){return e.before(this._createPlaceholderElement("tau-list-sortable-placeholder-fixed")),this._createPlaceholderElement("tau-list-sortable-placeholder-float")}.bind(this),update:function(){this._restoreScrollPosition(),this._refreshPositions()}.bind(this)}},_createHelper:function(e,t){this._saveScrollPosition();var i=t.next(".tau-list-level");return i.length?(i.slideUp(this._refreshPositions.bind(this)),t.data("list-subtree",i)):t.data("list-subtree",null),t},isDataPrioritizable:function(){return this.treeModel.hierarchyMetaInfo.isPrioritizable
},isDndPossible:function(){return this.isDataPrioritizable()&&this._getPrioritizationOptions().prioritizationPossible},isMovedWithPrioritization:function(){return this._getPrioritizationOptions().isMovedWithPrioritization(this.dndOptions)},_refreshPositions:function(){this.$treeContainer.sortable("refreshPositions")},_saveScrollPosition:function(){this.scrollTop=this.$scrollParent[0].scrollTop},_restoreScrollPosition:function(){this.$scrollParent[0].scrollTop=this.scrollTop},_fixWidgetIntersectionLogic:function(t){t._intersectsWithPointer=e.wrap(t._intersectsWithPointer.bind(t),function(e,t){var i=e(t);return i&&(t.item.hasClass("tau-list-entity-open")?i=1:t.item.hasClass("tau-list-level")&&(i=2)),i})},_fixWidgetContainmentLogic:function(t){t._generatePosition=e.wrap(t._generatePosition.bind(t),function(e,t){if(this.containment){var i=this.containment[3]+this.offset.click.top-11;t.pageY>i&&(t.pageY=i)}return e(t)})},_fixWidgetScrollLogic:function(e){e._mouseDrag=function(e){var i,n,a,r,s=this.options,o=!1;if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var l=this.scrollParent[0];if(l!==document&&"HTML"!==l.tagName){if(this.overflowOffset.top+l.offsetHeight-e.pageY<s.scrollSensitivity){var u=this.items[this.items.length-1];u.item[0]===this.currentItem[0]&&(u=this.items[this.items.length-2]);var c=u?u.top+u.height:0,d=c-this.positionAbs.top;d>0&&(l.scrollTop=o=l.scrollTop+Math.min(s.scrollSpeed,d))}else e.pageY-this.overflowOffset.top<s.scrollSensitivity&&(l.scrollTop=o=l.scrollTop-s.scrollSpeed);this.overflowOffset.left+l.offsetWidth-e.pageX<s.scrollSensitivity?l.scrollLeft=o=l.scrollLeft+s.scrollSpeed:e.pageX-this.overflowOffset.left<s.scrollSensitivity&&(l.scrollLeft=o=l.scrollLeft-s.scrollSpeed)}else{var p=t(document);e.pageY-p.scrollTop()<s.scrollSensitivity?o=p.scrollTop(p.scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-p.scrollTop())<s.scrollSensitivity&&(o=p.scrollTop(p.scrollTop()+s.scrollSpeed)),e.pageX-p.scrollLeft()<s.scrollSensitivity?o=p.scrollLeft(p.scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-p.scrollLeft())<s.scrollSensitivity&&(o=p.scrollLeft(p.scrollLeft()+s.scrollSpeed))
}o!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),o!==!1&&this.refreshPositions(!0)}for(this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],a=n.item[0],r=this._intersectsWithPointer(n),r&&n.instance===this.currentContainer&&a!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==a&&!t.contains(this.placeholder[0],a)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],a):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1}},_findSibling:function(e,t){var i=e;do i=i[t]();while(i.length&&!i.is(".i-role-card[id]"));return i},_getCoordinates:function(e){var t=e.closest(".tau-list-level");return{itemId:e.data("id").toString(),parentId:t.data("listParentId"),itemBefore:this._findSibling(e,"prev"),itemAfter:this._findSibling(e,"next")}},_moveCardWithSubTree:function(e){var i=t.Deferred(),a=e.data("list-startCoordinates"),r=this._getCoordinates(e);if(r.itemBefore[0]===a.itemBefore[0]&&r.itemAfter[0]===a.itemAfter[0])return this._showSubTree(e),i.resolve();i.fail(function(){this._moveCardToCoordinates(e,a),this._showSubTree(e),n.animated(e,"tau-card_dnd_failed")}.bind(this));var s={item:e,treeModel:this.treeModel};return this.isMovedWithPrioritization()?(s.itemBefore=r.itemBefore,s.itemAfter=r.itemAfter,this.applyDndMove(s).then(function(){i.resolve()}.bind(this),function(){i.reject()}.bind(this)),this._showSubTree(e),i):(this._restoreScrollPosition(),i.reject())},_moveCardToCoordinates:function(e,t){if(t.itemBefore.length){var i=t.itemBefore,n=i.next(".tau-list-level");
e.insertAfter(n.length?n:i)}else t.itemAfter.length?e.insertBefore(t.itemAfter):console.error("Move card after d&d: cannot find position in DOM",t)},_showSubTree:function(e){var t=e.data("list-subtree");t&&t.length&&t.insertAfter(e).slideDown()},setDndOptions:function(e){this.dndOptions=e;var t=this.isDndPossible();this.$treeContainer.toggleClass("tau-sortable",t).sortable({disabled:!t})}})}),define("tau/components/board.new.list/views/dragndropBehavior",["Underscore","tau/core/class","tau/utils/utils.debug","tau/components/board.new.list/views/view.new.list.tree.dragndrop"],function(e,t,i,n){return t.extend({_eventNamespace:".newlist-dragndrop-behavior",_fields:["prioritization"],init:function(e){this._eventAggregator=e.eventAggregator,this.skeletonView=e.skeletonView,this._boardSettingsService=e.modelSettings.listSettings.boardSettingsService,this._apiService=e.modelSettings.listSettings.apiService,this._configurator=e.configurator,this.dndOptions=e.behaviorsSettings.dndOptions||{}},attach:function(){$(this._configurator.getWindow()).on("keydown"+this._eventNamespace,this._trackShiftKeyState.bind(this)).on("keyup"+this._eventNamespace,this._trackShiftKeyState.bind(this)),this._eventAggregator.treeRendered.once(this._onInitialTreeRendered,this),this._boardSettingsService.get(this._fields).then(function(e){this._setPrioritization(e.prioritization)}.bind(this)),this._boardSettingsService.bind({fields:this._fields,listener:this,callback:function(e){this._setPrioritization(e.prioritization)}.bind(this)})},_onInitialTreeRendered:function(){e.each(this.skeletonView.getAllTreeViews(),this._onTreeViewCreated,this),this.skeletonView.treeViewCreated.add(this._onTreeViewCreated,this)},_setPrioritization:function(t){t=e.defaults({},t,{mode:"enabled"}),this.dndOptions.prioritization!==t.mode&&(this.dndOptions.prioritization=t.mode,this.setDndOptions())},_trackShiftKeyState:function(e){this.dndOptions.shiftKey!==e.shiftKey&&(this.dndOptions.shiftKey=e.shiftKey,this.setDndOptions())
},setDndOptions:function(){this.skeletonView.$el.toggleClass("tau-list-prioritization-enabled","enabled"===this.dndOptions.prioritization).toggleClass("tau-list-prioritization-shiftDown","shift"===this.dndOptions.prioritization&&!!this.dndOptions.shiftKey),this.setDndOptionsForView(this.skeletonView._rootView)},setDndOptionsForView:function(t){t&&(t.dndView&&t.dndView.setDndOptions(this.dndOptions),e.each(t.subViews,this.setDndOptionsForView,this))},_onTreeViewCreated:function(e){e.dndView=new n(e,this)},applyDndMove:function(t){var n={itemId:t.item.data("id"),beforeItemId:t.itemBefore.data("id"),afterItemId:t.itemAfter.data("id"),path:t.treeModel.hierarchy.getPath()};return this._apiService.treeViewPrioritizeBatch({$set:{items:[n]}}).done(function(a){taus.track({action:"drag and drop(prioritize)",cardTypes:e.map(t.treeModel.hierarchyMetaInfo.cardTypes,function(e){return e.typeName}),tags:["newlist"]});var r=t.treeModel;e.each(a.data,function(e){var t=r.hierarchy.findChildByCardId(e.dataItem.id);t?t.card.orderingValue=e.dataItem.orderingValue:i.assertError(!1,"Update card after d&d: cannot find node in model",n)}),r.sortCards()}.bind(this))},destroy:function(){$(this._configurator.getWindow()).off(this._eventNamespace),this._boardSettingsService.unbind({listener:this})}})}),define("tau/components/board.new.list/views/sortingBehavior",["Underscore","tau/core/class","tau/components/board.new.list/views/sortingItem"],function(e,t,i){return t.extend({STAT_KEY:"statistics_newlist_sort",init:function(e){this._skeletonView=e.skeletonView,this._rootController=e.rootTreeController,this._modelSettings=e.modelSettings},attach:function(){this._skeletonView.treeViewCreated.add(this._onTreeViewCreated.bind(this))},sort:function(t){var i=t.getOrdering(),n=0===t.nodeCollection.level?[this._rootController._model]:this._rootController._model.hierarchy.getExpandedModelsAtLevel(t.nodeCollection.level);e.each(n,function(e){e.nodes.setCustomOrdering(i)});var a=e.map(n,function(e){return e.hierarchy.getPath()
}),r=this.STAT_KEY,s=this._skeletonView;taus.start(r,{}),this._treeViewByLevel(a,t).done(this._updateNodes.bind(this,n)).done(this._updateQuickAdd.bind(this,n)).done(this._updateCounts.bind(this,n)).done(this._recalculateColumnWidthsForLevel.bind(this,n)).always(function(){s.toggleProgress(!1),taus.stop(r,{ordering:i,types:t.nodeCollection.hierarchyMetaInfo.cardTypes,requestState:this.state()})})},_updateNodes:function(t,i){e.each(t,function(e){var t=e.hierarchy.getPath(),n=e.hierarchy.findRawNodeByPath(i.data,t);e.updateChildrenNodes(n.nodes,i.data.meta)},this)},_recalculateColumnWidthsForLevel:function(e){e.length>0&&this._skeletonView.calculateColumnWidthsForLevel(e[0].level+1)},_treeViewByLevel:function(e,t){var i=t.nodeCollection,n=i.pagingModel.getTake(),a=i.hierarchyMetaInfo.levelType.toLowerCase(),r={$skip:0,$take:n,$set:{expansionState:e,level:i.level,orderingConfig:{levelType:a,ordering:t.getOrdering()}}};return this._modelSettings.listSettings.apiService.treeViewByLevel(r)},_onTreeViewCreated:function(e){var t=e.findHeaderHolder(),n=e.treeModel;t.on("click.newlist",".i-role-card-sorting",function(e){var t=$(e.currentTarget);if(0===t.closest(".tau-list-level-empty").length){var a=new i(t,n);this.sort(a),this._skeletonView.toggleProgress(!0)}}.bind(this))},_updateData:function(t,i,n){var a=e.flatMap(t,function(e){return i(e).getExpansionStateForLoadData()});if(a.length){var r={$set:{expansionState:a}};n(this._modelSettings.listSettings.apiService,r).done(function(e){var t=this._rootController._model;i(t).setSparseData(e.data)}.bind(this))}},_updateCounts:function(e){this._updateData(e,function(e){return e.countsModel},function(e,t){return e.treeViewCountsSparse(t)})},_updateQuickAdd:function(e){this._updateData(e,function(e){return e.quickAddModel},function(e,t){return e.treeViewPossibleActionsSparse(t)})},destroy:function(){}})}),define("tau/components/board.new.list/views/resizableBehavior",["Underscore","tau/core/class","tau/components/board.new.list/views/units/nameUnit"],function(e,t,i){return t.extend({init:function(e){this._eventAggregator=e.eventAggregator,this._columnWidthService=e.skeletonView.columnWidthService,this._$el=e.skeletonView.$el
},getResizeControl:function(){return this._$el.find(".tau-board-list-view-resizer")},attach:function(){this._eventAggregator.treeRendered.once(this.attachHandlerResizable.bind(this))},attachHandlerResizable:function(){var e=this._$el;e.find(".i-role-list-root-container").css("position","relative");var t=this.getResizeControl(),n=e.find(".tau-list-collapser-cell").width()||0,a=Math.ceil(t.width()/2),r=e.find(".tau-drag-handler-cell").width()||0,s=n+r-a,o=this._columnWidthService.layout.name||i.prototype.MIN_UNIT_WIDTH,l=o+s;t.css({left:l,right:0}),t.draggable({helper:function(){return t.clone().addClass("tau-list-caption-cell__resizable-helper")},start:function(){var e=t.parent().offset().left+i.prototype.MIN_UNIT_WIDTH+s;t.data("ui-draggable").containment=[e],t.draggable("option","containment",[e])},stop:function(e,i){var n=i.position.left-s;this._columnWidthService.setNameWidth(n,this._$el).then(function(){t.css({left:i.position.left})}.bind(this)).then(function(){taus.track({action:"name column resize",columnSize:n,tags:["newlist"]})})}.bind(this),appendTo:"parent",axis:"x"})},destroy:function(){var e=this.getResizeControl();e.data("ui-draggable")&&e.draggable("destroy")}})}),define("tau/models/board.customize.units/const.entity.types",["Underscore","tau/models/board.customize.units/const.entity.types.names"],function(e,t){var i=function(){this.entity={},this[t.GENERAL]={base:"entity"},this.assignable={base:t.GENERAL},this[t.US]={base:"assignable"},this[t.BUG]={base:"assignable"},this[t.FEATURE]={base:"assignable"},this[t.EPIC]={base:"assignable"},this[t.TASK]={base:"assignable"},this[t.REQUEST]={base:"assignable"},this[t.TEST_CASE]={base:t.GENERAL},this[t.TEST_CASE_RUN]={base:"entity"},this[t.IMPEDIMENT]={base:t.GENERAL},this[t.ASSIGNED_USER]={base:"entity"},this[t.USER]={base:"entity"},this[t.PROJECT]={base:t.GENERAL},this[t.PROGRAM]={base:t.GENERAL},this[t.TEAM]={base:t.GENERAL},this[t.ITERATION]={base:t.GENERAL},this[t.TEAM_ITERATION]={base:t.GENERAL},this[t.RELEASE]={base:t.GENERAL},this[t.TEST_PLAN]={base:"assignable"},this[t.TEST_PLAN_RUN]={base:"assignable"},this[t.BUILD]={base:t.GENERAL},this[t.PROJECT_MEMBER]={base:"entity"},this[t.INBOUND_RELATIONS]={base:t.GENERAL},this[t.OUTBOUND_RELATIONS]={base:t.GENERAL},this[t.TIME]={base:"entity"}
};return i.prototype.isAssignable=function(e){return e&&this[e]&&("assignable"==e||this.isAssignable(this[e].base))},i.prototype.isGeneral=function(e){return e&&this[e]&&(e==t.GENERAL||this.isGeneral(this[e].base))},i.prototype.getParents=function(e){return e&&this[e]?this.getParents(this[e].base).concat([e]):[]},new i}),define("tau/models/board.customize.units/board.customize.cards.builderSelector",["Underscore","tau/core/class","tau/models/board.customize.units/const.entity.types","tau/models/board.customize.units/const.entity.types.names"],function(e,t,i,n){return t.extend({defaultSettings:{entity:"id",general:"name, type:entityType.name, projectId:project.id",user:'fullName as name,type:"user",avatarUri',assigneduser:'fullName as name,type:"user",avatarUri',project:"color",assignable:"entityState.isFinal, teamId:team.id",team:"icon",teamiteration:"it.isInPast() as isInPast",release:"it.isInPast() as isInPast",iteration:"it.isInPast() as isInPast",testcaserun:'name,type:"testcaserun"',time:'type:"time"',impediment:"entityState.isFinal",projectmember:['type:"projectmember"',"name:user.fullName","avatarUri:user.avatarUri","color:project.color","project:{project.abbreviation,project.name}","projectId:project.id"].join(",")},createItemData:function(e,t){var i=t.unit.getModelByTypeAndSize(e);return t.unit.id+":{"+i+"}"},build:function(t,i){var n=this.createItemData.bind(this,t),a=e.flatten([this.getCardDataByType(t),e.chain(i).flatten().map(n).compact().value()],!1);return"{"+e.compact(a).join(",")+"}"},init:function(){this.cardsSettings=this.generateCardsData()},generateCardsData:function(){return e.chain(n).map(function(t){var n=i.getParents(t),a=e.reduce(n,function(t,i){var n=this.defaultSettings[i];return n?e.compact([t,n]).join(","):t}.bind(this),"");return a?(a="cardData:{"+a+"}",a=e.extend(a,{type:t})):a='cardData:""',[t,a]}.bind(this)).object().value()},getCardDataByType:function(e){return this.cardsSettings[e.toLowerCase()]||'cardData:""'},parseSelector:function(e){var t,i=0,n=e.indexOf("cardData:"),a="";
if(-1!==n){for(var r=n,s=e.length;s>r;r++)if("{"==e[r])i+=1;else if("}"==e[r]&&(i-=1,0===i)){t=r+1;break}a=e.substring(n,t)}return e=e.replace(a,""),e=e.replace("{,","{"),{cardData:a,withoutCardData:e}},buildSelectorWithoutCardData:function(e){return this.parseSelector(e).withoutCardData}})}),define("tau/components/board.new.list/models/hierarchy.innerLevels",["jQuery","Underscore","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n){return{getInnerTypes:function(e){return e.innerLevels?t.flatMap(e.innerLevels.items,function(e){return t.flatMap(e.items,function(e){return t.map(e.items,function(e){return e.id})})}):[]},createInnerLevelsDefinition:function(i,n){var a=i.getMetaForCells()||{},r=t.chain(a.cardTypes).map(function(e){return e.canExpand?this._getCardDataForInnerTypes(e.innerTypes,n).then(function(t){return{parentEntityType:e.valueType,items:t}}):null},this).compact().value();return e.when.all(r).then(function(e){return{items:[{items:e}]}})},_getCardDataForInnerTypes:function(a,r){if(!a||!a.length)return e.Deferred().resolve();a=t.map(a,function(e){return e.toLowerCase()});var s=new i;return r.getCardLayoutsByTypesAndSize(a,n.LIST).then(function(e){return t.map(e,function(e,t){return{id:t,data:s.build(t,e)}})})}}}),define("tau/components/board.new.list/storeListenerBehavior",["Underscore","tau/core/class","./models/hierarchy.innerLevels"],function(e,t,i){return t.extend({init:function(e){this._newListModel=e.listModel,this._definition=e.modelSettings.listSettings.apiService.config.definition,this._store=e.configurator.getStore(),this._apiService=e.modelSettings.listSettings.apiService},attach:function(){this._apiService.innerLevelsDefinitionChanged.add(this._subscribeToStore,this),this._subscribeToStore()},_getTypesToSubscribeTo:function(t){var n=e.pluck(t.cells.types,"type"),a=t.x?t.x.types:[],r=t.y?t.y.types:[],s=i.getInnerTypes(t);return e.union(n,a,r,s)},_subscribeToStore:function(){this._unsubscribeFromStore();
var t=this._getTypesToSubscribeTo(this._definition);e.forEach(t,e.bind(function(t){this._store.on({eventName:"afterRemove",type:t,listener:this},e.bind(function(e){this._newListModel.deleteCard(e.data.id,e.data.type)},this));var i=this._store.getEvictedPropertiesByType(t);e.forEach(i,function(e){this._store.on({eventName:"afterSave",type:t,listener:this,hasChanges:[e]},function(e){this._store.evictPersistedObject(e.data.id,e.data.type)}.bind(this))},this)},this)),this._store.on({eventName:"failure",listener:this},e.bind(function(i){var n=e.complexKey(i||{},"data.cmd");if(e.isObject(n)&&e.contains(t,n.type.toLowerCase())){var a=n.config.id;a&&e.contains(["save","remove"],n.name)&&this._newListModel.refreshCard(a,n.type)}},this))},destroy:function(){this._unsubscribeFromStore(),this._apiService.innerLevelsDefinitionChanged.remove(this)},_unsubscribeFromStore:function(){this._store.unbind(this)}})}),define("tau/ui/extensions/ui.context-menu",["jQuery","Underscore","tau/core/class"],function(e,t,i){return i.extend({cardContextMenuCssClass:"tau-context-menu-selected",init:function(t){this.context=t.context,!this.context&&window.console&&window.console.error&&console.error("DOM container for context menu should be specified"),this.handlers=t.handlers,this.onShow=t.onShow,this.onHide=t.onHide,this._destroyContextMenu(),e.contextMenu({context:this.context,selector:t.showSelectors.join(", "),skipShowSelector:t.skipShowSelectors.join(", "),callback:this.onContextMenuClick.bind(this),items:this.filterActions(this.handlers),events:{show:this.onContextMenuShow.bind(this),hide:this.onContextMenuHide.bind(this)},animation:{duration:0},zIndex:9999})},onContextMenuClick:function(e,t){this.trackContextMenuClick(e);var i=this.find(e,this.handlers),n=this.find(e,t.items);return i.itemClickCallback&&i.itemClickCallback(t,n)},trackContextMenuClick:function(e){taus.track({action:"click context menu",name:e,tags:["context menu",e,"click"]})},onContextMenuShow:function(e){this.onShow&&this.onShow(e);
var i=e.$trigger;i.addClass(this.cardContextMenuCssClass),i.attr("data-card-selector","#"+i.parent().uniqueId().attr("id")+' .i-role-card[data-entity-id="'+i.data("entityId")+'"]'),t.each(this.flatten(this.handlers),function(t,i){if(t.onShow){var n=this.find(i,e.items);t.onShow(e,n)}},this)},onContextMenuHide:function(i){this.onHide&&this.onHide(i),e(".i-role-card").removeClass(this.cardContextMenuCssClass),t.each(this.flatten(this.handlers),function(e,t){if(e.onHide){var n=this.find(t,i.items);e.onHide(n,i)}},this)},find:function(e,t){var i=this.flatten(t);return i[e]},flatten:function(e){var i=function(e,t,n,a){return e[n]=t,null!==t&&t.hasOwnProperty("items")?a(t.items,i,e):e},n=function(e,i,n){return t.reduce(e,i,n,e)};return n(e,function(e,t,a){return i(e,t,a,n)},{})},filterActions:function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];i.hasOwnProperty("isDisabled")&&i.isDisabled&&delete e[t]}return e},_destroyContextMenu:function(){e.contextMenu("destroy",{context:this.context})},destroy:function(){this._destroyContextMenu(),this.context=null,this.handlers=null}})}),define("tau/utils/utils.sliceApi",["Underscore"],function(e){var t={convertCellsResponseToComet:function(t){return e.flatten(e(t.data.items).map(function(t){return e(t.dynamic.items).map(function(e){return{x:t.x,y:t.y,data:e}})}))}};return t}),define("tau/utils/utils.boardCard",["Underscore"],function(){var e={convertToEntity:function(e){return{entityType:{name:e.entityType},id:e.entityId}}};return e}),define("tau/ui/extensions/board.plus/card-context-menu/menu-bubbleCreator",["jQuery","Underscore","tau/utils/utils.boardCard","tau/core/class"],function(e,t,i,n){return n.extend({targetMarkerClass:"i-role-context-menu-bubble",init:function(n,a){this.$trigger=n,this.activationCssClass=a.settings.activationCssClass,this.propertiesToEvict=a.settings.propertiesToEvict,this.bus=a.settings.bus,this.configurator=a.settings.configurator,this.updateCardAction=t.bind(a.updateCard,a),this.cardData=n.data(),this.entity=i.convertToEntity(this.cardData),this.cardSelector='.i-role-permanent-card-is-editing.i-role-card[data-entity-id="'+this.entity.id+'"]',this.coords=n.closest(".i-role-cellholder").data(),e("."+this.targetMarkerClass).remove()
},getAlignTo:function(t){var i=e(this.cardSelector),n=t.settings.viewMode;return"timeline"==n&&i.parent().is(".i-role-timeline-card-holder,.i-role-timeline-planner-card-holder")?i.parent():(0===i.length&&this.$trigger&&(i=e(this.$trigger.data("card-selector"))),i)},getTarget:function(){var t=e("."+this.targetMarkerClass);return 0===t.length&&(t=e("<div></div>").addClass(this.targetMarkerClass).appendTo("body")),t},createBubble:function(i){var n=this;if(this.$trigger.addClass("i-role-permanent-card-is-editing"),0===i.alignTo().length)return void this.$trigger.removeClass("i-role-permanent-card-is-editing");var a=this.getTarget(),r={cleanupOnHide:!0,target:a,showEvent:"",zIndex:99999},s=t.extend(r,i);n.propertiesToEvict.length>0&&n.configurator.getStore().evictProperties(n.entity.id,n.entity.entityType.name,n.propertiesToEvict),s.onShow=function(){e(n.cardSelector).addClass(n.activationCssClass),n.configurator.getStore().on({eventName:"afterSave",type:n.entity.entityType.name,listener:this,filter:{id:n.entity.id},changes:i.entitySubscriptionChanges},t.bind(function(e){var t=i.skipUpdateEntity&&i.skipUpdateEntity(e.data.cmd);if(!t){var r=n.updateCardAction(n.entity.id,n.coords,n.cardData);r.done(function(){var e=a.tauBubble("getAlignTo"),t=e.is(a)?"hide":"adjust";a.tauBubble(t)})}},this)),i.onBubbleShow&&i.onBubbleShow()},s.onHide=function(){e(n.cardSelector).removeClass(n.activationCssClass).removeClass("i-role-permanent-card-is-editing"),n.configurator.getStore().unbind(this),i.onBubbleHide&&i.onBubbleHide()},this.bus.fire("initBubble",s),a.tauBubble("show")}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base",["jQuery","Underscore","tau/core/class","tau/utils/utils.sliceApi","tau/ui/extensions/board.plus/card-context-menu/menu-bubbleCreator"],function(e,t,i,n,a){return i.extend({init:function(e){if(!(e.bus&&e.configurator&&e.sliceReady))throw new Error("action-base : required parameters are missing");this.settings=e},deleteCard:function(e,t){var i=[{location:"card",data:{id:e.id,data:{id:e.entityId,type:e.entityType}}}];
t.fire("operation.execute",{name:"deleted",items:i})},updateCard:function(i,a,r){var s=this,o=s.settings.bus,l=s.settings.sliceReady,u=e.Deferred();if(a&&(t.has(a,"x")||t.has(a,"y"))){u.done(function(e){var t=n.convertCellsResponseToComet(e);0===t.length?s.deleteCard(r,o):o.fire("operation.execute",{name:"updated",items:t})});var c={dataItem:{id:{$eq:i.toString()}}};l.slice.cell(c).done(u.resolve)}return u},disabled:function(e,i){var n=this,a=n.data("entityType"),r=i.items[e],s=r.getSupportedEntityTypes();return null===s||t.contains(s,a)?t.contains(r.getDisabledEntityTypes(),a):!0},getBubbleCreator:function(e){return new a(e.$trigger,this)},getSupportedEntityTypes:function(){return null},getDisabledEntityTypes:function(){}})}),define("tau/utils/utils.window",[],function(){return{tryOpenInBackgroundTab:function(e){var t=this._getOpenStrategy();t.call(this,e)},_openInNewWindow:function(e){window.open(e,"_blank")},_openWithClick:function(e){var t=document.createElement("a");document.body.appendChild(t),t.href=e;var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),t.dispatchEvent(i),t.parentNode.removeChild(t)},_getOpenStrategy:function(){var e=/chrome|webkit/i.test(window.navigator.userAgent);return e?this._openWithClick:this._openInNewWindow}}}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-open-new-tab",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/utils/utils.window"],function(e,t,i,n){return i.extend({name:"Open in new tab",className:"i-role-card-context-menu-open-new-tab",init:function(e){this.configurator=e.configurator},itemClickCallback:function(e){var t=e.$trigger.data(),i=this.configurator.getUrlBuilder().getNewViewUrl(t.entityId,t.entityType,!0);n.tryOpenInBackgroundTab(i)},getDisabledEntityTypes:function(){return["projectmember"]}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-delete",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base"],function(e,t,i){return i.extend({name:"Delete",className:"tau-context-menu-delete i-role-card-context-menu-delete",itemClickCallback:function(e,i){var n=i.$node;
return n.tauConfirm({showEvent:null,content:"<h3>Are you sure?</h3>",className:"context-menu-do-not-hide",callbacks:{success:this._deleteCard.bind(this,e)}}),t.delay(t.bind(n.tauConfirm,n),100,"show"),!1},_deleteCard:function(e){var t=e.$trigger.data(),i=this.settings.bus;e.$menu.trigger("contextmenu:hide"),this.settings.configurator.getStore().remove(t.entityType,{id:t.entityId}).done({success:this.deleteCard.bind(this,t,i)})},onHide:function(e){var t=e.$node;t.tauConfirm("instance")&&t.tauConfirm("hide")}})}),define("tau/components/board.new.list/views/contextMenuBehavior",["jQuery","Underscore","tau/core/class","tau/ui/extensions/ui.context-menu","tau/ui/extensions/board.plus/card-context-menu/menu-action-open-new-tab","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-delete"],function(e,t,i,n,a,r){return i.extend({cardMenuActionActivatedCssClass:"i-role-permanent-context-menu-action-activated",init:function(e){this.options={bus:e.componentBus,sliceReady:e.modelSettings.listSettings.apiService,configurator:e.configurator,activationCssClass:this.cardMenuActionActivatedCssClass,propertiesToEvict:[]},this.context=e.skeletonView.$el},attach:function(){var e={context:this.context,handlers:{open:new a(this.options),sep1:"---------",del:new r(this.options)},showSelectors:[".tau-board-list-view .i-role-card:not(.tau-axis-card-no-value, .tau-axis-card-no-view, .tau-elems-cell-no-value)"],skipShowSelectors:[".tau-id",".tau-bubble *"],onShow:function(e){e.$menu.addClass("tau-newlist-context-menu")}};this.contextMenu=new n(e)},destroy:function(){this.contextMenu.destroy(),this.contextMenu=null,this.context=null,this.options=null}})}),define("tau/components/component.base.new.list",["tau/components/board.new.list/models/model.new.list","tau/core/extension.base","tau/components/board.new.list/extensions/extension.new.list.cardLayout","tau/components/board.new.list/extensions/extension.new.list.selection","tau/components/board.new.list/extensions/extension.new.list.operations","tau/components/board.new.list/views/view.new.list.skeleton","tau/components/board.new.list/bus.new.list.event.aggregator","tau/models/board.plus/model.board.slice.comet","tau/components/board.new.list/views/dragndropBehavior","tau/components/board.new.list/views/sortingBehavior","tau/components/board.new.list/views/resizableBehavior","tau/components/board.new.list/storeListenerBehavior","tau/components/board.new.list/views/contextMenuBehavior"],function(e,t,i,n,a,r,s,o,l,u,c,d,p){return{createNewListConfig:function(l){var u=l.context.configurator,c=new s,d=new e(u),p=new r(u,c),f=[];
return l.context.configurator.getFeaturesService().isEnabled("comet.notifications")&&f.push({extType:o,args:[l.context.configurator,l.notificationsHubName]}),l.listOptions||(l.listOptions={}),{newList:{model:d,view:p,busEventAggregator:c},controller:t,extensions:[{extType:a,args:[d]},i,n].concat(l.extensions||[],f)}},getDefaultBehaviors:function(){return[l,u,c,d,p]}}}),define("tau/libs/inviter/inviter",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(e){this.store=e.getStore()},invite:function(t){var i=this.store,n=[];n=e.map(t,function(e){return function(t){e.id?t(!1,{success:e.id}):i.find("user",{$query:{email:e.email,deleteDate:{$isNull:!0}},fields:["id","firstName","lastName"]}).done(function(n){var a=n[0].data.length?n[0].data[0]:null;a?t(!1,{success:a.id}):i.save("user",{failureGlobal:!1,$set:{login:e.login,email:e.email,password:Math.round(1e11*Math.random())}},{success:function(e){t(!1,{success:e.data.id})},failure:function(){t(!1,{failure:e})}}).done()})}});var a=$.Deferred();return e.series(n,function(e,t){e?a.failure(e):a.resolve(t)}),a}})}),define("tau/configurations/project.colors",[],function(){return["#f9d9d1","#fbe9d6","#fdfadb","#e2eece","#d2ecea","#ceeefa","#d2e0ef","#dddceb","#f5d2e2","#e0e0e0"]}),define("tau/configurations/team.icons",[],function(){return["apple","windows","linux","chrome","firefox","internet_explorer","apache","wrench","binoculars","camcorder","camera","money","gamepad","traveler","finish","achievement","help","call_center","stethoscope","wand","horn","bug","skype","phone","pulse","thermometer","book","food","ball","gun","rabbit","airplane","truck","helicopter","spades","laugh","sunglasses","angry","skull","doctor","shamrock","sun","umbrella","knight","fish","ufo","smile","batman","superman","captain_america","flash","shield","star","android"]}),define("tau/models/quick.add/model.quick.add.base",["Underscore","jQuery","tau/core/model-base","tau/libs/inviter/inviter","tau/configurations/project.colors","tau/configurations/team.icons"],function(e,t,i,n,a,r){return i.extend({inviteMembers:function(t,i,a,r){new n(t).invite(a).done(function(t){var n=e.compact(e.pluck(t,"success")).filter(function(e){return e!=i
}).map(function(e){return{user:{id:e}}});r(n)})},preProcessField:function(e,i){var n=t.Deferred();return i.type&&"usersinvite"===i.type.toLowerCase()?this.inviteMembers(e,e.getLoggedUser().id,i.value,function(e){i.value=JSON.stringify(e),n.resolve()}.bind(this)):n.resolve(),n},getTemplateConstants:function(){return{projectColors:a,teamIcons:r}},preProcessFields:function(e){return t.when.all(e.map(this.preProcessField.bind(this,this.config.context.configurator)))}})}),define("tau/models/quick.add/model.board.quick.add.base",["Underscore","jQuery","tau/models/quick.add/model.quick.add.base"],function(e,t,i){var n="dataTemplate",a={board:"dataTemplate",list:"listDataTemplate",axis:"axisDataTemplate"},r="addData",s={board:"addData",list:"listAddData",axis:"axisAddData"};return i.extend({handleGetDataItemTemplate:function(e,t,i,n,a){var r=i.types;this.getDataTemplate(e,t,i).done(function(e){var s=e.data;n[t.name]={template:s,entityType:t},a.push(t),a.length==r.length&&(this.fire("model.dataItems.template.ready",{types:n}),this.fire("dataBind",{types:n,entityTypes:r,constants:this.getTemplateConstants(),data:i}))}.bind(this))},getDataTemplate:function(t,i,r){var s=r.slice,o=a[r.viewMode]||n,l={$set:e.extend(e.clone(t),{dataItemType:i.name})};return s[o](l)},resolveSliceAddData:function(){},onInit:function(t){var i=this.resolveSliceAddData(t);i.done(e.bind(function(e){this.fire("settings.beforeReady",{settings:e,config:t}),this.prepareTemplateData(e,t),this.fire("settings.ready",e)},this)).fail(e.bind(function(e){this.fire("dataBind",e)},this))},prepareTemplateData:function(t,i){var n=t.types,a={},r=[],s=this.getDataItemTemplateParam(t),o=e.find(n,function(e){return i.defaultType&&e.name.toLowerCase()===i.defaultType.toLowerCase()});o?o.active=!0:n.length>0&&(n[0].active=!0);var l=i.context.configurator.getSystemInfo().culture;this.fire("culture.ready",l);for(var u=0;u<n.length;u++){var c=n[u];this.handleGetDataItemTemplate(s,c,t,a,r)}},getDataItemTemplateParam:function(e){var t=e.action;
return"axis"===e.viewMode?{location:t.location}:{x:t.x||void 0,y:t.y||void 0}},getDoAddParams:function(e,t){var i={type:e.type,values:e.fields};return"axis"===t.viewMode?i.location=t.action.location:(i.x=t.action.x,i.y=t.action.y),i},doAdd:function(t,i,n){var a=n.slice,o=s[n.viewMode]||r,l=e.find(t,function(e){return e.name==i.type}),u=a.config.definition.global.acid,c=i.type.toLowerCase();("project"==c||"team"==c||"program"==c)&&(a.config.definition.global.acid=null);var d=this.getDoAddParams(i,n),p={$set:d,errorHandler:function(){return!1}},f=this.config.context.configurator;a[o](p).always(e.bind(function(e){e&&!a.config.definition.global.acid&&(f.getStore().evictCollection(c),f.getApplicationContextService().refreshChoice(),a.config.definition.global.acid=e)},this,u)).done(e.bind(function(e){var t={message:e.data[0],nameType:l,openAfter:i.openAfter};this.onAfterAddData(n,e,t)},this)).fail(e.bind(function(e){return this.fire("model.data.item.did.fail.add",e.data.responseText),!1},this)),taus.track({action:"add entity",name:(e.findWhere(d.values,{id:"Name"})||"").value,tags:["add entity","quick add"],type:c})},onAfterAddData:function(e,t,i){this.fire("model.data.item.did.add",i)},"bus dataBind:last + model.add.item + settings.ready:last":function(e,t,i,n){this.preProcessFields(i.fields).done(this.doAdd.bind(this,t.entityTypes,i,n))}})}),define("tau/models/quick.add/model.board.cell.quick.add",["Underscore","jQuery","tau/models/quick.add/model.board.quick.add.base"],function(e,t,i){return i.extend({resolveSliceAddData:function(){var e=t.Deferred(),i=this.config.options;return e.resolve({slice:i.slice,types:i.addAction.data.types,action:i.action,viewMode:i.viewMode,isGeneralAdd:!1}),e}})}),define("tau/ui/extensions/board.cell.quick.add/quick.add.error.handler",["Underscore"],function(e){var t=function(t,i){for(var a=t;a.InnerException;)a=a.InnerException;return e.isUndefined(a)||"Tp.BusinessObjects.InvalidLicenseException"!==a.Type?!1:(n(a.Message,i),!0)},i=function(t,i,n,a){if(!(t.Details&&t.Details.ServerErrorCodes&&e.contains(t.Details.ServerErrorCodes,"ProjectNotAssignedToTeam")))return!1;
var r=a.getStore(),s=$('<div class="tau-message tau-danger">'+t.Message+' <a class="i-role-assign-team-to-project" href="#">Assign</a></div>'),o=t.InnerException.Details.Suggest,l=e.findWhere(o,{id:"project"}).value,u=e.findWhere(o,{id:"team"}).value;return s.find("a").on("click",function(){r.save("teamProject",{$set:{project:{id:l},team:{id:u}},fields:["id","project","team"]}).done({success:function(e){var t=e[0].data.team.name,n=e[0].data.project.name,a=$('<div class="tau-message tau-success"> Success! The '+t+" team is now assigned to the "+n+" project.</div>");i.setText(a)}})}),i.setText(s),!0},n=function(e,t){var i=$('<div class="tau-message tau-danger">Error: '+e+"</div>");t.setText(i)};return{handle:function(e,a,r,s){t(e,r)||i(e,r,a,s)||n(e.Message,r)}}}),define("tau/models/quick.add/model.board.general.quick.add",["Underscore","jQuery","tau/models/quick.add/model.board.quick.add.base","tau/services/service.features"],function(e,t,i,n){var a=new n;return i.extend({getTypes:function(){var e=["feature","userstory","task","bug","request","testcase","testplan","impediment","release","iteration","teamiteration","build","program","project","team","user"];return a.isEnabled("entity.epics")&&e.unshift("epic"),e},getViewMode:function(){return"list"},getDefinition:function(e){var t={global:{acid:e},cells:{types:this.getTypes()}};return t},getSingleCellSliceDefinition:function(e,t){var i={global:{acid:e},cells:{types:[t]}};return i},resolveSliceAddData:function(e){var i=t.Deferred(),n=e.context.configurator;return this.context?n.getApplicationContextService().getApplicationContext(this.context).then(function(t){this.getActions(t,e,i)}.bind(this)):n.getAppStateStore().get({fields:["acid"]}).then(function(t){this.getActions(t,e,i)}.bind(this)),i},getActions:function(t,i,n){var a=t.acid,r=this.getDefinition(a),s=i.context.configurator.getSliceFactory().create({definition:r});s.listModeActionsV2().then(function(t){var r={};r.action=t.data.items[0],e.isEmpty(r.action)?this.processEmptyAddButtonAction(i,a,n):this.processAddButtonAction(r,s,i,n)
}.bind(this))},processAddButtonAction:function(t,i,n,a){t.addAction=e.find(t.action.fixed.items,function(e){return"AddAction"==e.type}),a.resolve({slice:i,types:this.getProcessedTypes(n,t.addAction.data.types),action:t.action,viewMode:this.getViewMode(),isGeneralAdd:!0})},processEmptyAddButtonAction:function(e,t,i){e.context.configurator.getApplicationContextService().getApplicationContext({acid:t},{success:function(e){var t={isEmpty:!0};1==e.selectedProjectIds.length&&"null"==e.selectedProjectIds[0]&&1==e.selectedTeamIds.length&&"null"==e.selectedTeamIds[0]&&(t.emptyContext=!0),i.reject(t)}})},getProcessedTypes:function(e,t){return t},doAdd:function(t,i,n){var a=e.deepClone(n);a.slice=this.buildReadyToAddSlice(n.slice,i),this._super(t,i,a)},buildReadyToAddSlice:function(t,i){var n=this.config.context.configurator,a=e.find(t.config.definition.cells.types,function(e){return e==i.type.toLowerCase()}),r=this.getSingleCellSliceDefinition(t.config.definition.acid,a);return n.getSliceFactory().create({definition:r})}})}),define("tau/ui/extensions/board.cell.quick.add/board.cell.quick.add.related",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/models/quick.add/model.board.general.quick.add"],function(e,t,i,n){var a=i.extend({"bus settings.beforeReady":function(e,t){t.settings.isGeneralAdd=!1,t.settings.isRelatedAdd=!0},"bus dataBind + afterRender":function(t,i,n){var a=n.element;a.on("click.quickAdd",".i-role-cancel",e.bind(this.onCancel,this))},onCancel:function(){this.fire("close")}});return{init:function(e){this.config=this._getExtendedConfig(e);var i=t.Deferred(),n=this._getBubbleConfig(i);return this.config.ctx.fire("initBubble",n),i},show:function(t){var i=this._getShowDelay();e.delay(function(){t.tauBubble("show")},i)},isInitialized:function(e){return!!e.tauBubble("instance")},destroy:function(e){e.tauBubble("destroy")},_getExtendedConfig:function(t){var i=t.$element,n=i.closest(".tau-bubble__inner"),a=i.closest(".tau-entity-controls"),r=e.extend({},t,{childBuses:t.ctx.childBus,entityUniqueName:i.data("entityuniquename"),$innerBubble:n,$controlsContainer:a,$field:i.closest(".tau-field"),$selector:i.siblings(".userStorySelector"),TOP_BUBBLE_MARGIN:parseInt(n.css("margin-top"),10),LEFT_CONTROLS_PADDING:parseInt(a.css("padding-left"),10),HORIZONTAL_OFFSET:15,VERTICAL_OFFSET:12,HIDE_DURATION_IF_FINDER_DISPLAYED:400});
return r},_getShowDelay:function(){return this.config.$selector.is(":visible")?0:this.config.HIDE_DURATION_IF_FINDER_DISPLAYED},_getBubbleConfig:function(e){var t=this.config.$target,i=this.config.$field,n=this._getComponentsConfig(),a={target:t,alignTo:i,applyBubbleClasses:!1,cleanupOnHide:!0,stackName:"quickAddGeneral",showOnCreation:!1,ignoreOverlap:!0,zIndex:10001,onCreate:function(){e.resolve()},onBeforeShow:function(e){var t=e.find(".tau-bubble__inner"),i=this.config.$target.closest(".tau-bubble__inner"),n=i.height(),a=t.height(),r=Math.max(n,a);t.height(r)}.bind(this),onShow:function(){t.removeClass("tau-quick-add-collapse");var e=t.tauBubble("widget");this.config.ctx.fire("relatedQuickAdd.afterShow",e)}.bind(this),onHide:function(){t.addClass("tau-quick-add-collapse"),this.config.ctx.fire("relatedQuickAdd.afterHide")}.bind(this),className:"tau-quick-add-dialog-general tau-quick-add-dialog-related",onPositionConfig:function(){var e=this.config.LEFT_CONTROLS_PADDING+this.config.HORIZONTAL_OFFSET;return{my:"left+"+e+" top-"+this.config.TOP_BUBBLE_MARGIN,at:"left top",of:this.config.$controlsContainer}}.bind(this),onArrowPositionConfig:function(e,t){var n={left:{my:"left+"+this.config.HORIZONTAL_OFFSET+" center",at:"left top+"+this.config.VERTICAL_OFFSET},right:{my:"right-"+this.config.HORIZONTAL_OFFSET+" center",at:"right top+"+this.config.VERTICAL_OFFSET}},a=n[t]||{};return a.of=i,a}.bind(this),onCurrentOrientationConfig:function(e,t){return e.left>t.left?"left":"right"},dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:n};return a},_getExtension:function(){var e=this.config.entityUniqueName,t=this.config.ctx,i=this.config.childBuses,n=a.extend({"bus model.data.item.did.add":function(n,a){var r=a.message.dataItem.data;t.fire("relatedQuickAdd."+e+".added",r),i[e].fire("refresh"),this.onCancel()}});return n},_getComponentsConfig:function(){var e=this.config.$element.data("fieldname").toLowerCase(),t=this._getExtension(),i=this.config.getCurrentContext(),a={components:[{name:"board plus quick add general",type:"board.cell.quick.add",extensions:[t],QuickAddModel:n.extend({getTypes:function(){return[e]
},context:i}),defaultType:e}]};return a}}}),define("libs/jquery/jquery.placeholder",["libs/jquery/jquery"],function(e){!function(e){function t(){return i&&n?this:(e(this).each(function(){a.call(this)}),this)}var i="placeholder"in document.createElement("input"),n="placeholder"in document.createElement("textarea"),a=function(){var t=e(this).nextAll(".placeholder");e(this).val()?t.removeClass("show").addClass("hide"):t.addClass("show").removeClass("hide")};e.fn.placeholder=function(r){if("refresh"==r)return t.call(this),this;r=e.extend({style:"placeholder",template:"<label></label>"},r);var s=null,o=(e(r.template).addClass(r.style),function(){var e=this;clearTimeout(s),s=setTimeout(function(){a.call(e)},0)});return i&&n?this:(e(this).each(function(){var t=e(this),i=e(r.template).addClass(r.style).addClass("placeholder").attr("for",this.id);i.appendTo(t.parent()),i.text(t.attr("placeholder")),i.click(e.proxy(function(){e(this).focus()},this)),a.call(this)}),e(this).on("keydown.placeholder keypress.placeholder input paste focus change",o),this)}}(e)}),define("libs/jquery/jquery.caret",["libs/jquery/jquery","Underscore"],function(e,t){return e.caretTo=function(e,t,i){if(e.createTextRange){var n=e.createTextRange();i&&t!=i?(n.moveStart("character",t),n.moveEnd("character",i)):n.move("character",t),n.select()}else e.setSelectionRange&&(e.focus(),e.setSelectionRange(t,i||t))},e.caretPos=function(e){if("selection"in document){var t=e.createTextRange();try{t.setEndPoint("EndToStart",document.selection.createRange())}catch(i){return 0}return t.text.length}return null!=e.selectionStart?e.selectionStart:void 0},e.fn.caret=function(t,i){return"undefined"==typeof t?e.caretPos(this.get(0)):this.queue(function(n){if(isNaN(t)){var a=e(this).val().indexOf(t);i===!0?a+=t.length:"undefined"!=typeof i&&(a+=i),e.caretTo(this,a)}else e.caretTo(this,t);n()})},e.fn.caretToStart=function(){return this.caret(0)},e.fn.caretToEnd=function(){return this.queue(function(t){e.caretTo(this,e(this).val().length),t()
})},e.fn.caretAll=function(){return this.queue(function(i){e.caretTo(this,0,t.asString(e(this).val()).length),i()})},e.clearSelection=function(){document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},e}),define("libs/jquery/jquery.inputMaskEditor",["jQuery"],function(e){return e.widget("tau.inputMaskEditor",{options:{className:"editableText",mask:null},_create:function(){this.element.addClass(this.options.className).on("keypress"+this.eventNamespace,this.onKeyPress.bind(this))},onKeyPress:function(e){if(this.options.mask&&!(e.ctrlKey||e.altKey||e.metaKey||e.which<32)){var t=String.fromCharCode(e.which),i=e.target.value,n=this._getSelection(e.target);n.statusSelection?i=i.substring(0,n.start)+t+i.substring(n.end):i+=t;var a=new RegExp(this.options.mask);a.test(i)||e.preventDefault()}},_getSelection:function(e){var t;return t="number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?{start:e.selectionStart,end:e.selectionEnd}:this._getSelectionFromRange(e),t.statusSelection=t.start!==t.end,t},_getSelectionFromRange:function(e){var t,i,n,a,r,s=0,o=0;return i&&i.parentElement()==e&&(a=e.value.length,t=e.value.replace(/\r\n/g,"\n"),n=e.createTextRange(),n.moveToBookmark(i.getBookmark()),r=e.createTextRange(),r.collapse(!1),n.compareEndPoints("StartToEnd",r)>-1?(s=a,o=a):(s=-n.moveStart("character",-a),s+=t.slice(0,s).split("\n").length-1,n.compareEndPoints("EndToEnd",r)>-1?o=a:(o=-n.moveEnd("character",-a),o+=t.slice(0,o).split("\n").length-1))),{start:s,end:o}}}),e}),define("tau/ui/extensions/board.cell.quick.add/board.cell.quick.add.config.fields",["Underscore","jQuery","tau/utils/utils.date","tau/core/class","tau/components/extensions/component.extension.base","tau/models/quick.add/model.board.general.quick.add","tau/ui/extensions/board.cell.quick.add/board.cell.quick.add.related","libs/jquery/jquery.placeholder","libs/jquery/jquery.caret","libs/jquery/jquery.inputMaskEditor","tau/ui/extensions/inviter/jquery.tauInviter"],function(e,t,i,n,a,r,s){return n.extend({init:function(e){this.config=e
},hasErrors:!1,validate:function(i){var n=!1,a=this.getFormData(i);return e.each(i,function(i){var r=t(i),s=this.getElementData(r),o=s.validateData;e.any(o.rules,function(e){var t=a[s.fieldname],i=this.typesValidate[e].validate(t,s,a),o=!1;return i.result?this.typesValidate[e].hideError?this.typesValidate[e].hideError(r):this.hideError(r):(this.typesValidate[e].showError?this.typesValidate[e].showError(r,i.message):this.showError(r,i.message),n=!0,o=!0),o},this)},this),this.hasErrors=n,!n},getValue:function(e){var t=(e.data("fieldtype")+"").toLowerCase();return this.typesValue[t]?this.typesValue[t].call(this,e):this.typesValue["default"].call(this,e)},getElementData:function(e){return{$element:e,fieldname:e.data("fieldname"),validateData:e.data("validate")}},getFormData:function(i){var n={};return e.each(i,function(e){var i=t(e),a=i.data("fieldname"),r=this.getValue(i);n[a]=r},this),n},getCfValue:function(e){var i=t(e),n=i.data("fieldtype");switch(n){case"DropDown":case"TemplatedURL":case"Number":case"Date":case"DateTime":case"Text":return i.val();case"MultipleSelectionList":return i.val()&&i.val().join(",")||"";case"CheckBox":return i.prop("checked");case"Entity":var a=i.data();return{id:a.value.id,kind:a.value.entityType.name,name:a.value.name};case"URL":var r=i.parent(),s=r.find(".cf-input-url_value").val(),o=r.find(".cf-input-url_description").val();return{url:s,label:o};default:return null}},typesValidate:{required:{validate:function(t){return{result:!e.isEmpty(t),message:"This is a required field."}}},"required-team-project":{validate:function(e,t,i){var n="project"in i,a="team"in i,r=i.project&&-1!=i.project,s=i.team&&-1!=i.team,o=r||s,l=n&&a,u=!l||o;return{result:u,message:"Either Project or Team should be selected."}}},"required-ddl":{validate:function(t){return{result:!e.isEmpty(t)&&-1!=t,message:"This is a required field."}}},text:{validate:function(){return{result:!0}}},email:{validate:function(t){return""==e.trim(t)?{result:!0}:{result:/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/gi.test(e.trim(t)),message:"Invalid email address."}
}},number:{validate:function(t){if(""==e.trim(t))return{result:!0};t=(t+"").replace(",",".");var i,n=!0;return isNaN(t)?(n=!1,i="the value can only be a valid number, e.g. 1, 3.14 or 2010"):t>e.MAX_INT?(n=!1,i="Please, enter a reasonable number."):0>t&&(n=!1,i="Number must be greater than 0"),{result:n,message:i}}},integer:{validate:function(t){if(""==e.trim(t))return{result:!0};var i,n=!0;return isNaN(t)||!/^\d+$/.test(t)?(n=!1,i="the value can only be a integer, e.g. 1, 2, 14"):t>e.MAX_INT?(n=!1,i="Please, enter a reasonable number."):0>=t&&(n=!1,i="Number must be greater than 0"),{result:n,message:i}}},date:{validate:function(t){if(""==e.trim(t))return{result:!0};var n,a=i.parse(t),r=!0;return null===a?(n="Incorrect date format",r=!1):a<new Date(1900,0,1)&&(n="Date must be greater than 01-01-1900",r=!1),{result:r,message:n}}},entityRequired:{validate:function(t){return{result:!e.isEmpty(t)}},showError:function(e){e.closest(".tau-userStorySelector").addClass("tau-error").attr("title","This is a required field.")},hideError:function(e){e.closest(".tau-userStorySelector").removeClass("tau-error").removeAttr("title")}},checkbox:{validate:function(){return{result:!0}}},url:{validate:function(t){return""==e.trim(t)?{result:!0}:{result:/\b((?:https?|ftp|file):\/\/(?:[\-A-Z0-9.]+)(?::\d+)?(?:\/[\-A-Z0-9+&@#\/%=~_|!:,.;]*)?(?:\?[A-Z0-9+&@#\/%=~_|!:,.; ]*)?)/i.test(t),message:"Invalid url address."}}},usersinvite:{validate:function(){return{result:!0}}},teammultiselect:{validate:function(){return{result:!0}}},projectmultiselect:{validate:function(){return{result:!0}}},color:{validate:function(){return{result:!0}}},icon:{validate:function(){return{result:!0}}}},showError:function(e,t){e.addClass("tau-error").attr("title",t).nextAll(".placeholder").addClass("tau-error")},hideError:function(e){e.removeClass("tau-error").removeAttr("title").nextAll(".placeholder").removeClass("tau-error")},setBehavior:function(i){e.each(i,function(e){var i=t(e),n=(i.data("fieldtype")+"").toLowerCase();
this.typesBehavior[n]&&this.typesBehavior[n].call(this,i)},this)},typesBehavior:{date:function(e){t.datepicker.parseDate=function(e,t){return i.parse(t)},t.datepicker.formatDate=function(e,t){return i.formatAs(t,e)};var n=i.getFormatData().date.short;e.datepicker({dateFormat:n})},datetime:function(e){t.datepicker.parseDate=function(e,t){return i.parse(t)},t.datepicker.formatDate=function(e,t){return i.formatAs(t,e)},t.datepicker.formatTime=function(e,t){return i.formatAs(t,e)};var n=i.getFormatData().date.short;e.datetimepicker({dateFormat:n,showButtonPanel:!1})},text:t.noop(),number:function(e){var t="^[0-9]*([\\"+this.config.culture.decimalSeparator+"][0-9]{0,2})?$";e.inputMaskEditor({mask:t})},integer:function(e){var t="^[0-9]*?$";e.inputMaskEditor({mask:t})},userstoryselector:function(e){var i=this.typesClear.entity,n=e.data("entityuniquename"),a=this._getFieldByClassFromElement(e,"project");this.entityBehavior(e),a.change(t.proxy(function(a){i(e),this.childBus[n].fire("refresh",{filter:{project:t(a.target).val()}})},this.config.self))},releaseselector:function(e){var i=this.typesClear.entity,n=e.data("entityuniquename"),a=this._getFieldByClassFromElement(e,"project");this.entityBehavior(e),a.change(t.proxy(function(a){i(e),this.childBus[n].fire("refresh",{filter:{project:t(a.target).val()}})},this.config.self))},testplanselector:function(e){var i=this.typesClear.entity,n=e.data("entityuniquename"),a=this._getFieldByClassFromElement(e,"project");this.entityBehavior(e),a.change(t.proxy(function(a){i(e),this.childBus[n].fire("refresh",{filter:{project:t(a.target).val()}})},this.config.self))},userselector:function(e){this.entityBehavior(e)},entity:function(e){this.entityBehavior(e)},usersinvite:function(e){e.parent().css({maxWidth:t(window).width()/3});var i=e.data("selected");e.tauInviter({configurator:this.config.configurator,allowEmails:!0,canDelete:function(e){return i.id!==e.id}}),i&&i.id&&e.tauInviter("setValue",[{id:i.id,type:"existing",name:i.email,avatarUri:i.avatarUri}])
},teammultiselect:function(e){e.css({maxHeight:t(window).height()/3}),this.config.self.fire("adjustPosition")},projectmultiselect:function(e){e.css({maxHeight:t(window).height()/3}),this.config.self.fire("adjustPosition")},color:function(e){var t=this._initRichSelect(e,"color");t.on("change",function(e,i){t.attr("style","background-color: "+(i||"default"))}),this.config.self.fire("adjustPosition")},icon:function(e){var t=this._initRichSelect(e,"icon");t.on("change",function(e,i){var n=t.attr("data-value");t.removeClass("tau-icon_name_"+n),t.addClass("tau-icon_name_"+(i||"default"))}),this.config.self.fire("adjustPosition")}},clear:function(i){e.each(i,function(e){var i=t(e),n=(i.data("fieldtype")+"").toLowerCase();this.typesClear[n]?this.typesClear[n].call(this,i):this.typesClear["default"].call(this,i)},this)},typesClear:{"default":function(e){"Remain"!=e.data("fieldname")&&e.val("")},date:function(e){"Time"!==e.closest("form").data("type")&&e.val("")},dropdown:function(e){e.find("option").eq(0).prop("selected",!0)},entity:function(e){e.val("");var t=e.parent();t.find(".tau-linkentity__inner").text(e.attr("placeholder")).addClass("tau-linkentity__inner_placeholder"),t.find(".tau-linkentity__icon").hide()},checkbox:function(e){e.prop("checked",!1)},usersinvite:function(e){e.tauInviter("reset")},color:function(e){e.find("select[name=color]").trigger("reset")},icon:function(e){e.find("select[name=icon]").trigger("reset")},teammultiselect:function(i){var n=i.find(":checked");e.each(n,function(e){t(e).prop("disabled")||t(e).prop("checked",!1)})},projectmultiselect:function(i){var n=i.find(":checked");e.each(n,function(e){t(e).prop("disabled")||t(e).prop("checked",!1)})},userstoryselector:t.noop,testplanselector:t.noop,releaseselector:t.noop,ddl:t.noop,url:t.noop},typesValue:{"default":function(e){return e.val()},usersinvite:function(t){var i=t.data("selected"),n=t.tauInviter("getValue");return e.reject(n,function(e){return e.id&&e.id==i.id})},teammultiselect:function(i){var n=i.find(":checked").filter(function(){return!this.disabled
});return JSON.stringify(e.map(n,function(e){return{team:{id:t(e).val()}}}))},projectmultiselect:function(i){var n=i.find(":checked").filter(function(){return!this.disabled});return JSON.stringify(e.map(n,function(e){return{project:{id:t(e).val()}}}))},color:function(e){return e.find("select[name=color]").val()},icon:function(e){return e.find("select[name=icon]").val()}},_getFieldByClassFromElement:function(e,t){return e.closest("form").find("."+t)},_getContextValue:function(e){return"-1"===e?"null":e},_getCurrentContext:function(e){var t=this._getFieldByClassFromElement(e,"project"),i=this._getFieldByClassFromElement(e,"team"),n=this._getContextValue(this.getValue(t)),a=this._getContextValue(this.getValue(i));return{projectIds:[n],teamIds:[a]}},_relatedAddClickHandler:function(e,t){var i=e.$target;s.isInitialized(i)&&s.destroy(i),t.stopImmediatePropagation(),s.init(e).then(function(){s.show(i)})},entityBehavior:function(e){var t=e.parent().parent().find(".i-role-related-quick-add"),i=0!==t.length;if(i){var n={namespace:".relatedQuickAdd",ctx:this.config.self,getCurrentContext:this._getCurrentContext.bind(this,e),$element:e,$target:t};t.on("click",this._relatedAddClickHandler.bind(this,n))}this.config.self.fire("applyFinder",e)},_initRichSelect:function(e,i){var n=e.find("select[name="+i+"]"),a=e.find(".i-role-currenticon");return n.on("change",function(){var e=n.val();a.trigger("change",e),a.attr("data-value",e||"default")}),e.find(".i-role-richselect .i-role-option").on("click",function(){var t=this.getAttribute("data-value");n.val(t),n.trigger("change"),e.find(":text:first").focus()}),a.parent().on("click",function(i){t(i).toggleClass("tau-active"),e.find(".i-role-richselect").css({width:e.width()}),e.find(".i-role-richselect").toggle(),this.fire("adjustPosition")}.bind(this.config.self)),e.on("reset",function(){n.val(""),n.trigger("change")}),a}})}),define("tau/ui/extensions/board.cell.quick.add/ui.extension.board.cell.quick.add",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/board.cell.quick.add/quick.add.error.handler","tau/ui/extensions/board.cell.quick.add/board.cell.quick.add.config.fields","libs/jquery/jquery.placeholder","libs/jquery/jquery.caret"],function(e,t,i,n,a){return i.extend({init:function(t){this._super(t);
var i=t.context.configurator,n=e.bind(this.fire,this,"viewerBus.ready");i.getComponentBusRegistry().getByName("entityViewer").done(n),i.getTemplateFactory().register({name:"board.cell.quick.add.success",engine:"jqote2",markup:["<h3>Success!</h3>","<p>","<%! this.type %> ","<% if (this.name && this.url) { %>",'<a class="ui-quick-add-notification-link i-role-card-view tau-entity-name" href="<%= this.url %>"><%! this.name %></a>',"<% } %>"," was added.","</p>"]})},"bus beforeInit:last + dataBind + afterRender":function(i,n,a,r){var s=this.$element=r.element,o=s.find(".tau-required-field-editor,.tau-add-item");s.find("form").on("submit.quickAdd",e.bind(this.onSubmit,this)),s.on("click.quickAdd",".i-role-add-open",e.bind(this.onAddOpen,this)),s.on("click.quickAdd",".i-role-entity-selector",e.bind(this.onTypeSelectorClick,this)),window.setTimeout(function(){s.parent().addClass("tau-bubble__inner_without_scroll"),s.find(".tau-entity-controls .tau-active input, .tau-entity-controls .tau-active select").eq(0).focus()},0);var l=this;s.find("form").each(function(){var e=t(this),i=e.find("[data-fieldname=Spent], [data-fieldname=Remain], [data-fieldname=Role]");3==i.length&&l._processTimeWidget(e,i,a)});var u=o.filter(".project"),c=o.filter(".team"),d=o.filter(".process"),p=d.add(u).add(c);0===p.length&&s.find(".cf-wrap").addClass("show").removeClass("hide");var f=e.bind(function(e,i){i=t(i?i:e.target);var n,a=i.find(":selected").data("option");i.hasClass("process")?n=a.id:i.hasClass("project")?n=a.processId:i.hasClass("team")&&0===i.closest("form").find(".project").length&&(n=a.processId),n&&this.toggleCustomFields(i,n)},this);p.change(f),p.each(f),this.fire("view.indicator.ready",s.tauProgressIndicator()),this.fire("view.editors.ready",o),this.fire("quick.add.popup.rendered",o)},toggleCustomFields:function(e,t){var i=e.closest("form").find(".cf-wrap").addClass("hide").removeClass("show");i.find(".cf-input").addClass("hide").removeClass("show"),i.filter(".cf-process_"+t).addClass("show").removeClass("hide").find(".cf-input").addClass("show").removeClass("hide"),this.fire("adjustPosition")
},setHtmlForMessage:function(e,t){var i=e.find(".tau-message-pool");i.children().remove(),i.width("").width(i.width()),i.append(t)},"bus afterRender:last + model.data.item.did.add":function(e,t){var i=t.element.find(".tau-control-set.tau-active .tau-required-field-editor");this.prepareFields.clear(i),i.filter(".tau-in-text").placeholder("refresh"),window.setTimeout(function(){i.filter(":visible").eq(0).focus()},100)},_openView:function(e,t){e.fire("cardDataToShow.ready",{entityId:t.id,entityType:t.type}),this.fire("close")},"bus beforeInit:last + viewerBus.ready:last + afterRender:last + model.data.item.did.add":function(i,n,a,r,s){var o=s.message.dataItem,l=o.data.cardData||o.data,u={id:l.id,name:l.name,type:o.type.toLowerCase(),nameType:s.nameType.title};if(s.openAfter)a&&this._openView(a,u);else{var c;"time"!=u.type&&(c=n.config.context.configurator.getUrlBuilder().getNewViewUrl(u.id,u.type,!0));var d=n.config.context.configurator.getTemplateFactory().get("board.cell.quick.add.success").bind({},{type:u.nameType,name:u.name,url:c});"x"===s.message.location||"y"===s.message.location||s.openAfter||s.skipNotification||this.fire("notification",{$node:d}),a&&d.on("click",".i-role-card-view",e.bind(function(e){e.preventDefault(),this._openView(a,u)},this))}var p=t('<div class="tau-quick-add-success-message i-role-quick-add-success-message" />');p.data("id",u.id),this.setHtmlForMessage(r.element,p),this.fire("adjustPosition")},"bus afterRender:last+beforeInit:last+model.add.item:last+model.data.item.did.fail.add":function(e,t,i,a,r){var s=this;n.handle(r,a,{setText:function(e){s.setHtmlForMessage(t.element,e),s.fire("adjustPosition")}},i.config.context.configurator)},"bus afterRender:last+view.submit":function(i,n,a){var r=a.type,s=n.element.find(".tau-control-set."+r+" .tau-required-field-editor").filter(":not(.placeholder)").filter(":not(.hide)"),o=s.filter(".cf-input"),l=this.prepareFields;if(l.validate(s)){var u=e.reduce(s,function(e,i){var n=t(i),a=n.data("fieldname"),r=n.data("fieldtype"),s=l.getValue(n);
return n.data("iscf")||e.push({id:a,value:s,type:r}),e},[]);if(o.length){var c=e.reduce(o,function(e,i){var n=t(i),a=n.data(),r={name:a.fieldname,type:a.fieldtype,value:l.getCfValue(i)};return r.value&&e.push(r),e},[]);u.push({id:"CustomFields",value:JSON.stringify(c)})}this.fire("model.add.item",{fields:u,type:r,openAfter:a.openAfter}),s.off(".validator")}else s.off(".validator").on("input.validator change.validator",function(){l.validate(s)})},"bus beforeInit:last + view.editors.ready + culture.ready":function(e,t,i,n){i.filter(".tau-in-text").placeholder(),this.prepareFields=new a({culture:n,self:this,configurator:t.config.context.configurator}),this.prepareFields.setBehavior(i),this.culture=n},"bus childComponentCreated":function(e,t){this.childBus[t.name]=t},childBus:{},"bus view.editors.ready:last+view.indicator.ready:last+before_model.add.item":function(e,t,i){t.filter(":not(.disabled)").prop("disabled",!0),i.tauProgressIndicator("show"),this.fire("adjustPosition")},afterDataItemAdding:function(e,t){e.filter(":not(.disabled)").prop("disabled",!1),t.data("ui-tauProgressIndicator")&&t.tauProgressIndicator("hide"),this.fire("adjustPosition")},"bus view.editors.ready:last+view.indicator.ready:last+model.data.item.did.add":function(e,t,i){this.afterDataItemAdding(t,i)},"bus view.editors.ready:last+view.indicator.ready:last+model.data.item.did.fail.add":function(e,t,i){this.afterDataItemAdding(t,i)},"bus afterRender:last+view.select.entity.editor":function(e,i,n){var a=i.element,r=a.find(".tau-control-set.tau-active .tau-required-field-editor").not(".placeholder");a.find(".tau-active").removeClass("tau-active").prop("disabled",!1),a.find(".tau-message-pool").children().remove(),a.find(".i-role-entity-selector.tau-"+n.type.toLowerCase()).addClass("tau-active").prop("disabled",!0);var s=".tau-entity-controls .tau-control-set."+n.type;a.find(s).addClass("tau-active"),window.setTimeout(function(){a.find(".tau-entity-controls .tau-active :text, .tau-entity-controls .tau-active textarea").eq(0).focus().caretToEnd()
},0),r.each(function(){var e=t(this),i=e.data();if(!i.iscf){var n=".tau-control-set.tau-active .tau-required-field-editor."+t.escapeSelector(i.fieldname),r=a.find(n),s=e.val();switch(i.fieldtype){case"Text":r.filter(":not(.placeholder)").val(s),s&&r.show().filter(".placeholder").remove();break;case"DDL":r.val()!=s&&(e.hasClass("disabled")||r.find('[value="'+s+'"]').prop("selected",!0).length&&r.change());break;default:r.val(s)}}}),this.fire("adjustPosition")},onTypeSelectorClick:function(e){e.preventDefault();var i=t(e.target);if(!i.hasClass("tau-active")){var n=i.data().type;this.fire("view.select.entity.editor",{type:n})}},onSubmit:function(e){return this.fire("view.submit",{type:t(e.target).data().type}),!1},onAddOpen:function(e){return this.fire("view.submit",{type:t(e.target).closest("form").data().type,openAfter:!0}),!1},_processTimeWidget:function(i,n,a){var r=function(e){return Math.round(100*e)/100},s=n.filter("[data-fieldname=Spent]"),o=n.filter("[data-fieldname=Remain]");s.attr("autocomplete","off"),o.attr("autocomplete","off");var l=t(['<div class="tau-field tau-field__time">',"<label><span></span></label>","<label><span></span></label>","</div>"].join(""));l.insertBefore(s.parent()),s.parent().detach(),l.find("label span").eq(0).text(s.attr("placeholder")),s.attr("placeholder",""),s.appendTo(l.find("label").eq(0)),o.parent().detach(),l.find("label span").eq(1).text(o.attr("placeholder")),o.attr("placeholder",""),o.appendTo(l.find("label").eq(1));var u=n.filter("[data-fieldname=Role]"),c=a.types.Time.template,d=e.find(c.items,function(e){return"Remain"==e.id}),p={};e.forEach(d.options.defaultValues,function(e){p[e.key]=e.value}),o.val(p[u.val()]);var f=p[u.val()];u.on("change",e.bind(function(){f=p[u.val()],o.val(e.outFloatLocal(p[u.val()],this.culture)||0),s.trigger("input")},this));var m="oninput"in s[0]?"input":"keyup";s.on(m,e.bind(function(){var t=e.parseFloatLocal(s.val(),this.culture)||0,i=(e.parseFloatLocal(f,this.culture)||0)-t;i=0>i?0:i,o.val(e.outFloatLocal(r(i),this.culture)||0)
},this)),o.on(m,function(){f=o.val()}),this.bus.on("model.data.item.did.add",function(){p[u.val()]=o.val(),f=p[u.val()]},this)},"bus relatedQuickAdd.afterShow":function(){this.$element.addClass("bg-overlay")},"bus relatedQuickAdd.afterHide":function(){this.$element.removeClass("bg-overlay")}})}),define("tau/ui/extensions/finder.entity/ui.extension.finder.entity.embedder",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus popupResize":function(e,t){this.fire("$outerBubbled.ready",t)},"bus $outerBubbled.ready + childrenBuses.ready":function(t,i,n){var a=e.bind(this.fire,this,"adjustPosition");e.forEach(n,function(e){e.fire("$outerBubbled.ready",i),e.on("adjustPosition",a)})},findBusByName:function(t,i){return e.find(t,function(e){return e.name==i})},"bus childrenBuses.ready:last + child.shown":function(e,t,i){this.findBusByName(t,i).fire("$outerBubbled.shown")},"bus childrenBuses.ready:last + child.hidden":function(e,t,i){this.findBusByName(t,i).fire("$outerBubbled.hidden")},showFinder:function(i){var n=20;t.when(i.$selector.finish().slideUp(n),i.$holder.finish().slideDown(n),i.$relatedQuickAdd.finish().addClass("tau-within-entity-lookup",n)).done(e.bind(function(){this.fire("child.shown",i.$holder.data("name")),this.fire("adjustPosition")},this))},hideFinder:function(i,n){var a=100;t.when(i.$holder.finish().slideUp(a),i.$selector.finish().slideDown(a),i.$relatedQuickAdd.finish().removeClass("tau-within-entity-lookup",a)).done(e.bind(function(){this.fire("child.hidden",i.$holder.data("name")),n&&i.$selector.addClass("focus").focus(),this.fire("adjustPosition")},this))},selectEntity:function(e,t,i){var n=i.entity;e.$input.data("value",n).val(n.id).change();var a=e.$field.find(".tau-linkentity__icon");if(a.length&&this.showEntityType(n)){var r=a.attr("class");r=r.replace(/tau-entity-icon--\S+/gi,"tau-entity-icon--"+n.entityType.name.toLowerCase()),a.attr("class",r).text(n.id).show()}e.$field.find(".tau-linkentity__inner").text(this.getEntityRenderInfo(n)).removeClass("tau-linkentity__inner_placeholder"),e.alwaysVisible||this.hideFinder(e,!0)
},getEntityRenderInfo:function(e){return"user"===e.entityType.name?e.fullName:e.name},showEntityType:function(e){return"user"!==e.entityType.name&&e.entityType},getFinderControls:function(e){var t=e.closest(".tau-field"),i=t.find(".tau-userStorySelector"),n=t.find(".i-role-related-quick-add");return{$input:e,$field:t,$selector:i,$holder:t.find(".tau-userStorySelector__control"),$relatedQuickAdd:n,alwaysVisible:i.hasClass("hidden")}},"bus applyFinder":function(i,n){var a=this.getFinderControls(n),r=null,s=e.bind(this.hideFinder,this,a),o=e.bind(this.showFinder,this,a),l=e.bind(this.selectEntity,this,a),u=e.bind(this._selectEntityFromItem,this,a),c=n.data("entityuniquename");this.on(c+".entitySelected",l),this.on(c+".add.entity.request",function(){s(),a.$relatedQuickAdd.click()}.bind(this)),this.on("relatedQuickAdd."+c+".added",u),a.alwaysVisible?o():(a.$selector.on({click:function(){o()},keydown:function(e){var i=t.ui.keyCode;(e.keyCode==i.DOWN||e.keyCode==i.UP)&&o()},focus:function(){a.$selector.hasClass("focus")||o()},focusout:function(){a.$selector.removeClass("focus")}}),a.$holder.on({keydown:function(e){e.keyCode==t.ui.keyCode.ESCAPE&&(s(!0),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())},focusin:function(){clearTimeout(r)},focusout:function(e){t(e.relatedTarget).is("select.tau-select")&&a.$holder.closest(".i-role-bubble").is(".i-orientation_bottom")||t(e.target).is(".tau-lookup-block .i-role-bubble input.tau-in-text")||(clearTimeout(r),r=setTimeout(s,300))}}),a.$holder.on({mousedown:function(){a.$holder.focus(10)}},".i-role-bubble"))},_selectEntityFromItem:function(e,t,i){var n=this._getEntityFromItem(i);return this.selectEntity(e,t,{entity:n})},_getEntityFromItem:function(e){var t={entityType:{name:e.type},id:e.id,name:e.name};return t}})}),define("tau/ui/extensions/container/ui.extension.container.childrenEvents",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus childComponentCreated":function(t){var i=t.data,n=this.bus,a=i.fire,r=i.name;
i.fire=function(t,s){var o=e.toArray(arguments);a.apply(i,o),n.fire(r+"."+t,s)}}})}),define("tau/views/view.compositeControl",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher","tau/models/dataprocessor/model.processor.context"],function(e,t,i,n,a){var r=function(t){var i={};return e.each(t,function(e,t){for(var n=t.split(":"),a=n.pop(),r=i,s=0,o=n.length;o>s;s++){var l=n[s];r.hasOwnProperty(l)||(r[l]={}),r=r[l]}r[a]=e}),i};return i.extend({name:"view.compositeControl",init:function(e){this._loaded=!1,this._super(e),this.timeoutDescriptor=null},initialize:function(){this._super.apply(this,arguments);var t=this.config.dependencies,i=this.config.visible&&e.isArray(t)&&e.size(t)>0;if(i){var n=this.getComponentPaths(t);require(n,this.createComponentTypesCallback(t))}else this.fireDependenciesAreReady({})},getComponentPaths:function(t){return e.map(t,function(e){return"tau/components/component."+e})},createComponentTypesCallback:function(t){var i=this;return i.dependenciesHash={},function(){var n=arguments;e(t).each(function(e,t){i.dependenciesHash[e]=n[t]}),i.fireDependenciesAreReady(i.dependenciesHash)}},fireDependenciesAreReady:function(e){this.fire("dependenciesAreReady",{controlTypes:e})},"bus afterInit+dataBind":function(){},"bus afterInit+dataBind+dependenciesAreReady":function(e){var t=this,i=e.afterInit.data,n=e.dataBind.data,a=e.dependenciesAreReady.data;t.config.visible&&(t._loaded=!0),t.fireBeforeRender({data:n}),t.doRender(n,i.refreshSelector);var r=t.instantiateChildrenComponents(t.element.find("[runas]"),a.controlTypes);t.initializeChildrenComponents(r,n)},createOnAfterRenderCallback:function(e){return function(t){t.removeListener(),e.replaceWith(t.data.element)}},onDestroyCallback:function(e){var t=e.sender;delete this.children[t.uniqueId]},instantiateChildrenComponents:function(i,n){var a=this,s=[];a.children={};var o=e.bind(a.onDestroyCallback,a);return i.each(function(){var i=t(this),l=i.attr("runas"),u=n.hasOwnProperty(l);if(!u)throw"The component type ["+l+"] not found";
var c=n[l],d=r(i.data()),p=c.create({disabledExtensionCategories:a.config.disabledExtensionCategories,context:a.config.context,allData:d});p.uniqueId=p.uniqueId||e.uniqueId(),p.on("afterRender",a.createOnAfterRenderCallback(i)),p.on("destroy",o);var f={instance:p,config:d};a.children[p.uniqueId]=p,s.push(f)}),s},initializeChildrenComponents:function(t,i){var n=this,a=[];e.forEach(t,function(t,i){var n=t.config,r=t.instance;e.has(n,"label")?a[n.label]=r:a[i]=r}),this.fire("childrenBuses.ready",a);var r=50,s=10,o=function(){if(t.length){for(var e=+new Date,i=t.splice(0,s),a=0,l=i.length;l>a;a++)n.fire("createComponentContext",i[a]);var u=+new Date,c=u-e,d=c/r;if(Math.abs(1-d)>.3){var p=Math.floor((s+s/d)/2);s=p||1}n.timeoutDescriptor=setTimeout(o,1)}else n.fire("component.ready")};o(),n.fireAfterRender({data:i})},"bus createComponentContext":function(e){var t=e.data,i=t.config;i.context.entity=i.context.general,i.context.applicationContext=this.config.context.applicationContext,i.context.configurator=this.config.context.configurator,a(i.context),this.fire("componentContextCreated",t)},"bus componentContextCreated":function(e){var t=e.data;this.fire("childComponentCreated",t.instance),t.instance.fire("initialize",t.config)},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},destroyChildren:function(){var t=this;clearTimeout(t.timeoutDescriptor),t.dispatcher=null,e(t.children||{}).chain().keys().each(function(e){t.children[e].destroy()}),t.children={}},lifeCycleCleanUp:function(){this.destroyChildren(),this._super()},destroy:function(){this.destroyChildren(),this._super()}})}),define("tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add",[],function(){var e=["project","team"],t=function(e){var t="";return e.length&&(t='"'+e.join('","')+'"'),"["+t+"]"},i={"default":{getRules:function(e,i,n){return i=i||[],e.required!==!1&&i.push(n||"required"),t(i)}},DDL:{getRules:function(i,n){return n=n||[],_.contains(e,i.id)?n.push("required-team-project"):i.required&&n.push("required-ddl"),t(n)
}}},n=function(e,t,n){var a=e.type,r=i[a],s=r||i["default"],o=s.getRules(e,t,n);return o};return{getValidationRules:n}}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.textField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.Text",engine:"jqote2",customFunctions:e.defaults(i,{getFieldByType:function(t,i){return e.find(t,function(e){return e.type.toLowerCase()===i})},getColorField:function(e){return this.getFieldByType(e,"color")},getIconField:function(e){return this.getFieldByType(e,"icon")}}),markup:['<div class="tau-field">',"<% var name = this.name, field = this.field; %>","<% if (field.options && field.options.multiline) { %>",'   <textarea name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":["required","<%= field.id.toLowerCase() == "email"?"email":"text"%>"]}\' ','       placeholder="<%= field.caption%>" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>" />','<% } else if (name.toLowerCase() == "project" && field.id.toLowerCase() == "name") { %>',"   <% var projectColors = this.constants.projectColors; %>","   <% var colorField = fn.getColorField(this.items); %>",'   <div name="<%= colorField.id%>" class="tau-required-field-editor <%= colorField.id%>" ','       data-validate=\'{"caption":"<%= colorField.caption%>","rules":<%=fn.getValidationRules(colorField, ["color"])%>}\' ','       data-fieldname="<%=colorField.id%>" data-fieldtype="<%=colorField.type%>">','       <div class="tau-new-entity-info">','           <span data-title="Select a project color" class="tau-select-team-icon tau-extension-board-tooltip">','               <i data-value="default" class="tau-icon tau-icon_type_color tau-icon_name_default i-role-currenticon"></i>',"           </span>",'           <input tabindex="0" autocomplete="off" type="text" name="<%= field.id%>"                data-validate=\'{"caption":"<%= field.caption%>","rules":["required","text"]}\' ','               class="tau-in-text tau-required-field-editor tau-new-entity-name <%= field.id%>" ','               placeholder="Enter project name here" name="name" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">','           <select name="color" style="display:none;">','               <option value=""></option>',"                   <% _.each(projectColors, function(color){ %>",'                       <option value="<%= color %>"><%= color %></option>',"                   <% }); %>","           </select>","       </div>",'       <ul class="tau-teams-icon-list i-role-richselect">','           <li><i class="tau-icon tau-i-close i-role-option" data-value=""></i></li>',"           <% _.each(projectColors, function(color){ %>",'               <li><i class="tau-icon tau-icon_type_color i-role-option" style="background-color:<%= color %>;" data-value="<%= color %>"></i></li>',"           <% }); %>","       </ul>","   </div>",'<% } else if (name.toLowerCase() == "team" && field.id.toLowerCase() == "name") { %>',"   <% var teamIcons = this.constants.teamIcons; %>","   <% var iconField = fn.getIconField(this.items); %>",'   <div name="<%= iconField.id%>" class="tau-required-field-editor <%= iconField.id%>" ','       data-validate=\'{"caption":"<%= iconField.caption%>","rules":<%=fn.getValidationRules(iconField, ["icon"])%>}\' ','       data-fieldname="<%=iconField.id%>" data-fieldtype="<%=iconField.type%>">','       <div class="tau-new-entity-info">','           <span data-title="Select a team icon" class="tau-select-team-icon tau-extension-board-tooltip">','               <i class="tau-icon tau-icon_type_svg tau-icon_name_default i-role-currenticon" data-value="default"></i>',"           </span>",'           <input tabindex="0" autocomplete="off" type="text" name="<%= field.id%>"                data-validate=\'{"caption":"<%= field.caption%>","rules":["required","text"]}\' ','               class="tau-in-text tau-required-field-editor tau-new-entity-name <%= field.id%>" ','               placeholder="Enter team name here" name="name" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">','           <select name="icon" style="display:none;">','               <option value=""></option>',"                   <% _.each(teamIcons, function(icon){ %>",'                       <option value="<%= icon %>"><%= icon %></option>',"                   <% }); %>","           </select>","       </div>",'       <ul class="tau-teams-icon-list i-role-richselect">','           <li><i class="tau-icon tau-i-close i-role-option" data-value=""></i></li>',"           <% _.each(teamIcons, function(icon){ %>",'               <li><i class="tau-icon tau-icon_type_svg tau-icon_name_<%= icon %> i-role-option" data-value="<%= icon %>"></i></li>',"           <% }); %>","       </ul>","   </div>","<% } else { %>",'   <input tabindex="0" autocomplete="off" type="text" name="<%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":["required","<%= field.id.toLowerCase() == "email"?"email":"text"%>"]}\' ','       class="tau-in-text tau-required-field-editor <%= field.id%>" placeholder="<%= field.caption%>" ','       data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">',"<% } %>","</div>"]};
return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.passwordField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.Password",engine:"jqote2",customFunctions:e.defaults(i),markup:['<div class="tau-field">',"   <% field = this.field; %>",'   <input type="password" tabindex="0" name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":["text"]}\' ','       placeholder="<%= field.caption%>" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">',"</div>"]};return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.numberField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.Number",engine:"jqote2",customFunctions:e.defaults(i),markup:['<div class="tau-field">',"   <% field = this.field; %>",'   <input type="text" tabindex="0" name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-fieldtype="number" data-fieldname="<%=field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["number"])%>}\' ','       placeholder="<%= field.caption%>" ',"       value=\"<%= _.has(field.options, 'defaultValue') ? field.options.defaultValue : '' %>\">","</div>"]};return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.integerField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.Integer",engine:"jqote2",customFunctions:e.defaults(i),markup:['<div class="tau-field">',"   <% field = this.field; %>",'   <input type="text" tabindex="0" name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["integer"])%>}\' ','       placeholder="<%= field.caption%>" data-fieldname="<%=field.id%>" data-fieldtype="integer">',"</div>"]};
return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.dateField",["Underscore","tau/core/templates-factory","tau/utils/utils.date","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i,n){var a={name:"board.cell.item.quick.add.field.Date",engine:"jqote2",customFunctions:e.defaults(n,{convertToDateString:function(e){var t=i.convertToTimezone(e);return i.format.date.short(t)}}),markup:['<div class="tau-field">',"   <% field = this.field; %>",'   <input type="text" tabindex="0" name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["date"])%>}\' ','       placeholder="<%= field.caption%>" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>" ',"       value=\"<%= _.has(field.options, 'defaultValue') ? fn.convertToDateString(field.options.defaultValue) : ''  %>\">","</div>"]};return t.register(a)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.dateTimeField",["Underscore","tau/core/templates-factory","tau/utils/utils.date","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i,n){var a={name:"board.cell.item.quick.add.field.DateTime",engine:"jqote2",customFunctions:e.defaults(n,{convertToDateTimeString:function(e){var t=i.convertToTimezone(e);return i.format.datetime.short(t)}}),markup:['<div class="tau-field">',"   <% field = this.field; %>",'   <input type="text" tabindex="0" name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["date"])%>}\' ','       placeholder="<%= field.caption%>" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>" ',"       value=\"<%= _.has(field.options, 'defaultValue') ? fn.convertToDateTimeString(field.options.defaultValue) : ''  %>\">","</div>"]};
return t.register(a)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.usersInviteField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.UsersInvite",engine:"jqote2",customFunctions:e.defaults(i),markup:['<div class="tau-field tau-invite-widget">',"   <% field = this.field; %>",'   <textarea type="text" tabindex="0" name="<%= field.id%>" class="tau-in-text tau-required-field-editor <%= field.id%>" ','       data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["usersinvite"])%>}\' ','       placeholder="Start typing name(s) or email(s) to assign people" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>" data-selected="<%! JSON.stringify(field.options.selectedUser) %>" />',"</div>"]};return t.register(n)}),define("tau/ui/templates/board.context.selector/ui.template.board.context.selector.teams.list",["tau/core/templates-factory"],function(e){return e.register({name:"board.context.selector.teams.list",engine:"jqote2",customFunctions:{getTooltip:function(e){var t=-1==e.id?"Select to see work not assigned to a team":"Select to see work assigned to this team";return void 0!==e.tooltip&&(t=e.tooltip),t}},markup:['<li class="i-role-item">','<label class="tau-checkbox tau-extension-board-tooltip <% if (this.id == -1) { %> tau-null-selector <% } %>" data-title="<%=fn.getTooltip(this)%>">',"<input type=\"checkbox\" name=\"team\" id=\"content_filter_team_<%= this.id %>\" value=\"<%= this.id %>\" <%= this.selected ? 'checked' : '' %> <%= (this.disabled ? 'disabled':'')%> />",'<i class="tau-checkbox__icon"></i>','<span class="tau-checkbox-label">','<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= this.icon || ""  %>"></i>',"<%! this.name %>","</span>","</label>","<% if (this.isSupportView) { %>",'<i data-title="Focus on this team" class="tau-extension-board-tooltip tau-category-items-selector__selecttrigger tau-icon tau-icon_type_svg tau-icon_name_aim i-role-selecttrigger" data-entity-id="<%! this.id %>" data-entity-type="team"></i>','<i data-title="View info about this team" class="tau-extension-board-tooltip tau-category-items-selector__viewtrigger tau-icon tau-icon_type_svg tau-icon_name_newwindow i-role-viewtrigger" data-entity-id="<%! this.id %>" data-entity-type="team"></i>',"<% } %>","</li>"]})
}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.teamMultiSelectField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add","tau/ui/templates/board.context.selector/ui.template.board.context.selector.teams.list"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.TeamMultiSelect",engine:"jqote2",customFunctions:e.defaults(i,{markTeamSelected:function(t,i){var n=e.find(t,function(e){return e.id===i.id});n&&(n.selected=!0,n.disabled=!0)}}),markup:["<% if (this.field.options.teams.length > 0) { %>",'<div class="tau-field">',"   <% field = this.field; %>",'   <% if (this.name == "User") { %><div class="tau-note">Assign to Teams</div><% } %>',"   <% if (field.options.selectedTeam && field.options.selectedTeam.id) { ","       fn.markTeamSelected(field.options.teams, field.options.selectedTeam);","   }%>",'   <div class="tau-teams">','       <ul name="<%= field.id%>" class="tau-category-items-selector i-role-list tau-required-field-editor <%= field.id%>" ','               data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["teammultiselect"])%>}\' ','               data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">','           <%= fn.sub("board.context.selector.teams.list", field.options.teams) %>',"       </ul>","   </div>","</div>","<% } %>"]};return t.register(n)}),define("tau/ui/templates/board.context.selector/ui.template.board.context.selector.projects.list",["tau/core/templates-factory"],function(e){return e.register({name:"board.context.selector.projects.list",engine:"jqote2",customFunctions:{getTooltip:function(e){var t=-1==e.id?"Select to see work not assigned to a project":"Select to see work assigned to this project";return void 0!==e.tooltip&&(t=e.tooltip),t}},markup:['<li class="i-role-item i-role-project">','<label class="tau-checkbox tau-extension-board-tooltip <% if (this.id == -1) { %> tau-null-selector <% } %>" data-title="<%=fn.getTooltip(this)%>">',"<input type=\"checkbox\" id=\"content_filter_project_<%= this.id %>\" value=\"<%= this.id %>\" <%= this.selected ? 'checked' : '' %> <%= (this.disabled ? 'disabled':'')%> <%= (this.process ? 'data-process-id=\"' + this.process.id + '\"' : '') %> />",'<i class="tau-checkbox__icon"></i>','<span class="tau-checkbox-label">',"<% if (this.color) { %>",'<i class="tau-icon tau-icon_type_color" style="background-color: <%= this.color %>"></i>',"<%} else { %>",'<i class="tau-icon"></i>',"<% } %>","<span><%! this.name %></span>","</span>","</label>","<% if (this.isWarningVisible) { %>",'<span class="tau-icon-general tau-icon-warning i-role-tooltipArticle" data-article-id="board.context.noProject.warning"></span>',"<% } %>","<% if (this.isSupportView) { %>",'<i data-title="Focus on this project" class="tau-extension-board-tooltip tau-category-items-selector__selecttrigger tau-icon tau-icon_type_svg tau-icon_name_aim i-role-selecttrigger" data-entity-id="<%! this.id %>" data-entity-type="project"></i>','<i data-title="View info about this project" class="tau-extension-board-tooltip tau-category-items-selector__viewtrigger tau-icon tau-icon_type_svg tau-icon_name_newwindow i-role-viewtrigger" data-entity-id="<%! this.id %>" data-entity-type="project"></i>',"<% } %>","</li>"]})
}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.projectMultiSelectField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add","tau/ui/templates/board.context.selector/ui.template.board.context.selector.projects.list"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.ProjectMultiSelect",engine:"jqote2",customFunctions:e.defaults(i,{markProjectSelected:function(t,i){var n=e.find(t,function(e){return e.id===i.id});n&&(n.selected=!0,n.disabled=!0)}}),markup:["<% if (this.field.options.projects.length > 0) { %>",'<div class="tau-field">',"   <% field = this.field; %>",'   <% if (this.name == "User") { %><div class="tau-note">Assign to Projects</div><% } %>',"   <% if (field.options.selectedProject && field.options.selectedProject.id) { ","       fn.markProjectSelected(field.options.projects, field.options.selectedProject);","   }%>",'   <div class="tau-projects">','       <ul name="<%= field.id%>" class="tau-category-items-selector i-role-list tau-required-field-editor <%= field.id%>" ','               data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["projectmultiselect"])%>}\' ','               data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">','           <%= fn.sub("board.context.selector.projects.list", field.options.projects, field.options.selectedProject) %>',"       </ul>","   </div>","</div>","<% } %>"]};return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.ddlField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.DDL",engine:"jqote2",customFunctions:e.defaults(i),markup:['<div class="tau-field">',"   <% field = this.field; %>","   <% var options = field.options.values, lengthOptions = options.length; %>",'   <select data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field)%>}\' tabindex="0" <%if(lengthOptions == 1){%>disabled="disabled"<%}%> ','           class="tau-select <%if(lengthOptions == 1){%>disabled<%}%> tau-required-field-editor <%= field.id.toLowerCase()%> chzn-select" ','           name="<%=field.id%>" data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">',"       <% for (var k = 0; k < lengthOptions; k++) { %>",'           <option data-option="<%! JSON.stringify(options[k]) %>"','               <% if (field.options.selectedValue == options[k].id) { %> selected="selected" <% } %> ','                   value="<%= options[k].id %>">',"               <%! options[k].title %>","           </option>","       <% } %>","   </select>","</div>"]};
return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.entitySelectorField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.EntitySelector",engine:"jqote2",customFunctions:e.defaults(i,{entity:{TestPlanSelector:{uniqueName:"testplanselector",type:"testplan",placeholder:"Test Plan"},UserStorySelector:{uniqueName:"userstories",type:"userstory",placeholder:"User Story"},ReleaseSelector:{uniqueName:"releaseselector",type:"release",placeholder:"Release"},UserSelector:{uniqueName:"usersselector",type:"user",placeholder:"User",model:"user"}}}),markup:['<div class="tau-field tau-field_entity tau-related-add-present">',"   <% var field = this.field; %>","   <% var entity = fn.entity[field.type]; %>",'   <div tabindex="0" class="tau-userStorySelector releaseSelector">',"       <input type=\"hidden\" data-entityuniquename='<%=entity.uniqueName%>' ",'               data-validate=\'{"caption":"<%=field.caption%>","rules":<%=fn.getValidationRules(field, [], \'entityRequired\')%>}\' ','               name="<%=field.id%>" class="tau-required-field-editor <%=field.id%>" placeholder="<%=field.caption%>" data-fieldname="<%=field.id%>" ',"               data-filter='<%=JSON.stringify(field.options.filter)%>' data-fieldtype=\"<%=field.type%>\">",'           <span class="userStorySelector ui-link">','               <em class="tau-entity-icon tau-entity-icon--userstory tau-linkentity__icon" style="display: none;"></em>','               <span class="tau-linkentity__inner tau-linkentity__inner_placeholder"><%=this.caption || entity.placeholder%></span>',"           </span>","   </div>","   <div class=\"tau-userStorySelector__control\" data-name='<%=entity.uniqueName%>'>","       <span runas=\"finder.entity\" data-context:general='' data-name='<%=entity.uniqueName%>' ","               data-entity-type='<%=entity.type%>' data-filterenabled='true'","               data-is-add-possible='true' data-field-caption='<%=field.caption%>'","               data-filter='<%=JSON.stringify(field.options.filter)%>' data-model='<%=entity.model%>'></span>","   </div>",'   <button type="button" class="tau-btn tau-success btn-plus tau-related-quick-add i-role-related-quick-add"></button>',"</div>"]};
return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.customField",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add"],function(e,t,i){var n={name:"board.cell.item.quick.add.field.CustomField",engine:"jqote2",customFunctions:e.defaults(i,{selected:function(e){return e?'selected="selected"':""}}),markup:['<% var field = this.field, className = "cf-wrap tau-field tau-custom cf-process_" + field.processId;','var defaultValue = field.config && field.config.defaultValue ? field.config.defaultValue : "";','if (field.fieldType == "Text" || field.fieldType == "Number" || field.fieldType == "Date" || field.fieldType == "TemplatedURL") {','    var rules = [], additionalClass = "";','    if (field.fieldType == "Number") {','        rules.push("number");','        additionalClass = "cf-input_number";','    } else if (field.fieldType == "Text") {','        rules.push("text");','    } else if (field.fieldType == "Date") {','        rules.push("date");','        additionalClass = "cf-input_date";',"    }","%>",'    <div class="<%=className%>">','        <input tabindex="0" autocomplete="off" type="text" data-validate=\'{"caption":"<%=field.caption%>","rules":<%=fn.getValidationRules(this.field, rules)%>}\' class="tau-in-text <%=additionalClass%> cf-input tau-required-field-editor" placeholder="<%=field.caption%>" data-iscf="true" data-fieldname="<%=field.caption%>" data-fieldtype="<%=field.fieldType%>" value="<%=defaultValue%>">',"    </div>",'<% } else if (field.fieldType == "CheckBox") { %>','    <div class="<%=className%>">','        <label class="tau-checkbox "><input tabindex="0" autocomplete="off" type="checkbox" data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(this.field, ["checkbox"])%>}\' class="tau-is-active cf-input tau-required-field-editor" data-iscf="true" data-fieldname="<%=field.caption%>" data-fieldtype="<%=field.fieldType%>"><i class="tau-checkbox__icon"></i><span><%=field.caption%></span></label>',"    </div>",'<% } else if (field.fieldType == "URL") { %>','    <div class="<%=className%>">','        <input tabindex="0" autocomplete="off" type="hidden" value=\'fake\' data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(this.field)%>}\' class="tau-is-active cf-input tau-required-field-editor" data-iscf="true" data-fieldname="<%=field.caption%>" data-fieldtype="<%=field.fieldType%>">',"        <h4><%= field.caption %></h4>",'        <p class="cf-wrap-url_value">','            <input class="tau-in-text tau-is-active cf-input cf-input-url_value tau-required-field-editor" data-iscf=\'true\' data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(this.field, ["url"])%>}\' data-fieldname="<%=field.caption%>-value" type="" placeholder="URL">',"        </p>",'        <p class="cf-wrap-url_description">','            <input class="tau-in-text tau-is-active cf-input cf-input-url_description tau-required-field-editor" data-iscf=\'true\' data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(this.field)%>}\' data-fieldname="<%=field.caption%>-description" type="" placeholder="URL description">',"        </p>","    </div>",'<% } else if (field.fieldType == "DropDown") {','    var options = field.options.value && field.options.value.split("\\r\\n") || [];',"%>",'    <div class="<%=className%>">','        <select data-validate=\'{"caption":"<%=field.caption%>","rules":<%=fn.getValidationRules(this.field)%>}\' tabindex="0" data-iscf=\'true\' class="tau-select cf-input tau-required-field-editor" name="<%=field.caption%>" data-fieldname="<%=field.caption%>" data-fieldtype="<%=field.fieldType%>">','            <option value=""><%=field.caption%></option>',"            <% for (var k = 0; k < options.length; k++) { %>",'                <option value="<%!options[k]%>" <%= fn.selected(defaultValue == options[k]) %>><%!options[k]%></option>',"            <% } %>","        </select>","    </div>",'<% } else if (field.fieldType == "MultipleSelectionList") {','    var options = field.options.value && field.options.value.split("\\r\\n") || [];','    var defaultValues = defaultValue.split(",");',"%>",'    <div class="<%=className%>">',"        <h4><%= field.caption %></h4>",'        <select data-validate=\'{"caption":"<%=field.caption%>","rules":<%=fn.getValidationRules(this.field)%>}\' multiple="multiple" tabindex="0" data-iscf=\'true\' class="tau-select cf-input tau-required-field-editor" name="<%=field.caption%>" data-fieldname="<%=field.caption%>" data-fieldtype="<%=field.fieldType%>">',"            <% for (var k = 0; k < options.length; k++) { %>",'                <option value="<%!options[k]%>" <%= fn.selected(defaultValues.indexOf(options[k]) >= 0) %>><%!options[k]%></option>',"            <% } %>","        </select>","    </div>",'<% } else if (field.fieldType == "Entity") { %>','    <div class="<%=className%> tau-field_entity">','        <div tabindex="0" class="tau-userStorySelector">','            <input type="hidden" data-iscf="true" data-entityuniquename=\'entity_<%=this.type.entityType.name%>_<%=this.entityNumber%>\' data-validate=\'{"caption":"<%=field.caption%>","rules":<%=fn.getValidationRules(this.field, [], \'entityRequired\')%>}\' name="<%=field.id%>" class="cf-input tau-required-field-editor <%= field.id%>" placeholder="<%=field.caption%>" data-fieldname="<%=field.caption%>" data-filter=\'<%= JSON.stringify(field.options.filter)%>\' data-fieldtype="<%=field.fieldType%>">','            <span class="userStorySelector ui-link"><em class="tau-entity-icon tau-entity-icon--userstory tau-linkentity__icon" style="display: none;"></em><span class="tau-linkentity__inner tau-linkentity__inner_placeholder"><%=field.caption%></span></span>',"        </div>",'        <div class="tau-userStorySelector__control" data-name=\'entity_<%=this.type.entityType.name%>_<%=this.entityNumber%>\'><span runas="finder.entity" ',"            <% if (this.mainEntity) { %>",'            data-context:general:id="<%= this.mainEntity.id %>" ','            data-context:general:entity-type:name="<%= this.mainEntity.entityType.name %>" ',"            <% } else { %>","            data-context:general='' ","            <% } %>","            data-name='entity_<%=this.type.entityType.name%>_<%=this.entityNumber%>' ","            data-filterenabled='true' ","            data-filter='<%= JSON.stringify(field.options.filter || null) %>'></span>","        </div>","    </div>","<% } %>"]};
return t.register(n)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.colorField",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"board.cell.item.quick.add.field.Color",engine:"jqote2",markup:['<div class="tau-field"/>']};return t.register(i)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.iconField",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"board.cell.item.quick.add.field.Icon",engine:"jqote2",markup:['<div class="tau-field"/>']};return t.register(i)}),define("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add",["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.textField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.passwordField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.numberField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.integerField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.dateField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.dateTimeField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.usersInviteField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.teamMultiSelectField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.projectMultiSelectField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.ddlField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.entitySelectorField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.customField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.colorField","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add.iconField"],function(e,t,i){var n={name:"board.cell.item.quick.add",engine:"jqote2",customFunctions:e.defaults(i,{entitySelectorTypes:["TestPlanSelector","UserStorySelector","ReleaseSelector","UserSelector"],entityTypesGroup:["program","project","team","user"],findAnyFromGroup:function(t){var i=e.find(t,function(t){return e.include(this.entityTypesGroup,t.name.toLowerCase())
}.bind(this));return i?i.name:null},canDrawGroup:function(e){return e.length>1&&this.findAnyFromGroup(e)},fieldTemplate:function(t){return e.include(this.entitySelectorTypes,t)?"EntitySelector":t}}),markup:["<% var isRelatedAdd = this.data && this.data.isRelatedAdd; %>",'<div class="tau-quick-add-dialog">',"    <% if (this.isEmpty) { %>",'        <div class="tau-quick-add_empty">',"        <% if (this.emptyContext) { %>",'           You need to <span class="i-role-select-context-link">select a project or a team</span> to add something.',"        <% } else { %>",'           You have no rights to add new items in the current Project/Team context.<br/>You can change the context in <span class="i-role-select-context-link">the settings</span>.',"        <% } %>","        </div>","    <% } else { %>","    <div class=\"tau-entity-selector <%= (isRelatedAdd ? 'hidden' : '') %>\">",'        <div class="quick-add__entity-items">',"            <% for (var i = 0, length = this.entityTypes.length; i < length; i++) { %>","                <% if (fn.canDrawGroup(this.entityTypes) && this.entityTypes[i].name === fn.findAnyFromGroup(this.entityTypes)) {%>",'                    <div class="tau-entity-group">',"                <%}%>","                <button data-index=\"<%=i%>\" data-type=\"<%= this.entityTypes[i].name%>\" class=\"i-role-entity-selector tau-btn tau-entity-type-btn tau-<%=this.entityTypes[i].name.toLowerCase()%> <%= ((this.entityTypes[i].active ? 'tau-active':'') + ' ' + this.entityTypes[i].name)%>\"  <%= (this.entityTypes[i].active ? 'disabled':'')%>>","                   <%= this.entityTypes[i].title %>","                </button>","            <% } %>","           <% if (fn.canDrawGroup(this.entityTypes)) { %>","                   </div>","           <% } %>","        </div>","    </div>",'    <div class="tau-entity-controls">',"    <% for (var i = 0, length = this.entityTypes.length; i < length; i++) { %>","       <% var name = this.entityTypes[i].name; %>","       <% var type = this.types[name]; %>","       <% var items = type.template.items; %>",'       <div class="tau-entity-fields">',"       <form class=\"tau-control-set tau-fieldset <%= ((this.entityTypes[i].active? 'tau-active':'') + ' ' + type.entityType.name )%>\" data-type=\"<%=type.entityType.name%>\">","           <% for (var j = 0; j < items.length; j++) { %>","               <% var field = items[j]; %>","               <% var fieldTemplate = fn.fieldTemplate(field.type); %>","               <% var fieldModel = {name: name, type: type, field: field, mainEntity: this.mainEntity, entityNumber: j, ","                   items: items, constants: this.constants, caption: field.caption}; %>",'               <%= fn.sub("board.cell.item.quick.add.field." + fieldTemplate, fieldModel) %>',"            <% } %>",'            <div class="tau-field">','                <button tabindex="0" type="submit" class="tau-btn tau-add-item tau-success i-role-add">Add</button>','                <% if (name != "Time" && !isRelatedAdd) { %>','                <button tabindex="0" type="button" class="tau-btn tau-add-item tau-success i-role-add-open">Add &amp; Open</button>',"                <% } %>","                <% if (isRelatedAdd) { %>",'                <button tabindex="0" type="button" class="tau-btn i-role-cancel">Cancel</button>',"                <% } %>","            </div>","        </form>","        </div>","        <%}%>",'       <div class="tau-message-pool"></div>',"    </div>","    <%}%>","</div>"]};
return t.register(n)}),define("tau/components/component.board.cell.quick.add",["tau/components/component.creator","tau/models/quick.add/model.board.cell.quick.add","tau/ui/extensions/board.cell.quick.add/ui.extension.board.cell.quick.add","tau/ui/extensions/finder.entity/ui.extension.finder.entity.embedder","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/container/ui.extension.container.childrenEvents","tau/components/extensions/error/extension.errorBar","tau/views/view.compositeControl","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){var d=[c.QuickAddModel||t,i,n,a,r,s,o];c.extensions&&(d=_.union(d,c.extensions));var p={ViewType:l,name:"board cell quick add",extensions:d,template:u};return c["queue.bus"]=!0,c.dependencies=["finder.entity"],e.create(p,c)}}}),define("tau/utils/utils.sampleData",[],function(){return{buildConfirmationString:function(e){for(var t=e.ProjectNames||e.projectNames,i=e.UserNames||e.userNames,n="Sample Projects and Users will be deleted.\n\nProjects: ",a=0;a<t.length;a++)n+=t[a],a<t.length-1&&(n+=", ");n+=".\nUsers: ";for(var a=0;a<i.length;a++)n+=i[a],a<i.length-1&&(n+=", ");return n+=".\n\nDelete this data?"}}}),define("tau/components/clear.sample.data/model.clean.sample.data",["Underscore","jQuery","tau/core/extension.base","tau/utils/utils.sampleData"],function(e,t,i,n){return i.extend({"bus beforeInit":function(e,t){this._getConfigurator(t).getSampleDataService().sampleData().done(function(e){e.isVisible=!e.isEmpty&&this._getConfigurator(t).getLoggedUser().isAdministrator,this.fire("dataBind",e)}.bind(this))},"bus beforeInit + afterRender":function(e,i,a){var r=t(a.element),s=r.find(".i-role-clear_sample_data");s.length>0&&s.click(function(){var e=a.data;if(confirm(n.buildConfirmationString(e))){r.addClass("active");var t=i.config.context.configurator.service("errorBar");this._getConfigurator(i).getSampleDataService().clearSampleData(e).done(function(){t.fire("notification",{message:"Sample data was cleared successfully"}),s.hide()
}).fail(function(e){t.fire("error",{message:e.statusText})}).always(function(){r.removeClass("active")})}}.bind(this))},_getConfigurator:function(e){return e.config.context.configurator}})}),define("tau/components/clear.sample.data/template.clear.sample.data",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"clear.sample.data",engine:"jqote2",markup:['<div class="link-clear-simple-date">',"<% if (this.isVisible) {%>",'<a class="i-role-clear_sample_data">Clear sample data</a><span class="tau-icon-general tau-icon-loading-white i-role-loader"></span>',"<% }%>","</div>"]};return t.register(i)}),define("tau/components/component.board.clear.sample.data",["tau/components/component.creator","tau/components/clear.sample.data/model.clean.sample.data","tau/components/clear.sample.data/template.clear.sample.data"],function(e,t,i){return{create:function(n){var a={queuedBus:!0,extensions:[t],template:i};return e.create(a,n)}}}),define("tau/models/board.clipboard/model.board.clipboard.main",["Underscore","tau/core/extension.base"],function(e,t){var i=t.extend({"bus initialize":function(e,t){var i=this,n=t,a=this._extractOptions(n,{refreshTimeout:null,settingsFieldName:"board_clipboard_collapse_state"}),r=n.context.configurator;i.fire("options.ready",a),i.fire("configurator.ready",r)},"bus boardSettings.ready":function(e,t){var i=t.boardSettings,n=this;i.get({fields:["viewMode"],callback:function(e){n.fire("viewMode.ready",e.viewMode),n.fire("viewMode.ready.fromInit",e.viewMode)}}),i.unbind({listener:this}),i.bind({listener:this,fields:["viewMode"],callback:function(e){n.fire("viewMode.ready",e.viewMode),n.fire("viewMode.ready.fromBind",e.viewMode)}})},"bus afterRender":function(e,t){this.fire("$el.ready",t.element)},"bus options.ready + configurator.ready":function(t,i,n){var a=n.getSettingsManager(),r=i.settingsFieldName;a.get({fields:[r],callback:e.bind(function(e){this.fire("collapseState.updated",e[r])},this)}),a.unbind({listener:this}),a.bind({fields:[r],listener:this,callback:e.bind(function(e){this.fire("collapseState.updated",e[r])
},this)})},"bus options.ready:last + configurator.ready:last + collapseState.set":function(e,t,i,n){var a=i.getSettingsManager(),r=t.settingsFieldName,s={};s[r]=n?"expanded":"collapsed",a.set({set:s,callback:function(){}})}});return i}),define("tau/models/board.customize.units/board.customize.units.settings.default.clipboard",[],function(){"use strict";return{get:function(e){var t=[[{id:"entity_name_small_sizes",alignment:"base"}]],i={team:[[{id:"team_project_name_long",alignment:"base"}],[{id:"team_team",alignment:"base"}]],project:[[{id:"team_project_name_long",alignment:"base"}],[{id:"project_project_icon",alignment:"base"}]],user:[[{id:"user_avatar",alignment:"base"}],[{id:"user_name",alignment:"base"}]],projectmember:[[{id:"user_avatar",alignment:"base"},{id:"user_name",alignment:"base"}],[{id:"project_long",alignment:"base"}]]};return i[e]||t}}}),define("tau/models/board.clipboard/model.board.clipboard.data",["Underscore","tau/core/extension.base","tau/utils/utils.serverErrorTranslator","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/services/customize/service.customize.card.layout.factory","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.settings.default.clipboard"],function(e,t,i,n,a,r,s){var o=t.extend({"bus configurator.ready:last + options.ready:last + afterInit":function(t,i){var n=i.getClipboardManager();n.getAll(e.bind(function(e,t){this.fire("cards.get",t)},this))},_convertDataForUnits:function(e){e=e||{};var t=e.project||{},i=e.name||"",n=i.split(" "),a=n.shift();return{entity_name_small_sizes:{name:i},team_project_name_long:{name:i},team_team:{icon:e.icon},user_avatar:{avatarUri:e.avatarUri},project_long:{project:{name:t.name,color:e.color}},project_project_icon:{color:e.color},user_name:{firstName:a,lastName:n.join(" ")}}},"bus configurator.ready:last + options.ready:last + cards.ready":function(t,i,n,a){var r=i.getClipboardManager();r.unbind(this);var s=e.bind(function(t,n){var r=!1;
if(a.length===n.length){var s=e.map(a,function(e){return e.dataItem.id}),o=e.map(n,function(e){return e.id}),l=e.difference(o,s);r=l.length}else r=!0;r&&this._getLayouts(n,i).done(function(t){n=e.map(n,function(n){return e.extend(n.data,this._convertDataForUnits(n.data.cardData)),this._convertDataForTemplate(n,i,t,n._id,n.isSelected)},this),this.fire("cards.ready",n)}.bind(this)),this.fire("cards.changed")},this);n.refreshTimeout&&(s=e.debounce(s,n.refreshTimeout)),r.bind(this,s)},"bus configurator.ready:last + cards.get":function(t,i,n){var a=n.length;this._loadCardsData(i,n).always(function(t){a!=t.length&&i.getClipboardManager().set(e.map(t,function(e){return e.dataItem.data.type=e.dataItem.type.toLowerCase(),e.dataItem})),this.fire("cards.ready",t),this.fire("dataBind",{cards:t})}.bind(this))},"bus configurator.ready:last + cards.readyToClear":function(t,i,n){var a=i.getClipboardManager(),r=[];e.forEach(n,function(e){r.push({id:e.id,data:{id:e.entityId,type:e.entityType}})}),a.remove(r,function(){})},"bus configurator.ready:last + cards.update":function(t,i,n){var a=i.getClipboardManager(),r=e.map(n,function(e){return{id:e.id,isSelected:e.isSelected,data:{cardData:e.cardData,id:e.entityId,type:e.entityType}}});a.update(r,function(){})},"bus configurator.ready:last + cards.readyToRemove":function(t,n,a){var r=n.getClipboardManager(),s=n.getStore(),o=this,l=[];e.forEach(a,function(t){l.push(e.bind(function(e,t){s.remove(e.entityType,{id:e.entityId}).done({success:function(){t(!1,{item:e,error:!1})},failure:function(n){var a=n[0].data,r=404!==a.status,s=r?i.translateServerError(a.response):!1;t(!1,{item:e,error:s})}})},o,t))}),e.parallel(l,function(t,i){var n=[],a=[],s=[];e.forEach(i,function(e){if(e.error)a.push(e.item),o.fire("error",e.error);else{var t=e.item;n.push(e.item),s.push({id:t.id,data:{id:t.entityId,type:t.entityType}})}}),r.remove(s,function(){}),o.fire("cards.readyToRemove.after",{success:n,failure:a})})},_getLayouts:function(t,i){var o=e.groupByComplex(t,function(e){return e.data.type.toLowerCase()
}),l=e.reduce(o,function(e,t){var i=t.key;return e.cells.types.push(i),e.cardSettings[i]={},e.cardSettings[i][r.L]=s.get(i),e},{cells:{types:[]},cardSettings:{}}),u=new n,c=new a(i,{get:function(){return $.Deferred().resolve(l)}});return c.getCardLayoutsByTypesAndSize(l.cells.types,r.L).then(function(t){return e.reduce(t,function(e,t,i){return e.types.push({type:i,data:u.build(i,t)}),e.mapLayouts[i]=t,e},{types:[],mapLayouts:{}})})},_convertDataForTemplate:function(e,t,i,n,a){e.type=e.type||e.data.type,e._id=n,e.data.cardData=e.data.cardData||{type:e.type};var r=e.type;return{dataItem:e,isSelected:a,configurator:t,layout:i.mapLayouts[r.toLowerCase()]}},getCardsDataByType:function(t,i){var n=e.map(t,function(e){return e.data.id}),a=e.reduce(t,function(e,t){return e[t.data.id]={_id:t._id,isSelected:t.isSelected},e},{}),r={cells:{}};return this._getLayouts(t,i).then(function(t){r.cells.types=t.types;var s={base64:!0,definition:r},o=i.getSliceFactory().create(s),l={$set:{CardsIds:n}};return o.cardDetails(l).then(function(n){return e.map(n.data.items,function(e){return this._convertDataForTemplate(e,i,t,a[e.data.cardData.id]._id,a[e.data.cardData.id].isSelected)},this)}.bind(this),function(){return[]})}.bind(this))},_loadCardsData:function(t,i){var n=e.groupByComplex(i,function(e){return e.data.type.toLowerCase()}),a=e.map(n,function(e){return this.getCardsDataByType(e.items,t)},this);return $.when.all(a).then(function(t){return e.flatten(t)},function(){return[]})}});return o}),define("tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.cards-custom-functions","tau/ui/templates/board.plus/customized/ui.template.boardplus.card.section.customized"],function(e,t,i){var n={engine:"jqote2",customFunctions:i,name:"board.plus.default.card.customized",markup:["<%var data = this.dataItem.data, configurator = this.configurator;%>",'<div role="card" class="i-role-card i-role-<%=this.dataItem.id%> tau-card-v2 <% if(this.isSelected){%>tau-selected<%}%> tau-card-v2_type_<%=this.dataItem.type.toLowerCase()%> <%=fn.generateFinalStateClass(this.dataItem.data.cardData) <%=fn.generateIsInPastClass(this.dataItem.data.cardData) %>"','  id="<%= fn.generateCardId(data.cardData) %>" ',"  <%= fn.generateDataAttributes(this.dataItem) %>",">","<% _.forEach(this.layout, function(section){%>",'   <%= fn.sub("boardplus.card.section.customized", [{section: section, data: data, configurator: configurator}]) %>',"<%});%>","</div>"]};
return t.register(n)}),define("tau/ui/extensions/board.clipboard/ui.board.clipboard.helper",["Underscore","jQuery"],function(e,t){return{CLASS_MAP:{CARD_SELECTED:"tau-selected",CARD_COUNTER:"tau-selection-counter",ROLE_CARD:"i-role-card",ROLE_ACTION_CLEAR:"i-role-action-clear",ROLE_TOGGLE_ACTIONS:"i-role-toggle-actions",ROLE_COUNTER_BLOCK:"i-role-counter-block",ROLE_COLLAPSER:"i-role-collapser"},getCardsData:function(i){return e.map(i,function(e){var i=t(e),n=i.data();return n.isSelected=i.hasClass(this.CLASS_MAP.CARD_SELECTED),n}.bind(this))},getAllCards:function(e){return this.getHolderCard(e).find("."+this.CLASS_MAP.ROLE_CARD)},getHolderCard:function(e){return e.find("[role=holder]")},updateCounter:function(e,t){t=t||this.getSelectedCards(e).length;var i=e.find("."+this.CLASS_MAP.CARD_COUNTER);i.toggleClass("tau-selected",!!t),i.text(t),t?this.appendClearButton(e):this.removeClearButton(e)},removeClearButton:function(e){return this.getCounterBlock(e).find("."+this.CLASS_MAP.ROLE_ACTION_CLEAR).remove()},appendClearButton:function(e){var i=this.getCounterBlock(e),n=i.find("."+this.CLASS_MAP.ROLE_ACTION_CLEAR);return n.length||(n=t('<button class="tau-btn tau-btn-small tau-clear-selection '+this.CLASS_MAP.ROLE_ACTION_CLEAR+'"></button>').appendTo(i)),n},getActionsButton:function(e){return e.find("."+this.CLASS_MAP.ROLE_TOGGLE_ACTIONS)},toggleActionsButton:function(e,t){return this.getActionsButton(e).toggleClass("tau-boardclipboard__toggle-button_enabled",!!t)},getCounterBlock:function(e){return e.find("."+this.CLASS_MAP.ROLE_COUNTER_BLOCK)},getSelectedCards:function(e){return this.getHolderCard(e).find("."+this.CLASS_MAP.CARD_SELECTED)},getCollapseButton:function(e){return e.find("."+this.CLASS_MAP.ROLE_COLLAPSER)},animateWithClass:function(t,i){t.removeClass(i).addClass(i);var n=parseFloat(t.css("MozAnimationDuration")||t.css("WebkitAnimationDuration")||1),a=parseFloat(t.css("MozAnimationIterationCount")||t.css("WebkitAnimationIterationCount")||1),r=n*a*1e3;e.delay(e.bind(function(){this.removeClass(i)
},t),r)}}}),define("tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.output",["Underscore","jQuery","tau/core/extension.base","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized","tau/ui/extensions/board.clipboard/ui.board.clipboard.helper"],function(e,t,i,n,a){return i.extend({"bus $el.ready:last+viewMode.ready":function(e,t,i){t.toggleClass("tau-boardclipboard_enable_true","list"!=i&&"newlist"!=i&&"timeline"!=i),this.fire("$el.readyToLayout",t)},"bus $el.ready:last + $selectable.ready:last + configurator.ready:last + cards.ready":function(i,r,s,o,l){var u=a.getAllCards(r),c=t();0===l.length?u.detach():(e.forEach(l,function(t){var i=u.filter("[data-_id="+t.dataItem._id+"]");i.length?u=u.not(i.eq(0)):(t.isSelected=!0,i=n.render(t),i.attr("id",e.uniqueId("clipboardcard_"))),i.length&&(c=c.add(i.eq(0)))}),u.detach(),c.appendTo(a.getHolderCard(r)));var d=a.getSelectedCards(r),p=d.length;a.updateCounter(r,p),a.toggleActionsButton(r,p),s.tauSelectable("select",d),this.fire("count.updated",c.length)},"bus $el.ready:last + cards.changed":function(e,t){var i=a.getSelectedCards(t);this.update(t,i)},"bus $el.ready:last + cards.drag.stopped":function(e,t,i){this.update(t,i)},update:function(e,t){var i=t.length;a.updateCounter(e,i),a.toggleActionsButton(e,i)},"bus $el.ready:last + count.updated:last + collapseState.updated:last":function(e,t,i,n){var r="collapsed"==n;a.getCollapseButton(t).toggleClass("tau-collapsed",r),t.toggleClass("tau-boardclipboard_empty_true",0===i||r),this.fire("$el.readyToLayout",t)},"bus view.dom.ready":function(e,t){var i=t.element.find(".tau-app-main-pane");this.fire("$layout.ready",i)},"bus $layout.ready:last + $el.readyToLayout":function(e,t,i){var n=i.hasClass("tau-boardclipboard_enable_true"),a=i.hasClass("tau-boardclipboard_empty_true");t.toggleClass("tau-layout-board_south-visible_true",n),t.toggleClass("tau-layout-board_south-visible_false",!n),t.toggleClass("tau-layout-board_south-expanded_false",a),t.toggleClass("tau-layout-board_south-expanded_true",!a)
}})}),define("tau/components/component.factory",["Underscore","tau/core/class","tau/components/component.creator"],function(e,t,i){var n=t.extend({createAsChild:function(e,t){var i=this.create(t);return e.on("destroy",function(){i.destroy()}),i},getCreatorConfig:function(){throw"SHOULD BE OVERRIDDEN"},create:function(e){e["queue.bus"]=!0;var t=this.getCreatorConfig(e);return i.create(t,e)}});return n.define=function(e){var t=n.extend({getCreatorConfig:e});return new t},n}),define("tau/models/print.cards/model.print.cards",["Underscore","jQuery","tau/core/extension.base","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/services/customize/service.customize.card.layout.factory","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n,a,r){return i.extend({"bus boardSettings.ready:last + configurator.ready:last + currentCards":function(i,n,a,r){var s=e.chain(r).map(function(e){return e.cards}).flatten().value(),o=e.groupByComplex(s,function(e){return e.type.toLowerCase()}),l=e.map(o,function(e){return this._getCardsDataByType(e.items,a,n.boardSettings)},this);t.when.all(l).then(function(t){return e.flatten(t)},function(){return[]}).then(function(t){var i=e.reduce(t,function(e,t){return e[t.dataItem.data.cardData.id]=t,e},{}),n=e.map(r,function(t){return{name:t.name,cards:e.map(t.cards,function(e){return i[e.id]})}});this.fire("renderCards",n)}.bind(this))},_getLayouts:function(t,i,s){var o=e.groupByComplex(t,function(e){return e.type.toLowerCase()}),l=e.reduce(o,function(e,t){var i=t.key;return e.cells.types.push(i),e},{cells:{types:[]},cardSettings:{}}),u=new n,c=new a(i,s);return c.getCardLayoutsByTypesAndSize(l.cells.types,r.L).then(function(t){return e.reduce(t,function(e,t,i){return e.types.push({type:i,data:u.build(i,t)}),e.mapLayouts[i]=t,e},{types:[],mapLayouts:{}})})},_getCardsDataByType:function(t,i,n){var a=e.map(t,function(e){return e.id}),r={cells:{}};return this._getLayouts(t,i,n).then(function(t){r.cells.types=t.types;
var n={base64:!0,definition:r},s=i.getSliceFactory().create(n),o={$set:{CardsIds:a}};return s.cardDetails(o).then(function(n){return e.map(n.data.items,function(e){return{dataItem:e,configurator:i,layout:t.mapLayouts[e.type.toLowerCase()]}})}.bind(this),function(){return[]})}.bind(this))},"bus beforeInit":function(){this.fire("dataBind")}})}),define("tau/ui/templates/print.cards/ui.template.print.cards",["tau/core/templates-factory","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized"],function(e){var t={engine:"jqote2",name:"print.cards",markup:["<%_.each(this,function(group){%>",'<h2 class="title-cards-for-print"><%!group.name%></h2>','<div class="tau-ui-size-l">',"<%_.each(group.cards,function(card){%>",'<div class="wrap-cards-for-print"><%=fn.sub("board.plus.default.card.customized",card)%></div>',"<%});%>","</div>","<%});%>"]};return e.register(t)}),define("tau/ui/extensions/print.cards/ui.extension.print.cards",["Underscore","jQuery","tau/core/extension.base","tau/ui/templates/print.cards/ui.template.print.cards","tau/core/tau"],function(e,t,i,n){return i.extend({"bus afterRender":function(e,i){i.element.on("click",".i-role-print-trigger",function(e){t(e.currentTarget).prop("disabled",!0),this.fire("getCardsData")}.bind(this))},clearPrintBlock:function(){this.$printBlock&&(this.$printBlock.remove(),t("body").css({overflow:""}))},"bus clearPrintBlock":function(){this.clearPrintBlock()},"bus destroy":function(){this.clearPrintBlock(),this._super()},"bus configurator.ready:last + renderCards + afterRender:last":function(i,a,r,s){s.element.find(".i-role-print-trigger").prop("disabled",!1);var o=t(".i-print-card");0===o.length&&(o=t('<div  class="i-print-card print-block-cards"/>').appendTo("body"),t("body").css({overflow:"hidden"})),this.$printBlock=o;var l=n.render(r);o.removeClass("print-block-cards_hide").html(l);var u=l.find(".i-role-card"),c=e.reduce(u,function(e,i){var n=t(i).height(),a=t(i).width();return e.height=n>e.height?n:e.height,e.width=n>e.width?a:e.width,e
},{width:0,height:0}),d=1.92,p={width:c.width*d,height:c.height*d+35};l.find(".wrap-cards-for-print").css(p),t(window).on("afterprint",function(){this.clearPrintBlock()}.bind(this)),window.print(),window.stop&&(location.reload(),window.stop()),o.addClass("print-block-cards_hide")}})}),define("tau/core/helpers/extension.configurator",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i)}})}),define("tau/components/component.print.cards",["tau/components/component.factory","tau/models/print.cards/model.print.cards","tau/ui/extensions/print.cards/ui.extension.print.cards","tau/core/helpers/extension.configurator"],function(e,t,i,n){return e.define(function(e){var a={name:"printCards",extensions:[t,i,n].concat(e.extensions||[]),template:{engine:"jqote2",name:"printCardsButton",markup:['<span class="tau-inline-group tau-board-print">','<button class="tau-btn tau-print i-role-print-trigger">','<span class="tau-icon-general tau-icon-loading"></span>Print cards',"</button>","</span>"]}};return a})}),define("tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.print",["Underscore","jQuery","tau/core/extension.base","tau/components/component.print.cards"],function(e,t,i,n){return i.extend({init:function(e){this._super(e),this.printComponent=n.createAsChild(this,{}),this.printComponent.initialize()},"bus boardSettings.ready":function(e,t){this.printComponent.fire("boardSettings.ready",t)},"bus printCards":function(e,t){this.printComponent.once("renderCards",function(){t.$button.removeClass("ui-state-disabled")}),this.printComponent.fire("currentCards",[{name:"",cards:t.cards}])},"bus clearPrintBlock":function(){this.printComponent.fire("clearPrintBlock")}})}),define("tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.actions",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/board.clipboard/ui.board.clipboard.helper"],function(e,t,i,n){return i.extend({"bus $el.ready + $selectable.ready + configurator.ready":function(e,t,i,n){this.addHandlerClearClipboard(t),this.addHandlerMenuAction(t,i,n.getTemplateFactory().getTermProcessor()),this.addHandlerAfterRemove(t),this.addHandlerCollapse(t)
},addHandlerCollapse:function(t){var i=n.getCollapseButton(t);i.on("click",e.bind(function(){var e=i.hasClass("tau-collapsed");this.fire("collapseState.set",e),taus.track({action:"click clipboard collapser",tags:["click","clipboard",e?"expand":"collapse"]})},this))},addHandlerClearClipboard:function(e){var t=this;e.on("click","."+n.CLASS_MAP.ROLE_ACTION_CLEAR,function(){var i=n.getSelectedCards(e),a=n.getCardsData(i);t.fire("cards.readyToClear",a),taus.track({action:"click clipboard clear",tags:["click","clipboard","clear"]})}.bind(this))},addHandlerAfterRemove:function(i){this.on("cards.readyToRemove.after",function(a,r){var s=r.failure,o=i.find(".i-role-card"),l=e.reduce(s,function(e,t){return e.add(o.filter("[data-_id="+t._id+"]")),e},t());n.animateWithClass(l,"tau-card_failed")})},addHandlerMenuAction:function(e,t,i){var a=e.find(".clipboard__actions-list"),r=n.getActionsButton(e);r.tauBubble({onPositionConfig:function(e){return e.my="right top+2",e.at="right bottom",e},template:a,zIndex:999,onShow:function(){var t=a.find('[data-action="remove"] a'),i=a.find('[data-action="print"] a'),r=n.getSelectedCards(e).length,s=r+" card"+(r>1?"s":""),o="Delete "+s,l="Print "+s;t.text(o),i.html(l+'<span class="tau-icon-general tau-icon-loading"></span>'),a.focus()}}),a.menu({select:function(n,a){var s=a.item.data("action");this.handlersAction[s]&&this.handlersAction[s].call(this,a.item,e,r,t,i)}.bind(this)}),t.on("tauselectablechanged",function(){var t=n.getSelectedCards(e).length;n.toggleActionsButton(e,t)}),a.detach()},handlersAction:{remove:function(t,i,a,r,s){var o=e.bind(function(e){this.fire("cards.readyToRemove",e)},this);taus.track({action:"click clipboard delete",tags:["click","clipboard","delete"]}),t.tauConfirm({onShow:function(r){var l=n.getSelectedCards(i),u=n.getCardsData(l),c=function(e,t){return s.getTerm(e,t>1?"names":"name")},d=["project","team"],p=[],f=e.groupBy(u,function(e){return e.entityType});e.forEach(f,function(e,t){var i=-1!==d.indexOf(t),n=e.length+" "+c(t,e.length);
i&&(n='<span class="tau-clipboard__highlight-message">'+n+"</span>"),p.push(n)});var m="<h3>Are you sure you want to delete "+p.join(", ")+"?</h3>";r.find(".i-role-actioncancel").focus(),t.tauConfirm("option",{content:m,callbacks:{success:function(){o(u)},always:function(){a.tauBubble("hide")}}})},zIndex:130}),t.tauConfirm("show")},print:function(t,i,a){var r=n.getSelectedCards(i);t.addClass("ui-state-disabled"),a.one("taububblehide",function(){this.fire("clearPrintBlock")}.bind(this)),this.fire("printCards",{cards:e.pluck(n.getCardsData(r),"cardData"),$button:t}),taus.track({action:"click clipboard print",tags:["click","clipboard","print"]})}}})}),define("tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.selection",["jQuery","tau/core/extension.base","tau/ui/extensions/board.clipboard/ui.board.clipboard.helper"],function(e,t,i){return t.extend({"bus $el.ready":function(t,n){var a=i.getSelectedCards(n);n.pscroller(),n.tauSelectable({items:"."+i.CLASS_MAP.ROLE_CARD,className:i.CLASS_MAP.CARD_SELECTED,ctrl:!0,selectOnMouseup:!0,selectedItems:a,changed:function(){this.fire("cards.update",i.getCardsData(i.getAllCards(n)))}.bind(this)}),n.rselect({trigger:".tau-boardclipboard__toolbar, .tau-select-block, .tau-boardclipboard__holder",selectionClass:i.CLASS_MAP.CARD_SELECTED,selectable:"."+i.CLASS_MAP.ROLE_CARD,show:function(){e(this).pscroller("enable")},end:function(t,i){e(this).pscroller("disable"),n.tauSelectable("unselect",i.deselection),n.tauSelectable("select",i.selection),n.tauSelectable("raiseChanged",i.selection,!0,!0)}}),i.updateCounter(n),i.toggleActionsButton(n,a.length),this.fire("$selectable.ready",n)}})}),define("tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.dragndrop",["jQuery","tau/core/extension.base","tau/ui/extensions/board.plus/ui.board.plus.dom.utils"],function(e,t,i){return t.extend({"bus configurator.ready + $sortable.ready":function(e,t){t.getGlobalBus().removeAllListeners(this)},"bus configurator.ready:last + destroy":function(e,t){t.getGlobalBus().removeAllListeners(this)
},"bus $el.ready + $selectable.ready":function(t,n,a){var r=this,s=n,o=n.parents("[role=main]:first");s.tauSortable({groups:".tau-boardclipboard__holder, .i-role-grid .i-role-cellholder",items:".i-role-card",appendTo:s,containment:o,addClasses:!1,useSelectable:a,connectedSortable:".i-role-grid",moveInGroup:!1,createPlaceholderContent:i.createDragNDropPlaceholderContent,processToGroup:function(e,t,i){var n=i;i.is(".i-role-cellholder")&&(n=i.children(".i-role-cell")),n.data("isempty",!0),e.appendTo(n);var a=n.children().length-1;a&&n.data("isempty",!1)}}),s.bind("tausortablestart",function(e,t){taus.track({action:"clipboard cards dnd",tags:["clipboard","cards dnd",t.items.length]}),t.helper&&t.helper.find(".i-role-card").addClass("tau-card-v2_dnd_helper").removeClass("i-role-card"),t.items.removeClass("i-role-card")}),s.bind("tausortablegroupentered",function(t,i){var n=i.group,a=n.parents(".i-role-grid"),r=a.length?a:s,o=e(i.item),l=o.data("ui-draggable");l.scrollParent=r,l.overflowOffset=r.offset()}),s.bind("tausortablestop",function(e,t){t.items.addClass("i-role-card"),a.tauSelectable("select",t.items),r.fire("cards.drag.stopped",t.items)}),r.fire("$sortable.ready",s)}})}),define("tau/ui/extensions/card.viewer.progress.indicators",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(){this.containers=[]},show:function(e,t){e.tauProgressIndicator(),e.tauProgressIndicator("show",t),e.on("remove",this._removeContainer.bind(this,e)),this.containers.push(e)},_removeContainer:function(t){this.containers=e.without(this.containers,t)},hideAll:function(){e.each(this.containers,function(e){e.data("ui-tauProgressIndicator")&&e.tauProgressIndicator("hide")}),this.containers.length=0}})}),define("tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.viewer",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/card.viewer.progress.indicators"],function(e,t,i,n){return i.extend({init:function(e){this.progressIndicators=new n,this._super(e)
},"bus configurator.ready":function(e,t){var i=this;t.getComponentBusRegistry().getByName("entityViewer").done(function(e){i.fire("viewerBus.ready",e)})},"bus viewerBus.ready + $el.ready + configurator.ready:last":function(i,n,a,r){n.on("application.error",e.bind(function(e){this.fire("view.cardDetails.lastResult",{type:"error",data:e.data})},this)),n.on("application.contentRendered",e.bind(function(e){this.fire("view.cardDetails.lastResult",{type:"loaded",data:e.data})},this)),a.on("dblclick",".i-role-card",e.bind(function(e){var i=t(e.currentTarget),a=i.data();taus.track({action:"clipboard view card",tags:["clipboard","view card",a.entityType]}),r.getBoardCacheService().setData(a.cardData),this.progressIndicators.show(i,{hover:!0}),n.fire("cardDataToShowSilent.ready",a)},this)),a.on("mousedown",".tau-id",function(e){e.stopPropagation()})},"bus view.cardDetails.lastResult":function(){this.progressIndicators.hideAll()}})}),define("tau/ui/templates/board.clipboard/ui.template.board.clipboard",["tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized"],function(){var e={name:"board.clipboard",engine:"jqote2",markup:['<div role="clipboard-body" class="tau-boardclipboard',"<% if (this.cards.length == 0) { %> tau-boardclipboard_empty_true<% } %>"," tau-ui-size-clipboard i-view_grid",'">','<div class="tau-boardclipboard__toolbar">','<div class="tau-select-block">','<button class="tau-v-collapser i-role-collapser" role="collapser"></button>','<span class="tau-boardclipboard-title">Selected cards</span>','<div class="tau-inline-group tau-selection-group i-role-counter-block">','<button class="tau-btn tau-btn-small tau-selection-counter">0</button>','<button class="tau-btn tau-btn-small tau-clear-selection i-role-action-clear"></button>',"</div>","</div>",'<div class="tau-actions-block">','<button class="tau-btn tau-attention tau-boardclipboard__toggle-button i-role-toggle-actions">Actions</button>','<ul tabindex="-1" class="clipboard__actions-list">','<li class="clipboard__actions-item" data-action="remove"><a class="clipboard__action clipboard__action_delete">Delete</a></li>','<li class="clipboard__actions-item" data-action="print"><a class="clipboard__action clipboard__action_print">Print</a></li>',"</ul>","</div>","</div>",'<div role="holder" class="tau-boardclipboard__holder i-role-cell i-role-clipboard-holder" id="clipboard_holder_<%= _.uniqueId() %>" >','<%= fn.sub("board.plus.default.card.customized", this.cards) %>',"</div>","</div>"]};
return e}),define("tau/components/component.board.clipboard",["Underscore","tau/components/component.creator","tau/models/board.clipboard/model.board.clipboard.main","tau/models/board.clipboard/model.board.clipboard.data","tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.output","tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.print","tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.actions","tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.selection","tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.dragndrop","tau/ui/extensions/board.clipboard/ui.extension.board.clipboard.viewer","tau/components/extensions/error/extension.errorBar","tau/ui/templates/board.clipboard/ui.template.board.clipboard"],function(e,t,i,n,a,r,s,o,l,u,c,d){return{create:function(e){var p={extensions:[i,n,a,r,s,o,l,u,c],template:d};e["queue.bus"]=!0;var f=t.create(p,e);return f}}}),define("tau/ui/extensions/board.editor/ui.extension.board.clone",["Underscore","tau/core/extension.base.stateful"],function(e,t){return t.extend({"bus boardSettings.ready:last + command.clone":function(e,t){var i=this,n=this.config.context.configurator,a=t.boardSettings,r=["cells","x","y","zoomLevel","viewMode","cardSettings","timelineSettings"];n.getBoardDefinitionFactory().cloneDefinition(a.settings.id,r).done(function(e){n.getBoardApiService().createViewMenuItem(e).done(function(t){e.id=t.data.key,i.navigateToCloned(n,e)})}.bind(this))},createTooltip:function(e,t){e.tauBubble({content:t,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow"  role="arrow"></div>','<div class="tau-bubble-board__inner tau-container"  role="content"></div>',"</div>"].join(""),zIndex:999,className:"tau-bubble-tooltip",showEvent:"mouseenter",hideEvent:"mouseleave",mode:"tooltip",onPositionConfig:function(e){e.at="center top",e.my="center bottom"},onShow:function(){this.adjustPosition()}})},navigateToCloned:function(e,t){var i=e.getUrlBuilder().getRelativeBoardUrl(t.id);
e.getRouting().redirect(i)}})}),define("tau/components/component.board.clone",["Underscore","tau/components/component.creator","tau/ui/extensions/board.editor/ui.extension.board.clone"],function(e,t,i){return{create:function(e){var n={extensions:[i],template:{engine:"jqote2",name:"cloneBoardButton",markup:['<span class="tau-inline-group tau-board-clone">','<button class="tau-btn tau-clone i-role-clone-trigger">Clone View</button>',"</span>"]}};e["queue.bus"]=!0;var a=t.create(n,e);return a.on("afterInit",function(e){e.sender.fire("dataBind",{})}),a.on("afterRender",function(e){var t=e.data.element;t.on("click",".i-role-clone-trigger",function(){e.sender.fire("command.clone")})}),a}}}),define("tau/models/model.board.collapser.aside",["Underscore","tau/core/model-base"],function(e,t){return t.extend({configFieldName:"collapser_aside_collapsed","bus afterInit":function(e){var t=e.data.config.context.configurator,i=t.getSettingsManager(),n=this.configFieldName;i.get({fields:[n]}).then(function(e){this.fire("dataBind",{isCollapsed:!!e[n]})}.bind(this))},"bus afterInit:last + collapser.switched":function(e,t){var i=t.config.context.configurator.getSettingsManager(),n=this.configFieldName;i.get({fields:[n]}).then(function(e){var t={};return t[n]=!e[n],i.set({set:t})})},"bus afterInit:last + afterRender:last + disable":function(e,t,i){var n=t.config.context.configurator.getSettingsManager(),a={};a[this.configFieldName]=!1,n.set({set:a}),i.element.hide()},"bus afterRender:last + enable":function(e,t){t.element.show()}})}),define("tau/ui/extensions/board.collapser.aside/ui.extension.board.collapser.aside",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var i=e.data.element,n=this;i.delegate("[role=collapser]","click",function(){t(this).toggleClass("tau-collapsed"),n.fire("collapser.switched",{})})}})}),define("tau/ui/templates/board.collapser.aside/ui.template.board.collapser.aside",["tau/core/templates-factory","tau/nls/translator"],function(e,t){var i={name:"board.collapser.aside",engine:"jqote2",markup:['<div class="tau-pane-collapser">','<button type="button" role="collapser" data-title="'+t("Hide&nbsp;menu")+'" data-title-collapsed="'+t("Show&nbsp;menu")+'" class="tau-extension-board-tooltip tau-h-collapser<% if (this.isCollapsed){ %> tau-collapsed<% } %>">',"</button>","</div>"],dependencies:[]};
return e.register(i)}),define("tau/components/component.board.collapser.aside",["Underscore","tau/components/component.creator","tau/models/model.board.collapser.aside","tau/ui/extensions/board.collapser.aside/ui.extension.board.collapser.aside","tau/ui/templates/board.collapser.aside/ui.template.board.collapser.aside"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[n,i],template:a};return t.create(r,e)}}}),define("tau/components/component.container",["Underscore","tau/components/component.creator","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/spinner/ui.extension.spinner"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:e.concat([s.extensions,n,a,r]),ViewType:s.ViewType||i};return t.create(o,s)}}}),define("tau/ui/extensions/board.container/ui.extension.board.container.events",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus boardSettings.ready > refresh":function(e,t){this.fire("boardSettings.ready",t)},"bus boardSettings.ready > initialize":function(e,t){this.fire("boardSettings.ready",t)},"bus componentsCreated:last + boardSettings.ready":function(e,t,i){for(var n=0,a=t.length;a>n;n++){var r=t[n].component;r.fire("boardSettings.ready",i)}},"bus componentsCreated:last + view.dom.ready":function(e,t,i){for(var n=function(){this.fire("view.dom.ready",i)},a=0,r=t.length;r>a;a++){var s=t[a].component;s.on("afterRender",n,s),s.fire("view.dom.ready",i)}}})}),define("tau/views/view.board.container",["Underscore","jQuery","tau/views/view.container"],function(e,t,i){return i.extend({"bus initialize":function(){},"bus initialize+boardSettings.ready":function(t){this.startLifeCycle(e.values(t)[0],e.values(t)[1].data.boardSettings)},"bus refresh":function(){this.destroyChildren(),this.startLifeCycle()},startLifeCycle:function(t,i){i=i||this.boardSettings;var n=this;n.setDefaultConfig(),e.extend(n.config,(t||{}).data),n.boardSettings=i;
var a=n.config.children;n.children=[],n.fire("beforeInit",{config:n.config});var r=e.isArray(a)&&e.size(a)>0&&n.config.visible;if(r){var s=n.config.children,o=n.config.context||{};n.fire("createComponents",{components:s,context:o})}else n.completeInitializationWithoutChildren()}})}),define("tau/components/component.board.container",["Underscore","tau/components/component.container","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/views/view.board.container"],function(e,t,i,n){return{create:function(a){var r={extensions:[i].concat(a.extensions||[]),ViewType:a.ViewType||n};return t.create(e.extend(a,r))}}}),define("tau/models/board.context.selector/model.board.context.selector.base",["Underscore","tau/core/class"],function(e,t){var i={TEAM:"Team",PROJECT:"Project"},n=function(t){var i=t.selected||e(t.projects||[]).any(function(e){return e.selected});return("None"==t.id?"0":"1")+(i?"0_":"1_")+t.name.toUpperCase()},a=t.extend({init:function(e){this._featureService=e},getData:function(t,n,a){var r=a.appContext.teamContext;r.items=a.selectedTeams;var s=this._process(t,r,i.TEAM),o=a.appContext.projectContext;o.items=a.selectedProjects;var l=this._process(n,o,i.PROJECT),u=this._getModelData(a,s,l);return this._selectedCache={projects:e.pluck(l.selection,"id"),teams:e.pluck(s.selection,"id")},u},_isProject:function(e){return e==i.PROJECT},_isTeam:function(e){return e==i.TEAM},_getModelData:function(e,t,i){return{acid:e.acid,selectedTeams:t.selection,selectedTeamsCount:t.selectionLength,selectedProjects:i.selection,selectedProjectsCount:i.selectionLength,teamsCount:t.list.length}},_sort:function(t){return e.sortBy(t,n)},_getListItem:function(e){return{id:e.id,name:e.name,icon:e.icon,whiteIcon:null,displayableIcon:e.icon,color:e.color,isSupportView:e.id>0,isWarningVisible:e.isWarningVisible}},_process:function(t,i,a){var r=a.toLowerCase(),s=this._isProject(a)&&this._featureService.isEnabled("warning.noProjectIsDeprecated"),o={id:"None",name:"No "+r,abbreviation:"No "+r,icon:null,whiteIcon:null,displayableIcon:null,isWarningVisible:s},l={id:"Any",name:"Any "+a,abbreviation:"Any "+a,icon:null,whiteIcon:null,displayableIcon:null},u=t;
u.unshift(o);var c=i.items||[];i.no&&c.unshift(o);var d=[],p=!1;if(0===c.length)d=[l],p=!0;else if(c.length==u.length&&1==u.length)d=[o];else{var f=e.filter(u,function(t){return e.indexOf(e.pluck(c,"id"),t.id)>=0});0===f.length?d=[o]:f.length==u.length?(d=[l],p=!0):d=f}d=this._sort(d);var m=e.pluck(d,"id");u=e.chain(u).map(function(t){return e.extend(this._getListItem(t,a),{selected:!p&&e.indexOf(m,t.id)>=0})},this).sortBy(n).value(),e.each(d,function(e){"None"==e.id||"Any"==e.id?(e.icon=r,e.whiteIcon=r):null!==e.icon&&(e.whiteIcon=e.icon+"_white"),e.displayableIcon=e.whiteIcon||e.icon});var h=d.length,g=d.slice(0,2);return d.length>1&&d[0]==o&&(o.icon=null,o.displayableIcon=null),{list:u,selection:d,selectionLength:h,selectionShow:g}},_getSelectedOnViewProjectIds:function(t){var i=t.projects.length==t.selectedProjects.length;return i?[]:e.pluck(t.selectedProjects,"id")}});return a}),define("tau/models/board.context.output/model.board.context.output.data",["Underscore","tau/core/extension.base","tau/models/board.context.selector/model.board.context.selector.base"],function(e,t,i){var n=["id","name","color","isActive","abbreviation"];return t.extend({"bus beforeInit":function(e){var t=e.data.config.context.configurator;this.fire("configurator.ready",t),this.fire("acidStore.ready",t.getAppStateStore()),this.fire("store.ready",t.getStore()),this.fire("contextStore.ready",t.getApplicationContextService()),this._model=new i(t.getFeaturesService())},"bus configurator.ready:last + acid.ready":function(e,t,i){t.getStateManager().unbind(this),t.getStateManager().bind({paramId:"appConfig",fieldName:"acid",listener:this,callback:function(e){var t=e.value;i!=t&&this._refreshModel()}.bind(this)})},"bus acidStore.ready":function(e,t){t.get({fields:["acid"],callback:function(e){this.fire("acid.ready",e.acid||"")}.bind(this)}),t.unbind({listener:this}),t.bind({fields:["acid","appContext"],listener:this,callback:function(){this._refreshModel()}.bind(this)})},"bus acidStore + destroy":function(e,t){t.unbind({listener:this})
},"bus configurator.ready:last + store.ready":function(e,t,i){this._setupStore(t,i)},"bus contextStore.ready":function(e,t){t.removeAllListeners(this),t.on("refreshChoice.after",function(){this._refreshModel()},this)},"bus contextStore.ready:last + acid.ready + configurator.ready:last + store.ready:last":function(e,t,i,n,a){t.getApplicationContext({acid:i},{success:function(e){n.getPrototypeContextEntityService().updateContextPrototype(e),this.fire("projects.ready",e.projects),this.fire("teams.ready",e.teams),this.fire("programs.ready",e.programs),this.fire("context.ready",e),this.fire("track.new.context",e)}.bind(this),failure:function(){this.fire("context.ready",{appContext:{teamContext:{},projectContext:{}},projects:[],selectedProjects:[]}),this._getProjects(a),this._getTeams(a),this._getPrograms(a)}.bind(this)})},prepareModel:function(e,t,i){return this._model.getData(e,t,i)},"bus teams.ready + projects.ready + context.ready":function(e,t,i,n){var a=this.prepareModel(t,i,n);this.fire("dataBind",a),this._trackData(a)},_refreshModel:function(){this.resetSubscriptions(),this.fire("refresh")},_getProjects:function(t){t.get("project",{fields:["id","name","color","isActive","abbreviation",{program:["id"]}]}).done(function(t){var i=e.filter(t[0].data,function(e){return e.isActive});this.fire("projects.ready",i)}.bind(this))},_getPrograms:function(e){e.get("program",{fields:["id","name",{projects:n}]}).done(function(e){this.fire("programs.ready",e[0].data)}.bind(this))},_getTeams:function(e){e.get("team",{fields:["id","name","icon","abbreviation"]}).done(function(e){var t=e[0].data;this.fire("teams.ready",t)}.bind(this))},_setupStore:function(e,t){e.getFeaturesService().isEnabled("context.v2")||(this._getProjects(t),this._getTeams(t))},_trackData:function(e){this.fire("application.context.data",e)}})}),define("tau/ui/templates/board.context.output/ui.template.board.context.output.selected",["tau/core/templates-factory"],function(e){var t={name:"board.context.output.selected",engine:"jqote2",markup:['<span class="tau-selected_item tau-extension-board-tooltip" data-title="<%! this.name %>" <% if (this.color != null) { %>style="color:<%! (this.color) %>"<% }%>>',"<% if (this.displayableIcon != null) { %>",'<i class="tau-icon tau-icon_type_svg tau-icon_name_<%! (this.displayableIcon) %>"></i>',"<% }%>","<%! (this.abbreviation || this.name) %>","</span>"]};
return e.register(t)}),define("tau/ui/templates/board.context.output/ui.template.board.context.output",["tau/core/templates-factory","tau/ui/templates/board.context.output/ui.template.board.context.output.selected"],function(e){var t={name:"board.context.output",engine:"jqote2",markup:['<div class="tau-teams-projects">','<div class="tau-selected-projects">','<div class="tau-txt">','<%= fn.sub("board.context.output.selected", this.selectedProjects.slice(0, 3)) %>',"</div>","<% if (this.selectedProjects.length > 3) { %>",'<b class="tau-more">+<%= this.selectedProjects.length-3 %></b>',"<% } %>","</div>","<% if(this.teamsCount > 1) {%>",'<div class="tau-selected-teams">','<div class="tau-txt">','<%= fn.sub("board.context.output.selected", this.selectedTeams.slice(0, 3)) %>',"</div>","<% if (this.selectedTeams.length > 3) { %>",'<b class="tau-more">+<%= this.selectedTeams.length-3 %></b>',"<% } %>","</div>","<% } %>","</div>"]};return e.register(t)}),define("tau/components/component.board.context.output",["tau/components/component.creator","tau/models/board.context.output/model.board.context.output.data","tau/ui/templates/board.context.output/ui.template.board.context.output"],function(e,t,i){return{create:function(n){var a={queuedBus:!0,extensions:[t],template:i};return e.create(a,n)}}}),define("tau/models/board.context.selector/model.board.context.selector",["Underscore","tau/models/board.context.selector/model.board.context.selector.base"],function(e,t){var i=function(e){return e.program},n=function(e){return function(t){return t.program.id==e.id}},a=t.extend({getData:function(t,a,r,s){var o=this._super(t,a,s),l=e.filter(o.projects,i),u=e.difference(o.projects,l),c=e.map(r,function(t){return this._getProgramListItem(t,e.filter(l,n(t)))},this);return o.projects=this._sort(e.concat([u,c])),o},getProgram:function(t,i){var n=e.map(t.projects,this._getProjectListItem.bind(this,this._getSelectedOnViewProjectIds(i)));return this._getProgramListItem(t,n)},_getProjectListItem:function(t,i){return e.extend(this._getListItem(i,"Project"),{selected:e.contains(t,i.id)})
},_getProgramListItem:function(t,i){var n=this._getListItem(t,"Program");return n.projects=i,n.selected=i.length>0&&e.all(i,e.matches({selected:!0})),n},_getListItem:function(e,t){var i=this._super(e,t);return this._isProject(t)&&(i.program=e.program),this._isProject(t)&&(i.process=e.process),i.type=t,i},_getModelData:function(e,t,i){return{acid:e.acid,teams:t.list,projects:i.list,loggedUser:e.loggedUser}}});return a}),define("tau/models/board.context.selector/model.board.context.selector.data",["Underscore","tau/models/board.context.output/model.board.context.output.data","tau/models/board.context.selector/model.board.context.selector"],function(e,t,i){return t.extend({CONVERT_MAP:{None:"null",Any:"*"},"bus beforeInit":function(e){var t=e.data.config.context.configurator;this.contextStore=t.getApplicationContextService(),this.acidStore=t.getAppStateStore(),this._super(e),this._model=new i(t.getFeaturesService())},"bus model.setFilter":function(t,i){var n=this.fire.bind(this),a=i.selectedProjectsIds,r=i.selectedTeamsIds;if(this._selectedCache&&e.isEqual(this._selectedCache.teams,r)&&e.isEqual(this._selectedCache.projects,a))return void n("currentContextSelected");var s=function(e){var t=this.CONVERT_MAP[e];return t?t:e}.bind(this),o={projectIds:e.map(a,s),teamIds:e.map(r,s)};this.contextStore.getApplicationContext(o,{success:function(e){n("context.changed",e),n("track.new.context",e)}})},"bus context.changed":function(e,t){this.contextStore.markAsDirty(),this.acidStore.set({set:{acid:t.acid,appContext:t.appContext}})},"bus teams.ready + projects.ready + context.ready":function(){},"bus teams.ready + projects.ready + programs.ready + context.ready":function(e,t,i,n,a){var r=this._model.getData(t,i,n,a);this.fire("dataBind",r),this._trackData(r)},_setupStore:function(e,t){this._super(e,t),t.unbind(this);var i=this.fire.bind(this);t.on({type:"project",eventName:"afterSave",listener:this},function(e){e.data.cmd&&"context"!=e.data.cmd.type&&t.get("project",{id:e.data.id,fields:["id","name","color",{process:["id","name"]},{program:["id","name"]}]}).done(function(e){i("project.add.success",e[0].data)
})}),t.on({type:"team",eventName:"afterSave",listener:this},function(e){e.data.cmd&&"context"!=e.data.cmd.type&&t.get("team",{id:e.data.id,fields:["id","name","icon"]}).done(function(e){i("team.add.success",e[0].data)})}),t.on({type:"program",eventName:"afterRemove",listener:this},function(e){i("program.removed",{id:e.data.id})}),t.on({type:"program",eventName:"afterSave",listener:this},function(e){e.data.cmd&&"context"!=e.data.cmd.type&&i("program.save",{id:e.data.id})})},"bus store.ready:last + program.save + context.ready:last":function(t,i,n,a){i.get("program",{id:n.id,fields:["id","name",{projects:["id","name","color","isActive",{process:["id"]}]}]}).done(function(t){var i=t[0].data;i.projects=e.where(i.projects,{isActive:!0}),this.fire("program.saved",this._model.getProgram(i,a))}.bind(this))},"bus project.add.success + context.ready:last":function(t,i,n){var a=this._model._getSelectedOnViewProjectIds(n),r=e.extend(this._model._getListItem(i),{selected:e.contains(a,i.id)});this.fire("project.saved",r)},"bus program.add.completed + context.ready:last":function(t,i,n){var a=this._model.getProgram(i,n);e.each(a.projects,function(e){e.selected=!0}),a.selected=!0,this.fire("program.saved",a)},_trackData:function(){}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.main",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({ANY_TEAM_OR_PROJECT:"Any",NO_TEAM_OR_PROJECT:"None","bus afterRender":function(e,t){this.fire("$el.ready",t.element)},"bus configurator.ready:last + $el.ready":function(e,i,n){var a=this,r=n.find(".i-role-action-submit");this.fire("$submitButton.ready",r),r.on("click",function(){a.fire("filter.submitted")}),this.fire("$teamSection.ready",n.find(".tau-teams")),this.fire("$projectSection.ready",n.find(".tau-projects")),this.fire("$sections.ready",n.find(".tau-teams, .tau-projects")),this.fire("$assignSection.ready",n.find(".tau-teams-projects-updater")),n.on("click",".i-role-selecttrigger",function(e){var i=t(e.currentTarget).data(),n="team"==i.entityType?[i.entityId]:[a.ANY_TEAM_OR_PROJECT],r="project"==i.entityType?[i.entityId]:[a.ANY_TEAM_OR_PROJECT];
a.fire("model.setFilter",{selectedTeamsIds:n,selectedProjectsIds:r})});var s=n.find(".i-role-process-submit");1===n.find(".tau-projects .i-role-list .i-role-project").length&&s.hide(),s.on("click",function(){this.showSetupProcess(i,n)}.bind(this))},"bus $el.ready:last + filter.submitted":function(e,t){this.fire("model.setFilter",this.getCurrentState(t))},"bus $el.ready + $submitButton.ready":function(e,t,i){t.on("change",":checkbox",function(){i.hasClass("tau-teams-projects-submit_highlighted_true")||i.animateWithCss({cssClassName:"tau-teams-projects-submit_highlighted_true"})})},"bus configurator.ready:last + $teamSection.ready:last + team.add.success":function(e,t,i,n){var a=i.find(":checkbox[value="+n.id+"]").length;a||(this._addToList(i,t.getTemplateFactory().get("board.context.selector.teams.list"),n),i.removeClass("tau-managed-category_isempty_true"),this.fire("team.add.completed"))},"bus configurator.ready:last + $projectSection.ready:last + project.saved":function(e,t,i,n){var a=t.getTemplateFactory().get("board.context.selector.projects.list"),r=i.find(":checkbox[value="+n.id+"]").closest("li");if(0===r.length)this._addToList(i,a,n),i.removeClass("tau-managed-category_isempty_true"),this.fire("project.add.completed");else{var s=r.closest(".i-role-program",i);s.length&&this.fire("program.save",{id:s.find(".i-role-select-program :checkbox").val()}),!n.program&&s.length&&this._moveInList(i,a,n)}},"bus $el.ready+project.add.completed":function(e,t){var i=t.find(".i-role-process-submit");i.is(":visible")||i.show()},showSetupProcess:function(i,n){var a=n.find(".tau-projects .i-role-list .i-role-project :checked"),r=n.find(".tau-projects .i-role-list .i-role-project :checkbox"),s=a.length>1&&a.length===r.length,o=1===a.length&&a[0].value===this.NO_TEAM_OR_PROJECT,l=!a.length||s||o?r:a,u=e.find(l,function(e){return e.value!==this.NO_TEAM_OR_PROJECT},this);if(u){var c=t(u).data("processId");c&&i.getTp2Service().showEditProcessPopup(i,c)}},getCurrentState:function(e){var t={},i=this,n=function(){return this.value==i.NO_TEAM_OR_PROJECT?i.NO_TEAM_OR_PROJECT:parseInt(this.value,10)
},a=e.find(".tau-teams .i-role-list :checked"),r=e.find(".tau-teams .i-role-list :checkbox");return t.selectedTeamsIds=!a.length||a.length>1&&a.length==r.length?[this.ANY_TEAM_OR_PROJECT]:a.map(n).toArray(),a=e.find(".tau-projects .i-role-list .i-role-project :checked"),r=e.find(".tau-projects .i-role-list .i-role-project :checkbox"),t.selectedProjectsIds=!a.length||a.length>1&&a.length==r.length?[this.ANY_TEAM_OR_PROJECT]:a.map(n).toArray(),t},_addToList:function(t,i,n){n.selected=!0;var a=i.bind({},n),r=t.find(".i-role-list"),s=r.find(".i-role-item:first");s.length?s.after(a):r.append(a),r.parent().scrollTo(0,{duration:500}),a.addClass("tau-added"),e.delay(function(){a.removeClass("tau-added")},1500)},_moveInList:function(e,t,i){var n=t.bind({},i),a=e.find(".i-role-list");i.selected?n.insertAt(a,1):n.appendTo(a)}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready":function(i,n){var a=null,r=null;n.off("input.search keydown.search");var s=e.bind(function(e){clearTimeout(r);var i=t(e.currentTarget);a!=i.val()&&(r=setTimeout(function(){this.fire("filter.changed",i.val())}.bind(this),50))},this);n.on("input.search keydown.search","input[name=filter]",s),n.delegate("input[name=filter]","keydown",function(e){e.keyCode==t.ui.keyCode.ESCAPE&&e.stopPropagation(),e.which==t.ui.keyCode.ENTER&&t(this).trigger("blur")})},match:function(t,i){var n=t.toLowerCase();return 0==i.length||e.any(i,function(e){return n.indexOf(e)>=0})},"bus $sections.ready:last + filter.changed":function(i,n,a){var r=e.trim(a).toLowerCase().split(/\s+/g),s=this.match;n.each(function(){var e=t(this),i=e.find(".i-role-list"),n=i.find(".i-role-item"),a=0;n.each(function(){var e=t(this),i=e.text(),n=s(i,r);n&&(a+=1),e.toggleClass("tau-category-items-selector__item_filtered_false",!n)}),e.toggleClass("tau-managed-category_filtered_none",0==a)}),this.fire("filter.completed")
},"bus $teamSection.ready:last + team.add.completed":function(e,t){t.removeClass("tau-managed-category_filtered_none")},"bus $projectSection.ready:last + project.add.completed":function(e,t){t.removeClass("tau-managed-category_filtered_none")}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $sections.ready":function(e,i){i.each(function(){var e=t(this);e.syncedCheckbox({sourceSelector:"header :checkbox",targetSelector:".i-role-list .i-role-item :checkbox"}),e.on("synccheckboxes",function(){e.syncedCheckbox("syncUp")})})},"bus $sections.ready:last + filter.completed":function(e,t){t.trigger("synccheckboxes")},"bus $sections.ready:last + team.add.completed":function(e,t){t.trigger("synccheckboxes")},"bus $sections.ready:last + project.add.completed":function(e,t){t.trigger("synccheckboxes")},"bus $sections.ready:last + $popup.shown":function(e,t){t.trigger("synccheckboxes")},"bus $sections.changed":function(i,n){var a=function(i,n){var a={};e.each(n,function(e){a[e.id]=e.selected}),e.each(i.find(".i-role-item :checkbox"),function(e){var i=t(e),n=i.val(),r=i.prop("checked"),s=a[n];r!==s&&i.prop("checked",s)})};a(n.projects.$optionsList,n.projects.data),a(n.teams.$optionsList,n.teams.data)}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.viewer",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready":function(e,t){var i=this;t.getComponentBusRegistry().getByName("entityViewer").done(function(e){i.fire("viewerBus.ready",e)})},"bus viewerBus.ready + $el.ready":function(t,i,n){n.on("click",".i-role-viewtrigger",function(t){t.stopPropagation(),t.stopImmediatePropagation();var n=e(t.currentTarget).data();i.fire("cardDataToShow.ready",n)})}})}),define("tau/ui/templates/board.context.selector/ui.template.board.context.selector.program.fn",["tau/core/templates-factory","tau/ui/templates/board.context.selector/ui.template.board.context.selector.projects.list"],function(){return{}
}),define("template!tau/ui/templates/board.context.selector/ui.template.board.context.selector.program",["tau/core/templates-factory","./ui.template.board.context.selector.program.fn"],function(e,t){var i={name:"board.context.selector.program",engine:"jqote2",customFunctions:t,markup:'<% var disabled = _.isEmpty(this.projects); %> <li class="i-role-item i-role-program"> <label data-title="Select to see work assigned to this program" class="tau-checkbox tau-extension-board-tooltip i-role-select-program"> <input type="checkbox" value="<%= this.id %>" <%= this.selected ? \'checked\' : \'\' %> <%= (disabled ? \'disabled\' : \'\')%> /> <i class="tau-checkbox__icon"></i> <span class="tau-checkbox-label"> <span class="tau-category-items-selector_level_link"><%! this.name %></span> <span class="tau-category-items-selector_level_count i-role-projects-count"><%= this.projects.length %></span> </span> </label> <i data-title="Open this program in a popup" class="tau-extension-board-tooltip tau-category-items-selector__viewtrigger tau-icon tau-icon_type_svg tau-icon_name_newwindow i-role-viewtrigger" data-entity-id="<%! this.id %>" data-entity-type="program"></i> <ul class="tau-category-items-selector_level"> <%= fn.sub("board.context.selector.projects.list", this.projects) %> </ul> </li>'};return e.register(i)}),define("tau/ui/templates/board.context.selector/ui.template.board.context.selector.lists.program.fn",["tau/core/templates-factory","tau/ui/templates/board.context.selector/ui.template.board.context.selector.teams.list","tau/ui/templates/board.context.selector/ui.template.board.context.selector.projects.list","template!tau/ui/templates/board.context.selector/ui.template.board.context.selector.program"],function(){}),define("template!tau/ui/templates/board.context.selector/ui.template.board.context.selector.lists.program",["tau/core/templates-factory","./ui.template.board.context.selector.lists.program.fn"],function(e,t){var i={name:"board.context.selector.lists.program",engine:"jqote2",customFunctions:t,markup:'<div class="tau-teams-projects-manager i-role-popupcontent"> <section class="tau-teams-projects-search"> <span class="tau-inline-group tau-search"> <input name="filter" type="text" placeholder="Search Projects and Teams" class="tau-in-text"> <button class="tau-btn tau-search" type="button"></button> </span> </section> <section class="tau-managed-category <% if (this.teams.length == (this.canAddTeams === false ? 0 : 1)) { %>tau-managed-category_isempty_true tau-no-team<% } %> tau-teams i-role-section-teams"> <header> <label class="tau-checkbox tau-extension-board-tooltip i-role-select-all-item" data-title="Select all teams"> <input <%if (this.checkedAllTeam) {%>checked<%}%> type="checkbox" value=""> <i class="tau-checkbox__icon"></i> <span class="tau-checkbox-label">Teams</span> </label> <button class="tau-add i-role-formtrigger" type="button">New team</button> </header> <ul class="tau-category-items-selector i-role-list"> <%= fn.sub("board.context.selector.teams.list", this.teams) %> </ul> <div class="tau-no-message"> <div class="tau-img"></div> <p>Team is a group of people working together toward a common vision. Teams can work on projects.</p> <div class="tau-btn-wrap"><button class="tau-btn tau-success i-role-formtrigger" type="button">Create team</button></div> </div> <div class="tau-managed-category__message tau-managed-category__message_not-found" data-text-nofound="No such team found" data-text-noitems="No available teams"></div> </section> <section class="tau-managed-category <% if (this.projects.length == (this.canAddProjects === false ? 0 : 1)){ %>tau-managed-category_isempty_true tau-no-project<% } %> tau-projects i-role-section-projects"> <header> <label class="tau-checkbox tau-extension-board-tooltip i-role-select-all-item" data-title="Select all projects"> <input <%if (this.checkedAllProject) {%>checked<%}%> type="checkbox"> <i class="tau-checkbox__icon"></i> <span class="tau-checkbox-label">Projects</span> </label> <span class="tau-add"> <a href="#" type="button" class="i-role-formtrigger">New project</a> <span>or</span> <a href="#" type="button" class="i-role-add-program-trigger">program</a> </span> </header> <ul class="tau-category-items-selector i-role-list"> <% _.each(this.projects, function(item) { %> <% if(item.type === "Program") { %> <%= fn.sub("board.context.selector.program", item) %> <% } else if (item.type === "Project") { %> <%= fn.sub("board.context.selector.projects.list", item) %> <% } else { throw new Error("the type \'" + item.type + "\' is not supported in template \'board.context.selector.lists.program\'") } %> <% }); %> </ul> <div class="tau-no-message"> <div class="tau-img"></div> <p>You usually need a project to deliver results. Projects hold all the work that needs to be done.</p> <div class="tau-btn-wrap"><button class="tau-btn tau-success i-role-formtrigger" type="submit">Create project</button></div> </div> <div class="tau-managed-category__message tau-managed-category__message_not-found" data-text-nofound="No such project found" data-text-noitems="No available projects"></div> </section> <% var updaterStateClass = this.isShowButtonVisible ? "tau-teams-projects-updater_state_enabled": ""; %> <section class="tau-teams-projects-updater <%= updaterStateClass %>"> <button class="tau-btn tau-primary tau-teams-projects-submit i-role-action-submit" role="action-submit" type="button"><%= (this.submitLabel || "Show") %></button> <% if (this.loggedUser && this.loggedUser.isAdministrator) { %> <a class="tau-setup-process i-role-process-submit">Set up Process</a> <% } %> </section> </div>'};
return e.register(i)}),define("tau/components/context.selector/views/view.context.selector",["Underscore","jQuery","template!tau/ui/templates/board.context.selector/ui.template.board.context.selector.lists.program","template!tau/ui/templates/board.context.selector/ui.template.board.context.selector.program","tau/core/view-base"],function(e,t,i,n,a){var r=a.extend({init:function(e){this._super(e),this.config.template=i},"bus program.saved":function(e,t){this.onProgramSaved(t)},"bus program.removed":function(e,t){this.onProgramRemoved(t)},onProgramRemoved:function(e){var t=this._$programById(e.id);t.replaceWith(t.find(".i-role-item")),t.remove()},onProgramSaved:function(e){e.projects.forEach(function(e){t(this.element).find("#content_filter_project_"+e.id).closest("li").remove()},this),this._$programById(e.id).length?this._updateProgram(e):this._addProgram(e)},_$programById:function(e){return t(".i-role-program",this.element).filter(function(){return t(".i-role-select-program :checkbox",this).val()==e})},_$renderProgram:function(e){var t=n.render(e);return this._onProgramAdded(t),t},_addProgram:function(i){var n=t(this.element).find(".tau-projects .i-role-list"),a=this._$renderProgram(i).insertAt(n,1).addClass("tau-added");e.delay(function(){a.removeClass("tau-added")},1500),this.element.find(".tau-projects").removeClass("tau-managed-category_isempty_true")},_updateProgram:function(e){this._$programById(e.id).replaceWith(this._$renderProgram(e))},doRender:function(t,i,n){if(n)throw new Error("Template parameter is forbidden in ContextSelectorView.doRender");var a=e.deepClone(t);a.isShowButtonVisible=1<t.projects.length||1<t.teams.length,this._super(a,i,n),this._afterRender()},bindTemplate:function(e,t){return this._rejectComments(this._super(e,t))},_rejectComments:function(e){return e.filter("*")},_afterRender:function(){var e=this.element.find(".tau-projects");e.on("synccheckboxes",function(){e.find(".i-role-program").syncedCheckbox("syncUp")}),this._onProgramAdded(e.find(".i-role-program"))
},_onProgramAdded:function(e){e.syncedCheckbox({sourceSelector:".i-role-select-program :checkbox",targetSelector:".i-role-item :checkbox"})}});return r}),define("tau/components/component.board.context.selector",["tau/components/component.creator","tau/models/board.context.selector/model.board.context.selector.data","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.main","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.viewer","tau/components/context.selector/views/view.context.selector"],function(e,t,i,n,a,r,s){return{create:function(o){var l={queuedBus:!0,ViewType:s,extensions:[t,i,n,a,r].concat(o.extensions||[])};return e.create(l,o)}}}),define("tau/libs/boardSettings/board.settings.to.definition.translator",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e,t){this.boardSettings=e,this.appStateStore=t},getBoardDefinition:function(){var t=this.boardSettings.get(["x","y","cells","zoomLevel","viewMode","page","focus","selectedMarks","cardSettings","user","acid","cellPaging"]),i=this.appStateStore.get({fields:["acid"]});return $.when(t,i).then(e.bind(function(e,t){var i=this.createDefinition(e);return i.global={acid:t.acid},{definition:i,configuration:e}},this))}}),n={entityState:25,effort:12},a=function(t,i){e.each(n,function(n,a){t[i]&&t[i].types&&e.any(t[i].types,function(e){return e.toLowerCase()==a.toLowerCase()})&&(t.page.size[i]=n)})},r=function(e){return Math.max(1,Math.min(6,e))};return i.prototype.createDefinition=function(t){var i={};return t.hasOwnProperty("x")&&null!==t.x&&(i.x=t.x),t.hasOwnProperty("y")&&null!==t.y&&(i.y=t.y),t.hasOwnProperty("cells")&&null!==t.cells&&(i.cells=t.cells),i.cells&&(i.cells.ordering=e.defaults(i.cells.ordering||{},{name:"Rank",direction:"Desc"})),i.zoomLevel=r(t.zoomLevel||3),i.page=e.defaults(t.page||{},{x:0,y:0,size:{x:8,y:20}}),a(i,"x"),a(i,"y"),i.focus=e.defaults(t.focus||{},{x:[],y:[]}),i.selectedMarks=e.defaults(t.selectedMarks||{},{x:[],y:[]}),i.viewMode=t.viewMode||"board",i.boardId=t.id,i.cardSettings=t.cardSettings,i.user=e.defaults(t.user||{},{cardsFilter:""}),i
},i}),define("tau/ui/extensions/board.csv/ui.extension.board.csv",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/libs/boardSettings/board.settings.to.definition.translator","tau/slice/url.resolver","tau/slice/slice.definition.transformations","tau/core/query"],function(e,t,i,n,a,r,s){return i.extend({"bus beforeInit":function(e,t){this.formSubmitter=t.config.formSubmitter||this.formSubmitterImpl,this.fire("dataBind",{})},"bus afterRender + boardSettings.ready:last + configurator.ready:last":function(i,s,o,l){var u=o.boardSettings,c=s.view.config.context.configurator.getAppStateStore(),d=s.element,p=new a({prefix:"matrix"}),f=p.resolveUrl("csv"),m=this;d.on("click",".i-role-export-to-csv",function(){var i=e(this);new n(u,c).getBoardDefinition().then(function(e){var n=r.createSliceDefinitionFromBoardSettings(e.definition),a=t.pick(l.service("currentBoard").sliceInfo,["x","y"]);n.where=m.createWhere(a),m.fire("ready.to.submit",{$el:i,definition:n,url:f,boardName:u.settings.name,viewMode:u.settings.viewMode})})})},"bus ready.to.submit":function(e,t){this.formSubmitter(t)},createWhere:function(e){var i=e||{},n=t.reduce(i,function(e,i,n){if(i.data.length){var a=t.pluck(i.data,"id"),r=t.every(a,function(e){return void 0==e});if(r){var s=t.pluck(i.data,n);a=s}e[n]={$in:a}}return e},{});return s.render(n)},formSubmitterImpl:function(t){var i=e('<form id="csvForm" action="'+t.url+'" method="POST" target="_blank"></form>'),n=e('<input type="hidden" name="parameters"/>'),a=e('<input type="hidden" name="boardName"/>'),r=e('<input type="hidden" name="where"/>'),s=e('<input type="hidden" name="viewMode"/>');n.val(JSON.stringify(t.definition)),a.val(t.boardName),r.val(t.definition.where),s.val(t.viewMode),t.$el.wrap(i),t.$el.after(n),t.$el.after(a),t.$el.after(r),t.$el.after(s),t.$el.parent().submit(),n.remove(),a.remove(),r.remove(),s.remove(),t.$el.unwrap()}})}),define("tau/ui/templates/board.csv/ui.template.board.csv",["tau/core/templates-factory"],function(e){var t={name:"board.templates.csv",engine:"jqote2",markup:['<span class="tau-inline-group tau-board-csv"><input type="button" class="tau-btn tau-csv i-role-export-to-csv" value="Export"/></span>']};
return e.register(t)}),define("tau/utils/timeline/utils.timeline.date",["Underscore","libs/date.js/build/date","tau/utils/utils.date"],function(e,t,i){var n=864e5;return{minDate:new t(-68478156e5),maxDate:new t(0xe677d17b107d),isInfinite:function(e){return e<this.minDate+n||e>this.maxDate-n},getNow:function(){return i.getServerNow()},getToday:function(){return this.getNow().clearTime()}}}),define("tau/utils/timeline/utils.timeline.date-range",["Underscore","tau/utils/utils.date","libs/date.js/build/date","tau/utils/utils.date/utils.date.formats","tau/utils/timeline/utils.timeline.date"],function(e,t,i,n,a){var r="",s=function(e){return e?e.getTime():0},o=function(e){return e?new i(e):null},l=function(e,t){this.startDate=e,this.endDate=t,this.isValid=!0,this.invalidString=null};l.prototype={errorMessage:function(){return"Invalid date range"},equals:function(e){return s(this.startDate)===s(e.startDate)&&s(this.endDate)===s(e.endDate)},toString:function(){if(!this.isValid)return this.invalidString;var e=this.startDate?t.format.date.short(this.startDate):"*";return e+=" "+r+" ",e+=this.endDate?t.format.date.short(this.endDate):"*"},toISOString:function(){if(!this.isValid)return this.invalidString;var e=this.startDate?t.format.date.iso(this.startDate):"*";return e+=" "+r+" ",e+=this.endDate?t.format.date.iso(this.endDate):"*"},toFullISOString:function(){if(!this.isValid)return this.invalidString;var e=this.startDate?t.format.datetime.iso(this.startDate):"*";return e+=" "+r+" ",e+=this.endDate?t.format.datetime.iso(this.endDate):"*"},toJSON:function(){return this.isValid?{startDate:t.format.datetime.iso(this.startDate),endDate:t.format.datetime.iso(this.endDate)}:null},setStartDate:function(e){return new l(e,this.endDate)},setEndDate:function(e){return new l(this.startDate,e)},getDurationInTicks:function(){return this.endDate-this.startDate},getDurationInDays:function(){return this.startDate||this.endDate?t.getDiffInDays(this.endDate,this.startDate):Number.POSITIVE_INFINITY
},scale:function(e){var t=this.startDate.clone(),n=new i(this.startDate+this.getDurationInTicks()*e);return new l(t,n)},intersects:function(e){return e.startDate&&e.startDate.valueOf()>=this.endDate.valueOf()?!1:e.endDate&&e.endDate.valueOf()<=this.startDate.valueOf()?!1:!0}};var u=function(){this.startDate=null,this.endDate=null,this.isValid=!1};return u.prototype=l.prototype,l.tryParse=function(t,a){if(t=e.trim(t),0===t.length)return l.createEmptyRange();a=a||[n.datetime.iso,n.datetime.short];var r=t.split(/ [-] /),s=function(t,n){var a=null;return e.find(n,function(e){return a=i.parseExact(t,e),null!==a}),a},o=r[0]?s(r[0],a):null,u=r[1]?s(r[1],a):null;return null===o||r[1]?null===o||null===u||o.getTime()>u.getTime()?l.createInvalidRange(t):new l(o,u):l.createEmptyRange()},l.tryParseWithRoundedDays=function(e,t){var i=this.tryParse(e,t||[n.date.short,n.date.iso]);return!i.isValid||i.isEmpty?i:l.createWithRoundedDays(i.startDate,i.endDate)},l.createInvalidRange=function(e){var t=new l(null,null);return t.isValid=!1,t.invalidString=e,t},l.createEmptyRange=function(){return new u},l.createWithRoundedDays=function(e,t){return new l(o(e),new i(t).clone().clearTime().addDays(1).addMilliseconds(-1))},l.createDefault=function(){return l.createWithRoundedDays(a.getToday().addMonths(-1),a.getToday().addDays(2))},l.createLastWeek=function(){return l.createWithRoundedDays(a.getToday().addDays(-7).moveToDayOfWeek(0,-1),a.getToday().addDays(-7).moveToDayOfWeek(6,1))},l.createLastThirtyDays=function(){return l.createWithRoundedDays(a.getToday().addDays(-30),a.getToday())},l.createLastThreeMonths=function(){return l.createWithRoundedDays(a.getToday().addMonths(-3),a.getToday())},l.createLastYear=function(){return l.createWithRoundedDays(a.getToday().addYears(-1),a.getToday())},l}),define("tau/configurations/definitions/board.definition.factory",["Underscore","jQuery","tau/core/class","tau/utils/timeline/utils.timeline.date-range"],function(e,t,i,n){return i.extend({init:function(t,i){this.serviceContainer=t,this.storage=t.getRestStorage(),this.boardService=t.getBoardApiService(),this._viewsMenuService=t.getViewsMenuService(),this.boardAccess=t.getBoardAccessService(),this.options={groupName:"boards"},this.options=e.defaults(i||{},this.options),this.defaults={groupName:this.options.groupName,name:"New View",zoomLevel:{board:3},viewMode:"board",hierarchyMode:"inside",createdAt:null,isDraft:!0,edit:!1,ownerIds:[],isShared:!1,menuIsVisible:!0,menuNumericPriority:999999,prioritization:{mode:"shift"},cells:{types:[],filter:"",useFilter:!1},timelineSettings:{showPlannedInPast:!1,showForecast:!0}}
},getLoggedUser:function(){return this.serviceContainer.getLoggedUser()},createDefault:function(){var t=new Date,i=e.cloneDeep(this.defaults);return i.createdAt=t.toGMTString(),i.menuNumericPriority=t.getTime(),i.timelineGlobalDateRange=n.createDefault().toISOString(),i},_createDefaultGroupData:function(){var e=new Date;return{name:"New Group",createdAt:e.toGMTString(),isShared:!1,menuIsVisible:!0,menuNumericPriority:e.getTime()}},createByOwner:function(t){if(!e.isObject(t))throw new Error("Should be owner");var i=this.createDefault();return i.ownerIds=[t.id],i.edit=!0,i},createForLoggedUser:function(){return this.createByOwner(this.getLoggedUser())},createBoard:function(t){t=t||this.createForLoggedUser();var i=e.clone(t);return i.menuIsVisible=!0,this.boardService.createViewMenuItem(i).then(function(e){return t.id=e.data.key,t})},createViewGroup:function(t){var i=e.defaults(e.deepClone(t)||{},this._createDefaultGroupData());return this._viewsMenuService.groupsApi.createViewMenuItem(i)},cloneDefinition:function(t,i){return this.getById(t).then(function(t){var n=["x","y","cells","limits","zoomLevel","viewMode","prioritization","cardSettings","timelineLocalDateRange","timelineGlobalDateRange","timelineSettings"],a=this.createDefault(),r=e.pick(e.deepClone(t),n,i);r.isShared=!1,r.ownerIds=[this.getLoggedUser().id],r.name=t.name+" Cloned",r.edit=!0;var s=e.extend(a,r);return s}.bind(this))},findDefaultForLoggedUser:function(){return this.findDefault(this.getLoggedUser())},findDefault:function(t){return this._viewsMenuService.getBoardsForUser(t.id).then(function(t){var i=t.data||{},n=i.items||[];return e.chain(n).map(function(t){return e.extend(t,t.publicData,t.userData),e.extend(t,{id:t.key,priority:t.menuNumericPriority||0,visibility:t.menuIsVisible||0})}).sortBy(function(e){return e.visibility?e.priority-1:e.priority+99999}).first().value()})},findLast:function(e){var i=t.Deferred();return this.boardService.getBoardData(e).done(function(e){var t=e.data||{};t&&(t.id=t.key),i.resolve(t)
}).fail(function(){i.resolve(null)}),i.promise()},getById:function(e){return this.boardService.getBoardData(e).then(function(e){var t=e.data||{};return t.id=t.key,t}.bind(this))}})}),define("tau/ui/extensions/application.generic/ui.extension.application.generic.boardSpecific",["Underscore","jQuery","tau/core/extension.base","tau/configurations/definitions/board.definition.factory"],function(e,t,i,n){return i.extend({"bus configurator.ready":function(e,t){t.getBoardDefinitionFactory=function(){return this.boardDefinitionFactory=this.boardDefinitionFactory||new n(t),this.boardDefinitionFactory}},"bus afterRender":function(t,i){this.initializeFeedback(),this.processBody(i.element).done(e.bind(function(e){this.fire("view.dom.ready",{element:e})},this))},"bus configurator.ready + application.exit":function(e,t){this.fire("initProgress"),t.getRouting().redirect(t.getUrlBuilder().getDashboardUrl())},"bus configurator.ready:last + application.navigate + controller.postExecute":function(e,t,i){var n=i.requestArgs||{},a=function(e){this.fire("boardSettings.ready",{boardSettings:e})}.bind(this),r="board"==n.entity;if(r){var s=n.id;this.processBoardSettings(s,t).done(a)}else{var o=this._createDefaultBoardSettings("none",t);o.markFieldsRetrieved(this._getDefaultBoardFields()),o.settings.viewMode="list",a(o)}},"bus controller.app.host:last + controller.app.page:last + boardSettings.ready":function(t,i,n,a){e.forEach([i,n],function(e){e.fire("boardSettings.ready",a)})},processBody:function(e){var i=t.Deferred();t(":root").addClass("tau-app-frame");var n=t("body");return n.prepend(e),i.resolve(n),i},processBoardSettings:function(e,i){var n=t.Deferred(),a=i.getBoardDefinitionFactory().createDefault();i.setBoardSettingsOptions(a);var r=i.getBoardSettingsFactory().create(e);return r.get({fields:this._getDefaultBoardFields(),callback:function(){n.resolve(r)}}),n},_createDefaultBoardSettings:function(e,t){var i=t.getBoardDefinitionFactory().createDefault();return t.setBoardSettingsOptions(i),t.getBoardSettingsFactory().create(e)
},_getDefaultBoardFields:function(){return["name","x","y","cells","viewMode","zoomLevel","collapse","focus"]},initializeFeedback:function(){!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"widget.uservoice.com/rywvig4l55Tifwaw7wk3Ag.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}})}),define("tau/components/component.board.csv",["tau/components/component.creator","tau/ui/extensions/board.csv/ui.extension.board.csv","tau/ui/templates/board.csv/ui.template.board.csv","tau/ui/extensions/application.generic/ui.extension.application.generic.boardSpecific","tau/core/helpers/extension.configurator"],function(e,t,i,n,a){return{create:function(r){var s={extensions:[t,n,a],template:i};return e.create(s,r)}}}),define("tau/services/boards/service.views.menu.api.wrapper",["require","Underscore","jQuery"],function(e){var t=e("Underscore"),i=e("jQuery");return{create:function(e,n){var a=e.boardsApi,r=a.createChildEventEmitter({updateViewMenuItem:{writable:!1,value:function(e,t,r){var s=n(),o=i.Deferred();if(e===s.settings.id){var l={set:t,failure:function(e){o.reject(e)},onReceived:function(e){o.resolve(e)},_originalBoardData:r};return s.set(l),o.promise().then(function(){return{data:s.settings}})}return a.updateViewMenuItem(e,t,r)}}});return Object.create(e,{boardsApi:{get:t.constant(r)}})}}}),define("tau/models/board.editor.access/model.board.editor.access",["Underscore","jQuery","tau/core/model-base","tau/services/boards/service.views.menu.api.wrapper","tau/utils/utils.serverErrorTranslator"],function(e,t,i,n,a){return i.extend({"bus beforeInit":function(e){this._configurator=e.data.config.context.configurator,this.fire("configurator.ready",this._configurator)},_getTeams:function(){var e=t.Deferred();return this._configurator.getStore().get("team",{fields:["id","name","icon"]}).done(function(t){e.resolve(t[0].data)}),e},_getProjects:function(){var i=t.Deferred();
return this._configurator.getStore().get("project",{fields:["id","name","color","isActive"]}).done(function(t){var n=e.filter(t[0].data,function(e){return e.isActive});i.resolve(n)}),i},_getBoardAccess:function(){return this._viewsMenuService.getViewMenuItem(this._viewMenuId).then(function(e){return this._getAccessData(e.data)}.bind(this))},_getAccessData:function(e){var t=this._configurator.getLoggedUser(),i=this._configurator.getBoardAccessService();return{isShared:e.isShared,isAdmin:t.isAdministrator,isOwner:i.isOwner(e,t),isEditable:i.isEditable(e,t),isView:!!e.viewMode,id:e.id||e.key,name:e.name,acid:e.acid,customSharedData:e.customSharedData||{isActive:!1,teamIds:[],projectIds:[]}}},_getEmailNotificationSettings:function(){var e=t.Deferred();return this._configurator.getGlobalSettingsService().getGlobalSettings({success:function(t){e.resolve(t.IsEmailNotificationsEnabled)},failure:function(){e.resolve(!1)}}),e},_loadData:function(){t.when(this._getTeams(),this._getProjects(),this._getBoardAccess(),this._getEmailNotificationSettings()).done(function(e,t,i,n){e=this._process(e,i.customSharedData.teamIds),t=this._process(t,i.customSharedData.projectIds),this.fire("dataBind",{access:i,teams:e,projects:t,canAddTeams:!1,canAddProjects:!1,checkedAllProject:t.length==i.customSharedData.projectIds.length,checkedAllTeam:e.length==i.customSharedData.teamIds.length,showSearch:!0,submitLabel:"Share",boardId:i.id,boardName:i.name,isEmailNotificationsEnabled:n&&i.isView,boardAcid:i.acid})}.bind(this))},_process:function(t,i){var n=function(e){return(-1==e.id?"0":"1")+(e.selected?"0_":"1_")+e.name.toUpperCase()},a=t;return a=e.chain(a).map(function(t){return{id:t.id,name:t.name,icon:t.icon,color:t.color,selected:e.indexOf(i,t.id)>=0}}).sortBy(n).value()},"bus configurator.ready + boardSettings.ready:last":function(t,i,a){this._boardSettings=a.boardSettings,this._viewMenuId=this.config.context.viewMenuId||this._boardSettings.settings.id;var r=n.create(i.getViewsMenuService(),function(){return this._boardSettings
}.bind(this));this._viewsMenuService=r.getApiForType(this.config.context.viewMenuType||"board"),this._loadData();var s=e.debounce(function(){this.fire("componentRefresh")}.bind(this),300);this._boardSettings.unbind({listener:this}),this._boardSettings.bind({fields:["name","acid","isShared","customSharedData"],listener:this,callback:s});var o=this._configurator.getStore();o.unbind(this),o.on({eventName:"afterSave",type:"team",listener:this},s),o.on({eventName:"afterRemove",type:"team",listener:this},s),o.on({eventName:"afterSave",type:"project",listener:this},s),o.on({eventName:"afterRemove",type:"project",listener:this},s)},"bus elementInsertedToContainer:last + componentRefresh":function(){this.fire("refresh")},"bus form.submitted":function(e,t){this._viewsMenuService.updateViewMenuItem(this._viewMenuId,t,{isShared:!1}).fail(function(e){var t=e.response?e.response.data.responseText:e.data.responseText;this.fire("error",a.translateServerError(t))}.bind(this))},"bus destroy":function(){this._boardSettings.unbind({listener:this})}})}),define("tau/ui/extensions/board.editor.access/ui.extension.board.editor.access",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({getProjectsAndTeams:function(e){function i(e){return parseInt(e.value,10)}return t.map(e.find(".i-role-list :checked"),i)},"bus afterRender + configurator.ready":function(t,i,n){var a=i.data,r=i.element,s=r.find(".i-role-popupcontent"),o=s.find(".i-role-section-teams"),l=s.find(".i-role-section-projects");this.toggleCustomSharedPanel(r,!a.access.customSharedData.isActive),r.on("change","[role=action-share]",function(t){this.handlers[e(t.target).val()].bind(this)(r)}.bind(this));var u=r.find("[role=action-bord-access-notify]");this.getProjectsAndTeams(l).length<1&&this.getProjectsAndTeams(o).length<1&&u.prop("disabled",!0),r.on("click",".i-role-popupcontent :checkbox",function(t){var i=this.getProjectsAndTeams(o),n=this.getProjectsAndTeams(l);e(t.target).is(":checked")?u.prop("disabled",!1):i.length<1&&n.length<1&&u.prop("disabled",!0),this.fireCustomSharedData(!0,!0,i,n)
}.bind(this)),this.fire("$el.ready",s),this.fire("$teamSection.ready",o),this.fire("$projectSection.ready",l),this.fire("$sections.ready",s.find(".tau-teams, .tau-projects"));var c=n.getSliceFactory().create({});u.on("click",function(){u.prop("disabled",!0);var e=this.getProjectsAndTeams(o),t=this.getProjectsAndTeams(l),i=n.getUrlBuilder().getBoardPageRelativePath()+n.getUrlBuilder().getRelativeBoardUrl(a.boardId,a.boardAcid);c.notifyBoardAccess({$set:{teamIds:e,projectIds:t,boardUrl:i,boardName:a.boardName}}).done(function(){this.fire("notification",{message:"People will be notified that you've shared a View with them.",delay:3e3})}.bind(this)).fail(function(e){this.fire("error",{message:e.data.responseText.Message,delay:3e3})}.bind(this))}.bind(this))},fireCustomSharedData:function(e,t,i,n){this.fire("form.submitted",{isShared:e,customSharedData:{isActive:t,teamIds:i||[],projectIds:n||[]}})},handlers:{"public":function(e){this.toggleCustomSharedPanel(e,!0),this.fireCustomSharedData(!0,!1)},"private":function(e){this.toggleCustomSharedPanel(e,!0),this.fireCustomSharedData(!1,!1)},custom:function(e){this.toggleCustomSharedPanel(e,!1),this.fireCustomSharedData(!0,!0)}},toggleCustomSharedPanel:function(e,t){var i=e.find(".i-role-popupcontent");i.toggleClass("tau-disabled",t),i.find("input,button:not([role=action-bord-access-notify])").prop("disabled",t),t&&i.find(":checkbox").prop("checked",!1)}})}),define("tau/ui/templates/board.context.filter/ui.template.board.context.filter.projects.list",["tau/core/templates-factory"],function(e){var t={name:"board.context.filter.projects.list",engine:"jqote2",markup:['<li class="i-role-item">','<label class="tau-checkbox  <% if (this.id == -1){ %>  tau-null-selector <% } %>">','<input type="checkbox" id="content_filter_project_<%= this.id %>" value="<%= this.id %>"',"<% if (this.selected){ %>"," checked","<% } %> ","/>",'<i class="tau-checkbox__icon"></i>','<span class="tau-checkbox-label">',"<% if (this.color){ %>",'<i class="tau-icon tau-icon_type_color" style="background-color: <%= this.color %>"></i>',"<%} else { %>",'<i class="tau-icon"></i>',"<% } %>","<%! this.name %>","</span>","</label>","<% if (this.isSupportView){ %>",'<i title="Select this project only" class="tau-category-items-selector__selecttrigger tau-icon tau-icon_type_svg tau-icon_name_aim i-role-selecttrigger" data-entity-id="<%! this.id %>" data-entity-type="project"></i>','<i title="Open this project in a popup" class="tau-category-items-selector__viewtrigger tau-icon tau-icon_type_svg tau-icon_name_newwindow i-role-viewtrigger" data-entity-id="<%! this.id %>" data-entity-type="project"></i>',"<% } %>","</li>"]};
return e.register(t)}),define("tau/ui/templates/finder.project/ui.template.finder.project.add.form",["tau/core/templates-factory"],function(e){var t={name:"finder.project.add.form",engine:"jqote2",markup:['<form class="tau-new-item_active_false i-role-form">','<div class="tau-new-entity-form">','<div class="tau-new-entity-info">','<span class="tau-select-team-icon">','<i class="tau-icon tau-icon_type_color tau-icon_name_default i-role-currenticon" data-value="default"></i>',"</span>",'<input name="name" type="text" placeholder="Enter project name here"  class="tau-in-text tau-new-entity-name">','<select name="color" style="display:none;">','<option value=""></option>',"<% _.each(this.colors, function(item){ %>",'<option value="<%= item %>"><%= item %></option>',"<% }); %>","</select>","</div>",'<ul class="tau-teams-icon-list i-role-richselect">','<li><i class="tau-icon tau-i-close i-role-option" data-value=""></i></li>',"<% _.each(this.colors, function(item){ %>",'<li><i class="tau-icon tau-icon_type_color i-role-option" style="background-color:<%= item %>;" data-value="<%= item %>"></i></li>',"<% }); %>","</ul>",'<div class="tau-new-entity-process">','<label><div class="tau-note">Select process</div>','<select class="tau-select" name="process">',"<% _.each(this.processes, function(item){ %>",'<option <% if (item.isDefault){ %>selected<% } %> value="<%= item.id %>"><%! item.name %></option>',"<% }); %>","</select></label>","</div>","<% if (this.programs && this.programs.length) { %>",'<div class="tau-new-entity-program">','<label><div class="tau-note">Select program</div>','<select class="tau-select" name="program">',"<% _.each(this.programs, function(program) { %>",'<option <% if (program.isDefault) { %>selected<% } %> value="<%= program.id %>"><%! program.name %></option>',"<% }); %>","</select></label>","</div>","<% } %>",'<div class="tau-invite-widget">','<div class="tau-note">Invite people</div>','<textarea name="users" placeholder="Start typing name(s) or email(s) to assign people to a project" />','<div class="tau-invite-footer">','<button class="tau-btn tau-success" type="submit">Create project</button>','<button class="tau-btn" type="reset">Cancel</button>',"</div>","</div>","</div>","</form>"]};
return e.register(t)}),define("tau/ui/templates/board.context.filter/ui.template.board.context.filter.teams.list",["tau/core/templates-factory"],function(e){return e.register({name:"board.context.filter.teams.list",engine:"jqote2",markup:['<li class="i-role-item">','<label class="tau-checkbox <% if (this.id == -1){ %>  tau-null-selector <% } %>">','<input type="checkbox" id="content_filter_team_<%= this.id %>" value="<%= this.id %>"',"<% if (this.selected){ %>"," checked","<% } %> ","/>",'<i class="tau-checkbox__icon"></i>','<span class="tau-checkbox-label">','<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= this.icon || ""  %>"></i>',"<%! this.name %>","</span>","</label>","<% if (this.isSupportView){ %>",'<i title="Select this team only" class="tau-category-items-selector__selecttrigger tau-icon tau-icon_type_svg tau-icon_name_aim i-role-selecttrigger" data-entity-id="<%! this.id %>" data-entity-type="team"></i>','<i  title="Open this team in a popup" class="tau-category-items-selector__viewtrigger tau-icon tau-icon_type_svg tau-icon_name_newwindow i-role-viewtrigger" data-entity-id="<%! this.id %>" data-entity-type="team"></i>',"<% } %>","</li>"]})}),define("tau/ui/templates/finder.team/ui.template.finder.team.add.form",["tau/core/templates-factory"],function(e){var t={name:"finder.team.add.form",engine:"jqote2",markup:['<form class="tau-new-item_active_false i-role-form">','<div class="tau-new-entity-form">','<div class="tau-new-entity-info">','<span class="tau-select-team-icon">','<i class="tau-icon tau-icon_type_svg tau-icon_name_default i-role-currenticon" data-value="default"></i>',"</span>",'<input name="name" type="text" placeholder="Enter team name here"  class="tau-in-text tau-new-entity-name">','<select name="icon" style="display:none;">','<option value=""></option>',"<% _.each(this.icons, function(item){ %>",'<option value="<%= item %>"><%= item %></option>',"<% }); %>","</select>","</div>",'<ul class="tau-teams-icon-list i-role-richselect">','<li><i class="tau-icon tau-i-close i-role-option" data-value=""></i></li>',"<% _.each(this.icons, function(item){ %>",'<li><i class="tau-icon tau-icon_type_svg tau-icon_name_<%= item %> i-role-option" data-value="<%= item %>"></i></li>',"<% }); %>","</ul>",'<div class="tau-invite-widget ">','<div class="tau-note">Invite people</div>','<textarea name="users" placeholder="Start typing name(s) or email(s) to assign people to a team" />','<div class="tau-invite-footer">','<button class="tau-btn tau-success" type="submit">Create team</button>','<button class="tau-btn" type="reset">Cancel</button>',"</div>","</div>","</div>","</form>"]};
return e.register(t)}),define("tau/ui/templates/board.context.filter/ui.template.board.context.filter.lists",["tau/core/templates-factory","tau/ui/templates/board.context.filter/ui.template.board.context.filter.projects.list","tau/ui/templates/finder.project/ui.template.finder.project.add.form","tau/ui/templates/board.context.filter/ui.template.board.context.filter.teams.list","tau/ui/templates/finder.team/ui.template.finder.team.add.form"],function(e){var t={name:"board.context.filter.lists",engine:"jqote2",markup:['<div class="tau-teams-projects-manager i-role-popupcontent">',"<%var hideSearch = this.showSearch === true ? false : (this.teams.length < 25 && this.projects.length < 25);%>",'<section class="tau-teams-projects-search" <% if (hideSearch){ %>style="display:none"<% } %> >','<span class="tau-inline-group tau-search">','<input name="filter" type="text" placeholder="Search Projects and Teams" class="tau-in-text">','<button class="tau-btn tau-search" type="button"></button>',"</span>","</section>",'<section class="tau-managed-category <% if (this.teams.length == (this.canAddTeams === false ? 0 : 1)){ %>tau-managed-category_isempty_true tau-no-team<% } %> tau-teams i-role-section-teams">',"<header>",'<label class="tau-checkbox i-role-select-all-item">','<input <%if (this.checkedAllTeam) {%>checked<%}%> type="checkbox" value="">','<i class="tau-checkbox__icon"></i>','<span class="tau-checkbox-label">Teams</span>',"</label>","<% if (this.canAddTeams !== false) { %>",'<button class="tau-add i-role-formtrigger" type="button">New team</button>',"<% } %>","</header>","<% if (this.canAddTeams !== false) { %>",'<%= fn.sub("finder.team.add.form", this) %>',"<% } %>",'<ul class="tau-category-items-selector i-role-list">','<%= fn.sub("board.context.filter.teams.list", this.teams) %>',"</ul>","<% if (this.canAddTeams !== false) { %>",'<div class="tau-no-message">','<div class="tau-img"></div>',"<p>Team is a group of people working together toward a common vision. Teams can work on projects.</p>",'<div class="tau-btn-wrap"><button class="tau-btn tau-success i-role-formtrigger" type="button">Create team</button></div>',"</div>","<% } %>",'<div class="tau-managed-category__message tau-managed-category__message_not-found" data-text-nofound="No such team found" data-text-noitems="No available teams"></div>','<div class="tau-managed-category__message tau-managed-category__message_isempty">You need to have some teams for custom sharing.</div>',"</section>",'<section class="tau-managed-category <% if (this.projects.length == (this.canAddProjects === false ? 0 : 1)){ %>tau-managed-category_isempty_true tau-no-project<% } %> tau-projects i-role-section-projects">',"<header>",'<label class="tau-checkbox i-role-select-all-item">','<input <%if (this.checkedAllProject) {%>checked<%}%> type="checkbox">','<i class="tau-checkbox__icon"></i>','<span class="tau-checkbox-label">Projects</span>',"</label>","<% if (this.canAddProjects !== false) { %>",'<button class="tau-add i-role-formtrigger" type="button">New project</button>',"<% } %>","</header>","<% if (this.canAddProjects !== false) { %>",'<%= fn.sub("finder.project.add.form", this) %>',"<% } %>",'<ul class="tau-category-items-selector i-role-list">','<%= fn.sub("board.context.filter.projects.list", this.projects) %>',"</ul>","<% if (this.canAddProjects !== false) { %>",'<div class="tau-no-message">','<div class="tau-img"></div>',"<p>You usually need a project to deliver results. Projects hold all the work that needs to be done.</p>",'<div class="tau-btn-wrap"><button class="tau-btn tau-success i-role-formtrigger" type="submit">Create project</button></div>',"</div>","<% } %>",'<div class="tau-managed-category__message tau-managed-category__message_not-found" data-text-nofound="No such project found" data-text-noitems="No available projects"></div>','<div class="tau-managed-category__message tau-managed-category__message_isempty">You need to have some projects for custom sharing.</div>',"</section>","<% if (this.isEmailNotificationsEnabled){ %>",'<section class="tau-board-send-notification">','<button class="tau-btn tau-board-send-notification-submit i-role-action-bord-access-notify" role="action-bord-access-notify" type="button">Send Notification</button>',"</section>","<% } %>",'<section class="tau-teams-projects-updater <% if (this.teams.length > 1 || this.projects.length > 1){ %> tau-teams-projects-updater_state_enabled<% } %>">','<button class="tau-btn tau-primary tau-teams-projects-submit i-role-action-submit" role="action-submit" type="button">','<%= (this.submitLabel || "Show") %>',"</section>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/board.editor.access/ui.template.board.editor.access",["tau/core/templates-factory","tau/ui/templates/board.context.filter/ui.template.board.context.filter.lists"],function(e){var t={name:"board.editor.access",engine:"jqote2",markup:["<% var uid = +new Date(); %>",'<div class="tau-access-settings">','<div class="tau-board-settings-group__help">','<span class="tau-help i-role-tooltipArticle" data-article-id="board.editor.access">',"About Access","</span>","</div>",'<div class="tau-access-type">',"<%if (this.access.isEditable) {%>",'<label class="tau-line">','<div class="tau-field">','<input role="action-share" value="private" type="radio" name="share<%= uid %>"<% if (!this.access.isShared) { %> checked<% } %>>',"</div>",'<div class="tau-txt">',"<h3>Private</h3>","<p>Only you as the View owner can see this View. That's the default option for new Views.</p>","</div>","</label>","<% if(this.access.isAdmin) {%>",'<label class="tau-line">','<div class="tau-field">','<input role="action-share" value="public" type="radio" name="share<%= uid %>"<% if (this.access.isShared && !this.access.customSharedData.isActive) { %> checked<% } %>>',"</div>",'<div class="tau-txt">',"<h3>Public</h3>","<p>Everyone can see this View. It will be shown in the left menu.</p>","</div>","</label>","<%}%>",'<label class="tau-line">','<div class="tau-field">','<input role="action-share" value="custom" type="radio" name="share<%= uid %>"<% if (this.access.isShared && this.access.customSharedData.isActive) { %> checked<% } %>>',"</div>",'<div class="tau-txt">',"<h3>Custom sharing</h3>","<p>You as the View owner or admin decide which team can see and change this View.</p>","</div>","</label>","<%}%>","</div>",'<div class="tau-notification-block">','<%= fn.sub("board.context.filter.lists", this) %>',"</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.editor.access",["Underscore","tau/components/component.creator","tau/models/board.editor.access/model.board.editor.access","tau/ui/extensions/board.editor.access/ui.extension.board.editor.access","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/components/extensions/error/extension.errorBar","tau/ui/templates/board.editor.access/ui.template.board.editor.access"],function(e,t,i,n,a,r,s,o){return{create:function(e){var l={extensions:[i,n,a,r,s],template:o};
return e["queue.bus"]=!0,t.create(l,e)}}}),define("tau/ui/extensions/board.editor.container/ui.extension.board.editor.container.view",["Underscore","jQuery","tau/views/view.container"],function(e,t,i){return i.extend({"bus initialize":function(){},"bus initialize + boardSettings.ready":function(e,t,i){this.startLifeCycle(t,i.boardSettings)},"bus refresh":function(){this.startLifeCycle()},startLifeCycle:function(t,i){i=i||this.boardSettings,this.boardSettings=i;var n=e.bind(this._super,this);i.get({fields:["edit"],callback:e.bind(function(e){this.config.visible=!!e.edit,n(t,i)},this)}),i.unbind({listener:this}),i.bind({fields:["edit"],listener:this,callback:e.bind(function(e){this.config&&(this.config.visible=!!e.edit,this.fire(this.config.visible?"show":"hide"),this.config.visible&&this.fire("tab.activate","setup"))},this)})}})}),define("tau/ui/extensions/board.editor.container/ui.extension.board.editor.container.tabs",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n=function(e,t){this.tabHeaderClass=e,this.setStateCustomAction=t};return n.prototype.setState=function(e,t,i,n){var a=i.getBoardAccessService().isEditable(t,i.getLoggedUser());e.toggleClass(this.tabHeaderClass,!a),this.setStateCustomAction(e,t,i,n)},i.extend({resetLifecycle:!0,configTab:{limits:{isActive:function(t){return e.some([t.x,t.y],function(e){return e&&"entitystate"===e.types[0]})},setState:function(e,t){e.toggleClass("tau-disabled",!this.isActive(t))}},templates:new n("tau-disabled",t.noop),access:new n("tau-hide",t.noop),customize:new n("tau-hide",function(e,t){var i=t.cells.types.length;e.toggleClass("tau-disabled",!i)}),timeline:new n("tau-hide",function(e,t,i,n){var a=e.hasClass("tau-active"),r="timeline"!==t.viewMode;e.toggleClass("tau-hide",r),r&&a&&n.fire("tab.activate","setup")})},"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i)},"bus afterRenderAll + childrenBuses.ready + show.completed":function(t,i,n){e.each(n,function(e){e.fire("elementInsertedToContainer")
})},"bus afterRender":function(e,t){var i=t.element;this.fire("$el.ready",i)},"bus $el.ready":function(e,i){var n=this;i.on("click",".i-role-tabheader:not(.tau-disabled)",function(){n.fire("tab.activate",t(this).data("label"))}),i.on("click",".tau-settings-close",function(){n.fire("settings.close",t(this).data("label"))})},"bus boardSettings.ready:last + settings.close":function(e,t){var i=this;t.boardSettings.get({fields:["edit"],callback:function(e){e.edit&&0===e.cells.types.length?i.fire("boardSettings.cardSetIsEmpty"):t.boardSettings.set({set:{edit:!1}})}})},"bus $el.ready:last + tab.activate":function(e,t,i){var n=t.find(".i-role-tab"),a=n.filter("[data-label="+i+"]:not(.tau-active)"),r=t.find(".i-role-tabheaders .i-role-tabheader"),s=r.filter("[data-label="+i+"]:not(.tau-active)");a.length&&s.length&&(n.not(a).removeClass("tau-active"),a.addClass("tau-active"),r.not(s).removeClass("tau-active"),s.addClass("tau-active"),this.fire("tab.activate.completed",i))},"bus configurator.ready + componentsCreated":function(i,n){t.when(n.getComponentBusRegistry().getByName("board_editor"),n.getComponentBusRegistry().getByName("board_templates")).done(e.bind(function(e,t,i){var n={setup:e,templates:t,limits:i};this.fire("tabBusesInternal.ready",n)},this));var a=n.getConfig("tmpBoardIsJustAdded",!1);n.setConfig("tmpBoardIsJustAdded",!1),a?(this.fire("tab.activate","templates"),this.fire("justAdded.opened")):this.fire("alreadyAdded.opened")},"bus $el.ready + tabBusesInternal.ready":function(e,t,i){i.templates.on("item.selected",function(){t.parent().toggleClass("tau-full-cell-settings",!1),i.templates.fire("external.setFocusOnSelected")}),i.templates.on("item.selected.completed",function(){i.setup.fire("refresh")});var n=this;i.templates.on("setup.pressed",function(){n.fire("tab.activate","setup")})},"bus tabBusesInternal.ready:last + tab.activate.completed + justAdded.opened":function(e,t){t.templates.once("afterRender",function(){t.templates.fire("external.selectDefault"),t.templates.fire("confirmation.toggle",!1)
}),t.templates.fire("external.selectDefault"),t.templates.fire("confirmation.toggle",!1)},"bus tabBusesInternal.ready:last + tab.activate.completed":function(e,t,i){"templates"==i&&(t.templates.fire("external.selectNone"),t.templates.fire("confirmation.toggle",!0))},"bus view.dom.ready:last + $el.ready:last + childrenBuses.ready:last + tab.activate.completed + configurator.ready:last":function(e,t,i,n,a){var r=i.parent();r.toggleClass("tau-full-cell-settings","templates"==a||"encoding"==a),r.toggleClass("tau-access","access"==a),r.toggleClass("tau-customize","customize"==a),n[a].fire("show")},"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus configurator.ready + $el.ready + boardSettings.ready":function(i,n,a,r){var s=a.find(".i-role-tabheader"),o=e.bind(function(i){s.each(e.bind(function(e,a){var r=t(a),s=r.data("label");this.configTab[s]&&this.configTab[s].setState(r,i,n,this)},this))},this),l=r.boardSettings,u=function(){l.get({fields:["x","y","cells","ownerIds","viewMode"],callback:o})};u(),l.unbind({listener:this}),l.bind({fields:["x","y","cells","ownerIds","viewMode"],listener:this,callback:u})}})}),define("tau/ui/templates/board.editor.container/ui.template.board.editor.container",["tau/core/templates-factory","tau/nls/translator"],function(e,t){var i={name:"board.editor.container",engine:"jqote2",markup:["<% var features = this.context.configurator.getFeaturesService(); %>",'<div class="tau-board-settings" id="<%= _.uniqueId(\'boardSettings\') %>">','<div class="tau-board-settings-header i-role-tabheaders" role="toolbar">','<ul class="tau-board-settings-groups-tags i-role-tabheaders">','<li class="i-role-tabheader tau-extension-board-tooltip" data-label="templates" data-title="Create a View from template">Templates</li>','<li class="tau-active i-role-tabheader tau-extension-board-tooltip" data-label="setup" data-title="Change View setup">Setup</li>','<li class="i-role-tabheader tau-extension-board-tooltip" data-label="access" data-title="Change View permissions">Access</li>','<li class="tau-extension-board-tooltip tau-disabled tau-extension-board-tooltip i-role-tabheader"','data-label="limits" data-collapsed-selector=".i-role-tabheader:not(.tau-active)" data-expanded-selector=".i-role-tabheader.tau-disabled"','data-title-expanded="'+t("You need to set States as a horizontal or vertical lane to activate this tab")+'"','data-title-collapsed="'+t("Set limits to work in progress")+'">Limits</li>','<li class="i-role-tabheader tau-extension-board-tooltip" data-label="prioritization" data-title="Turn prioritization on/off">Prioritize</li>','<li class="tau-extension-board-tooltip tau-disabled tau-extension-board-tooltip i-role-tabheader" ','data-label="customize" ','data-collapsed-selector=".i-role-tabheader:not(.tau-active)" ','data-expanded-selector=".i-role-tabheader.tau-disabled" ','data-title-collapsed="Change the look of cards in the View"','data-title-expanded="'+t("You need to make a selection of the card types to activate this tab")+'">Customize Cards</li>','<li class="tau-extension-board-tooltip tau-extension-board-tooltip i-role-tabheader" data-label="timeline" data-title="Set timeline options">Timeline</li>',"</ul>",'<button role="close-settings" class="tau-btn tau-settings-close" type="button">'+t("Finish setup")+"</button>","</div>",'<div class="i-role-tab tau-board-settings-group tau-active" role="editor" data-label="setup"></div>','<div class="i-role-tab tau-board-settings-group" role="templates" data-label="templates"></div>','<div class="i-role-tab tau-board-settings-group" role="access" data-label="access"></div>','<div class="i-role-tab tau-board-settings-group" role="limits" data-label="limits"></div>','<div class="i-role-tab tau-board-settings-group" role="prioritization" data-label="prioritization"></div>','<div class="i-role-tab tau-board-settings-group" role="customize" data-label="customize"></div>','<div class="i-role-tab tau-board-settings-group" role="encoding" data-label="encoding"></div>','<div class="i-role-tab tau-board-settings-group" role="timeline" data-label="timeline"></div>',"</div>"]};
return e.register(i)}),define("tau/components/component.board.editor.container",["Underscore","tau/components/component.container","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.editor.container/ui.extension.board.editor.container.view","tau/ui/extensions/board.editor.container/ui.extension.board.editor.container.tabs","tau/core/extension.base","tau/ui/templates/board.editor.container/ui.template.board.editor.container"],function(e,t,i,n,a,r,s){return{create:function(r){var o=(r.context.configurator.getFeaturesService(),{extensions:[i,a].concat(r.extensions||[]),ViewType:n,template:s,children:e.compact([{type:"board.owner",selector:"[role=toolbar]"},{type:"board.editor.access",visible:!1,layout:"replaceable",label:"access",selector:"[role=access]"},{name:"board_editor_tab_templates",type:"board.container",layout:"replaceable",visible:!1,spinner:!1,useAnimation:!1,selector:"[role=templates]",label:"templates",children:[{name:"board_templates",type:"board.templates.selector"}]},{name:"board_editor_tab_editor",type:"board.container",layout:"replaceable",visible:!0,spinner:!1,useAnimation:!1,selector:"[role=editor]",label:"setup",children:[{name:"board_editor",type:"board.editor"}]},{type:"board.editor.remember.context",selector:"[role=editor]",childrenContainerSelector:".i-role-output"},{name:"board_editor_tab_limits",type:"board.limits",layout:"replaceable",visible:!1,spinner:!1,useAnimation:!1,selector:"[role=limits]",label:"limits"},{name:"board_editor_tab_prioritization",type:"board.container",layout:"replaceable",visible:!1,spinner:!1,useAnimation:!1,selector:"[role=prioritization]",label:"prioritization",children:[{name:"board_editor_prioritization",type:"board.editor.prioritization"}]},{name:"board_editor_tab_customize",type:"board.container",layout:"replaceable",visible:!1,spinner:!1,useAnimation:!1,selector:"[role=customize]",label:"customize",children:[{name:"board_editor_customize",type:"board.editor.customize"}]},{name:"board_editor_tab_encoding",type:"board.container",layout:"replaceable",visible:!1,spinner:!1,useAnimation:!1,selector:"[role=encoding]",label:"encoding",children:[{name:"board_editor_encoding",type:"board.editor.encoding"}]},{name:"board_editor_tab_timeline",type:"board.container",layout:"replaceable",visible:!1,spinner:!1,useAnimation:!1,selector:"[role=timeline]",label:"timeline",children:[{name:"board_editor_timeline",type:"board.editor.timeline"}]}])});
return t.create(e.extend(r,o))}}}),define("tau/components/extensions/component.sharedBus.extension",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){var i=/^(public\.|parent\.)(.+)/i,n=/^(public\.)(.+)/i;return t.extend({"bus beforeComponentsInitialize":function(t,i){var n=e.pluck(i,"component");this.wrapChildrenBuses(n),this.wrapOwnBus(n)},wrapChildrenBuses:function(t){var n=this;return e.each(t,e.bind(function(a){a.originalFire=a.fire,a.fire=function(r){var s=i.exec(r);if(null!=s)switch(s[1]){case"public.":n.fire.apply(n,arguments),e.each(t,function(e){e!==a&&e.originalFire.apply(e,arguments)});break;case"parent.":var o=Array.prototype.slice.call(arguments,0);o[0]="child."+a.name+"."+s[2],n.fire.apply(n,o)}a.originalFire.apply(a,arguments)}},this)),n},wrapOwnBus:function(t){var i=this.bus,a=i.fire;i.firePublicToChildren=function(){var i=arguments;e.each(t,function(e){e.originalFire.apply(e,i),e.firePublicToChildren&&e.firePublicToChildren.apply(e,i)})},i.fire=function(e){var t=n.exec(e);if(null!=t){var r=Array.prototype.slice.call(arguments,0);r[0]="public."+t[2],i.firePublicToChildren.apply(i,r)}a.apply(i,arguments)}}})}),define("tau/components/component.container.with-shared-events",["Underscore","tau/components/component.container","tau/components/extensions/component.sharedBus.extension"],function(e,t,i){return{create:function(n){return n.extensions=e.concat([n.extensions,i]),t.create(n)}}}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.board",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.board",engine:"jqote2",markup:['<div class="tau-board-layout-cards-module i-role-module-customize" >','<div class="tau-board-layout-compositor tau-board-layout-compositor_cards-compositor"></div>','<div class="tau-board-layout-components-set"></div>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.base",["jQuery","Underscore","tau/core/class","tau/ui/templates/board.plus/customized/ui.template.boardplus.card.section.customized"],function(e,t,i,n){var a=function(e,i,n){if(i=i.trim().toLowerCase(),0===i.length)return n;
var a=i.split(/\s+/i),r=(e||"").toLowerCase();return a.length>0&&t.all(a,function(e){return r.indexOf(e)>=0})};return e.expr[":"].searchText=function(e,t,i){var n=i[3],r=e.textContent||e.innerText;return a(r,n,!0)},i.extend({MAX_SECTION:10,CLASS_MAP:{ACTIVE:"tau-is-active",DISABLED:"tau-is-disabled",DROP_ZONE:"tau-is-drop-zone",CARD:"tau-card-v2",CLOSE_BUTTON:"tau-board-layout-close",EDITOR:"tau-board-layout-customizer",NOT_DROP:"tau-not-drop",DND_IN_PROGRESS:"tau-card-v2__dnd_inprogress",CARD_SECTION:"tau-card-v2__section",CARD_SECTION_REMOVER:"tau-card-v2__section_remover",BOARD_UNIT:"tau-board-unit",BOARD_UNIT_MAX_FORMAT:"tau-board-unit_format_max",BOARD_UNIT_ALIGNMENT_BASE:"tau-board-unit_alignment_base",BOARD_UNIT_ALIGNMENT_ALT:"tau-board-unit_alignment_alt",BOARD_UNIT_ALIGNMENT_BASE_LAST:"tau-board-unit_alignment_base-last",BOARD_UNIT_ALIGNMENT_ALT_LAST:"tau-board-unit_alignment_alt-last",BOARD_UNIT_DND_SOURCE:"tau-board-unit_dnd_source",BOARD_UNIT_DND_HELPER:"tau-board-unit_dnd_helper",BOARD_UNIT_DND_PROXY:"tau-board-unit_dnd_proxy",BOARD_UNIT_DND_PROXY_HIDE:"tau-board-unit_dnd_proxy_hide",BOARD_UNIT_DND_PRE_INSERT:"tau-board-unit_dnd_pre-insert",BOARD_UNIT_MAXIMIZED:"tau-board-unit_maximized",BOARD_UNIT_DND_NOT_DROP:"tau-board-unit_dnd_not-drop",LAYOUT_ELEMENTS_LIST:"tau-board-layout-elements-list",LAYOUT_ELEMENTS_LIST_ITEM:"tau-board-layout-elements-list__item",LAYOUT_ELEMENTS_LIST_ITEM_NAME:"tau-board-layout-elements-list__item-name",LAYOUT_COMPOSITOR:"tau-board-layout-compositor",LAYOUT_COMPOSITOR_SUBJECT:"tau-board-layout-compositor__subject",LAYOUT_COMPOSITOR_CANVAS_INCREASER:"tau-board-layout-compositor_cards-compositor__card-space-increaser",LAYOUT_COMPOSITOR_CANVAS_INCREASER_DISABLED:"tau-board-layout-compositor_cards-compositor__card-space-increaser_disabled",LAYOUT_COMPONENTS_SET:"tau-board-layout-components-set",LAYOUT_COMPONENTS_SET_ITEM_LIST:"tau-board-layout-components-set__items-list",LAYOUT_COMPONENTS_SET_ITEM:"tau-board-layout-components-set__item",LAYOUT_COMPONENTS_SET_ITEM_HIDE_BY_SEARCH:"tau-item-hide-by-search",LAYOUT_COMPONENTS_SET_ITEM_NAME:"tau-board-layout-components-set__item-name"},getUnitLineNumber:function(e){return e.data("sections")
},setPositionCross:function(e,t,i){e.css({left:t.left+i-3,top:t.top-4})},appendToSection:function(e,t){e.appendTo(t)},getLayoutCompositor:function(e){return e.find("."+this.CLASS_MAP.LAYOUT_COMPOSITOR)},initializeScroll:function(){},setOptionScroll:function(){},destroyScroll:function(){},addDraggableClasses:function(e){e.removeClass(this.CLASS_MAP.BOARD_UNIT_DND_SOURCE).addClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY)},getPlaceholder:function(e){return e.find("."+this.CLASS_MAP.BOARD_UNIT_DND_PROXY)},enableUnitInCard:function(e){e.removeClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY+" "+this.CLASS_MAP.BOARD_UNIT_DND_PRE_INSERT).addClass(this.CLASS_MAP.BOARD_UNIT_DND_SOURCE).show()},insertAfterUnit:function(e,t){e.after(t)},insertBeforeUnit:function(e,t){e.before(t)},getUnitHolder:function(e){return e.closest("."+this.CLASS_MAP.BOARD_UNIT)},isOverUnit:function(e){return e.hasClass(this.CLASS_MAP.BOARD_UNIT_DND_SOURCE)&&!e.hasClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY)&&!e.closest("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET).length&&!e.closest("."+this.CLASS_MAP.CARD_SECTION).hasClass(this.CLASS_MAP.NOT_DROP)},allowToDrop:function(e){return!e.hasClass(this.CLASS_MAP.NOT_DROP)&&e.parents("."+this.CLASS_MAP.LAYOUT_COMPOSITOR).length},isSectionCardElement:function(e){return e.hasClass(this.CLASS_MAP.CARD_SECTION)},getUnit:function(e){return e},isMultipleLineUnit:function(e){return e.data("sections")>1},isDoubleLineUnit:function(e){return 2==e.data("sections")},isStretchableUnit:function(e){return 1===e.data("sections")&&e.data("isStretchable")===!0},removeFromSection:function(e){this.resetSectionStyles(e.parent(),e),e.remove()},setSectionStyles:function(e,t){var i=this.getUnitLineNumber(t);2==i?e.addClass("tau-card-v2__section_double"):3==i&&e.addClass("tau-card-v2__section_triple")},resetSectionStyles:function(e,t){this.isMultipleLineUnit(t)&&e.removeClass("tau-card-v2__section_double tau-card-v2__section_triple")},insertSectionToCard:function(e){return n.get().bind({},{section:[]}).appendTo(this.getCard(e))
},getIncreaser:function(e){return e.find(".i-role-increaser")},disableIncreaser:function(e){return e.addClass(this.CLASS_MAP.LAYOUT_COMPOSITOR_CANVAS_INCREASER_DISABLED)},enableIncreaser:function(e){return e.removeClass(this.CLASS_MAP.LAYOUT_COMPOSITOR_CANVAS_INCREASER_DISABLED)},getCard:function(e){return e.find("."+this.CLASS_MAP.CARD)},getSections:function(e){return e.find("."+this.CLASS_MAP.CARD_SECTION)},setAlignment:function(e,t){e.toggleClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_ALT,!t).toggleClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE,t),e.data("alignment",t?"base":"alt")},isAvailableSpaceOnSection:function(t,i){if(this.isStretchableUnit(i))return this.isAvailableSpaceForStretchableUnit(t,i);if(i.hasClass(this.CLASS_MAP.BOARD_UNIT_MAX_FORMAT)){var n=this.getUnitLineNumber(i);return n>1?this.isAvailableSpaceForMultipleUnit(t,n):!t.children().filter(":not("+this.getUnitTypeSelector(i)+")").length}var a=t.width(),r=t.width(),s=i.outerWidth(!0),o=this;return t.children().filter(":not("+this.getUnitTypeSelector(i)+")").each(function(){r-=o.isStretchableUnit(e(this))?a/2:e(this).outerWidth(!0)}),r>=s},isAvailableSpaceForMultipleUnit:function(t,i){var n=t.find(".tau-board-unit:not(."+this.CLASS_MAP.BOARD_UNIT_DND_PROXY+")").length>0;if(n)return!1;var a=function(e,i){for(var n=0,a=e.call(t,"."+i.CLASS_MAP.CARD_SECTION);a.length>0&&0===a.find(".tau-board-unit:not(."+i.CLASS_MAP.BOARD_UNIT_DND_PROXY+")").length;)n++,a=e.call(a,"."+i.CLASS_MAP.CARD_SECTION);return n},r=a(e().next,this),s=a(e().prev,this);return r+s+1>=i},isAvailableSpaceForStretchableUnit:function(i,n){var a=i.width(),r=t.reduce(i.find("."+this.CLASS_MAP.BOARD_UNIT),function(t,i){var a=e(i);return a.data("unitId")==n.data("unitId")?t:t+a.outerWidth(!0)},0);return a-r>a/2},disableUnitInLibrary:function(e,t){var i=this.getUnitTypeSelector(e);i&&t.find(i).parent().addClass(this.CLASS_MAP.DISABLED).removeClass(this.CLASS_MAP.ACTIVE)},enableUnitInLibrary:function(e,t){var i=this.getUnitTypeSelector(e);i&&t.find(i).parent().removeClass(this.CLASS_MAP.DISABLED+" "+this.CLASS_MAP.ACTIVE)
},activateUnitInLibrary:function(t,i){var n=this.getUnitTypeSelector(t),a=e("<div/>");return n&&(a=i.find(n).parent().removeClass(this.CLASS_MAP.DISABLED).addClass(this.CLASS_MAP.ACTIVE)),this.searchInLibrary(i),a},checkAvailableSpaceOnCard:function(i,n,a){return t.reduce(i.filter(":visible"),t.bind(function(t,i){return t||this.isAvailableSpaceOnSection(e(i),n,a)},this),!1)},getUnitTypeSelector:function(e){var t=e.data("unitId");return t&&"[data-unit-id ="+t+"]"||""},hidePlaceholder:function(e){e.hide()},showPlaceholder:function(e){e.show()},showPlaceholderOutLibrary:function(e){this.showPlaceholder(e)},getCloseCross:function(e){return e.find("."+this.CLASS_MAP.CLOSE_BUTTON)},searchInLibrary:function(e,t){if(!t){var i=e.find(".tau-in-text");t=i.val()}var n=e.find("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET_ITEM_LIST),a=e.find(".tau-empty-placeholder");e.find("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET_ITEM_NAME+":searchText("+t+")").parent().removeClass(this.CLASS_MAP.LAYOUT_COMPONENTS_SET_ITEM_HIDE_BY_SEARCH),e.find("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET_ITEM_NAME+":not(:searchText("+t+"))").parent().addClass(this.CLASS_MAP.LAYOUT_COMPONENTS_SET_ITEM_HIDE_BY_SEARCH);var r=n.find("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET_ITEM).not(".tau-item-hide-by-search").not("."+this.CLASS_MAP.DISABLED);a.toggleClass("tau-item-hide",r.length>0)},highlightUnitsOnCard:function(i,n){var r=i.find(".tau-board-unit");r.removeClass("tau-board-unit_highlighted"),t.each(r,function(t){var i=e(t);a(i.attr("title"),n)&&i.addClass("tau-board-unit_highlighted")})},preInsertUnitOnCard:function(i,n,a){var r,s=t.find(n.filter(":visible"),t.bind(function(t){return this.isAvailableSpaceOnSection(e(t),i,a)},this));if(s){var o=e(s);this.setSectionStyles(o,i),r=i.clone().addClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY+" "+this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE+" "+this.CLASS_MAP.BOARD_UNIT_DND_PRE_INSERT).removeClass(this.CLASS_MAP.BOARD_UNIT_DND_SOURCE),this.hidePlaceholder(r),this.setAlignment(r,!0);var l=a.find("[data-unit-id="+r.data("unitId")+"]");
this.handleDragOverStretchableUnit(r,o,this.getUnitOuterWidthWithMargin(l)),o.append(r)}else r=e("<div/>").remove(),r.length=0;return r},handleDragOverStretchableUnit:function(i,n,a){var r=null,s=this.isStretchableUnit(i);if(s)r=i;else{var o=t.find(n.children(),function(t){return this.isStretchableUnit(e(t))},this);r=o?e(o):null}if(r){var l=i.parent()[0]==n[0],u=i.width()>0?this.getUnitOuterWidthWithMargin(i):a;this.setWidthForStretchable(r,n,-1*(l||s?0:u))}},getStretchableSelector:function(){return'[data-sections="1"][data-is-stretchable="true"]'},getUnitMargin:function(e){return parseInt(e.css("margin-left"))+parseInt(e.css("margin-right"))},getUnitOuterWidth:function(e){return e[0].getBoundingClientRect().width},getUnitOuterWidthWithMargin:function(e){return this.getUnitMargin(e)+this.getUnitOuterWidth(e)},fixLayoutNearStretchable:function(i){t.each(i.find("."+this.CLASS_MAP.CARD_SECTION),function(i){var n=e(i),a=n.find("."+this.CLASS_MAP.BOARD_UNIT),r=t.find(a,function(t){return this.isStretchableUnit(e(t))},this);if(r){var s=t.filter(a,function(t){var i=e(t);return!this.isStretchableUnit(i)&&i.hasClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE)},this);if(s.length>0){var o=s[s.length-1];e(o).addClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE_LAST)}var l=n.find("."+this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_ALT+":last");l&&l.addClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_ALT_LAST)}},this)},freezeStretchableUnits:function(i){t.each(i.find("."+this.CLASS_MAP.BOARD_UNIT),function(t){var i=e(t);i.removeClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE_LAST),i.removeClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_ALT_LAST)},this),t.each(this.getCard(i).find(this.getStretchableSelector()),function(t){var i=e(t);this.setWidthForStretchable(i,i.closest("."+this.CLASS_MAP.CARD_SECTION),0),i.removeClass(this.CLASS_MAP.BOARD_UNIT_MAX_FORMAT)},this)},setWidthForStretchable:function(i,n,a){var r=this.getUnitMargin(i)||4,s=t.reduce(n.find("."+this.CLASS_MAP.BOARD_UNIT),function(t,n){var a=e(n);return a.data("unitId")==i.data("unitId")?t:t+this.getUnitOuterWidthWithMargin(a)
},0,this),o=this.getUnitOuterWidth(n)-s-r+(a?a:0);i.css({"max-width":o,width:o,"margin-left":r/2,"margin-right":r/2}),i.removeClass(this.CLASS_MAP.BOARD_UNIT_MAX_FORMAT)},unfreezeStretchableUnit:function(e){e.css({"max-width":"100%",width:"","margin-left":"","margin-right":""}),e.addClass(this.CLASS_MAP.BOARD_UNIT_MAX_FORMAT)},unfreezeStretchableUnits:function(i){t.each(i.find("."+this.CLASS_MAP.CARD).find("."+this.CLASS_MAP.CARD_SECTION),function(i){var n=e(i),a=n.find("."+this.CLASS_MAP.BOARD_UNIT),r=n.find(this.getStretchableSelector()),s=function(e){n.remove('[data-unit-id="'+e.data("unitId")+'"]')},o=function(e){s(e),n.append(e)},l=function(e){s(e),n.prepend(e)};if(r.length>0){this.unfreezeStretchableUnit(r);var u=this.getSortedUnitsInSection(a),c=t.find(u,function(e){return e.isStretchable}).order;this.appendUnitsNearStretchable(u,c,o,l),this.setClassesNearStretchable(u,c),o(r)}},this)},getSortedUnitsInSection:function(i){var n=[],a=0,r=i.length-1;return t.each(i,function(t){var i=e(t),s=this.isStretchableUnit(i);i.hasClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE)?(n.push({align:"base",unit:i,order:a,isStretchable:s}),a++):(n.push({align:"alt",unit:i,order:r,isStretchable:s}),r--)},this),n},appendUnitsNearStretchable:function(e,i,n){t.each(t.sortBy(e,function(e){return e.order}),function(e){e.order<i&&(this.setAlignment(e.unit,!0),n(e.unit))},this),t.each(t.sortBy(e,function(e){return-1*e.order}),function(e){e.order>i&&(this.setAlignment(e.unit,!1),n(e.unit))},this)},setClassesNearStretchable:function(e,i){var n=function(n,a){var r=t.find(e,function(e){return e.order==i+n});r&&r.unit.addClass(a)};t.each(e,function(e){e.unit.removeClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE_LAST),e.unit.removeClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_ALT_LAST)},this),n(-1,this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE_LAST),n(1,this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_ALT_LAST)}})}),define("tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper",["Underscore","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.base"],function(e,t){return new t
}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dnd",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i,n){return i.extend({init:function(e){this._super(e),this.helper=n},"bus afterRender:last  + child.customize.editor.ready:last + child.customize.library.ready:last":function(e,i){var n=this,a=i.element,r=this.helper,s=r.CLASS_MAP,o=function(e){var t=e.offset(),i=t.left,n=t.left+e.outerWidth(!0),a=function(e){return"."+e+":not(."+s.BOARD_UNIT_DND_PROXY+"):visible:not(."+s.BOARD_UNIT_DND_HELPER+"):last"},r=e.children().filter(a(s.BOARD_UNIT_ALIGNMENT_BASE));r.offset()&&(i=r.offset().left+r.outerWidth(!0));var o=e.children().filter(a(s.BOARD_UNIT_ALIGNMENT_ALT));return o.offset()&&(n=o.offset().left),i+(n-i)/2},l=function(e){var t=e.offset(),i=t.left,n=t.left+e.outerWidth(!0);return i+(n-i)/2},u=a.find("."+s.LAYOUT_COMPONENTS_SET),c=null,d=10,p=function(e){return e.clone().addClass(s.BOARD_UNIT_DND_HELPER).removeClass(s.BOARD_UNIT_DND_SOURCE).css({zIndex:"99999",cursor:"move",outline:"none",width:e.outerWidth(!0)}).removeAttr("title")},f=function(e,t,i){var n=e.style.display||"";document.body.style.cursor=e.style.cursor,e.style.display="none";var a=document.elementFromPoint(t,i);return e.style.display=n,a&&a!=document||(a=document.body),a},m=function(e,t,i){return setTimeout(function(){var n=e.parent(),l=r.isDoubleLineUnit(e),u=t.index()!=n.index();if(l&&u){var c;t.index()>n.index()?(c=t.prev(),c.hasClass(s.NOT_DROP)&&(c=t)):(c=t,c.next().length&&c.next().hasClass(s.NOT_DROP)&&(c=c.prev())),t=c,r.setSectionStyles(t,e)}r.appendToSection(e,t),r.handleDragOverStretchableUnit(e,t),l&&u&&r.resetSectionStyles(n,e);var d=o(t)>i;r.setAlignment(r.getPlaceholder(a),d)},d)},h=function(e,t,i){return setTimeout(function(){var n=l(r.getUnitHolder(t));t.hasClass(s.BOARD_UNIT_ALIGNMENT_BASE)?(r.setAlignment(e,!0),n>i?r.insertBeforeUnit(t,e):r.insertAfterUnit(t,e)):(r.setAlignment(e,!1),n>i?r.insertAfterUnit(t,e):r.insertBeforeUnit(t,e)),r.handleDragOverStretchableUnit(e,t.parent().eq(0))
},d)},g=function(e){var t=r.activateUnitInLibrary(e,u),i=t.outerHeight();if(t.position()){var n=t.position().top,o=a.find("."+s.LAYOUT_COMPONENTS_SET_ITEM_LIST),l=o.height(),c=n+i-o.position().top<0,d=n-i>l;(c||d)&&o.scrollTo(t)}},v=function(e,i){clearTimeout(c);var n=t(f(i.helper[0],e.clientX,e.clientY)),o=r.getPlaceholder(a),l=!n.closest("."+s.NOT_DROP).length,u=t("."+s.BOARD_UNIT_DND_HELPER);u.toggleClass(s.BOARD_UNIT_DND_NOT_DROP,!l),l?u.css("cursor","move"):u.css("cursor","not-allowed");var d=n.closest("."+s.LAYOUT_COMPONENTS_SET).length;d?(g(i.helper),r.resetSectionStyles(o.parent(),o),r.hidePlaceholder(o)):(r.setSectionStyles(o.parent(),o),r.showPlaceholderOutLibrary(o));var p=r.allowToDrop(n),v=p&&r.isSectionCardElement(n);v&&(c=m(o,n,e.pageX));var b=r.getUnitHolder(n);b.length&&(n=b);var y=r.isOverUnit(n);y&&(r.showPlaceholder(o),r.setOptionScroll(a,{point:{x:e.clientX,y:e.clientY}}),c=h(o,r.getUnit(n),e.pageX))},b=function(e,t){a.removeClass(s.DND_IN_PROGRESS);var i=r.getPlaceholder(a);r.destroyScroll(a),r.getSections(a).removeClass(s.NOT_DROP),a.removeClass(s.NOT_DROP);var o=i.is(":visible");o?(r.enableUnitInCard(i),r.disableUnitInLibrary(t.helper,u)):(r.removeFromSection(i),r.enableUnitInLibrary(t.helper,u)),r.unfreezeStretchableUnits(a),n.fire("public.card.changed",r.getCard(a))},y=function(e){r.initializeScroll(a),r.freezeStretchableUnits(a),a.addClass(s.DND_IN_PROGRESS);var i=t(e.currentTarget);a.removeClass(s.NOT_DROP);var n=r.getSections(a);i.closest("."+s.CARD).length?(i.parent().removeClass(s.NOT_DROP),r.addDraggableClasses(i)):(r.checkAvailableSpaceOnCard(n,i,u)||a.addClass(s.NOT_DROP),r.preInsertUnitOnCard(i,n,u)),n.each(function(e,n){var a=t(n);a.toggleClass(s.NOT_DROP,!r.isAvailableSpaceOnSection(a,i,u))})};r.fixLayoutNearStretchable(a),a.off("mouseover.dnd"),a.on("mouseover.dnd","."+s.BOARD_UNIT_DND_SOURCE,function(e){var i=t(e.currentTarget);i.draggable({appendTo:a,addClasses:!1,containment:'[role="customize"]',helper:function(e){var i=t(e.currentTarget);
return p(i)},drag:v,stop:b,start:y})})}})}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dblclick-handler",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper","Underscore"],function(e,t,i,n){return t.extend({init:function(e){this._super(e),this.helper=i},"bus afterRender:last + child.customize.editor.ready:last + child.customize.library.ready:last":function(t,i){var a=i.element,r=this.helper,s=r.CLASS_MAP,o=a.find("."+s.LAYOUT_COMPONENTS_SET),l=r.getCard(a),u=n.bind(function(t){var i=a.find("."+s.CARD_SECTION),n=e(t.currentTarget),u=r.preInsertUnitOnCard(n,i,o);r.unfreezeStretchableUnits(a),u.length&&(r.disableUnitInLibrary(u,o),r.enableUnitInCard(u,!0),r.getLayoutCompositor(a).scrollTo(u),this.fire("public.card.changed",l))},this),c=n.bind(function(t){var i=e(t.currentTarget);r.removeFromSection(i),r.enableUnitInLibrary(i,o),r.unfreezeStretchableUnit(i),r.getCloseCross(a).hide(),this.fire("public.card.changed",l)},this);o.off("dblclick.customize"),o.on("dblclick.customize","."+s.BOARD_UNIT_DND_SOURCE,u),l.off("dblclick.customize"),l.on("dblclick.customize","."+s.BOARD_UNIT_DND_SOURCE,c)}})}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.remove",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i){return t.extend({init:function(e){this._super(e),this.helper=i},"bus afterRender:last + child.customize.editor.ready:last + child.customize.library.ready:last":function(t,i,n,a){function r(e){var t=c.data("unit-id");return e.find('[data-unit-id="'+t+'"]')}var s=this,o=this.helper,l=n.element,u=a.element,c=o.getCloseCross(l);l.on("mouseenter",".tau-board-unit_dnd_source",function(){if(window.clearTimeout(d),!i.element.hasClass(o.CLASS_MAP.DND_IN_PROGRESS)){e(this).addClass("tau-board-unit_hovered");var t=e(this).position(),n=e(this).outerWidth();
c.data("unit-id",e(this).data("unit-id")),o.setPositionCross(c,t,n),c.show()}});var d;l.on("mouseleave",".tau-board-unit_dnd_source",function(){e(this).removeClass("tau-board-unit_hovered"),d=window.setTimeout(function(){c.hide()},10)}),l.on("dragstart",".tau-board-unit_dnd_source",function(){e(this).removeClass("tau-board-unit_hovered"),c.hide()}),c.on("mouseenter",function(){var t=r(e(this).parent());t.addClass("tau-board-unit_hovered"),window.clearTimeout(d)}),c.on("mouseleave",function(){var t=r(e(this).parent());t.removeClass("tau-board-unit_hovered"),c.hide()}),c.on("click",function(){var t=r(e(this).parent());o.removeFromSection(t),r(u).parent().removeClass("tau-is-disabled"),c.hide(),s.fire("public.card.changed",o.getCard(l))})}})}),define("tau/models/board.editor.customize/model.board.editor.customize.base",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i,n){return i.extend({saveSettings:function(t,i,n,a){var r=this.getType(i);return t.get({fields:["cardSettings"]}).then(function(i){var s=i.cardSettings,o=s&&s[r]&&s[r][n];if(e.isEqual(o,a))return{};var l=s||{};return a?(l[r]||(l[r]={}),l[r][n]=a):delete l[r][n],t.set({set:{cardSettings:l}})},this)},"bus public.listSizes.changed:last + public.types.changed:last + public.card.changed + boardSettings.ready:last":function(i,a,r,s,o){var l=o.boardSettings,u=this.getCustomizeSection(s),c=e.map(u,function(i){return e.map(t(i).find("."+n.CLASS_MAP.BOARD_UNIT),function(e){var i=t(e);return{id:i.data("unit-id"),alignment:i.data("alignment")}})});this.fire("public.settings.saved",this.saveSettings(l,r,a.size,c))},"bus public.listSizes.changed:last + public.types.changed:last + boardSettings.ready:last + public.resetToDefault":function(t,i,n,a){var r=a.boardSettings;this.saveSettings(r,n,i.size,null).then(e.bind(function(){this.fire("public.types.changed",n)},this))}})}),define("tau/models/board.editor.customize/model.board.editor.customize.board",["Underscore","jQuery","tau/models/board.editor.customize/model.board.editor.customize.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i,n){return i.extend({getType:function(e){return e[0]
},getCustomizeSection:function(e){return e.find("."+n.CLASS_MAP.CARD_SECTION)}})}),define("tau/components/component.board.editor.customize.board",["Underscore","tau/components/component.container.with-shared-events","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.board","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dnd","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dblclick-handler","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.remove","tau/models/board.editor.customize/model.board.editor.customize.board","tau/core/helpers/extension.configurator"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){var c={extensions:[l,a,r,s,n,o].concat(u.extensions||[]),template:i};return c.layout="selectable",c.children=[{type:"board.editor.customize.types",name:"customize.types",selector:".tau-board-layout-compositor"},{type:"board.editor.customize.editor",name:"customize.editor",selector:".tau-board-layout-compositor"},{type:"board.editor.customize.library.board",name:"customize.library",selector:".tau-board-layout-components-set"}],t.create(e.extend(u,c))}}}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.section",["tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t){var i={name:"board.editor.customize.editor.section",engine:"jqote2",customFunctions:{getSectionAdditionalClass:t.getClassForCustomizeSection},markup:["<% var configurator = this.configurator; %>",'<div class="tau-card-v2__section <%=fn.getSectionAdditionalClass(this.section)%>">',"<%this.section.forEach(function(item){%>",'<%= fn.sub(item.unit.getTemplateName("card"), [{settings:item.unit.settings,data:item.unit.sampleData,configurator:configurator}])%>',"<%});%>","</div>"],dependencies:[]};return e.register(i)}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor",["tau/core/templates-factory","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.section"],function(e){var t={name:"board.editor.customize.editor",engine:"jqote2",markup:["<div>","<%if (this.size && this.type) {%>",'<div class="tau-ui-size-<%=this.size%>">','<div class="tau-board-layout-compositor__canvas">','<div class="tau-board-layout-compositor__subject tau-card-v2 tau-card-v2_type_<%=this.type%>">','<div class="tau-board-layout-close"></div>',"<% var configurator = this.configurator; %>","<% this.cardLayout.forEach(function(section) {%>",'<%= fn.sub("board.editor.customize.editor.section", {section: section, configurator: configurator}) %>',"<% }); %>","</div>","<% if(this.isShowIncreaser) {%>",'<button type="button" class="tau-board-layout-compositor_cards-compositor__card-space-increaser <%if(this.isDisabledIncreaser){%>tau-board-layout-compositor_cards-compositor__card-space-increaser_disabled<%};%> i-role-increaser">+</button>',"<% };%>","</div>","</div>",'<button style="margin-top: 20px" <%= this.isDefaultSettings?"disabled":""%> class="tau-btn  i-role-reset">Reset to default</button>',"<%};%>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/models/board.editor.customize/model.board.editor.customize.editor",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(){this.fire("dataBind",{})},"bus configurator.ready:last + layout.changed":function(e,t,i){this.refreshLayout(t,i)},refreshLayout:function(t,i){i.configurator=t,i.cardLayout=e.map(i.cardLayout,function(t){return e.map(t,function(t){var i=e.clone(t.unit);return i.settings={classes:["dnd_source","maximized"],isDesignMode:!0,metaData:{id:t.id,title:i.name,alignment:t.alignment}},t.unit=i,t})}),this.fire("refreshData",i)}})}),define("tau/models/board.editor.customize/model.board.editor.customize.settings",["Underscore","jQuery","tau/core/extension.base","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n){return i.extend({"bus public.listSizes.changed:last + public.types.changed:last + cardLayoutFactory.ready:last":function(e,t,i,n){this.layoutChanged(t.size,i,n)},"bus public.listSizes.changed:last + public.types.changed:last + cardLayoutFactory.ready:last + acidChanged":function(e,t,i,n){this.layoutChanged(t.size,i,n)},_getLayout:function(t,i,a){var r=i[0];t.getCardLayoutByTypeAndSize(r,a).done(e.bind(function(e){var t=e.length;this.fire("layout.changed",{cardLayout:e,type:r,types:i,size:a,isDefaultSettings:!e||e.isDefault,isShowIncreaser:a==n.XL||a==n.L,isDisabledIncreaser:t>=10})},this))},layoutChanged:function(e,t,i){t=t||[],n.has(e)&&t.length&&this._getLayout(i,t,e)}})}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.resizer-card",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i){return t.extend({"bus elementRefreshedWithData":function(t,n){var a=n.data;if(a.isShowIncreaser){var r=n.element,s=i.getIncreaser(r),o=function(){i.insertSectionToCard(r),this.fire("public.card.changed",i.getCard(r)),i.MAX_SECTION==i.getSections(r).length&&i.disableIncreaser(s)
}.bind(this),l=function(t){var n=e(t.currentTarget),a=r.closest("."+i.CLASS_MAP.EDITOR);0!==n.children().length||1===i.getSections(r).length||a.hasClass(i.CLASS_MAP.DND_IN_PROGRESS)||n.addClass(i.CLASS_MAP.CARD_SECTION_REMOVER)},u=function(t){e(t.currentTarget).removeClass(i.CLASS_MAP.CARD_SECTION_REMOVER)},c=function(t){e(t.currentTarget).remove(),this.fire("public.card.changed",i.getCard(r)),i.MAX_SECTION>i.getSections(r).length&&i.enableIncreaser(s)}.bind(this),d=i.getCard(r);d.off("mouseover.decreaser"),d.off("mouseout.decreaser"),d.off("click.decreaser"),d.on("mouseover.decreaser","."+i.CLASS_MAP.CARD_SECTION,l),d.on("mouseout.decreaser","."+i.CLASS_MAP.CARD_SECTION,u),d.on("click.decreaser","."+i.CLASS_MAP.CARD_SECTION_REMOVER,c),s.off("click.increaser"),s.on("click.increaser",o)}}})}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.reset",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus elementRefreshedWithData":function(t,i){i.element.find(".i-role-reset").click(e.bind(function(){this.fire("public.resetToDefault")},this))},"bus elementRefreshedWithData:last + public.card.changed":function(e,t){t.element.find(".i-role-reset").prop("disabled",!1)}})}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.editor",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i){return t.extend({"bus elementRefreshedWithData":function(e,t){this.fire("parent.ready",t)},"bus elementRefreshedWithData:last + public.searchText.changed":function(e,t,n){i.highlightUnitsOnCard(t.element,n)}})}),define("tau/ui/extensions/customizedLayout/ui.extension.customizedLayout.cardLayout.factory",["Underscore","tau/core/extension.base","tau/services/customize/service.customize.card.layout.factory"],function(e,t,i){return t.extend({"bus configurator.ready:last + boardSettings.ready":function(e,t,n){var a=new i(t,n.boardSettings);
this.fire("cardLayoutFactory.ready",a)}})}),define("tau/components/component.board.editor.customize.editor",["Underscore","tau/components/component.creator","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor","tau/models/board.editor.customize/model.board.editor.customize.editor","tau/models/board.editor.customize/model.board.editor.customize.settings","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.resizer-card","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.reset","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.editor","tau/core/helpers/extension.configurator","tau/ui/extensions/customizedLayout/ui.extension.customizedLayout.cardLayout.factory"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(e){var c={name:"board.editor.customize.editor",extensions:[a,l,u,r,s,o,n],template:i};return e["queue.bus"]=!0,t.create(c,e)}}}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list.unit-name",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.editor.list.unit-name",engine:"jqote2",markup:['<div class="tau-canvas-board-unit-cell tau-canvas-board-unit-cell_not_dnd tau-canvas-name-cell">','<div class="tau-board-unit-label">','<div class="tau-entity-list">',"<% this.unit.settings.metaData.typesNames.forEach(function(type,index){%>","<% if (index > 0) { %>",'<span class="tau-cap">, </span>',"<% } %>",'<span class="tau-cap tau-text_type_<%= type.typeId%>"><%= type.long%></span>',"<%});%>","</div>","</div>",'<% this.unit.settings.classes = ["type_entity-name_list_canvas"];%>','<div class="tau-board-unit-wrap">','<%= fn.sub(this.unit.getTemplateName("card"), [{settings:this.unit.settings,data:this.unit.sampleData,configurator:this.configurator}])%>',"</div>","</div>"]};return e.register(t)}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list.unit",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.editor.list.unit",engine:"jqote2",markup:['<div data-rank="<%=this.unit.settings.metaData.rank%>" class="tau-canvas-board-unit-cell">','<div class="tau-board-unit-label">',"<%! fn.replaceTermTags(this.unit.settings.metaData.header)%>","<% this.unit.settings.metaData.typesNames.forEach(function(type, index) {%>","<% if(this.unit.settings.metaData.showTypes) {%>",' <span class="tau-entity tau-text_type_<%= type.typeId%>"><%= type.short%></span>',"<%}%>","<%}, this);%>","</div>",'<div class="tau-board-unit-wrap">','<%= fn.sub(this.unit.getTemplateName("card"), [{settings:this.unit.settings,data:this.unit.sampleData,configurator:this.configurator}])%>',"</div>","</div>"]};
return e.register(t)}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list",["tau/core/templates-factory","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list.unit-name","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list.unit"],function(e){var t={name:"board.editor.customize.editor.list",engine:"jqote2",markup:["<div>","<%if (this.size && this.types.length > 0) {%>",'<div class="tau-list-canvas">',"<% this.cardLayout.forEach(_.bind(function(item, index) { %>","<%if(index === 0){%>",'<%= fn.sub("board.editor.customize.editor.list.unit-name", [{unit:item.unit,configurator:this.configurator}])%>',"<%} else {%>",'<%= fn.sub("board.editor.customize.editor.list.unit", [{unit:item.unit,configurator:this.configurator}])%>',"<%}%>","<% }, this)); %>",'<div class="tau-board-layout-close"></div>',"</div>","<%};%>","</div>"],dependencies:[]};return e.register(t)}),define("tau/models/board.editor.customize/model.board.editor.customize.editor.list",["Underscore","tau/models/board.editor.customize/model.board.editor.customize.editor","tau/ui/ui.templateFactory","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/utils/utils.customFields.list"],function(e,t,i,n,a){return t.extend({refreshLayout:function(t,r){r.configurator=t;var s=i.getTermProcessor(),o=n.orderListUnits(r.cardLayout);r.cardLayout=e.map(o,function(t){var i=e.clone(t.unit),n=e.intersection(r.types,e.chain(i.settings).pluck("types").flatten().value()),o=a.getListHeader(void 0!==i.header?i.header:i.name);return i.settings={classes:["dnd_source","maximized"],isDesignMode:!0,metaData:{id:t.id,rank:t.rank,title:i.name,header:o,alignment:t.alignment,typesNames:e.map(n,function(e){return{"long":s.getTerm(e,"names"),"short":s.getTerm(e,"iconSmall"),typeId:e}}),showTypes:r.types.length>n.length}},t.unit=i,t}),this.fire("refreshData",r)}})}),define("tau/models/board.editor.customize/model.board.editor.customize.settings.list",["Underscore","jQuery","tau/models/board.editor.customize/model.board.editor.customize.settings","tau/models/board.customize.units/const.card.sizes"],function(e,t,i){return i.extend({_getLayout:function(t,i,n){t.getLayoutFactory().then(function(t){var a=e.flatten(e.toArray(t(i))),r=e.chain(a).uniq(function(e){return e.id
}).value();this.fire("layout.changed",{cardLayout:r,isDefaultSettings:!a||a.isDefault,types:i,size:n})}.bind(this))}})}),define("tau/services/customize/service.customize.card.layout.factory.newlist.customizeCards",["jQuery","Underscore","tau/services/customize/service.customize.card.layout.factory.newlist"],function(e,t,i){return i.extend({_replaceShortUnitsWithLong:function(e){return e}})}),define("tau/ui/extensions/board.customize/extension.new.list.cardLayout.customize",["Underscore","tau/core/extension.base","tau/services/customize/service.customize.card.layout.factory.newlist.customizeCards"],function(e,t,i){return t.extend({"bus configurator.ready:last + boardSettings.ready":function(e,t,n){this.fire("cardLayoutFactory.ready",new i(t,n.boardSettings))}})}),define("tau/components/component.board.editor.customize.editor.list",["Underscore","tau/components/component.creator","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list","tau/models/board.editor.customize/model.board.editor.customize.editor.list","tau/models/board.editor.customize/model.board.editor.customize.settings.list","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.editor","tau/core/helpers/extension.configurator","tau/ui/extensions/board.customize/extension.new.list.cardLayout.customize"],function(e,t,i,n,a,r,s,o){return{create:function(e){var l={name:"board.editor.customize.editor.list",extensions:[a,s,o,r,n],template:i};return e["queue.bus"]=!0,t.create(l,e)}}}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize",engine:"jqote2",markup:['<div class="tau-board-layout-customizer">','<div class="tau-board-layout-customize-hint"></div>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus public.listSizes.changed + afterRender:last":function(e,t,i){var n=i.element;
n.toggleClass("i-role-show-hint",1===t.size)},"bus componentsCreated":function(e,t){this.childrenComponents=_.reduce(t,function(e,t){return e[t.config.name]=t.component,e},{}),this.bindComponents()},bindComponents:function(){this.childrenComponents["customize.sizes"].on("public.listSizes.changed",function(e,t){this.childrenComponents["board.editor.customize.board"]&&this.childrenComponents["board.editor.customize.board"].fire("public.listSizes.changed",t),this.childrenComponents["board.editor.customize.list"]&&this.childrenComponents["board.editor.customize.list"].fire("public.listSizes.changed",t),this.fire("public.listSizes.changed",t)}.bind(this))},init:function(e){this._super(e),this.children={}},"bus afterRenderAll + configurator.ready:last":function(e,t){var i=t.element.find(".tau-board-layout-list-module"),n=t.element.find(".tau-board-layout-cards-module");i.tauCoverView(),n.addClass("tau-board-layout-hide-module")},"bus afterRenderAll:last + public.listSizes.changed + configurator.ready:last + componentsCreated:last":function(e,t,i){var n=t.element.find(".tau-board-layout-list-module"),a=t.element.find(".tau-board-layout-cards-module");"list"===i.size?(n.tauCoverView("show"),a.addClass("tau-board-layout-hide-module")):(n.tauCoverView("hide"),a.removeClass("tau-board-layout-hide-module"))}})}),define("tau/components/component.board.editor.customize",["Underscore","tau/components/component.container","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.customize/ui.extension.board.editor.customize","tau/core/helpers/extension.configurator"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[r,a,n].concat(s.extensions||[]),template:i};return s["queue.bus"]=!0,o.children=[{type:"board.editor.customize.sizes",name:"customize.sizes"},{type:"board.editor.customize.board",name:"board.editor.customize.board"},{type:"board.editor.customize.list",name:"board.editor.customize.list"}],t.create(e.extend(s,o))
}}}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.library",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.library",engine:"jqote2",markup:['<div class="tau-customizer-library">','<div class="tau-board-layout-components-set__filter tau-searchbox">','<input type="text" class="tau-in-text" placeholder="Search" value="<%!this.search%>"><button class="tau-btn tau-search" type="button"></button>',"</div>",'<div class="tau-empty-placeholder tau-board-layout-components-set__item-name<% if (this.units.length) {%> tau-item-hide<%}%>">Nothing found</div></li>','<ul class="tau-board-layout-components-set__items-list">',"<% var configurator = this.configurator; %>","<% _.forEach(this.units, function(item){ %>","<li class=\"tau-board-layout-components-set__item <%= item.visible?'':'tau-is-disabled' %>\">",'<%= fn.sub(item.unit.getTemplateName("card"), [{settings:item.unit.settings, data:item.unit.sampleData, configurator: configurator}]) %>','<div class="tau-board-layout-components-set__item-name"><%= fn.replaceTermTags(item.unit.name) %></div>',"</li>","<% }); %>","</ul>","</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.library",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper"],function(e,t,i,n){return i.extend({_search:function(e){var t=e.val();this.fire("public.searchText.changed",t)},setSearchAndHandler:function(t){var i=this,n=null,a=null,r=t.find(".tau-in-text");r.off("input.search keydown.search");var s=e.bind(function(){clearTimeout(a),n!=r.val()&&(a=setTimeout(e.bind(i._search,this,r),50))},this);this._search(r),r.on("input.search keydown.search",s)},"bus afterRender":function(e,t){this.setSearchAndHandler(t.element)},"bus elementRefreshedWithData":function(e,t){this.setSearchAndHandler(t.element),this.fire("parent.ready",t)
},"bus elementRefreshedWithData:last + public.card.changed":function(e,t){this._search(t.element.find(".tau-in-text"))},"bus elementRefreshedWithData:last + public.searchText.changed":function(e,t,i){n.searchInLibrary(t.element,i)}})}),define("tau/components/component.board.editor.customize.library.base",["Underscore","tau/components/component.creator","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.library","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.library","tau/core/helpers/extension.configurator"],function(e,t,i,n,a){return{create:function(e,r){var s={name:"board.editor.customize.library",extensions:e.extensions.concat([n,a]),template:i};return r["queue.bus"]=!0,t.create(s,r)}}}),define("tau/models/board.editor.customize/model.board.editor.customize.library",["Underscore","jQuery","tau/core/extension.base","tau/ui/ui.templateFactory"],function(e,t,i,n){return i.extend({"bus beforeInit":function(i,n){var a=n.config.context.configurator,r=a.getAppStateStore();this.fire("dataBind",{units:[],search:""});var s=e.bind(function(){var i=a.getUnitsRegistry(),n=a.getCustomFieldsUnitsFactory(),r=n.getAllUnits();t.when(i.units,r).then(e.bind(function(t,i){this.fire("units.ready",e.flatten([e.values(t),i]))},this))},this);s(),r.unbind({listener:this}),r.bind({fields:["acid"],listener:this,callback:function(){this.fire("acidChanged"),s()}.bind(this)})},"bus configurator.ready + destroy":function(e,t){var i=t.getAppStateStore();i.unbind({listener:this})},"bus public.searchText.changed":function(e,t){this.searchText=t},"bus configurator.ready:last + units.ready:last + layout.changed:last":function(t,i,a,r){function s(t,i){return e.any(t.types,function(e){return i.isApplicableByTypeAndSize(e,t.size)})}var o=n.getTermProcessor(),l=e.chain(r.cardLayout).flatten().map(function(e){return[e.id,!0]}).object().value(),u=e.chain(a).filter(function(e){return s(r,e)}).uniq(function(e){return e.id}).sortBy(function(e){return e.name}).sortBy(function(e){return e.priority||-99999
}).map(function(t){var i=e.clone(t),n=e.intersection(r.types,e.chain(i.settings).map(function(e){return e.types}).flatten().value());return i.rank=n.length,i.settings={classes:["dnd_source","maximized"],isDesignMode:!0,metaData:{rank:n.length,id:t.id,title:t.name,header:void 0!==i.header?i.header:i.name,types:n,typesNames:e.map(n,function(e){return{"long":o.getTerm(e,"names"),"short":o.getTerm(e,"iconSmall"),typeId:e}}),showTypes:r.types.length>n.length}},{unit:i,visible:!l[i.id],unitId:i.id}}).value();this.fire("public.unit.readyForLibrary",u),this.fire("refreshData",{units:u,search:this.searchText||"",configurator:i})}})}),define("tau/components/component.board.editor.customize.library.board",["tau/components/component.board.editor.customize.library.base","tau/ui/extensions/customizedLayout/ui.extension.customizedLayout.cardLayout.factory","tau/models/board.editor.customize/model.board.editor.customize.settings","tau/models/board.editor.customize/model.board.editor.customize.library"],function(e,t,i,n){return{create:function(a){var r={name:"board.editor.customize.library.board",extensions:[t,i,n].concat(a.extensions||[])};return e.create(r,a)}}}),define("tau/models/board.editor.customize/model.board.editor.customize.library.list",["Underscore","jQuery","tau/models/board.editor.customize/model.board.editor.customize.library"],function(e,t,i){return i.extend({"bus configurator.ready:last + units.ready:last + layout.changed:last":function(t,i,n,a){var r=e.filter(n,function(e){return e.hideInLibrary!==!0});this._super(t,i,r,a)}})}),define("tau/components/component.board.editor.customize.library.list",["tau/components/component.board.editor.customize.library.base","tau/ui/extensions/board.customize/extension.new.list.cardLayout.customize","tau/models/board.editor.customize/model.board.editor.customize.settings.list","tau/models/board.editor.customize/model.board.editor.customize.library.list"],function(e,t,i,n){return{create:function(a){var r={name:"board.editor.customize.library.list",extensions:[t,i,n].concat(a.extensions||[])};
return e.create(r,a)}}}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.list",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.list",engine:"jqote2",markup:['<div class="tau-board-layout-list-module i-role-module-customize">','<div class="tau-shadow">','<div class="tau-customize-list-lanes-panel"></div>','<div class="tau-board-layout-compositor tau-board-layout-compositor_list-compositor">',"</div>",'<div class="tau-board-layout-components-set"></div>',"</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.types.list",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.types.list",engine:"jqote2",markup:["<div><form>","<% _.forEach(this.x, function(item){ %>",'<input type="radio" name="customize_entities" value=\'<%= JSON.stringify([item.id]) %>\' ','<% if (this.x.isDisabled) { %> disabled <% } %> class="tau-input-hidden" />','<button type="button" class="i-role-entities tau-btn tau-y-lane-value','<% if (this.x.isDisabled) { %> tau-disabled<% } %>"',"<% if (this.x.isDisabled) { %> disabled<% } %>","><%!item.name %></button>","<% }, this); %>","<% _.forEach(this.y, function(item){ %>",'<input type="radio" name="customize_entities" value=\'<%= JSON.stringify([item.id]) %>\' ','<% if (this.y.isDisabled) { %> disabled <% } %> class="tau-input-hidden" />','<button type="button" class="i-role-entities tau-btn tau-x-lane-value','<% if (this.y.isDisabled) { %> tau-disabled<% } %>"',"<% if (this.y.isDisabled) { %> disabled<% } %>","><%!item.name %></button>","<% }, this); %>",'<input type="radio" name="customize_entities" value=\'<%= JSON.stringify(_.map(this.cells,function(item){ return item.id})) %>\' ','<% if (this.defaultChecked["cells"]) { %> checked="checked" <% } %> class="tau-input-hidden" />','<button type="button" class="i-role-entities tau-btn','<% if (this.defaultChecked["cells"]) { %> tau-checked<% } %>"><%! _.map(this.cells,function(item){ return item.name}).join(", ") %>',"</button>","</form></div>"]};
return e.register(t)}),define("tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.list",["jQuery","Underscore","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.base","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list.unit","tau/utils/utils.customFields.list"],function(e,t,i,n,a){var r=function(){},s=t.constant(!0),o=t.constant(!1);e.widget("tau.pscrollerForCustomize",e.ui.pscroller,{setPoint:function(e){this.__setPoint(e)}});var l=i.extend({init:function(){this.CLASS_MAP=t.defaults({CARD_SECTION:"tau-list-canvas",CARD:"tau-list-canvas"},this.CLASS_MAP)},setUnits:function(e){this.units=e},setConfigurator:function(e){this.configurator=e},getUnitLineNumber:function(){return 0},initializeScroll:function(e){this.getLayoutCompositor(e).pscrollerForCustomize().pscrollerForCustomize("enable")},setOptionScroll:function(e,t){this.getLayoutCompositor(e).pscrollerForCustomize("setPoint",t.point)},destroyScroll:function(e){this.getLayoutCompositor(e).pscrollerForCustomize("destroy")},appendToSection:function(e){this.showPlaceholder(e)},getPlaceholder:function(e){return e.find("."+this.CLASS_MAP.BOARD_UNIT_DND_PROXY).find(".tau-board-unit")},addDraggableClasses:function(e){e.closest(".tau-canvas-board-unit-cell").addClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY)},enableUnitInCard:function(e,t){e.addClass(this.CLASS_MAP.BOARD_UNIT_DND_SOURCE).closest(".tau-canvas-board-unit-cell").removeClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY+" "+this.CLASS_MAP.BOARD_UNIT_DND_PRE_INSERT).show(),t&&e.animateWithCss({cssClassName:"tau-operation_unit_added",offsetTimeout:-40})},isSectionCardElement:function(e){return this._super(e)||e.closest(".tau-canvas-board-unit-cell").hasClass("tau-canvas-board-unit-cell_not_dnd")},insertAfterUnit:function(e,t){e.closest(".tau-canvas-board-unit-cell").after(t.closest(".tau-canvas-board-unit-cell"))},insertBeforeUnit:function(e,t){e.closest(".tau-canvas-board-unit-cell").before(t.closest(".tau-canvas-board-unit-cell"))
},getUnitHolder:function(e){return e.closest(".tau-canvas-board-unit-cell")},getUnit:function(e){return e.find("."+this.CLASS_MAP.BOARD_UNIT)},isOverUnit:function(e){return e.hasClass("tau-canvas-board-unit-cell")&&!e.hasClass("tau-canvas-board-unit-cell_not_dnd")&&!e.hasClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY)&&!e.closest("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET).length&&!e.closest("."+this.CLASS_MAP.CARD_SECTION).hasClass(this.CLASS_MAP.NOT_DROP)},isMultipleLineUnit:o,isDoubleLineUnit:o,isStretchableUnit:o,removeFromSection:function(e){e.closest(".tau-canvas-board-unit-cell").remove()},setSectionStyles:r,resetSectionStyles:r,insertSectionToCard:r,isAvailableSpaceOnSection:s,isAvailableSpaceForMultipleUnit:s,isAvailableSpaceForStretchableUnit:s,checkAvailableSpaceOnCard:s,hidePlaceholder:function(e){e.closest(".tau-canvas-board-unit-cell").hide()},showPlaceholder:function(e){e.closest(".tau-canvas-board-unit-cell").show()},showPlaceholderOutLibrary:r,preInsertUnitOnCard:function(i,n){var r,s=n;if(s.length){this.setSectionStyles(s,i);var o=i.data("unitId"),l=t.find(this.units,function(e){return e.unitId==o}),u=this.renderUnitCell(l.unit);r=u.find(".tau-board-unit"),u.addClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY+" "+this.CLASS_MAP.BOARD_UNIT_DND_PRE_INSERT),r.addClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE),this.hidePlaceholder(r),this.setAlignment(r,!0);var c=u.data("rank"),d=s.find("[data-rank="+c+"]");if(o.indexOf("custom_field")>=0){var p=u.find(".tau-board-unit-label");p.text(a.getListHeader(p.text()))}var f=d.last();f.length?f.after(u):s.append(u)}else r=e("<div/>").remove(),r.length=0;return r},handleDragOverStretchableUnit:r,renderUnitCell:function(e){return n.render({unit:e,configurator:this.configurator})},fixLayoutNearStretchable:r,freezeStretchableUnits:r,unfreezeStretchableUnit:r,unfreezeStretchableUnits:r});return new l}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.initHelperList",["tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.list"],function(e){var t={init:function(t){this._super(t),this.helper=e
},"bus public.unit.readyForLibrary":function(e,t){this.helper.setUnits(t)},"bus configurator.ready":function(e,t){this.helper.setConfigurator(t)}};return t}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dnd.list",["tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dnd","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.initHelperList"],function(e,t){return e.extend(_.defaults({},t))}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dblclick-handler.list",["tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dblclick-handler","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.initHelperList"],function(e,t){return e.extend(_.defaults({},t))}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.remove.list",["tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.remove","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.initHelperList"],function(e,t){return e.extend(_.defaults({},t))}),define("tau/models/board.editor.customize/model.board.editor.customize.list",["Underscore","jQuery","tau/models/board.editor.customize/model.board.editor.customize.base","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.list","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n,a){return i.extend({getType:function(e){return a.getListKeyByTypes(e)},getCustomizeSection:function(e){return[e]}})}),define("tau/components/component.board.editor.customize.list",["Underscore","tau/components/component.container.with-shared-events","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.list","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.types.list","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dnd.list","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.dblclick-handler.list","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.card.remove.list","tau/models/board.editor.customize/model.board.editor.customize.list","tau/core/helpers/extension.configurator"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){var d={extensions:[u,r,s,r,o,a,l].concat(c.extensions||[]),template:i};
return d.layout="selectable",d.children=[{type:"board.editor.customize.types",name:"customize.types",template:n,selector:".tau-customize-list-lanes-panel"},{type:"board.editor.customize.editor.list",name:"customize.editor",selector:".tau-board-layout-compositor"},{type:"board.editor.customize.library.list",name:"customize.library",selector:".tau-board-layout-components-set"}],t.create(e.extend(c,d))}}}),define("tau/models/board.editor.customize/model.board.editor.customize.sizes",["Underscore","tau/core/model-base","tau/models/board.customize.units/const.card.sizes"],function(e,t,i){return t.extend({normalizeZoom:function(e){return i.zoomToSize(e)||e},"bus afterInit + configurator.ready":function(){this.model=null,this.lastViewModeNotList="board",this.currentViewMove=null,this.model=null},updateLayout:function(e){this.fire("refreshData",{items:e.items})},init:function(e){this._super(e),this.timeoutId=null},renderLayout:function(e){this.fire("dataBind",{items:e.items})},updateSettings:function(e){var t=this.normalizeZoom(e.zoomLevel),i=this.createModel(t,e.viewMode);this.model?i.size!==this.model.size&&(this.updateLayout(i),this.model=i,this.fire("public.listSizes.changed",i)):(this.renderLayout(i),this.model=i,this.fire("public.listSizes.changed",i))},"bus configurator.ready + boardSettings.ready:last":function(e,t,i){var n=i.boardSettings,a=function(){n.get({fields:["zoomLevel","viewMode"],callback:function(e){"newlist"!==e.viewMode&&(this.lastViewModeNotList=e.viewMode),this.currentViewMove=e.viewMode,this.currentZoomLevel=e.zoomLevel,this.updateSettings(e)}.bind(this)})}.bind(this);a(),n.unbind({listener:this}),n.bind({fields:["zoomLevel","viewMode"],listener:this,callback:a})},createModel:function(t,n){var a={xs:" - only basic info, just one line. Could be a card name or ID.",s:" - a bit more info fits in here: two lines e.g. a card name + avatars of assigned people.",m:" - still more info: three lines. Could be a card name + tags + avatars and time spent.",l:" - this size is for the detailed info. Unlimited lines.",xl:" - a maxi stretch fit. That is how a card looks in the list-like mode."},r=e.reject(i,function(e){return"list"===e
}),s=e.map(r,function(e){return{description:a[e],name:e.toUpperCase(),role:"size",data:e,classes:"tau-board-layout-elements-list__item_card-"+e,isActive:"newlist"!==n&&e===t,isDisabled:!1}},this),o=[].concat(s);return o.push({description:" - displays maximum info in minimum space. Unlimited nested lists are allowed.",name:"List",role:"view",data:"newlist",classes:"tau-board-layout-elements-list__item_list-view",isActive:"newlist"===n,isDisabled:!1}),"newlist"===n&&(t="list"),{items:o,size:t,viewMode:n}},"bus size.changed.ui + boardSettings.ready:last":function(t,n,a){var r=a.boardSettings,s=i.sizeToZoom(n),o={zoomLevel:s},l=this.currentViewMove;"newlist"===this.currentViewMove&&(o.viewMode=this.lastViewModeNotList,l=this.lastViewModeNotList),this.updateSettings({zoomLevel:s,viewMode:l}),(s||0===s)&&(clearTimeout(this.timeoutId),this.timeoutId=e.delay(function(){r.set({set:o})},300))},"bus view.changed.ui + boardSettings.ready:last":function(t,i,n){var a=n.boardSettings;this.updateSettings({zoomLevel:this.currentZoomLevel,viewMode:i}),clearTimeout(this.timeoutId),this.timeoutId=e.delay(function(){a.set({set:{viewMode:i}})},300)}})}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.sizes",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){this.addHandler(e,t)},"bus elementRefreshedWithData":function(e,t){this.addHandler(e,t)},addHandler:function(t,i){i.element.on("click",".i-role-toggle-view:not(.tau-is-disabled)",function(t){this.fire("view.changed.ui",e(t.currentTarget).data("view"))}.bind(this)),i.element.on("click",".i-role-toggle-size",function(t){this.fire("size.changed.ui",e(t.currentTarget).data("size"))}.bind(this))}})}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.sizes.item",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.sizes.item",engine:"jqote2",markup:['<li class="tau-board-layout-elements-list__item <%if(this.isActive){%>tau-is-active<%}%> <%if(this.isDisabled){%>tau-is-disabled<%}%> <%=this.classes%> i-role-toggle-<%=this.role%>" data-<%=this.role%>="<%=this.data%>"><strong class="tau-board-layout-elements-list__item-name"><%=this.name%></strong><%=this.description%></li>'],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.sizes",["tau/core/templates-factory","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.sizes.item"],function(e){var t={name:"board.editor.customize.sizes",engine:"jqote2",markup:['<div class="tau-board-layout-elements-list">','<ul class="customize">','<%=fn.sub("board.editor.customize.sizes.item", this.items)%>',"</ul>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.editor.customize.sizes",["Underscore","tau/components/component.creator","tau/models/board.editor.customize/model.board.editor.customize.sizes","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.sizes","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.sizes","tau/core/helpers/extension.configurator"],function(e,t,i,n,a,r){return{create:function(e){var s={name:"board.editor.customize.sizes",extensions:[i,r,n],template:a};return e["queue.bus"]=!0,t.create(s,e)}}}),define("tau/models/board.editor.customize/model.board.editor.customize.types",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n=i.extend({"bus beforeInit + boardSettings.ready:last":function(t,i,n){var a=n.boardSettings,r=i.config.context.configurator,s=e.bind(function(){this.fire("refresh")},this);a.unbind({listener:this});var o=["cells","y","x"];a.bind({fields:o,listener:this,callback:s});var l=function(e){return e&&e.types||[]};a.get({fields:o,callback:e.bind(function(t){this.getEmptySpace(r).done(e.bind(function(e){var i={cells:l(t.cells),x:l(t.x),y:l(t.y)};this.fire("dataBind",this.getViewModel(i,e,r.getUnitsRegistry().units))},this))},this)}),r.acidStore.unbind({listener:this}),r.acidStore.bind({fields:["acid"],listener:this,callback:s})},"bus beforeInit:last + boardSettings.ready:last + destroy":function(e,t,i){i.boardSettings.unbind({listener:this}),t.config.context.configurator.acidStore.unbind({listener:this})
},getEmptySpace:function(i){var n=t.Deferred();return i.acidStore.get({fields:["acid"],callback:e.bind(function(t){var a={global:{acid:t.acid}};i.getSliceFactory().create({definition:a}).space().then(e.bind(function(e){return this.emptySpace={cells:e.data.cells.items,axes:e.data.axes.items},this.emptySpace},this)).done(function(e){n.resolve(e)})},this)}),n},getViewModel:function(t,i,n){function a(t,i){return e.chain(t).filter(function(t){return e.contains(i,t.id)}).map(function(e,t){return{id:e.id,name:e.name,"default":!t}}).value()}var r=function(t,i){return e.reduce(t,function(t,n){return t&&e.find(i,function(t){return e.contains(t.types,n.id)})},!0)},s=a(i.cells,t.cells),o=a(i.axes,t.y),l=a(i.axes,t.x),u={cells:!0};return l.isDisabled=!r(l,n),o.isDisabled=!r(o,n),{cells:s,y:o,x:l,defaultChecked:u}}});return n}),define("tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.types",["tau/core/templates-factory"],function(e){var t={name:"board.editor.customize.types",engine:"jqote2",markup:["<div><form>","<% _.forEach(this.cells, function(item){ %>",'<input type="radio" name="customize_entities" value=\'<%= JSON.stringify([item.id]) %>\' ','<% if (item["default"]) { %> checked="checked" <% } %> class="tau-input-hidden" />','<button type="button" class="i-role-entities tau-customize-label tau-btn tau-<%= item.id %> ',"<% if (item['default']) { %> tau-checked<% } %>\"><%= item.name %></button>","<% }); %>","</form></div>"]};return e.register(t)}),define("tau/ui/extensions/board.customize/ui.extension.board.editor.customize.types",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e,i){var n=this,a=i.element;a.on("click",".i-role-entities",function(){var e=t(this),i=e.prev("input");a.find(".tau-btn.tau-checked").removeClass("tau-checked"),e.addClass("tau-checked"),i.trigger("click"),n.fire("public.types.changed",JSON.parse(i.val()))});var r=a.find("input:radio[checked=checked]").val();
this.fire("public.types.changed",r&&JSON.parse(r))}})}),define("tau/components/component.board.editor.customize.types",["Underscore","tau/components/component.creator","tau/models/board.editor.customize/model.board.editor.customize.types","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.types","tau/ui/extensions/board.customize/ui.extension.board.editor.customize.types"],function(e,t,i,n,a){return{create:function(e){var r={name:"board.editor.customize.editor",extensions:[i,a],template:e.template||n};return e["queue.bus"]=!0,t.create(r,e)}}}),define("tau/ui/templates/board.editor.encoding/ui.template.board.editor.encoding",["tau/core/templates-factory"],function(e){var t={name:"board.editor.encoding",engine:"jqote2",markup:['<div class="tau-coming-soon"><h2><span>Visual Encoding</span></h2><h3>Highlight important things by custom rules</h3><div class="tau-bg tau-visual-encoding"></div></div>'],dependencies:[]};return e.register(t)}),define("tau/components/component.board.editor.encoding",["tau/components/component.creator","tau/ui/templates/board.editor.encoding/ui.template.board.editor.encoding"],function(e,t){return{create:function(i){var n={template:t},a=e.create(n,i);return a.fire("dataBind",{}),a}}}),define("tau/models/board.editor/board.filter.help.data",["Underscore"],function(){return{general:[{label:"has 'wow' in tags or in name",value:"?'wow' in Tags or 'wow' in Name"},{label:"created last week",value:"?CreateDate > Today - 7(days)"},{label:"entities with inbound blockers",value:"?InboundRelations.Where(RelationType is 'Blocker')"}],projectMember:[{label:"fully allocated",value:"?Allocation is 100"},{label:"partially allocated",value:"?Allocation < 100"},{label:"allocated in the future",value:"?MembershipStartDate > today"}],assignable:[{label:"not done",value:"?EntityState.IsFinal != true"},{label:"assigned to a person with last name 'Gates'",value:"?AssignedUser.Where(LastName is 'Gates')"},{label:"with some effort",value:"?Effort > 0"},{label:"assigned to me",value:"?AssignedUser.Where(it is Me)"}],feature:[{label:"assigned to ${release,lower} started after 04-Mar-2013",value:"?Release.StartDate > '04-Mar-2013'"},{label:"has ${user story,lower,names} with time spent",value:"?UserStories.Where(TimeSpent > 0)"}],team:[{label:"small teams",value:"?TeamMembers.Count < 4"},{label:"teams without related projects",value:"?TeamProjects.Count is 0"}],testCase:[{label:"failed today",value:"?LastStatus is False and LastRunDate is today"},{label:"for ${user story,lower} 'Make us happy'",value:"?UserStory is 'Make us happy'"}],entityState:[{label:"not done",value:"?IsFinal is False"},{label:"only in progress states",value:"?IsInitial is false and IsFinal is false and IsPlanned is false"},{label:"'developer' is responsible",value:"?Role is 'Developer'"},{label:"name starts with 'in'",value:"?Name.StartsWith('in')"}],tag:[{label:"Tags with ${user story,lower,names} from project 'Triads'",value:"?Generals.Count > 0 and Generals.Where(EntityType is 'UserStory') and Generals.Where(Project.Name is 'Triads')"},{label:"Tags that starts with 'A' or 'B'",value:"?Name.StartsWith('A') or Name.StartsWith('B')"},{label:"Tags that contains 'rest' or 'soap'",value:"?Name.Contains('rest') or Name.Contains('soap')"}],impediment:[{label:"with critical priority",value:"?Priority is 'Critical'"},{label:"resolved",value:"?EntityState.IsFinal is true"},{label:"email of responsible contains 'ted'",value:"?Responsible.Email.Contains('ted')"},{label:"related to entities with 'rest' in name",value:"?Assignable.Name.Contains('rest')"}],iteration:[{label:"started last month",value:"?StartDate > today - 30(days)"},{label:"backlog",value:"?it is None"},{label:"in ${release,lower,names} that have 'gold' in name",value:"?Release.Name.Contains('gold')"}],time_container:[{label:"current and backlog",value:"?it is Current"},{label:"current only",value:"?it is Current and it is not none"},{label:"future and backlog",value:"?it is Future"},{label:"past and backlog",value:"?it is Past"}],release:[{label:"started last year",value:"?StartDate > today - 365(days)"},{label:"without ${iterations,lower,names}",value:"?Iterations.Count is 0"}],role:[{label:"name starts with 'dev'",value:"?Name.StartsWith('dev')"},{label:"roles with effort",value:"?HasEffort is True"}],severity:[{label:"most severe ${bug,lower,names}",value:"?Importance is 1"},{label:"severity contains 'cri' and ends with 'cal'",value:"?Name.Contains('cri') and Name.EndsWith('cal')"}],requestType:[{label:"types with some requests",value:"?Requests.Count > 0"},{label:"types with name 'Issue'",value:"?Name is 'Issue'"}],testPlan:[{label:"without test runs",value:"?TestPlanRuns.Count is 0"},{label:"from projects where name contains 'tp'",value:"?Project.Name.Contains('tp')"}],process:[{label:"default process",value:"?IsDefault is True"},{label:"unused process",value:"?Projects.Count is 0"}],priority:[{label:"most important",value:"?Importance is 1"},{label:"name starts with 'must'",value:"?Name.StartsWith('must')"}],teamIteration:[{label:"started last month",value:"?StartDate > today - 30(days)"},{label:"backlog",value:"?it is None"}],assignment:[{label:"developers or qa engineers",value:"?Role is 'Developer' or Role is 'QA Engineer'"},{label:"persons from Project A",value:"?It is not none and ProjectMembers.Where(Project is 'Project A')"},{label:"added this year",value:"?CreateDate > today - 365(days)"},{label:"last name starts with 'D'",value:"?LastName.StartsWith('D')"},{label:"active admins",value:"?IsActive is true and IsAdministrator is true"}],user:[{label:"developers or qa engineers",value:"?Role is 'Developer' or Role is 'QA Engineer'"},{label:"added this year",value:"?CreateDate > today - 365(days)"},{label:"last name starts with 'D'",value:"?LastName.StartsWith('D')"},{label:"active admins",value:"?IsActive is true and IsAdministrator is true"}],releasable:[{label:"belongs to the current ${release,lower}",value:"?Release is Current"},{label:"belongs to a future ${release,lower}",value:"?Release is Future"}],project:[{label:"only active projects",value:"?IsActive is True"},{label:"problematic projects",value:"?Bugs.Count > 1000"}],task:[{label:"${user story,lower} contains 'zoom' in name",value:"?UserStory.Name.Contains('zoom')"}],request:[{label:"not replied or without comments",value:"?IsReplied is False or Comments.Count is 0"}],bug:[{label:"belongs to the last 3 ${team iteration,lower,names}",value:"?TeamIteration is Past(3)"},{label:"with 'Confused' severity",value:"?Severity.Name is 'Confused'"}],userStory:[{label:"belongs to the 2 future ${iteration,lower,names}",value:"?Iteration is Future(2)"},{label:"without tasks",value:"?Tasks.Count is 0"},{label:"belongs to 'Quick Add' ${feature,lower} ",value:"?Feature is 'Quick Add'"},{label:"belongs to the current ${iteration,lower}",value:"?Iteration is Current"},{label:"assigned to 'Delta' team",value:"?Team is 'Delta'"}],datetime:[{label:"10 days from the past",value:"?It >= today - 10(days)"},{label:"10 days from the future",value:"?It >= today and It <= today + 10(days)"},{label:"10 days from the past and 10 days from the future",value:"?It >= today - 10(days) and It <= today + 10(days)"},{label:"Today",value:"?It == today"}],inboundRelation:[{label:"entities with outbound blockers",value:"?OutboundRelations.Where(RelationType is 'Blocker')"},{label:"entities with more than 10 outbound relations",value:"?OutboundRelations.Count > 10"},{label:"entities with outbound ${bug,lower,names}",value:"?OutboundRelations.Where(Outbound.EntityType is 'Bug')"}],outboundRelation:[{label:"entities with inbound blockers",value:"?InboundRelations.Where(RelationType is 'Blocker')"},{label:"entities with more than 10 inbound relations",value:"?InboundRelations.Count > 10"},{label:"entities with inbound ${bug,lower,names}",value:"?InboundRelations.Where(Inbound.EntityType is 'Bug')"}],effort:[{label:"Fibonacci",value:"1,2,3,5,8,13,21"},{label:"Planning Poker",value:"0.5,1,2,3,5,8,13,20,40,100"},{label:"Linear",value:"1,2,3,4,5,6,7,8,9,10"}],program:[{label:"has some projects",value:"?Projects.Count > 0"},{label:"with name 'Marketing'",value:"?Name is 'Marketing'"}]}
}),define("tau/models/board.editor/board.filter.help",["Underscore","jQuery","tau/core/class","tau/models/board.editor/board.filter.help.data","tau/store/types"],function(e,t,i,n,a){var r={},s={assigneduser:"assignment",createdate:"datetime",enddate:"datetime",startdate:"datetime"},o={userStory:["releasable"],bug:["releasable"],feature:["releasable"],task:["releasable"],iteration:["releasable","time_container"],teamIteration:["time_container"],release:["time_container"]};return i.extend({getTypes:function(e){return r.hasOwnProperty(e)||(r[e]=this._getTypes(e)),r[e]},_getTypes:function(e){var t=[];s.hasOwnProperty(e)&&(e=s[e]);var i=a.findByKeyword(e);if(i&&i.name&&o.hasOwnProperty(i.name)&&(t=t.concat(o[i.name])),i){var n=i.parent;for(t.push(i.name);n;){t.push(n);var r=a.findByKeyword(n);if(!r)break;n=r.parent}}else t.push(e);return t},get:function(i){i=i||{};var a={},r=this,s=t.Deferred();return e.each(e.keys(i),function(t){var s=(i[t]||{}).types||[];if(0!==s.length){a[t]=[];var o=[];e.each(s,function(e){o.push(r.getTypes(e))}),o=e.intersection.apply(null,o),e.each(o,function(e){var i=n[e];i&&(a[t]=a[t].concat(i))})}}),s.resolve(a),s}})}),define("tau/ui/templates/board.editor/ui.template.board.editor.filterHelp",["tau/core/templates-factory"],function(e){var t={name:"board.editor.filterHelp",engine:"jqote2",markup:['<div class="filter-help cm-s-default" role="<%= this.name%>_help">',"<table>","<tbody>","<% if (this.predefinedFilters && this.predefinedFilters.length) {%>",'<tr class="filter-help-heading">','<td colspan="3"><h2>Advanced filters <span>(type <strong>?</strong> to use them)</span></h2></td>',"</tr>","<%}%>","<% _.forEach(this.predefinedFilters, function(filter){%>",'<tr class="i-role-complex-filter-example">',"<td>",'<button type="button" class="tau-btn tau-primary i-role-predefined-filter" data-value="<%= filter.value %>">use</button>',"</td>",'<td class="filter-help-output i-role-output-filter">',"<%= filter.value %>","</td>",'<td class="filter-help-description">','<%= fn.replaceTermTags(filter.label, "abbr") %>',"</td>","</tr>","<% }); %>","</tbody>","</table>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.filter",["tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.filterHelp"],function(e){var t={name:"board.editor.filter",engine:"jqote2",markup:['<div class="tau-boardsettings__filter i-role-filter-control">','<button class="tau-btn i-role-filter-toggle tau-extension-board-tooltip" type="button" ','data-expanded-selector=".tau-checked" data-title-expanded="Turn filter off" ','data-title="Turn filter on">Filter ','<span class="tau-boardsettings__status tau-boardsettings__status_on">on </span>','<span class="tau-boardsettings__status tau-boardsettings__status_off">off</span>',"</button>",'<input type="checkbox" class="i-role-useFilter" name="<%= this.name %>_useFilter" <% if (this.useFilter) { %>checked<% } %> />','<div class="i-role-filter">','<input type="text" name="<%= this.name %>_filter" placeholder="<%= this.placeholder || \'type ? for advanced filter\' %>" spellcheck="false"',' class="i-role-filter-input tau-boardsettings__filter__input tau-in-text tau-x-large tau-filter" value="<%! this.filter %>" />','<div class="tau-boardsettings__filtertools">','<button type="button" tabindex="-1" class="tau-btn tau-boardsettings__presetstrigger i-role-help"></button>','<div class="tau-help-content i-role-help-content">','<%= fn.sub("board.editor.filterHelp", this) %>',"</div>",'<span class="tau-help i-role-tooltipArticle" data-article-id="board.editor.filter"></span>',"</div>","</div>","</div>"]};return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.ordering",["tau/core/templates-factory"],function(e){var t={name:"board.editor.ordering",engine:"jqote2",markup:['<span class="tau-inline-group tau-sorter i-role-ordering-control">','<button class="tau-btn tau-sorter-toggle i-role-sorter-toggler tau-extension-board-tooltip" type="button" data-collapsed-selector=":not(.tau-checked)" data-title-collapsed="Change sorting criteria">Sort</button>','<select class="tau-select tau-sorter-value" name="<%= this.name %>_ordering_name"></select>','<button name="<%= this.name %>_ordering_direction" class="tau-btn tau-sort-<%= this.name %> tau-sort-inc tau-sorter-dir i-role-direction-toggler tau-extension-board-tooltip" data-title="Change sorting order"></button>',"</span>"]};
return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.cards",["tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.filter","tau/ui/templates/board.editor/ui.template.board.editor.ordering"],function(e){var t={name:"board.editor.cards",engine:"jqote2",markup:['<div class="tau-board-settings-cards">',"<h4>Select the cards you want to see</h4>",'<span class="tau-help i-role-tooltipArticle" data-article-id="<%= this.cardsHelpArticleId %>"></span>','<div class="tau-section-cards">',"<% _.forEach(this.space.cells.types, function(item){ %> ",'<input type="checkbox" name="cells_types" value="<%= item.id %>" class="tau-input-hidden" ','<% if (item.isSelected) { %> checked="checked" <% } %> ',"/>",'<% var btnChecked = item.isSelected ? "tau-checked" : ""; %>','<button type="button" class="i-role-cell-type tau-btn tau-<%= item.id %> <%= btnChecked %>">',"<%= item.name %>","</button>","<% }); %>",'<button class="tau-btn tau-more hidden" type="button">more&hellip;</button>',"</div>",'<div class="tau-section">','<%= fn.sub("board.editor.ordering", this.space.cells) %>','<%= fn.sub("board.editor.filter", this.space.cells) %>',"</div>","</div>"]};return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.axisTypes",["tau/core/templates-factory"],function(e){var t={name:"board.editor.axisTypes",engine:"jqote2",markup:["<% var UIID = _.UUID();  %>","<% _.forEach(this.grouped, function(group){ %>",'<% if (group.name != "default") { %>','<option value="<%! group.name + UIID %>" disabled="">----- <%! group.name %> -----</option>',"<% } %>","<% _.forEach(group.items, function(item){ %>","<% if (item.isAvailable){ %>",'<option value="<%= item.id %>" ',"<% if (item.isSelected){ %>","selected ","<% } %> ",">","<%! item.name %>","</option>","<% } %> ","<% }); %>","<% }); %>"]};return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.stateSetup",["tau/core/templates-factory"],function(e){var t={name:"board.editor.stateSetup",engine:"jqote2",markup:['<button type="button" class="tau-btn tau-board-settings__statesetup i-role-statesetup">Set up States</button>'],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.lanes",["tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.filter","tau/ui/templates/board.editor/ui.template.board.editor.ordering","tau/ui/templates/board.editor/ui.template.board.editor.axisTypes","tau/ui/templates/board.editor/ui.template.board.editor.stateSetup"],function(e){var t={name:"board.editor.lanes",engine:"jqote2",markup:['<div class="tau-board-settings-lanes">',"<h4><%= this.lanesHeader %></h4>",'<span class="tau-help i-role-tooltipArticle" data-article-id="<%= this.lanesHelpArticleId %>"></span>','<div class="tau-y-lane tau-section">','<select name="x_types" class="tau-select">','<option value=""><%= this.firstLaneNoValue %></option>','<%= fn.sub("board.editor.axisTypes", this.space.x) %>',"</select>",'<%= fn.sub("board.editor.ordering", this.space.x) %>','<%= fn.sub("board.editor.filter", this.space.x) %>',"<% if (this.user.isAdministrator){ %>",'<%= fn.sub("board.editor.stateSetup", {}) %>',"<% } %>","</div>",'<div class="tau-x-lane tau-section">','<select name="y_types" class="tau-select">','<option value=""><%= this.secondLaneNoValue %></option>','<%= fn.sub("board.editor.axisTypes", this.space.y) %>',"</select>",'<%= fn.sub("board.editor.ordering", this.space.y) %>','<%= fn.sub("board.editor.filter", this.space.y) %>',"<% if (this.user.isAdministrator){ %>",'<%= fn.sub("board.editor.stateSetup", {}) %>',"<% } %>","</div>",'<button type="button" class="tau-lane-switch i-role-switch-filter tau-extension-board-tooltip" data-title="Swap lanes">Swap lanes</button>',"</div>"]};return e.register(t)}),define("tau/ui/templates/board.editor/ui.template.board.editor.help",["Underscore","tau/nls/translator","tau/core/templates-factory"],function(e,t,i){var n={name:"board.editor.help",engine:"jqote2",markup:['<div class="tau-board-settings-group__help">','<span class="tau-help i-role-tooltipArticle" data-article-id="board.editor">About Setup</span>',"</div>"]};
return i.register(n)}),define("tau/ui/templates/board.editor/ui.template.board.editor",["Underscore","tau/nls/translator","tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.cards","tau/ui/templates/board.editor/ui.template.board.editor.lanes","tau/ui/templates/board.editor/ui.template.board.editor.help","tau/extensions/extension.underscore"],function(e,t,i){var n={name:"board.editor",engine:"jqote2",markup:['<div class="tau-board-settings tau-boardsettings" role="form-settings" id="<%= _.uniqueId(\'boardSettings\') %>">','<%= fn.sub("board.editor.help") %>','<%= fn.sub("board.editor.cards", _.extend(this, { cardsHelpArticleId: "board.editor.selectCards" })) %>','<%= fn.sub("board.editor.lanes", _.extend(this, { lanesHelpArticleId: "board.editor.selectLanes", lanesHeader: "Set vertical and horizontal lanes", firstLaneNoValue: "No vertical lanes", secondLaneNoValue: "No horizontal lanes" })) %>',"</div>"]};return i.register(n)}),define("tau/ui/templates/board.editor/ui.template.board.editor.newlist",["Underscore","tau/nls/translator","tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.cards","tau/ui/templates/board.editor/ui.template.board.editor.lanes","tau/ui/templates/board.editor/ui.template.board.editor.help","tau/extensions/extension.underscore"],function(e,t,i){var n={name:"board.editor.new.list",engine:"jqote2",markup:['<div class="tau-board-settings tau-boardsettings tau-list-settings" role="form-settings" id="<%= _.uniqueId(\'boardSettings\') %>">','<%= fn.sub("board.editor.help") %>','<%= fn.sub("board.editor.lanes", _.extend(this, { lanesHelpArticleId: "board.editor.selectListLevels", lanesHeader: "Set 1st and 2nd hierarchy level", firstLaneNoValue: "No 1st level", secondLaneNoValue: "No 2nd level" })) %>','<%= fn.sub("board.editor.cards", _.extend(this, { cardsHelpArticleId: "board.editor.selectListCards" })) %>',"</div>"]};return i.register(n)}),define("tau/models/board.editor/model.board.editor.read",["Underscore","tau/core/extension.base","tau/models/board.editor/board.filter.help","tau/ui/templates/board.editor/ui.template.board.editor","tau/ui/templates/board.editor/ui.template.board.editor.newlist"],function(e,t,i,n,a){var r=t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;
this.fire("configurator.ready",i)},"bus configurator.ready":function(e,t){var i=this;t.getAppStateStore().get({fields:["acid"],callback:function(e){i.fire("acid.ready",e.acid)}}),t.getAppStateStore().unbind({listener:this}),t.getAppStateStore().bind({fields:["acid"],listener:this,callback:function(){i.fire("refresh")}});var n=t.service("boardSettings");n.get({fields:["ownerIds"],callback:function(e){var n=t.getLoggedUser(),a={edit:t.getBoardAccessService().isEditable(e,n)};i.fire("accessData.ready",a)}})},"bus configurator.ready:last + acid.ready:last + accessData.ready:last + form.readyToUpdate":function(e,t,i,n){var a=t.service("boardSettings"),r=this;this.getSpaceTotal(t.getSliceFactory(),a,i,function(e){r.fire("updateData.ready",{space:e,access:n})})},"bus configurator.ready + acid.ready":function(e,t,i){var n=this,a=t.service("boardSettings");a.unbind({listener:this}),a.bind({listener:this,fields:["viewMode"],callback:function(e){this.setTemplate(e.viewMode),this.fire("refresh")}}),$.when(this.getSpaceTotal(t.getSliceFactory(),a,i),this.getViewMode(a)).done(function(e,i){n.setTemplate(i),n.fire("dataBind",{user:t.getLoggedUser(),space:e})})},getViewMode:function(e){return e.get({fields:["viewMode"]}).then(function(e){return e.viewMode})},setTemplate:function(e){var t="newlist"===e?a:n;this.fire("board.editor.setTemplate",t)},"bus configurator.ready + destroy":function(e,t){var i=t.service("boardSettings");i.unbind({listener:this})},getSpaceTotal:function(t,i,n,a){var r=this,s=$.Deferred(),o=[];return o.push(function(e){r.spaceAvailable(t,i,n,e)}),o.push(function(e){r.spaceCells(t,i,n,e)}),o.push(function(e){r.spaceAxisX(t,i,n,e)}),o.push(function(e){r.spaceAxisY(t,i,n,e)}),o.push(function(e){r.getPredefinedFilters(i,e)}),e.parallel(o,function(e,t){var i=r.processSpaces(t);a&&a(i),s.resolve(i)}),s},spaceAvailable:function(e,t,i,n){var a={global:{acid:i}},r=e.create({definition:a});r.space().done(function(e){n(!1,{space:e.data})})},spaceCells:function(e,t,i,n){t.get({fields:["name","x","y","cells","zoomLevel","hierarchyMode","viewMode","acid"],callback:function(t){var a={definition:{global:{acid:i},x:t.x,y:t.y,cells:t.cells}},r=e.create(a);
r.on("error",function(){n(!1,{space:{},settings:t})}),r.space().done(function(e){n(!1,{space:e.data,settings:t})})}})},spaceAxisX:function(e,t,i,n){t.get({fields:["name","x","y","cells","zoomLevel"],callback:function(t){var a={definition:{global:{acid:i},y:t.y,cells:t.cells}},r=e.create(a);r.on("error",function(){n(!1,{space:{}})}),r.space().done(function(e){n(!1,{space:e.data})})}})},spaceAxisY:function(e,t,i,n){t.get({fields:["name","x","y","cells","zoomLevel"],callback:function(t){var a={definition:{global:{acid:i},x:t.x,cells:t.cells}},r=e.create(a);r.on("error",function(){n(!1,{space:{}})}),r.space().done(function(e){n(!1,{space:e.data})})}})},processSpaces:function(t){var i={spaceDefault:t[0].space,spaceAvailable:{cells:t[1].space.cells||[],x:t[2].space.axes||[],y:t[3].space.axes||[],hierarchyMode:"inside",viewMode:""},settingsCurrent:t[1].settings},n=t[4],a={x:{name:"x",types:[],filter:"",useFilter:!0,predefinedFilters:n.x||[],orderingName:"",orderingDirection:"Asc"},y:{name:"y",types:[],filter:"",useFilter:!0,predefinedFilters:n.y||[],orderingName:"",orderingDirection:"Asc"},cells:{name:"cells",types:[],filter:"",useFilter:!0,predefinedFilters:n.cells||[],orderingName:"",orderingDirection:"Asc"},hierarchyMode:null,viewMode:null},r=function(e){return e.toLowerCase()};a.hierarchyMode=i.settingsCurrent.hierarchyMode,a.viewMode=i.settingsCurrent.viewMode;var s=e.bind(function(t){a[t].types=e.map(i.spaceDefault.axes.items,function(n){var a={id:n.id,name:n.name,isAvailable:e.any(i.spaceAvailable[t].items,function(e){return r(e.id)===r(n.id)}),isSelected:i.settingsCurrent[t]&&e.any(i.settingsCurrent[t].types,function(e){return r(e)===r(n.id)})};return a.isAvailable=a.isSelected?!0:a.isAvailable,a.groupName=n.groupName,a}),a[t].filter=i.settingsCurrent[t]?i.settingsCurrent[t].filter||"":"",a[t].useFilter=this._isFilterEnabled(i.settingsCurrent[t]||{},a[t]);var n=e.filter(a[t].types,function(e){return e.isAvailable});a[t].grouped=e.groupBy(n,function(e){return e.groupName||"default"
}),a[t].grouped=e.map(a[t].grouped,function(e,t){return{name:t,items:e}}),a[t].grouped=e.sortBy(a[t].grouped,function(e){return"default"==e.name?"AAAA":e.name});var s=i.settingsCurrent[t]?i.settingsCurrent[t].types[0]||"":"",o=e.find(i.spaceAvailable[t].items,function(e){return r(e.id)===r(s)});o||(o={});var l=i.settingsCurrent&&i.settingsCurrent[t]?i.settingsCurrent[t].ordering:{},u=l&&l.name;a[t].orderingNames=e.map(o.orderings||[],function(e){return{id:e.name,name:e.name,isSelected:e.name==u,direction:e.direction}}),a[t].orderingDirection=this.getOrderingDirection(l,o.orderings)},this);s("x"),s("y"),a.cells.types=e.map(i.spaceDefault.cells.items,function(t){var n={id:t.id,name:t.name,isAvailable:e.any(i.spaceAvailable.cells.items,function(e){return r(e.id)===r(t.id)}),isSelected:e.any(i.settingsCurrent.cells.types,function(e){return r(e)===r(t.id)})};return n.isAvailable=n.isSelected?!0:n.isAvailable,n}),a.cells.filter=i.settingsCurrent.cells.filter||"",a.cells.useFilter=this._isFilterEnabled(i.settingsCurrent.cells||{},a.cells);var o=i.settingsCurrent&&i.settingsCurrent.cells.ordering,l=o&&o.name;return a.cells.orderingDirection=this.getOrderingDirection(o,t[1].space.cells.orderings.items),a.cells.orderingNames=e.map(t[1].space.cells.orderings.items,function(e){return{id:e.name,name:e.name,isSelected:e.name==l,direction:e.direction}}),a.acid=t[1].settings.acid||"",a},_isFilterEnabled:function(e,t){var i=e.useFilter,n=null!==i&&void 0!==i;return n?e.useFilter:!!t.filter},getOrderingDirection:function(t,i){var n=i&&i[0]&&i[0].direction;if(t){if(t.direction)n=t.direction;else var a=e.find(i,function(e){return e.name==t.name});a&&(n=a.direction)}return n},getPredefinedFilters:function(e,t){e.get({fields:["x","y","cells"],callback:function(e){(new i).get({x:e.x,y:e.y,cells:e.cells}).done(function(e){t(!1,e)})}})},getSpaceEmpty:function(){var e={x:{name:"x",types:[],filter:""},y:{name:"y",types:[],filter:""},cells:{name:"cells",types:[],filter:""},hierarchyMode:null,viewMode:null};
return e}});return r}),define("tau/models/board.editor/model.board.editor.write",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready:last + acid.ready:last + formData.changed":function(t,i,n,a){a.focus={x:[],y:[]},a.selectedMarks={x:[],y:[]};var r=i.service("boardSettings"),s=this,o=$.Deferred();this._getCurrent(r).done(function(t){if(e.isEqual(t.cells.types,a.cells.types)&&t.x&&e.isEqual(t.x.types,a.x.types)&&t.y&&e.isEqual(t.y.types,a.y.types))o.resolve(a);else{var r={global:{acid:n},x:a.x,y:a.y,cells:a.cells},s=i.getSliceFactory().create({definition:r});s.spaceV2().done(function(t){var i=t.data;if(a.cells.ordering&&-1==e.indexOf(e.pluck(i.cells.orderings.items,"name"),a.cells.ordering.name))if(i.cells.orderings.items.length){var n=i.cells.orderings.items[0];a.cells.ordering.name=n.name,a.cells.ordering.direction=n.direction}else a.cells.ordering.name=null,a.cells.ordering.direction=null;e.forEach(["x","y"],function(t){if(a[t].ordering){var n=e.find(i.axes.items,function(e){return e.id==a[t].types[0]});if(n){if(-1==e.indexOf(e.pluck(n.orderings,"name"),a[t].ordering.name))if(n.orderings.length){var r=n.orderings[0];a[t].ordering.name=r.name,a[t].ordering.direction=r.direction}else a[t].ordering.name=null,a[t].ordering.direction=null}else a[t].ordering.name=null,a[t].ordering.direction=null}}),o.resolve(a)})}}),o.done(function(e){r.set({set:e}).done(function(){s.fire("settings.changed",e)})})},_getCurrent:function(e){var t=$.Deferred();return e.get({fields:["cells","x","y"],callback:function(e){t.resolve(e)}}),t}})}),define("tau/models/board.editor/model.board.filter.help",["Underscore","tau/core/model-base","tau/models/board.editor/board.filter.help"],function(e,t,i){return t.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus boardSettings.ready":function(e,t){var n=new i,a=t.boardSettings,r=this;a.unbind({listener:r}),a.bind({fields:["cells","x","y"],listener:r,callback:function(e){n.get(e).done(function(e){r.fire("refresh.help.content",e)
})}})}})}),define("tau/models/board.editor/board.filter.suggestionManager",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n={};return i.extend({init:function(e){this.url=e.getApplicationPath()+"/api/v2/lang/query",this.acidStore=e.getAppStateStore(),this.ajaxService=t.ajax},get:function(i){i=e.defaults(i||{},{query:{resourceTypes:[],script:""},take:50,skip:0,options:{insertDotForObjectAttribute:!0,insertLeftBracketForObjectCollectionMethod:!0}});var a=this.url+"/suggestions",r=t.Deferred();return this.acidStore.get({fields:["acid"],callback:e.bind(function(e){i.acid=e.acid;var t=JSON.stringify(i),s=(a+"/"+t).toLowerCase(),o=n.hasOwnProperty(s)?n[s]:this.ajaxService({url:a,type:"POST",data:t,dataType:"json",contentType:"application/json; charset=utf-8"});n[s]=o,o.done(r.resolve).fail(r.fail)},this)}),r}})}),define("tau/models/board.editor/model.board.editor.autocomplete",["Underscore","tau/core/extension.base","tau/models/board.editor/board.filter.suggestionManager"],function(e,t,i){var n=t.extend({"bus configurator.ready":function(e,t){var n=new i(t);this.fire("suggestionManager.ready",n)},getTypes:function(e,t){var i=e.prop("name"),n=$.Deferred();if(!i)return n.reject(),n;var a=i.replace("_filter","");return t.get({fields:[a],callback:function(e){var t=[];e.hasOwnProperty(a)&&(t=e[a].types||[]),n.resolve(t)}}),n},"bus suggestionManager.ready:last + boardSettings.ready:last + filter.autocomplete.preload":function(t,i,n,a){var r=a.$input;this.getTypes(r,n.boardSettings).done(function(t){if(0!=t.length){var n=a.value;if(n&&0!==n.length&&"?"==n[0]){var r=[n.trim()+" ",n.trim()+"."];e.each(r,function(e){var n={query:{resourceTypes:t,script:e}};i.get(n)})}}})},"bus suggestionManager.ready:last  + boardSettings.ready:last + filter.autocomplete.resolve":function(t,i,n,a){var r=a.$input;this.getTypes(r,n.boardSettings).done(function(t){if(0==t.length)return void a.next([]);var n=a.request.term.slice(0,r[0].selectionStart),s=function(t){var i=t.Suggestions?t.Suggestions.Items:[];
i=e.map(i,function(e){return e.Source=t.Source,e.Position=t.Position,e}),a.next(i)},o=function(){a.next([])},l={query:{resourceTypes:t,script:n}};i.get(l).done(s).fail(o)})}});return n}),define("tau/models/board.editor/model.board.editor.autocomplete.preloading",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready:last + suggestionManager.ready:last + preloading.execute":function(t,i,n){var a=i.service("boardSettings");a.get({fields:["x","y","cells","user"],callback:e.bind(function(t){this._preloadAll(n,t).done(e.bind(function(){this.fire("preload.complete")},this))},this)})},_preloadAll:function(e,t){var i=[];return t.x&&(i=i.concat(this._preload(t.x.types,t.x.filter,e))),t.y&&(i=i.concat(this._preload(t.y.types,t.y.filter,e))),t.cells&&(i=i.concat(this._preload(t.cells.types,t.cells.filter,e)),t.user&&(i=i.concat(this._preload(t.cells.types,t.user.cardFilter,e)))),$.whenList(i)},_preload:function(t,i,n){var a=[];if(e.isArray(t)||(t=[t]),!(t.indexOf("effort")>=0||t.indexOf("source")>=0)){e.each(t,function(t){a.push(e.isString(t)?t:t.type)}),i=i||"";var r=["?"];return i.length>1&&"?"===i[0]&&r.push(i.trim()+" "),0===a.length?[]:e.map(r,function(e){return n.get({query:{resourceTypes:a,script:e}})})}}})}),define("libs/jquery/jquery.toggleFilter",["libs/jquery/jquery","libs/jquery/jquery.caret"],function(e){e.fn.toggleFilter=function(t){var i=e.extend({expandedClass:"tau-inline-group",additionalClass:"",filterOnClass:"tau-boardsettings__filter_on",defaultExpand:!1},t),n=function(e){var t=e.find(".i-role-useFilter"),n=t.prop("checked");e.toggleClass(i.expandedClass,n),e.find(".i-role-filter-toggle").toggleClass("tau-checked",n);var a=i.filterOnClass+" i-role-filter-control_on",r=e.find(".i-role-filter-input");e.toggleClass(a,n&&!!r.val())};if("refresh"===t)return this.each(function(){n(e(this))}),this;if(this.addClass(i.additionalClass),i.defaultExpand){var a=e(this);a.find(".i-role-useFilter").prop("checked",!0),n(a)}return this.each(function(){var t=e(this),i=t.find(".i-role-filter-input"),a=t.find(".i-role-useFilter");
n(t),i.on("clear autocompletechange",function(){n(t)}),a.on("click",function(){n(t),i.val()&&i.trigger("_change")}),t.on("click",".i-role-filter-toggle",function(){a.trigger("click")})}),this}}),define("libs/jquery/jquery.tau.resetableInput",["libs/jquery/jquery"],function(e){!function(e,t){if(t in e.fn)throw new Error('The "'+t+'" jQuery plugin is already defined.');var i=function(e){e.css("visibility","visible")},n=function(e){e.css("visibility","hidden")},a=function(t){var a=e(this);if(!a.is('input[type="text"]'))return e(this);t=e.extend({cssClass:"",template:'<button type="button" tabindex="-1"></button>',onAttach:function(t,i){i.css({zIndex:t.zIndex()+10});var n=e('<span class="tau-resetable-input"></span>');n.insertBefore(t),t.detach(),n.append(t).append(i)},showAlways:!1},t);var r=e(t.template).addClass(t.cssClass);n(r),t.onAttach(a,r),a.addClass("i-role-resetable-target"),r.addClass("i-role-resetable-trigger");var s=null,o=function(){a.val()?i(r):n(r)},l=function(){clearTimeout(s),s=setTimeout(o,0)};if(t.showAlways)a.on({keydown:l,input:l}),o();else{var u=function(){clearTimeout(s),n(r)},c=a.parent(),d=".i-role-resetable-target,.i-role-resetable-trigger",p={mouseenter:l,mouseleave:u},f=function(){c.on(p,d)},m=function(){c.off(p,d),c.on(p,d)},h=function(){c.off(p,d)},g=function(){l(),h()},v=function(){u(),m()};a.on({keydown:l,input:l,focus:g,blur:v}),f()}return r.on("mousedown",function(t){return 1==t.which?(n(e(this)),a.val("").focus().trigger(e.Event("keydown",{keyCode:8})).trigger(e.Event("keyup",{keyCode:8})).trigger(e.Event("keypress",{keyCode:8})).trigger("input").trigger("clear"),t.preventDefault(),!1):void 0}),e(this)};e.fn[t]=function(t){return e.ui.ie||this.each(function(){a.call(this,t)}),this}}(e,"tauResetableInput")}),define("tau/ui/extensions/board.editor/ui.extension.board.editor.form",["Underscore","jQuery","tau/core/extension.base","tau/ui/templates/board.editor/ui.template.board.editor.axisTypes","tau/ui/behaviour/overlay/ui.behaviour.overlay","libs/jquery/jquery.placeholder","libs/jquery/jquery.toggleFilter","libs/jquery/jquery.tau.resetableInput"],function(e,t,i,n){var a=null;
return i.extend({resetLifecycle:!0,disableSettingsChange:!1,"bus afterRender":function(e,t){var i=t.element,n=i.find(".i-role-filter-input");n.placeholder(),i.find(".i-role-filter-control").toggleFilter(),this.fire("$el.ready",i),this.fire("$form.ready",i)},"bus $el.ready:last + error":function(e,t){t.data("ui-tauOverlay")&&t.tauOverlay("hide")},"bus $form.ready + updateData.ready":function(i,n,r){var s=this;n.on("click",".i-role-sorter-toggler",function(){t(this).toggleClass("tau-checked")});var o=r.access;if(o.edit===!1)return n.find("select, input, button").not(".i-role-filter-toggle").not(".i-role-sorter-toggler").prop("disabled",!0).addClass("permission-denied"),!1;n.find(".i-role-filter-input").tauResetableInput({showAlways:!0}),n.on("click",".i-role-switch-filter",function(){var e=n.find("[name=x_types]"),i=n.find("[name=y_types]"),a=n.find("[name=x_filter]"),r=a.parents(".i-role-filter-control:first"),o=n.find("[name=y_filter]"),l=o.parents(".i-role-filter-control:first"),u=n.find("[name=x_ordering_name]"),c=n.find("[name=x_ordering_direction]"),d=c.parents(".i-role-ordering-control:first"),p=n.find("[name=y_ordering_name]"),f=n.find("[name=y_ordering_direction]"),m=f.parents(".i-role-ordering-control:first"),h=e.val(),g=a.val(),v=u.find("option").map(function(){var e=t(this);return{id:e.attr("value"),name:e.text(),isSelected:e.prop("selected")}}),b=p.find("option").map(function(){var e=t(this);return{id:e.attr("value"),name:e.text(),isSelected:e.prop("selected")}}),y=c.data("direction");a.val(o.val()),a.trigger("input");var _=i.val(),x=e.find("option").detach(),w=i.find("option").detach();e.append(w),e.val(_),s.updateOrderingState(u,b),s.updateOrderingDirectionState(c,f.data("direction"));var C=!!d.find(".i-role-sorter-toggler.tau-checked").length,S=!!m.find(".i-role-sorter-toggler.tau-checked").length;d.find(".i-role-sorter-toggler").toggleClass("tau-checked",S),m.find(".i-role-sorter-toggler").toggleClass("tau-checked",C),o.val(g),o.trigger("input"),i.append(x),i.val(h),s.updateOrderingState(p,v),s.updateOrderingDirectionState(f,y);
var T=r.find(".i-role-useFilter").prop("checked"),k=l.find(".i-role-useFilter").prop("checked");r.find(".i-role-useFilter").prop("checked",k),l.find(".i-role-useFilter").prop("checked",T),n.trigger("_submit")});var l=["[name=cells_ordering_direction]","[name=x_types]","[name=x_ordering_direction]","[name=y_types]","[name=y_ordering_direction]"].join(","),u=["[name=cells_ordering_name]","[name=x_ordering_name]","[name=y_ordering_name]"].join(",");n.on("change",u,e.bind(function(e){var i=t(e.target);this.updateOrderingDirectionState(i.next(),i.find(":selected").data("direction")),n.trigger("_submit",{$input:i,sourceEvent:e})},this)),n.on("change",l,function(e){n.trigger("_submit",{$input:t(this),sourceEvent:e})}),n.on("click",".i-role-cell-type",function(e){if(0==s.disableSettingsChange){s.disableSettingsChange=!0;var i=t(this),a=i.prev("input");i.toggleClass("tau-checked");var r=i.hasClass("tau-checked");a.prop("checked",r),r&&n.find(".tau-board-settings-cards h4").removeClass("tau-attention"),n.trigger("_submit",{$input:a,sourceEvent:e})}else e.preventDefault(),e.stopPropagation()});var c="[name=cells_filter], [name=x_filter], [name=y_filter]";n.on("_change",c,function(e){n.trigger("_submit",{$input:t(this),sourceEvent:e})}),n.on("clear",c,function(){t(this).trigger("_change")}),n.on("keydown",c,function(e){if(e.which==t.ui.keyCode.ENTER){var i=t(this);i.blur()}}),n.on("click",".i-role-direction-toggler",function(){var e=t(this);e.toggleClass("tau-sort-inc"),e.toggleClass("tau-sort-dec"),e.hasClass("tau-sort-dec")?e.data("direction","Desc"):e.data("direction","Asc"),e.trigger("change")}),n.on("_submit",function(t,i){var r=!1;i&&i.$input&&(s.resetFilters(n,i.$input),i.$input.is("[name=x_types]")&&(r="x"),i.$input.is("[name=y_types]")&&(r="y"),i.$input.is("[name=cells_types]")&&(r="cells"));var o=s.bindForm(n,r);clearTimeout(a),a=e.delay(function(){s.fire("formData.changed",o)},250)})},"bus refresh":function(){clearTimeout(a),this._super()},"bus destroy":function(){clearTimeout(a),this._super()
},"bus settings.changed":function(){this.fire("form.readyToUpdate")},"bus $form.ready":function(){this.fire("form.readyToUpdate")},"bus configurator.ready:last + $form.ready:last + updateData.ready ":function(e,t,i,n){this.updateForm(t,i,n.space,n.access)},resetFilters:function(e,t){"x_types"==t.attr("name")&&e.find("[name=x_filter]").val(""),"y_types"==t.attr("name")&&e.find("[name=y_filter]").val("")},bindForm:function(i,n){n=!1;var a={x:{types:[],filter:"",useFilter:!1,ordering:{name:"",direction:"Asc"}},y:{types:[],filter:"",useFilter:!1,ordering:{name:"",direction:"Asc"}},cells:{types:[],filter:"",useFilter:!1,ordering:{name:"",direction:"Asc"}}};a.x.types=e.compact([i.find("[name=x_types]").val()]),a.x.filter=e.trim(i.find("[name=x_filter]").val()),a.x.useFilter=!!a.x.filter&&i.find("[name=x_useFilter]").prop("checked"),"x"==n?(a.x.ordering=null,a.x.direction=null):(a.x.ordering.name=e.trim(i.find("[name=x_ordering_name]").val())||null,a.x.ordering.direction=i.find("[name=x_ordering_direction]").data("direction")||null),a.y.types=e.compact([i.find("[name=y_types]").val()]),a.y.filter=e.trim(i.find("[name=y_filter]").val()),a.y.useFilter=!!a.y.filter&&i.find("[name=y_useFilter]").prop("checked"),"y"==n?(a.y.ordering=null,a.y.direction=null):(a.y.ordering.name=e.trim(i.find("[name=y_ordering_name]").val())||null,a.y.ordering.direction=i.find("[name=y_ordering_direction]").data("direction")||null),"cells"==n?(a.cells.ordering=null,a.direction.ordering=null):(a.cells.ordering.name=e.trim(i.find("[name=cells_ordering_name]").val())||null,a.cells.ordering.direction=i.find("[name=cells_ordering_direction]").data("direction")||null);var r=[];return i.find("[name=cells_types]:checked").each(function(){r.push(t(this).val())}),a.cells.types=e.compact(r),a.cells.filter=e.trim(i.find("[name=cells_filter]").val()),a.cells.useFilter=!!a.cells.filter&&i.find("[name=cells_useFilter]").prop("checked"),a},updateForm:function(i,n,a,r){var s=n.find(".i-role-filter-input");s.placeholder("refresh"),n.find(".i-role-filter-control").toggleFilter("refresh");
var o=n.find("[name=cells_types]"),l=n.find("[name=x_types]"),u=n.find("[name=y_types]"),c=n.find("[name=cells_filter]"),d=n.find("[name=x_filter]"),p=n.find("[name=y_filter]"),f=n.find("[name=x_ordering_name]"),m=n.find("[name=y_ordering_name]"),h=n.find("[name=cells_ordering_name]"),g=n.find("[name=x_ordering_direction]"),v=n.find("[name=y_ordering_direction]"),b=n.find("[name=cells_ordering_direction]"),y=a.cells.types;e.forEach(y,function(e){var i=!e.isAvailable,n=o.filter(function(){return this.value==e.id||t(this).hasClass("permission-denied")}),a=n.next();n.prop("disabled",i).toggleClass("tau-disabled",i),a.prop("disabled",i).toggleClass("tau-disabled",i)});var _="remove",x={disable:e.bind(this.updateSelectByDisable,this),remove:e.bind(this.updateSelectByRemove,this)}[_];x(i,l,a.x),x(i,u,a.y),this.updateFilterState(l.val(),d),this.updateFilterState(u.val(),p),this.updateFilterState(o.filter(":checked").length,c),this.updateOrderingState(f,a.x.orderingNames),this.updateOrderingState(m,a.y.orderingNames),this.updateOrderingState(h,a.cells.orderingNames),this.updateOrderingDirectionState(g,a.x.orderingDirection),this.updateOrderingDirectionState(v,a.y.orderingDirection),this.updateOrderingDirectionState(b,a.cells.orderingDirection),this.toggleOrderingDisable(l.next(),f.find("option").length,r),this.toggleOrderingDisable(u.next(),m.find("option").length,r),this.toggleOrderingDisable(h.parent(),h.find("option").length,r),this.disableSettingsChange=!1},updateSelectByRemove:function(e,t,i){var a=e.getTemplateFactory().get(n.name).bind({},i);t.find("option:not(:first)").remove(),t.append(a)},updateSelectByDisable:function(t,i){var n=t.find("option");e.forEach(i,function(e){n.filter(function(){return this.value==e.id}).prop("disabled",!e.isAvailable)})},setFilterFieldDisabled:function(e,t){e.prop("disabled",t);var i=e.closest(".i-role-filter-control");i.find(".i-role-help").prop("disabled",t),i.find(".i-role-filter-toggle").prop("disabled",t&&!i.hasClass("i-role-filter-control_on"))
},updateFilterState:function(e,t){var i=!(e&&!t.hasClass("permission-denied"));this.setFilterFieldDisabled(t,i)},updateOrderingState:function(i,n){i.find("option").remove(),e.forEach(n,function(e){var n=t('<option value="'+e.id+'"'+(e.isSelected?'selected="selected"':"")+">"+e.name+"</option>");n.data("direction",e.direction),i.append(n)})},updateOrderingDirectionState:function(e,t){e.removeData("direction"),e.data("direction",t),e.toggleClass("tau-sort-dec","Desc"==t),e.toggleClass("tau-sort-inc","Asc"==t||!t)},toggleOrderingDisable:function(e,t,i){i.edit?t>0?e.find(":input").prop("disabled",!1):e.find(":input").prop("disabled",!0):t>0?e.find("select").prop("disabled",!0):e.find(":input").prop("disabled",!0)}})}),define("tau/ui/templates/board.editor/ui.template.board.editor.autocomplete.item",["tau/core/templates-factory"],function(e){var t={name:"board.editor.autocomplete.item",engine:"jqote2",markup:['<li class="tau-autocomplete__item">','<a class="tau-autocomplete__itemtrigger tau-autocomplete__itemtrigger-',"<%! this.SuggestionType.toLowerCase() %>",' drop-down-option">',"<%! this.Value %>","</a>","</li>"]};return e.register(t)}),define("tau/ui/extensions/board.editor/ui.extension.board.editor.autocomplete",["jQuery","Underscore","tau/core/extension.base","tau/ui/templates/board.editor/ui.template.board.editor.autocomplete.item"],function(e,t,i,n){function a(e,t){null!=e&&(e.type==t?e.stopImmediatePropagation():a(e.originalEvent,t))}return i.extend({"bus configurator.ready:last + view.dom.ready:last + $form.ready":function(i,r,s,o){var l=o.find(".i-role-filter-control :text"),u=t.bind(this.fire,this);l.on("focus",function(){u("preloading.execute")}),o.delegate(".i-role-clear","click",function(){var t=e(this).parent().find(":text");t.val("")}),l.bind("click keydown keyup",function(){var t=e(this),i=t.val().length>0;t.parent().toggleClass("tau-boardsettings__filter_empty_false",i)}),l.each(function(){var i=e(this);e.ui.ie&&i.bind("keyup",function(){e(this).data("selectionEnd",this.selectionEnd)
}),i.bind("keydown",function(t){switch(t.keyCode){case e.ui.keyCode.TAB:e(this).data("ui-autocomplete").menu.active&&t.preventDefault();break;case e.ui.keyCode.SPACE:t.ctrlKey&&(t.preventDefault(),e(this).autocomplete("search"));break;case e.ui.keyCode.ESCAPE:e(this).data("ui-autocomplete").menu.element.is(":visible")&&(e(this).autocomplete("close"),t.preventDefault(),t.stopPropagation())}}).bind("clear",function(){e(this).autocomplete("close")}).autocomplete({minLength:0,position:{my:"left top",at:"left bottom",collision:"flip"},source:function(t,i){u("filter.autocomplete.resolve",{$input:e(this.element),request:t,next:i})},change:function(){e(this).trigger("_change")},focus:function(){return!1},select:function(i,n){var r=e(this),s=n.item,o=r.val(),l=s.Source.slice(0,s.Position.Value);l+=s.LangValue;var c=l,d=l.length;return l+=o.slice(r[0].selectionEnd>0?r[0].selectionEnd:r.data("selectionEnd")||0),r.val(l),r[0].focus(),r[0].setSelectionRange(d,d),r.data("selectionEnd",d),t.contains(["ObjectAttribute","ObjectsCollectionAttribute","Method"],s.SuggestionType)&&setTimeout(function(){r.autocomplete("search",c)},100),u("filter.autocomplete.preload",{value:l,$input:r}),i.stopPropagation(),a(i,"keydown"),!1}});var s=r.getTemplateFactory().get(n.name),o=i.data("ui-autocomplete");o._change=function(e){this._trigger("change",e,{item:this.selectedItem})},o._renderItem=function(e,t){return s.bind({},t).data("ui-autocomplete-item",t).appendTo(e)},o._renderMenu=function(t,i){e(t).addClass("tau-autocomplete__menu drop-down-list").css({maxHeight:.4*e(window).height(),zIndex:this.element.zIndex()+10});var n=this;e.each(i,function(e,i){n._renderItem(t,i)})}})}})}),define("tau/ui/templates/board.workflow/ui.template.board.workflow.chooseProcess",["tau/core/templates-factory"],function(e){var t={name:"board.templates.workflow.chooseProcess",engine:"jqote2",markup:["<div>","   <h3>Please select processes to customize:</h3>",'   <div class="tau-buttons">',"       <% _.forEach(this.processes, function(v){%>",'           <button type="button" class="tau-btn tau-primary" data-id="<%= v.id %>"><%! v.name %></button>',"       <% }); %>","   </div>","</div>"]};
return e.register(t)}),define("tau/ui/extensions/board.workflow/ui.extension.board.workflow.base",["Underscore","jQuery","tau/core/extension.base","tau/ui/templates/board.workflow/ui.template.board.workflow.chooseProcess"],function(e,t,i){var n=i.extend({configure:function(e,i,n){n.on("click",function(n){var a=t(n.target),r=this._getProcess(e,a),s=this._getCard(e,i);t.when(r,s).done(function(t,i){e.getTp2Service().showPopupToChangeProcessWorkflow(e,a,i,t)})}.bind(this))},_getCard:function(e,i){var n=t.Deferred();return i.get({fields:["cells"],callback:function(e){var t=e.cells?e.cells.types:[],i=0===t.length?"userstory":t[0];n.resolve(i)}}),n},_getProcess:function(e,i){var n=t.Deferred();return e.getAppStateStore().get({fields:["acid"],callback:function(t){var a=t.acid;e.getApplicationContextService().getApplicationContext({acid:a},{success:function(t){this._chooseProcess(e,i,t.processes).done(n.resolve)}.bind(this),failure:function(){this._chooseProcess(e,i,[]).done(n.resolve)}.bind(this)})}.bind(this)}),n},_chooseProcess:function(e,i,n){var a,r=t.Deferred();return 1==n.length?(r.resolve(n[0].id),r):(a=e.getTemplateFactory().get("board.templates.workflow.chooseProcess").bind({},{processes:n}),i.tauBubble({template:['<div class="tau-bubble tau-warning-bubble tau-process-bubble">','   <div class="tau-bubble__arrow"  role="arrow"></div>','   <div class="tau-bubble__inner tau-container">','       <div role="content">',"       </div>","   </div>","</div>"].join(""),showOnCreation:!0,content:a}),i.tauBubble("widget").on("click","button",function(){r.resolve(t(this).data("id"))}),r)}});return n}),define("tau/ui/extensions/board.editor/ui.extension.board.editor.stateSetup",["Underscore","jQuery","tau/ui/extensions/board.workflow/ui.extension.board.workflow.base"],function(e,t,i){return i.extend({"bus configurator.ready + boardSettings.ready:last + $el.ready":function(e,t,i,n){var a=n.find(".i-role-statesetup");this.configure(t,i.boardSettings,a)},"bus $form.ready":function(e,i){i.find("[name=x_types], [name=y_types]").each(function(){t(this).parent().find(".i-role-statesetup").toggle("entitystate"==t(this).val().toLowerCase())
}),i.on("change","[name=x_types], [name=y_types]",function(){t(this).parent().find(".i-role-statesetup").toggle("entitystate"==t(this).val().toLowerCase())}),i.on("_submit",function(){i.find("[name=x_types], [name=y_types]").each(function(){t(this).parent().find(".i-role-statesetup").toggle("entitystate"==t(this).val().toLowerCase())})})}})}),define("tau/ui/extensions/board.editor/ui.extension.board.editor.hideCards",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({COUNT_OF_VISIBLE_CARDS:6,"bus $form.ready + boardSettings.ready:last":function(e,t,i){this._hideCardsIntoMoreAction(t),i.boardSettings.unbind({listener:this}),i.boardSettings.bind({fields:["edit"],listener:this,callback:function(e){e.edit&&this._hideCardsIntoMoreAction(t)}.bind(this)})},_hideCardsIntoMoreAction:function(e){var t=e.find(".tau-board-settings-cards button.i-role-cell-type").slice(this.COUNT_OF_VISIBLE_CARDS),i=e.find("button.tau-more");t.filter(":not(.tau-checked)").addClass("hidden").parent().addClass("collapsed"),i.removeClass("hidden").on("click",function(){t.removeClass("hidden").parent().removeClass("collapsed"),i.addClass("hidden")})}})}),define("tau/ui/extensions/board.editor/ui.extension.board.editor.nodata",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus configurator.ready":function(t,i){this.messageId="board.editor.nodata",this.configFieldName="doNotShowNoCardsMessageOnBoardSetup",this.settingsManager=i.getSettingsManager(),this.settingsManager.get({fields:[this.configFieldName],callback:e.bind(function(e){this.fire("nodata.settings.ready",{messageDisabled:!!e[this.configFieldName]})},this)});var n=i.getGlobalBus();n.on("board.nodata.status.ready",e.bind(function(e,t){this.fire("nodata.status.ready",t)},this)),n.on("application.navigate",e.bind(function(){this._hideMessage()},this)),n.on("error",e.bind(function(){this.fire("globalErrorStatus",!0)},this)),n.on("clearError",e.bind(function(e,t){t&&t.id===this.messageId||this.fire("globalErrorStatus",!1)
},this)),this.fire("globalErrorStatus",!1)},"bus globalErrorStatus":function(e,t){t&&this._hideMessage()},"bus nodata.settings.ready:last+nodata.status.ready+globalErrorStatus:last":function(e,t,i,n){t.messageDisabled||n||(i.noCards&&!i.noCardsSetup?this._showNoCards():i.noValuableAxis&&!i.noLanesSetup?this._showNoLanes():this._hideMessage())},_showNoCards:function(){this._show('<div><h3>Hmm... No cards on View...</h3><a href="http://guide.targetprocess.com/troubleshooting/no-cards.html" target="_blank">Find out why this happens?</a>')},_showNoLanes:function(){this._show('<div><h3>Hmm... No lanes on View...</h3><a href="http://guide.targetprocess.com/troubleshooting/no-lanes.html" target="_blank">Find out why this happens?</a>')},_show:function(i){var n={id:this.messageId,button:{caption:"Hide Forever",callback:e.bind(this._disableMessage,this)},type:"information",disableAutoClose:!0,$node:t(i)};this.fire("notification",n)},_disableMessage:function(){var e={};e[this.configFieldName]=!0,this.settingsManager.set({set:e,callback:t.proxy(function(e){this.fire("nodata.settings.ready",{messageDisabled:e[this.configFieldName]})},this)})},_hideMessage:function(){this.fire("clearError",{id:this.messageId})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.errors",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.serverErrorTranslator"],function(e,t,i,n){return i.extend({init:function(e){this._super(e),this.config.context.configurator.getRestStorage().on("error",this.generalErrorHandler,this),this.store.on({eventName:"failure",listener:this},this.generalErrorHandler.bind(this))},generalErrorHandler:function(e){var t=e.data;if(t&&t.cmd&&t.cmd.config){var i=t.cmd.config.errorHandler;if(i){var a=i(t.data);if(a===!1)return}}var r=n.translateServerError.call(this,t);this.fire("error",r)},"bus slice.ready":function(e,t){t.slice.on("error",this.generalErrorHandler,this),t.base&&t.base.on("error",this.generalErrorHandler,this),t.lazy&&t.lazy.on("error",this.generalErrorHandler,this)
},"bus report.error":function(e){this.generalErrorHandler(e)},"bus lookup.error":function(e){this.generalErrorHandler(e)},"bus dragndrop.error":function(e){this.generalErrorHandler(e)},"bus slice.ready:last + destroy":function(e,t){t.slice.removeAllListeners(this),t.base&&t.base.removeAllListeners(this),t.lazy&&t.lazy.removeAllListeners(this)},destroy:function(){this.config.context.configurator.getRestStorage().removeAllListeners(this),this.store.unbind(this)}})}),define("tp/codemirror/lib/codemirror",[],function(){var e=function(){function e(n,o){function h(e){return H&&(U&&229==e||window.opera&&197==e)||q&&U}function b(e){return e>=0&&e<Wi.size}function S(e){return c(Wi,e)}function T(e,t){rn=!0;for(var i=t-e.height,n=e;n;n=n.parent)n.height+=i}function M(e){var t={line:0,ch:0};rt(t,{line:Wi.size-1,ch:S(Wi.size-1).text.length},K(e),t,t),Zi=!0}function N(){var e=[];return Wi.iter(0,Wi.size,function(t){e.push(t.text)}),e.join("\n")}function G(e){function t(e){var i=di(e,!0);if(i&&!D(i,s)){Hi||nt(),s=i,Pt(n,i),Zi=!1;var a=Ct();(i.line>=a.to||i.line<a.from)&&(r=setTimeout(wi(function(){t(e)}),150))}}for(var i=_(e);i!=Di;i=i.parentNode)if(i.parentNode==Ai&&i!=Fi)return;for(var i=_(e);i!=Di;i=i.parentNode)if(i.parentNode==Ni)return Si.onGutterClick&&Si.onGutterClick(_n,F(Ni.childNodes,i)+dn,e),v(e);var n=di(e);switch(x(e)){case 3:return void(U&&!q&&pi(e));case 2:return void(n&&At(n.line,n.ch,!0))}if(!n)return void(_(e)==Ri&&v(e));Hi||nt();var a=+new Date;if(Xi&&Xi.time>a-400&&D(Xi.pos,n))return v(e),setTimeout(yt,20),Bt(n.line);if(Yi&&Yi.time>a-400&&D(Yi.pos,n))return Xi={time:a,pos:n},v(e),Ut(n);Yi={time:a,pos:n};var r,s=n;if(L&&!D(un.from,un.to)&&!P(n,un.from)&&!P(un.to,n)){O&&(ji.draggable=!0);var o=w(Ii,"mouseup",wi(function(t){O&&(ji.draggable=!1),Ji=!1,o(),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(v(t),At(n.line,n.ch,!0),yt())}),!0);return void(Ji=!0)}v(e),At(n.line,n.ch,!0);var l=w(Ii,"mousemove",wi(function(e){clearTimeout(r),v(e),t(e)}),!0),o=w(Ii,"mouseup",wi(function(e){clearTimeout(r);
var t=di(e);t&&Pt(n,t),v(e),yt(),Zi=!0,l(),o()}),!0)}function Q(e){for(var t=_(e);t!=Di;t=t.parentNode)if(t.parentNode==Ni)return v(e);var i=di(e);i&&(Xi={time:+new Date,pos:i},v(e),Ut(i))}function J(e){function t(e,t){var n=new FileReader;n.onload=function(){r[t]=n.result,++s==a&&(i=Mt(i),wi(function(){var e=ct(r.join(""),i,i);Pt(i,e)})())},n.readAsText(e)}e.preventDefault();var i=di(e,!0),n=e.dataTransfer.files;if(i&&!Si.readOnly)if(n&&n.length&&window.FileReader&&window.File)for(var a=n.length,r=Array(a),s=0,o=0;a>o;++o)t(n[o],o);else try{var r=e.dataTransfer.getData("Text");if(r){var l=ct(r,i,i),u=un.from,c=un.to;Pt(i,l),Ji&&ct("",u,c),yt()}}catch(e){}}function Z(e){var t=mt();R(t),e.dataTransfer.setDragImage(W,0,0),e.dataTransfer.setData("Text",t)}function et(e){Hi||nt();var t=e.keyCode;B&&27==t&&(e.returnValue=!1);var i=(q?e.metaKey:e.ctrlKey)&&!e.altKey,n=e.ctrlKey||e.altKey||e.metaKey;if(Qi=16==t||e.shiftKey?Qi||(un.inverted?un.to:un.from):null,!Si.onKeyEvent||!Si.onKeyEvent(_n,g(e))){if(33==t||34==t)return Nt(34==t),v(e);if(i&&(36==t||35==t||q&&(38==t||40==t)))return jt(36==t||38==t),v(e);if(i&&65==t)return Lt(),v(e);if(!Si.readOnly){if(!n&&13==t)return;if(!n&&9==t&&$t(e.shiftKey))return v(e);if(i&&90==t)return ot(),v(e);if(i&&(e.shiftKey&&90==t||89==t))return lt(),v(e)}if(36==t&&Si.smartHome)return zt(),v(e);if(mn=(i?"c":"")+(e.altKey?"a":"")+t,un.inverted&&V[mn]===!0){var a=Y(Ei);a&&(Ki={anchor:a.start},X(Ei,a.start,a.start))}i||e.altKey||(mn=null),gt(mn),Si.pollForIME&&h(t)&&(vn=50)}}function tt(e){Si.onKeyEvent&&Si.onKeyEvent(_n,g(e))||(Ki&&(Ki=null,Zi=!0),16==e.keyCode&&(Qi=null),2e3>vn&&!bn&&(vn=2e3))}function it(e){if(!Si.onKeyEvent||!Si.onKeyEvent(_n,g(e))){if(Si.electricChars&&zi.electricChars){var t=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode);zi.electricChars.indexOf(t)>-1&&setTimeout(wi(function(){qt(un.to.line,"smart")}),50)}var i=e.keyCode;13==i?(Si.readOnly||Ot(),v(e)):e.ctrlKey||e.altKey||e.metaKey||9!=i||"default"==Si.tabMode?gt(mn):v(e)
}}function nt(){"nocursor"!=Si.readOnly&&(Hi||(Si.onFocus&&Si.onFocus(_n),Hi=!0,-1==Di.className.search(/\bCodeMirror-focused\b/)&&(Di.className+=" CodeMirror-focused"),an||bt()),ht(),fi())}function at(){Hi&&(Si.onBlur&&Si.onBlur(_n),Hi=!1,Di.className=Di.className.replace(" CodeMirror-focused","")),clearInterval($i),setTimeout(function(){Hi||(Qi=null)},150)}function rt(e,t,i,n,a){if(gn){var r=[];for(Wi.iter(e.line,t.line+1,function(e){r.push(e.text)}),gn.addChange(e.line,i.length,r);gn.done.length>Si.undoDepth;)gn.done.shift()}ut(e,t,i,n,a)}function st(e,t){var i=e.pop();if(i){var n=[],a=i.start+i.added;Wi.iter(i.start,a,function(e){n.push(e.text)}),t.push({start:i.start,added:i.old.length,old:n});var r=Mt({line:i.start+i.old.length-1,ch:A(n[n.length-1],i.old[i.old.length-1])});ut({line:i.start,ch:0},{line:a-1,ch:S(a-1).text.length},i.old,r,r),Zi=!0}}function ot(){st(gn.done,gn.undone)}function lt(){st(gn.undone,gn.done)}function ut(e,t,i,n,a){function r(e){return e<=Math.min(t.line,t.line+v)?e:e+v}var o=!1,l=hn.length;Si.lineWrapping||Wi.iter(e.line,t.line,function(e){return e.text.length==l?(o=!0,!0):void 0});var u=t.line-e.line,c=S(e.line),d=S(t.line);if(c==d)if(1==i.length)c.replace(e.ch,t.ch,i[0]);else{d=c.split(t.ch,i[i.length-1]),c.replace(e.ch,null,i[0]),c.fixMarkEnds(d);for(var p=[],f=1,m=i.length-1;m>f;++f)p.push(s.inheritMarks(i[f],c));p.push(d),Wi.insert(e.line+1,p)}else if(1==i.length)c.replace(e.ch,null,i[0]),d.replace(null,t.ch,""),c.append(d),Wi.remove(e.line+1,u);else{var p=[];c.replace(e.ch,null,i[0]),d.replace(null,t.ch,i[i.length-1]),c.fixMarkEnds(d);for(var f=1,m=i.length-1;m>f;++f)p.push(s.inheritMarks(i[f],c));u>1&&Wi.remove(e.line+1,u-1),Wi.insert(e.line+1,p)}if(Si.lineWrapping){var h=Ri.clientWidth/li()-3;Wi.iter(e.line,e.line+i.length,function(e){if(!e.hidden){var t=Math.ceil(e.text.length/h)||1;t!=e.height&&T(e,t)}})}else Wi.iter(e.line,f+i.length,function(e){var t=e.text;t.length>l&&(hn=t,l=t.length,ln=null,o=!1)}),o&&(l=0,hn="",ln=null,Wi.iter(0,Wi.size,function(e){var t=e.text;
t.length>l&&(l=t.length,hn=t)}));for(var g=[],v=i.length-u-1,f=0,b=qi.length;b>f;++f){var y=qi[f];y<e.line?g.push(y):y>t.line&&g.push(y+v)}var _=e.line+Math.min(i.length,500);vi(e.line,_),g.push(_),qi=g,yi(100),en.push({from:e.line,to:t.line+1,diff:v}),tn={from:e,to:t,text:i},Et(n,a,r(un.from.line),r(un.to.line)),Ai.style.height=Wi.height*oi()+2*ui()+"px"}function ct(e,t,i){function n(n){if(P(n,t))return n;if(!P(i,n))return a;var r=n.line+e.length-(i.line-t.line)-1,s=n.ch;return n.line==i.line&&(s+=e[e.length-1].length-(i.ch-(i.line==t.line?t.ch:0))),{line:r,ch:s}}t=Mt(t),i=i?Mt(i):t,e=K(e);var a;return pt(e,t,i,function(e){return a=e,{from:n(un.from),to:n(un.to)}}),a}function dt(e,t){pt(K(e),un.from,un.to,function(e){return"end"==t?{from:e,to:e}:"start"==t?{from:un.from,to:un.from}:{from:un.from,to:e}})}function pt(e,t,i,n){var a=1==e.length?e[0].length+t.ch:e[e.length-1].length,r=n({line:t.line+e.length-1,ch:a});rt(t,i,e,r.from,r.to)}function ft(e,t){var i=e.line,n=t.line;if(i==n)return S(i).text.slice(e.ch,t.ch);var a=[S(i).text.slice(e.ch)];return Wi.iter(i+1,n,function(e){a.push(e.text)}),a.push(S(n).text.slice(0,t.ch)),a.join("\n")}function mt(){return ft(un.from,un.to)}function ht(){xn||Vi.set(vn,function(){_i(),vt(),Hi&&ht(),xi()})}function gt(e){function t(){_i();var n=vt();n&&e&&("moved"==n&&null==V[e]&&(V[e]=!0),"changed"==n&&(V[e]=!1)),n||i?(xn=!1,ht()):(i=!0,Vi.set(80,t)),xi()}var i=!1;xn=!0,Vi.set(20,t)}function vt(){function e(e,t){for(var n=0;;){var a=i.indexOf("\n",n);if(-1==a||("\r"==i.charAt(a-1)?a-1:a)>=e)return{line:t,ch:e-n};++t,n=a+1}}if(!an&&Hi){var t=!1,i=Ei.value,n=Y(Ei);if(!n)return!1;var t=sn.text!=i,a=Ki,r=t||n.start!=sn.start||n.end!=(a?sn.start:sn.end);if(!r&&!a)return!1;if(t&&(Qi=Ki=null,Si.readOnly))return Zi=!0,"changed";var s=e(n.start,sn.from),o=e(n.end,sn.from);if(a){var l=n.start==a.anchor?o:s,u=Qi?un.to:n.start==a.anchor?s:o;(un.inverted=P(l,u))?(s=l,o=u):(Ki=null,s=u,o=l)}if(s.line!=o.line||s.line!=un.from.line||s.line!=un.to.line||Qi||(Zi=!1),t){for(var c,d=0,p=i.length,f=Math.min(p,sn.text.length),m=sn.from,h=-1;f>d&&(c=i.charAt(d))==sn.text.charAt(d);)++d,"\n"==c&&(m++,h=d);
for(var g=h>-1?d-h:d,v=sn.to-1,b=sn.text.length;;){if(c=sn.text.charAt(b),i.charAt(p)!=c){++p,++b;break}if("\n"==c&&v--,d>=b||d>=p)break;--p,--b}var h=sn.text.lastIndexOf("\n",b-1),y=-1==h?b:b-h-1;rt({line:m,ch:g},{line:v,ch:y},K(i.slice(d,p)),s,o),(m!=v||s.line!=m)&&(Zi=!0)}else Et(s,o);return sn.text=i,sn.start=n.start,sn.end=n.end,t?"changed":r?"moved":!1}}function bt(){var e=[],t=Math.max(0,un.from.line-1),i=Math.min(Wi.size,un.to.line+2);Wi.iter(t,i,function(t){e.push(t.text)}),e=Ei.value=e.join($);var n=un.from.ch,a=un.to.ch;Wi.iter(t,un.from.line,function(e){n+=$.length+e.text.length}),Wi.iter(t,un.to.line,function(e){a+=$.length+e.text.length}),sn={text:e,from:t,to:i,start:n,end:a},X(Ei,n,Ki?n:a)}function yt(){"nocursor"!=Si.readOnly&&Ei.focus()}function _t(){if(Ui.getBoundingClientRect){var e=Ui.getBoundingClientRect(),t=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(e.top<0||e.bottom>t)&&Ui.scrollIntoView()}}function xt(){var e=ai(un.inverted?un.from:un.to),t=Si.lineWrapping?Math.min(e.x,ji.offsetWidth):e.x;return wt(t,e.y,t,e.yBot)}function wt(e,t,i,n){var a=ci(),r=ui(),s=oi();t+=r,n+=r,e+=a,i+=a;var o=Ri.clientHeight,l=Ri.scrollTop,u=!1,c=!0;l>t?(Ri.scrollTop=Math.max(0,t-2*s),u=!0):n>l+o&&(Ri.scrollTop=n+s-o,u=!0);var d=Ri.clientWidth,p=Ri.scrollLeft,f=Si.fixedGutter?Mi.clientWidth:0;return p+f>e?(50>e&&(e=0),Ri.scrollLeft=Math.max(0,e-10-f),u=!0):i>d+p&&(Ri.scrollLeft=i+10-d,u=!0,i>Ai.clientWidth&&(c=!1)),u&&Si.onScroll&&Si.onScroll(_n),c}function Ct(){var e=oi(),t=Ri.scrollTop-ui(),i=Math.max(0,Math.floor(t/e)),n=Math.ceil((t+Ri.clientHeight)/e);return{from:p(Wi,i),to:p(Wi,n)}}function St(e){if(!Ri.clientWidth)return void(dn=pn=cn=0);var t=Ct();if(!(e!==!0&&0==e.length&&t.from>=dn&&t.to<=pn)){var i=Math.max(t.from-100,0),n=Math.min(Wi.size,t.to+100);i>dn&&20>i-dn&&(i=dn),pn>n&&20>pn-n&&(n=Math.min(Wi.size,pn));for(var a=e===!0?[]:Tt([{from:dn,to:pn,domStart:0}],e),r=0,s=0;s<a.length;++s){var o=a[s];o.from<i&&(o.domStart+=i-o.from,o.from=i),o.to>n&&(o.to=n),o.from>=o.to?a.splice(s--,1):r+=o.to-o.from
}if(r!=n-i){a.sort(function(e,t){return e.domStart-t.domStart});var l=oi(),u=Mi.style.display;Bi.style.display=Mi.style.display="none",kt(i,n,a),Bi.style.display="";var c=i!=dn||n!=pn||fn!=Ri.clientHeight;if(c&&(fn=Ri.clientHeight),dn=i,pn=n,cn=f(Wi,i),Fi.style.top=cn*l+"px",Ai.style.height=Wi.height*l+2*ui()+"px",Bi.childNodes.length!=pn-dn)throw new Error("BAD PATCH! "+JSON.stringify(a)+" size="+(pn-dn)+" nodes="+Bi.childNodes.length);if(Si.lineWrapping){ln=Ri.clientWidth;var d=Bi.firstChild;Wi.iter(dn,pn,function(e){if(!e.hidden){var t=Math.round(d.offsetHeight/l)||1;e.height!=t&&(T(e,t),rn=!0)}d=d.nextSibling})}else null==ln&&(ln=ii(hn)),ln>Ri.clientWidth?(ji.style.width=ln+"px",Ai.style.width="",Ai.style.width=Ri.scrollWidth+"px"):ji.style.width=Ai.style.width="";Mi.style.display=u,(c||rn)&&It(),Dt()}}}function Tt(e,t){for(var i=0,n=t.length||0;n>i;++i){for(var a=t[i],r=[],s=a.diff||0,o=0,l=e.length;l>o;++o){var u=e[o];a.to<=u.from&&a.diff?r.push({from:u.from+s,to:u.to+s,domStart:u.domStart}):a.to<=u.from||a.from>=u.to?r.push(u):(a.from>u.from&&r.push({from:u.from,to:a.from,domStart:u.domStart}),a.to<u.to&&r.push({from:a.to+s,to:u.to+s,domStart:u.domStart+(a.to-u.from)}))}e=r}return e}function kt(e,t,i){function n(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}if(i.length){for(var a=0,r=Bi.firstChild,s=0;s<i.length;++s){for(var o=i[s];o.domStart>a;)r=n(r),a++;for(var l=0,u=o.to-o.from;u>l;++l)r=r.nextSibling,a++}for(;r;)r=n(r)}else Bi.innerHTML="";var c=i.shift(),r=Bi.firstChild,l=e,d=un.from.line,p=un.to.line,f=e>d&&p>=e,m=Ii.createElement("div");Wi.iter(e,t,function(e){var t=null,n=null;f?(t=0,p==l&&(f=!1,n=un.to.ch)):d==l&&(p==l?(t=un.from.ch,n=un.to.ch):(f=!0,t=un.from.ch)),c&&c.to==l&&(c=i.shift()),!c||c.from>l?(m.innerHTML=e.hidden?"<pre></pre>":e.getHTML(t,n,!0),Bi.insertBefore(m.firstChild,r)):r=r.nextSibling,++l})}function It(){if(Si.gutter||Si.lineNumbers){var e=Fi.offsetHeight,t=Ri.clientHeight;Mi.style.height=(2>e-t?t:e)+"px";var i=[],n=dn;
Wi.iter(dn,Math.max(pn,dn+1),function(e){if(e.hidden)i.push("<pre></pre>");else{var t=e.gutterMarker,a=Si.lineNumbers?n+Si.firstLineNumber:null;t&&t.text?a=t.text.replace("%N%",null!=a?a:""):null==a&&(a=""),i.push(t&&t.style?'<pre class="'+t.style+'">':"<pre>",a);for(var r=1;r<e.height;++r)i.push("<br>&nbsp;");i.push("</pre>")}++n}),Mi.style.display="none",Ni.innerHTML=i.join("");for(var a=String(Wi.size).length,r=Ni.firstChild,s=I(r),o="";s.length+o.length<a;)o+="";o&&r.insertBefore(Ii.createTextNode(o),r.firstChild),Mi.style.display="",ji.style.marginLeft=Mi.offsetWidth+"px",rn=!1}}function Dt(){var e=un.inverted?un.from:un.to,t=(oi(),ai(e,!0)),i=t.y+cn*oi();Pi.style.top=Math.max(Math.min(i,Ri.offsetHeight),0)+"px",Pi.style.left=t.x-Ri.scrollLeft+"px",D(un.from,un.to)?(Ui.style.top=t.y+"px",Ui.style.left=(Si.lineWrapping?Math.min(t.x,ji.offsetWidth):t.x)+"px",Ui.style.display=""):Ui.style.display="none"}function Pt(e,t){var i=Qi&&Mt(Qi);i&&(P(i,e)?e=i:P(t,i)&&(t=i)),Et(e,t)}function Et(e,t,i,n){if(null==i&&(i=un.from.line,n=un.to.line),!D(un.from,e)||!D(un.to,t)){if(P(t,e)){var a=t;t=e,e=a}e.line!=i&&(e=Rt(e,i,un.from.ch)),t.line!=n&&(t=Rt(t,n,un.to.ch)),D(e,t)?un.inverted=!1:D(e,un.to)?un.inverted=!1:D(t,un.from)&&(un.inverted=!0),D(e,t)?D(un.from,un.to)||en.push({from:i,to:n+1}):D(un.from,un.to)?en.push({from:e.line,to:t.line+1}):(D(e,un.from)||en.push(e.line<i?{from:e.line,to:Math.min(t.line,i)+1}:{from:i,to:Math.min(n,e.line)+1}),D(t,un.to)||en.push(t.line<n?{from:Math.max(i,e.line),to:n+1}:{from:Math.max(e.line,n),to:t.line+1})),un.from=e,un.to=t,nn=!0}}function Rt(e,t,i){function n(t){for(var n=e.line+t,a=1==t?Wi.size:-1;n!=a;){var r=S(n);if(!r.hidden){var s=e.ch;return(s>i||s>r.text.length)&&(s=r.text.length),{line:n,ch:s}}n+=t}}var a=S(e.line);return a.hidden?e.line>=t?n(1)||n(-1):n(-1)||n(1):e}function At(e,t,i){var n=Mt({line:e,ch:t||0});(i?Pt:Et)(n,n)}function Ft(e){return Math.max(0,Math.min(e,Wi.size-1))}function Mt(e){if(e.line<0)return{line:0,ch:0};
if(e.line>=Wi.size)return{line:Wi.size-1,ch:S(Wi.size-1).text.length};var t=e.ch,i=S(e.line).text.length;return null==t||t>i?{line:e.line,ch:i}:0>t?{line:e.line,ch:0}:e}function Nt(e){var t=Math.floor(Ri.clientHeight/oi()),i=un.inverted?un.from:un.to,n=f(Wi,i.line)+Math.max(t-1,1)*(e?1:-1);At(p(Wi,n),i.ch,!0)}function jt(e){var t=e?{line:0,ch:0}:{line:Wi.size-1,ch:S(Wi.size-1).text.length};Pt(t,t)}function Lt(){var e=Wi.size-1;Et({line:0,ch:0},{line:e,ch:S(e).text.length})}function Ut(e){for(var t=S(e.line).text,i=e.ch,n=e.ch;i>0&&/\w/.test(t.charAt(i-1));)--i;for(;n<t.length&&/\w/.test(t.charAt(n));)++n;Pt({line:e.line,ch:i},{line:e.line,ch:n})}function Bt(e){Pt({line:e,ch:0},{line:e,ch:S(e).text.length})}function Ot(){dt("\n","end"),"flat"!=Si.enterMode&&qt(un.from.line,"keep"==Si.enterMode?"prev":"smart")}function $t(e){function t(e){if(D(un.from,un.to))return qt(un.from.line,e);for(var t=un.to.line-(un.to.ch?0:1),i=un.from.line;t>=i;++i)qt(i,e)}switch(Qi=null,Si.tabMode){case"default":return!1;case"indent":t("smart");break;case"classic":if(D(un.from,un.to)){e?qt(un.from.line,"smart"):dt("	","end");break}case"shift":t(e?"subtract":"add")}return!0}function zt(){var e=Math.max(0,S(un.from.line).text.search(/\S/));At(un.from.line,un.from.ch<=e&&un.from.ch?0:e,!0)}function qt(e,t){if("smart"==t)if(zi.indent)var i=gi(e);else t="prev";var n,a=S(e),r=a.indentation(),s=a.text.match(/^\s*/)[0];"prev"==t?n=e?S(e-1).indentation():0:"smart"==t?n=zi.indent(i,a.text.slice(s.length)):"add"==t?n=r+Si.indentUnit:"subtract"==t&&(n=r-Si.indentUnit),n=Math.max(0,n);var o=n-r;if(o){var l="",u=0;if(Si.indentWithTabs)for(var c=Math.floor(n/z);c;--c)u+=z,l+="	";for(;n>u;)++u,l+=" "}else{if(un.from.line!=e&&un.to.line!=e)return;var l=s}ct(l,{line:e,ch:0},{line:e,ch:s.length})}function Ht(){zi=e.getMode(Si,Si.mode),Wi.iter(0,Wi.size,function(e){e.stateAfter=null}),qi=[0],yi()}function Vt(){var e=Si.gutter||Si.lineNumbers;Mi.style.display=e?"":"none",e?rn=!0:Bi.parentNode.style.marginLeft=0
}function Gt(){if(Si.lineWrapping){Di.className+=" CodeMirror-wrap";var e=Ri.clientWidth/li()-3;Wi.iter(0,Wi.size,function(t){if(!t.hidden){var i=Math.ceil(t.text.length/e)||1;1!=i&&T(t,i)}}),ji.style.width=Ai.style.width=""}else Di.className=Di.className.replace(" CodeMirror-wrap",""),ln=null,hn="",Wi.iter(0,Wi.size,function(e){1==e.height||e.hidden||T(e,1),e.text.length>hn.length&&(hn=e.text)});en.push({from:0,to:Wi.size})}function Wt(){this.set=[]}function Qt(e,t,i){function n(e,t,i,n){mark=S(e).addMark(new a(t,i,n,r.set))}e=Mt(e),t=Mt(t);var r=new Wt;if(e.line==t.line)n(e.line,e.ch,t.ch,i);else{n(e.line,e.ch,null,i);for(var s=e.line+1,o=t.line;o>s;++s)n(s,null,null,i);n(t.line,null,t.ch,i)}return en.push({from:e.line,to:t.line+1}),r}function Kt(e){e=Mt(e);var t=new r(e.ch);return S(e.line).addMark(t),t}function Yt(e,t,i){return"number"==typeof e&&(e=S(Ft(e))),e.gutterMarker={text:t,style:i},rn=!0,e}function Xt(e){"number"==typeof e&&(e=S(Ft(e))),e.gutterMarker=null,rn=!0}function Jt(e,t){var i=e,n=e;return"number"==typeof e?n=S(Ft(e)):i=d(e),null==i?null:(t(n,i)&&en.push({from:i,to:i+1}),n)}function Zt(e,t){return Jt(e,function(e){return e.className!=t?(e.className=t,!0):void 0})}function ei(e,t){return Jt(e,function(e,i){return e.hidden!=t?(e.hidden=t,T(e,t?0:1),!t||un.from.line!=i&&un.to.line!=i||Et(Rt(un.from,un.from.line,un.from.ch),Rt(un.to,un.to.line,un.to.ch)),rn=!0):void 0})}function ti(e){if("number"==typeof e){if(!b(e))return null;var t=e;if(e=S(e),!e)return null}else{var t=d(e);if(null==t)return null}var i=e.gutterMarker;return{line:t,handle:e,text:e.text,markerText:i&&i.text,markerClass:i&&i.style,lineClass:e.className}}function ii(e){return Li.innerHTML="<pre><span>x</span></pre>",Li.firstChild.firstChild.firstChild.nodeValue=e,Li.firstChild.firstChild.offsetWidth||10}function ni(e,t){var i="";if(Si.lineWrapping){var n=e.text.indexOf(" ",t+2);i=e.text.slice(t+1,0>n?e.text.length:n+(B?5:0))}Li.innerHTML="<pre>"+e.getHTML(null,null,!1,t)+'<span id="CodeMirror-temp-'+Tn+'">'+(e.text.charAt(t)||" ")+"</span>"+i+"</pre>";
var a=document.getElementById("CodeMirror-temp-"+Tn),r=a.offsetTop,s=a.offsetLeft;if(B&&t&&0==r&&0==s){var o=document.createElement("span");o.innerHTML="x",a.parentNode.insertBefore(o,a.nextSibling),r=o.offsetTop}return{top:r,left:s}}function ai(e,t){var i,n=oi(),a=n*(f(Wi,e.line)-(t?cn:0));if(0==e.ch)i=0;else{var r=ni(S(e.line),e.ch);i=r.left,Si.lineWrapping&&(a+=Math.max(0,r.top))}return{x:i,y:a,yBot:a+n}}function ri(e,t){function i(e){var t=ni(o,e);if(u){var i=Math.round(t.top/n);return Math.max(0,t.left+(i-c)*Ri.clientWidth)}return t.left}0>t&&(t=0);var n=oi(),a=li(),r=cn+Math.floor(t/n),s=p(Wi,r);if(s>=Wi.size)return{line:Wi.size-1,ch:0};var o=S(s),l=o.text,u=Si.lineWrapping,c=u?r-f(Wi,s):0;if(0>=e&&0==c)return{line:s,ch:0};for(var d,m=0,h=0,g=l.length,v=Math.min(g,Math.ceil((e+c*Ri.clientWidth*.9)/a));;){var b=i(v);if(!(e>=b&&g>v)){d=b,g=v;break}v=Math.min(g,Math.ceil(1.2*v))}if(e>d)return{line:s,ch:g};for(v=Math.floor(.8*g),b=i(v),e>b&&(m=v,h=b);;){if(1>=g-m)return{line:s,ch:d-e>e-h?m:g};var y=Math.ceil((m+g)/2),_=i(y);_>e?(g=y,d=_):(m=y,h=_)}}function si(e){var t=ai(e,!0),i=k(ji);return{x:i.left+t.x,y:i.top+t.y,yBot:i.top+t.yBot}}function oi(){var e=Bi.offsetHeight;return e==Cn?wn:(Cn=e,Li.innerHTML="<pre>x<br>x<br>x<br>x<br>x<br>x<br>x<br>x<br>x<br>x</pre>",wn=Li.firstChild.offsetHeight/10||1)}function li(){return Ri.clientWidth==Cn?Sn:(Cn=Ri.clientWidth,Sn=ii("x"))}function ui(){return ji.offsetTop}function ci(){return ji.offsetLeft}function di(e,t){var i,n,a=k(Ri,!0);try{i=e.clientX,n=e.clientY}catch(e){return null}if(!t&&(i-a.left>Ri.clientWidth||n-a.top>Ri.clientHeight))return null;var r=k(ji,!0);return ri(i-r.left,n-r.top)}function pi(e){function t(){var e=K(Ei.value).join("\n");e!=a&&wi(dt)(e,"end"),Pi.style.position="relative",Ei.style.cssText=n,an=!1,bt(),ht()}var i=di(e);if(i&&!window.opera){(D(un.from,un.to)||P(i,un.from)||!P(i,un.to))&&wi(At)(i.line,i.ch);var n=Ei.style.cssText;Pi.style.position="absolute",Ei.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",an=!0;
var a=Ei.value=mt();if(yt(),X(Ei,0,Ei.value.length),U){y(e);var r=w(window,"mouseup",function(){r(),setTimeout(t,20)},!0)}else setTimeout(t,50)}}function fi(){clearInterval($i);var e=!0;Ui.style.visibility="",$i=setInterval(function(){Ui.style.visibility=(e=!e)?"":"hidden"},650)}function mi(e){function t(e,t,i){if(e.text)for(var n,a=e.styles,r=s?0:e.text.length-1,l=s?0:a.length-2,u=s?a.length:-2;l!=u;l+=2*o){var c=a[l];if(null==a[l+1]||a[l+1]==p){for(var d=s?0:c.length-1,h=s?c.length:-1;d!=h;d+=o,r+=o)if(r>=t&&i>r&&m.test(n=c.charAt(d))){var g=kn[n];if(">"==g.charAt(1)==s)f.push(n);else{if(f.pop()!=g.charAt(0))return{pos:r,match:!1};if(!f.length)return{pos:r,match:!0}}}}else r+=o*c.length}}var i=un.inverted?un.from:un.to,n=S(i.line),a=i.ch-1,r=a>=0&&kn[n.text.charAt(a)]||kn[n.text.charAt(++a)];if(r){for(var s=(r.charAt(0),">"==r.charAt(1)),o=s?1:-1,l=n.styles,u=a+1,c=0,d=l.length;d>c;c+=2)if((u-=l[c].length)<=0){var p=l[c+1];break}for(var f=[n.text.charAt(a)],m=/[(){}[\]]/,c=i.line,d=s?Math.min(c+100,Wi.size):Math.max(-1,c-100);c!=d;c+=o){var n=S(c),h=c==i.line,g=t(n,h&&s?a+1:0,h&&!s?a:n.text.length);if(g)break}g||(g={pos:null,match:!1});var p=g.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",v=Qt({line:i.line,ch:a},{line:i.line,ch:a+1},p),b=null!=g.pos&&Qt({line:c,ch:g.pos},{line:c,ch:g.pos+1},p),y=wi(function(){v.clear(),b&&b.clear()});e?setTimeout(y,800):on=y}}function hi(e){for(var t,i,n=e,a=e-40;n>a;--n){if(0==n)return 0;var r=S(n-1);if(r.stateAfter)return n;var s=r.indentation();(null==i||t>s)&&(i=n-1,t=s)}return i}function gi(e){var n=hi(e),a=n&&S(n-1).stateAfter;return a=a?t(zi,a):i(zi),Wi.iter(n,e,function(e){e.highlight(zi,a),e.stateAfter=t(zi,a)}),e>n&&en.push({from:n,to:e}),e<Wi.size&&!S(e).stateAfter&&qi.push(e),a}function vi(e,i){var n=gi(e);Wi.iter(e,i,function(e){e.highlight(zi,n),e.stateAfter=t(zi,n)})}function bi(){for(var e=+new Date+Si.workTime,n=qi.length;qi.length;){if(S(dn).stateAfter)var a=qi.pop();else var a=dn;if(!(a>=Wi.size)){var r=hi(a),s=r&&S(r-1).stateAfter;
s=s?t(zi,s):i(zi);var o=0,l=zi.compareStates,u=!1,c=r,d=!1;if(Wi.iter(c,Wi.size,function(i){var n=i.stateAfter;if(+new Date>e)return qi.push(c),yi(Si.workDelay),u&&en.push({from:a,to:c+1}),d=!0;var r=i.highlight(zi,s);if(r&&(u=!0),i.stateAfter=t(zi,s),l){if(n&&l(n,s))return!0}else if(r===!1&&n){if(++o>3)return!0}else o=0;++c}),d)return;u&&en.push({from:a,to:c+1})}}n&&Si.onHighlightComplete&&Si.onHighlightComplete(_n)}function yi(e){qi.length&&Gi.set(e,wi(bi))}function _i(){Zi=null,en=[],tn=nn=!1}function xi(){var e=!1;nn&&(e=!xt()),en.length?St(en):(nn&&Dt(),rn&&It()),e&&xt(),nn&&(_t(),fi()),Hi&&!an&&(Zi===!0||Zi!==!1&&nn)&&bt(),nn&&Si.matchBrackets&&setTimeout(wi(function(){on&&(on(),on=null),mi(!1)}),20);var t=tn;nn&&Si.onCursorActivity&&Si.onCursorActivity(_n),t&&Si.onChange&&_n&&Si.onChange(_n,t)}function wi(e){return function(){In++||_i();try{var t=e.apply(this,arguments)}finally{--In||xi()}return t}}function Ci(e,t,i){if(this.atOccurrence=!1,null==i&&(i="string"==typeof e&&e==e.toLowerCase()),t=t&&"object"==typeof t?Mt(t):{line:0,ch:0},this.pos={from:t,to:t},"string"!=typeof e)this.matches=function(t,i){if(t)for(var n=S(i.line).text.slice(0,i.ch),a=n.match(e),r=0;a;){var s=n.indexOf(a[0]);r+=s,n=n.slice(s+1);var o=n.match(e);if(!o)break;a=o,r++}else var n=S(i.line).text.slice(i.ch),a=n.match(e),r=a&&i.ch+n.indexOf(a[0]);return a?{from:{line:i.line,ch:r},to:{line:i.line,ch:r+a[0].length},match:a}:void 0};else{i&&(e=e.toLowerCase());var n=i?function(e){return e.toLowerCase()}:function(e){return e},a=e.split("\n");this.matches=1==a.length?function(t,i){var a,r=n(S(i.line).text),s=e.length;return(t?i.ch>=s&&-1!=(a=r.lastIndexOf(e,i.ch-s)):-1!=(a=r.indexOf(e,i.ch)))?{from:{line:i.line,ch:a},to:{line:i.line,ch:a+s}}:void 0}:function(e,t){var i=t.line,r=e?a.length-1:0,s=a[r],o=n(S(i).text),l=e?o.indexOf(s)+s.length:o.lastIndexOf(s);if(!(e?l>=t.ch||l!=s.length:l<=t.ch||l!=o.length-s.length))for(;;){if(e?!i:i==Wi.size-1)return;if(o=n(S(i+=e?-1:1).text),s=a[e?--r:++r],!(r>0&&r<a.length-1)){var u=e?o.lastIndexOf(s):o.indexOf(s)+s.length;
if(e?u!=o.length-s.length:u!=s.length)return;var c={line:t.line,ch:l},d={line:i,ch:u};return{from:e?d:c,to:e?c:d}}if(o!=s)return}}}}var Si={},Ti=e.defaults;for(var ki in Ti)Ti.hasOwnProperty(ki)&&(Si[ki]=(o&&o.hasOwnProperty(ki)?o:Ti)[ki]);var Ii=Si.document,Di=Ii.createElement("div");Di.className="CodeMirror"+(Si.lineWrapping?" CodeMirror-wrap":""),Di.innerHTML='<div style="overflow: hidden; position: relative; width: 1px; height: 0px;"><textarea style="position: absolute; width: 10000px;" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-'+Si.theme+'"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative"><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden"></div><pre class="CodeMirror-cursor">&#160;</pre><div></div></div></div></div></div></div>',n.appendChild?n.appendChild(Di):n(Di);var Pi=Di.firstChild,Ei=Pi.firstChild,Ri=Di.lastChild,Ai=Ri.firstChild,Fi=Ai.firstChild,Mi=Fi.firstChild,Ni=Mi.firstChild,ji=Mi.nextSibling.firstChild,Li=ji.firstChild,Ui=Li.nextSibling,Bi=Ui.nextSibling;O||(ji.draggable=!0),null!=Si.tabindex&&(Ei.tabindex=Si.tabindex),Si.gutter||Si.lineNumbers||(Mi.style.display="none");try{ii("x")}catch(Oi){throw Oi.message.match(/unknown runtime/i)&&(Oi=new Error("A CodeMirror inside a P-style element does not work in Internet Explorer. (innerHTML bug)")),Oi}var $i,zi,qi,Hi,Vi=new C,Gi=new C,Wi=new u([new l([new s("")])]);Ht();var Qi,Ki,Yi,Xi,Ji,Zi,en,tn,nn,an,rn,sn,on,ln,un={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},cn=0,dn=0,pn=0,fn=0,mn=null,hn="";wi(function(){M(Si.value||""),Zi=!1})();var gn=new m,vn=2e3,bn=!H&&!q&&(U||window.opera);Si.pollForIME&&bn&&(vn=50),w(Ri,"mousedown",wi(G)),w(Ri,"dblclick",wi(Q)),w(ji,"dragstart",Z),w(ji,"selectstart",v),U||w(Ri,"contextmenu",pi),w(Ri,"scroll",function(){St([]),Si.fixedGutter&&(Mi.style.left=Ri.scrollLeft+"px"),Si.onScroll&&Si.onScroll(_n)
}),w(window,"resize",function(){St(!0)}),w(Ei,"keyup",wi(tt)),w(Ei,"input",function(){gt(mn)}),w(Ei,"keydown",wi(et)),w(Ei,"keypress",wi(it)),w(Ei,"focus",nt),w(Ei,"blur",at),w(Ri,"dragenter",y),w(Ri,"dragover",y),w(Ri,"drop",wi(J)),w(Ri,"paste",function(){yt(),gt()}),w(Ei,"paste",function(){gt()}),w(Ei,"cut",function(){gt()});var yn;try{yn=Ii.activeElement==Ei}catch(Oi){}yn?setTimeout(nt,20):at();var _n=Di.CodeMirror={getValue:N,setValue:wi(M),getSelection:mt,replaceSelection:wi(dt),focus:function(){yt(),nt(),gt()},setOption:function(e,t){var i=Si[e];Si[e]=t,"mode"==e||"indentUnit"==e?Ht():"readOnly"==e&&"nocursor"==t?Ei.blur():"theme"==e?Ri.className=Ri.className.replace(/cm-s-\w+/,"cm-s-"+t):"lineWrapping"==e&&i!=t?wi(Gt)():"pollForIME"==e&&bn&&(vn=t?50:2e3),("lineNumbers"==e||"gutter"==e||"firstLineNumber"==e||"theme"==e)&&wi(Vt)()},getOption:function(e){return Si[e]},undo:wi(ot),redo:wi(lt),indentLine:wi(function(e,t){b(e)&&qt(e,null==t?"smart":t?"add":"subtract")}),historySize:function(){return{undo:gn.done.length,redo:gn.undone.length}},clearHistory:function(){gn=new m},matchBrackets:wi(function(){mi(!0)}),getTokenAt:wi(function(e){return e=Mt(e),S(e.line).getTokenAt(zi,gi(e.line),e.ch)}),getStateAfter:function(e){return e=Ft(null==e?Wi.size-1:e),gi(e+1)},cursorCoords:function(e){return null==e&&(e=un.inverted),si(e?un.from:un.to)},charCoords:function(e){return si(Mt(e))},coordsChar:function(e){var t=k(ji);return ri(e.x-t.left,e.y-t.top)},getSearchCursor:function(e,t,i){return new Ci(e,t,i)},markText:wi(Qt),setBookmark:Kt,setMarker:wi(Yt),clearMarker:wi(Xt),setLineClass:wi(Zt),hideLine:wi(function(e){return ei(e,!0)}),showLine:wi(function(e){return ei(e,!1)}),lineInfo:ti,addWidget:function(e,t,i,n,a){e=ai(Mt(e));var r=e.yBot,s=e.x;if(t.style.position="absolute",Ai.appendChild(t),"over"==n)r=e.y;else if("near"==n){var o=Math.max(Ri.offsetHeight,Wi.height*oi()),l=Math.max(Ai.clientWidth,ji.clientWidth)-ci();e.yBot+t.offsetHeight>o&&e.y>t.offsetHeight&&(r=e.y-t.offsetHeight),s+t.offsetWidth>l&&(s=l-t.offsetWidth)
}t.style.top=r+ui()+"px",t.style.left=t.style.right="","right"==a?(s=Ai.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==a?s=0:"middle"==a&&(s=(Ai.clientWidth-t.offsetWidth)/2),t.style.left=s+ci()+"px"),i&&wt(s,r,s+t.offsetWidth,r+t.offsetHeight)},lineCount:function(){return Wi.size},getCursor:function(e){return null==e&&(e=un.inverted),E(e?un.from:un.to)},somethingSelected:function(){return!D(un.from,un.to)},setCursor:wi(function(e,t){null==t&&"number"==typeof e.line?At(e.line,e.ch):At(e,t)}),setSelection:wi(function(e,t){Et(Mt(e),Mt(t||e))}),getLine:function(e){return b(e)?S(e).text:void 0},setLine:wi(function(e,t){b(e)&&ct(t,{line:e,ch:0},{line:e,ch:S(e).text.length})}),removeLine:wi(function(e){b(e)&&ct("",{line:e,ch:0},Mt({line:e+1,ch:0}))}),replaceRange:wi(ct),getRange:function(e,t){return ft(Mt(e),Mt(t))},coordsFromIndex:function(e){var t,i=0;return Wi.iter(0,Wi.size,function(n){var a=n.text.length+1;return a>e?(t=e,!0):(e-=a,void++i)}),Mt({line:i,ch:t})},operation:function(e){return wi(e)()},refresh:function(){St(!0)},getInputField:function(){return Ei},getWrapperElement:function(){return Di},getScrollerElement:function(){return Ri},getGutterElement:function(){return Mi}},xn=!1;Wt.prototype.clear=wi(function(){for(var e=0,t=this.set.length;t>e;++e){var i=this.set[e].marked;if(i)for(var n=0;n<i.length;++n)i[n].set==this.set&&i.splice(n--,1)}en.push({from:0,to:Wi.size})}),Wt.prototype.find=function(){for(var e,t,i=0,n=this.set.length;n>i;++i)for(var a=this.set[i],r=a.marked,s=0;s<r.length;++s){var o=r[s];if(o.set==this.set&&(null!=o.from||null!=o.to)){var l=d(a);null!=l&&(null!=o.from&&(e={line:l,ch:o.from}),null!=o.to&&(t={line:l,ch:o.to}))}}return{from:e,to:t}};var wn,Cn,Sn,Tn=Math.floor(16777215*Math.random()).toString(16),Cn=0,kn={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},In=0;Ci.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t={line:e,ch:0};return i.pos={from:t,to:t},i.atOccurrence=!1,!1
}for(var i=this,n=Mt(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,n))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!n.line)return t(0);n={line:n.line-1,ch:S(n.line-1).text.length}}else{if(n.line==Wi.size-1)return t(Wi.size);n={line:n.line+1,ch:0}}}},from:function(){return this.atOccurrence?E(this.pos.from):void 0},to:function(){return this.atOccurrence?E(this.pos.to):void 0},replace:function(e){var t=this;this.atOccurrence&&wi(function(){t.pos.to=ct(e,t.pos.from,t.pos.to)})()}};for(var Dn in j)j.propertyIsEnumerable(Dn)&&!_n.propertyIsEnumerable(Dn)&&(_n[Dn]=j[Dn]);return _n}function t(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var i={};for(var n in t){var a=t[n];a instanceof Array&&(a=a.concat([])),i[n]=a}return i}function i(e,t,i){return e.startState?e.startState(t,i):!0}function n(e){this.pos=this.start=0,this.string=e}function a(e,t,i,n){this.from=e,this.to=t,this.style=i,this.set=n}function r(e){this.from=e,this.to=e,this.line=null}function s(e,t){this.styles=t||[e,null],this.text=e,this.height=1,this.marked=this.gutterMarker=this.className=null,this.stateAfter=this.parent=this.hidden=null}function o(e,t,i,n){for(var a=0,r=0,s=0;t>r;a+=2){var o=i[a],l=r+o.length;0==s?(l>e&&n.push(o.slice(e-r,Math.min(o.length,t-r)),i[a+1]),l>=e&&(s=1)):1==s&&(l>t?n.push(o.slice(0,t-r),i[a+1]):n.push(o,i[a+1])),r=l}}function l(e){this.lines=e,this.parent=null;for(var t=0,i=e.length,n=0;i>t;++t)e[t].parent=this,n+=e[t].height;this.height=n}function u(e){this.children=e;for(var t=0,i=0,n=0,a=e.length;a>n;++n){var r=e[n];t+=r.chunkSize(),i+=r.height,r.parent=this}this.size=t,this.height=i,this.parent=null}function c(e,t){for(;;){for(var i=0,n=e.children.length;n>i;++i){var a=e.children[i],r=a.chunkSize();if(r>t){e=a;break}t-=r}if(e.lines)return e.lines[t]}}function d(e){if(null==e.parent)return null;for(var t=e.parent,i=F(t.lines,e),n=t.parent;n;t=n,n=n.parent){var a=0;for(n.children.length;n.children[a]!=t;++a)i+=n.children[a].chunkSize()}return i
}function p(e,t){var i=0;e:do{for(var n=0,a=e.children.length;a>n;++n){var r=e.children[n],s=r.height;if(s>t){e=r;continue e}t-=s,i+=r.chunkSize()}return i}while(!e.lines);for(var n=0,a=e.lines.length;a>n;++n){var o=e.lines[n],l=o.height;if(l>t)break;t-=l}return i+n}function f(e,t){var i=0;e:do{for(var n=0,a=e.children.length;a>n;++n){var r=e.children[n],s=r.chunkSize();if(s>t){e=r;continue e}t-=s,i+=r.height}return i}while(!e.lines);for(var n=0;t>n;++n)i+=e.lines[n].height;return i}function m(){this.time=0,this.done=[],this.undone=[]}function h(){y(this)}function g(e){return e.stop||(e.stop=h),e}function v(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function b(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function y(e){v(e),b(e)}function _(e){return e.target||e.srcElement}function x(e){return e.which?e.which:1&e.button?1:2&e.button?3:4&e.button?2:void 0}function w(e,t,i,n){function a(e){i(e||window.event)}if("function"==typeof e.addEventListener){if(e.addEventListener(t,a,!1),n)return function(){e.removeEventListener(t,a,!1)}}else if(e.attachEvent("on"+t,a),n)return function(){e.detachEvent("on"+t,a)}}function C(){this.id=null}function S(e,t){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var i=0,n=0;t>i;++i)"	"==e.charAt(i)?n+=z-n%z:++n;return n}function T(e){return e.currentStyle?e.currentStyle:window.getComputedStyle(e,null)}function k(e,t){for(var i=e.ownerDocument.body,n=0,a=0,r=!1,s=e;s;s=s.offsetParent){var o=s.offsetLeft,l=s.offsetTop;s==i?(n+=Math.abs(o),a+=Math.abs(l)):(n+=o,a+=l),t&&"fixed"==T(s).position&&(r=!0)}for(var u=t&&!r?null:i,s=e.parentNode;s!=u;s=s.parentNode)null!=s.scrollLeft&&(n-=s.scrollLeft,a-=s.scrollTop);return{left:n,top:a}}function I(e){return e.textContent||e.innerText||e.nodeValue||""}function D(e,t){return e.line==t.line&&e.ch==t.ch}function P(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function E(e){return{line:e.line,ch:e.ch}}function R(e){return Q?(W.innerHTML="",W.appendChild(document.createTextNode(e))):W.textContent=e,W.innerHTML
}function A(e,t){if(!t)return e?e.length:0;if(!e)return t.length;for(var i=e.length,n=t.length;i>=0&&n>=0&&e.charAt(i)==t.charAt(n);--i,--n);return n+1}function F(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0,n=e.length;n>i;++i)if(e[i]==t)return i;return-1}e.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,tabMode:"classic",enterMode:"indent",electricChars:!0,onKeyEvent:null,lineWrapping:!1,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,readOnly:!1,smartHome:!0,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:!1,workTime:100,workDelay:200,undoDepth:40,tabindex:null,pollForIME:!1,document:window.document};var M={},N={};e.defineMode=function(t,i){e.defaults.mode||"null"==t||(e.defaults.mode=t),M[t]=i},e.defineMIME=function(e,t){N[e]=t},e.getMode=function(t,i){if("string"==typeof i&&N.hasOwnProperty(i)&&(i=N[i]),"string"==typeof i)var n=i,a={};else if(null!=i)var n=i.name,a=i;var r=M[n];return r?r(t,a||{}):(window.console&&console.warn("No mode "+n+" found, falling back to plain text."),e.getMode(t,"text/plain"))},e.listModes=function(){var e=[];for(var t in M)M.propertyIsEnumerable(t)&&e.push(t);return e},e.listMIMEs=function(){var e=[];for(var t in N)N.propertyIsEnumerable(t)&&e.push({mime:t,mode:N[t]});return e};var j={};e.defineExtension=function(e,t){j[e]=t},e.fromTextArea=function(t,i){function n(){t.value=o.getValue()}function a(){n(),t.form.submit=s,t.form.submit(),t.form.submit=a}if(i||(i={}),i.value=t.value,!i.tabindex&&t.tabindex&&(i.tabindex=t.tabindex),t.form){var r=w(t.form,"submit",n,!0);if("function"==typeof t.form.submit){var s=t.form.submit;t.form.submit=a}}t.style.display="none";var o=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},i);return o.save=n,o.toTextArea=function(){n(),t.parentNode.removeChild(o.getWrapperElement()),t.style.display="",t.form&&(r(),"function"==typeof t.form.submit&&(t.form.submit=s))},o},e.copyState=t,e.startState=i,n.prototype={eol:function(){return this.pos>=this.string.length
},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var i=t==e;else var i=t&&(e.test?e.test(t):e(t));return i?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return S(this.string,this.start)},indentation:function(){return S(this.string)},match:function(e,t,i){function n(e){return i?e.toLowerCase():e}if("string"!=typeof e){var a=this.string.slice(this.pos).match(e);return a&&t!==!1&&(this.pos+=a[0].length),a}return n(this.string).indexOf(n(e),this.pos)==this.pos?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},e.StringStream=n,a.prototype={attach:function(e){this.set.push(e)},detach:function(e){var t=F(this.set,e);t>-1&&this.set.splice(t,1)},split:function(e,t){if(this.to<=e&&null!=this.to)return null;var i=this.from<e||null==this.from?null:this.from-e+t,n=null==this.to?null:this.to-e+t;return new a(i,n,this.style,this.set)},dup:function(){return new a(null,null,this.style,this.set)},clipTo:function(e,t,i,n,a){null!=this.from&&this.from>=t&&(this.from=Math.max(n,this.from)+a),null!=this.to&&this.to>t&&(this.to=n<this.to?this.to+a:t),e&&n>this.from&&(n<this.to||null==this.to)&&(this.from=null),i&&(t<this.to||null==this.to)&&(t>this.from||null==this.from)&&(this.to=null)},isDead:function(){return null!=this.from&&null!=this.to&&this.from>=this.to},sameSet:function(e){return this.set==e.set}},r.prototype={attach:function(e){this.line=e},detach:function(e){this.line==e&&(this.line=null)
},split:function(e,t){return e<this.from?(this.from=this.to=this.from-e+t,this):void 0},isDead:function(){return this.from>this.to},clipTo:function(e,t,i,n,a){(e||t<this.from)&&(i||n>this.to)?(this.from=0,this.to=-1):this.from>t&&(this.from=this.to=Math.max(n,this.from)+a)},sameSet:function(){return!1},find:function(){return this.line&&this.line.parent?{line:d(this.line),ch:this.from}:null},clear:function(){if(this.line){var e=F(this.line.marked,this);-1!=e&&this.line.marked.splice(e,1),this.line=null}}},s.inheritMarks=function(e,t){var i=new s(e),n=t.marked;if(n)for(var a=0;a<n.length;++a)if(null==n[a].to&&n[a].style){var r=i.marked||(i.marked=[]),o=n[a],l=o.dup();r.push(l),l.attach(i)}return i},s.prototype={replace:function(e,t,i){e||null!=t&&t!=this.text.length||(this.className=this.gutterMarker=null);var n=[],a=this.marked,r=null==t?this.text.length:t;if(o(0,e,this.styles,n),i&&n.push(i,null),o(r,this.text.length,this.styles,n),this.styles=n,this.text=this.text.slice(0,e)+i+this.text.slice(r),this.stateAfter=null,a)for(var s=i.length-(r-e),l=0,u=a[l];l<a.length;++l)u.clipTo(null==e,e||0,null==t,r,s),u.isDead()&&(u.detach(this),a.splice(l--,1))},split:function(e,t){var i=[t,null],n=this.marked;o(e,this.text.length,this.styles,i);var a=new s(t+this.text.slice(e),i);if(n)for(var r=0;r<n.length;++r){var l=n[r],u=l.split(e,t.length);u&&(a.marked||(a.marked=[]),a.marked.push(u),u.attach(a))}return a},append:function(e){var t=this.text.length,i=e.marked,n=this.marked;if(this.text+=e.text,o(0,e.text.length,e.styles,this.styles),n)for(var a=0;a<n.length;++a)null==n[a].to&&(n[a].to=t);if(i&&i.length){n||(this.marked=n=[]);e:for(var a=0;a<i.length;++a){var r=i[a];if(!r.from)for(var s=0;s<n.length;++s){var l=n[s];if(l.to==t&&l.sameSet(r)){l.to=null==r.to?null:r.to+t,l.isDead()&&(l.detach(this),i.splice(a--,1));continue e}}n.push(r),r.attach(this),r.from+=t,null!=r.to&&(r.to+=t)}}},fixMarkEnds:function(e){var t=this.marked,i=e.marked;if(t)for(var n=0;n<t.length;++n){var a=t[n],r=null==a.to;
if(r&&i)for(var s=0;s<i.length;++s)if(i[s].sameSet(a)){r=!1;break}r&&(a.to=this.text.length)}},addMark:function(e){e.attach(this),null==this.marked&&(this.marked=[]),this.marked.push(e),this.marked.sort(function(e,t){return(e.from||0)-(t.from||0)})},highlight:function(e,t){var i,a=new n(this.text),r=this.styles,s=0,o=!1,l=r[0];for(""==this.text&&e.blankLine&&e.blankLine(t);!a.eol();){var u=e.token(a,t),c=this.text.slice(a.start,a.pos);if(a.start=a.pos,s&&r[s-1]==u?r[s-2]+=c:c&&(!o&&(r[s+1]!=u||s&&r[s-2]!=i)&&(o=!0),r[s++]=c,r[s++]=u,i=l,l=r[s]),a.pos>5e3){r[s++]=this.text.slice(a.pos),r[s++]=null;break}}return r.length!=s&&(r.length=s,o=!0),s&&r[s-2]!=i&&(o=!0),o||(r.length<5&&this.text.length<10?null:!1)},getTokenAt:function(e,t,i){for(var a=this.text,r=new n(a);r.pos<i&&!r.eol();){r.start=r.pos;var s=e.token(r,t)}return{start:r.start,end:r.pos,string:r.current(),className:s||null,state:t}},indentation:function(){return S(this.text)},getHTML:function(e,t,i,n){function a(e,t){e&&(o&&B&&" "==e.charAt(0)&&(e=""+e.slice(1)),o=!1,t?s.push('<span class="',t,'">',R(e),"</span>"):s.push(R(e)))}function r(){c&&(g+=1,v=g<c.length?c[g]:null)}var s=[],o=!0;i&&s.push(this.className?'<pre class="'+this.className+'">':"<pre>");var l=this.styles,u=this.text,c=this.marked;e==t&&(e=null);var d=u.length;if(null!=n&&(d=Math.min(n,d)),u||null!=n)if(c||null!=e){var p,f=0,m=0,h="",g=-1,v=null;for(r();d>f;){var b=d,y="";for(null!=e&&(e>f?b=e:(null==t||t>f)&&(y=" CodeMirror-selected",null!=t&&(b=Math.min(b,t))));v&&null!=v.to&&v.to<=f;)r();for(v&&(v.from>f?b=Math.min(b,v.from):(y+=" "+v.style,null!=v.to&&(b=Math.min(b,v.to))));;){var _=f+h.length,x=p;if(y&&(x=p?p+y:y),a(_>b?h.slice(0,b-f):h,x),_>=b){h=h.slice(b-f),f=b;break}f=_,h=l[m++],p="cm-"+l[m++]}}null!=e&&null==t&&a(" ","CodeMirror-selected")}else for(var m=0,w=0;d>w;m+=2){var C=l[m],p=l[m+1],S=C.length;w+S>d&&(C=C.slice(0,d-w)),w+=S,a(C,p&&"cm-"+p)}else a(" ",null!=e&&null==t?"CodeMirror-selected":null);return i&&s.push("</pre>"),s.join("")
},cleanUp:function(){if(this.parent=null,this.marked)for(var e=0,t=this.marked.length;t>e;++e)this.marked[e].detach(this)}},l.prototype={chunkSize:function(){return this.lines.length},remove:function(e,t){for(var i=e,n=e+t;n>i;++i){var a=this.lines[i];a.cleanUp(),this.height-=a.height}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertHeight:function(e,t,i){this.height+=i,this.lines.splice.apply(this.lines,[e,0].concat(t));for(var n=0,a=t.length;a>n;++n)t[n].parent=this},iterN:function(e,t,i){for(var n=e+t;n>e;++e)if(i(this.lines[e]))return!0}},u.prototype={chunkSize:function(){return this.size},remove:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var n=this.children[i],a=n.chunkSize();if(a>e){var r=Math.min(t,a-e),s=n.height;if(n.remove(e,r),this.height-=s-n.height,a==r&&(this.children.splice(i--,1),n.parent=null),0==(t-=r))break;e=0}else e-=a}if(this.size-t<25){var o=[];this.collapse(o),this.children=[new l(o)]}},collapse:function(e){for(var t=0,i=this.children.length;i>t;++t)this.children[t].collapse(e)},insert:function(e,t){for(var i=0,n=0,a=t.length;a>n;++n)i+=t[n].height;this.insertHeight(e,t,i)},insertHeight:function(e,t,i){this.size+=t.length,this.height+=i;for(var n=0,a=this.children.length;a>n;++n){var r=this.children[n],s=r.chunkSize();if(s>=e){if(r.insertHeight(e,t,i),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var o=r.lines.splice(r.lines.length-25,25),u=new l(o);r.height-=u.height,this.children.splice(n+1,0,u),u.parent=this}this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),i=new u(t);if(e.parent){e.size-=i.size,e.height-=i.height;var n=F(e.parent.children,e);e.parent.children.splice(n+1,0,i)}else{var a=new u(e.children);a.parent=e,e.children=[a,i],e=a}i.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iter:function(e,t,i){this.iterN(e,t-e,i)},iterN:function(e,t,i){for(var n=0,a=this.children.length;a>n;++n){var r=this.children[n],s=r.chunkSize();
if(s>e){var o=Math.min(t,s-e);if(r.iterN(e,o,i))return!0;if(0==(t-=o))break;e=0}else e-=s}}},m.prototype={addChange:function(e,t,i){this.undone.length=0;var n=+new Date,a=this.done[this.done.length-1];if(n-this.time>400||!a||a.start>e+t||a.start+a.added<e-a.added+a.old.length)this.done.push({start:e,added:t,old:i});else{var r=0;if(e<a.start){for(var s=a.start-e-1;s>=0;--s)a.old.unshift(i[s]);a.added+=a.start-e,a.start=e}else a.start<e&&(r=e-a.start,t+=r);for(var s=a.added-r,o=i.length;o>s;++s)a.old.push(i[s]);a.added<t&&(a.added=t)}this.time=n}},C.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}};var L=function(){if(/MSIE [1-8]\b/.test(navigator.userAgent))return!1;var e=document.createElement("div");return"draggable"in e}(),U=/gecko\/\d{7}/i.test(navigator.userAgent),B=/MSIE \d/.test(navigator.userAgent),O=/WebKit\//.test(navigator.userAgent),$="\n";!function(){var e=document.createElement("textarea");e.value="foo\nbar",e.value.indexOf("\r")>-1&&($="\r\n")}();for(var z=8,q=/Mac/.test(navigator.platform),H=/Win/.test(navigator.platform),V={},G=35;40>=G;++G)V[G]=V["c"+G]=!0;null!=document.documentElement.getBoundingClientRect&&(k=function(e,t){try{var i=e.getBoundingClientRect();i={top:i.top,left:i.left}}catch(n){i={top:0,left:0}}if(!t)if(null==window.pageYOffset){var a=document.documentElement||document.body.parentNode;null==a.scrollTop&&(a=document.body),i.top+=a.scrollTop,i.left+=a.scrollLeft}else i.top+=window.pageYOffset,i.left+=window.pageXOffset;return i});var W=document.createElement("pre"),Q="	"!=R("	");e.htmlEscape=R;var K,Y,X;return K=3!="\n\nb".split(/\n/).length?function(e){for(var t,i=0,n=[];(t=e.indexOf("\n",i))>-1;)n.push(e.slice(i,"\r"==e.charAt(t-1)?t-1:t)),i=t+1;return n.push(e.slice(i)),n}:function(e){return e.split(/\r?\n/)},e.splitLines=K,window.getSelection?(Y=function(e){try{return{start:e.selectionStart,end:e.selectionEnd}}catch(t){return null}},X=O?function(e,t,i){t==i?e.setSelectionRange(t,i):(e.setSelectionRange(t,i-1),window.getSelection().modify("extend","forward","character"))
}:function(e,t,i){try{e.setSelectionRange(t,i)}catch(n){}}):(Y=function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){return null}if(!t||t.parentElement()!=e)return null;var n=e.value,a=n.length,r=e.createTextRange();r.moveToBookmark(t.getBookmark());var s=e.createTextRange();if(s.collapse(!1),r.compareEndPoints("StartToEnd",s)>-1)return{start:a,end:a};for(var o=-r.moveStart("character",-a),l=n.indexOf("\r");l>-1&&o>l;l=n.indexOf("\r",l+1),o++);if(r.compareEndPoints("EndToEnd",s)>-1)return{start:o,end:a};for(var u=-r.moveEnd("character",-a),l=n.indexOf("\r");l>-1&&u>l;l=n.indexOf("\r",l+1),u++);return{start:o,end:u}},X=function(e,t,i){var n=e.createTextRange();n.collapse(!0);for(var a=n.duplicate(),r=0,s=e.value,o=s.indexOf("\n");o>-1&&t>o;o=s.indexOf("\n",o+1))++r;for(n.move("character",t-r);o>-1&&i>o;o=s.indexOf("\n",o+1))++r;a.move("character",i-r),n.setEndPoint("EndToEnd",a),n.select()}),e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null"),e}();return e}),define("tp/codemirror.stylesheet",["jQuery"],function(e){e(document).ready(function(){function e(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}e(require.toUrl("tp/codemirror/theme/default.css"))})}),define("tp/codemirror/lib/util/runmode",["../codemirror"],function(e){e.runMode=function(t,i,n){var a=e.getMode({indentUnit:2},i),r=1==n.nodeType;if(r){var s=n,o=[];n=function(t,i){o.push("\n"==t?"<br>":i?'<span class="cm-'+e.htmlEscape(i)+'">'+e.htmlEscape(t)+"</span>":e.htmlEscape(t))}}for(var l=e.splitLines(t),u=e.startState(a),c=0,d=l.length;d>c;++c){c&&n("\n");for(var p=new e.StringStream(l[c]);!p.eol();){var f=a.token(p,u);n(p.current(),f,c,p.start),p.start=p.pos}}r&&(s.innerHTML=o.join(""))}}),define("tp/codemirror/mode/python/python",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("python",function(e,t){function i(e){return new RegExp("^(("+e.join(")|(")+"))\\b")
}function n(e,t){if(e.sol()){var i=t.scopes[0].offset;if(e.eatSpace()){var n=e.indentation();return n>i?C="indent":i>n&&(C="dedent"),null}i>0&&s(e,t)}if(e.eatSpace())return null;var r=e.peek();if("#"===r)return e.skipToEnd(),"comment";if(e.match(/^[0-9\.]/,!1)){var o=!1;if(e.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(o=!0),e.match(/^\d+\.\d*/)&&(o=!0),e.match(/^\.\d+/)&&(o=!0),o)return e.eat(/J/i),"number";var g=!1;if(e.match(/^0x[0-9a-f]+/i)&&(g=!0),e.match(/^0b[01]+/i)&&(g=!0),e.match(/^0o[0-7]+/i)&&(g=!0),e.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(e.eat(/J/i),g=!0),e.match(/^0(?![\dx])/i)&&(g=!0),g)return e.eat(/L/i),"number"}return e.match(_)?(t.tokenize=a(e.current()),t.tokenize(e,t)):e.match(f)||e.match(p)?null:e.match(d)||e.match(u)||e.match(h)?"operator":e.match(c)?null:e.match(w)?"builtin":e.match(x)?"keyword":e.match(m)?"variable":(e.next(),l)}function a(e){for(;"rub".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var i=1==e.length,a="string";return function(r,s){for(;!r.eol();)if(r.eatWhile(/[^'"\\]/),r.eat("\\")){if(r.next(),i&&r.eol())return a}else{if(r.match(e))return s.tokenize=n,a;r.eat(/['"]/)}if(i){if(t.singleLineStringErrors)return l;s.tokenize=n}return a}}function r(t,i,n){n=n||"py";var a=0;if("py"===n){for(var r=0;r<i.scopes.length;++r)if("py"===i.scopes[r].type){a=i.scopes[r].offset+e.indentUnit;break}}else a=t.column()+t.current().length;i.scopes.unshift({offset:a,type:n})}function s(e,t){if(1!=t.scopes.length){if("py"===t.scopes[0].type){for(var i=e.indentation(),n=-1,a=0;a<t.scopes.length;++a)if(i===t.scopes[a].offset){n=a;break}if(-1===n)return!0;for(;t.scopes[0].offset!==i;)t.scopes.shift();return!1}return t.scopes.shift(),!1}}function o(e,t){C=null;var i=t.tokenize(e,t),n=e.current();if("."===n)return i=t.tokenize(e,t),n=e.current(),"variable"===i?"variable":l;if("@"===n)return i=t.tokenize(e,t),n=e.current(),"variable"===i||"@staticmethod"===n||"@classmethod"===n?"meta":l;("pass"===n||"return"===n)&&(t.dedent+=1),(":"===n&&!t.lambda&&"py"==t.scopes[0].type||"indent"===C)&&r(e,t);
var a="[({".indexOf(n);return-1!==a&&r(e,t,"])}".slice(a,a+1)),"dedent"===C&&s(e,t)?l:(a="])}".indexOf(n),-1!==a&&s(e,t)?l:(t.dedent>0&&e.eol()&&"py"==t.scopes[0].type&&(t.scopes.length>1&&t.scopes.shift(),t.dedent-=1),i))}var l="error",u=new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),c=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),d=new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),p=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),f=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),m=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),h=i(["and","or","not","is","in"]),g=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield"],v=["bool","classmethod","complex","dict","enumerate","float","frozenset","int","list","object","property","reversed","set","slice","staticmethod","str","super","tuple","type"],b={types:["basestring","buffer","file","long","unicode","xrange"],keywords:["exec","print"]},y={types:["bytearray","bytes","filter","map","memoryview","open","range","zip"],keywords:["nonlocal"]};if(t.version&&3===parseInt(t.version,10)){g=g.concat(y.keywords),v=v.concat(y.types);var _=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}else{g=g.concat(b.keywords),v=v.concat(b.types);var _=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var x=i(g),w=i(v),C=null,S={startState:function(e){return{tokenize:n,scopes:[{offset:e||0,type:"py"}],lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var i=o(e,t);return t.lastToken={style:i,content:e.current()},e.eol()&&e.lambda&&(t.lambda=!1),i},indent:function(e){return e.tokenize!=n?0:e.scopes[0].offset}};return S}),e.defineMIME("text/x-python","python")}),define("tau/ui/extensions/board.editor/ui.extension.board.editor.help",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/templates/board.editor/ui.template.board.editor.filterHelp","tp/codemirror/lib/codemirror","tp/codemirror.stylesheet","tp/codemirror/lib/util/runmode","tp/codemirror/mode/python/python"],function(e,t,i,n,a){return i.extend({"bus content.ready:last + refresh.help.content":function(e,i,a){var r=this,s=n.get();
t.each(i,function(e){t.each(a,function(t,i){var n=e.find("[role="+i+"_help]");if(n.length){var a=s.bind({},{name:"rebind",predefinedFilters:t});n.find("table").remove(),n.append(a.find("table")),r.fire("content.$element.ready",n.parent())}})})},"bus afterRender:last + content.$element.ready":function(e,t,i){var n=i.find(".i-role-complex-filter-example"),a=i.find(".filter-help").attr("role")+"_button",r=t.element.find("."+a);r.toggle(n.length>0)},"bus afterRender":function(e){var i=e.data.element.find(".i-role-help"),n=t.map(i,this._initHelp.bind(this));this.fire("content.ready",n)},"bus content.$element.ready:last + destroy":function(e,t){t.off("click.helpfilter"),t=null},_initHelp:function(t){var i=e(t),n=i.parents(".i-role-filter:first").find(":text"),a=i.next(".i-role-help-content");return a.on("click.helpfilter",".i-role-predefined-filter",function(){var t=e(this).data("value");i.tauBubble("hide"),n.focus(),setTimeout(function(){n.val(t)},1)}),this.fire("content.$element.ready",a),this._initHelpBubble(i,a),a},_initHelpBubble:function(t,i){t.tauBubble({className:"i-role-taububble-ignore",content:i,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),onResize:function(e,t){var i=t.height;e.find("[role=content]").css({maxHeight:i-20,overflowY:"auto"})},onShow:function(t){this.element.toggleClass("tau-checked",!0),t.find(".i-role-output-filter").each(function(){var t=e(this);t.data("processed")||(a.runMode(t.text(),"python",this),t.data("processed",!0))})},onHide:function(){this.element.toggleClass("tau-checked",!1)}})}})}),define("tau/components/component.board.editor",["Underscore","tau/components/component.creator","tau/models/board.editor/model.board.editor.read","tau/models/board.editor/model.board.editor.write","tau/models/board.editor/model.board.filter.help","tau/models/board.editor/model.board.editor.autocomplete","tau/models/board.editor/model.board.editor.autocomplete.preloading","tau/ui/extensions/board.editor/ui.extension.board.editor.form","tau/ui/extensions/board.editor/ui.extension.board.editor.autocomplete","tau/ui/extensions/board.editor/ui.extension.board.editor.stateSetup","tau/ui/extensions/board.editor/ui.extension.board.editor.hideCards","tau/ui/extensions/board.editor/ui.extension.board.editor.nodata","tau/ui/extensions/board.plus/ui.extension.board.plus.errors","tau/ui/extensions/board.editor/ui.extension.board.editor.help","tau/components/extensions/error/extension.errorBar","tau/ui/templates/board.editor/ui.template.board.editor","tau/core/view-base"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g){return{create:function(e){var v={extensions:[i,n,a,r,s,o,l,u,c,d,p,m,f],template:h,ViewType:g.extend({"bus board.editor.setTemplate":function(e,t){this.config.template=t
}})};e.queuedBus=!0;var b=t.create(v,e);return b}}}),define("tau/models/board.editor.prioritization/model.board.editor.prioritization",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t){var i=t.data.config.context.configurator;this.fire("configurator.ready",i);var n=$.Deferred();i.service("boardSettings").get({fields:["ownerIds","prioritization","cells"],callback:e.bind(function(t){var a=e.defaults(t.prioritization||{},{mode:"enabled"});if(i.getBoardAccessService().isEditable(t,i.getLoggedUser())){var r={definition:{cells:t.cells}},s=i.getSliceFactory().create(r);s.spaceV2().done(function(e){var t=e.data,i=t.metaInfo.isPrioritizable;n.resolve({prioritization:a,access:{edit:i}})})}else n.resolve({prioritization:a,access:{edit:!1}})},this)}),n.done(e.bind(function(e){this.fire("dataBind",e)},this)),i.service("boardSettings").unbind({listener:this}),i.service("boardSettings").bind({fields:["cells"],listener:this,callback:e.bind(function(){this.fire("refresh")},this)})},"bus configurator.ready + afterRender":function(t,i,n){var a=n.element,r=i.service("boardSettings");a.on("change",":radio",function(){var t={};e.forEach(a.find("form").serializeArray(),function(e){t[e.name]=e.value}),r.set({set:{prioritization:t}})})}})}),define("tau/ui/templates/board.editor.prioritization/ui.template.board.editor.prioritization",["tau/core/templates-factory"],function(e){var t={name:"board.editor.prioritization",engine:"jqote2",markup:['<div class="tau-access-settings tau-prioritization-settings">',"<% if (this.access.edit) { %>",'<div class="tau-board-settings-group__help">','<span class="tau-help i-role-tooltipArticle" data-article-id="board.editor.prioritization">',"About Prioritize","</span>","</div>",'<div class="tau-access-type">',"<form>",'<label class="tau-line">','<div class="tau-field">','<input value="enabled" type="radio" name="mode"<% if (this.prioritization.mode == "enabled") { %> checked<% } %>>',"</div>",'<div class="tau-txt">',"<h3>Prioritization on</h3>","</div>","</label>",'<label class="tau-line">','<div class="tau-field">','<input value="disabled" type="radio" name="mode"<% if (this.prioritization.mode == "disabled") { %> checked<% } %>>',"</div>",'<div class="tau-txt">',"<h3>Prioritization off</h3>","<p> You won't be able to prioritize cards by drag and drop on this View. This option is recommended if you want to lock priorities. </p>","</div>","</label>",'<label class="tau-line tau-line-img">','<div class="tau-field">','<input value="shift" type="radio" name="mode"<% if (this.prioritization.mode == "shift") { %> checked<% } %>>',"</div>",'<div class="tau-txt">',"<h3>Prioritize only if the Shift key is pressed</h3>","<p>You won't be able to prioritize unless the Shift key is pressed.</p>","</div>","</label>","</form>","</div>","<% } %>","<% if (!this.access.edit) { %>",'<div class="tau-prioritization-text tau-bubble-tooltipArticle">',"<p>The current View settings do not allow prioritization.<p>","<p>It&#39;s either the cards cannot be prioritized together, or ranking is not applicable to them.</p>",'<p><a target="_blank"  href="http://guide.targetprocess.com/troubleshooting/cannot-prioritize-cards-on-a-board.html">Read more...</a></p>',"</div>","<% } %>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/components/component.board.editor.prioritization",["Underscore","tau/components/component.creator","tau/models/board.editor.prioritization/model.board.editor.prioritization","tau/ui/templates/board.editor.prioritization/ui.template.board.editor.prioritization"],function(e,t,i,n){return{create:function(e){var a={extensions:[i],template:n};return e["queue.bus"]=!0,t.create(a,e)}}}),define("tau/ui/extensions/board.context.container/ui.extension.board.context.container.tabs",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(t,i){this._super(t),this._selectorBusName=i,this._configuratorReadyCallbacks=e.Callbacks(),this._configuratorReadyCallbacks.once(this._onConfiguratorReady.bind(this))},resetLifecycle:!0,"bus initialize":function(){this.activeTab="selector"},"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i)},"bus show":function(){"selector"!=this.activeTab?this.fire("tab.activate","selector"):this.fire("tab.activate.completed","selector")},"bus $el.ready":function(e,t){var i=this;t.on("click",".i-role-section-teams .i-role-formtrigger",function(){i.fire("tab.activate","team.formAdd")}),t.on("click",".i-role-section-projects .i-role-formtrigger",function(){i.fire("tab.activate","project.formAdd")}),t.on("click",".i-role-section-projects .i-role-add-program-trigger",function(){i.fire("tab.activate","program.formAdd")}),t.on("click","[type=reset]",function(){i.fire("tab.activate","selector")})},"bus configurator.ready":function(e,t){this._configuratorReadyCallbacks.fire(t)},_onConfiguratorReady:function(e){e.getComponentBusRegistry().getByName("team_form_add").done(function(e){this.fire("teamFormAddBus.ready",e),e.on("entity.add.completed",this._backToMainTab.bind(this))}.bind(this)),e.getComponentBusRegistry().getByName("project_form_add").done(function(e){this.fire("projectFormAddBus.ready",e),e.on("entity.add.completed",this._backToMainTab.bind(this))
}.bind(this)),e.getComponentBusRegistry().getByName("board_selector_add-program").done(function(e){this.fire("programFormAddBus.ready",e),e.on("afterRender",function(){setTimeout(e.fire.bind(e,"show.completed"),10)}),e.on("program.add.completed",function(e,t){this._backToMainTab(),this.fire("program.add.completed",t)}.bind(this))}.bind(this)),e.getComponentBusRegistry().getByName(this._selectorBusName).done(function(e){this.fire("selectorBus.ready",e),this.on("program.add.completed",function(t,i){e.fire("program.add.completed",i)})}.bind(this))},_backToMainTab:function(){this.fire("tab.activate","selector")},"bus $bubbled.ready:last + $el.ready:last + childrenBuses.ready:last + tab.activate":function(i,n,a,r,s){t("body").data("contextOverflow",t("body").css("overflow")),t("body").css("overflow","hidden"),a.css("visibility","hidden"),a.css("overflow","hidden"),a.css("width",a.width()+"px"),a.css("height",a.height()+"px");var o;e.forEach(r,function(e,t){t!=s?e.fire("hide"):o=e}),o&&(o.once("show.completed",function(e,i){i.length&&(a.css("width","auto"),a.css("height","auto"),a.css("overflow","visible")),n.tauBubble("adjust"),a.css("visibility","visible"),t("body").css("overflow",t("body").data("contextOverflow"))},this),o.fire("show"),this.fire("tab.activate.completed",s),this.activeTab=s)},"bus teamFormAddBus.ready:last + tab.activate.completed":function(e,t,i){"team.formAdd"==i&&t.fire("show.completed")},"bus projectFormAddBus.ready:last + tab.activate.completed":function(e,t,i){"project.formAdd"==i&&t.fire("show.completed")},"bus programFormAddBus.ready:last + tab.activate.completed":function(e,t,i){"program.formAdd"==i&&t.fire("show.completed")}})}),define("tau/ui/extensions/board.context.container/ui.extension.board.context.container.bubble",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $bubbled.ready":function(t,i){i.tauBubble("option",{template:['<div class="tau-bubble-board tau-teams-projects-manager-wrapper">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),dontCloseSelectors:[".ui-autocomplete",".tau-invite-widget-tooltip"],onArrowPositionConfig:function(e){e.at="left+26 bottom"
},stackName:"contextcontainer",onResize:function(e,t){var i=t.height;e.find(".tau-managed-category .i-role-list").css({maxHeight:i-e.find(".tau-teams-projects-search").height()-e.find(".tau-teams-projects-updater").height()-200,overflowY:"auto"}),e.find(".tau-projects .i-role-form .i-role-list").css({maxHeight:i-500,overflowY:"auto"}),e.find(".tau-teams .i-role-form .i-role-list").css({maxHeight:i-400,overflowY:"auto"})},onPositionConfig:function(e){e.collision="flipfit flipfit"},show:function(){var e=i.tauBubble("widget").find(".tau-search input");e.length&&e.is(":visible")&&e.focus()}}),i.on("taububblehide.ctx",e.bind(function(e,t){t.silent||this.fire("$popup.hidden")},this)),i.on("taububbleshow",e.bind(function(){this.fire("$popup.shown"),i.tauBubble("widget").one("click",".i-role-popupcontent .i-role-action-submit",function(){i.tauBubble("hide")}),i.tauBubble("widget").one("click",".i-role-popupcontent .i-role-selecttrigger",function(){i.tauBubble("hide",{silent:!0})})},this))},"bus $bubbled.ready + afterRender":function(e,t){t.tauBubble("adjust")},"bus selectorBus.ready:last + tab.activate.completed:last + $popup.hidden":function(e,t,i){t.fire("selector"==i?"filter.submitted":"refresh")}})}),define("tau/ui/extensions/board.context.container/ui.extension.board.context.container.board",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({SUBMIT_BUTTON_TEXT:"Set","bus afterRender + childrenBuses.ready + boardSettings.ready":function(t,i,n,a){var r=n[0],s=n[1],o=i.element.find(".i-role-output");this._bs=a.boardSettings,s.fire("$trigger.ready",o),r.on("refresh",function(){s.fire("hide",{silent:!0})}),o.on("click",function(t){var i=e(t.target),n=i.closest(".tau-context");(!n.closest(".tau-context").length||n.is(":disabled"))&&(s.fire("hide",{silent:!0}),i.hasClass("tau-remove-selected-context")&&!i.is(":disabled")&&(o.find(".tau-line-group").removeClass("hidden"),o.find(".tau-inline-group").addClass("hidden"),a.boardSettings.set({set:{acid:""}})))}),s.on("show.completed",function(e,t){t.find("button.tau-teams-projects-submit").text(this.SUBMIT_BUTTON_TEXT),t.find(".i-role-process-submit").remove()
}.bind(this)),this._bs.bind({fields:["acid"],listener:this,callback:function(e){""!==e.acid&&(o.find(".tau-line-group").addClass("hidden"),o.find(".tau-inline-group").removeClass("hidden"))}}),s.on("show",function(){o.find(".tau-context").addClass("tau-checked")}),s.on("hide",function(){o.find(".tau-context").removeClass("tau-checked")})},"bus destroy":function(){this._bs.unbind(this)}})}),define("tau/ui/extensions/board.context.container/ui.extension.board.context.container.acid",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus boardSettings.ready:last + context.changed":function(e,t,i){t.boardSettings.set({set:{acid:i.acid}})},"bus boardSettings.ready:last + context.ready:last + currentContextSelected":function(e,t,i){t.boardSettings.set({set:{acid:i.acid}})}})}),define("tau/ui/templates/board.context.output/ui.template.board.remember.context.wrapper.output",["tau/core/templates-factory"],function(e){var t={name:"board.editor.remember.context.wrapper.output",engine:"jqote2",markup:['<div class="tau-board-settings-context">',"<h4>Set default projects and teams",'<span class="tau-help i-role-tooltipArticle" data-article-id="board.editor.saveContext"></span>',"</h4>",'<div class="i-role-output">',"</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.editor.remember.context",["Underscore","tau/components/component.container","tau/ui/extensions/board.context.container/ui.extension.board.context.container.tabs","tau/ui/extensions/board.context.container/ui.extension.board.context.container.bubble","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.context.container/ui.extension.board.context.container.board","tau/ui/extensions/board.context.container/ui.extension.board.context.container.acid","tau/ui/templates/board.context.output/ui.template.board.remember.context.wrapper.output"],function(e,t,i,n,a,r,s,o){return{create:function(e){var l={extensions:[a,r],children:[{type:"board.editor.remember.context.output",name:"board.editor.remember.context.output"},{type:"bubble.container",cssClass:"tau-teams-projects-manager-holder",visible:!1,useAnimation:!1,extensions:[{extType:i,args:["board_remember_context_selector"]},a,n],children:[{type:"container",label:"team.formAdd",visible:!1,useAnimation:!1,cssClass:"tau-teams-projects-manager",children:[{name:"team_form_add",type:"team.formAdd"}]},{type:"container",label:"project.formAdd",cssClass:"tau-teams-projects-manager",visible:!1,useAnimation:!1,children:[{name:"project_form_add",type:"project.formAdd"}]},{type:"container",label:"program.formAdd",cssClass:"tau-teams-projects-manager",visible:!1,useAnimation:!1,children:[{name:"board_selector_add-program",type:"board.selector.add-program"}]},{type:"container",label:"selector",visible:!0,useAnimation:!1,extensions:[a],children:[{name:"board_remember_context_selector",type:"board.context.selector",extensions:[s]}]}]}],template:o};
return t.create(l,e)}}}),define("tau/models/board.editor.remember.context/model.board.editor.remember.output",["Underscore","tau/models/board.context.output/model.board.context.output.data"],function(e,t){return t.extend({"bus beforeInit + boardSettings.ready:last":function(e,t,i){var n=i.boardSettings,a=function(e){this.savedAcid=e.acid}.bind(this);n.get({fields:["acid"],callback:a}),n.bind({fields:["acid"],listener:this,callback:a}),n.get({fields:["ownerIds"],callback:function(e){var t=this.configurator.getLoggedUser();this.editable=this.configurator.getBoardAccessService().isEditable(e,t)}.bind(this)})},"bus teams.ready + projects.ready + context.ready":function(e,t,i,n){var a=this.prepareModel(t,i,n);a.savedAcid=this.savedAcid,a.editable=this.editable,this.fire("dataBind",a),this._trackData(a)},"bus configurator.ready":function(e,t){this.configurator=t},"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind(this)}})}),define("tau/ui/templates/board.context.output/ui.template.board.context.output.selected.button",["tau/core/templates-factory"],function(e){var t={name:"board.context.output.selected.button",engine:"jqote2",markup:['<span class="tau-context-button-item',"<% if (this.color != null) { %>"," tau-icon_type_color","<% }%>",'"',"<% if (this.color != null) { %>",'style="background-color:<%! (this.color) %>"',"<% }%>>","<% if (this.icon != null) { %>",'<i class="tau-icon tau-icon_type_svg tau-icon-no-checked tau-icon_name_',"<%! (this.icon) %>",'"></i>','<i class="tau-icon tau-icon_type_svg tau-icon-checked tau-icon_name_',"<%! (this.whiteIcon) %>",'"></i>',"<% }%>","<%! (this.abbreviation || this.name) %>","</span>"]};return e.register(t)}),define("tau/ui/templates/board.context.output/ui.template.board.remember.context.output",["tau/core/templates-factory","tau/ui/templates/board.context.output/ui.template.board.context.output.selected.button"],function(e){var t={name:"board.context.remember.output",engine:"jqote2",markup:["<div>",'<span class="tau-inline-group',"<% if (!this.savedAcid){%> hidden<%}%>",'">','<button class="tau-btn tau-context"<% if (!this.editable){%> disabled<%}%>>','<%= fn.sub("board.context.output.selected.button", this.selectedProjects.slice(0, 3)) %>',"<% if (this.selectedProjects.length > 3) { %>",'<span class="tau-more">+<%= this.selectedProjects.length-3 %></span>',"<% } %>",'<span class="tau-context-button-item tau-teams-projects-splitter"></span>','<%= fn.sub("board.context.output.selected.button", this.selectedTeams.slice(0, 3)) %>',"<% if (this.selectedTeams.length > 3) { %>",'<span class="tau-more">+<%= this.selectedTeams.length-3 %></span>',"<% } %>","</button>",'<button type="button" name="remove_context" role="action-remove-selected-context"',' data-title="Remove&nbsp;selected&nbsp;context" ','class="tau-extension-board-tooltip tau-btn tau-close tau-remove-selected-context"',"<% if (!this.editable){%> disabled<%}%>></button>","</span>",'<span class="tau-line-group<% if (this.savedAcid){%> hidden<%}%>','">','<button class="tau-btn tau-context"<% if (!this.editable){%> disabled<%}%>>Not specified</button>','<span class="tau-context-label">Projects-Teams context from the top menu will be used</span>',"</span>","</div>"]};
return e.register(t)}),define("tau/components/component.board.editor.remember.context.output",["tau/components/component.creator","tau/models/board.editor.remember.context/model.board.editor.remember.output","tau/ui/templates/board.context.output/ui.template.board.remember.context.output"],function(e,t,i){return{create:function(n){var a={queuedBus:!0,extensions:[t],template:i};return e.create(a,n)}}}),define("tau/models/board.editor.timeline/model.board.editor.timeline",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit + boardSettings.ready:last":function(t,i,n){var a=i.config.context.configurator,r=n.boardSettings;r.get({fields:["timelineSettings","ownerIds"]}).done(function(t){var i=a.getLoggedUser(),n=e.defaults(t.timelineSettings||{},{showPlannedInPast:!1,showForecast:!1,editable:a.getBoardAccessService().isEditable(t,i)});this.fire("dataBind",n)}.bind(this)),this.on("destroy",function(){r.unbind({listener:this})}),r.unbind({listener:this}),r.bind({fields:["timelineSettings"],listener:this,callback:function(){this.fire("refresh")}.bind(this)})},"bus boardSettings.ready:last + afterRender":function(e,t,i){var n=i.element,a=t.boardSettings;n.on("change",":checkbox",function(){var e={showPlannedInPast:n.find("[name=showPlannedInPast]").prop("checked"),showForecast:n.find("[name=showForecast]").prop("checked")};a.set({set:{timelineSettings:e}})})}})}),define("tau/ui/templates/board.editor.timeline/ui.template.board.editor.timeline",["tau/core/templates-factory"],function(e){var t={name:"board.editor.timeline",engine:"jqote2",markup:["<div>","<h4>Show on cards</h4>",'<ul class="tau-timelines-cards-features">',"<li>",'<label class="tau-checkbox tau-planned-in-past"><input type="checkbox" name="showPlannedInPast"<% if (this.showPlannedInPast) { %> checked<% } if (!this.editable) {%> disabled class="permission-denied"<% } %>><i class="tau-checkbox__icon"></i>',"<span>Planned for Done</span>","</label>",'<span class="tau-help i-role-tooltipArticle" data-article-id="timeline.options.plannedInPast"></span>',"</li>","<li>",'<label class="tau-checkbox tau-forecast"><input type="checkbox" name="showForecast"<% if (this.showForecast) { %> checked<% } if (!this.editable) {%> disabled class="permission-denied"<% } %>><i class="tau-checkbox__icon"></i>',"<span>Forecast</span>","</label>",'<span class="tau-help i-role-tooltipArticle" data-article-id="timeline.options.showForecast"></span>',"</li>","</ul>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/components/component.board.editor.timeline",["Underscore","tau/components/component.creator","tau/models/board.editor.timeline/model.board.editor.timeline","tau/ui/templates/board.editor.timeline/ui.template.board.editor.timeline"],function(e,t,i,n){return{create:function(e){var a={extensions:[i],template:n};return e["queue.bus"]=!0,t.create(a,e)}}}),define("tau/models/board.entityViewer/model.board.entityViewer",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i),this.fire("dataBind",{})}})}),define("tau/ui/extensions/board.entityViewer/ui.extension.board.entityViewer",["Underscore","jQuery","tau/core/extension.base","tau/configurations/const.page.entity.actions"],function(e,t,i,n){return i.extend({"bus configurator.ready":function(t,i){var n=this,a=i.getRequireLoader();a(["all.components"],function(){a(["tau/components/component.application"],function(t){var a=i.createChild();a._id=e.uniqueId("board_entityViewer_"),a.isBoardEdition=!0,n.fire("appData.ready",{component:t,configurator:a})})})},"bus afterRender":function(){var e=t("body");e.tauProgressIndicator(),this.fire("$progressIndicator.ready",e)},"bus appData.ready":function(e,t){var i=t.configurator,n=t.component;i.getHashService().setFakeWindow();var a=this,r={name:"viewer",context:{configurator:i},options:{applicationId:"boardEntityViewerPopup",integration:{showInCoverView:!0,keepAlive:!0},routing:{silent:!0,executeOnStart:!1},comet:{enabled:!0}}},s=n.create(r);s.on("application.error",function(e){a.fire("error",e.data),a.fire("application.error",e.data)}),s.on("contentRendered",function(e){a.fire("application.contentRendered",e.data)}),s.initialize(r),a.fire("appBus.ready",s)},"bus appData.ready:last + appBus.ready:last + cardDataToShowSilent.ready":function(e,t,i,a){this.showCard(t,i,a,n.SILENT)},"bus appData.ready:last + appBus.ready:last + cardDataToShow.ready":function(e,t,i,n){this.showCard(t,i,n)
},"bus appBus.error":function(e,t){this.fire("error",t)},"bus appBus.ready + destroy":function(e,t){t.destroy()},showCard:function(e,t,i,n){var a=e.configurator;return i.entityId&&i.entityType?(this.cleanupStore(a),t.fire("history.reset"),void t.fire("application.navigate.entity",{id:i.entityId,entity:i.entityType,action:n})):void console.error("bad data for viewer",i)},cleanupStore:function(e){e.getStore().evictData()}})}),define("tau/components/component.board.entityViewer",["tau/components/component.creator","tau/models/board.entityViewer/model.board.entityViewer","tau/ui/extensions/board.entityViewer/ui.extension.board.entityViewer","tau/components/extensions/error/extension.errorBar"],function(e,t,i,n){return{create:function(a){a["queue.bus"]=!0;var r={"queue.bus":!0,extensions:[t,i,n],template:{name:"board.entityViewer",engine:"jqote2",markup:'<div style="display:none;"></div>'}};return e.create(r,a)}}}),define("tau/models/board.flowHelp/model.board.flowHelp",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(t){var i=this;if(i._super.apply(i,arguments),i.flowHelpService=t.context.configurator.getHelpScenarioService(),i.flowHelpService.on("next.section",e.bind(i.fire,i,"next.section")),i.flowHelpService.on("done.scenario",e.bind(i.fire,i,"done.section")),i.flowHelpService.getState()===i.flowHelpService.stateTypes.ToBeStarted){var n=i.flowHelpService.getCurrentFlow();i.flowHelpService.run(n)}},isInProgress:function(t){var i=t.getState(),n=t.stateTypes;return!e.contains([n.Aborted,n.Done,n.Stopped],i)},"bus beforeInit":function(){var e=this.getFlowData();this.fire("dataBind",e)},"bus next.section":function(){var e=this.getFlowData();this.fireStatsData(e),this.fire("update",e)},fireStatsData:function(t){var i=e.clone(t),n=": "+t.currentState;t.progress.done===t.progress.total&&(n="is COMPLETED"),i.name=t.name+" ("+(t.progress.done+1)+" of "+t.progress.total+") "+n,i.tags=[t.name],this.fire("help.flow.action",i)},getFlowData:function(){var t=this.flowHelpService,i=t.getCurrentFlow(),n=t.getScenarioById(i),a=t.getSubFlows(i),r="ready to start/replay",s=0;
e.each(a||[],function(e){"active"==e.state&&(r=e.name),"done"==e.state&&s++});var o=(a||[]).length;s===o&&(r="COMPLETED");var l={name:n.name,currentState:r,subFlows:a,progress:{total:o,done:s}};return l}})}),define("tau/ui/extensions/board.flowHelp/ui.extension.board.flowHelp",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(e){var t=this;t._super.apply(t,arguments),t.flowHelpService=e.context.configurator.getHelpScenarioService(),t.config=e},"bus afterRender":function(e,t){var i=this,n=t.element,a=i.flowHelpService;n.on("click",".i-role-flowhelp-stop-flow",function(){a.abort(),i.fire("help.flow.action",{name:"stop"})});var r={target:n,className:"tau-bubble-flow",stackName:"helpFlowStep",applyBubbleClasses:!1,zIndex:10,componentsConfig:{components:[{type:"board.flowHelp.popup"}],context:this.config.context},onPositionConfig:function(e){e.at="center bottom-6",e.my="center top"},onBeforeShow:function(){return n.parent().hasClass("tau-flow-started")},showArrow:!1,showCloseButton:!1};this.fire("initBubble",r)},"bus afterRender:last + update":function(e,t,i){var n=t.element;n.find(".i-role-step").text(i.progress.done+1+"/"+i.progress.total),n.find(".i-role-step_name").text(i.currentState)}})}),define("tau/ui/templates/board.flowHelp/ui.template.board.flowHelp",["tau/core/templates-factory"],function(e){var t={name:"board.flowHelp",engine:"jqote2",markup:['<div class="tau-flow-info-panel i-role-flowhelp-toggle-steps">','<div class="tau-steps">','<span class="tau-step i-role-step"><%= this.progress.done+1 %>/<%= this.progress.total %></span>','<span class="tau-step-name i-role-step_name"><%= this.currentState %></span>',"</div>",'<button class="tau-btn tau-stop-flow i-role-flowhelp-stop-flow">Stop Tour</button>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.flowHelp",["Underscore","tau/components/component.creator","tau/models/board.flowHelp/model.board.flowHelp","tau/ui/extensions/board.flowHelp/ui.extension.board.flowHelp","tau/ui/templates/board.flowHelp/ui.template.board.flowHelp","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension"],function(e,t,i,n,a,r,s){return{create:function(e){var o={extensions:[i,n,r,s],template:a,name:"board.main.menu.item.helpFlow"};
return t.create(o,e)}}}),define("tau/ui/extensions/board.flowHelp/ui.extension.board.flowHelp.popup",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(){var e=this;e._super.apply(e,arguments)},"bus afterRender:last + update":function(e,t,i){this.fire("refresh",i)}})}),define("tau/ui/templates/board.flowHelp/ui.template.board.flowHelp.popup",["tau/core/templates-factory"],function(e){var t={name:"board.flowHelp.popup",engine:"jqote2",markup:['<div class="tau-flow-steps">',"<% for (var i = 0; i < this.subFlows.length; i++) { %>","    <% var sf = this.subFlows[i]; %>",'    <% var attr = ""; %>','    <% attr += (sf.state === "done")   ? " tau-step-done"   : ""; %>','    <% attr += (sf.state === "active") ? " tau-step-current": ""; %>','    <div class="tau-step <%= attr %>"><%= sf.name %></div>',"<% } %>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.flowHelp.popup",["Underscore","tau/components/component.creator","tau/models/board.flowHelp/model.board.flowHelp","tau/ui/extensions/board.flowHelp/ui.extension.board.flowHelp.popup","tau/ui/templates/board.flowHelp/ui.template.board.flowHelp.popup"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[i,n],template:a,name:"board.helpFlow.popup"};return t.create(r,e)}}}),define("tau/models/quick.add/model.board.general.quick.add.singleQuery",["Underscore","jQuery","tau/models/quick.add/model.board.general.quick.add"],function(e,t,i){return i.extend({getDataTemplate:function(i,n,a){var r=e.find(a.action,function(e){return e.availableResource.name===n.name});return t.Deferred().resolve({data:r.fieldTemplates}).promise()},getActions:function(t,i,n){var a=t.acid,r=this.getDefinition(a),s=i.context.configurator.getSliceFactory().create({definition:r});s.globalDataTemplates().then(function(t){var r={};r.action=t.data.items,e.isEmpty(r.action)?this.processEmptyAddButtonAction(i,a,n):this.processAddButtonAction(r,s,i,n)}.bind(this))},processAddButtonAction:function(t,i,n,a){var r=e.map(t.action,function(e){return e.availableResource
});a.resolve({slice:i,types:this.getProcessedTypes(n,r),action:t.action,viewMode:this.getViewMode(),isGeneralAdd:!0})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.general",["jQuery","tau/components/extensions/component.extension.base","tau/models/quick.add/model.board.general.quick.add.singleQuery"],function(e,t,i){return t.extend({resetLifecycle:!0,"bus afterRender:last + boardSettings.ready":function(e,t,i){var n=t.element,a=i.boardSettings,r=function(e){var t=e.cells&&e.cells.types||[];this.appendQuickAddPopup(n.find("[role=action-quick-add]"),t)}.bind(this);a.get({fields:["cells"]}).done(r),a.unbind(this),a.bind({fields:["cells"],listener:this,callback:r})},"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind(this)},appendQuickAddPopup:function(e,n){var a={target:e,applyBubbleClasses:!1,cleanupOnHide:!0,stackName:"quickAddGeneral",showArrow:!0,showOnCreation:!1,zIndex:1e4,onShow:function(){e.removeClass("tau-quick-add-collapse")},onHide:function(){e.addClass("tau-quick-add-collapse")},className:"tau-quick-add-dialog-general",onPositionConfig:function(){return{of:e,collision:"none none",my:"left top",at:"left-12 bottom+1"}},dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:{components:[{name:"board plus quick add general",type:"board.cell.quick.add",extensions:t.extend({"bus beforeInit:last + afterRender":function(e,t,i){var n=i.element,a=i.data;if(a.isEmpty){var r=t.config.context.configurator.getGlobalBus();r.fire("general.quick.add.empty"),n.find(".i-role-select-context-link").on("click",function(){r.fire("select.context.link.click"),this.fire("close")}.bind(this)).addClass("ui-link")}}}),QuickAddModel:i,defaultType:n[0]}]}};this.fire("initBubble",a)}})}),define("tau/models/model.board.quick.add",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus afterInit":function(){this.fire("dataBind",{})}})}),define("tau/ui/templates/board.general.quick.add/ui.template.board.general.quick.add",["tau/core/templates-factory","tau/nls/translator"],function(e,t){var i={name:"board.general.quick.add",engine:"jqote2",markup:['<div class="tau-btn-add-bg">','<div role="action-quick-add" class="tau-btn tau-btn-big tau-quick-add-collapse tau-success tau-add tau-quick-add tau-extension-board-tooltip" data-title="'+t("Quick add work and people")+'">',"<span>Add</span>","</div>","</div>"]};
return e.register(i)}),define("tau/components/component.board.general.quick.add",["Underscore","tau/components/component.creator","tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.general","tau/models/model.board.quick.add","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/board.general.quick.add/ui.template.board.general.quick.add"],function(e,t,i,n,a,r,s){return{create:function(e){var o={extensions:[i,n,a,r],template:s};return t.create(o,e)}}}),define("tau/models/board.limits/model.board.limits",["Underscore","tau/core/model-base"],function(e,t){return t.extend({INITIAL_STATE:"b64_X0luaXRpYWw_2_",FINAL_STATE:"b64_X0ZpbmFs_",ENTITY_STATE:"entitystate","bus afterInit":function(e){this.fire("dataBind",{});var t=e.data.config.context.configurator;this.fire("configurator.ready",t)},getSlice:function(t,i){var n=$.Deferred();return this.getDefinition(i).done(e.bind(function(i){t.getAppStateStore().get({fields:["acid"],callback:function(a){var r={};r.global={acid:a.acid},r=e.extend(r,i);var s=t.getSliceFactory().create({definition:r});n.resolve(s)}})},this)),n},getDefinition:function(e){var t=$.Deferred();return e.get({fields:["cells","x","y"],callback:function(e){t.resolve({cells:e.cells,x:e.x,y:e.y})}}),t},getLimitFields:function(t,i){var n=$.Deferred();return this.getSlice(t,i).done(e.bind(function(e){var t,i=e.config.definition;i.y&&i.y.types&&i.y.types[0]==this.ENTITY_STATE&&(t="y"),i.x&&i.x.types&&i.x.types[0]==this.ENTITY_STATE&&(t="x"),t?e[t]({$take:999}).done(function(e){n.resolve(e.data.items)}):n.reject()},this)),n},limitValues:function(t){var i=$.Deferred();return t.get({fields:["limits"],callback:e.bind(function(e){i.resolve(e.limits&&e.limits[this.ENTITY_STATE]||{})},this)}),i},getAccess:function(e,t){var i=$.Deferred(),n=e.getLoggedUser(),a=e.getBoardAccessService();return t.get({fields:["ownerIds"],callback:function(e){return i.resolve({edit:a.isEditable(e,n)})
}}),i},getData:function(t,i){return $.when(this.getLimitFields(t,i),this.limitValues(i),this.getAccess(t,i)).then(e.bind(function(t,i,n){return t=e.reduce(t,function(t,n){var a="y";if(n.x&&(a="x"),n[a].toString()!==this.INITIAL_STATE&&n[a].toString()!==this.FINAL_STATE){var r=i[n[a]];(!e.isNumber(r)||e.isNaN(r))&&(r=""),n.dynamic.items[0].value=r,t.push(n.dynamic.items[0])}return t},[],this),{fields:t,access:n,values:i}},this))},loadData:function(t,i){return e.bind(function(){this.getData(t,i).done(e.bind(function(e){this.fire("dataLimits.ready",e)},this)).fail(e.bind(function(){this.fire("dataLimits.ready",{fields:[],access:{edit:!1}})},this))},this)},"bus configurator.ready + boardSettings.ready":function(e,t,i){i=i.boardSettings;var n=this.loadData(t,i);n(),t.getAppStateStore().unbind({listener:this}),t.getAppStateStore().bind({fields:["acid"],listener:this,callback:n}),i.unbind({listener:this}),i.bind({fields:["x","y","cells"],listener:this,callback:n})},"bus configurator.ready + boardSettings.ready + destroy":function(e,t,i){t.getAppStateStore().unbind({listener:this}),i.boardSettings.unbind({listener:this})}})}),define("tau/ui/templates/board.limits/ui.template.board.limit-item",["tau/core/templates-factory"],function(e){var t={name:"board.limit-item",engine:"jqote2",markup:['<div class="tau-limiter">',"<h4>Limits for States</h4>",'<div class="tau-limit-matrix">',"<%if(this.fields.length){%>","<form>","<table>","<% _.forEach(this.fields,_.bind(function(item) {%>","<tr>","<th><%=item.data.name%></th>",'<td><input class="tau-in-text <%if(!this.access.edit){%>tau-disabled<%}%>" <%if(!this.access.edit){%>disabled<%}%> name="<%=item.id%>" min="0" max="999" value="<%=item.value%>" type="number"></td>',"</tr>","<%},this));%>","</table>","</form>","<%}else{%>",'<div class="tau-empty-limit-text">There\'s no work in progress.</div>',"<%}%>","</div>","</div>"]};return e.register(t)}),define("tau/ui/extensions/board.limits/ui.extension.board.limits",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/board.limits/ui.template.board.limit-item","libs/jquery/jquery.inputMaskEditor"],function(e,t,i){return i.extend({temp:{},"bus afterRender:last + dataLimits.ready + configurator.ready:last + boardSettings.ready:last":function(t,i,n,a,r){var s=i.element;
s.html(""),this.temp=e.extend(this.temp,n.values),s.append(a.getTemplateFactory().get("board.limit-item").bind({},n)),this.setHandler(s,r.boardSettings)},setHandler:function(i,n){var a=i.find("input"),r=/^\d+$/i;a.closest("form").on("submit",function(){return!1});var s=e.debounce(e.bind(function(i){var a=t(i.target);r.test(a.val())||a.val("");var s=a.closest("form").serializeArray();s=e.reduce(s,function(e,t){return e[t.name]=parseInt(t.value,10),e},{}),this.temp=e.extend(this.temp,s),n.set({set:{limits:{entitystate:this.temp}},callback:t.noop}),this.fire("changeLimits",this.temp)},this),100);a.on("input keydown",s),a.inputMaskEditor({mask:r})}})}),define("tau/ui/templates/board.limits/ui.template.board.limits",["tau/core/templates-factory"],function(e){var t={name:"board.limit",engine:"jqote2",markup:['<div class="i-role-limit-list" >',"</div>"]};return e.register(t)}),define("tau/components/component.board.limits",["Underscore","tau/components/component.creator","tau/models/board.limits/model.board.limits","tau/ui/extensions/board.limits/ui.extension.board.limits","tau/ui/templates/board.limits/ui.template.board.limits"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[n,i],template:a};return t.create(r,e)}}}),define("tau/ui/extensions/board.user-help/ui.extension.board.user-help",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(e){this._super(e),this.flowHelpService=e.context.configurator.getHelpScenarioService()},"bus initialize:last + afterRender":function(t,i,n){var a=this.flowHelpService,r=n.element,s=r.find(".i-role-flowhelp-flow");s.change(function(){var t=e(this),n=t.val();n&&(a.abort(),a.setCurrentFlow(n),a.run(n)),i.hidePopup()})}})}),define("tau/models/board.user-help/model.board.user-help",["Underscore","jQuery","tau/core/extension.base","app.path"],function(e,t,i,n){return i.extend({"bus afterInit":function(i,a){var r=a.config.context.configurator,s=r.getHelpScenarioService(),o=s.getScenarios(),l=t.Deferred();
r.getApplicationContextService().getApplicationContext({projectIds:e.compact(e.pluck(o,"requiredProject")),teamIds:[]},{success:l.resolve}),l.done(e.bind(function(i){var a=n.get().toLowerCase().replace("http://","").replace("https://",""),l=e.filter(o,function(e){return s.checkScenarioPrerequisites(i,e)});this.fire("dataBind",{flows:l,queryString:t.param({host:a,userId:r.getLoggedUser().id,sid:taus.sid,origin:"User guide popup"})})},this))}})}),define("tau/components/component.board.user-help",["jQuery","tau/components/component.factory","tau/ui/extensions/board.user-help/ui.extension.board.user-help","tau/models/board.user-help/model.board.user-help"],function(e,t,i,n){return t.define(function(){var e={name:"board.user-help",engine:"jqote2",markup:['<div class="tau-container">','<div class="tau-help-header">','<span class="tau-help-txt">Take a 5-min Tour</span>','<select class="tau-select i-role-flowhelp-flow">',"<% for (var i = 0; i < this.flows.length; i++) { %>","<% var f = this.flows[i]; %>",'<option value="<%= f.id %>"><%= f.name %></option>',"<% } %>","</select>",'<span class="tau-help-follow">and follow the blue dot<span class="tau-help-attention-attractor"></span></span>','<a href="//guide.targetprocess.com?<%= this.queryString %>" target="_blank" class="tau-help-site-link">Open Help in a New Window</a>',"</div>",'<div class="tau-help-frame">','<iframe src="//guide.targetprocess.com?<%= this.queryString %>" height="100%" width="982"></iframe>',"</div>","</div>"]};return{extensions:[i,n],template:e}})}),define("tau/ui/extensions/board.main.menu/ui.extension.board.main.menu.item.help",["jQuery","Underscore","tau/core/extension.base","tau/components/component.board.user-help"],function(e,t,i,n){return i.extend({"bus afterRender + afterInit":function(e,i,a){var r=i.element,s=r.find(".i-role-user-guide");s.on("click",t.bind(function(){this.component?this.component.fire("refresh"):(this.component=n.create({context:a.config.context}),this.component.on("afterRender",function(e,t){var i=t.element;
s.tauPopup({className:"tau-help-popup",hideOnEscape:!0,show:function(){s.tauPopup("setContent",i)},hide:function(){s.tauPopup("clearContent")}}),s.tauPopup("show")}),this.component.initialize({hidePopup:function(){s.tauPopup("hide")}}))},this))},destroy:function(){this.component&&(this.component.fire("destroy"),this.component=null),this._super()}})}),define("tau/components/component.board.main.menu.item.help",["jQuery","tau/components/component.creator","tau/ui/extensions/board.main.menu/ui.extension.board.main.menu.item.help"],function(e,t,i){return{create:function(e){var n={name:"board.main.menu.item.help",engine:"jqote2",markup:['<div class="tau-menu-item tau-menu-items-help tau-user-menu">','<span class="tau-popup-link"><%!fn.T("User Guide")%></span>',"</div>"]},a={extensions:[i],template:n},r=t.create(a,e);return r.fire("dataBind",{}),r}}}),define("tau/ui/extensions/board.main.menu/ui.extension.board.main.menu.item.social-share",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender":function(e,t){var i=t.element,n=i.find(".tau-menu-icon"),a=i.find(".tau-social-share-popup");a.detach(),n.tauBubble({content:a,target:n,alignTo:i,ignoreOverlap:!0,zIndex:999,onPositionConfig:function(e){e.at="left-30 bottom-10"},onArrowPositionConfig:function(e){e.at="center bottom-10"},show:function(){i.addClass("tau-active")},hide:function(){i.removeClass("tau-active")}})},destroy:function(){this.component&&(this.component.fire("destroy"),this.component=null),this._super()}})}),define("tau/components/component.board.main.menu.item.social-share",["jQuery","tau/components/component.creator","tau/ui/extensions/board.main.menu/ui.extension.board.main.menu.item.social-share"],function(e,t,i){return{create:function(e){var n={name:"board.main.menu.item.promo-social-share",engine:"jqote2",markup:['<div class="tau-menu-item tau-social-share">','   <span class="tau-menu-icon tau-icon-social-share"></span>','   <div class="tau-social-share-popup">',"       <span>Like new Targetprocess?</span>","       <br>","       <span>Spread the word!</span>",'       <ul class="tau-share-links">','           <li class="tau-share-link">','               <a class="tau-btn tau-facebook" href="//www.facebook.com/TargetProcess" title="Like Targetprocess on Facebook" target="_blank">Facebook</a>','           <li class="tau-share-link">','               <a class="tau-btn tau-google-plus" href="//plus.google.com/106458767326839109835/posts" title="Follow Targetprocess on Google+" target="_blank">Google+</a>','           <li class="tau-share-link">','               <a class="tau-btn tau-twitter" href="https://twitter.com/intent/tweet?url=http%3A%2F%2Ftargetprocess.com%2F3&text=Try%20TargetProcess3%20%E2%80%94%20fascinating%20agile%20project%20management%20software&hashtags=targetprocess,kanban,scrum&related=Targetprocess" title="Share on Twitter" target="_blank">Twitter</a>',"       </ul>","   </div>","</div>"]},a={extensions:[i],template:n},r=t.create(a,e);
return r.fire("dataBind",{}),r}}}),define("tau/ui/extensions/board.main.menu/ui.extension.board.main.toggle-help-flow",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit + afterRender":function(e,t,i){var n=i.element,a=this.showPanel.bind(this,n),r=this.hidePanel.bind(this,n),s=t.config.context.configurator.getHelpScenarioService();s.on("run.scenario",a),s.on("abort.scenario",r),s.on("done.scenario",r),s.getState()===s.stateTypes.InProgress&&a()},hidePanel:function(e){e.removeClass("tau-flow-started tau-flow-info")},showPanel:function(e){e.addClass("tau-flow-started tau-flow-info")}})}),define("tau/ui/templates/board.main.menu/ui.template.board.main.menu",["tau/core/templates-factory"],function(e){var t={name:"board.main.menu",engine:"jqote2",markup:['<div class="tau-main-menu">',"</div>"].join(""),dependencies:[]};return e.register(t)}),define("tau/ui/templates/board.main.menu/ui.template.board.main.menu.section",["tau/core/templates-factory"],function(e){var t={name:"board.main.menu.section",engine:"jqote2",markup:['<div class="tau-menu-section">',"</div>"].join(""),dependencies:[]};return e.register(t)}),define("tau/models/reports/model.reports",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit + destroy":function(e,t){var i=t.config,n=i.context.configurator,a=n.getAppStateStore();a.unbind({listener:this})},"bus beforeInit":function(t,i){var n=i.config,a=n.context.configurator,r=a.getAppStateStore(),s=this;r.unbind({listener:this}),r.bind({fields:["acid"],listener:this,callback:function(){s.fire("refresh")}}),r.get({fields:["acid"],callback:function(t){var i=t.acid,n={id:i,acid:i,fields:["acid",{selectedProjects:["id","name"]},{selectedTeams:["id","name"]}]};a.getStore().get("context",n).done({success:function(t){var i=t[0].data;e.isArray(i)&&(i=i[0]),s.fire("context.ready",i)},failure:function(){var e={acid:"",selectedProjects:[],selectedTeams:[]};s.fire("context.ready",e)}})}})},"bus afterInit + context.ready":function(e,t,i){var n=t.config.context.configurator.getApplicationPath(),a=this._createMenuEntries(i,n);
this.fire("dataBind",a)},_createMenuEntries:function(e,t){if(!e.selectedProjects.length&&!e.selectedTeams.length)return[];var i=[{title:"Process Control",report:"processControl"},{title:"Burn Down",report:"burnDown"},{title:"Cycle Time Distribution",report:"timeDistribution"},{title:"Relations Network",report:"relationsNetwork"}];return e.selectedProjects.length&&(i.push({title:"Cumulative Flow",url:t+"/Project/Reports/Report.aspx?Report=CumulativeFlow&rmnav=1&tp3=1&acid="+e.acid}),i.push({title:"Other Reports&hellip;",url:t+"/Project/Reports/Reports.aspx?rmnav=1&tp3=1&acid="+e.acid})),i}})}),define("tau/ui/extensions/board.main.menu/ui.extention.board.main.menu.submenu",[],function(){return{createSubMenu:function(e,t){var i=e.element,n=i.find(".tau-user-submenu");t.fire("subMenu.ready",n),n.detach(),i.tauBubble({content:n,target:i,alignTo:i,ignoreOverlap:!0,onPositionConfig:function(e){e.at="left-30 bottom-10"},onArrowPositionConfig:function(e){e.at="center bottom-10"},zIndex:999})}}}),define("tau/ui/extensions/board.main.menu/ui.extension.board.main.menu",["jQuery","tau/core/extension.base","tau/ui/extensions/board.main.menu/ui.extention.board.main.menu.submenu"],function(e,t,i){return t.extend({"bus afterRender":function(e,t){i.createSubMenu(t,this.bus)}})}),define("application.creator",["jQuery"],function(e){return{create:function(t){var i=e.Deferred(),n=require;return n(["all.components"],function(){n(["tau/components/component.application.generic"],function(e){t.options=t.options||{},t.options.applicationId=t.options.applicationId||t.applicationId,t.options.integration=t.options.integration||t.integration,t.context=t.context||{},t.context.configurator=t.context.configurator||t.configurator;var n=e.create(t);i.resolve(n)})}),i}}}),define("tp/reports/service.chart.size",["tau/core/class","tau/core/event"],function(e,t){var i=e.extend({size:function(){return{width:.85*$(window).width(),height:.7*$(window).height()}}});return t.implementOn(i.prototype),i}),define("tp/reports/tp.application.reports",["Underscore","jQuery","application.creator","tau/services/service.navigator","tp/reports/service.chart.size"],function(e,t,i,n,a){var r="appReports",s=function(n){n._id=e.uniqueId("report_charts_viewer"),n.isBoardEdition=!0;
var a=[{pattern:/reports$/,adapter:function(){this.resolve({id:null,entity:"reports"})},type:"tau/components/component.page.reports",host:"tau/components/component.master.empty"},{pattern:/reports\/(\w+)/,adapter:function(e){this.resolve({id:null,entity:"reports",reportType:e})},type:"tau/components/component.page.reports",host:"tau/components/component.master.empty"},{pattern:/(\w+)\/([0-9]+)($|\s|&)/,adapter:function(e,t){this.resolve({id:parseInt(t,10),entity:e,action:"show"})},type:"tau/components/component.page.entity",host:"tau/components/component.master.empty"},{pattern:/(\w+)\/([0-9]+)\/(\w+)[&|]*.*/,adapter:function(e,t,i){this.resolve({id:parseInt(t,10),entity:e,action:i})},type:"tau/components/component.page.entity",host:"tau/components/component.master.empty"}],s={name:"application charts",applicationId:r,routes:a,configurator:n,options:{routing:{silent:!0}},integration:{disableProgressIndicator:!0,showInPopup:!0,keepAlive:!1}};return i.create(s).then(function(e){var i=t.Deferred();return e.initialize(s),i.resolve(e),i})},o=function(e,t){var i=e.createChild();i.getExternal().setFakeWindow(),i.registerService("chart.size",new a),i.registerService("navigator",new n(i,{parameterName:r})),i.service("navigator").to("reports/"+t.active),s(i)};return{initialize:o}}),define("tau/ui/extensions/reports/ui.extension.reports",["Underscore","jQuery","tau/core/extension.base","tp/reports/tp.application.reports"],function(e,t,i,n){return i.extend({"bus afterInit:last + subMenu.ready":function(t,i,n){var a=i.config.context.configurator;n.on("click",".tau-menu-item",e.bind(this._onMenuItemClick,this,a))},_onMenuItemClick:function(e,i){var a=t(i.target),r=a.attr("data-url"),s=a.attr("data-report");r?(a.tauIFramePopup({url:r}),a.tauIFramePopup("show")):s&&n.initialize(e,{active:s})}})}),define("tau/components/component.reports",["tau/components/component.creator","tau/models/reports/model.reports","tau/ui/extensions/board.main.menu/ui.extension.board.main.menu","tau/ui/extensions/reports/ui.extension.reports"],function(e,t,i,n){return{create:function(a){var r={name:"menu-item-reports",engine:"jqote2",markup:['<div class="tau-menu-item tau-menu-item-reports tau-user-menu">','   <span class="tau-popup-link tau-extension-board-tooltip" data-title="Check progress">Reports</span>','   <ul class="tau-user-submenu">',"<% for (var i = 0, len = this.length; i < len; i++) { %>","       <% var item = this[i]; %>",'       <li class="tau-menu-item" <%=item.url?("data-url="+item.url+""):""%> <%=item.report?("data-report="+item.report+""):""%>><%=item.title%></li>',"<% } %>","<% if (!this.length) { %>",'       <li class="tau-menu-item tau-menu-item-disabled">You need to select a project or a team to see the reports.</li>',"<% } %>","   </ul>","</div>"]},s={extensions:[t,i,n],template:r};
return e.create(s,a)}}}),define("tau/ui/extensions/time-sheet/ui.extension.time-sheet",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender + afterInit":function(t,i,n){var a=n.config.context.configurator.getApplicationPath();i.element.find(".i-role-timesheet").click(function(){e(this).tauIFramePopup({url:a+"/Default/TimeSheet.aspx?rmnav=1&tp3=1"}),e(this).tauIFramePopup("show")})}})}),define("tau/components/component.time-sheet",["tau/components/component.creator","tau/ui/extensions/time-sheet/ui.extension.time-sheet"],function(e,t){return{create:function(i){var n={name:"time-sheet",engine:"jqote2",markup:['<div class="tau-menu-item tau-menu-item-timesheet">','<span class="tau-popup-link tau-extension-board-tooltip i-role-timesheet i-taus" ','tauspref="time sheet" taustype="header-menu-click" data-title="Track time">',"Time Sheet","</span>","</div>"]},a={template:n,extensions:[t]},r=e.create(a,i);return r.fire("dataBind",{}),r}}}),define("tau/components/component.tp-buy",["tau/components/component.creator","jQuery"],function(e,t){return{create:function(i){var n={name:"board.tp-buy",engine:"jqote2",markup:["<% if (this.visible) { %>",'<div class="tau-menu-item tau-buy">','   <span class="tau-btn-buy i-taus" tauspref="buy" taustype="header-menu-click">Buy</span>',"</div>","<% } %>"]},a={template:n},r=e.create(a,i);return r.fire("dataBind",{visible:!window.tauSystemInfo.isLicensed||window.tauSystemInfo.isTrial||window.tauSystemInfo.isFree}),r.on("afterRender",function(e,i){i.element.find(".tau-btn-buy").click(function(){t(this).tauIFramePopup({url:"https://secure.shareit.com/shareit/checkout.html?PRODUCT[300582212]=10"}),t(this).tauIFramePopup("show")})}),r}}}),define("tau/models/current-user/model.current-user",["tau/core/extension.base","tau/utils/utils.convertUserName"],function(e,t){return e.extend({"bus beforeInit":function(e,t){this.fire("configurator.ready",t.config.context.configurator)},"bus afterInit":function(e,i){var n=i.config.context.configurator,a=n.getLoggedUser(),r=n.getStore(),s=this;
n.getFeaturesService().isEnabled("context.v2")?s.fire("dataBind",{userAvatarURI:a.avatarUri+"24",userId:a.id,logoutUrl:n.getUrlBuilder().getLogoutUrl(),userName:a.name}):r.get("user",{id:a.id,fields:["avatarUri","firstName","lastName"]}).done({success:function(e){var i=e[0].data;s.fire("dataBind",{userAvatarURI:i.avatarUri+"24",userId:i.id,logoutUrl:n.getUrlBuilder().getLogoutUrl(),userName:t.getFullName(i)})}}),r.unbind(this),r.on({eventName:"afterSave",type:"user",listener:s},function(e){e.data.id==a.id&&s.fire("refresh")})}})}),define("tau/ui/extensions/current-user/ui.extension.current-user.viewer",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({$subMenu:null,"bus beforeInit":function(e,t){var i=t.config.context.configurator;i.getComponentBusRegistry().getByName("entityViewer").done(function(e){this.fire("viewerBus.ready",e)}.bind(this))},"bus subMenu.ready":function(e,t){this.$subMenu&&this.$subMenu.off(".showUserProfile"),this.$subMenu=t,t.on("click.showUserProfile",".tau-user-menu-profile",function(){this.fire("show.user.profile")}.bind(this))},"bus viewerBus.ready:last + dataBind:last + show.user.profile":function(e,t,i){t.fire("cardDataToShow.ready",{entityType:"user",entityId:i.userId})},destroy:function(){this.$subMenu&&(this.$subMenu.off(".showUserProfile"),this.$subMenu=null),this._super()}})}),define("tau/components/component.current-user",["tau/components/component.creator","tau/models/current-user/model.current-user","tau/ui/extensions/board.main.menu/ui.extension.board.main.menu","tau/ui/extensions/current-user/ui.extension.current-user.viewer"],function(e,t,i,n){return{create:function(a){var r={name:"current-user",engine:"jqote2",markup:['<div class="tau-menu-item tau-menu-item-avatar tau-user-menu">','    <img data-title="<%!this.userName%>" class="tau-user-avatar tau-extension-board-tooltip" src="<%=this.userAvatarURI%>" />','    <ul class="tau-user-submenu">','        <li class="tau-menu-item tau-user-name"><%!this.userName%></li>','        <li class="tau-menu-item tau-user-menu-profile"><span>My Profile</span></li>','        <li class="tau-menu-item tau-user-menu-logout"><a href="<%=this.logoutUrl%>">Logout</a></li>',"    </ul>","</div>"]},s={extensions:[t,i,n],template:r};
return e.create(s,a)}}}),define("tau/ui/templates/ui.template.settings.popup",["tau/core/templates-factory"],function(e){var t={name:"settings.popup",engine:"jqote2",markup:["<div>",'<ul class="tau-setting-submenu">',"</ul>","</div>"]};return e.register(t)}),define("tau/ui/extensions/tp-settings/ui.extension.tp-settings",["jQuery","tau/core/extension.base","tau/ui/templates/ui.template.settings.popup"],function(e,t,i){return t.extend({"bus afterRender + afterInit + boardSettings.ready":function(e,n,a,r){var s=n.element.find(".i-role-settings"),o=[{name:"settings_settings_item",type:"tp-settings.settings",selector:".tau-setting-submenu"},{name:"settings_userGuide_item",type:"tp-settings.user-guide",selector:".tau-setting-submenu"},{name:"settings_liveChat_item",type:"tp-settings.live-chat",selector:".tau-setting-submenu"},{name:"settings_submitIssue_item",type:"tp-settings.feedback",selector:".tau-setting-submenu"},{name:"settings_sendIdea_item",type:"tp-settings.user-voice",selector:".tau-setting-submenu"},{name:"board_about",type:"board.system-info",selector:"div"}],l=a.config.context.configurator,u=l.getFeaturesService(),c=l.getLoggedUser();u.isEnabled("process.setup")&&c.isAdministrator&&o.splice(1,0,{name:"process_setup",type:"tp-settings.process-setup",selector:".tau-setting-submenu"});var d={target:s,className:"tau-bubble-settings",applyBubbleClasses:!1,stackName:"mainsettings",showArrow:!0,showOnCreation:!1,zIndex:1e4,alignTo:s,onShow:function(e){e.one("click",".tau-setting-submenu__item, .tau-changelog-link, .i-role-diagnostic",function(){s.tauBubble("toggle")})},onPositionConfig:function(){return{of:s,collision:"none none",my:"right top",at:"right+20 bottom+1"}},componentsConfig:{components:[{name:"settings-bubble",layout:"selectable",type:"container",template:i,children:o,extensions:[t.extend({"bus childComponentCreated":function(e,t){t.fire("boardSettings.ready",r)}})]}]}};this.fire("initBubble",d),s.click(function(){s.tauBubble("toggle")})}})}),define("tau/components/component.tp-settings",["tau/components/component.creator","tau/ui/extensions/tp-settings/ui.extension.tp-settings","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension"],function(e,t,i,n){return{create:function(a){var r={name:"board.tp-settings",engine:"jqote2",markup:['<div class="tau-menu-item tau-menu-item-settings">','    <a class="tau-icon-settings i-role-settings"></a>',"</div>"]},s={template:r,extensions:[t,i,n]},o=e.create(s,a);
return o.fire("dataBind",{}),o}}}),define("tau/components/component.board.main.menu",["require","Underscore","tau/components/component.container","tau/ui/extensions/board.main.menu/ui.extension.board.main.toggle-help-flow","tau/ui/templates/board.main.menu/ui.template.board.main.menu","tau/ui/templates/board.main.menu/ui.template.board.main.menu.section","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/components/component.reports","tau/components/component.time-sheet","tau/components/component.tp-buy","tau/components/component.board.flowHelp","tau/components/component.board.main.menu.item.social-share","tau/components/component.current-user","tau/components/component.tp-settings"],function(e){var t=e("Underscore"),i=e("tau/components/component.container"),n=e("tau/ui/extensions/board.main.menu/ui.extension.board.main.toggle-help-flow"),a=e("tau/ui/templates/board.main.menu/ui.template.board.main.menu"),r=e("tau/ui/templates/board.main.menu/ui.template.board.main.menu.section"),s=e("tau/ui/extensions/board.container/ui.extension.board.container.events");return e("tau/components/component.reports"),e("tau/components/component.time-sheet"),e("tau/components/component.tp-buy"),e("tau/components/component.board.flowHelp"),e("tau/components/component.board.main.menu.item.social-share"),e("tau/components/component.current-user"),e("tau/components/component.tp-settings"),{create:function(e){var o={extensions:[s].concat(e.extensions||[]),template:a,name:"board.main.menu",children:[{type:"container",template:r,children:[{type:"reports"},{type:"time-sheet"}]},{type:"container",template:r,extensions:[n],children:[{type:"tp-buy"},{type:"board.flowHelp"},{type:"board.main.menu.item.social-share"}]},{type:"container",template:r,children:[{type:"current-user"},{type:"tp-settings"}],extensions:[s]}]};return e["queue.bus"]=!0,i.create(t.extend(e,o))}}}),define("template!tau/components/board.menu/templates/board.menu.template",["tau/core/templates-factory"],function(e){var t={name:"board.menu",engine:"jqote2",customFunctions:null,markup:'<div class="i-role-views-navigator-container"></div>'};
return e.register(t)}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("react",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.React=e()}}(function(){return function e(t,i,n){function a(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return a(i?i:e)},u,u.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t){"use strict";var i=e("./focusNode"),n={componentDidMount:function(){this.props.autoFocus&&i(this.getDOMNode())}};t.exports=n},{"./focusNode":117}],2:[function(e,t){"use strict";function i(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}function n(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}var a=e("./EventConstants"),r=e("./EventPropagators"),s=e("./ExecutionEnvironment"),o=e("./SyntheticInputEvent"),l=e("./keyOf"),u=s.canUseDOM&&"TextEvent"in window&&!("documentMode"in document||i()),c=32,d=String.fromCharCode(c),p=a.topLevelTypes,f={beforeInput:{phasedRegistrationNames:{bubbled:l({onBeforeInput:null}),captured:l({onBeforeInputCapture:null})},dependencies:[p.topCompositionEnd,p.topKeyPress,p.topTextInput,p.topPaste]}},m=null,h={eventTypes:f,extractEvents:function(e,t,i,a){var s;if(u)switch(e){case p.topKeyPress:var l=a.which;if(l!==c)return;s=String.fromCharCode(l);break;case p.topTextInput:if(s=a.data,s===d)return;break;default:return}else{switch(e){case p.topPaste:m=null;break;case p.topKeyPress:a.which&&!n(a)&&(m=String.fromCharCode(a.which));break;case p.topCompositionEnd:m=a.data}if(null===m)return;s=m}if(s){var h=o.getPooled(f.beforeInput,i,a);return h.data=s,m=null,r.accumulateTwoPhaseDispatches(h),h
}}};t.exports=h},{"./EventConstants":16,"./EventPropagators":21,"./ExecutionEnvironment":22,"./SyntheticInputEvent":95,"./keyOf":138}],3:[function(e,t){var i=e("./invariant"),n={addClass:function(e,t){return i(!/\s/.test(t)),t&&(e.classList?e.classList.add(t):n.hasClass(e,t)||(e.className=e.className+" "+t)),e},removeClass:function(e,t){return i(!/\s/.test(t)),t&&(e.classList?e.classList.remove(t):n.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),e},conditionClass:function(e,t,i){return(i?n.addClass:n.removeClass)(e,t)},hasClass:function(e,t){return i(!/\s/.test(t)),e.classList?!!t&&e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}};t.exports=n},{"./invariant":131}],4:[function(e,t){"use strict";function i(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var n={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},a=["Webkit","ms","Moz","O"];Object.keys(n).forEach(function(e){a.forEach(function(t){n[i(t,e)]=n[e]})});var r={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},s={isUnitlessNumber:n,shorthandPropertyExpansions:r};t.exports=s},{}],5:[function(e,t){"use strict";var i=e("./CSSProperty"),n=e("./dangerousStyleValue"),a=e("./hyphenateStyleName"),r=e("./memoizeStringOnly"),s=r(function(e){return a(e)}),o={createMarkupForStyles:function(e){var t="";for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];
null!=a&&(t+=s(i)+":",t+=n(i,a)+";")}return t||null},setValueForStyles:function(e,t){var a=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=n(r,t[r]);if(s)a[r]=s;else{var o=i.shorthandPropertyExpansions[r];if(o)for(var l in o)a[l]="";else a[r]=""}}}};t.exports=o},{"./CSSProperty":4,"./dangerousStyleValue":112,"./hyphenateStyleName":129,"./memoizeStringOnly":140}],6:[function(e,t){"use strict";function i(){this._callbacks=null,this._contexts=null}var n=e("./PooledClass"),a=e("./invariant"),r=e("./mixInto");r(i,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){a(e.length===t.length),this._callbacks=null,this._contexts=null;for(var i=0,n=e.length;n>i;i++)e[i].call(t[i]);e.length=0,t.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),n.addPoolingTo(i),t.exports=i},{"./PooledClass":28,"./invariant":131,"./mixInto":144}],7:[function(e,t){"use strict";function i(e){return"SELECT"===e.nodeName||"INPUT"===e.nodeName&&"file"===e.type}function n(e){var t=w.getPooled(I.change,P,e);y.accumulateTwoPhaseDispatches(t),x.batchedUpdates(a,t)}function a(e){b.enqueueEvents(e),b.processEventQueue()}function r(e,t){D=e,P=t,D.attachEvent("onchange",n)}function s(){D&&(D.detachEvent("onchange",n),D=null,P=null)}function o(e,t,i){return e===k.topChange?i:void 0}function l(e,t,i){e===k.topFocus?(s(),r(t,i)):e===k.topBlur&&s()}function u(e,t){D=e,P=t,E=e.value,R=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(D,"value",M),D.attachEvent("onpropertychange",d)}function c(){D&&(delete D.value,D.detachEvent("onpropertychange",d),D=null,P=null,E=null,R=null)}function d(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==E&&(E=t,n(e))}}function p(e,t,i){return e===k.topInput?i:void 0}function f(e,t,i){e===k.topFocus?(c(),u(t,i)):e===k.topBlur&&c()
}function m(e){return e!==k.topSelectionChange&&e!==k.topKeyUp&&e!==k.topKeyDown||!D||D.value===E?void 0:(E=D.value,P)}function h(e){return"INPUT"===e.nodeName&&("checkbox"===e.type||"radio"===e.type)}function g(e,t,i){return e===k.topClick?i:void 0}var v=e("./EventConstants"),b=e("./EventPluginHub"),y=e("./EventPropagators"),_=e("./ExecutionEnvironment"),x=e("./ReactUpdates"),w=e("./SyntheticEvent"),C=e("./isEventSupported"),S=e("./isTextInputElement"),T=e("./keyOf"),k=v.topLevelTypes,I={change:{phasedRegistrationNames:{bubbled:T({onChange:null}),captured:T({onChangeCapture:null})},dependencies:[k.topBlur,k.topChange,k.topClick,k.topFocus,k.topInput,k.topKeyDown,k.topKeyUp,k.topSelectionChange]}},D=null,P=null,E=null,R=null,A=!1;_.canUseDOM&&(A=C("change")&&(!("documentMode"in document)||document.documentMode>8));var F=!1;_.canUseDOM&&(F=C("input")&&(!("documentMode"in document)||document.documentMode>9));var M={get:function(){return R.get.call(this)},set:function(e){E=""+e,R.set.call(this,e)}},N={eventTypes:I,extractEvents:function(e,t,n,a){var r,s;if(i(t)?A?r=o:s=l:S(t)?F?r=p:(r=m,s=f):h(t)&&(r=g),r){var u=r(e,t,n);if(u){var c=w.getPooled(I.change,u,a);return y.accumulateTwoPhaseDispatches(c),c}}s&&s(e,t,n)}};t.exports=N},{"./EventConstants":16,"./EventPluginHub":18,"./EventPropagators":21,"./ExecutionEnvironment":22,"./ReactUpdates":84,"./SyntheticEvent":93,"./isEventSupported":132,"./isTextInputElement":134,"./keyOf":138}],8:[function(e,t){"use strict";var i=0,n={createReactRootIndex:function(){return i++}};t.exports=n},{}],9:[function(e,t){"use strict";function i(e){switch(e){case v.topCompositionStart:return y.compositionStart;case v.topCompositionEnd:return y.compositionEnd;case v.topCompositionUpdate:return y.compositionUpdate}}function n(e,t){return e===v.topKeyDown&&t.keyCode===m}function a(e,t){switch(e){case v.topKeyUp:return-1!==f.indexOf(t.keyCode);case v.topKeyDown:return t.keyCode!==m;case v.topKeyPress:case v.topMouseDown:case v.topBlur:return!0;default:return!1
}}function r(e){this.root=e,this.startSelection=u.getSelection(e),this.startValue=this.getText()}var s=e("./EventConstants"),o=e("./EventPropagators"),l=e("./ExecutionEnvironment"),u=e("./ReactInputSelection"),c=e("./SyntheticCompositionEvent"),d=e("./getTextContentAccessor"),p=e("./keyOf"),f=[9,13,27,32],m=229,h=l.canUseDOM&&"CompositionEvent"in window,g=!h||"documentMode"in document&&document.documentMode>8&&document.documentMode<=11,v=s.topLevelTypes,b=null,y={compositionEnd:{phasedRegistrationNames:{bubbled:p({onCompositionEnd:null}),captured:p({onCompositionEndCapture:null})},dependencies:[v.topBlur,v.topCompositionEnd,v.topKeyDown,v.topKeyPress,v.topKeyUp,v.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:p({onCompositionStart:null}),captured:p({onCompositionStartCapture:null})},dependencies:[v.topBlur,v.topCompositionStart,v.topKeyDown,v.topKeyPress,v.topKeyUp,v.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:p({onCompositionUpdate:null}),captured:p({onCompositionUpdateCapture:null})},dependencies:[v.topBlur,v.topCompositionUpdate,v.topKeyDown,v.topKeyPress,v.topKeyUp,v.topMouseDown]}};r.prototype.getText=function(){return this.root.value||this.root[d()]},r.prototype.getData=function(){var e=this.getText(),t=this.startSelection.start,i=this.startValue.length-this.startSelection.end;return e.substr(t,e.length-i-t)};var _={eventTypes:y,extractEvents:function(e,t,s,l){var u,d;if(h?u=i(e):b?a(e,l)&&(u=y.compositionEnd):n(e,l)&&(u=y.compositionStart),g&&(b||u!==y.compositionStart?u===y.compositionEnd&&b&&(d=b.getData(),b=null):b=new r(t)),u){var p=c.getPooled(u,s,l);return d&&(p.data=d),o.accumulateTwoPhaseDispatches(p),p}}};t.exports=_},{"./EventConstants":16,"./EventPropagators":21,"./ExecutionEnvironment":22,"./ReactInputSelection":61,"./SyntheticCompositionEvent":91,"./getTextContentAccessor":126,"./keyOf":138}],10:[function(e,t){"use strict";function i(e,t,i){e.insertBefore(t,e.childNodes[i]||null)}var n,a=e("./Danger"),r=e("./ReactMultiChildUpdateTypes"),s=e("./getTextContentAccessor"),o=e("./invariant"),l=s();
n="textContent"===l?function(e,t){e.textContent=t}:function(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);if(t){var i=e.ownerDocument||document;e.appendChild(i.createTextNode(t))}};var u={dangerouslyReplaceNodeWithMarkup:a.dangerouslyReplaceNodeWithMarkup,updateTextContent:n,processUpdates:function(e,t){for(var s,l=null,u=null,c=0;s=e[c];c++)if(s.type===r.MOVE_EXISTING||s.type===r.REMOVE_NODE){var d=s.fromIndex,p=s.parentNode.childNodes[d],f=s.parentID;o(p),l=l||{},l[f]=l[f]||[],l[f][d]=p,u=u||[],u.push(p)}var m=a.dangerouslyRenderMarkup(t);if(u)for(var h=0;h<u.length;h++)u[h].parentNode.removeChild(u[h]);for(var g=0;s=e[g];g++)switch(s.type){case r.INSERT_MARKUP:i(s.parentNode,m[s.markupIndex],s.toIndex);break;case r.MOVE_EXISTING:i(s.parentNode,l[s.parentID][s.fromIndex],s.toIndex);break;case r.TEXT_CONTENT:n(s.parentNode,s.textContent);break;case r.REMOVE_NODE:}}};t.exports=u},{"./Danger":13,"./ReactMultiChildUpdateTypes":67,"./getTextContentAccessor":126,"./invariant":131}],11:[function(e,t){"use strict";var i=e("./invariant"),n={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=e.Properties||{},a=e.DOMAttributeNames||{},s=e.DOMPropertyNames||{},o=e.DOMMutationMethods||{};e.isCustomAttribute&&r._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var l in t){i(!r.isStandardName.hasOwnProperty(l)),r.isStandardName[l]=!0;var u=l.toLowerCase();if(r.getPossibleStandardName[u]=l,a.hasOwnProperty(l)){var c=a[l];r.getPossibleStandardName[c]=l,r.getAttributeName[l]=c}else r.getAttributeName[l]=u;r.getPropertyName[l]=s.hasOwnProperty(l)?s[l]:l,r.getMutationMethod[l]=o.hasOwnProperty(l)?o[l]:null;var d=t[l];r.mustUseAttribute[l]=d&n.MUST_USE_ATTRIBUTE,r.mustUseProperty[l]=d&n.MUST_USE_PROPERTY,r.hasSideEffects[l]=d&n.HAS_SIDE_EFFECTS,r.hasBooleanValue[l]=d&n.HAS_BOOLEAN_VALUE,r.hasNumericValue[l]=d&n.HAS_NUMERIC_VALUE,r.hasPositiveNumericValue[l]=d&n.HAS_POSITIVE_NUMERIC_VALUE,r.hasOverloadedBooleanValue[l]=d&n.HAS_OVERLOADED_BOOLEAN_VALUE,i(!r.mustUseAttribute[l]||!r.mustUseProperty[l]),i(r.mustUseProperty[l]||!r.hasSideEffects[l]),i(!!r.hasBooleanValue[l]+!!r.hasNumericValue[l]+!!r.hasOverloadedBooleanValue[l]<=1)
}}},a={},r={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasNumericValue:{},hasPositiveNumericValue:{},hasOverloadedBooleanValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<r._isCustomAttributeFunctions.length;t++){var i=r._isCustomAttributeFunctions[t];if(i(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var i,n=a[e];return n||(a[e]=n={}),t in n||(i=document.createElement(e),n[t]=i[t]),n[t]},injection:n};t.exports=r},{"./invariant":131}],12:[function(e,t){"use strict";function i(e,t){return null==t||n.hasBooleanValue[e]&&!t||n.hasNumericValue[e]&&isNaN(t)||n.hasPositiveNumericValue[e]&&1>t||n.hasOverloadedBooleanValue[e]&&t===!1}var n=e("./DOMProperty"),a=e("./escapeTextForBrowser"),r=e("./memoizeStringOnly"),s=(e("./warning"),r(function(e){return a(e)+'="'})),o={createMarkupForID:function(e){return s(n.ID_ATTRIBUTE_NAME)+a(e)+'"'},createMarkupForProperty:function(e,t){if(n.isStandardName.hasOwnProperty(e)&&n.isStandardName[e]){if(i(e,t))return"";var r=n.getAttributeName[e];return n.hasBooleanValue[e]||n.hasOverloadedBooleanValue[e]&&t===!0?a(r):s(r)+a(t)+'"'}return n.isCustomAttribute(e)?null==t?"":s(e)+a(t)+'"':null},setValueForProperty:function(e,t,a){if(n.isStandardName.hasOwnProperty(t)&&n.isStandardName[t]){var r=n.getMutationMethod[t];if(r)r(e,a);else if(i(t,a))this.deleteValueForProperty(e,t);else if(n.mustUseAttribute[t])e.setAttribute(n.getAttributeName[t],""+a);else{var s=n.getPropertyName[t];n.hasSideEffects[t]&&e[s]===a||(e[s]=a)}}else n.isCustomAttribute(t)&&(null==a?e.removeAttribute(t):e.setAttribute(t,""+a))},deleteValueForProperty:function(e,t){if(n.isStandardName.hasOwnProperty(t)&&n.isStandardName[t]){var i=n.getMutationMethod[t];if(i)i(e,void 0);else if(n.mustUseAttribute[t])e.removeAttribute(n.getAttributeName[t]);else{var a=n.getPropertyName[t],r=n.getDefaultValueForProperty(e.nodeName,a);
n.hasSideEffects[t]&&e[a]===r||(e[a]=r)}}else n.isCustomAttribute(t)&&e.removeAttribute(t)}};t.exports=o},{"./DOMProperty":11,"./escapeTextForBrowser":115,"./memoizeStringOnly":140,"./warning":153}],13:[function(e,t){"use strict";function i(e){return e.substring(1,e.indexOf(" "))}var n=e("./ExecutionEnvironment"),a=e("./createNodesFromMarkup"),r=e("./emptyFunction"),s=e("./getMarkupWrap"),o=e("./invariant"),l=/^(<[^ \/>]+)/,u="data-danger-index",c={dangerouslyRenderMarkup:function(e){o(n.canUseDOM);for(var t,c={},d=0;d<e.length;d++)o(e[d]),t=i(e[d]),t=s(t)?t:"*",c[t]=c[t]||[],c[t][d]=e[d];var p=[],f=0;for(t in c)if(c.hasOwnProperty(t)){var m=c[t];for(var h in m)if(m.hasOwnProperty(h)){var g=m[h];m[h]=g.replace(l,"$1 "+u+'="'+h+'" ')}var v=a(m.join(""),r);for(d=0;d<v.length;++d){var b=v[d];b.hasAttribute&&b.hasAttribute(u)&&(h=+b.getAttribute(u),b.removeAttribute(u),o(!p.hasOwnProperty(h)),p[h]=b,f+=1)}}return o(f===p.length),o(p.length===e.length),p},dangerouslyReplaceNodeWithMarkup:function(e,t){o(n.canUseDOM),o(t),o("html"!==e.tagName.toLowerCase());var i=a(t,r)[0];e.parentNode.replaceChild(i,e)}};t.exports=c},{"./ExecutionEnvironment":22,"./createNodesFromMarkup":110,"./emptyFunction":113,"./getMarkupWrap":123,"./invariant":131}],14:[function(e,t){"use strict";var i=e("./keyOf"),n=[i({ResponderEventPlugin:null}),i({SimpleEventPlugin:null}),i({TapEventPlugin:null}),i({EnterLeaveEventPlugin:null}),i({ChangeEventPlugin:null}),i({SelectEventPlugin:null}),i({CompositionEventPlugin:null}),i({BeforeInputEventPlugin:null}),i({AnalyticsEventPlugin:null}),i({MobileSafariClickEventPlugin:null})];t.exports=n},{"./keyOf":138}],15:[function(e,t){"use strict";var i=e("./EventConstants"),n=e("./EventPropagators"),a=e("./SyntheticMouseEvent"),r=e("./ReactMount"),s=e("./keyOf"),o=i.topLevelTypes,l=r.getFirstReactDOM,u={mouseEnter:{registrationName:s({onMouseEnter:null}),dependencies:[o.topMouseOut,o.topMouseOver]},mouseLeave:{registrationName:s({onMouseLeave:null}),dependencies:[o.topMouseOut,o.topMouseOver]}},c=[null,null],d={eventTypes:u,extractEvents:function(e,t,i,s){if(e===o.topMouseOver&&(s.relatedTarget||s.fromElement))return null;
if(e!==o.topMouseOut&&e!==o.topMouseOver)return null;var d;if(t.window===t)d=t;else{var p=t.ownerDocument;d=p?p.defaultView||p.parentWindow:window}var f,m;if(e===o.topMouseOut?(f=t,m=l(s.relatedTarget||s.toElement)||d):(f=d,m=t),f===m)return null;var h=f?r.getID(f):"",g=m?r.getID(m):"",v=a.getPooled(u.mouseLeave,h,s);v.type="mouseleave",v.target=f,v.relatedTarget=m;var b=a.getPooled(u.mouseEnter,g,s);return b.type="mouseenter",b.target=m,b.relatedTarget=f,n.accumulateEnterLeaveDispatches(v,b,h,g),c[0]=v,c[1]=b,c}};t.exports=d},{"./EventConstants":16,"./EventPropagators":21,"./ReactMount":65,"./SyntheticMouseEvent":97,"./keyOf":138}],16:[function(e,t){"use strict";var i=e("./keyMirror"),n=i({bubbled:null,captured:null}),a=i({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTextInput:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),r={topLevelTypes:a,PropagationPhases:n};t.exports=r},{"./keyMirror":137}],17:[function(e,t){var i=e("./emptyFunction"),n={listen:function(e,t,i){return e.addEventListener?(e.addEventListener(t,i,!1),{remove:function(){e.removeEventListener(t,i,!1)}}):e.attachEvent?(e.attachEvent("on"+t,i),{remove:function(){e.detachEvent("on"+t,i)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:i}},registerDefault:function(){}};t.exports=n},{"./emptyFunction":113}],18:[function(e,t){"use strict";
var i=e("./EventPluginRegistry"),n=e("./EventPluginUtils"),a=e("./accumulate"),r=e("./forEachAccumulated"),s=e("./invariant"),o=(e("./isEventSupported"),e("./monitorCodeUse"),{}),l=null,u=function(e){if(e){var t=n.executeDispatch,a=i.getPluginModuleForEvent(e);a&&a.executeDispatch&&(t=a.executeDispatch),n.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e)}},c=null,d={injection:{injectMount:n.injection.injectMount,injectInstanceHandle:function(e){c=e},getInstanceHandle:function(){return c},injectEventPluginOrder:i.injectEventPluginOrder,injectEventPluginsByName:i.injectEventPluginsByName},eventNameDispatchConfigs:i.eventNameDispatchConfigs,registrationNameModules:i.registrationNameModules,putListener:function(e,t,i){s(!i||"function"==typeof i);var n=o[t]||(o[t]={});n[e]=i},getListener:function(e,t){var i=o[t];return i&&i[e]},deleteListener:function(e,t){var i=o[t];i&&delete i[e]},deleteAllListeners:function(e){for(var t in o)delete o[t][e]},extractEvents:function(e,t,n,r){for(var s,o=i.plugins,l=0,u=o.length;u>l;l++){var c=o[l];if(c){var d=c.extractEvents(e,t,n,r);d&&(s=a(s,d))}}return s},enqueueEvents:function(e){e&&(l=a(l,e))},processEventQueue:function(){var e=l;l=null,r(e,u),s(!l)},__purge:function(){o={}},__getListenerBank:function(){return o}};t.exports=d},{"./EventPluginRegistry":19,"./EventPluginUtils":20,"./accumulate":103,"./forEachAccumulated":118,"./invariant":131,"./isEventSupported":132,"./monitorCodeUse":145}],19:[function(e,t){"use strict";function i(){if(s)for(var e in o){var t=o[e],i=s.indexOf(e);if(r(i>-1),!l.plugins[i]){r(t.extractEvents),l.plugins[i]=t;var a=t.eventTypes;for(var u in a)r(n(a[u],t,u))}}}function n(e,t,i){r(!l.eventNameDispatchConfigs.hasOwnProperty(i)),l.eventNameDispatchConfigs[i]=e;var n=e.phasedRegistrationNames;if(n){for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];a(o,t,i)}return!0}return e.registrationName?(a(e.registrationName,t,i),!0):!1}function a(e,t,i){r(!l.registrationNameModules[e]),l.registrationNameModules[e]=t,l.registrationNameDependencies[e]=t.eventTypes[i].dependencies
}var r=e("./invariant"),s=null,o={},l={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){r(!s),s=Array.prototype.slice.call(e),i()},injectEventPluginsByName:function(e){var t=!1;for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];o.hasOwnProperty(n)&&o[n]===a||(r(!o[n]),o[n]=a,t=!0)}t&&i()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return l.registrationNameModules[t.registrationName]||null;for(var i in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(i)){var n=l.registrationNameModules[t.phasedRegistrationNames[i]];if(n)return n}return null},_resetEventPlugins:function(){s=null;for(var e in o)o.hasOwnProperty(e)&&delete o[e];l.plugins.length=0;var t=l.eventNameDispatchConfigs;for(var i in t)t.hasOwnProperty(i)&&delete t[i];var n=l.registrationNameModules;for(var a in n)n.hasOwnProperty(a)&&delete n[a]}};t.exports=l},{"./invariant":131}],20:[function(e,t){"use strict";function i(e){return e===h.topMouseUp||e===h.topTouchEnd||e===h.topTouchCancel}function n(e){return e===h.topMouseMove||e===h.topTouchMove}function a(e){return e===h.topMouseDown||e===h.topTouchStart}function r(e,t){var i=e._dispatchListeners,n=e._dispatchIDs;if(Array.isArray(i))for(var a=0;a<i.length&&!e.isPropagationStopped();a++)t(e,i[a],n[a]);else i&&t(e,i,n)}function s(e,t,i){e.currentTarget=m.Mount.getNode(i);var n=t(e,i);return e.currentTarget=null,n}function o(e,t){r(e,t),e._dispatchListeners=null,e._dispatchIDs=null}function l(e){var t=e._dispatchListeners,i=e._dispatchIDs;if(Array.isArray(t)){for(var n=0;n<t.length&&!e.isPropagationStopped();n++)if(t[n](e,i[n]))return i[n]}else if(t&&t(e,i))return i;return null}function u(e){var t=l(e);return e._dispatchIDs=null,e._dispatchListeners=null,t}function c(e){var t=e._dispatchListeners,i=e._dispatchIDs;f(!Array.isArray(t));var n=t?t(e,i):null;return e._dispatchListeners=null,e._dispatchIDs=null,n}function d(e){return!!e._dispatchListeners
}var p=e("./EventConstants"),f=e("./invariant"),m={Mount:null,injectMount:function(e){m.Mount=e}},h=p.topLevelTypes,g={isEndish:i,isMoveish:n,isStartish:a,executeDirectDispatch:c,executeDispatch:s,executeDispatchesInOrder:o,executeDispatchesInOrderStopAtTrue:u,hasDispatches:d,injection:m,useTouchEvents:!1};t.exports=g},{"./EventConstants":16,"./invariant":131}],21:[function(e,t){"use strict";function i(e,t,i){var n=t.dispatchConfig.phasedRegistrationNames[i];return h(e,n)}function n(e,t,n){var a=t?m.bubbled:m.captured,r=i(e,n,a);r&&(n._dispatchListeners=p(n._dispatchListeners,r),n._dispatchIDs=p(n._dispatchIDs,e))}function a(e){e&&e.dispatchConfig.phasedRegistrationNames&&d.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,n,e)}function r(e,t,i){if(i&&i.dispatchConfig.registrationName){var n=i.dispatchConfig.registrationName,a=h(e,n);a&&(i._dispatchListeners=p(i._dispatchListeners,a),i._dispatchIDs=p(i._dispatchIDs,e))}}function s(e){e&&e.dispatchConfig.registrationName&&r(e.dispatchMarker,null,e)}function o(e){f(e,a)}function l(e,t,i,n){d.injection.getInstanceHandle().traverseEnterLeave(i,n,r,e,t)}function u(e){f(e,s)}var c=e("./EventConstants"),d=e("./EventPluginHub"),p=e("./accumulate"),f=e("./forEachAccumulated"),m=c.PropagationPhases,h=d.getListener,g={accumulateTwoPhaseDispatches:o,accumulateDirectDispatches:u,accumulateEnterLeaveDispatches:l};t.exports=g},{"./EventConstants":16,"./EventPluginHub":18,"./accumulate":103,"./forEachAccumulated":118}],22:[function(e,t){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),n={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};t.exports=n},{}],23:[function(e,t){"use strict";var i,n=e("./DOMProperty"),a=e("./ExecutionEnvironment"),r=n.injection.MUST_USE_ATTRIBUTE,s=n.injection.MUST_USE_PROPERTY,o=n.injection.HAS_BOOLEAN_VALUE,l=n.injection.HAS_SIDE_EFFECTS,u=n.injection.HAS_NUMERIC_VALUE,c=n.injection.HAS_POSITIVE_NUMERIC_VALUE,d=n.injection.HAS_OVERLOADED_BOOLEAN_VALUE;
if(a.canUseDOM){var p=document.implementation;i=p&&p.hasFeature&&p.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var f={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,accessKey:null,action:null,allowFullScreen:r|o,allowTransparency:r,alt:null,async:o,autoComplete:null,autoPlay:o,cellPadding:null,cellSpacing:null,charSet:r,checked:s|o,className:i?r:s,cols:r|c,colSpan:null,content:null,contentEditable:null,contextMenu:r,controls:s|o,coords:null,crossOrigin:null,data:null,dateTime:r,defer:o,dir:null,disabled:r|o,download:d,draggable:null,encType:null,form:r,formNoValidate:o,frameBorder:r,height:r,hidden:r|o,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:s,label:null,lang:null,list:null,loop:s|o,max:null,maxLength:r,mediaGroup:null,method:null,min:null,multiple:s|o,muted:s|o,name:null,noValidate:o,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:s|o,rel:null,required:o,role:r,rows:r|c,rowSpan:null,sandbox:null,scope:null,scrollLeft:s,scrolling:null,scrollTop:s,seamless:r|o,selected:s|o,shape:null,size:r|c,span:c,spellCheck:null,src:null,srcDoc:s,srcSet:null,start:u,step:null,style:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:s|l,width:r,wmode:r,autoCapitalize:null,autoCorrect:null,itemProp:r,itemScope:r|o,itemType:r,property:null},DOMAttributeNames:{className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=f},{"./DOMProperty":11,"./ExecutionEnvironment":22}],24:[function(e,t){"use strict";var i=e("./ReactLink"),n=e("./ReactStateSetters"),a={linkState:function(e){return new i(this.state[e],n.createStateKeySetter(this,e))}};t.exports=a},{"./ReactLink":63,"./ReactStateSetters":79}],25:[function(e,t){"use strict";
function i(e){l(null==e.props.checkedLink||null==e.props.valueLink)}function n(e){i(e),l(null==e.props.value&&null==e.props.onChange)}function a(e){i(e),l(null==e.props.checked&&null==e.props.onChange)}function r(e){this.props.valueLink.requestChange(e.target.value)}function s(e){this.props.checkedLink.requestChange(e.target.checked)}var o=e("./ReactPropTypes"),l=e("./invariant"),u={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},c={Mixin:{propTypes:{value:function(e,t){return!e[t]||u[e.type]||e.onChange||e.readOnly||e.disabled?void 0:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t){return!e[t]||e.onChange||e.readOnly||e.disabled?void 0:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:o.func}},getValue:function(e){return e.props.valueLink?(n(e),e.props.valueLink.value):e.props.value},getChecked:function(e){return e.props.checkedLink?(a(e),e.props.checkedLink.value):e.props.checked},getOnChange:function(e){return e.props.valueLink?(n(e),r):e.props.checkedLink?(a(e),s):e.props.onChange}};t.exports=c},{"./ReactPropTypes":73,"./invariant":131}],26:[function(e,t){"use strict";function i(e){e.remove()}var n=e("./ReactBrowserEventEmitter"),a=e("./accumulate"),r=e("./forEachAccumulated"),s=e("./invariant"),o={trapBubbledEvent:function(e,t){s(this.isMounted());var i=n.trapBubbledEvent(e,t,this.getDOMNode());this._localEventListeners=a(this._localEventListeners,i)},componentWillUnmount:function(){this._localEventListeners&&r(this._localEventListeners,i)}};t.exports=o},{"./ReactBrowserEventEmitter":31,"./accumulate":103,"./forEachAccumulated":118,"./invariant":131}],27:[function(e,t){"use strict";
var i=e("./EventConstants"),n=e("./emptyFunction"),a=i.topLevelTypes,r={eventTypes:null,extractEvents:function(e,t,i,r){if(e===a.topTouchStart){var s=r.target;s&&!s.onclick&&(s.onclick=n)}}};t.exports=r},{"./EventConstants":16,"./emptyFunction":113}],28:[function(e,t){"use strict";var i=e("./invariant"),n=function(e){var t=this;if(t.instancePool.length){var i=t.instancePool.pop();return t.call(i,e),i}return new t(e)},a=function(e,t){var i=this;if(i.instancePool.length){var n=i.instancePool.pop();return i.call(n,e,t),n}return new i(e,t)},r=function(e,t,i){var n=this;if(n.instancePool.length){var a=n.instancePool.pop();return n.call(a,e,t,i),a}return new n(e,t,i)},s=function(e,t,i,n,a){var r=this;if(r.instancePool.length){var s=r.instancePool.pop();return r.call(s,e,t,i,n,a),s}return new r(e,t,i,n,a)},o=function(e){var t=this;i(e instanceof t),e.destructor&&e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},l=10,u=n,c=function(e,t){var i=e;return i.instancePool=[],i.getPooled=t||u,i.poolSize||(i.poolSize=l),i.release=o,i},d={addPoolingTo:c,oneArgumentPooler:n,twoArgumentPooler:a,threeArgumentPooler:r,fiveArgumentPooler:s};t.exports=d},{"./invariant":131}],29:[function(e,t){"use strict";var i=e("./DOMPropertyOperations"),n=e("./EventPluginUtils"),a=e("./ReactChildren"),r=e("./ReactComponent"),s=e("./ReactCompositeComponent"),o=e("./ReactContext"),l=e("./ReactCurrentOwner"),u=e("./ReactDescriptor"),c=e("./ReactDOM"),d=e("./ReactDOMComponent"),p=e("./ReactDefaultInjection"),f=e("./ReactInstanceHandles"),m=e("./ReactMount"),h=e("./ReactMultiChild"),g=e("./ReactPerf"),v=e("./ReactPropTypes"),b=e("./ReactServerRendering"),y=e("./ReactTextComponent"),_=e("./onlyChild");p.inject();var x={Children:{map:a.map,forEach:a.forEach,count:a.count,only:_},DOM:c,PropTypes:v,initializeTouchEvents:function(e){n.useTouchEvents=e},createClass:s.createClass,createDescriptor:function(e){var t=Array.prototype.slice.call(arguments,1);return e.apply(null,t)},constructAndRenderComponent:m.constructAndRenderComponent,constructAndRenderComponentByID:m.constructAndRenderComponentByID,renderComponent:g.measure("React","renderComponent",m.renderComponent),renderComponentToString:b.renderComponentToString,renderComponentToStaticMarkup:b.renderComponentToStaticMarkup,unmountComponentAtNode:m.unmountComponentAtNode,isValidClass:u.isValidFactory,isValidComponent:u.isValidDescriptor,withContext:o.withContext,__internals:{Component:r,CurrentOwner:l,DOMComponent:d,DOMPropertyOperations:i,InstanceHandles:f,Mount:m,MultiChild:h,TextComponent:y}};
x.version="0.11.0",t.exports=x},{"./DOMPropertyOperations":12,"./EventPluginUtils":20,"./ReactChildren":34,"./ReactComponent":35,"./ReactCompositeComponent":38,"./ReactContext":39,"./ReactCurrentOwner":40,"./ReactDOM":41,"./ReactDOMComponent":43,"./ReactDefaultInjection":53,"./ReactDescriptor":54,"./ReactInstanceHandles":62,"./ReactMount":65,"./ReactMultiChild":66,"./ReactPerf":69,"./ReactPropTypes":73,"./ReactServerRendering":77,"./ReactTextComponent":80,"./onlyChild":146}],30:[function(e,t){"use strict";var i=e("./ReactEmptyComponent"),n=e("./ReactMount"),a=e("./invariant"),r={getDOMNode:function(){return a(this.isMounted()),i.isNullComponentID(this._rootNodeID)?null:n.getNode(this._rootNodeID)}};t.exports=r},{"./ReactEmptyComponent":56,"./ReactMount":65,"./invariant":131}],31:[function(e,t){"use strict";function i(e){return Object.prototype.hasOwnProperty.call(e,m)||(e[m]=p++,c[e[m]]={}),c[e[m]]}var n=e("./EventConstants"),a=e("./EventPluginHub"),r=e("./EventPluginRegistry"),s=e("./ReactEventEmitterMixin"),o=e("./ViewportMetrics"),l=e("./isEventSupported"),u=e("./merge"),c={},d=!1,p=0,f={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},m="_reactListenersID"+String(Math.random()).slice(2),h=u(s,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(h.handleTopLevel),h.ReactEventListener=e
}},setEnabled:function(e){h.ReactEventListener&&h.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!h.ReactEventListener||!h.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var a=t,s=i(a),o=r.registrationNameDependencies[e],u=n.topLevelTypes,c=0,d=o.length;d>c;c++){var p=o[c];s.hasOwnProperty(p)&&s[p]||(p===u.topWheel?l("wheel")?h.ReactEventListener.trapBubbledEvent(u.topWheel,"wheel",a):l("mousewheel")?h.ReactEventListener.trapBubbledEvent(u.topWheel,"mousewheel",a):h.ReactEventListener.trapBubbledEvent(u.topWheel,"DOMMouseScroll",a):p===u.topScroll?l("scroll",!0)?h.ReactEventListener.trapCapturedEvent(u.topScroll,"scroll",a):h.ReactEventListener.trapBubbledEvent(u.topScroll,"scroll",h.ReactEventListener.WINDOW_HANDLE):p===u.topFocus||p===u.topBlur?(l("focus",!0)?(h.ReactEventListener.trapCapturedEvent(u.topFocus,"focus",a),h.ReactEventListener.trapCapturedEvent(u.topBlur,"blur",a)):l("focusin")&&(h.ReactEventListener.trapBubbledEvent(u.topFocus,"focusin",a),h.ReactEventListener.trapBubbledEvent(u.topBlur,"focusout",a)),s[u.topBlur]=!0,s[u.topFocus]=!0):f.hasOwnProperty(p)&&h.ReactEventListener.trapBubbledEvent(p,f[p],a),s[p]=!0)}},trapBubbledEvent:function(e,t,i){return h.ReactEventListener.trapBubbledEvent(e,t,i)},trapCapturedEvent:function(e,t,i){return h.ReactEventListener.trapCapturedEvent(e,t,i)},ensureScrollValueMonitoring:function(){if(!d){var e=o.refreshScrollValues;h.ReactEventListener.monitorScrollValue(e),d=!0}},eventNameDispatchConfigs:a.eventNameDispatchConfigs,registrationNameModules:a.registrationNameModules,putListener:a.putListener,getListener:a.getListener,deleteListener:a.deleteListener,deleteAllListeners:a.deleteAllListeners});t.exports=h},{"./EventConstants":16,"./EventPluginHub":18,"./EventPluginRegistry":19,"./ReactEventEmitterMixin":58,"./ViewportMetrics":102,"./isEventSupported":132,"./merge":141}],32:[function(e,t){"use strict";var i=e("./React"),n=e("./ReactTransitionGroup"),a=e("./ReactCSSTransitionGroupChild"),r=i.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:i.PropTypes.string.isRequired,transitionEnter:i.PropTypes.bool,transitionLeave:i.PropTypes.bool},getDefaultProps:function(){return{transitionEnter:!0,transitionLeave:!0}
},_wrapChild:function(e){return a({name:this.props.transitionName,enter:this.props.transitionEnter,leave:this.props.transitionLeave},e)},render:function(){return this.transferPropsTo(n({childFactory:this._wrapChild},this.props.children))}});t.exports=r},{"./React":29,"./ReactCSSTransitionGroupChild":33,"./ReactTransitionGroup":83}],33:[function(e,t){"use strict";var i=e("./React"),n=e("./CSSCore"),a=e("./ReactTransitionEvents"),r=e("./onlyChild"),s=17,o=i.createClass({displayName:"ReactCSSTransitionGroupChild",transition:function(e,t){var i=this.getDOMNode(),r=this.props.name+"-"+e,s=r+"-active",o=function(){n.removeClass(i,r),n.removeClass(i,s),a.removeEndEventListener(i,o),t&&t()};a.addEndEventListener(i,o),n.addClass(i,r),this.queueClass(s)},queueClass:function(e){this.classNameQueue.push(e),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,s))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(n.addClass.bind(n,this.getDOMNode())),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillEnter:function(e){this.props.enter?this.transition("enter",e):e()},componentWillLeave:function(e){this.props.leave?this.transition("leave",e):e()},render:function(){return r(this.props.children)}});t.exports=o},{"./CSSCore":3,"./React":29,"./ReactTransitionEvents":82,"./onlyChild":146}],34:[function(e,t){"use strict";function i(e,t){this.forEachFunction=e,this.forEachContext=t}function n(e,t,i,n){var a=e;a.forEachFunction.call(a.forEachContext,t,n)}function a(e,t,a){if(null==e)return e;var r=i.getPooled(t,a);d(e,n,r),i.release(r)}function r(e,t,i){this.mapResult=e,this.mapFunction=t,this.mapContext=i}function s(e,t,i,n){var a=e,r=a.mapResult,s=!r.hasOwnProperty(i);if(s){var o=a.mapFunction.call(a.mapContext,t,n);r[i]=o}}function o(e,t,i){if(null==e)return e;var n={},a=r.getPooled(n,t,i);return d(e,s,a),r.release(a),n
}function l(){return null}function u(e){return d(e,l,null)}var c=e("./PooledClass"),d=e("./traverseAllChildren"),p=(e("./warning"),c.twoArgumentPooler),f=c.threeArgumentPooler;c.addPoolingTo(i,p),c.addPoolingTo(r,f);var m={forEach:a,map:o,count:u};t.exports=m},{"./PooledClass":28,"./traverseAllChildren":151,"./warning":153}],35:[function(e,t){"use strict";var i=e("./ReactDescriptor"),n=e("./ReactOwner"),a=e("./ReactUpdates"),r=e("./invariant"),s=e("./keyMirror"),o=e("./merge"),l=s({MOUNTED:null,UNMOUNTED:null}),u=!1,c=null,d=null,p={injection:{injectEnvironment:function(e){r(!u),d=e.mountImageIntoNode,c=e.unmountIDFromEnvironment,p.BackendIDOperations=e.BackendIDOperations,u=!0}},LifeCycle:l,BackendIDOperations:null,Mixin:{isMounted:function(){return this._lifeCycleState===l.MOUNTED},setProps:function(e,t){var i=this._pendingDescriptor||this._descriptor;this.replaceProps(o(i.props,e),t)},replaceProps:function(e,t){r(this.isMounted()),r(0===this._mountDepth),this._pendingDescriptor=i.cloneAndReplaceProps(this._pendingDescriptor||this._descriptor,e),a.enqueueUpdate(this,t)},_setPropsInternal:function(e,t){var n=this._pendingDescriptor||this._descriptor;this._pendingDescriptor=i.cloneAndReplaceProps(n,o(n.props,e)),a.enqueueUpdate(this,t)},construct:function(e){this.props=e.props,this._owner=e._owner,this._lifeCycleState=l.UNMOUNTED,this._pendingCallbacks=null,this._descriptor=e,this._pendingDescriptor=null},mountComponent:function(e,t,i){r(!this.isMounted());var a=this._descriptor.props;if(null!=a.ref){var s=this._descriptor._owner;n.addComponentAsRefTo(this,a.ref,s)}this._rootNodeID=e,this._lifeCycleState=l.MOUNTED,this._mountDepth=i},unmountComponent:function(){r(this.isMounted());var e=this.props;null!=e.ref&&n.removeComponentAsRefFrom(this,e.ref,this._owner),c(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=l.UNMOUNTED},receiveComponent:function(e,t){r(this.isMounted()),this._pendingDescriptor=e,this.performUpdateIfNecessary(t)},performUpdateIfNecessary:function(e){if(null!=this._pendingDescriptor){var t=this._descriptor,i=this._pendingDescriptor;
this._descriptor=i,this.props=i.props,this._owner=i._owner,this._pendingDescriptor=null,this.updateComponent(e,t)}},updateComponent:function(e,t){var i=this._descriptor;(i._owner!==t._owner||i.props.ref!==t.props.ref)&&(null!=t.props.ref&&n.removeComponentAsRefFrom(this,t.props.ref,t._owner),null!=i.props.ref&&n.addComponentAsRefTo(this,i.props.ref,i._owner))},mountComponentIntoNode:function(e,t,i){var n=a.ReactReconcileTransaction.getPooled();n.perform(this._mountComponentIntoNode,this,e,t,n,i),a.ReactReconcileTransaction.release(n)},_mountComponentIntoNode:function(e,t,i,n){var a=this.mountComponent(e,i,0);d(a,t,n)},isOwnedBy:function(e){return this._owner===e},getSiblingByRef:function(e){var t=this._owner;return t&&t.refs?t.refs[e]:null}}};t.exports=p},{"./ReactDescriptor":54,"./ReactOwner":68,"./ReactUpdates":84,"./invariant":131,"./keyMirror":137,"./merge":141}],36:[function(e,t){"use strict";var i=e("./ReactDOMIDOperations"),n=e("./ReactMarkupChecksum"),a=e("./ReactMount"),r=e("./ReactPerf"),s=e("./ReactReconcileTransaction"),o=e("./getReactRootElementInContainer"),l=e("./invariant"),u=e("./setInnerHTML"),c=1,d=9,p={ReactReconcileTransaction:s,BackendIDOperations:i,unmountIDFromEnvironment:function(e){a.purgeID(e)},mountImageIntoNode:r.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(e,t,i){if(l(t&&(t.nodeType===c||t.nodeType===d)),i){if(n.canReuseMarkup(e,o(t)))return;l(t.nodeType!==d)}l(t.nodeType!==d),u(t,e)})};t.exports=p},{"./ReactDOMIDOperations":45,"./ReactMarkupChecksum":64,"./ReactMount":65,"./ReactPerf":69,"./ReactReconcileTransaction":75,"./getReactRootElementInContainer":125,"./invariant":131,"./setInnerHTML":147}],37:[function(e,t){"use strict";var i=e("./shallowEqual"),n={shouldComponentUpdate:function(e,t){return!i(this.props,e)||!i(this.state,t)}};t.exports=n},{"./shallowEqual":148}],38:[function(e,t){"use strict";function i(e){var t=e._owner||null;return t&&t.constructor&&t.constructor.displayName?" Check the render method of `"+t.constructor.displayName+"`.":""
}function n(e,t){for(var i in t)t.hasOwnProperty(i)&&C("function"==typeof t[i])}function a(e,t){var i=R.hasOwnProperty(t)?R[t]:null;M.hasOwnProperty(t)&&C(i===P.OVERRIDE_BASE),e.hasOwnProperty(t)&&C(i===P.DEFINE_MANY||i===P.DEFINE_MANY_MERGED)}function r(e){var t=e._compositeLifeCycleState;C(e.isMounted()||t===F.MOUNTING),C(t!==F.RECEIVING_STATE),C(t!==F.UNMOUNTING)}function s(e,t){C(!m.isValidFactory(t)),C(!m.isValidDescriptor(t));var i=e.prototype;for(var n in t){var r=t[n];if(t.hasOwnProperty(n))if(a(i,n),A.hasOwnProperty(n))A[n](e,r);else{var s=R.hasOwnProperty(n),o=i.hasOwnProperty(n),l=r&&r.__reactDontBind,d="function"==typeof r,p=d&&!s&&!o&&!l;if(p)i.__reactAutoBindMap||(i.__reactAutoBindMap={}),i.__reactAutoBindMap[n]=r,i[n]=r;else if(o){var f=R[n];C(s&&(f===P.DEFINE_MANY_MERGED||f===P.DEFINE_MANY)),f===P.DEFINE_MANY_MERGED?i[n]=u(i[n],r):f===P.DEFINE_MANY&&(i[n]=c(i[n],r))}else i[n]=r}}}function o(e,t){if(t)for(var i in t){var n=t[i];if(t.hasOwnProperty(i)){var a=i in e,r=n;if(a){var s=e[i],o=typeof s,l=typeof n;C("function"===o&&"function"===l),r=c(s,n)}e[i]=r}}}function l(e,t){return C(e&&t&&"object"==typeof e&&"object"==typeof t),I(t,function(t,i){C(void 0===e[i]),e[i]=t}),e}function u(e,t){return function(){var i=e.apply(this,arguments),n=t.apply(this,arguments);return null==i?n:null==n?i:l(i,n)}}function c(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}var d=e("./ReactComponent"),p=e("./ReactContext"),f=e("./ReactCurrentOwner"),m=e("./ReactDescriptor"),h=(e("./ReactDescriptorValidator"),e("./ReactEmptyComponent")),g=e("./ReactErrorUtils"),v=e("./ReactOwner"),b=e("./ReactPerf"),y=e("./ReactPropTransferer"),_=e("./ReactPropTypeLocations"),x=(e("./ReactPropTypeLocationNames"),e("./ReactUpdates")),w=e("./instantiateReactComponent"),C=e("./invariant"),S=e("./keyMirror"),T=e("./merge"),k=e("./mixInto"),I=(e("./monitorCodeUse"),e("./mapObject")),D=e("./shouldUpdateReactComponent"),P=(e("./warning"),S({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null})),E=[],R={mixins:P.DEFINE_MANY,statics:P.DEFINE_MANY,propTypes:P.DEFINE_MANY,contextTypes:P.DEFINE_MANY,childContextTypes:P.DEFINE_MANY,getDefaultProps:P.DEFINE_MANY_MERGED,getInitialState:P.DEFINE_MANY_MERGED,getChildContext:P.DEFINE_MANY_MERGED,render:P.DEFINE_ONCE,componentWillMount:P.DEFINE_MANY,componentDidMount:P.DEFINE_MANY,componentWillReceiveProps:P.DEFINE_MANY,shouldComponentUpdate:P.DEFINE_ONCE,componentWillUpdate:P.DEFINE_MANY,componentDidUpdate:P.DEFINE_MANY,componentWillUnmount:P.DEFINE_MANY,updateComponent:P.OVERRIDE_BASE},A={displayName:function(e,t){e.displayName=t
},mixins:function(e,t){if(t)for(var i=0;i<t.length;i++)s(e,t[i])},childContextTypes:function(e,t){n(e,t,_.childContext),e.childContextTypes=T(e.childContextTypes,t)},contextTypes:function(e,t){n(e,t,_.context),e.contextTypes=T(e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps=e.getDefaultProps?u(e.getDefaultProps,t):t},propTypes:function(e,t){n(e,t,_.prop),e.propTypes=T(e.propTypes,t)},statics:function(e,t){o(e,t)}},F=S({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null,RECEIVING_STATE:null}),M={construct:function(){d.Mixin.construct.apply(this,arguments),v.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._compositeLifeCycleState=null},isMounted:function(){return d.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==F.MOUNTING},mountComponent:b.measure("ReactCompositeComponent","mountComponent",function(e,t,i){d.Mixin.mountComponent.call(this,e,t,i),this._compositeLifeCycleState=F.MOUNTING,this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.context=this._processContext(this._descriptor._context),this.props=this._processProps(this.props),this.state=this.getInitialState?this.getInitialState():null,C("object"==typeof this.state&&!Array.isArray(this.state)),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=w(this._renderValidatedComponent()),this._compositeLifeCycleState=null;var n=this._renderedComponent.mountComponent(e,t,i+1);return this.componentDidMount&&t.getReactMountReady().enqueue(this.componentDidMount,this),n}),unmountComponent:function(){this._compositeLifeCycleState=F.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,d.Mixin.unmountComponent.call(this)},setState:function(e,t){C("object"==typeof e||null==e),this.replaceState(T(this._pendingState||this.state,e),t)
},replaceState:function(e,t){r(this),this._pendingState=e,x.enqueueUpdate(this,t)},_processContext:function(e){var t=null,i=this.constructor.contextTypes;if(i){t={};for(var n in i)t[n]=e[n]}return t},_processChildContext:function(e){var t=this.getChildContext&&this.getChildContext();if(this.constructor.displayName||"ReactCompositeComponent",t){C("object"==typeof this.constructor.childContextTypes);for(var i in t)C(i in this.constructor.childContextTypes);return T(e,t)}return e},_processProps:function(e){var t,i=this.constructor.defaultProps;if(i){t=T(e);for(var n in i)"undefined"==typeof t[n]&&(t[n]=i[n])}else t=e;return t},_checkPropTypes:function(e,t,n){var a=this.constructor.displayName;for(var r in e)if(e.hasOwnProperty(r)){var s=e[r](t,r,a,n);s instanceof Error&&i(this)}},performUpdateIfNecessary:function(e){var t=this._compositeLifeCycleState;if(t!==F.MOUNTING&&t!==F.RECEIVING_PROPS&&(null!=this._pendingDescriptor||null!=this._pendingState||this._pendingForceUpdate)){var i=this.context,n=this.props,a=this._descriptor;null!=this._pendingDescriptor&&(a=this._pendingDescriptor,i=this._processContext(a._context),n=this._processProps(a.props),this._pendingDescriptor=null,this._compositeLifeCycleState=F.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(n,i)),this._compositeLifeCycleState=F.RECEIVING_STATE;var r=this._pendingState||this.state;this._pendingState=null;try{var s=this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(n,r,i);s?(this._pendingForceUpdate=!1,this._performComponentUpdate(a,n,r,i,e)):(this._descriptor=a,this.props=n,this.state=r,this.context=i,this._owner=a._owner)}finally{this._compositeLifeCycleState=null}}},_performComponentUpdate:function(e,t,i,n,a){var r=this._descriptor,s=this.props,o=this.state,l=this.context;this.componentWillUpdate&&this.componentWillUpdate(t,i,n),this._descriptor=e,this.props=t,this.state=i,this.context=n,this._owner=e._owner,this.updateComponent(a,r),this.componentDidUpdate&&a.getReactMountReady().enqueue(this.componentDidUpdate.bind(this,s,o,l),this)
},receiveComponent:function(e,t){(e!==this._descriptor||null==e._owner)&&d.Mixin.receiveComponent.call(this,e,t)},updateComponent:b.measure("ReactCompositeComponent","updateComponent",function(e,t){d.Mixin.updateComponent.call(this,e,t);var i=this._renderedComponent,n=i._descriptor,a=this._renderValidatedComponent();if(D(n,a))i.receiveComponent(a,e);else{var r=this._rootNodeID,s=i._rootNodeID;i.unmountComponent(),this._renderedComponent=w(a);var o=this._renderedComponent.mountComponent(r,e,this._mountDepth+1);d.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(s,o)}}),forceUpdate:function(e){var t=this._compositeLifeCycleState;C(this.isMounted()||t===F.MOUNTING),C(t!==F.RECEIVING_STATE&&t!==F.UNMOUNTING),this._pendingForceUpdate=!0,x.enqueueUpdate(this,e)},_renderValidatedComponent:b.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var e,t=p.current;p.current=this._processChildContext(this._descriptor._context),f.current=this;try{e=this.render(),null===e||e===!1?(e=h.getEmptyComponent(),h.registerNullComponentID(this._rootNodeID)):h.deregisterNullComponentID(this._rootNodeID)}finally{p.current=t,f.current=null}return C(m.isValidDescriptor(e)),e}),_bindAutoBindMethods:function(){for(var e in this.__reactAutoBindMap)if(this.__reactAutoBindMap.hasOwnProperty(e)){var t=this.__reactAutoBindMap[e];this[e]=this._bindAutoBindMethod(g.guard(t,this.constructor.displayName+"."+e))}},_bindAutoBindMethod:function(e){var t=this,i=function(){return e.apply(t,arguments)};return i}},N=function(){};k(N,d.Mixin),k(N,v.Mixin),k(N,y.Mixin),k(N,M);var j={LifeCycle:F,Base:N,createClass:function(e){var t=function(e,t){this.construct(e,t)};t.prototype=new N,t.prototype.constructor=t,E.forEach(s.bind(null,t)),s(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),C(t.prototype.render);for(var i in R)t.prototype[i]||(t.prototype[i]=null);var n=m.createFactory(t);return n},injection:{injectMixin:function(e){E.push(e)}}};t.exports=j},{"./ReactComponent":35,"./ReactContext":39,"./ReactCurrentOwner":40,"./ReactDescriptor":54,"./ReactDescriptorValidator":55,"./ReactEmptyComponent":56,"./ReactErrorUtils":57,"./ReactOwner":68,"./ReactPerf":69,"./ReactPropTransferer":70,"./ReactPropTypeLocationNames":71,"./ReactPropTypeLocations":72,"./ReactUpdates":84,"./instantiateReactComponent":130,"./invariant":131,"./keyMirror":137,"./mapObject":139,"./merge":141,"./mixInto":144,"./monitorCodeUse":145,"./shouldUpdateReactComponent":149,"./warning":153}],39:[function(e,t){"use strict";
var i=e("./merge"),n={current:{},withContext:function(e,t){var a,r=n.current;n.current=i(r,e);try{a=t()}finally{n.current=r}return a}};t.exports=n},{"./merge":141}],40:[function(e,t){"use strict";var i={current:null};t.exports=i},{}],41:[function(e,t){"use strict";function i(e,t){var i=function(e){this.construct(e)};i.prototype=new a(t,e),i.prototype.constructor=i,i.displayName=t;var r=n.createFactory(i);return r}var n=e("./ReactDescriptor"),a=(e("./ReactDescriptorValidator"),e("./ReactDOMComponent")),r=e("./mergeInto"),s=e("./mapObject"),o=s({a:!1,abbr:!1,address:!1,area:!0,article:!1,aside:!1,audio:!1,b:!1,base:!0,bdi:!1,bdo:!1,big:!1,blockquote:!1,body:!1,br:!0,button:!1,canvas:!1,caption:!1,cite:!1,code:!1,col:!0,colgroup:!1,data:!1,datalist:!1,dd:!1,del:!1,details:!1,dfn:!1,div:!1,dl:!1,dt:!1,em:!1,embed:!0,fieldset:!1,figcaption:!1,figure:!1,footer:!1,form:!1,h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,head:!1,header:!1,hr:!0,html:!1,i:!1,iframe:!1,img:!0,input:!0,ins:!1,kbd:!1,keygen:!0,label:!1,legend:!1,li:!1,link:!0,main:!1,map:!1,mark:!1,menu:!1,menuitem:!1,meta:!0,meter:!1,nav:!1,noscript:!1,object:!1,ol:!1,optgroup:!1,option:!1,output:!1,p:!1,param:!0,pre:!1,progress:!1,q:!1,rp:!1,rt:!1,ruby:!1,s:!1,samp:!1,script:!1,section:!1,select:!1,small:!1,source:!0,span:!1,strong:!1,style:!1,sub:!1,summary:!1,sup:!1,table:!1,tbody:!1,td:!1,textarea:!1,tfoot:!1,th:!1,thead:!1,time:!1,title:!1,tr:!1,track:!0,u:!1,ul:!1,"var":!1,video:!1,wbr:!0,circle:!1,defs:!1,ellipse:!1,g:!1,line:!1,linearGradient:!1,mask:!1,path:!1,pattern:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,stop:!1,svg:!1,text:!1,tspan:!1},i),l={injectComponentClasses:function(e){r(o,e)}};o.injection=l,t.exports=o},{"./ReactDOMComponent":43,"./ReactDescriptor":54,"./ReactDescriptorValidator":55,"./mapObject":139,"./mergeInto":143}],42:[function(e,t){"use strict";var i=e("./AutoFocusMixin"),n=e("./ReactBrowserComponentMixin"),a=e("./ReactCompositeComponent"),r=e("./ReactDOM"),s=e("./keyMirror"),o=r.button,l=s({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),u=a.createClass({displayName:"ReactDOMButton",mixins:[i,n],render:function(){var e={};
for(var t in this.props)!this.props.hasOwnProperty(t)||this.props.disabled&&l[t]||(e[t]=this.props[t]);return o(e,this.props.children)}});t.exports=u},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./keyMirror":137}],43:[function(e,t){"use strict";function i(e){e&&(h(null==e.children||null==e.dangerouslySetInnerHTML),h(null==e.style||"object"==typeof e.style))}function n(e,t,i,n){var a=d.findReactContainerForID(e);if(a){var r=a.nodeType===S?a.ownerDocument:a;_(t,r)}n.getPutListenerQueue().enqueuePutListener(e,t,i)}function a(e,t){this._tagOpen="<"+e,this._tagClose=t?"":"</"+e+">",this.tagName=e.toUpperCase()}var r=e("./CSSPropertyOperations"),s=e("./DOMProperty"),o=e("./DOMPropertyOperations"),l=e("./ReactBrowserComponentMixin"),u=e("./ReactComponent"),c=e("./ReactBrowserEventEmitter"),d=e("./ReactMount"),p=e("./ReactMultiChild"),f=e("./ReactPerf"),m=e("./escapeTextForBrowser"),h=e("./invariant"),g=e("./keyOf"),v=e("./merge"),b=e("./mixInto"),y=c.deleteListener,_=c.listenTo,x=c.registrationNameModules,w={string:!0,number:!0},C=g({style:null}),S=1;a.Mixin={mountComponent:f.measure("ReactDOMComponent","mountComponent",function(e,t,n){return u.Mixin.mountComponent.call(this,e,t,n),i(this.props),this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t)+this._tagClose}),_createOpenTagMarkupAndPutListeners:function(e){var t=this.props,i=this._tagOpen;for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];if(null!=s)if(x.hasOwnProperty(a))n(this._rootNodeID,a,s,e);else{a===C&&(s&&(s=t.style=v(t.style)),s=r.createMarkupForStyles(s));var l=o.createMarkupForProperty(a,s);l&&(i+=" "+l)}}if(e.renderToStaticMarkup)return i+">";var u=o.createMarkupForID(this._rootNodeID);return i+" "+u+">"},_createContentMarkup:function(e){var t=this.props.dangerouslySetInnerHTML;if(null!=t){if(null!=t.__html)return t.__html}else{var i=w[typeof this.props.children]?this.props.children:null,n=null!=i?null:this.props.children;if(null!=i)return m(i);
if(null!=n){var a=this.mountChildren(n,e);return a.join("")}}return""},receiveComponent:function(e,t){(e!==this._descriptor||null==e._owner)&&u.Mixin.receiveComponent.call(this,e,t)},updateComponent:f.measure("ReactDOMComponent","updateComponent",function(e,t){i(this._descriptor.props),u.Mixin.updateComponent.call(this,e,t),this._updateDOMProperties(t.props,e),this._updateDOMChildren(t.props,e)}),_updateDOMProperties:function(e,t){var i,a,r,o=this.props;for(i in e)if(!o.hasOwnProperty(i)&&e.hasOwnProperty(i))if(i===C){var l=e[i];for(a in l)l.hasOwnProperty(a)&&(r=r||{},r[a]="")}else x.hasOwnProperty(i)?y(this._rootNodeID,i):(s.isStandardName[i]||s.isCustomAttribute(i))&&u.BackendIDOperations.deletePropertyByID(this._rootNodeID,i);for(i in o){var c=o[i],d=e[i];if(o.hasOwnProperty(i)&&c!==d)if(i===C)if(c&&(c=o.style=v(c)),d){for(a in d)!d.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r=r||{},r[a]="");for(a in c)c.hasOwnProperty(a)&&d[a]!==c[a]&&(r=r||{},r[a]=c[a])}else r=c;else x.hasOwnProperty(i)?n(this._rootNodeID,i,c,t):(s.isStandardName[i]||s.isCustomAttribute(i))&&u.BackendIDOperations.updatePropertyByID(this._rootNodeID,i,c)}r&&u.BackendIDOperations.updateStylesByID(this._rootNodeID,r)},_updateDOMChildren:function(e,t){var i=this.props,n=w[typeof e.children]?e.children:null,a=w[typeof i.children]?i.children:null,r=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,s=i.dangerouslySetInnerHTML&&i.dangerouslySetInnerHTML.__html,o=null!=n?null:e.children,l=null!=a?null:i.children,c=null!=n||null!=r,d=null!=a||null!=s;null!=o&&null==l?this.updateChildren(null,t):c&&!d&&this.updateTextContent(""),null!=a?n!==a&&this.updateTextContent(""+a):null!=s?r!==s&&u.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,s):null!=l&&this.updateChildren(l,t)},unmountComponent:function(){this.unmountChildren(),c.deleteAllListeners(this._rootNodeID),u.Mixin.unmountComponent.call(this)}},b(a,u.Mixin),b(a,a.Mixin),b(a,p.Mixin),b(a,l),t.exports=a},{"./CSSPropertyOperations":5,"./DOMProperty":11,"./DOMPropertyOperations":12,"./ReactBrowserComponentMixin":30,"./ReactBrowserEventEmitter":31,"./ReactComponent":35,"./ReactMount":65,"./ReactMultiChild":66,"./ReactPerf":69,"./escapeTextForBrowser":115,"./invariant":131,"./keyOf":138,"./merge":141,"./mixInto":144}],44:[function(e,t){"use strict";
var i=e("./EventConstants"),n=e("./LocalEventTrapMixin"),a=e("./ReactBrowserComponentMixin"),r=e("./ReactCompositeComponent"),s=e("./ReactDOM"),o=s.form,l=r.createClass({displayName:"ReactDOMForm",mixins:[a,n],render:function(){return this.transferPropsTo(o(null,this.props.children))},componentDidMount:function(){this.trapBubbledEvent(i.topLevelTypes.topReset,"reset"),this.trapBubbledEvent(i.topLevelTypes.topSubmit,"submit")}});t.exports=l},{"./EventConstants":16,"./LocalEventTrapMixin":26,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41}],45:[function(e,t){"use strict";var i=e("./CSSPropertyOperations"),n=e("./DOMChildrenOperations"),a=e("./DOMPropertyOperations"),r=e("./ReactMount"),s=e("./ReactPerf"),o=e("./invariant"),l=e("./setInnerHTML"),u={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},c={updatePropertyByID:s.measure("ReactDOMIDOperations","updatePropertyByID",function(e,t,i){var n=r.getNode(e);o(!u.hasOwnProperty(t)),null!=i?a.setValueForProperty(n,t,i):a.deleteValueForProperty(n,t)}),deletePropertyByID:s.measure("ReactDOMIDOperations","deletePropertyByID",function(e,t,i){var n=r.getNode(e);o(!u.hasOwnProperty(t)),a.deleteValueForProperty(n,t,i)}),updateStylesByID:s.measure("ReactDOMIDOperations","updateStylesByID",function(e,t){var n=r.getNode(e);i.setValueForStyles(n,t)}),updateInnerHTMLByID:s.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(e,t){var i=r.getNode(e);l(i,t)}),updateTextContentByID:s.measure("ReactDOMIDOperations","updateTextContentByID",function(e,t){var i=r.getNode(e);n.updateTextContent(i,t)}),dangerouslyReplaceNodeWithMarkupByID:s.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(e,t){var i=r.getNode(e);n.dangerouslyReplaceNodeWithMarkup(i,t)}),dangerouslyProcessChildrenUpdates:s.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(e,t){for(var i=0;i<e.length;i++)e[i].parentNode=r.getNode(e[i].parentID);
n.processUpdates(e,t)})};t.exports=c},{"./CSSPropertyOperations":5,"./DOMChildrenOperations":10,"./DOMPropertyOperations":12,"./ReactMount":65,"./ReactPerf":69,"./invariant":131,"./setInnerHTML":147}],46:[function(e,t){"use strict";var i=e("./EventConstants"),n=e("./LocalEventTrapMixin"),a=e("./ReactBrowserComponentMixin"),r=e("./ReactCompositeComponent"),s=e("./ReactDOM"),o=s.img,l=r.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[a,n],render:function(){return o(this.props)},componentDidMount:function(){this.trapBubbledEvent(i.topLevelTypes.topLoad,"load"),this.trapBubbledEvent(i.topLevelTypes.topError,"error")}});t.exports=l},{"./EventConstants":16,"./LocalEventTrapMixin":26,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41}],47:[function(e,t){"use strict";var i=e("./AutoFocusMixin"),n=e("./DOMPropertyOperations"),a=e("./LinkedValueUtils"),r=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),o=e("./ReactDOM"),l=e("./ReactMount"),u=e("./invariant"),c=e("./merge"),d=o.input,p={},f=s.createClass({displayName:"ReactDOMInput",mixins:[i,a.Mixin,r],getInitialState:function(){var e=this.props.defaultValue;return{checked:this.props.defaultChecked||!1,value:null!=e?e:null}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=c(this.props);e.defaultChecked=null,e.defaultValue=null;var t=a.getValue(this);e.value=null!=t?t:this.state.value;var i=a.getChecked(this);return e.checked=null!=i?i:this.state.checked,e.onChange=this._handleChange,d(e,this.props.children)},componentDidMount:function(){var e=l.getID(this.getDOMNode());p[e]=this},componentWillUnmount:function(){var e=this.getDOMNode(),t=l.getID(e);delete p[t]},componentDidUpdate:function(){var e=this.getDOMNode();null!=this.props.checked&&n.setValueForProperty(e,"checked",this.props.checked||!1);var t=a.getValue(this);null!=t&&n.setValueForProperty(e,"value",""+t)},_handleChange:function(e){var t,i=a.getOnChange(this);i&&(this._isChanging=!0,t=i.call(this,e),this._isChanging=!1),this.setState({checked:e.target.checked,value:e.target.value});
var n=this.props.name;if("radio"===this.props.type&&null!=n){for(var r=this.getDOMNode(),s=r;s.parentNode;)s=s.parentNode;for(var o=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),c=0,d=o.length;d>c;c++){var f=o[c];if(f!==r&&f.form===r.form){var m=l.getID(f);u(m);var h=p[m];u(h),h.setState({checked:!1})}}}return t}});t.exports=f},{"./AutoFocusMixin":1,"./DOMPropertyOperations":12,"./LinkedValueUtils":25,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./ReactMount":65,"./invariant":131,"./merge":141}],48:[function(e,t){"use strict";var i=e("./ReactBrowserComponentMixin"),n=e("./ReactCompositeComponent"),a=e("./ReactDOM"),r=(e("./warning"),a.option),s=n.createClass({displayName:"ReactDOMOption",mixins:[i],componentWillMount:function(){},render:function(){return r(this.props,this.props.children)}});t.exports=s},{"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./warning":153}],49:[function(e,t){"use strict";function i(e,t){if(null!=e[t])if(e.multiple){if(!Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be an array if `multiple` is true.")}else if(Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be a scalar value if `multiple` is false.")}function n(e,t){var i,n,a,r=e.props.multiple,s=null!=t?t:e.state.value,o=e.getDOMNode().options;if(r)for(i={},n=0,a=s.length;a>n;++n)i[""+s[n]]=!0;else i=""+s;for(n=0,a=o.length;a>n;n++){var l=r?i.hasOwnProperty(o[n].value):o[n].value===i;l!==o[n].selected&&(o[n].selected=l)}}var a=e("./AutoFocusMixin"),r=e("./LinkedValueUtils"),s=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),l=e("./ReactDOM"),u=e("./merge"),c=l.select,d=o.createClass({displayName:"ReactDOMSelect",mixins:[a,r.Mixin,s],propTypes:{defaultValue:i,value:i},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillReceiveProps:function(e){!this.props.multiple&&e.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!e.multiple&&this.setState({value:this.state.value[0]})
},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=u(this.props);return e.onChange=this._handleChange,e.value=null,c(e,this.props.children)},componentDidMount:function(){n(this,r.getValue(this))},componentDidUpdate:function(e){var t=r.getValue(this),i=!!e.multiple,a=!!this.props.multiple;(null!=t||i!==a)&&n(this,t)},_handleChange:function(e){var t,i=r.getOnChange(this);i&&(this._isChanging=!0,t=i.call(this,e),this._isChanging=!1);var n;if(this.props.multiple){n=[];for(var a=e.target.options,s=0,o=a.length;o>s;s++)a[s].selected&&n.push(a[s].value)}else n=e.target.value;return this.setState({value:n}),t}});t.exports=d},{"./AutoFocusMixin":1,"./LinkedValueUtils":25,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./merge":141}],50:[function(e,t){"use strict";function i(e,t,i,n){return e===i&&t===n}function n(e){var t=document.selection,i=t.createRange(),n=i.text.length,a=i.duplicate();a.moveToElementText(e),a.setEndPoint("EndToStart",i);var r=a.text.length,s=r+n;return{start:r,end:s}}function a(e){var t=window.getSelection();if(0===t.rangeCount)return null;var n=t.anchorNode,a=t.anchorOffset,r=t.focusNode,s=t.focusOffset,o=t.getRangeAt(0),l=i(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),u=l?0:o.toString().length,c=o.cloneRange();c.selectNodeContents(e),c.setEnd(o.startContainer,o.startOffset);var d=i(c.startContainer,c.startOffset,c.endContainer,c.endOffset),p=d?0:c.toString().length,f=p+u,m=document.createRange();m.setStart(n,a),m.setEnd(r,s);var h=m.collapsed;return m.detach(),{start:h?f:p,end:h?p:f}}function r(e,t){var i,n,a=document.selection.createRange().duplicate();"undefined"==typeof t.end?(i=t.start,n=i):t.start>t.end?(i=t.end,n=t.start):(i=t.start,n=t.end),a.moveToElementText(e),a.moveStart("character",i),a.setEndPoint("EndToStart",a),a.moveEnd("character",n-i),a.select()}function s(e,t){var i=window.getSelection(),n=e[u()].length,a=Math.min(t.start,n),r="undefined"==typeof t.end?a:Math.min(t.end,n);
if(!i.extend&&a>r){var s=r;r=a,a=s}var o=l(e,a),c=l(e,r);if(o&&c){var d=document.createRange();d.setStart(o.node,o.offset),i.removeAllRanges(),a>r?(i.addRange(d),i.extend(c.node,c.offset)):(d.setEnd(c.node,c.offset),i.addRange(d)),d.detach()}}var o=e("./ExecutionEnvironment"),l=e("./getNodeForCharacterOffset"),u=e("./getTextContentAccessor"),c=o.canUseDOM&&document.selection,d={getOffsets:c?n:a,setOffsets:c?r:s};t.exports=d},{"./ExecutionEnvironment":22,"./getNodeForCharacterOffset":124,"./getTextContentAccessor":126}],51:[function(e,t){"use strict";var i=e("./AutoFocusMixin"),n=e("./DOMPropertyOperations"),a=e("./LinkedValueUtils"),r=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),o=e("./ReactDOM"),l=e("./invariant"),u=e("./merge"),c=(e("./warning"),o.textarea),d=s.createClass({displayName:"ReactDOMTextarea",mixins:[i,a.Mixin,r],getInitialState:function(){var e=this.props.defaultValue,t=this.props.children;null!=t&&(l(null==e),Array.isArray(t)&&(l(t.length<=1),t=t[0]),e=""+t),null==e&&(e="");var i=a.getValue(this);return{initialValue:""+(null!=i?i:e)}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=u(this.props);return l(null==e.dangerouslySetInnerHTML),e.defaultValue=null,e.value=null,e.onChange=this._handleChange,c(e,this.state.initialValue)},componentDidUpdate:function(){var e=a.getValue(this);if(null!=e){var t=this.getDOMNode();n.setValueForProperty(t,"value",""+e)}},_handleChange:function(e){var t,i=a.getOnChange(this);return i&&(this._isChanging=!0,t=i.call(this,e),this._isChanging=!1),this.setState({value:e.target.value}),t}});t.exports=d},{"./AutoFocusMixin":1,"./DOMPropertyOperations":12,"./LinkedValueUtils":25,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./invariant":131,"./merge":141,"./warning":153}],52:[function(e,t){"use strict";function i(){this.reinitializeTransaction()}var n=e("./ReactUpdates"),a=e("./Transaction"),r=e("./emptyFunction"),s=e("./mixInto"),o={initialize:r,close:function(){d.isBatchingUpdates=!1
}},l={initialize:r,close:n.flushBatchedUpdates.bind(n)},u=[l,o];s(i,a.Mixin),s(i,{getTransactionWrappers:function(){return u}});var c=new i,d={isBatchingUpdates:!1,batchedUpdates:function(e,t,i){var n=d.isBatchingUpdates;d.isBatchingUpdates=!0,n?e(t,i):c.perform(e,null,t,i)}};t.exports=d},{"./ReactUpdates":84,"./Transaction":101,"./emptyFunction":113,"./mixInto":144}],53:[function(e,t){"use strict";function i(){S.EventEmitter.injectReactEventListener(C),S.EventPluginHub.injectEventPluginOrder(o),S.EventPluginHub.injectInstanceHandle(T),S.EventPluginHub.injectMount(k),S.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:P,EnterLeaveEventPlugin:l,ChangeEventPlugin:a,CompositionEventPlugin:s,MobileSafariClickEventPlugin:d,SelectEventPlugin:I,BeforeInputEventPlugin:n}),S.DOM.injectComponentClasses({button:g,form:v,img:b,input:y,option:_,select:x,textarea:w,html:R(h.html),head:R(h.head),body:R(h.body)}),S.CompositeComponent.injectMixin(p),S.DOMProperty.injectDOMPropertyConfig(c),S.DOMProperty.injectDOMPropertyConfig(E),S.EmptyComponent.injectEmptyComponent(h.noscript),S.Updates.injectReconcileTransaction(f.ReactReconcileTransaction),S.Updates.injectBatchingStrategy(m),S.RootIndex.injectCreateReactRootIndex(u.canUseDOM?r.createReactRootIndex:D.createReactRootIndex),S.Component.injectEnvironment(f)}var n=e("./BeforeInputEventPlugin"),a=e("./ChangeEventPlugin"),r=e("./ClientReactRootIndex"),s=e("./CompositionEventPlugin"),o=e("./DefaultEventPluginOrder"),l=e("./EnterLeaveEventPlugin"),u=e("./ExecutionEnvironment"),c=e("./HTMLDOMPropertyConfig"),d=e("./MobileSafariClickEventPlugin"),p=e("./ReactBrowserComponentMixin"),f=e("./ReactComponentBrowserEnvironment"),m=e("./ReactDefaultBatchingStrategy"),h=e("./ReactDOM"),g=e("./ReactDOMButton"),v=e("./ReactDOMForm"),b=e("./ReactDOMImg"),y=e("./ReactDOMInput"),_=e("./ReactDOMOption"),x=e("./ReactDOMSelect"),w=e("./ReactDOMTextarea"),C=e("./ReactEventListener"),S=e("./ReactInjection"),T=e("./ReactInstanceHandles"),k=e("./ReactMount"),I=e("./SelectEventPlugin"),D=e("./ServerReactRootIndex"),P=e("./SimpleEventPlugin"),E=e("./SVGDOMPropertyConfig"),R=e("./createFullPageComponent");
t.exports={inject:i}},{"./BeforeInputEventPlugin":2,"./ChangeEventPlugin":7,"./ClientReactRootIndex":8,"./CompositionEventPlugin":9,"./DefaultEventPluginOrder":14,"./EnterLeaveEventPlugin":15,"./ExecutionEnvironment":22,"./HTMLDOMPropertyConfig":23,"./MobileSafariClickEventPlugin":27,"./ReactBrowserComponentMixin":30,"./ReactComponentBrowserEnvironment":36,"./ReactDOM":41,"./ReactDOMButton":42,"./ReactDOMForm":44,"./ReactDOMImg":46,"./ReactDOMInput":47,"./ReactDOMOption":48,"./ReactDOMSelect":49,"./ReactDOMTextarea":51,"./ReactDefaultBatchingStrategy":52,"./ReactEventListener":59,"./ReactInjection":60,"./ReactInstanceHandles":62,"./ReactMount":65,"./SVGDOMPropertyConfig":86,"./SelectEventPlugin":87,"./ServerReactRootIndex":88,"./SimpleEventPlugin":89,"./createFullPageComponent":109}],54:[function(e,t){"use strict";function i(e,t){if("function"==typeof t)for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];if("function"==typeof n){var a=n.bind(t);for(var r in n)n.hasOwnProperty(r)&&(a[r]=n[r]);e[i]=a}else e[i]=n}}var n=e("./ReactContext"),a=e("./ReactCurrentOwner"),r=e("./merge"),s=(e("./warning"),function(){});s.createFactory=function(e){var t=Object.create(s.prototype),o=function(e,i){null==e?e={}:"object"==typeof e&&(e=r(e));var s=arguments.length-1;if(1===s)e.children=i;else if(s>1){for(var o=Array(s),l=0;s>l;l++)o[l]=arguments[l+1];e.children=o}var u=Object.create(t);return u._owner=a.current,u._context=n.current,u.props=e,u};return o.prototype=t,o.type=e,t.type=e,i(o,e),t.constructor=o,o},s.cloneAndReplaceProps=function(e,t){var i=Object.create(e.constructor.prototype);return i._owner=e._owner,i._context=e._context,i.props=t,i},s.isValidFactory=function(e){return"function"==typeof e&&e.prototype instanceof s},s.isValidDescriptor=function(e){return e instanceof s},t.exports=s},{"./ReactContext":39,"./ReactCurrentOwner":40,"./merge":141,"./warning":153}],55:[function(e,t){"use strict";function i(){var e=d.current;return e&&e.constructor.displayName||void 0}function n(e,t){e._store.validated||null!=e.props.key||(e._store.validated=!0,r("react_key_warning",'Each child in an array should have a unique "key" prop.',e,t))
}function a(e,t,i){g.test(e)&&r("react_numeric_key_warning","Child objects should have non-numeric keys so ordering is preserved.",t,i)}function r(e,t,n,a){var r=i(),s=a.displayName,o=r||s,l=f[e];if(!l.hasOwnProperty(o)){l[o]=!0,t+=r?" Check the render method of "+r+".":" Check the renderComponent call using <"+s+">.";var u=null;n._owner&&n._owner!==d.current&&(u=n._owner.constructor.displayName,t+=" It was passed a child from "+u+"."),t+=" See http://fb.me/react-warning-keys for more information.",p(e,{component:o,componentOwner:u}),console.warn(t)}}function s(){var e=i()||"";m.hasOwnProperty(e)||(m[e]=!0,p("react_object_map_children"))}function o(e,t){if(Array.isArray(e))for(var i=0;i<e.length;i++){var r=e[i];u.isValidDescriptor(r)&&n(r,t)}else if(u.isValidDescriptor(e))e._store.validated=!0;else if(e&&"object"==typeof e){s();for(var o in e)a(o,e[o],t)}}function l(e,t,i,n){for(var a in t)if(t.hasOwnProperty(a)){var r;try{r=t[a](i,a,e,n)}catch(s){r=s}r instanceof Error&&!(r.message in h)&&(h[r.message]=!0,p("react_failed_descriptor_type_check",{message:r.message}))}}var u=e("./ReactDescriptor"),c=e("./ReactPropTypeLocations"),d=e("./ReactCurrentOwner"),p=e("./monitorCodeUse"),f={react_key_warning:{},react_numeric_key_warning:{}},m={},h={},g=/^\d+$/,v={createFactory:function(e,t,i){var n=function(){for(var n=e.apply(this,arguments),a=1;a<arguments.length;a++)o(arguments[a],n.type);var r=n.type.displayName;return t&&l(r,t,n.props,c.prop),i&&l(r,i,n._context,c.context),n};n.prototype=e.prototype,n.type=e.type;for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);return n}};t.exports=v},{"./ReactCurrentOwner":40,"./ReactDescriptor":54,"./ReactPropTypeLocations":72,"./monitorCodeUse":145}],56:[function(e,t){"use strict";function i(){return o(s),s()}function n(e){l[e]=!0}function a(e){delete l[e]}function r(e){return l[e]}var s,o=e("./invariant"),l={},u={injectEmptyComponent:function(e){s=e}},c={deregisterNullComponentID:a,getEmptyComponent:i,injection:u,isNullComponentID:r,registerNullComponentID:n};
t.exports=c},{"./invariant":131}],57:[function(e,t){"use strict";var i={guard:function(e){return e}};t.exports=i},{}],58:[function(e,t){"use strict";function i(e){n.enqueueEvents(e),n.processEventQueue()}var n=e("./EventPluginHub"),a={handleTopLevel:function(e,t,a,r){var s=n.extractEvents(e,t,a,r);i(s)}};t.exports=a},{"./EventPluginHub":18}],59:[function(e,t){"use strict";function i(e){var t=c.getID(e),i=u.getReactRootIDFromNodeID(t),n=c.findReactContainerForID(i),a=c.getFirstReactDOM(n);return a}function n(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function a(e){for(var t=c.getFirstReactDOM(p(e.nativeEvent))||window,n=t;n;)e.ancestors.push(n),n=i(n);for(var a=0,r=e.ancestors.length;r>a;a++){t=e.ancestors[a];var s=c.getID(t)||"";h._handleTopLevel(e.topLevelType,t,s,e.nativeEvent)}}function r(e){var t=f(window);e(t)}var s=e("./EventListener"),o=e("./ExecutionEnvironment"),l=e("./PooledClass"),u=e("./ReactInstanceHandles"),c=e("./ReactMount"),d=e("./ReactUpdates"),p=e("./getEventTarget"),f=e("./getUnboundedScrollPosition"),m=e("./mixInto");m(n,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),l.addPoolingTo(n,l.twoArgumentPooler);var h={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:o.canUseDOM?window:null,setHandleTopLevel:function(e){h._handleTopLevel=e},setEnabled:function(e){h._enabled=!!e},isEnabled:function(){return h._enabled},trapBubbledEvent:function(e,t,i){var n=i;return n?s.listen(n,t,h.dispatchEvent.bind(null,e)):void 0},trapCapturedEvent:function(e,t,i){var n=i;return n?s.capture(n,t,h.dispatchEvent.bind(null,e)):void 0},monitorScrollValue:function(e){var t=r.bind(null,e);s.listen(window,"scroll",t),s.listen(window,"resize",t)},dispatchEvent:function(e,t){if(h._enabled){var i=n.getPooled(e,t);try{d.batchedUpdates(a,i)}finally{n.release(i)}}}};t.exports=h},{"./EventListener":17,"./ExecutionEnvironment":22,"./PooledClass":28,"./ReactInstanceHandles":62,"./ReactMount":65,"./ReactUpdates":84,"./getEventTarget":122,"./getUnboundedScrollPosition":127,"./mixInto":144}],60:[function(e,t){"use strict";
var i=e("./DOMProperty"),n=e("./EventPluginHub"),a=e("./ReactComponent"),r=e("./ReactCompositeComponent"),s=e("./ReactDOM"),o=e("./ReactEmptyComponent"),l=e("./ReactBrowserEventEmitter"),u=e("./ReactPerf"),c=e("./ReactRootIndex"),d=e("./ReactUpdates"),p={Component:a.injection,CompositeComponent:r.injection,DOMProperty:i.injection,EmptyComponent:o.injection,EventPluginHub:n.injection,DOM:s.injection,EventEmitter:l.injection,Perf:u.injection,RootIndex:c.injection,Updates:d.injection};t.exports=p},{"./DOMProperty":11,"./EventPluginHub":18,"./ReactBrowserEventEmitter":31,"./ReactComponent":35,"./ReactCompositeComponent":38,"./ReactDOM":41,"./ReactEmptyComponent":56,"./ReactPerf":69,"./ReactRootIndex":76,"./ReactUpdates":84}],61:[function(e,t){"use strict";function i(e){return a(document.documentElement,e)}var n=e("./ReactDOMSelection"),a=e("./containsNode"),r=e("./focusNode"),s=e("./getActiveElement"),o={hasSelectionCapabilities:function(e){return e&&("INPUT"===e.nodeName&&"text"===e.type||"TEXTAREA"===e.nodeName||"true"===e.contentEditable)},getSelectionInformation:function(){var e=s();return{focusedElem:e,selectionRange:o.hasSelectionCapabilities(e)?o.getSelection(e):null}},restoreSelection:function(e){var t=s(),n=e.focusedElem,a=e.selectionRange;t!==n&&i(n)&&(o.hasSelectionCapabilities(n)&&o.setSelection(n,a),r(n))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&"INPUT"===e.nodeName){var i=document.selection.createRange();i.parentElement()===e&&(t={start:-i.moveStart("character",-e.value.length),end:-i.moveEnd("character",-e.value.length)})}else t=n.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var i=t.start,a=t.end;if("undefined"==typeof a&&(a=i),"selectionStart"in e)e.selectionStart=i,e.selectionEnd=Math.min(a,e.value.length);else if(document.selection&&"INPUT"===e.nodeName){var r=e.createTextRange();r.collapse(!0),r.moveStart("character",i),r.moveEnd("character",a-i),r.select()
}else n.setOffsets(e,t)}};t.exports=o},{"./ReactDOMSelection":50,"./containsNode":106,"./focusNode":117,"./getActiveElement":119}],62:[function(e,t){"use strict";function i(e){return p+e.toString(36)}function n(e,t){return e.charAt(t)===p||t===e.length}function a(e){return""===e||e.charAt(0)===p&&e.charAt(e.length-1)!==p}function r(e,t){return 0===t.indexOf(e)&&n(t,e.length)}function s(e){return e?e.substr(0,e.lastIndexOf(p)):""}function o(e,t){if(d(a(e)&&a(t)),d(r(e,t)),e===t)return e;for(var i=e.length+f,s=i;s<t.length&&!n(t,s);s++);return t.substr(0,s)}function l(e,t){var i=Math.min(e.length,t.length);if(0===i)return"";for(var r=0,s=0;i>=s;s++)if(n(e,s)&&n(t,s))r=s;else if(e.charAt(s)!==t.charAt(s))break;var o=e.substr(0,r);return d(a(o)),o}function u(e,t,i,n,a,l){e=e||"",t=t||"",d(e!==t);var u=r(t,e);d(u||r(e,t));for(var c=0,p=u?s:o,f=e;;f=p(f,t)){var h;if(a&&f===e||l&&f===t||(h=i(f,u,n)),h===!1||f===t)break;d(c++<m)}}var c=e("./ReactRootIndex"),d=e("./invariant"),p=".",f=p.length,m=100,h={createReactRootID:function(){return i(c.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===p&&e.length>1){var t=e.indexOf(p,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,i,n,a){var r=l(e,t);r!==e&&u(e,r,i,n,!1,!0),r!==t&&u(r,t,i,a,!0,!1)},traverseTwoPhase:function(e,t,i){e&&(u("",e,t,i,!0,!1),u(e,"",t,i,!1,!0))},traverseAncestors:function(e,t,i){u("",e,t,i,!0,!1)},_getFirstCommonAncestorID:l,_getNextDescendantID:o,isAncestorIDOf:r,SEPARATOR:p};t.exports=h},{"./ReactRootIndex":76,"./invariant":131}],63:[function(e,t){"use strict";function i(e,t){this.value=e,this.requestChange=t}function n(e){var t={value:"undefined"==typeof e?a.PropTypes.any.isRequired:e.isRequired,requestChange:a.PropTypes.func.isRequired};return a.PropTypes.shape(t)}var a=e("./React");i.PropTypes={link:n},t.exports=i},{"./React":29}],64:[function(e,t){"use strict";var i=e("./adler32"),n={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=i(e);
return e.replace(">"," "+n.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(e,t){var a=t.getAttribute(n.CHECKSUM_ATTR_NAME);a=a&&parseInt(a,10);var r=i(e);return r===a}};t.exports=n},{"./adler32":104}],65:[function(e,t){"use strict";function i(e){var t=v(e);return t&&E.getID(t)}function n(e){var t=a(e);if(t)if(C.hasOwnProperty(t)){var i=C[t];i!==e&&(y(!o(i,t)),C[t]=e)}else C[t]=e;return t}function a(e){return e&&e.getAttribute&&e.getAttribute(w)||""}function r(e,t){var i=a(e);i!==t&&delete C[i],e.setAttribute(w,t),C[t]=e}function s(e){return C.hasOwnProperty(e)&&o(C[e],e)||(C[e]=E.findReactNodeByID(e)),C[e]}function o(e,t){if(e){y(a(e)===t);var i=E.findReactContainerForID(t);if(i&&g(i,e))return!0}return!1}function l(e){delete C[e]}function u(e){var t=C[e];return t&&o(t,e)?void(P=t):!1}function c(e){P=null,m.traverseAncestors(e,u);var t=P;return P=null,t}var d=e("./DOMProperty"),p=e("./ReactBrowserEventEmitter"),f=(e("./ReactCurrentOwner"),e("./ReactDescriptor")),m=e("./ReactInstanceHandles"),h=e("./ReactPerf"),g=e("./containsNode"),v=e("./getReactRootElementInContainer"),b=e("./instantiateReactComponent"),y=e("./invariant"),_=e("./shouldUpdateReactComponent"),x=(e("./warning"),m.SEPARATOR),w=d.ID_ATTRIBUTE_NAME,C={},S=1,T=9,k={},I={},D=[],P=null,E={_instancesByReactRootID:k,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,i,n){var a=t.props;return E.scrollMonitor(i,function(){e.replaceProps(a,n)}),e},_registerComponent:function(e,t){y(t&&(t.nodeType===S||t.nodeType===T)),p.ensureScrollValueMonitoring();var i=E.registerContainer(t);return k[i]=e,i},_renderNewRootComponent:h.measure("ReactMount","_renderNewRootComponent",function(e,t,i){var n=b(e),a=E._registerComponent(n,t);return n.mountComponentIntoNode(a,t,i),n}),renderComponent:function(e,t,n){y(f.isValidDescriptor(e));var a=k[i(t)];if(a){var r=a._descriptor;if(_(r,e))return E._updateRootComponent(a,e,t,n);E.unmountComponentAtNode(t)}var s=v(t),o=s&&E.isRenderedByReact(s),l=o&&!a,u=E._renderNewRootComponent(e,t,l);
return n&&n.call(u),u},constructAndRenderComponent:function(e,t,i){return E.renderComponent(e(t),i)},constructAndRenderComponentByID:function(e,t,i){var n=document.getElementById(i);return y(n),E.constructAndRenderComponent(e,t,n)},registerContainer:function(e){var t=i(e);return t&&(t=m.getReactRootIDFromNodeID(t)),t||(t=m.createReactRootID()),I[t]=e,t},unmountComponentAtNode:function(e){var t=i(e),n=k[t];return n?(E.unmountComponentFromNode(n,e),delete k[t],delete I[t],!0):!1},unmountComponentFromNode:function(e,t){for(e.unmountComponent(),t.nodeType===T&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)},findReactContainerForID:function(e){var t=m.getReactRootIDFromNodeID(e),i=I[t];return i},findReactNodeByID:function(e){var t=E.findReactContainerForID(e);return E.findComponentRoot(t,e)},isRenderedByReact:function(e){if(1!==e.nodeType)return!1;var t=E.getID(e);return t?t.charAt(0)===x:!1},getFirstReactDOM:function(e){for(var t=e;t&&t.parentNode!==t;){if(E.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(e,t){var i=D,n=0,a=c(t)||e;for(i[0]=a.firstChild,i.length=1;n<i.length;){for(var r,s=i[n++];s;){var o=E.getID(s);o?t===o?r=s:m.isAncestorIDOf(o,t)&&(i.length=n=0,i.push(s.firstChild)):i.push(s.firstChild),s=s.nextSibling}if(r)return i.length=0,r}i.length=0,y(!1)},getReactRootID:i,getID:n,setID:r,getNode:s,purgeID:l};t.exports=E},{"./DOMProperty":11,"./ReactBrowserEventEmitter":31,"./ReactCurrentOwner":40,"./ReactDescriptor":54,"./ReactInstanceHandles":62,"./ReactPerf":69,"./containsNode":106,"./getReactRootElementInContainer":125,"./instantiateReactComponent":130,"./invariant":131,"./shouldUpdateReactComponent":149,"./warning":153}],66:[function(e,t){"use strict";function i(e,t,i){m.push({parentID:e,parentNode:null,type:u.INSERT_MARKUP,markupIndex:h.push(t)-1,textContent:null,fromIndex:null,toIndex:i})}function n(e,t,i){m.push({parentID:e,parentNode:null,type:u.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:i})
}function a(e,t){m.push({parentID:e,parentNode:null,type:u.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:t,toIndex:null})}function r(e,t){m.push({parentID:e,parentNode:null,type:u.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function s(){m.length&&(l.BackendIDOperations.dangerouslyProcessChildrenUpdates(m,h),o())}function o(){m.length=0,h.length=0}var l=e("./ReactComponent"),u=e("./ReactMultiChildUpdateTypes"),c=e("./flattenChildren"),d=e("./instantiateReactComponent"),p=e("./shouldUpdateReactComponent"),f=0,m=[],h=[],g={Mixin:{mountChildren:function(e,t){var i=c(e),n=[],a=0;this._renderedChildren=i;for(var r in i){var s=i[r];if(i.hasOwnProperty(r)){var o=d(s);i[r]=o;var l=this._rootNodeID+r,u=o.mountComponent(l,t,this._mountDepth+1);o._mountIndex=a,n.push(u),a++}}return n},updateTextContent:function(e){f++;var t=!0;try{var i=this._renderedChildren;for(var n in i)i.hasOwnProperty(n)&&this._unmountChildByName(i[n],n);this.setTextContent(e),t=!1}finally{f--,f||(t?o():s())}},updateChildren:function(e,t){f++;var i=!0;try{this._updateChildren(e,t),i=!1}finally{f--,f||(i?o():s())}},_updateChildren:function(e,t){var i=c(e),n=this._renderedChildren;if(i||n){var a,r=0,s=0;for(a in i)if(i.hasOwnProperty(a)){var o=n&&n[a],l=o&&o._descriptor,u=i[a];if(p(l,u))this.moveChild(o,s,r),r=Math.max(o._mountIndex,r),o.receiveComponent(u,t),o._mountIndex=s;else{o&&(r=Math.max(o._mountIndex,r),this._unmountChildByName(o,a));var f=d(u);this._mountChildByNameAtIndex(f,a,s,t)}s++}for(a in n)!n.hasOwnProperty(a)||i&&i[a]||this._unmountChildByName(n[a],a)}},unmountChildren:function(){var e=this._renderedChildren;for(var t in e){var i=e[t];i.unmountComponent&&i.unmountComponent()}this._renderedChildren=null},moveChild:function(e,t,i){e._mountIndex<i&&n(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){i(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){a(this._rootNodeID,e._mountIndex)},setTextContent:function(e){r(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,i,n){var a=this._rootNodeID+t,r=e.mountComponent(a,n,this._mountDepth+1);
e._mountIndex=i,this.createChild(e,r),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[t]=e},_unmountChildByName:function(e,t){this.removeChild(e),e._mountIndex=null,e.unmountComponent(),delete this._renderedChildren[t]}}};t.exports=g},{"./ReactComponent":35,"./ReactMultiChildUpdateTypes":67,"./flattenChildren":116,"./instantiateReactComponent":130,"./shouldUpdateReactComponent":149}],67:[function(e,t){"use strict";var i=e("./keyMirror"),n=i({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});t.exports=n},{"./keyMirror":137}],68:[function(e,t){"use strict";var i=e("./emptyObject"),n=e("./invariant"),a={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,i){n(a.isValidOwner(i)),i.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,i){n(a.isValidOwner(i)),i.refs[t]===e&&i.detachRef(t)},Mixin:{construct:function(){this.refs=i},attachRef:function(e,t){n(t.isOwnedBy(this));var a=this.refs===i?this.refs={}:this.refs;a[e]=t},detachRef:function(e){delete this.refs[e]}}};t.exports=a},{"./emptyObject":114,"./invariant":131}],69:[function(e,t){"use strict";function i(e,t,i){return i}var n={enableMeasure:!1,storedMeasure:i,measure:function(e,t,i){return i},injection:{injectMeasure:function(e){n.storedMeasure=e}}};t.exports=n},{}],70:[function(e,t){"use strict";function i(e){return function(t,i,n){t[i]=t.hasOwnProperty(i)?e(t[i],n):n}}function n(e,t){for(var i in t)if(t.hasOwnProperty(i)){var n=u[i];n&&u.hasOwnProperty(i)?n(e,i,t[i]):e.hasOwnProperty(i)||(e[i]=t[i])}return e}var a=e("./emptyFunction"),r=e("./invariant"),s=e("./joinClasses"),o=e("./merge"),l=i(function(e,t){return o(t,e)}),u={children:a,className:i(s),key:a,ref:a,style:l},c={TransferStrategies:u,mergeProps:function(e,t){return n(o(e),t)},Mixin:{transferPropsTo:function(e){return r(e._owner===this),n(e.props,this.props),e}}};t.exports=c},{"./emptyFunction":113,"./invariant":131,"./joinClasses":136,"./merge":141}],71:[function(e,t){"use strict";
var i={};t.exports=i},{}],72:[function(e,t){"use strict";var i=e("./keyMirror"),n=i({prop:null,context:null,childContext:null});t.exports=n},{"./keyMirror":137}],73:[function(e,t){"use strict";function i(e){function t(t,i,n,a,r){if(a=a||y,null!=i[n])return e(i,n,a,r);var s=v[r];return t?new Error("Required "+s+" `"+n+"` was not specified in "+("`"+a+"`.")):void 0}var i=t.bind(null,!1);return i.isRequired=t.bind(null,!0),i}function n(e){function t(t,i,n,a){var r=t[i],s=m(r);if(s!==e){var o=v[a],l=h(r);return new Error("Invalid "+o+" `"+i+"` of type `"+l+"` "+("supplied to `"+n+"`, expected `"+e+"`."))}}return i(t)}function a(){return i(b.thatReturns())}function r(e){function t(t,i,n,a){var r=t[i];if(!Array.isArray(r)){var s=v[a],o=m(r);return new Error("Invalid "+s+" `"+i+"` of type "+("`"+o+"` supplied to `"+n+"`, expected an array."))}for(var l=0;l<r.length;l++){var u=e(r,l,n,a);if(u instanceof Error)return u}}return i(t)}function s(){function e(e,t,i,n){if(!g.isValidDescriptor(e[t])){var a=v[n];return new Error("Invalid "+a+" `"+t+"` supplied to "+("`"+i+"`, expected a React component."))}}return i(e)}function o(e){function t(t,i,n,a){if(!(t[i]instanceof e)){var r=v[a],s=e.name||y;return new Error("Invalid "+r+" `"+i+"` supplied to "+("`"+n+"`, expected instance of `"+s+"`."))}}return i(t)}function l(e){function t(t,i,n,a){for(var r=t[i],s=0;s<e.length;s++)if(r===e[s])return;var o=v[a],l=JSON.stringify(e);return new Error("Invalid "+o+" `"+i+"` of value `"+r+"` "+("supplied to `"+n+"`, expected one of "+l+"."))}return i(t)}function u(e){function t(t,i,n,a){var r=t[i],s=m(r);if("object"!==s){var o=v[a];return new Error("Invalid "+o+" `"+i+"` of type "+("`"+s+"` supplied to `"+n+"`, expected an object."))}for(var l in r)if(r.hasOwnProperty(l)){var u=e(r,l,n,a);if(u instanceof Error)return u}}return i(t)}function c(e){function t(t,i,n,a){for(var r=0;r<e.length;r++){var s=e[r];if(null==s(t,i,n,a))return}var o=v[a];return new Error("Invalid "+o+" `"+i+"` supplied to "+("`"+n+"`."))
}return i(t)}function d(){function e(e,t,i,n){if(!f(e[t])){var a=v[n];return new Error("Invalid "+a+" `"+t+"` supplied to "+("`"+i+"`, expected a renderable prop."))}}return i(e)}function p(e){function t(t,i,n,a){var r=t[i],s=m(r);if("object"!==s){var o=v[a];return new Error("Invalid "+o+" `"+i+"` of type `"+s+"` "+("supplied to `"+n+"`, expected `object`."))}for(var l in e){var u=e[l];if(u){var c=u(r,l,n,a);if(c)return c}}}return i(t,"expected `object`")}function f(e){switch(typeof e){case"number":case"string":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(f);if(g.isValidDescriptor(e))return!0;for(var t in e)if(!f(e[t]))return!1;return!0;default:return!1}}function m(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function h(e){var t=m(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}var g=e("./ReactDescriptor"),v=e("./ReactPropTypeLocationNames"),b=e("./emptyFunction"),y="<<anonymous>>",_={array:n("array"),bool:n("boolean"),func:n("function"),number:n("number"),object:n("object"),string:n("string"),any:a(),arrayOf:r,component:s(),instanceOf:o,objectOf:u,oneOf:l,oneOfType:c,renderable:d(),shape:p};t.exports=_},{"./ReactDescriptor":54,"./ReactPropTypeLocationNames":71,"./emptyFunction":113}],74:[function(e,t){"use strict";function i(){this.listenersToPut=[]}var n=e("./PooledClass"),a=e("./ReactBrowserEventEmitter"),r=e("./mixInto");r(i,{enqueuePutListener:function(e,t,i){this.listenersToPut.push({rootNodeID:e,propKey:t,propValue:i})},putListeners:function(){for(var e=0;e<this.listenersToPut.length;e++){var t=this.listenersToPut[e];a.putListener(t.rootNodeID,t.propKey,t.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),n.addPoolingTo(i),t.exports=i},{"./PooledClass":28,"./ReactBrowserEventEmitter":31,"./mixInto":144}],75:[function(e,t){"use strict";function i(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=n.getPooled(null),this.putListenerQueue=o.getPooled()
}var n=e("./CallbackQueue"),a=e("./PooledClass"),r=e("./ReactBrowserEventEmitter"),s=e("./ReactInputSelection"),o=e("./ReactPutListenerQueue"),l=e("./Transaction"),u=e("./mixInto"),c={initialize:s.getSelectionInformation,close:s.restoreSelection},d={initialize:function(){var e=r.isEnabled();return r.setEnabled(!1),e},close:function(e){r.setEnabled(e)}},p={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},f={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},m=[f,c,d,p],h={getTransactionWrappers:function(){return m},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){n.release(this.reactMountReady),this.reactMountReady=null,o.release(this.putListenerQueue),this.putListenerQueue=null}};u(i,l.Mixin),u(i,h),a.addPoolingTo(i),t.exports=i},{"./CallbackQueue":6,"./PooledClass":28,"./ReactBrowserEventEmitter":31,"./ReactInputSelection":61,"./ReactPutListenerQueue":74,"./Transaction":101,"./mixInto":144}],76:[function(e,t){"use strict";var i={injectCreateReactRootIndex:function(e){n.createReactRootIndex=e}},n={createReactRootIndex:null,injection:i};t.exports=n},{}],77:[function(e,t){"use strict";function i(e){u(a.isValidDescriptor(e)),u(!(2===arguments.length&&"function"==typeof arguments[1]));var t;try{var i=r.createReactRootID();return t=o.getPooled(!1),t.perform(function(){var n=l(e),a=n.mountComponent(i,t,0);return s.addChecksumToMarkup(a)},null)}finally{o.release(t)}}function n(e){u(a.isValidDescriptor(e));var t;try{var i=r.createReactRootID();return t=o.getPooled(!0),t.perform(function(){var n=l(e);return n.mountComponent(i,t,0)},null)}finally{o.release(t)}}var a=e("./ReactDescriptor"),r=e("./ReactInstanceHandles"),s=e("./ReactMarkupChecksum"),o=e("./ReactServerRenderingTransaction"),l=e("./instantiateReactComponent"),u=e("./invariant");t.exports={renderComponentToString:i,renderComponentToStaticMarkup:n}
},{"./ReactDescriptor":54,"./ReactInstanceHandles":62,"./ReactMarkupChecksum":64,"./ReactServerRenderingTransaction":78,"./instantiateReactComponent":130,"./invariant":131}],78:[function(e,t){"use strict";function i(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=a.getPooled(null),this.putListenerQueue=r.getPooled()}var n=e("./PooledClass"),a=e("./CallbackQueue"),r=e("./ReactPutListenerQueue"),s=e("./Transaction"),o=e("./emptyFunction"),l=e("./mixInto"),u={initialize:function(){this.reactMountReady.reset()},close:o},c={initialize:function(){this.putListenerQueue.reset()},close:o},d=[c,u],p={getTransactionWrappers:function(){return d},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){a.release(this.reactMountReady),this.reactMountReady=null,r.release(this.putListenerQueue),this.putListenerQueue=null}};l(i,s.Mixin),l(i,p),n.addPoolingTo(i),t.exports=i},{"./CallbackQueue":6,"./PooledClass":28,"./ReactPutListenerQueue":74,"./Transaction":101,"./emptyFunction":113,"./mixInto":144}],79:[function(e,t){"use strict";function i(e,t){var i={};return function(n){i[t]=n,e.setState(i)}}var n={createStateSetter:function(e,t){return function(i,n,a,r,s,o){var l=t.call(e,i,n,a,r,s,o);l&&e.setState(l)}},createStateKeySetter:function(e,t){var n=e.__keySetters||(e.__keySetters={});return n[t]||(n[t]=i(e,t))}};n.Mixin={createStateSetter:function(e){return n.createStateSetter(this,e)},createStateKeySetter:function(e){return n.createStateKeySetter(this,e)}},t.exports=n},{}],80:[function(e,t){"use strict";var i=e("./DOMPropertyOperations"),n=e("./ReactBrowserComponentMixin"),a=e("./ReactComponent"),r=e("./ReactDescriptor"),s=e("./escapeTextForBrowser"),o=e("./mixInto"),l=function(e){this.construct(e)};o(l,a.Mixin),o(l,n),o(l,{mountComponent:function(e,t,n){a.Mixin.mountComponent.call(this,e,t,n);var r=s(this.props);return t.renderToStaticMarkup?r:"<span "+i.createMarkupForID(e)+">"+r+"</span>"
},receiveComponent:function(e){var t=e.props;t!==this.props&&(this.props=t,a.BackendIDOperations.updateTextContentByID(this._rootNodeID,t))}}),t.exports=r.createFactory(l)},{"./DOMPropertyOperations":12,"./ReactBrowserComponentMixin":30,"./ReactComponent":35,"./ReactDescriptor":54,"./escapeTextForBrowser":115,"./mixInto":144}],81:[function(e,t){"use strict";var i=e("./ReactChildren"),n={getChildMapping:function(e){return i.map(e,function(e){return e})},mergeChildMappings:function(e,t){function i(i){return t.hasOwnProperty(i)?t[i]:e[i]}e=e||{},t=t||{};var n={},a=[];for(var r in e)t.hasOwnProperty(r)?a.length&&(n[r]=a,a=[]):a.push(r);var s,o={};for(var l in t){if(n.hasOwnProperty(l))for(s=0;s<n[l].length;s++){var u=n[l][s];o[n[l][s]]=i(u)}o[l]=i(l)}for(s=0;s<a.length;s++)o[a[s]]=i(a[s]);return o}};t.exports=n},{"./ReactChildren":34}],82:[function(e,t){"use strict";function i(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete s.animationend.animation,"TransitionEvent"in window||delete s.transitionend.transition;for(var i in s){var n=s[i];for(var a in n)if(a in t){o.push(n[a]);break}}}function n(e,t,i){e.addEventListener(t,i,!1)}function a(e,t,i){e.removeEventListener(t,i,!1)}var r=e("./ExecutionEnvironment"),s={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},o=[];r.canUseDOM&&i();var l={addEndEventListener:function(e,t){return 0===o.length?void window.setTimeout(t,0):void o.forEach(function(i){n(e,i,t)})},removeEndEventListener:function(e,t){0!==o.length&&o.forEach(function(i){a(e,i,t)})}};t.exports=l},{"./ExecutionEnvironment":22}],83:[function(e,t){"use strict";var i=e("./React"),n=e("./ReactTransitionChildMapping"),a=e("./cloneWithProps"),r=e("./emptyFunction"),s=e("./merge"),o=i.createClass({displayName:"ReactTransitionGroup",propTypes:{component:i.PropTypes.func,childFactory:i.PropTypes.func},getDefaultProps:function(){return{component:i.DOM.span,childFactory:r.thatReturnsArgument}
},getInitialState:function(){return{children:n.getChildMapping(this.props.children)}},componentWillReceiveProps:function(e){var t=n.getChildMapping(e.children),i=this.state.children;this.setState({children:n.mergeChildMappings(i,t)});var a;for(a in t){var r=i&&i.hasOwnProperty(a);!t[a]||r||this.currentlyTransitioningKeys[a]||this.keysToEnter.push(a)}for(a in i){var s=t&&t.hasOwnProperty(a);!i[a]||s||this.currentlyTransitioningKeys[a]||this.keysToLeave.push(a)}},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performEnter:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)},_handleDoneEntering:function(e){var t=this.refs[e];t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e];var i=n.getChildMapping(this.props.children);i&&i.hasOwnProperty(e)||this.performLeave(e)},performLeave:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)},_handleDoneLeaving:function(e){var t=this.refs[e];t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];var i=n.getChildMapping(this.props.children);if(i&&i.hasOwnProperty(e))this.performEnter(e);else{var a=s(this.state.children);delete a[e],this.setState({children:a})}},render:function(){var e={};for(var t in this.state.children){var i=this.state.children[t];i&&(e[t]=a(this.props.childFactory(i),{ref:t}))}return this.transferPropsTo(this.props.component(null,e))}});t.exports=o},{"./React":29,"./ReactTransitionChildMapping":81,"./cloneWithProps":105,"./emptyFunction":113,"./merge":141}],84:[function(e,t){"use strict";
function i(){p(x.ReactReconcileTransaction&&h)}function n(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=l.getPooled(null),this.reconcileTransaction=x.ReactReconcileTransaction.getPooled()}function a(e,t,n){i(),h.batchedUpdates(e,t,n)}function r(e,t){return e._mountDepth-t._mountDepth}function s(e){var t=e.dirtyComponentsLength;p(t===m.length),m.sort(r);for(var i=0;t>i;i++){var n=m[i];if(n.isMounted()){var a=n._pendingCallbacks;if(n._pendingCallbacks=null,n.performUpdateIfNecessary(e.reconcileTransaction),a)for(var s=0;s<a.length;s++)e.callbackQueue.enqueue(a[s],n)}}}function o(e,t){return p(!t||"function"==typeof t),i(),h.isBatchingUpdates?(m.push(e),void(t&&(e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t]))):void h.batchedUpdates(o,e,t)}var l=e("./CallbackQueue"),u=e("./PooledClass"),c=(e("./ReactCurrentOwner"),e("./ReactPerf")),d=e("./Transaction"),p=e("./invariant"),f=e("./mixInto"),m=(e("./warning"),[]),h=null,g={initialize:function(){this.dirtyComponentsLength=m.length},close:function(){this.dirtyComponentsLength!==m.length?(m.splice(0,this.dirtyComponentsLength),y()):m.length=0}},v={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},b=[g,v];f(n,d.Mixin),f(n,{getTransactionWrappers:function(){return b},destructor:function(){this.dirtyComponentsLength=null,l.release(this.callbackQueue),this.callbackQueue=null,x.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,i){return d.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,i)}}),u.addPoolingTo(n);var y=c.measure("ReactUpdates","flushBatchedUpdates",function(){for(;m.length;){var e=n.getPooled();e.perform(s,null,e),n.release(e)}}),_={injectReconcileTransaction:function(e){p(e),x.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){p(e),p("function"==typeof e.batchedUpdates),p("boolean"==typeof e.isBatchingUpdates),h=e
}},x={ReactReconcileTransaction:null,batchedUpdates:a,enqueueUpdate:o,flushBatchedUpdates:y,injection:_};t.exports=x},{"./CallbackQueue":6,"./PooledClass":28,"./ReactCurrentOwner":40,"./ReactPerf":69,"./Transaction":101,"./invariant":131,"./mixInto":144,"./warning":153}],85:[function(e,t){"use strict";var i=e("./LinkedStateMixin"),n=e("./React"),a=e("./ReactComponentWithPureRenderMixin"),r=e("./ReactCSSTransitionGroup"),s=e("./ReactTransitionGroup"),o=e("./cx"),l=e("./cloneWithProps"),u=e("./update");n.addons={CSSTransitionGroup:r,LinkedStateMixin:i,PureRenderMixin:a,TransitionGroup:s,classSet:o,cloneWithProps:l,update:u},t.exports=n},{"./LinkedStateMixin":24,"./React":29,"./ReactCSSTransitionGroup":32,"./ReactComponentWithPureRenderMixin":37,"./ReactTransitionGroup":83,"./cloneWithProps":105,"./cx":111,"./update":152}],86:[function(e,t){"use strict";var i=e("./DOMProperty"),n=i.injection.MUST_USE_ATTRIBUTE,a={Properties:{cx:n,cy:n,d:n,dx:n,dy:n,fill:n,fillOpacity:n,fontFamily:n,fontSize:n,fx:n,fy:n,gradientTransform:n,gradientUnits:n,markerEnd:n,markerMid:n,markerStart:n,offset:n,opacity:n,patternContentUnits:n,patternUnits:n,points:n,preserveAspectRatio:n,r:n,rx:n,ry:n,spreadMethod:n,stopColor:n,stopOpacity:n,stroke:n,strokeDasharray:n,strokeLinecap:n,strokeOpacity:n,strokeWidth:n,textAnchor:n,transform:n,version:n,viewBox:n,x1:n,x2:n,x:n,y1:n,y2:n,y:n},DOMAttributeNames:{fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"}};t.exports=a},{"./DOMProperty":11}],87:[function(e,t){"use strict";
function i(e){if("selectionStart"in e&&s.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(document.selection){var t=document.selection.createRange();return{parentElement:t.parentElement(),text:t.text,top:t.boundingTop,left:t.boundingLeft}}var i=window.getSelection();return{anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}}function n(e){if(!v&&null!=m&&m==l()){var t=i(m);if(!g||!d(g,t)){g=t;var n=o.getPooled(f.select,h,e);return n.type="select",n.target=m,r.accumulateTwoPhaseDispatches(n),n}}}var a=e("./EventConstants"),r=e("./EventPropagators"),s=e("./ReactInputSelection"),o=e("./SyntheticEvent"),l=e("./getActiveElement"),u=e("./isTextInputElement"),c=e("./keyOf"),d=e("./shallowEqual"),p=a.topLevelTypes,f={select:{phasedRegistrationNames:{bubbled:c({onSelect:null}),captured:c({onSelectCapture:null})},dependencies:[p.topBlur,p.topContextMenu,p.topFocus,p.topKeyDown,p.topMouseDown,p.topMouseUp,p.topSelectionChange]}},m=null,h=null,g=null,v=!1,b={eventTypes:f,extractEvents:function(e,t,i,a){switch(e){case p.topFocus:(u(t)||"true"===t.contentEditable)&&(m=t,h=i,g=null);break;case p.topBlur:m=null,h=null,g=null;break;case p.topMouseDown:v=!0;break;case p.topContextMenu:case p.topMouseUp:return v=!1,n(a);case p.topSelectionChange:case p.topKeyDown:case p.topKeyUp:return n(a)}}};t.exports=b},{"./EventConstants":16,"./EventPropagators":21,"./ReactInputSelection":61,"./SyntheticEvent":93,"./getActiveElement":119,"./isTextInputElement":134,"./keyOf":138,"./shallowEqual":148}],88:[function(e,t){"use strict";var i=Math.pow(2,53),n={createReactRootIndex:function(){return Math.ceil(Math.random()*i)}};t.exports=n},{}],89:[function(e,t){"use strict";var i=e("./EventConstants"),n=e("./EventPluginUtils"),a=e("./EventPropagators"),r=e("./SyntheticClipboardEvent"),s=e("./SyntheticEvent"),o=e("./SyntheticFocusEvent"),l=e("./SyntheticKeyboardEvent"),u=e("./SyntheticMouseEvent"),c=e("./SyntheticDragEvent"),d=e("./SyntheticTouchEvent"),p=e("./SyntheticUIEvent"),f=e("./SyntheticWheelEvent"),m=e("./invariant"),h=e("./keyOf"),g=i.topLevelTypes,v={blur:{phasedRegistrationNames:{bubbled:h({onBlur:!0}),captured:h({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:h({onClick:!0}),captured:h({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:h({onContextMenu:!0}),captured:h({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:h({onCopy:!0}),captured:h({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:h({onCut:!0}),captured:h({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:h({onDoubleClick:!0}),captured:h({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:h({onDrag:!0}),captured:h({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:h({onDragEnd:!0}),captured:h({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:h({onDragEnter:!0}),captured:h({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:h({onDragExit:!0}),captured:h({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:h({onDragLeave:!0}),captured:h({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:h({onDragOver:!0}),captured:h({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:h({onDragStart:!0}),captured:h({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:h({onDrop:!0}),captured:h({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:h({onFocus:!0}),captured:h({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:h({onInput:!0}),captured:h({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:h({onKeyDown:!0}),captured:h({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:h({onKeyPress:!0}),captured:h({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:h({onKeyUp:!0}),captured:h({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:h({onLoad:!0}),captured:h({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:h({onError:!0}),captured:h({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:h({onMouseDown:!0}),captured:h({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:h({onMouseMove:!0}),captured:h({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:h({onMouseOut:!0}),captured:h({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:h({onMouseOver:!0}),captured:h({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:h({onMouseUp:!0}),captured:h({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:h({onPaste:!0}),captured:h({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:h({onReset:!0}),captured:h({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:h({onScroll:!0}),captured:h({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:h({onSubmit:!0}),captured:h({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:h({onTouchCancel:!0}),captured:h({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:h({onTouchEnd:!0}),captured:h({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:h({onTouchMove:!0}),captured:h({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:h({onTouchStart:!0}),captured:h({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:h({onWheel:!0}),captured:h({onWheelCapture:!0})}}},b={topBlur:v.blur,topClick:v.click,topContextMenu:v.contextMenu,topCopy:v.copy,topCut:v.cut,topDoubleClick:v.doubleClick,topDrag:v.drag,topDragEnd:v.dragEnd,topDragEnter:v.dragEnter,topDragExit:v.dragExit,topDragLeave:v.dragLeave,topDragOver:v.dragOver,topDragStart:v.dragStart,topDrop:v.drop,topError:v.error,topFocus:v.focus,topInput:v.input,topKeyDown:v.keyDown,topKeyPress:v.keyPress,topKeyUp:v.keyUp,topLoad:v.load,topMouseDown:v.mouseDown,topMouseMove:v.mouseMove,topMouseOut:v.mouseOut,topMouseOver:v.mouseOver,topMouseUp:v.mouseUp,topPaste:v.paste,topReset:v.reset,topScroll:v.scroll,topSubmit:v.submit,topTouchCancel:v.touchCancel,topTouchEnd:v.touchEnd,topTouchMove:v.touchMove,topTouchStart:v.touchStart,topWheel:v.wheel};
for(var y in b)b[y].dependencies=[y];var _={eventTypes:v,executeDispatch:function(e,t,i){var a=n.executeDispatch(e,t,i);a===!1&&(e.stopPropagation(),e.preventDefault())},extractEvents:function(e,t,i,n){var h=b[e];if(!h)return null;var v;switch(e){case g.topInput:case g.topLoad:case g.topError:case g.topReset:case g.topSubmit:v=s;break;case g.topKeyPress:if(0===n.charCode)return null;case g.topKeyDown:case g.topKeyUp:v=l;break;case g.topBlur:case g.topFocus:v=o;break;case g.topClick:if(2===n.button)return null;case g.topContextMenu:case g.topDoubleClick:case g.topMouseDown:case g.topMouseMove:case g.topMouseOut:case g.topMouseOver:case g.topMouseUp:v=u;break;case g.topDrag:case g.topDragEnd:case g.topDragEnter:case g.topDragExit:case g.topDragLeave:case g.topDragOver:case g.topDragStart:case g.topDrop:v=c;break;case g.topTouchCancel:case g.topTouchEnd:case g.topTouchMove:case g.topTouchStart:v=d;break;case g.topScroll:v=p;break;case g.topWheel:v=f;break;case g.topCopy:case g.topCut:case g.topPaste:v=r}m(v);var y=v.getPooled(h,i,n);return a.accumulateTwoPhaseDispatches(y),y}};t.exports=_},{"./EventConstants":16,"./EventPluginUtils":20,"./EventPropagators":21,"./SyntheticClipboardEvent":90,"./SyntheticDragEvent":92,"./SyntheticEvent":93,"./SyntheticFocusEvent":94,"./SyntheticKeyboardEvent":96,"./SyntheticMouseEvent":97,"./SyntheticTouchEvent":98,"./SyntheticUIEvent":99,"./SyntheticWheelEvent":100,"./invariant":131,"./keyOf":138}],90:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticEvent"),a={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};n.augmentClass(i,a),t.exports=i},{"./SyntheticEvent":93}],91:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticEvent"),a={data:null};n.augmentClass(i,a),t.exports=i},{"./SyntheticEvent":93}],92:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticMouseEvent"),a={dataTransfer:null};n.augmentClass(i,a),t.exports=i
},{"./SyntheticMouseEvent":97}],93:[function(e,t){"use strict";function i(e,t,i){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=i;var n=this.constructor.Interface;for(var r in n)if(n.hasOwnProperty(r)){var s=n[r];this[r]=s?s(i):i[r]}var o=null!=i.defaultPrevented?i.defaultPrevented:i.returnValue===!1;this.isDefaultPrevented=o?a.thatReturnsTrue:a.thatReturnsFalse,this.isPropagationStopped=a.thatReturnsFalse}var n=e("./PooledClass"),a=e("./emptyFunction"),r=e("./getEventTarget"),s=e("./merge"),o=e("./mergeInto"),l={type:null,target:r,currentTarget:a.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};o(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=a.thatReturnsTrue},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=a.thatReturnsTrue},persist:function(){this.isPersistent=a.thatReturnsTrue},isPersistent:a.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),i.Interface=l,i.augmentClass=function(e,t){var i=this,a=Object.create(i.prototype);o(a,e.prototype),e.prototype=a,e.prototype.constructor=e,e.Interface=s(i.Interface,t),e.augmentClass=i.augmentClass,n.addPoolingTo(e,n.threeArgumentPooler)},n.addPoolingTo(i,n.threeArgumentPooler),t.exports=i},{"./PooledClass":28,"./emptyFunction":113,"./getEventTarget":122,"./merge":141,"./mergeInto":143}],94:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticUIEvent"),a={relatedTarget:null};n.augmentClass(i,a),t.exports=i},{"./SyntheticUIEvent":99}],95:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticEvent"),a={data:null};n.augmentClass(i,a),t.exports=i
},{"./SyntheticEvent":93}],96:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticUIEvent"),a=e("./getEventKey"),r=e("./getEventModifierState"),s={key:a,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:r,charCode:function(e){return"keypress"===e.type?"charCode"in e?e.charCode:e.keyCode:0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return e.keyCode||e.charCode}};n.augmentClass(i,s),t.exports=i},{"./SyntheticUIEvent":99,"./getEventKey":120,"./getEventModifierState":121}],97:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticUIEvent"),a=e("./ViewportMetrics"),r=e("./getEventModifierState"),s={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getEventModifierState:r,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+a.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+a.currentScrollTop}};n.augmentClass(i,s),t.exports=i},{"./SyntheticUIEvent":99,"./ViewportMetrics":102,"./getEventModifierState":121}],98:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticUIEvent"),a=e("./getEventModifierState"),r={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:a};n.augmentClass(i,r),t.exports=i},{"./SyntheticUIEvent":99,"./getEventModifierState":121}],99:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticEvent"),a=e("./getEventTarget"),r={view:function(e){if(e.view)return e.view;var t=a(e);if(null!=t&&t.window===t)return t;var i=t.ownerDocument;return i?i.defaultView||i.parentWindow:window},detail:function(e){return e.detail||0
}};n.augmentClass(i,r),t.exports=i},{"./SyntheticEvent":93,"./getEventTarget":122}],100:[function(e,t){"use strict";function i(e,t,i){n.call(this,e,t,i)}var n=e("./SyntheticMouseEvent"),a={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};n.augmentClass(i,a),t.exports=i},{"./SyntheticMouseEvent":97}],101:[function(e,t){"use strict";var i=e("./invariant"),n={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,n,a,r,s,o,l){i(!this.isInTransaction());var u,c;try{this._isInTransaction=!0,u=!0,this.initializeAll(0),c=e.call(t,n,a,r,s,o,l),u=!1}finally{try{if(u)try{this.closeAll(0)}catch(d){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return c},initializeAll:function(e){for(var t=this.transactionWrappers,i=e;i<t.length;i++){var n=t[i];try{this.wrapperInitData[i]=a.OBSERVED_ERROR,this.wrapperInitData[i]=n.initialize?n.initialize.call(this):null}finally{if(this.wrapperInitData[i]===a.OBSERVED_ERROR)try{this.initializeAll(i+1)}catch(r){}}}},closeAll:function(e){i(this.isInTransaction());for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r,s=t[n],o=this.wrapperInitData[n];try{r=!0,o!==a.OBSERVED_ERROR&&s.close&&s.close.call(this,o),r=!1}finally{if(r)try{this.closeAll(n+1)}catch(l){}}}this.wrapperInitData.length=0}},a={Mixin:n,OBSERVED_ERROR:{}};t.exports=a},{"./invariant":131}],102:[function(e,t){"use strict";var i=e("./getUnboundedScrollPosition"),n={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var e=i(window);n.currentScrollLeft=e.x,n.currentScrollTop=e.y}};t.exports=n},{"./getUnboundedScrollPosition":127}],103:[function(e,t){"use strict";
function i(e,t){if(n(null!=t),null==e)return t;var i=Array.isArray(e),a=Array.isArray(t);return i?e.concat(t):a?[e].concat(t):[e,t]}var n=e("./invariant");t.exports=i},{"./invariant":131}],104:[function(e,t){"use strict";function i(e){for(var t=1,i=0,a=0;a<e.length;a++)t=(t+e.charCodeAt(a))%n,i=(i+t)%n;return t|i<<16}var n=65521;t.exports=i},{}],105:[function(e,t){"use strict";function i(e,t){var i=n.mergeProps(t,e.props);return!i.hasOwnProperty(r)&&e.props.hasOwnProperty(r)&&(i.children=e.props.children),e.constructor(i)}var n=e("./ReactPropTransferer"),a=e("./keyOf"),r=(e("./warning"),a({children:null}));t.exports=i},{"./ReactPropTransferer":70,"./keyOf":138,"./warning":153}],106:[function(e,t){function i(e,t){return e&&t?e===t?!0:n(e)?!1:n(t)?i(e,t.parentNode):e.contains?e.contains(t):e.compareDocumentPosition?!!(16&e.compareDocumentPosition(t)):!1:!1}var n=e("./isTextNode");t.exports=i},{"./isTextNode":135}],107:[function(e,t){function i(e,t,i,n,a,r){e=e||{};for(var s,o=[t,i,n,a,r],l=0;o[l];){s=o[l++];for(var u in s)e[u]=s[u];s.hasOwnProperty&&s.hasOwnProperty("toString")&&"undefined"!=typeof s.toString&&e.toString!==s.toString&&(e.toString=s.toString)}return e}t.exports=i},{}],108:[function(e,t){function i(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function n(e){return i(e)?Array.isArray(e)?e.slice():a(e):[e]}var a=e("./toArray");t.exports=n},{"./toArray":150}],109:[function(e,t){"use strict";function i(e){var t=n.createClass({displayName:"ReactFullPageComponent"+(e.type.displayName||""),componentWillUnmount:function(){a(!1)},render:function(){return this.transferPropsTo(e(null,this.props.children))}});return t}var n=e("./ReactCompositeComponent"),a=e("./invariant");t.exports=i},{"./ReactCompositeComponent":38,"./invariant":131}],110:[function(e,t){function i(e){var t=e.match(u);return t&&t[1].toLowerCase()}function n(e,t){var n=l;o(!!l);var a=i(e),u=a&&s(a);
if(u){n.innerHTML=u[1]+e+u[2];for(var c=u[0];c--;)n=n.lastChild}else n.innerHTML=e;var d=n.getElementsByTagName("script");d.length&&(o(t),r(d).forEach(t));for(var p=r(n.childNodes);n.lastChild;)n.removeChild(n.lastChild);return p}var a=e("./ExecutionEnvironment"),r=e("./createArrayFrom"),s=e("./getMarkupWrap"),o=e("./invariant"),l=a.canUseDOM?document.createElement("div"):null,u=/^\s*<(\w+)/;t.exports=n},{"./ExecutionEnvironment":22,"./createArrayFrom":108,"./getMarkupWrap":123,"./invariant":131}],111:[function(e,t){function i(e){return"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}).join(" "):Array.prototype.join.call(arguments," ")}t.exports=i},{}],112:[function(e,t){"use strict";function i(e,t){var i=null==t||"boolean"==typeof t||""===t;if(i)return"";var n=isNaN(t);return n||0===t||a.hasOwnProperty(e)&&a[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}var n=e("./CSSProperty"),a=n.isUnitlessNumber;t.exports=i},{"./CSSProperty":4}],113:[function(e,t){function i(e){return function(){return e}}function n(){}var a=e("./copyProperties");a(n,{thatReturns:i,thatReturnsFalse:i(!1),thatReturnsTrue:i(!0),thatReturnsNull:i(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(e){return e}}),t.exports=n},{"./copyProperties":107}],114:[function(e,t){"use strict";var i={};t.exports=i},{}],115:[function(e,t){"use strict";function i(e){return a[e]}function n(e){return(""+e).replace(r,i)}var a={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},r=/[&><"']/g;t.exports=n},{}],116:[function(e,t){"use strict";function i(e,t,i){var n=e,a=!n.hasOwnProperty(i);a&&null!=t&&(n[i]=t)}function n(e){if(null==e)return e;var t={};return a(e,i,t),t}var a=e("./traverseAllChildren");e("./warning"),t.exports=n},{"./traverseAllChildren":151,"./warning":153}],117:[function(e,t){"use strict";function i(e){e.disabled||e.focus()}t.exports=i},{}],118:[function(e,t){"use strict";var i=function(e,t,i){Array.isArray(e)?e.forEach(t,i):e&&t.call(i,e)};t.exports=i
},{}],119:[function(e,t){function i(){try{return document.activeElement||document.body}catch(e){return document.body}}t.exports=i},{}],120:[function(e,t){"use strict";function i(e){if(e.key){var t=a[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var i="charCode"in e?e.charCode:e.keyCode;return 13===i?"Enter":String.fromCharCode(i)}return"keydown"===e.type||"keyup"===e.type?r[e.keyCode]||"Unidentified":void n(!1)}var n=e("./invariant"),a={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=i},{"./invariant":131}],121:[function(e,t){"use strict";function i(e){var t=this,i=t.nativeEvent;if(i.getModifierState)return i.getModifierState(e);var n=a[e.toLowerCase()];return n&&i[n]}function n(){return i}var a={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"};t.exports=n},{}],122:[function(e,t){"use strict";function i(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}t.exports=i},{}],123:[function(e,t){function i(e){return a(!!r),d.hasOwnProperty(e)||(e="*"),s.hasOwnProperty(e)||(r.innerHTML="*"===e?"<link />":"<"+e+"></"+e+">",s[e]=!r.firstChild),s[e]?d[e]:null}var n=e("./ExecutionEnvironment"),a=e("./invariant"),r=n.canUseDOM?document.createElement("div"):null,s={circle:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},o=[1,'<select multiple="true">',"</select>"],l=[1,"<table>","</table>"],u=[3,"<table><tbody><tr>","</tr></tbody></table>"],c=[1,"<svg>","</svg>"],d={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:o,option:o,caption:l,colgroup:l,tbody:l,tfoot:l,thead:l,td:u,th:u,circle:c,defs:c,ellipse:c,g:c,line:c,linearGradient:c,path:c,polygon:c,polyline:c,radialGradient:c,rect:c,stop:c,text:c};
t.exports=i},{"./ExecutionEnvironment":22,"./invariant":131}],124:[function(e,t){"use strict";function i(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function n(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function a(e,t){for(var a=i(e),r=0,s=0;a;){if(3==a.nodeType){if(s=r+a.textContent.length,t>=r&&s>=t)return{node:a,offset:t-r};r=s}a=i(n(a))}}t.exports=a},{}],125:[function(e,t){"use strict";function i(e){return e?e.nodeType===n?e.documentElement:e.firstChild:null}var n=9;t.exports=i},{}],126:[function(e,t){"use strict";function i(){return!a&&n.canUseDOM&&(a="textContent"in document.documentElement?"textContent":"innerText"),a}var n=e("./ExecutionEnvironment"),a=null;t.exports=i},{"./ExecutionEnvironment":22}],127:[function(e,t){"use strict";function i(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}t.exports=i},{}],128:[function(e,t){function i(e){return e.replace(n,"-$1").toLowerCase()}var n=/([A-Z])/g;t.exports=i},{}],129:[function(e,t){"use strict";function i(e){return n(e).replace(a,"-ms-")}var n=e("./hyphenate"),a=/^ms-/;t.exports=i},{"./hyphenate":128}],130:[function(e,t){"use strict";function i(e){return e&&"function"==typeof e.type&&"function"==typeof e.type.prototype.mountComponent&&"function"==typeof e.type.prototype.receiveComponent}function n(e){return a(i(e)),new e.type(e)}var a=e("./invariant");t.exports=n},{"./invariant":131}],131:[function(e,t){"use strict";var i=function(e,t,i,n,a,r,s,o){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[i,n,a,r,s,o],c=0;l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return u[c++]}))}throw l.framesToPop=1,l}};t.exports=i},{}],132:[function(e,t){"use strict";function i(e,t){if(!a.canUseDOM||t&&!("addEventListener"in document))return!1;
var i="on"+e,r=i in document;if(!r){var s=document.createElement("div");s.setAttribute(i,"return;"),r="function"==typeof s[i]}return!r&&n&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r}var n,a=e("./ExecutionEnvironment");a.canUseDOM&&(n=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=i},{"./ExecutionEnvironment":22}],133:[function(e,t){function i(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}t.exports=i},{}],134:[function(e,t){"use strict";function i(e){return e&&("INPUT"===e.nodeName&&n[e.type]||"TEXTAREA"===e.nodeName)}var n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=i},{}],135:[function(e,t){function i(e){return n(e)&&3==e.nodeType}var n=e("./isNode");t.exports=i},{"./isNode":133}],136:[function(e,t){"use strict";function i(e){e||(e="");var t,i=arguments.length;if(i>1)for(var n=1;i>n;n++)t=arguments[n],t&&(e+=" "+t);return e}t.exports=i},{}],137:[function(e,t){"use strict";var i=e("./invariant"),n=function(e){var t,n={};i(e instanceof Object&&!Array.isArray(e));for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n};t.exports=n},{"./invariant":131}],138:[function(e,t){var i=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};t.exports=i},{}],139:[function(e,t){"use strict";function i(e,t,i){if(!e)return null;var n=0,a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=t.call(i,e[r],r,n++));return a}t.exports=i},{}],140:[function(e,t){"use strict";function i(e){var t={};return function(i){return t.hasOwnProperty(i)?t[i]:t[i]=e.call(this,i)}}t.exports=i},{}],141:[function(e,t){"use strict";var i=e("./mergeInto"),n=function(e,t){var n={};return i(n,e),i(n,t),n};t.exports=n},{"./mergeInto":143}],142:[function(e,t){"use strict";var i=e("./invariant"),n=e("./keyMirror"),a=36,r=function(e){return"object"!=typeof e||null===e
},s={MAX_MERGE_DEPTH:a,isTerminal:r,normalizeMergeArg:function(e){return void 0===e||null===e?{}:e},checkMergeArrayArgs:function(e,t){i(Array.isArray(e)&&Array.isArray(t))},checkMergeObjectArgs:function(e,t){s.checkMergeObjectArg(e),s.checkMergeObjectArg(t)},checkMergeObjectArg:function(e){i(!r(e)&&!Array.isArray(e))},checkMergeIntoObjectArg:function(e){i(!(r(e)&&"function"!=typeof e||Array.isArray(e)))},checkMergeLevel:function(e){i(a>e)},checkArrayStrategy:function(e){i(void 0===e||e in s.ArrayStrategies)},ArrayStrategies:n({Clobber:!0,IndexByIndex:!0})};t.exports=s},{"./invariant":131,"./keyMirror":137}],143:[function(e,t){"use strict";function i(e,t){if(r(e),null!=t){a(t);for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}}var n=e("./mergeHelpers"),a=n.checkMergeObjectArg,r=n.checkMergeIntoObjectArg;t.exports=i},{"./mergeHelpers":142}],144:[function(e,t){"use strict";var i=function(e,t){var i;for(i in t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i])};t.exports=i},{}],145:[function(e,t){"use strict";function i(e){n(e&&!/[^a-z0-9_]/.test(e))}var n=e("./invariant");t.exports=i},{"./invariant":131}],146:[function(e,t){"use strict";function i(e){return a(n.isValidDescriptor(e)),e}var n=e("./ReactDescriptor"),a=e("./invariant");t.exports=i},{"./ReactDescriptor":54,"./invariant":131}],147:[function(e,t){"use strict";var i=e("./ExecutionEnvironment"),n=function(e,t){e.innerHTML=t};if(i.canUseDOM){var a=document.createElement("div");a.innerHTML=" ",""===a.innerHTML&&(n=function(e,t){e.parentNode&&e.parentNode.replaceChild(e,e),t.match(/^[ \r\n\t\f]/)||"<"===t[0]&&(-1!==t.indexOf("<noscript")||-1!==t.indexOf("<script")||-1!==t.indexOf("<style")||-1!==t.indexOf("<meta")||-1!==t.indexOf("<link"))?(e.innerHTML=""+t,e.firstChild.deleteData(0,1)):e.innerHTML=t})}t.exports=n},{"./ExecutionEnvironment":22}],148:[function(e,t){"use strict";function i(e,t){if(e===t)return!0;var i;for(i in e)if(e.hasOwnProperty(i)&&(!t.hasOwnProperty(i)||e[i]!==t[i]))return!1;for(i in t)if(t.hasOwnProperty(i)&&!e.hasOwnProperty(i))return!1;
return!0}t.exports=i},{}],149:[function(e,t){"use strict";function i(e,t){return e&&t&&e.type===t.type&&(e.props&&e.props.key)===(t.props&&t.props.key)&&e._owner===t._owner?!0:!1}t.exports=i},{}],150:[function(e,t){function i(e){var t=e.length;if(n(!Array.isArray(e)&&("object"==typeof e||"function"==typeof e)),n("number"==typeof t),n(0===t||t-1 in e),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(i){}for(var a=Array(t),r=0;t>r;r++)a[r]=e[r];return a}var n=e("./invariant");t.exports=i},{"./invariant":131}],151:[function(e,t){"use strict";function i(e){return p[e]}function n(e,t){return e&&e.props&&null!=e.props.key?r(e.props.key):t.toString(36)}function a(e){return(""+e).replace(f,i)}function r(e){return"$"+a(e)}function s(e,t,i){return null==e?0:m(e,"",0,t,i)}var o=e("./ReactInstanceHandles"),l=e("./ReactTextComponent"),u=e("./invariant"),c=o.SEPARATOR,d=":",p={"=":"=0",".":"=1",":":"=2"},f=/[=.:]/g,m=function(e,t,i,a,s){var o=0;if(Array.isArray(e))for(var p=0;p<e.length;p++){var f=e[p],h=t+(t?d:c)+n(f,p),g=i+o;o+=m(f,h,g,a,s)}else{var v=typeof e,b=""===t,y=b?c+n(e,0):t;if(null==e||"boolean"===v)a(s,null,y,i),o=1;else if(e.type&&e.type.prototype&&e.type.prototype.mountComponentIntoNode)a(s,e,y,i),o=1;else if("object"===v){u(!e||1!==e.nodeType);for(var _ in e)e.hasOwnProperty(_)&&(o+=m(e[_],t+(t?d:c)+r(_)+d+n(e[_],0),i+o,a,s))}else if("string"===v){var x=l(e);a(s,x,y,i),o+=1}else if("number"===v){var w=l(""+e);a(s,w,y,i),o+=1}}return o};t.exports=s},{"./ReactInstanceHandles":62,"./ReactTextComponent":80,"./invariant":131}],152:[function(e,t){"use strict";function i(e){return Array.isArray(e)?e.concat():e&&"object"==typeof e?r(new e.constructor,e):e}function n(e,t,i){o(Array.isArray(e));var n=t[i];o(Array.isArray(n))}function a(e,t){if(o("object"==typeof t),t.hasOwnProperty(d))return o(1===Object.keys(t).length),t[d];var s=i(e);if(t.hasOwnProperty(p)){var m=t[p];o(m&&"object"==typeof m),o(s&&"object"==typeof s),r(s,t[p])}t.hasOwnProperty(l)&&(n(e,t,l),t[l].forEach(function(e){s.push(e)
})),t.hasOwnProperty(u)&&(n(e,t,u),t[u].forEach(function(e){s.unshift(e)})),t.hasOwnProperty(c)&&(o(Array.isArray(e)),o(Array.isArray(t[c])),t[c].forEach(function(e){o(Array.isArray(e)),s.splice.apply(s,e)})),t.hasOwnProperty(f)&&(o("function"==typeof t[f]),s=t[f](s));for(var g in t)h.hasOwnProperty(g)&&h[g]||(s[g]=a(e[g],t[g]));return s}var r=e("./copyProperties"),s=e("./keyOf"),o=e("./invariant"),l=s({$push:null}),u=s({$unshift:null}),c=s({$splice:null}),d=s({$set:null}),p=s({$merge:null}),f=s({$apply:null}),m=[l,u,c,d,p,f],h={};m.forEach(function(e){h[e]=!0}),t.exports=a},{"./copyProperties":107,"./invariant":131,"./keyOf":138}],153:[function(e,t){"use strict";var i=e("./emptyFunction"),n=i;t.exports=n},{"./emptyFunction":113}]},{},[85])(85)}),define("tau/core/injector",["require","Underscore","tau/core/class","tau/utils/utils.debug"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=e("tau/utils/utils.debug"),a=i.extend({init:function(){this._services={}},register:function(e,i){n.assertError(t.isString(e),"Service name should be a string"),n.assertError(""!==e,"Service error should not be empty"),n.assertWarn(function(){return!t.has(this._services,e)}.bind(this),'Re-assigning the service value for "'+e+'" service name could be an error'),n.assertError(null!==i&&void 0!==i,"Service should not be null or undefined"),this._services[e]=i},registerModule:function(e,t){this.register(e,this.createModule(t))},resolve:function(e){var t=this._services[e];if(!t)throw new Error('Service "'+e+'" is not registered');return t},release:function(e){n.assertWarn(function(){return t.has(this._services,e)}.bind(this),'Attempting to release an unregistered service by name "'+e+'".'),delete this._services[e]},releaseAll:function(){this._services={}},createModule:function(e){var i=e.__injectorDependencies;if(!i)return new e;var n=t.map(i,this.resolve,this);return e.apply({},n)}});return a.defineModule=function(e,i){var n=function(){return i.apply(this,arguments)};return n.__injectorDependencies=t.toArray(e),n
},a}),define("libs/react/react-ex",["require","react","tau/core/injector"],function(e){var t=e("react"),i=e("tau/core/injector");return Object.create(t,{defineClass:{value:function(e,n){return i.defineModule(e,function(){var e=n.apply(null,arguments);return t.createClass(e)})},writable:!1},resolveClass:{value:function(e,t,i){return e.createModule(t)(i)},writable:!1}})}),define("jsx!tau/components/board.menu/views/board.menu.view",["require","Underscore","jQuery","libs/react/react-ex","./../services/board.menu.transformations.service"],function(e){var t=e("Underscore"),i=(e("jQuery"),e("libs/react/react-ex")),n=e("./../services/board.menu.transformations.service"),a=["boardMenuListView","boardMenuActionsView","boardMenuSearchView","boardSettingsService"];return i.defineClass(a,function(e,a,r,s){return{getDefaultProps:function(){return{filterText:"",viewMenuSections:null}},getInitialState:function(){return{currentBoardId:"",showHidden:!1,focusedBoardId:"",isLoading:!0}},componentWillMount:function(){this.setState({currentBoardId:s.getCurrentSettings().id})},componentDidMount:function(){this.setState({isLoading:!0}),this.props.model.loadBoards().always(function(){this.setState({isLoading:!1})}.bind(this))},componentWillReceiveProps:function(e){if(e.filterText!==this.props.filterText){var t=this._createBoardQuerySpec();t.filterText=e.filterText;var i=n.getDefaultFocusedBoardId(e.viewMenuSections.getAllViewGroups(),t);this.setState({focusedBoardId:i})}},_getVisibleBoards:function(){var e=t.flatMap(this.props.viewMenuSections.getAllViewGroups(),t.property("boards"));return n.getVisibleBoards(e,this._createBoardQuerySpec())},_createBoardQuerySpec:function(){return{filterText:this.props.filterText,showHidden:this.state.showHidden,currentBoardId:this.state.currentBoardId}},render:function(){if(this.state.isLoading)return i.DOM.div({className:"t3-views-navigator i-role-board-menu"});var t=this._createBoardQuerySpec();return i.DOM.div({className:"t3-views-navigator i-role-board-menu"},r({viewMenuSections:this.props.viewMenuSections,querySpec:t,focusedBoardId:this.state.focusedBoardId}),e({ref:"listView",viewMenuSections:this.props.viewMenuSections,currentBoardId:this.state.currentBoardId,focusedBoardId:this.state.focusedBoardId,model:this.props.model,querySpec:t}),a({hasHiddenBoards:this.props.viewMenuSections.hasHiddenItems(),showHidden:this.state.showHidden}))
}}})}),define("tau/components/board.menu/extensions/board.menu.extension",["require","tau/core/extension.base","libs/react/react-ex","jsx!./../views/board.menu.view"],function(e){var t=e("tau/core/extension.base"),i=e("libs/react/react-ex"),n=e("jsx!./../views/board.menu.view");return t.extend({"bus afterInit":function(){this.fire("dataBind")},"bus board.menu.config.ready":function(e,t){var a=i.resolveClass(t.serviceScope,n,{model:t.model,viewMenuSections:t.model.viewMenuSections}),r=i.renderComponent(a,t.element);this.fire("_board.menu.main.view",r)}})}),define("tau/services/context.menu/context.menu.items/separator",["require","Underscore","tau/core/class"],function(e){var t=e("Underscore"),i=e("tau/core/class");return i.extend({getMenuItemClassName:t.constant("drop-down-separator"),getContent:t.constant("")})}),define("template!tau/services/context.menu/templates/context.menu.item.template",["tau/core/templates-factory"],function(e){var t={name:"context.menu.item",engine:"jqote2",customFunctions:null,markup:'<div role="option" class="<%= this.menuItem.getMenuItemClassName(this.menuConfig) %> drop-down-option" title="<%= this.menuItem.getTooltipText ? this.menuItem.getTooltipText(this.menuConfig) : \'\' %>"> <%= this.menuItem.getContent(this.menuConfig) %> </div>'};return e.register(t)}),define("template!tau/services/context.menu/templates/context.menu.template",["tau/core/templates-factory","template!tau/services/context.menu/templates/context.menu.item.template"],function(e){var t={name:"context.menu",engine:"jqote2",customFunctions:null,markup:'<div class="ui-drop-down t3-views-navigator-context-menu"> <div role="list" class="drop-down-list"> <div class="drop-down-list__inner i-inner"> <%= fn.sub(\'context.menu.item\', this.menuItems) %> </div> </div> </div>'};return e.register(t)}),define("tau/services/context.menu/context.menu.service",["require","tau/core/class","Underscore","./context.menu.items/separator","template!./templates/context.menu.template"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n=e("./context.menu.items/separator"),a=e("template!./templates/context.menu.template");
return t.extend({_isElementVisible:i.abstractMethod,_getContainerSelector:i.abstractMethod,_getScrollContainerSelector:i.abstractMethod,_createSeparator:function(){return new n},_showMenu:function(e,t){var n=i.filter(e,function(e){return!e.shouldRender||e.shouldRender(t)});n=this._normalizeSeparators(n);var a=t.$target;t.destroyBubble=function(){a.removeClass("t3-opened"),a.data("ui-tauBubble")&&a.tauBubble("destroy")},t.hideBubble=function(){a.data("ui-tauBubble")&&a.tauBubble("hide")};var r=this._initBubble(t,n,a.closest(this._getContainerSelector()));i.each(n,this._initMenuItemEvents.bind(this,t,r)),this._initMenuEvents(t)},_initMenuItemEvents:function(e,t,i){var n="."+i.getMenuItemClassName(e).replace(" ",".");if(i.whenRendered){var a=t.find(n);i.whenRendered(e,a)}i.actionHandler&&t.on("click",n,function(){i.actionHandler(e),e.hideBubble()}.bind(this))},_initMenuEvents:function(e){var t=e.$target,i=function(){t.data("ui-tauBubble")&&(this._isElementVisible(t)?t.tauBubble("adjust"):e.destroyBubble())}.bind(this),n=t.closest(this._getScrollContainerSelector());n.on("scroll",i),t.on("taububbledestroy",function(){n.off("scroll",i)})},_initBubble:function(e,t,n){return e.destroyBubble(),e.$target.tauBubble(i.extend({appendTo:n,showArrow:!1,content:this._getMenuContent(e,t),onPositionConfig:function(e){e.my="left top",e.at="right top"},onShow:function(){e.$target.addClass("t3-opened")},onHide:function(t,i){i.preventDefault&&i.preventDefault(),e.destroyBubble()},template:['<div class="tau-bubble t3-views-navigator-bubble">','    <div class="tau-bubble__inner" role="content"></div>',"</div>"].join(""),zIndex:999},e.options)),e.$target.tauBubble("show"),n.find(".tau-bubble")},_getMenuContent:function(e,t){var n=i.map(t,function(t){return{menuItem:t,menuConfig:e}});return a.render({menuItems:n})},_normalizeSeparators:function(e){var t=i.reduce(e,function(e,t){if(t instanceof n){if(!e.length)return e;if(i.last(e)instanceof n)return e}return e.push(t),e},[]);return i.last(t)instanceof n&&t.splice(t.length-1,1),t
}})}),define("tau/components/board.menu/services/context.menu.items/rename",["require","Underscore","tau/core/injector"],function(e){var t=e("Underscore"),i=e("tau/core/injector");return function(e){return i.defineModule(["settingsService","boardMenuViewsMenuService","boardMenuBus"],function(i,n,a){return{shouldRender:function(e){return e.isEditable},getMenuItemClassName:t.constant("i-role-menu-action-rename"),getContent:t.constant("Rename"),actionHandler:function(t){taus.track({action:"rename view menu item",itemType:e,tags:["viewsMenu"]}),i.expandBoardMenuIfCollapsed().then(function(){a.fire("board.menu.rename.start",t.itemId)})}}})}}),define("tau/components/board.menu/services/context.menu.items/access",["require","tau/core/injector","Underscore"],function(e){var t=e("tau/core/injector"),i=e("Underscore"),n={board:"Make this View visible to all or selected teams",group:"Make this Group visible to all or selected teams"};return function(e){return t.defineModule(["boardAccessEditorService","boardSettingsService"],function(t,a){return{shouldRender:function(e){return e.isEditable},getMenuItemClassName:i.constant("i-role-menu-action-access"),getTooltipText:function(){return n[e]||""},_getMenuItem:function(e){return e.board||e.group},_getIconClassName:function(e){return e.getIsPrivate()?"tau-icon-access-type-private":e.getIsCustomShared()?"tau-icon-access-type-custom":""},_getLabel:function(e){return e.getIsPrivate()?"Private":e.getIsCustomShared()?"Custom":"Public"},getContent:function(e){var t=this._getMenuItem(e),i=this._getIconClassName(t),n=this._getLabel(t);return'Access<span class="drop-down-option__access-type">'+(i?'<span class="tau-icon-general '+i+'"></span>':"")+n+"</span>"},actionHandler:function(i){taus.track({action:"change access",itemType:e,tags:["viewsMenu"]}),t.show(i.itemId,e,i.$target,a.getCurrentService())}}})}}),define("tau/components/board.menu/services/context.menu.items/board.toggle.favorite",["require","tau/core/injector","Underscore"],function(e){var t=e("tau/core/injector"),i=e("Underscore");
return t.defineModule(["boardMenuViewsMenuService"],function(e){return{getMenuItemClassName:i.constant("i-role-menu-action-favorites"),getContent:function(e){return e.board.isFavorite?"Remove from Favorites":"Add to Favorites"},shouldRender:function(e){var t=e.group;return t.isFavorite?t.getIsUngroupedGroup():!0},actionHandler:function(t){var i={isFavorite:t.board.isFavorite},n={isFavorite:!i.isFavorite};taus.track({action:"toggle view favorite",isFavorite:n.isFavorite,tags:["viewsMenu"]}),e.boardsApi.updateViewMenuItem(t.board.boardId,n,i)}}})}),define("tau/components/board.menu/services/context.menu.items/board.toggle.visibility",["require","tau/core/injector"],function(e){var t=e("tau/core/injector");return t.defineModule(["boardMenuViewsMenuService"],function(e){return{shouldRender:function(e){return e.group.menuIsVisible},getTooltipText:function(e){return e.board.menuIsVisible?"Hide this View from your menu":"Show this View in your menu"},getMenuItemClassName:function(e){return e.board.menuIsVisible?"i-role-menu-action-hide":"i-role-menu-action-unhide"},getContent:function(e){return e.board.menuIsVisible?"Hide":"Show"},actionHandler:function(t){var i={menuIsVisible:t.board.menuIsVisible},n={menuIsVisible:!i.menuIsVisible};taus.track({action:"toggle view visibility",isVisible:n.menuIsVisible,tags:["viewsMenu"]}),e.boardsApi.updateViewMenuItem(t.board.boardId,n,i)}}})}),define("tau/components/board.menu/services/context.menu.items/board.remove",["require","Underscore","tau/core/injector"],function(e){var t=e("Underscore"),i=e("tau/core/injector");return i.defineModule(["boardsOperationsService","boardMenuModel"],function(e,i){return{shouldRender:function(e){return e.isEditable},getMenuItemClassName:t.constant("i-role-menu-action-remove drop-down-option-danger"),getContent:t.constant("Remove"),getTooltipText:t.constant("Remove this View"),whenRendered:function(e,t){t.tauConfirm({content:"<h3>Do you really want to remove this View?</h3>",callbacks:{success:function(){taus.track({action:"remove view from menu",tags:["viewsMenu"]}),this._removeBoard(e),e.destroyBubble()
}.bind(this)},zIndex:1e3})},_removeBoard:function(t){var n=t.board.boardId,a=t.board.acid,r=t.isCurrentBoard;if(r){var s=i.findBoardDataToReplaceDeleted(t.board.boardId),o=s?s.key:null,l=s?s.acid:null;return e.removeBoardAndRedirect(n,a,o,l)}return e.removeBoard(n,a)}}})}),define("tau/components/board.menu/services/context.menu.items/board.setup",["require","tau/core/injector"],function(e){var t=e("tau/core/injector");return t.defineModule(["boardSettingsService","urlBuilder","routingService"],function(e,t,i){return{getMenuItemClassName:function(){return"i-role-menu-action-setup"},getContent:function(e){return e.isCurrentBoard&&e.board.edit?"Finish setup":"Setup"},actionHandler:function(n){var a=n.isCurrentBoard;if(taus.track({action:"open view setup",isCurrent:a,tags:["viewsMenu"]}),a)e.toggleBoardEditMode();else{var r=t.getRelativeBoardUrl(n.board.boardId);i.redirect(r+"&openSetup=")}}}})}),define("tau/components/board.menu/services/context.menu.items/board.open.tab",["require","Underscore","tau/core/class","tau/utils/utils.window"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n=e("tau/utils/utils.window");return i.extend({getMenuItemClassName:t.constant("i-role-open-view-in-new-tab"),getContent:t.constant("Open in new tab"),actionHandler:function(e){taus.track({action:"open in new tab",tags:["viewsMenu"]}),n.tryOpenInBackgroundTab(e.board.link)}})}),define("tau/components/board.menu/services/context.menu.items/group.toggle.favorite",["require","tau/core/injector","Underscore"],function(e){var t=e("tau/core/injector"),i=e("Underscore");return t.defineModule(["boardMenuViewsMenuService"],function(e){return{getMenuItemClassName:i.constant("i-role-menu-action-favorites"),getContent:function(e){return e.group.isFavorite?"Remove from Favorites":"Add to Favorites"},actionHandler:function(t){var i={isFavorite:t.group.isFavorite},n={isFavorite:!i.isFavorite};taus.track({action:"toggle group favorite",isFavorite:n.isFavorite,tags:["viewsMenu"]}),e.groupsApi.updateViewMenuItem(t.itemId,n,i)
}}})}),define("tau/components/board.menu/services/context.menu.items/group.toggle.visibility",["require","tau/core/injector"],function(e){var t=e("tau/core/injector");return t.defineModule(["boardMenuViewsMenuService"],function(e){return{getMenuItemClassName:function(e){return e.group.menuIsVisible?"i-role-menu-action-hide":"i-role-menu-action-unhide"},getTooltipText:function(e){return e.group.menuIsVisible?"Hide this Group from your menu":"Show this Group in your menu"},getContent:function(e){return e.group.menuIsVisible?"Hide":"Show"},actionHandler:function(t){var i={menuIsVisible:t.group.menuIsVisible},n={menuIsVisible:!i.menuIsVisible};taus.track({action:"toggle view group visibility",isVisible:n.menuIsVisible,tags:["viewsMenu"]}),e.groupsApi.updateViewMenuItem(t.group.groupId,n,i)}}})}),define("tau/components/board.menu/services/context.menu.items/group.ungroup",["require","Underscore","tau/core/injector"],function(e){var t=e("Underscore"),i=e("tau/core/injector");return i.defineModule(["settingsService","boardMenuViewsMenuService"],function(e,i){return{shouldRender:function(e){return e.isEditable},getMenuItemClassName:t.constant("i-role-menu-action-ungroup drop-down-option-danger"),getContent:t.constant("Remove"),getTooltipText:t.constant("Remove this Group but keep its Views"),whenRendered:function(e,i){i.tauConfirm({content:"<h3>Do you really want to remove this Group? This action will not delete Views.</h3>",callbacks:{success:function(){taus.track({action:"ungroup view group",groupData:t.pick(e.group,"menuIsVisible","isFavorite","isShared"),tags:["viewsMenu"]}),this._performUngroup(e),e.destroyBubble()}.bind(this)},zIndex:1e3})},_performUngroup:function(e){i.groupsApi.removeViewMenuItem(e.group.groupId)}}})}),define("tau/ui/behaviour/common/ui.behaviour.editableText",["Underscore","jQuery"],function(e,t){t.widget("ui.editableText",{_create:function(){this.element.textEditor(this.options)},enable:function(){this._textEditor().enable()},disable:function(){this._textEditor().disable()
},performSave:function(){this._textEditor().performSave()},activate:function(){var e=this._textEditor();e.isActive()?e.onBlur():e.onFocus()},setValidationErrors:function(t){this.element.addClass("ui-validationerror"),e.isString(t)&&this.element.attr("title",t)},resetValidationErrors:function(e){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title",e)},setValue:function(e){this.element.text(e),this._textEditor().setInitialText(e)},destroy:function(){this._super()},_textEditor:function(){return this.element.data("textEditor")}})}),define("tau/components/board.menu/services/board.menu.context.menu.service",["require","Underscore","tau/services/context.menu/context.menu.service","./context.menu.items/rename","./context.menu.items/access","./context.menu.items/board.toggle.favorite","./context.menu.items/board.toggle.visibility","./context.menu.items/board.remove","./context.menu.items/board.setup","./context.menu.items/board.open.tab","./context.menu.items/group.toggle.favorite","./context.menu.items/group.toggle.visibility","./context.menu.items/group.ungroup","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e){var t=e("Underscore"),i=e("tau/services/context.menu/context.menu.service"),n=e("./context.menu.items/rename"),a=e("./context.menu.items/access"),r=e("./context.menu.items/board.toggle.favorite"),s=e("./context.menu.items/board.toggle.visibility"),o=e("./context.menu.items/board.remove"),l=e("./context.menu.items/board.setup"),u=e("./context.menu.items/board.open.tab"),c=e("./context.menu.items/group.toggle.favorite"),d=e("./context.menu.items/group.toggle.visibility"),p=e("./context.menu.items/group.ungroup");return e("tau/ui/behaviour/common/ui.behaviour.editableText"),i.extend({init:function(e,t,i,f){this._serviceScope=f,this._boardAccessService=e,this._boardMenuScrollService=t,this._loggedUser=i,this._boardMenuItems=[this._serviceScope.createModule(l),this._createSeparator(),this._serviceScope.createModule(u),this._serviceScope.createModule(n("board")),this._serviceScope.createModule(a("board")),this._serviceScope.createModule(r),this._serviceScope.createModule(s),this._createSeparator(),this._serviceScope.createModule(o)],this._groupMenuItems=[this._serviceScope.createModule(n("group")),this._serviceScope.createModule(a("group")),this._serviceScope.createModule(c),this._serviceScope.createModule(d),this._createSeparator(),this._serviceScope.createModule(p)]
},_isElementVisible:function(e){return this._boardMenuScrollService.isMenuElementVisible(e)},_getContainerSelector:t.constant(".i-role-board-menu"),_getScrollContainerSelector:t.constant(".t3-views-catalog"),showMenuForBoard:function(e,t,i,n){var a={itemId:t.boardId,board:t,group:i,isCurrentBoard:n,$target:e,isEditable:this._boardAccessService.isEditable(t,this._loggedUser)};this._showMenu(this._boardMenuItems,a)},showMenuForGroup:function(e,t){var i={itemId:t.groupId,group:t,$target:e,isEditable:this._boardAccessService.isEditable(t,this._loggedUser),user:this._loggedUser};this._showMenu(this._groupMenuItems,i)}})}),define("tau/components/board.menu/services/board.menu.settings.service",["require","Underscore","tau/core/class"],function(e){var t=e("Underscore"),i=e("tau/core/class"),n="boardMenuShowHiddenBoards",a="collapser_aside_collapsed";return i.extend({init:function(e){this._settingsManager=e},getShowHiddenBoards:function(){return this._getField(n,function(e){return!!e})},setShowHiddenBoards:function(e){return this._setField(n,e)},getIsBoardMenuExpanded:function(){return this._getField(a,function(e){return!e})},setIsBoardMenuExpanded:function(e){return this._setField(a,!e)},expandBoardMenuIfCollapsed:function(){return this.getIsBoardMenuExpanded().then(function(e){return e?!1:this.setIsBoardMenuExpanded(!0).then(t.constant(!0))}.bind(this))},_getField:function(e,i,n){return this._settingsManager.get({fields:[e]}).then(function(a){var r=a[e];return t.isFunction(i)?i.call(n,r):r})},_setField:function(e,t){var i={};return i[e]=t,this._settingsManager.set({set:i})}})}),define("tau/services/boards/service.board.access.editor",["require","tau/core/class","tau/components/component.board.editor.access"],function(e){var t=e("tau/core/class"),i=e("tau/components/component.board.editor.access");return t.extend({componentConfig:{type:"board.editor.access",visible:!1,layout:"replaceable",label:"access_popup",selector:".i-role-access-popup"},init:function(e){this._configurator=e
},show:function(e,t,n,a){var r=i.create(this.componentConfig,!0);r.on("afterRender",function(e,t){var i=$('<div class="tau-access-settings-buttons-block"><button class="tau-btn tau-settings-close">Done</button></div>');i.on("click",function(){n.tauPopup("hide")}),i.appendTo($(t.element)),n.tauPopup({className:"ui-access-popup i-role-access-popup",hideOnEscape:!0}),n.tauPopup("setContent",t.element),r.fire("show"),n.tauPopup("show"),n.on("taupopuphide",function(){r.fire("destroy")})}),r.fire("initialize",{context:{configurator:this._configurator,viewMenuId:e,viewMenuType:t}}),r.fire("boardSettings.ready",{boardSettings:a}),r.fire("elementInsertedToContainer")}})}),define("tau/components/board.menu/services/board.menu.scroll.service",["require","jQuery","tau/core/class"],function(e){var t=e("jQuery"),i=e("tau/core/class");return i.extend({isMenuElementVisible:function(e){var t=e.closest(".t3-views-catalog"),i=t.offset()||{top:0},n=i.top,a=n+t.height(),r=e.offset()||{top:0},s=r.top,o=s+e.height();return o>=n&&a>=s&&a>=o&&s>=n},scrollToCurrentMenuElementIfNeeded:function(){var e=t(".t3-views-catalog"),i=e.find(".i-role-board-menu-item-active");this.isMenuElementVisible(i)||e.scrollTop(i.offset().top-e.offset().top+e.scrollTop())}})}),define("tau/services/boards/service.board.settings.wrapper",["require","Underscore","jQuery","tau/core/class"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class");return n.extend({init:function(){this.currentBoardChanged=t.Callbacks(),this._serviceInitializedDef=i.Deferred(),this.serviceInitialized=this._serviceInitializedDef.promise()},getCurrentSettings:function(){return this._assertInitialized(),this._service.settings},getCurrentBoardId:function(){return this.getCurrentSettings().id},getCurrentService:function(){return this._assertInitialized(),this._service},setNewBoardSettingsService:function(e){var t=this._service;t!==e&&(this._service=e,this.currentBoardChanged.fire(e.settings)),this._serviceInitializedDef.resolve()},toggleBoardEditMode:function(){this._assertInitialized();
var e=this._service;return e.get({fields:["edit"]}).then(function(i){var n,a,r=i.edit&&i.cells&&0===i.cells.types.length;return r?(n={emptyCardsSet:+new Date},a=!0):(n={edit:!i.edit},a=n.edit),e.set({set:n}).then(t.constant(a))})},_assertInitialized:function(){if("resolved"!==this._serviceInitializedDef.state())throw new Error("Board settings service is not initialized yet")}})}),define("tau/components/board.menu/sortable",["jQuery"],function(e){return{SORTABLE_KEY_NAME:{full:"data-sortable-key","short":"sortableKey"},sortState:null,sortableSelector:"div[draggable]",_findClosestSortable:function(t){return e(t).closest(this.sortableSelector)},_findFirstSortable:function(t){return e(t).find(this.sortableSelector+":not(.t3-dragging):first")},_findLastSortable:function(t){return e(t).find(this.sortableSelector+":not(.t3-dragging):last")},_findMenuRoot:function(e){return e.closest(".i-role-board-menu")},_removeAllDropClasses:function(t){var i=this._findMenuRoot(e(t));return this._removeDropClasses(i.find(".t3-drop-target"))},_removeDropClasses:function(e){return e.removeClass("t3-drop-target t3-drop-before t3-drop-after")},_addDropClasses:function(e,t){e.addClass("t3-drop-target "+(t?"t3-drop-after":"t3-drop-before"))},_removeDraggingClass:function(){this.sortState.$element.removeClass("t3-dragging")},_addDraggingClass:function(){this.sortState.$element.addClass("t3-dragging")},_findSortableFromEvent:function(e){var t=e.target,i=this._findClosestSortable(t);if(i.length)return this.sortState.overNonSortable=null,i;var n=document.elementFromPoint(e.clientX,e.clientY);return i=this._findClosestSortable(n),i.length?(this.sortState.overNonSortable=null,i):(this.sortState.overNonSortable=t,i=this._findLastSortable(t))},_clearSortState:function(){this.sortState={$element:e(),key:null,over:{$element:e()}}},_setSortStateElement:function(e){this.sortState.$element=this._findClosestSortable(e),this.sortState.key=this._getSortableKey(this.sortState.$element)},_setSortStateOverElement:function(e){var t=e[0],i=this.sortState.over.$element[0];
i!==t&&(this.sortState.over={$element:e,top:e.offset().top,height:t.offsetHeight},this.sortState.placeAfter=null)},_getSortableKey:function(e){var t=e.data(this.SORTABLE_KEY_NAME.short);return t?t+"":null},_getSortableText:function(){return this.sortState.$element.find("a").prop("href")},sortStart:function(e){this._isDropFinished=!1,this._clearSortState(),this._setSortStateElement(e.target),setTimeout(this._addDraggingClass,1),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text",this._getSortableText())},sortDragOver:function(e){e.preventDefault();var t=e.clientY;if(t!==this.sortState.positionY||e.target!==this.sortState.eventTarget){this.sortState.eventTarget=e.target;var i=this._findSortableFromEvent(e);if(!i.length)return void this._removeAllDropClasses(e.target);this._setSortStateOverElement(i),this.sortState.positionY=t;var n=t-this.sortState.over.top,a=n>this.sortState.over.height/2;a!==this.sortState.placeAfter&&(this.sortState.placeAfter=a,this._removeAllDropClasses(i),this._addDropClasses(i,a))}},sortDrop:function(e){this._isDropFinished=!0,e.preventDefault()},sortEnd:function(){this._isDropFinished&&this._sortItems(),this._removeAllDropClasses(this.sortState.over.$element),this._removeDraggingClass(),this._clearSortState()},_sortItems:function(){var e=this.sortState.key,t=this._getSortableKey(this.sortState.over.$element);e!==t&&this.sortItems(e,t,this.sortState.placeAfter)}}}),define("tau/components/board.menu/sortable-groups",["jQuery","tau/core/class","./sortable"],function(e,t,i){return t.mixin(i,{sortableSelector:".t3-view[draggable]",sortableGroupSelector:".t3-view-list-group[draggable]",groupSelector:".t3-view-list-group",_elementIsGroup:function(t){return e(t).is(this.groupSelector)},_removeDropClasses:function(e){return e.removeClass("t3-drop-target t3-drop-item-target t3-drop-group-target t3-drop-before t3-drop-after")},_addDropClasses:function(e,t){this._super(e,t),this.sortState.elementIsGroup?e.addClass("t3-drop-group-target"):(e.addClass("t3-drop-item-target"),this.sortState.$targetGroup&&this.sortState.$targetGroup.addClass("t3-drop-target t3-drop-item-target"))
},_expandGroup:function(){var e=this.sortState.$targetGroup;if(e&&e[0]){var t=this._getSortableKey(e);this.props.model.expandGroup(t)}},_findSection:function(e){var t=e.closest(".t3-views-section");if(0===t.length){var i=this._findMenuRoot(e);t=i.find(".t3-views-section:last")}return t},_findContainingGroup:function(e){return e.closest(this.groupSelector)},_findSortableFromEventForItem:function(t,i){if(!this.sortState.overNonSortable)return{$group:this._findContainingGroup(i),$element:i};var n,a=e(t.target),r=this._findContainingGroup(a);if(0===r.length&&(n=this._findSection(a),r=n.find(".t3-view-list-group:last"),0===r.find(".t3-view:not(.t3-dragging)").length))return{$group:r,$element:r};var s=a.closest(".t3-header");return s.length?(r=this._findContainingGroup(s),i=this._findFirstSortable(r),{$group:r,$element:i.length?i:r}):(r=this._findContainingGroup(i),r.length?(i=this._findLastSortable(r),{$group:r,$element:i.length?i:r}):(a.is(".t3-views-section > .t3-name")&&(n=this._findSection(a),i=this._findFirstSortable(n),r=this._findContainingGroup(i)),{$group:r,$element:i}))},_findSortableFromEventForGroup:function(t){var i,n,a=e(t.target),r=a.closest(".t3-views-section");if(!r.length)return i=this._findMenuRoot(a),n=i.find(this.sortableGroupSelector+":last"),n.length||(n=i.find(".t3-view-list-group:last")),n;if(n=a.closest(this.sortableGroupSelector),n.length)return n;var s=r.find(this.sortableGroupSelector);if(s.length)return n=a.is(".t3-views-section")||a.closest(".i-role-board-menu-item").length?s.last():s.first();var o=r.find(".t3-view-list-group");return o.length?n=o:(i=this._findMenuRoot(a),n=i.find(this.sortableGroupSelector+":first"),n.length||(n=i.find(".t3-view-list-group:last")),n)},_findSortableFromEvent:function(e){if(this.sortState.elementIsGroup){var t=this._findSortableFromEventForGroup(e);return this._setSortStateTargetGroup(t),t}var i=this._super(e),n=this._findSortableFromEventForItem(e,i);return this._setSortStateTargetGroup(n.$group),n.$element},_clearSortState:function(){this.sortState&&clearTimeout(this.sortState.groupExpandTimeout),this._super()
},_setSortStateElement:function(t){this.sortState.$element=e(t).closest("[draggable]"),this.sortState.key=this._getSortableKey(this.sortState.$element),this.sortState.elementIsGroup=this._elementIsGroup(this.sortState.$element)},_setSortStateTargetGroup:function(e){var t=this.sortState.$targetGroup&&this.sortState.$targetGroup[0];t!==e[0]&&(clearTimeout(this.sortState.groupExpandTimeout),this.sortState.$targetGroup=e,this.sortState.elementIsGroup||(this.sortState.groupExpandTimeout=setTimeout(this._expandGroup,500)))},_getSortableText:function(){return this.sortState.elementIsGroup?this.sortState.$element.find(".t3-group > .i-role-view-menu-header").text():this._super()},_sortItems:function(){var e=this.sortState.key,t=this.sortState.over.$element,i=this._getSortableKey(t),n=this.sortState.placeAfter;if(e!==i){if(this.sortState.elementIsGroup)return void(this.sortState.$element.is(n?t.next():t.prev())||this.sortGroups(e,i,n));var a=this._getSortableKey(this.sortState.$targetGroup);a===i||null===a?this.sortItems(e,null,a,!1):this.sortItems(e,i,a,n)}}})}),define("tau/components/board.menu/tooltips",["Underscore","jQuery"],function(e,t){var i=".i-role-view-menu-header";return{componentDidMount:function(){var e=t(this.getDOMNode());this._initTooltips(e)},componentWillUpdate:function(){var e=t(this.getDOMNode());this._removeOldTooltips(e)},_initTooltips:function(e){e.on("mouseenter",i,function(e){if(this._isMenuCollapsed()){var n=t(e.currentTarget),a=n.closest(i),r=this._getContainerForTooltip(a);r.data("ui-tauBubble")||this._createBubble(a,r),r.tauBubble("show")}}.bind(this))},_createBubble:function(e,t){var i="<span>"+e.text()+"</span>";t.tauBubble({alignTo:e,content:i,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),zIndex:105,className:"tau-bubble-tooltip t3-view-menu-tooltip",showEvent:"foo",hideEvent:"mouseleave",stackName:"viewmenu",mode:"tooltip",onShow:function(e){e.toggleClass("t3-active",t.hasClass("t3-active")),e.toggleClass("t3-hidden",t.hasClass("t3-hidden"))
},onPositionConfig:function(e){e.at="right center",e.my="left center"}})},_removeOldTooltips:function(n){var a=n.find(i);e.each(a,function(e){var i=t(e),n=this._getContainerForTooltip(i);n.data("ui-tauBubble")&&n.tauBubble("destroy")},this)},_isMenuCollapsed:function(){return t("[role=app-body]").hasClass("tau-sp-collapsed")},_getContainerForTooltip:function(e){return e.parent().closest("div")}}}),define("tau/components/board.menu/views/board.menu.list.view.scrollable.mixin",["require","jQuery"],function(e){var t=e("jQuery");return{componentDidMount:function(){t("body").on("mousewheel.viewsMenuScrollable",".tau-sp-collapsed .t3-views-navigator .t3-views-catalog",function(e){this.scrollTop-=e.deltaY*e.deltaFactor})},componentWillUnmount:function(){t("body").off(".viewsMenuScrollable")}}}),define("jsx!tau/components/board.menu/views/board.menu.list.view",["require","Underscore","libs/react/react-ex","tau/components/board.menu/sortable-groups","tau/components/board.menu/tooltips","tau/components/board.menu/views/board.menu.list.view.scrollable.mixin"],function(e){var t=e("Underscore"),i=e("libs/react/react-ex"),n=e("tau/components/board.menu/sortable-groups"),a=e("tau/components/board.menu/tooltips"),r=e("tau/components/board.menu/views/board.menu.list.view.scrollable.mixin");return i.defineClass(["board.menu.list.section.view","boardSettingsService","boardMenuScrollService"],function(e,s,o){return{mixins:[n,a,r],componentDidMount:function(){s.currentBoardChanged.add(this._scrollToCurrentView,this);var e=$(this.getDOMNode()),t=setInterval(function(){e.closest("[role=application]").length>0&&(this._scrollToCurrentView(),clearInterval(t))}.bind(this),100)},componentWillUnmount:function(){s.currentBoardChanged.remove(this)},_scrollToCurrentView:function(){var e=this.props.model,t=e.viewMenuSections.findBoardById(this.props.currentBoardId);if(t&&t.menuGroupKey){var i=e.viewMenuSections.findGroupById(t.menuGroupKey);i&&i.hasBoard(t.boardId)&&e.expandGroup(t.menuGroupKey)}o.scrollToCurrentMenuElementIfNeeded()
},sortItems:function(e,t,i,n){this.props.model.prioritizeBoard(e,t,i,n)},sortGroups:function(e,t,i){this.props.model.prioritizeGroup(e,t,i)},getInitialState:function(){return{renamingId:null}},render:function(){var n=t.map(this.props.viewMenuSections.items,function(t){return new e({key:t.sectionType,section:t,querySpec:this.props.querySpec,currentBoardId:this.props.currentBoardId,focusedBoardId:this.props.focusedBoardId,renamingId:this.state.renamingId})},this);return i.DOM.div({className:"t3-views-catalog",onDragStart:this.sortStart,onDragOver:this.sortDragOver,onDragEnd:this.sortEnd,onDrop:this.sortDrop},n)}}})}),define("jsx!tau/components/board.menu/views/board.menu.list.item.name.view",["require","jQuery","libs/react/react-ex"],function(e){var t=(e("jQuery"),e("libs/react/react-ex"));return t.defineClass([],function(){return{render:function(){var e=this.props.isGroup,i=t.addons.classSet({"t3-name":!0,"i-role-group-name":e,"i-role-item-name":!e}),n=t.addons.classSet({"t3-actions-trigger":!0,"i-role-group-actions-trigger":e});return t.DOM.div({className:"t3-header i-role-view-menu-header",onClick:this.props.onClick},t.DOM.span({className:"tau-icon-general"}),t.DOM.div({className:i},this.props.name),t.DOM.div({className:n,onClick:this.props.onActionClick}))}}})}),define("tau/services/rename.service",["require","jQuery","Underscore"],function(e){var t=e("jQuery"),i=e("Underscore");return{startRenamingActivity:function(e,i){var n=t(e);if(1!==n.length)throw new Error("There should be only one name element to edit");return this._startRename(n,i)},stopRenaming:function(e){t(e).editableText("performSave")},_clearSelection:function(){var e=window.getSelection?window.getSelection():document.selection;e&&(e.empty&&e.empty(),e.removeAllRanges&&e.removeAllRanges())},_selectElement:window.getSelection&&document.createRange?function(e){var t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}:t.noop,_startRename:function(e,n){var a=t.Deferred(),r=e.text();
return e.editableText(i.extend({enabled:!1,restoreText:!0,classNameActive:"t3-edit",maxLength:40,onSave:function(e){a.resolve(e,r)},onEditStart:function(){this._selectElement(e[0])}.bind(this),onEditCancelled:function(){a.reject(),this._clearSelection()}.bind(this),onEditEnd:function(){a.resolve(e.text(),r),e.editableText("disable"),this._clearSelection()}.bind(this)},n)).editableText("enable").editableText("activate"),a.always(i.defer.bind(i,function(){e.editableText("destroy")})),a.promise()}}}),define("tau/components/board.menu/services/board.menu.item.rename.service",["require","tau/services/rename.service"],function(e){var t=e("tau/services/rename.service");return{isBeingRenamed:function(e){return e.props.renamingId===e.props.key},startRenameAndSave:function(e){return t.startRenamingActivity(e.$element).done(function(t,i){var n={name:i},a={name:t};e.apiService.updateViewMenuItem(e.itemId,a,n)}).always(function(){e.bus.fire("board.menu.rename.finish")})}}}),define("jsx!tau/components/board.menu/views/board.menu.list.item.view",["require","jQuery","libs/react/react-ex","tau/components/board.menu/services/board.menu.item.rename.service"],function(e){var t=e("jQuery"),i=e("libs/react/react-ex"),n=e("tau/components/board.menu/services/board.menu.item.rename.service");return i.defineClass(["board.menu.list.item.name.view","boardMenuViewsMenuService","boardMenuBus"],function(e,a,r){return{_viewModeClassNames:{list:"t3-detailed",newlist:"t3-list",timeline:"t3-timeline"},_defaultViewModeClassName:"t3-grid",_showContextMenu:function(e){var i=t(e.target);i.hasClass("t3-name")&&i.hasClass("t3-edit")||(this.props.showContextMenu&&this.props.showContextMenu(this.props.board,i.closest(".t3-view").find(".t3-header")),e.preventDefault(),e.stopPropagation())},_getClassName:function(){var e={"t3-view":!0,"i-role-board-menu-item":!0,"t3-private":this.props.board.getIsPrivate(),"t3-custom":this.props.board.getIsCustomShared(),"t3-active":this.props.isCurrentBoard,"i-role-board-menu-item-active":this.props.isCurrentBoard,"t3-focused":this.props.isFocusedBoard,"t3-hidden":this.props.board.menuIsVisible===!1},t=(this.props.board.viewMode||"").toLowerCase(),n=this._viewModeClassNames[t]||this._defaultViewModeClassName;
return e[n]=!0,i.addons.classSet(e)},_onLinkClick:function(e){0===e.button&&r.fire("board.menu.switch.board",this.props.board.boardId)},componentDidUpdate:function(){n.isBeingRenamed(this)&&n.startRenameAndSave({apiService:a.boardsApi,itemId:this.props.renamingId,bus:r,$element:t(this.getDOMNode()).find(".i-role-item-name")})},render:function(){var t=this.props,a=n.isBeingRenamed(this),r=e({name:t.board.name,onActionClick:this._showContextMenu}),s=a?i.DOM.div(null,r):i.DOM.a({className:"t3-view-link",href:t.board.link,onClick:this._onLinkClick},r);return i.DOM.div({className:this._getClassName(),onContextMenu:this._showContextMenu,draggable:!a,"data-sortable-key":t.key},s,i.DOM.div({className:"t3-views__drop-placeholder"}))}}})}),define("jsx!tau/components/board.menu/views/board.menu.list.group.view",["require","jQuery","Underscore","libs/react/react-ex","./../services/board.menu.transformations.service","tau/components/board.menu/services/board.menu.item.rename.service"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("libs/react/react-ex"),a=e("./../services/board.menu.transformations.service"),r=e("tau/components/board.menu/services/board.menu.item.rename.service");return n.defineClass(["board.menu.list.item.view","board.menu.list.item.name.view","boardMenuViewsMenuService","boardContextMenuService","boardMenuBus"],function(e,s,o,l,u){return{_isRenamingActivated:!1,_getGroupClassName:function(){var e=this.props.groupModel,t=e.getIsRegularGroup();return n.addons.classSet({"t3-group":!0,"t3-hidden":e.menuIsVisible===!1,"t3-private":e.getIsPrivate(),"t3-custom":e.getIsCustomShared(),"t3-regular-group":t,"t3-other-group":!t,"t3-expanded":e.isExpanded||this.props.querySpec.filterText})},_getGroupContainerClassName:function(){var e=this.props.groupModel,t=e.getIsRegularGroup();return n.addons.classSet({"t3-view-list-group":!0,"t3-view-list-regular-group":t,"t3-view-list-other-group":!t,"i-role-views-menu-favorites-group":e.getIsFavoriteUngroupedGroup()})},_showViewContextMenu:function(e,t){var i=e.boardId===this.props.currentBoardId;
l.showMenuForBoard(t,e,this.props.groupModel,i)},_toggleGroupExpanded:function(){var e={isExpanded:this.props.groupModel.isExpanded},t={isExpanded:!e.isExpanded};o.groupsApi.updateViewMenuItem(this.props.groupModel.groupId,t,e)},_showGroupContextMenu:function(e){var i=t(e.target);i.hasClass("t3-name")&&i.hasClass("t3-edit")||(i=i.closest(".t3-header"),l.showMenuForGroup(i,this.props.groupModel),e.preventDefault(),e.stopPropagation())},_getSortableKey:function(e){return e.groupId},_startRenamingIfNeeded:function(){r.isBeingRenamed(this)?this._isRenamingActivated||(this._isRenamingActivated=!0,r.startRenameAndSave({apiService:o.groupsApi,itemId:this.props.renamingId,bus:u,$element:t(this.getDOMNode()).find(".i-role-group-name")})):this._isRenamingActivated=!1},_isGroupContainingCurrentBoard:function(){return this.props.groupModel.hasBoard(this.props.currentBoardId)},componentWillMount:function(){this.props.groupModel.isExpanded=this.props.groupModel.isExpanded||this._isGroupContainingCurrentBoard()},componentDidMount:function(){this._startRenamingIfNeeded()},componentDidUpdate:function(){this._startRenamingIfNeeded()},render:function(){var t=this.props.groupModel,r=a.getVisibleBoards(t.boards,this.props.querySpec),o=!r.length,l=t.getIsRegularGroup();if(this.props.querySpec.filterText&&o&&l)return n.DOM.span(null);var u=i.map(r,function(t){return new e({board:t,key:t.boardId,isCurrentBoard:t.boardId===this.props.currentBoardId,isFocusedBoard:t.boardId===this.props.focusedBoardId,showContextMenu:this._showViewContextMenu,renamingId:this.props.renamingId})},this);if(!l)return n.DOM.div({className:this._getGroupContainerClassName(),"data-sortable-key":this._getSortableKey(t)},n.DOM.div({className:this._getGroupClassName()},u),n.DOM.div({className:"t3-views__drop-placeholder"}));var c=!this.props.renamingId;return n.DOM.div({className:this._getGroupContainerClassName(),draggable:c,"data-sortable-key":this._getSortableKey(t)},n.DOM.div({className:this._getGroupClassName(),onContextMenu:this._showGroupContextMenu},s({name:t.name||t.groupId,onClick:this._toggleGroupExpanded,onActionClick:this._showGroupContextMenu,isGroup:!0}),u),n.DOM.div({className:"t3-views__drop-placeholder"}))
}}})}),define("jsx!tau/components/board.menu/views/board.menu.list.section.view",["require","libs/react/react-ex","Underscore","./../services/board.menu.transformations.service","./../models/board.menu.constants"],function(e){{var t=e("libs/react/react-ex"),i=e("Underscore");e("./../services/board.menu.transformations.service"),e("./../models/board.menu.constants")}return t.defineClass(["board.menu.list.group.view"],function(e){return{_getSectionClassName:function(){return t.addons.classSet({"t3-views-section":!0,"t3-favorite-views-section i-role-favorite-views-section":this.props.section.getIsFavoritesSection(),"t3-other-views-section i-role-other-views-section":this.props.section.getIsOthersSection()})},render:function(){var n=this.props.section.getVisibleData(this.props.querySpec),a=i.filter(n.groups,function(e){return e.getIsRegularGroup()});if(!n.boards.length&&!a.length)return t.DOM.noscript(null);var r=i.map(n.groups,function(t){return new e({groupModel:t,key:t.groupId,querySpec:this.props.querySpec,currentBoardId:this.props.currentBoardId,focusedBoardId:this.props.focusedBoardId,renamingId:this.props.renamingId})},this),s=t.DOM.div({className:"t3-name"},this.props.section.name);return t.DOM.div({className:this._getSectionClassName()},s,r)}}})}),define("jsx!tau/components/board.menu/views/board.menu.actions.view",["require","libs/react/react-ex"],function(e){var t=e("libs/react/react-ex");return t.defineClass(["boardMenuBus","settingsService","boardsOperationsService","integrationService"],function(e,i,n,a){return{getInitialState:function(){return{isNewItemMenuVisible:!1}},componentDidMount:function(){i.getShowHiddenBoards().then(this._setShowHidden),a.actionsMenuItemsUpdated.add(this.forceUpdate,this)},componentWillUnmount:function(){a.actionsMenuItemsUpdated.remove(this)},_getAddViewTriggerClassName:function(){return t.addons.classSet({"t3-add-view-trigger":!0,"i-role-add-board-button":!0,"t3-pressed":this.state.isNewItemMenuVisible})},_getToggleHiddenBoardsButtonClassName:function(){return t.addons.classSet({"t3-show-hidden-views-trigger":!0,"t3-pressed":this.props.showHidden})
},_getNewItemMenuClassName:function(){return t.addons.classSet({"t3-add-view-options-list":!0,"t3-active":this.state.isNewItemMenuVisible})},_onToggleHiddenBoards:function(){var e=!this.props.showHidden;this._setShowHidden(e),i.setShowHiddenBoards(e)},_onShowOptionsClick:function(){this.setState({isNewItemMenuVisible:!this.state.isNewItemMenuVisible})},_onCreateBoard:function(){this.setState({isNewItemMenuVisible:!1}),e.fire("board.menu.update.search.filter",""),n.createBoardAndRedirect()},_onCreateGroup:function(){this.setState({isNewItemMenuVisible:!1}),e.fire("board.menu.update.search.filter",""),n.createViewGroup().then(function(t){i.getIsBoardMenuExpanded().then(function(i){i&&e.fire("board.menu.rename.start",t.data.key)})})},_setShowHidden:function(t){e.fire("board.menu.toggle.hidden",t)},render:function(){return t.DOM.div({className:"t3-controls"},this._getNewItemMenu(),t.DOM.div({className:this._getAddViewTriggerClassName(),onClick:this._onShowOptionsClick,title:"Create new Groups and Views"},t.DOM.span(null,"Create")),this._getToggleHiddenButton())},_getNewItemMenu:function(){var e=a.getCustomActionsMenuItems();return t.DOM.div({className:this._getNewItemMenuClassName()},t.DOM.div({className:"t3-group i-role-create-group-menu-item",onClick:this._onCreateGroup},t.DOM.div({className:"t3-header"},t.DOM.span({className:"tau-icon-general"}),t.DOM.div({className:"t3-name"},"New Group"))),t.DOM.div({className:"t3-view t3-grid i-role-create-view-menu-item",onClick:this._onCreateBoard},t.DOM.div({className:"t3-header"},t.DOM.span({className:"tau-icon-general"}),t.DOM.div({className:"t3-name"},"New View"))),e)},_getToggleHiddenButton:function(){if(!this.props.hasHiddenBoards)return null;var e=this.props.showHidden?"Hide Groups and Views from your menu":"Show hidden Groups and Views in your menu";return t.DOM.div({className:this._getToggleHiddenBoardsButtonClassName(),onClick:this._onToggleHiddenBoards,title:e})}}})}),define("jsx!tau/components/board.menu/views/board.menu.search.view",["require","jQuery","Underscore","libs/react/react-ex","./../services/board.menu.transformations.service"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("libs/react/react-ex"),a=e("./../services/board.menu.transformations.service");
return n.defineClass(["boardMenuBus","settingsService"],function(e,r){return{getInitialState:function(){return{isFocused:!1}},_onSearchTermChanged:function(e){this._setFilter(e.target.value)},_setFilter:function(t){e.fire("board.menu.update.search.filter",t)},_cancelFiltering:function(){this.props.querySpec.filterText?this._setFilter(""):this._getInputNode().blur()},_onKeyDown:function(e){var t=this._getOperationForKey(e.keyCode);t&&(t(),e.preventDefault())},_getOperationForKey:function(e){switch(e){case t.ui.keyCode.DOWN:return this._tryFocusNextBoard;case t.ui.keyCode.UP:return this._tryFocusPrevBoard;case t.ui.keyCode.ENTER:return this._trySwitchToFocusedBoard;case t.ui.keyCode.ESCAPE:return this._cancelFiltering}},_tryFocusNextBoard:function(){this._tryFocusWith(function(e,t){return t-1>e?e+1:0})},_tryFocusPrevBoard:function(){this._tryFocusWith(function(e,t){return e>0?e-1:t-1})},_tryFocusWith:function(e){var t=this._getBoards();if(t.length>0){var i=this._getFocusedBoardIndex(t),n=e(i,t.length),a=t[n].boardId;this._changeFocusedBoard(a)}},_trySwitchToFocusedBoard:function(){var t=this._getBoards(),i=this._getFocusedBoard(t);i&&(e.fire("board.menu.switch.board",i.boardId),this._setFilter(""),this._changeFocusedBoard(""),window.location.href=i.link)},_getBoards:function(){return i.flatMap(this.props.viewMenuSections.getAllViewGroups(),function(e){return a.getVisibleBoards(e.boards,this.props.querySpec)},this)},_getFocusedBoard:function(e){var t=this.props.focusedBoardId;return i.find(e,i.matches({boardId:t}))},_getFocusedBoardIndex:function(e){var t=this.props.focusedBoardId;return i.findIndex(e,i.matches({boardId:t}))},_onFocus:function(){this.setState({isFocused:!0})},_onBlur:function(){this.setState({isFocused:!1}),this.props.focusedBoardId&&this._changeFocusedBoard("")},_changeFocusedBoard:function(t){e.fire("board.menu.focus.board",t)},_expandPanelIfRequired:function(){var e=this;r.expandBoardMenuIfCollapsed().then(function(t){t&&e._getInputNode().focus(1)})},_getInputNode:function(){return t(this.getDOMNode()).find(".i-role-views-list-search")
},_onClearButtonClick:function(){this._setFilter("")},render:function(){var e=["t3-search",this.state.isFocused?"t3-active":null].join(" "),t=this.props.querySpec.filterText?n.DOM.div({className:"tau-icon-general tau-icon-close-gray",onClick:this._onClearButtonClick}):null;return n.DOM.div({className:e,onClick:this._expandPanelIfRequired},n.DOM.input({className:"i-role-views-list-search",type:"text",value:this.props.querySpec.filterText,onChange:this._onSearchTermChanged,onKeyDown:this._onKeyDown,onFocus:this._onFocus,onBlur:this._onBlur}),t)}}})}),define("tau/components/board.menu/services/board.menu.prioritization.service",["require","tau/core/class","Underscore","./../models/board.menu.constants"],function(e){"use strict";var t=e("tau/core/class"),i=e("Underscore"),n=e("./../models/board.menu.constants");return t.extend({init:function(e,t){this._viewsMenuService=e,this._loggedUser=t},prioritizeGroup:function(e,t,i,n){var a,r=e.findSectionContainingGroup(t),s=e.findSectionContainingGroup(i),o=e.findGroupById(t),l=e.findGroupById(i);if(!l.getIsUngroupedGroup()){this._viewsMenuService.groupsApi.prioritizeViewMenuItem(t,i,n).then(this._applyGroupPrioritizationResponse.bind(this,e));var u=this._getNewGroupPriority(t,r,i,s,n);null!==u&&(o.updateGroupData({menuNumericPriority:u}),a=!0)}r!==s&&this._changeGroupSection(o,r,s),a&&s.invalidateGroupsOrder()},_applyGroupPrioritizationResponse:function(e,t){var n=t.data.items;i.each(n,function(t){var i=e.findGroupById(t.key);i&&i.menuNumericPriority!==t.menuNumericPriority&&i.updateGroupData({menuNumericPriority:t.menuNumericPriority})},this)},_getNewGroupPriority:function(e,t,n,a,r){var s=t.findGroupIndexById(e);if(0>s)return null;var o=a.viewMenuGroups,l=a.findGroupIndexById(n);if(0>l)return null;if(r&&l++,o.length){var u=i.reject(o,function(e){return e.getIsUngroupedGroup()});return this._calculateTargetPriority(u,l)}return null},prioritizeBoard:function(e,t,i,a,r){var s=e.findBoardById(t),o=e.findGroupContainingBoard(t),l=e.findGroupById(a||n.UNGROUPED_GROUP_KEY);
i&&this._viewsMenuService.boardsApi.prioritizeViewMenuItem(t,i,r).then(this._applyBoardPrioritizationResponse.bind(this,e));var u=this._getNewBoardPriority(t,o,i,l,r);null!==u&&(s.updateBoardData({menuNumericPriority:u}),l.invalidateViewsOrder()),this._updateBoardOnDrop(s,o,l)},_applyBoardPrioritizationResponse:function(e,t){var n=t.data.items;i.each(n,function(t){var i=e.findBoardById(t.key);i&&i.menuNumericPriority!==t.menuNumericPriority&&i.updateBoardData({menuNumericPriority:t.menuNumericPriority})},this)},_getNewBoardPriority:function(e,t,i,n,a){var r=t.findBoardIndexById(e);if(0>r)return null;var s=n.boards,o=i?n.findBoardIndexById(i):0;return 0>o?null:(a&&o++,s.length?this._calculateTargetPriority(s,o):null)},_updateBoardOnDrop:function(e,t,n){var a=e.getCanChangeGroup(this._loggedUser),r=n!==t,s=t.isFavorite!==n.isFavorite,o={};a&&r?(o.isFavorite=n.isFavorite,o.menuGroupKey=n.getIsRegularGroup()?n.groupId:""):s&&(o.isFavorite=n.isFavorite);var l=i.keys(o);if(l.length){var u=i.pick(e,l);this._viewsMenuService.boardsApi.updateViewMenuItem(e.boardId,o,u)}},_calculateTargetPriority:function(e,t){var i=e[t-1]||{menuNumericPriority:e[0].menuNumericPriority-16},n=e[t]||{menuNumericPriority:e[e.length-1].menuNumericPriority+16};return(i.menuNumericPriority+n.menuNumericPriority)/2},_changeGroupSection:function(e,t,i){this._viewsMenuService.groupsApi.updateViewMenuItem(e.groupId,{isFavorite:i.getIsFavoritesSection()},{isFavorite:t.getIsFavoritesSection()})}})}),define("tau/components/board.menu/models/board.menu.model",["require","Underscore","tau/core/class","./../services/board.menu.prioritization.service","./board.menu.board.group","./board.menu.section.collection"],function(e){"use strict";var t=e("Underscore"),i=e("tau/core/class"),n=e("./../services/board.menu.prioritization.service"),a=e("./board.menu.board.group"),r=e("./board.menu.section.collection");return i.extend({viewMenuSections:null,init:function(e,t,i,a,s){this._componentBus=e,this._loggedUser=t,this._urlService=i.viewsMenuUrlService,this._boardsOperationsService=a,this._viewsMenuService=i,this._boardSettingsService=s,this._boardSettingsService.currentBoardChanged.add(this._onCurrentBoardChanged,this),this.viewMenuSections=new r,this.viewMenuSections.sectionCollectionUpdated.add(this._updateViewsMenu,this),this._prioritization=new n(this._viewsMenuService,this._loggedUser),this._subscribeToAcidChanges()
},loadBoards:function(){return this._viewsMenuService.getViewsMenuForUser().then(function(e){this.viewMenuSections.setSections(e),this._subscribeToApiServiceChanges()}.bind(this))},_createBoardGroupModel:function(e){return new a(this._urlService,e)},_updateViewsMenu:function(){this._componentBus.fire("board.menu.update.all",this.viewMenuSections)},expandGroup:function(e){if(e){var t=this.viewMenuSections.findGroupById(e);t&&t.getIsRegularGroup()&&!t.isExpanded&&this._viewsMenuService.groupsApi.updateViewMenuItem(t.groupId,{isExpanded:!0})}},prioritizeGroup:function(e,t,i){this._prioritization.prioritizeGroup(this.viewMenuSections,e,t,i)},prioritizeBoard:function(e,t,i,n){this._prioritization.prioritizeBoard(this.viewMenuSections,e,t,i,n)},findBoardDataToReplaceDeleted:function(e){var i=t.chain(this.viewMenuSections.getAllViewGroups()).flatMap(t.property("boards")).map(t.property("storedBoardData")).value();return this._boardsOperationsService.getNextBoardAfterDeleted(i,e)},_subscribeToAcidChanges:function(){this._clearAcidSubscription(),this._urlService.acidUpdated.add(this._onAcidUpdated,this)},_onAcidUpdated:function(){this.viewMenuSections.applyAcidToViews()},_subscribeToApiServiceChanges:function(){this._clearApiSubscriptions();var e=this._viewsMenuService.boardsApi;e.on("service.views.api.created.board",function(e,t){this._onBoardCreated(t)},this),e.on("service.views.api.updating.board",function(e,t){this._onBoardUpdated(t)},this),e.on("service.views.api.updated.board",function(e,t){this._onBoardUpdated(t)},this),e.on("service.views.api.removed.board",function(e,t){this._onBoardRemoved(t)},this),e.on("service.views.api.removing.board",function(e,t){this._onBoardRemoved(t)},this);var t=this._viewsMenuService.groupsApi;t.on("service.views.api.created.group",function(e,t){this._onBoardGroupCreated(t)},this),t.on("service.views.api.updating.group",function(e,t){this._onBoardGroupUpdated(t)},this),t.on("service.views.api.updated.group",function(e,t){this._onBoardGroupUpdated(t)
},this),t.on("service.views.api.removed.group",function(e,t){this._onBoardGroupRemoved(t)},this)},_onBoardCreated:function(e){this.viewMenuSections.findAppropriateGroupForBoard(e).createBoardInGroup(e)},_onBoardGroupCreated:function(e){this.viewMenuSections.findGroupById(e.key)||this.viewMenuSections.createGroupInSection(this._createBoardGroupModel(e))},_onBoardUpdated:function(e){this.viewMenuSections.applyBoardUpdates(e)||this._onBoardCreated(e)},_onBoardGroupUpdated:function(e){var i=this.viewMenuSections.findGroupById(e.key);if(!i)return void this._onBoardGroupCreated(e);var n=i?i.boards:[],a=i&&i.isFavorite&&t.has(e,"isFavorite")&&!e.isFavorite;this.viewMenuSections.applyGroupUpdates(e),a&&t.each(n,function(e){e.isFavorite&&this._viewsMenuService.boardsApi.updateViewMenuItem(e.boardId,{isFavorite:!1},{isFavorite:e.isFavorite})},this)},_onBoardRemoved:function(e){this.viewMenuSections.removeView(e)},_onBoardGroupRemoved:function(e){var i=this.viewMenuSections.findGroupById(e);if(i){var n=i.boards,a=i.isFavorite,r=this.viewMenuSections.findSectionContainingGroup(e);r&&r.removeMenuGroup(e),a&&t.each(n,function(e){e.isFavorite||this._viewsMenuService.boardsApi.updateViewMenuItem(e.boardId,{isFavorite:!0},{isFavorite:e.isFavorite})},this)}},_onCurrentBoardChanged:function(){var e=this._boardSettingsService.getCurrentSettings().id;this._componentBus.fire("board.menu.switch.board",e)},_clearApiSubscriptions:function(){var e=[this._viewsMenuService.boardsApi,this._viewsMenuService.groupsApi];t.each(e,function(e){e.removeAllListeners(this)},this)},_clearAcidSubscription:function(){this._urlService.acidUpdated.remove(this)},destroy:function(){this._clearApiSubscriptions(),this._clearAcidSubscription()}})}),define("tau/components/board.menu/extensions/board.menu.config.extension",["require","jQuery","Underscore","./../board.menu.config","tau/core/extension.base","tau/core/injector","./../services/board.menu.context.menu.service","./../services/board.menu.settings.service","tau/services/boards/service.board.access.editor","../services/board.menu.scroll.service","tau/services/boards/service.board.settings.wrapper","tau/services/boards/service.views.menu.api.wrapper","jsx!./../views/board.menu.list.view","jsx!./../views/board.menu.list.item.name.view","jsx!./../views/board.menu.list.item.view","jsx!./../views/board.menu.list.group.view","jsx!./../views/board.menu.list.section.view","jsx!./../views/board.menu.actions.view","jsx!./../views/board.menu.search.view","./../models/board.menu.model"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("./../board.menu.config"),a=e("tau/core/extension.base"),r=e("tau/core/injector"),s=e("./../services/board.menu.context.menu.service"),o=e("./../services/board.menu.settings.service"),l=e("tau/services/boards/service.board.access.editor"),u=e("../services/board.menu.scroll.service"),c=e("tau/services/boards/service.board.settings.wrapper"),d=e("tau/services/boards/service.views.menu.api.wrapper"),p=e("jsx!./../views/board.menu.list.view"),f=e("jsx!./../views/board.menu.list.item.name.view"),m=e("jsx!./../views/board.menu.list.item.view"),h=e("jsx!./../views/board.menu.list.group.view"),g=e("jsx!./../views/board.menu.list.section.view"),v=e("jsx!./../views/board.menu.actions.view"),b=e("jsx!./../views/board.menu.search.view"),y=e("./../models/board.menu.model");
return a.extend({init:function(e){this._super(e),this._ownedResources=[],this._renderDataDef=t.Deferred(),this._configurator=e.context.configurator,this._boardSettingsServiceWrapper=new c,this._boardSettingsServiceWrapper.serviceInitialized.then(function(){var e=this._boardSettingsServiceWrapper.getCurrentService();return"none"===e.settings.id?t.Deferred().resolve():e.get({fields:n.watchedBoardSettingsFields})}.bind(this)).then(i.constant(this._renderDataDef)).then(this._initializeMenu.bind(this))},"bus boardSettings.ready":function(e,t){this._boardSettingsServiceWrapper.setNewBoardSettingsService(t.boardSettings)},"bus afterRender":function(e,t){this._renderDataDef.resolve(t)},_initializeMenu:function(e){var t=this._configurator,i=this._boardSettingsServiceWrapper,n=d.create(t.getViewsMenuService(),function(){return i.getCurrentService()}.bind(this)),a=new r;a.register("integrationService",t.getInternalViewsMenuIntegrationService());var c=t.getUrlBuilder();a.register("urlBuilder",c);var _=t.getRouting();a.register("routingService",_);var x=t.getLoggedUser();a.register("loggedUser",x);var w=this.bus;a.register("boardMenuBus",w),a.register("boardMenuViewsMenuService",n),a.register("boardSettingsService",i);var C=new o(t.getSettingsManager());a.register("settingsService",C),a.register("boardsOperationsService",t.getBoardOperationsService());var S=new l(t);a.register("boardAccessEditorService",S);var T=new y(this.bus,x,n,t.getBoardOperationsService(),i);this._ownedResources.push(T),a.register("boardMenuModel",T);var k=new u;a.register("boardMenuScrollService",k),a.register("boardContextMenuService",new s(t.getBoardAccessService(),k,x,a)),a.registerModule("board.menu.list.item.name.view",f),a.registerModule("board.menu.list.item.view",m),a.registerModule("board.menu.list.group.view",h),a.registerModule("board.menu.list.section.view",g),a.registerModule("boardMenuListView",p),a.registerModule("boardMenuActionsView",v),a.registerModule("boardMenuSearchView",b);var I={configurator:t,element:e.element.filter(".i-role-views-navigator-container")[0],serviceScope:a,model:T};
this.fire("board.menu.config.ready",I)},destroy:function(){i.invoke(this._ownedResources,"destroy"),this._ownedResources=[],this._boardSettingsServiceWrapper.currentBoardChanged.remove(this),this._super()}})}),define("tau/components/board.menu/extensions/board.menu.dispatcher.extension",["require","tau/core/extension.base"],function(e){var t=e("tau/core/extension.base");return t.extend({"bus _board.menu.main.view":function(e,t){this._view=t},"bus board.menu.update.search.filter":function(e,t){this._setProps({filterText:t})},"bus board.menu.toggle.hidden":function(e,t){this._setState({showHidden:t})},"bus board.menu.update.board":function(){this._setProps({viewMenuSections:this._view.props.viewMenuSections})},"bus board.menu.update.all":function(e,t){this._setProps({viewMenuSections:t})},"bus board.menu.focus.board":function(e,t){this._setState({focusedBoardId:t})},"bus board.menu.switch.board":function(e,t){this._setState({currentBoardId:t})},"bus board.menu.sorted":function(e,t){this._setProps({viewMenuSections:t})},"bus board.menu.rename.start":function(e,t){this._setRefState("listView",{renamingId:t})},"bus board.menu.rename.finish":function(){this._setRefState("listView",{renamingId:null})},_setState:function(e){this._view&&this._view.setState(e)},_setRefState:function(e,t){if(this._view){var i=this._view.refs[e];i&&i.setState(t)}},_setProps:function(e){this._view&&this._view.setProps(e)}})}),define("tau/components/component.board.menu",["require","tau/components/component.creator","template!tau/components/board.menu/templates/board.menu.template","tau/components/board.menu/extensions/board.menu.extension","tau/components/board.menu/extensions/board.menu.config.extension","tau/components/board.menu/extensions/board.menu.dispatcher.extension","tau/components/extensions/error/extension.errorBar"],function(e){var t=e("tau/components/component.creator"),i=e("template!tau/components/board.menu/templates/board.menu.template"),n=e("tau/components/board.menu/extensions/board.menu.extension"),a=e("tau/components/board.menu/extensions/board.menu.config.extension"),r=e("tau/components/board.menu/extensions/board.menu.dispatcher.extension"),s=e("tau/components/extensions/error/extension.errorBar");
return{create:function(e){e=e||{};var o={extensions:[n,a,r,s],template:i};return t.create(o,e)}}}),define("tau/core/bus.profiler",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e){var t=this;t.stream=[],t.stopped=!1;var i=e.fire;e.fire=function(){var e=arguments;!t.stopped&&t.registerEvent(e),i.apply(this,e)}},stop:function(){this.stopped=!0},registerEvent:function(e){var t=+new Date,i={tick:t,name:e[0],data:e[1]||{}};this.stream.push(i)},data:function(){return this.stream}});return i}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.view",["Underscore","jQuery","tau/core/extension.base.stateful","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n){var a=i.extend({name:"view.board.plus","bus view.build.skeleton":function(e){n.resetCardIds();var t=e.data;this.fire("template.bind",{name:"boardplus.skeleton",data:t})},getCoords:function(e){var t={};return e.hasAttribute("data-x")&&(t.x=e.getAttribute("data-x")),e.hasAttribute("data-y")&&(t.y=e.getAttribute("data-y")),t},bound:function(e){var t=this,i=e.data.element;this.fire("view.skeleton.built",{element:i});var n=i.find(".i-role-cell");t.fire("view.cellSlot.built.start",{cells:n}),n.each(function(e,i){var n=t.getCoords(i);t.fire("view.cellSlot.built",{element:this,data:n,id:this.id})}),t.fire("view.cellSlot.built.end",{cells:n})},"bus template.boardplus.skeleton.bound":function(e){this.bound(e)},"bus template.boardplus.skeleton.customized.bound":function(e){this.bound(e)},createFireBindTemplateHandler:function(){return e.bind(function(e){this.fire("template.bind",e)},this)},buildCellSkeleton:function(e,i,n){t.when(this.getCellTemplateConfig(e,i,n)).then(this.createFireBindTemplateHandler())},"bus configurator.ready:last + cardLayoutFactory.ready:last + view.build.cell.skeleton + view.skeleton.built:last":function(e,t,i,n,a){this.buildCellSkeleton(t,i,n,a)},buildAxisSkeleton:function(e,i,n){t.when(this.getAxisTemplateConfig(e,i,n)).then(this.createFireBindTemplateHandler())
},"bus configurator.ready:last + cardLayoutFactory.ready:last + view.build.axis.skeleton + view.skeleton.built:last":function(e,t,i,n,a){this.buildAxisSkeleton(t,i,n,a)},getAxisTemplateConfig:function(e,t,i){return{name:"boardplus.cell.axis.skeleton",data:n.convertCellAxisData(i)}},getCellTemplateConfig:function(i,n,a){var r="boardplus.cell.grid.skeleton",s=t.Deferred();return n.getLayoutFactory().done(function(t){var n=e.extend({getLayout:t,configurator:i},a);s.resolve({name:r+".customized",data:n})}),s},getCellElement:function(e,t){var i=n.generateId(e),a=t.find("#"+i);return a},appendCellToBoardSkeleton:function(e,t){var i=e.data,n=e.element,a=this.getCellElement(i,t),r={cell:a,content:n};this.fire("view.cell.skeleton.element.beforeUpdate",r),a.append(n),this.fire("view.cell.skeleton.element.afterUpdate",r),this.fireCellSkeletonBuilt({element:a,data:i})},fireCellSkeletonBuilt:function(e){this.fire("view.cell.skeleton.built",e)},"bus view.skeleton.built:last + template.boardplus.cell.grid.skeleton.customized.bound":function(e){var t=e["view.skeleton.built"].data.element,i=e["template.boardplus.cell.grid.skeleton.customized.bound"].data;this.appendCellToBoardSkeleton(i,t)},"bus view.skeleton.built:last+template.boardplus.cell.axis.skeleton.bound":function(e){var t=e["view.skeleton.built"].data.element,i=e["template.boardplus.cell.axis.skeleton.bound"].data;this.appendCellToBoardSkeleton(i,t)},"bus view.cell.skeleton.built":function(e){var i=this,n=e.data,a=n.data,r=a.hasOwnProperty("x"),s=a.hasOwnProperty("y");if(r&&s){var o=n.element;o.find(".i-role-card").each(function(){var e=t(this);i.fire("view.card.skeleton.built",{element:e,data:{id:e.attr("data-id"),type:e.attr("data-type")}})})}}});return a}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.controller",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n=function(e,t){var i=this;e.refActualCellsCount+=1,e.refActualCellsData.push(t),e.refActualCellsCount===e.expectedCellsCount&&i.fire("overview.cells.skeletons.ready",{cells:e.refActualCellsData,cardGroups:e.refActualCellsCardsGroupedHash})
};return i.extend({init:function(e){this._super(e),this.config=e},"bus initialize":function(e,t){var i=this._extractOptions(t.options||this.config.options,{dragndrop:{containmentRefreshTimeout:null},clipboard:{processTimeout:null},paging:{0:[100,100,100],1:[100,50,25],2:[50,25,25]}});this.fire("options.ready",i),this.fire("configurator.ready",e.data.context.configurator),this.fire("board.configurator.initialized",{configurator:e.data.context.configurator}),this.startLifeCycle(e.data)},"bus refresh":function(){this.startLifeCycle(this.config)},"bus configurator.ready > refresh":function(e,t){this.fire("configurator.ready",t)},"bus options.ready > refresh":function(e,t){this.fire("options.ready",t)},startLifeCycle:function(e){this.fire("start.lifecycle",e)},"bus start.lifecycle":function(){this.fire("afterInit",{})},"bus pastElement:last + afterRender":function(e,t,i){var n=i.element,a=t.element;a!==n&&this.fire("board.element.updated",{newElement:n,oldElement:a})},"bus view.skeleton.built":function(e){this.fire("afterRender",e.data),this.fire("pastElement",e.data)},"bus afterRender":function(e){var t=e.data.element,i=t.find(".i-role-grid");this.fire("$el.ready",t),this.fire("$grid.ready",i)},"bus model.sliceInfo.retrieved":function(e,t){this.fire("view.build.skeleton",t);var i=t.x.onPage,n=t.y.onPage,a=i||1,r=n||1,s=a*r+i+n;this.fire("metaInfo",{expectedCellsCount:s,refActualCellsCount:0,refActualCellsData:[]})},"bus model.cell.basicInfo.retrieved":function(t,i){var n=e.has(i,"x"),a=e.has(i,"y");n&&a?this.fire("view.build.cell.skeleton",i):this.fire("view.build.axis.skeleton",i)},"bus view.cellSlot.built.start":function(){this.fire("model.get.cell.basicInfo.start",{})},"bus view.cellSlot.built.end":function(){this.fire("model.get.cell.basicInfo.end",{})},fireOverviewCardsReady:function(e){this.fire("overview.cards.ready",{cards:e.refActualCellsCardsHash,cardGroups:e.refActualCellsCardsGroupedHash})},"bus metaInfo":function(){this.onViewCellSkeletonBuiltTick=n},"bus overview.cells.skeletons.ready":function(){this.onViewCellSkeletonBuiltTick=t.noop
},"bus metaInfo:last + view.cell.skeleton.built":function(e,t,i){this.onViewCellSkeletonBuiltTick(t,i)},"bus metaInfo + view.cards.update.complete":function(e,t){this.fireOverviewCardsReady(t)},"bus view.skeleton.built + overview.cells.skeletons.ready":function(e){var t=e["view.skeleton.built"].data.element,i=e["overview.cells.skeletons.ready"].data.cells;this.fire("overview.board.ready",{element:t,cells:i})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.templateBinder",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus configurator.ready:last + template.bind":function(e,t,i){var n=i.name,a=i.data,r=i.config||{};i.element=t.getTemplateFactory().get(n).bind(r,a),this.fire("template."+n+".bound",i)},"bus configurator.ready:last + template.pure.bind":function(e,t,i){var n=i.name,a=i.data,r=i.config||{};i.html=t.getTemplateFactory().get(n).bindPure(r,a),this.fire("template."+n+".pure.bound",i)},"bus configurator.ready:last + template.multiply.pure.bind":function(t,i,n){var a=n.name,r=n.arrayData,s=n.config||{},o={},l=i.getTemplateFactory().get(a);o.items=e.map(r,function(e){return{html:l.bindPure(s,e),data:e}}),this.fire("template.multiply."+a+".pure.bound",o)}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-rename",["jQuery","Underscore","tau/core/class","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t,i,n){var a=i.extend({init:function(e,i){var n=this;n.$card=e,n.d=e.data(),n.c=e.closest(".i-role-cellholder").data(),n.externalSettings=i;var a=n.d.entityType,r=n.d.cardData;if(r.hasOwnProperty("name")){var s=t.extend({},r,{__type:a});i.configurator.getStore().register(s)}},fetchFormData:function(){var t=this,i=e.Deferred(),n=t.d.entityType,a=t.d.cardData;return t.externalSettings.configurator.getStore().get(n,{id:a.id,fields:["name"]},{success:i.resolve}).done(),i},saveAndUpdate:function(t){var i=this,n=i.d,a=i.c,r=i.externalSettings.configurator,s=e.Deferred();
return s.done(function(){var e=i.$card.find(".i-role-name");e.text(t);var r=i.$card.data("cardData")||{};r.name=t,i.$card.data("cardData",r),i.externalSettings.updateCardAction(n.entityId,a,i.$card.data())}),r.getStore().save(n.entityType,{$set:{id:n.entityId,name:t}}).done({success:s.resolve}),s},suppressDblClick:function(e){e.on("dblclick.contextmenu",function(e){e.preventDefault(),e.stopPropagation()})},cancelSuppressDblClick:function(e){e.off("dblclick.contextmenu")}}),r=a.extend({getEditableCardStyle:function(){return["tau-card"]},getEditableCardInlineStyle:function(){return"font-size:0.813em; min-height:4em; height:4em; overflow:hidden;"},prepareEditableCard:function(){},getBubbleClassname:function(e){return["tau-cardtooltip","tau-cardtooltip_type_"+e]},create:function(){var i=this,n=i.$card,a=i.externalSettings.domWrapper;i.$destroyDefer=e.Deferred(),i.$bubbleShow=e.Deferred(),i.$dataReady=e.Deferred(),e.when(i.$bubbleShow,i.$dataReady).done(function(e,t){t.editableText("activate")});var r=i.d.entityType.toLowerCase(),s=this.getEditableCardStyle(r).join(" "),o=this.getEditableCardInlineStyle(),l=e(['<div class="'+s+'" style="padding: 0 !important;">','   <div style="display:none;"></div>','   <div style="display:none;"></div>','   <div style="padding: 8px 4px 8px 10px">','       <div class="i-role-name" style="'+o+'">Loading...</div>',"   </div>","</div>"].join(""));this.prepareEditableCard(n,l);var u="team"===r||"project"===r?"":"tau-"+r;l.addClass(u).addClass(i.externalSettings.activationCssClass);var c=i;i.fetchFormData().done(function(e){var n=l.find(".i-role-name"),a=t.bind(i.saveAndUpdate,i);n.editableText({enabled:!1,restoreText:!0,onSave:function(e){a(e).fail(t.bind(this.restoreInitialText,this))},onEditEnd:t.bind(function(){this.$destroyDefer.resolve()},i)}),n.editableText("setValue",e.data.name),i.suppressDblClick(n),t.defer(function(){n.editableText("enable")}),i.$dataReady.resolve(n)});var d={className:this.getBubbleClassname(r).join(" "),template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__inner tau-container" role="content" style="margin:0 0 0 0;"></div>',"</div>"].join(""),alignTo:n,within:a.board,showEvent:"",hideEvent:"",stackName:"context-menu-action",content:l,onPositionConfig:function(e){return e.my="left top-5",e.at="left top",e.collision="flipfit",e
},onShow:i.$bubbleShow.resolve,onHide:function(e){n.css("opacity","");var t=e.find(".i-role-name");c.cancelSuppressDblClick(t),t.data("textEditor").onBlur(),t.editableText("disable")}};i.$bubbleShow.done(function(){n.css("opacity",0)});var p=e(".i-role-card-context-rename-holder");p.length||(p=e('<div class="i-role-card-context-rename-holder"></div>').appendTo("body")),i.$destroyDefer.done(function(){p.tauBubble("hide")}),e(window).on("scroll",i.$destroyDefer.resolve),a.getGrid().on("scroll",i.$destroyDefer.resolve),p.tauBubble(d).tauBubble("show")}}),s=r.extend({getEditableCardStyle:function(e){return["tau-card-v2","tau-card-v2_type_"+e]},prepareEditableCard:function(e,t){var i=Math.max(e.height(),14),n=Math.max(e.width(),240);t.find(".i-role-name").css({height:i,"min-height":i}),t.css({width:n,"min-width":n})},getEditableCardInlineStyle:function(){return"font-size:0.813em; min-height:10em; height:10em; overflow:hidden; max-width:500px"},getBubbleClassname:function(){return["tau-ui-size-l"]}}),o=function(e,t){var i=t?"enable":"disable";e.draggable("instance")&&e.draggable(i)},l=a.extend({create:function(){var i,n=this;o(n.$card,!1),n.fetchFormData().done(t.bind(function(n){var a=this;a.$card.addClass(a.externalSettings.activationCssClass);var r=a.$card.find(".i-role-name");0===r.length&&(r.text(n.data.name),i=e('<div class="tau-card-title-container"><div class="tau-name i-role-name">'+n.data.name+"</div></div>"),a.$card.append(i),r=a.$card.find(".i-role-name")),r=r.eq(0),a.suppressDblClick(r);var s=this,l=t.bind(a.saveAndUpdate,a);r.editableText({enabled:!1,restoreText:!0,onSave:function(e){l(e).fail(t.bind(this.restoreInitialText,this))},onEditEnd:function(){s.cancelSuppressDblClick(r),r.editableText("disable"),r.css("background-color",r.data("color")),a.$card.removeClass(a.externalSettings.activationCssClass),i&&setTimeout(function(){i.remove()},1),o(a.$card,!0)}}),r.editableText("setValue",n.data.name),r.css("background-color",""),t.defer(function(){r.editableText("enable").editableText("activate")
})},n))}}),u=["user","project","team","projectmember"];return n.extend({name:"Rename",className:"i-role-card-context-menu-rename",getDisabledEntityTypes:function(){return u},itemClickCallback:function(e){var i=this.settings,n=e.$trigger;i.updateCardAction=t.bind(this.updateCard,this);var a=n.closest(".i-role-cell").hasClass("i-role-clipboard-holder"),r=this.createRenameForm({vm:i.viewMode,zl:i.zoomLevelData.zoomLevel,isInClipboard:a,isCardCollapsed:!a&&n.closest(".i-role-cellholder").hasClass("tau-collapsed")},n,i);r.create()},createRenameForm:function(e,t,i){return e.isInClipboard?new l(t,i):"board"===e.vm&&(e.isCardCollapsed||e.zl<4)?new r(t,i):"timeline"===e.vm?new s(t,i):"list"===e.vm&&e.zl<3?new r(t,i):new l(t,i)}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-change-tags",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base"],function(e,t,i){return i.extend({name:"Change Tags",className:"i-role-card-context-menu-changeTags",getDisabledEntityTypes:function(){return["user","projectmember"]},getAlignTo:function(e){var t=e.getAlignTo(this);if(t.is(".i-role-timeline-card-holder,.i-role-timeline-planner-card-holder"))return t;var i=t.find(".tau-card-tags:visible");return i.length?i:t},itemClickCallback:function(i){var n=this.getBubbleCreator(i),a=function(){var t=e(n.cardSelector).find(".tau-card-tags");return 0!==t.length&&t.is(":visible")?"left+20":"center"},r={context:{entity:n.entity},alignTo:t.bind(this.getAlignTo,this,n),stackName:"tagsContextMenu",dontCloseSelectors:[".tau-autocomplete__menu__tags"],skipUpdateEntity:function(e){return!(e&&e.config.$set&&t.has(e.config.$set,"tags"))},onPositionConfig:function(e){e.my="center bottom",e.at=a()+" top"},onArrowPositionConfig:function(e,t){"bottom"===t?(e.my="center bottom",e.at=a()+" top"):(e.my="center top",e.at=a()+" bottom")},componentsConfig:{components:[{type:"tags",selector:".i-role-tagslistcontainer",alwaysShowTagsEditField:!0,renderEditorFirst:!0}]}};
n.createBubble(r)}})}),define("tau/configurations/const.page.entity.modes",{FULL:"full",LIST_ENTITY_DETAILS:"listEntityDetails"}),define("tau/configurations/component.config.helper",["Underscore","tau/core/class"],function(e,t){return t.extend({_typeDefaults:{string:""},_containerType:"container",init:function(e){this._context={features:e.context.configurator.getFeaturesService(),mode:e.mode,entityType:e.context.entity.entityType.name.toLowerCase(),isBoard:e.context.configurator.isBoardEdition}},children:function(e){return this.collection(e)},containers:function(e){return this._filterCollection(e,[this._matchContextSpec,this._isNotEmptyContainerSpec])},valueOrDefault:function(e){return this._matchContextSpec(e)?e.value:e.hasOwnProperty("default")?e["default"]:this._default(e.value)},collection:function(e){return this._filterCollection(e,[this._matchContextSpec])},_filterCollection:function(t,i){var n=e.isArray(t),a=n?[]:{},r=n?this._collectArray:this._collectObject;return e.each(t,function(e,t){this._specsAreSatisfiedByItem(i,e)&&r(a,e,t)},this),a},_collectArray:function(e,t){e.push(t)},_collectObject:function(e,t,i){e[i]=t},_specsAreSatisfiedByItem:function(t,i){return e.every(t,function(e){return e.call(this,i)},this)},_matchContextSpec:function(e){return!(e.enabledIf&&!this._matchContextSubSpec(e.enabledIf)||e.disabledIf&&this._matchContextSubSpec(e.disabledIf))},_matchContextSubSpec:function(t){return!(t.feature&&!this._context.features.isEnabled(t.feature)||t.modeIn&&!e.contains(t.modeIn,this._context.mode)||t.entityTypeIn&&!e.contains(t.entityTypeIn,this._context.entityType)||t.isBoard&&t.isBoard!==this._context.isBoard)},_isNotEmptyContainerSpec:function(e){return e.type.toLowerCase()===this._containerType&&e.children&&e.children.length>0},_default:function(e){return this._typeDefaults[typeof e]}})}),define("tau/components/extensions/customField/extension.customField.multipleEntities.count.label.setter",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterInit":function(e,t){var i=t.config.context.configurator.getStore(),n=t.config.context.entity,a=t.config.customField;
this._calculateCount(i,n,a),this._subscribeToStore(i,n,a)},_calculateCount:function(t,i,n){if(!n||"MultipleEntities"!==n.type)return void this._publishCount(0);var a={id:i.id,fields:["customFields"]};t.freeze(!0).done(e.bind(function(e){t.get(i.entityType.name,a,{success:function(e){this._getActualEntitiesAndPublishCount(t,this._findOwnCustomField(e.data.customFields,n))},scope:this}).done(),e.unfreeze()},this))},_subscribeToStore:function(e,t,i){e.unbind(this);var n=this,a={type:t.entityType.name,eventName:"afterSave",hasChanges:["customFields"],filter:{id:t.id},listener:this};e.on(a,function(t){n._getActualEntitiesAndPublishCount(e,n._findOwnCustomField(t.data.changes.customFields,i))})},_publishCount:function(e){this.fire("setBadgeData",e.toString())},_getActualEntitiesAndPublishCount:function(t,i){if(i){if(!i.value)return void this._publishCount(0);var n=this,a=e.map(i.value.split(","),function(e){return e.split(" ")[0]});t.find("general",{fields:["id"],$query:{id:{$in:a}}}).done({success:function(e){n._publishCount(e[0].data.length)}})}},_findOwnCustomField:function(t,i){return e.chain(t).select(function(e){return e.name==i.name}).first().value()}})}),define("tau/configurations/base.container.config",["Underscore","jQuery","tau/core/class","tau/core/termProcessor","tau/configurations/const.page.entity.modes","tau/configurations/component.config.helper","tau/components/extensions/customField/extension.customField.multipleEntities.count.label.setter"],function(e,t,i,n,a,r,s){return i.extend({init:function(e){var t=e.context.getTerms(),i=e.context.entity;this.termProcessor=new n(t),this.configurator=e.context.configurator,this.features=this.configurator.getFeaturesService(),this.collections={},this.helper=new r({context:e.context,mode:e.mode||a.FULL});var s=this.configurator.getUrlBuilder();this._registerActions(i,s),this._registerAdditionalInfoItems(e),this._registerTabs(e),this._registerPanels(e)},_registerActions:function(e,t){this.registerAction("Old Edit",{disabledIf:{feature:"tp3.only"},label:"Old Edit",url:t.getEditUrl(e.id,e.entityType.name)}),this.registerAction("Print",{label:"Print View",command:function(i){i.redirectTo(t.getPrintUrlRelative(e.id,e.entityType.name),"_blank")
}}),this.registerAction("-----","-----"),this.registerAction("Delete",{label:"Delete",confirmation:"Are you sure?",command:function(e){e.removeEntity()},className:"ui-menu__item-action-delete ui-menu__item-dont-close"}),this.registerAction("Move or Copy",{label:"Move or Copy",command:function(e){e.moveOrCopy()},editions:["~board"]}),this.registerAction("Copy to project",{label:"Copy to project&hellip;",command:function(e,t){e.copyToProject(t)},editions:["board"]}),this.registerAction("Convert",{label:"Convert to&hellip;",roleAction:"convert",className:"ui-menu__item__parent",editions:["~innerList"]}),this.registerAction("Create",{label:"Create&hellip;",roleAction:"create",className:"ui-menu__item__parent",editions:["~innerList"]}),this.registerAction("Attach to Request",{label:"Attach to "+this.getTermName("Request"),command:function(e){e.attachToRequest()},editions:["Pro"]})},_registerAdditionalInfoItems:function(e){this.registerAdditionalInfoItem("PlannedStartDate",{label:{text:"Planned Start"},field:{type:"property.plannedStartDate",editable:!0}}),this.registerAdditionalInfoItem("PlannedEndDate",{label:{text:"Planned End"},field:{type:"property.plannedEndDate",editable:!0}}),this.registerAdditionalInfoItem("Owner",{label:{text:"Owner"},field:{type:"property.owner"}}),this.registerAdditionalInfoItem("Assigned Effort",{label:{text:"Assigned Effort"},field:{type:"assignedEffort"}}),this.registerAdditionalInfoItem("Release Assigned Effort",{label:{text:"Assigned Effort"},field:{type:"release.assignedEffort"}}),this.registerAdditionalInfoItem("Velocity",{label:{text:"Velocity"},field:{type:"property.velocity"}}),this.registerAdditionalInfoItem("State",{label:{text:"State"},field:{type:"property.entityState"}}),this.registerAdditionalInfoItem("Test Plan",{label:{text:this.getTermName("TestPlan")},field:{type:"property.testPlan"}}),this.registerAdditionalInfoItem("Responsible",{label:{text:"Responsible"},field:{type:"property.responsible"}}),this.registerAdditionalInfoItem("IsPrivate",{label:{text:"Private?"},field:{type:"property.isPrivate"}}),this.registerAdditionalInfoItem("Last Note",{label:{text:"Last Note"},field:{type:"property.lastNote"}}),e.context.getProject()&&(this.registerAdditionalInfoItem("Release",{label:{text:this.getTermName("Release")},field:{type:"property.release"},practices:["Planning"]}),this.registerAdditionalInfoItem("Release For Iteration",{label:{text:this.getTermName("Release")},field:{type:"property.release",resetDisabled:!0}}),this.registerAdditionalInfoItem("Iteration",{label:{text:this.getTermName("Iteration")},field:{type:"property.iteration"},practices:["Iterations"]}),this.registerAdditionalInfoItem("Build",{label:{text:this.getTermName("build")},field:{type:"property.build"}})),this.registerAdditionalInfoItem("ImpedimentDate",{label:{text:"Creation Date"},field:{type:"property.impedimentDate"}}),this.registerAdditionalInfoItem("CreationDate",{label:{text:"Creation Date"},field:{type:"property.createDate"}}),this.registerAdditionalInfoItem("FinishDate",{label:{text:"Finish Date"},field:{type:"property.completeDate",editable:!0}}),this.registerAdditionalInfoItem("StartDate",{label:{text:"Start Date"},field:{type:"property.startDate",editable:!0}}),this.registerAdditionalInfoItem("ResolvedOn",{label:{text:"Resolved On"},field:{type:"property.completeDate",editable:!0}}),this.registerAdditionalInfoItem("CompletionDate",{label:{text:"Completion  Date"},field:{type:"property.completeDate",editable:!0}}),this.registerAdditionalInfoItem("Project",{label:{text:this.getTermName("Project")},field:{type:"property.project"}}),this.registerAdditionalInfoItem("Priority",{label:{text:this.getTermName("Priority")},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Business Value",{label:{text:"Business Value"},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Priority",{label:{text:"Priority"},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Initial Estimate",{label:{text:"Initial Estimate"},field:{type:"property.initialEstimate"},practices:["Planning"]}),this.registerAdditionalInfoItem("Epic",{label:{text:this.getTermName("Epic")},field:{type:"property.epic"},practices:["Requirements"]}),this.registerAdditionalInfoItem("Feature",{label:{text:this.getTermName("Feature")},field:{type:"property.feature"},practices:["Requirements"]}),this.registerAdditionalInfoItem("Team",{label:{text:"Team"},field:{type:"property.team"},editions:["hasTeams"]}),this.registerAdditionalInfoItem("Team Iteration",{label:{text:this.getTermName("teamIteration")},field:{type:"property.teamIteration"},editions:["hasTeams"]}),this.registerAdditionalInfoItem("User Story",{label:{text:this.getTermName("userStory")},field:{type:"property.userStory"}}),this.registerAdditionalInfoItem("Assignable",{label:{text:this.getTermName("Assignable")},field:{type:"property.assignable"}}),this.registerAdditionalInfoItem("Last Run Result",{label:{text:"Last Run Result"},field:{type:"property.lastStatus"}}),this.registerAdditionalInfoItem("Last Run Date",{label:{text:"Last Run Date"},field:{type:"property.lastRunDate"}}),this.registerAdditionalInfoItem("User Story For Task",{label:{text:this.getTermName("userStory")},field:{type:"property.userStory",resetDisabled:!0}}),this.registerAdditionalInfoItem("Severity",{label:{text:this.getTermName("Severity")},field:{type:"property.severity"},practices:["Planning"]}),this.registerAdditionalInfoItem("Test Case",{label:{text:"Test Case"},field:{type:"property.testCase"}}),this.registerAdditionalInfoItem("Test Plan Run",{label:{text:"Test Plan Run"},field:{type:"property.testPlanRun"}}),this.registerAdditionalInfoItem("Run Result",{label:{text:"Run Result"},field:{type:"property.status.testCaseRun"}}),this.registerAdditionalInfoItem("Run Date",{label:{text:"Run Date"},field:{type:"property.runDate"}}),this.registerAdditionalInfoItem("BuildDate",{label:{text:this.getTermName("Build")+" Date"},field:{type:"property.buildDate",editable:!0}})
},_registerTabs:function(e){this.registerTab("Description",{selected:!0,label:"description",containsNestedContainers:!0,header:[{type:"label",text:"Description"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"tagsEditor",layout:"selectable",children:[{type:"tags",selector:".i-role-tagslistcontainer"},{type:"container",name:"tagsCloud.container",selector:".i-role-tagscloudcontainer",visible:!1,children:[{type:"tagsCloud"}]}]},{type:"container",name:"description container",cssClass:"ui-sub-control",children:[{type:"description"}]},{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[this._buildRichTextCustomFieldsSummary(e),{type:"attachments"},{type:"container",label:"comments",name:"comments container",cssClass:"ui-sub-control",isNestedTopContainer:!0,children:[{type:"label",text:"Comments",cssClass:"ui-ctrl-title"},{type:"comments"}]}]}]}]}]}),this.registerTab("Relations",{label:"relations",printable:!1,header:[{type:"label.relationCount",text:"Relations"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{name:"relations container",type:"relations.container"}]}]}]}),this.registerTab("Flow",{label:"implementationHistory",printable:!1,header:[{type:"label",text:"Flow"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"implementationHistory"}]}]}),this.registerTab("History",{label:"History",printable:!1,header:[{type:"label",text:"History"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"auditHistory",name:"audit history"}]}]}]}),this._registerMultipleEntitiesCustomFieldsTabs(e)},_registerPanels:function(e){this.registerPanel("Additional Info",{type:"collapsible",name:"additional info container",collapsed:!1,stateName:"additionalInfo",header:[{type:"label",text:"Info"}],items:[{type:"additionalInfo",children:this.getAdditionalInfoItems()}]}),this.registerPanel("Lead Cycle Time",{type:"collapsible",name:"Lead Cycle Time",stateName:"leadTime",collapsed:!1,header:[{type:"label",text:"Lead Cycle Time"}],items:[{type:"leadCycleTime"}]});
var t=this._buildCustomFieldsSummary(e);t.length&&this.registerPanel("Custom Fields",{type:"collapsible",name:"custom fields collapsible",collapsed:!1,stateName:"customFields",header:[{type:"label",text:"Custom Fields"}],items:t}),window.appIsInDebugMode&&this.registerPanel("Diagnostic",{type:"collapsible",name:"diagnostics container",printable:!1,collapsed:!0,header:[{type:"diagnostics"}],items:[{type:"collapsible",collapsed:!0,header:[{type:"label",text:"Global Bus Listeners"}],items:[{type:"diagnostics.globalListeners"}]},{type:"collapsible",collapsed:!0,header:[{type:"label",text:"Store Listeners"}],items:[{type:"diagnostics.store"}]}]})},getCollection:function(e){return e in this.collections||(this.collections[e]={}),this.collections[e]},getSpinnerConfigForLazy:function(){return{isShow:!0,selectorForHeight:".tau-page-entity"}},addToCollection:function(e,t,i){return this.getCollection(e)[t]=i,this},registerAction:function(e,t){t.alias=e,t.className=t.className||"",this.addToCollection("actions",e,t)},getActions:function(){var t=e.compact(this.getActionsAliases()),i=this.helper.collection(this.getCollection("actions")),n=[];return e.forEach(t,function(e){e in i&&n.push(i[e])}),n},getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},registerAdditionalInfoItem:function(t,i){i.field&&e.defaults(i.field,{name:t+" "+i.field.type}),i.label&&(i.label.type=i.label.type||"label",i.label.name=i.label.name||t+" "+i.label.type),this.addToCollection("additionalInfo",t,i)},getAdditionalInfoItems:function(){var t=this.getAdditionalInfoAliases(),i=this.helper.collection(this.getCollection("additionalInfo")),n=[];return e.forEach(t,function(e){e in i&&n.push(i[e])}),n},getAdditionalInfoAliases:function(){return[]},registerTab:function(e,t){this.addToCollection("tabs",e,t)},getTabsHeader:function(){return{type:"tabsHeader",options:{more:!0}}},getTabs:function(){var t=e.union(this.getTabsAliases(),this._getCustomFieldTabsAliases()),i=this.helper.collection(this.getCollection("tabs")),n=[];
return e.forEach(t,function(e){e in i&&n.push(i[e])}),n},getTabsAliases:function(){return["Description","Relations"]},_getCustomFieldTabsAliases:function(){return e.reduce(this.getCollection("tabs"),function(e,t,i){return t.isCustomFieldTab&&e.push(i),e},[])},registerPanel:function(e,t){this.addToCollection("panels",e,t)},getPanels:function(){var t=this.getPanelsAliases(),i=this.helper.collection(this.getCollection("panels")),n=[],a=this;return e.forEach(t,function(e){e in i&&("Additional Info"==e&&(i[e].items[0].children=a.getAdditionalInfoItems()),n.push(i[e]))}),n},getPanelsAliases:function(){return["Diagnostic","Additional Info","Custom Fields"]},_buildCustomFieldsSummary:function(t){for(var i=t.context,n=i.getCustomFields(),a=i.entity.entityType.name.toLowerCase(),r=e(n).select(function(e){return a===e.entityKind.toLowerCase()&&"richtext"!==e.type.toLowerCase()&&"multipleentities"!==e.type.toLowerCase()}),s=[],o=0;o<r.length;o++){var l=r[o],u=l.type.toLowerCase();"multipleselectionlist"===u&&(u="multiselect"),s.push({type:"customField."+u,customField:l})}return s},_buildRichTextCustomFieldsSummary:function(t){for(var i=t.context,n=i.getCustomFields(),a=i.entity.entityType.name.toLowerCase(),r=e.filter(n,function(e){return a===e.entityKind.toLowerCase()&&"richtext"===e.type.toLowerCase()}),s={type:"container",name:"custom fields container",isNestedTopContainer:!0,visible:r.length>0,children:[]},o=0;o<r.length;o++){var l=r[o];s.children.push({type:"label",text:l.name,cssClass:"ui-ctrl-title"}),s.children.push({type:"container",name:"custom field container for "+l.type.toLowerCase(),cssClass:"ui-sub-control",children:[{type:"customField."+l.type.toLowerCase(),customField:l}]})}return s},_registerMultipleEntitiesCustomFieldsTabs:function(t){var i=t.context,n=i.entity.entityType.name.toLowerCase(),a=e.filter(i.getCustomFields(),function(e){return n===e.entityKind.toLowerCase()&&"multipleentities"===e.type.toLowerCase()});e.forEach(a,function(e,t){this.registerTab(e.name,{label:"MultipleEntitiesCustomFieldEditor"+t,isCustomFieldTab:!0,header:[{type:"label",text:e.name,extensions:[s],customField:{name:e.name,type:e.type}}],items:[{type:"container",spinnerConfigForLazy:{isShow:!0,selectorForHeight:".tau-page-entity"},children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"customField.multipleEntities.container",customField:{name:e.name,type:e.type,value:e.value}}]}]}]})
},this)},getNames:function(e){return this.termProcessor.getTerms(e).names},getTermName:function(e){return this.termProcessor.getTerms(e).name},getEntityQuickAddOptions:function(){return{}},getEntityMenuOptions:function(){return{type:"menu.actions",items:this.getActions()}},getConfig:function(t){var i=e.uniqueId("entitygeneralinfo"),n=e.uniqueId("entityadditionalinfo");return this._mergeConfigRegistries(t,{children:[{type:"container",name:"main entity container",layout:"selectable",template:{name:"main.entity.container",engine:"jqote2",markup:["<div class=\"main-container <%= this.cssClass || '' %>\">",'<div id="'+i+'" class="general-info"></div>',this.helper.valueOrDefault({enabledIf:{modeIn:[a.FULL]},value:'<div id="'+n+'" class="additional-info"></div>'}),"</div>"]},children:this.helper.children([{type:"container",name:"general info column container",layout:"list",selector:"#"+i,cssClass:this.helper.valueOrDefault({enabledIf:{modeIn:[a.FULL]},disabledIf:{entityTypeIn:["team","project","testcaserun"]},value:"tau-sharelink-enabled"}),children:this.helper.children([{type:"breadcrumbs"},{type:"container",cssClass:"ui-popup-header",children:this.helper.children([{type:"title",editable:this.helper.valueOrDefault({enabledIf:{entityTypeIn:["testcaserun"]},value:!1,"default":!0})},{cssClass:"header-button-wrap",type:"container",children:this.helper.children([{type:"followButton",disabledIf:{entityTypeIn:["user","testcaserun","team"]},enabledIf:{feature:"follow"}},{enabledIf:{modeIn:[a.FULL]},disabledIf:{entityTypeIn:["team","project","testcaserun"]},type:"shareLink"}])}])},{type:"tabs",cssClass:"tau-tabs",stateName:"generalTab",tabsHeader:this.getTabsHeader(),tabs:this.getTabs(t),additionalHeaders:this.helper.containers([{type:"container",cssClass:"inner",children:this.helper.children([{enabledIf:{modeIn:[a.FULL]},type:"entity.menuTrigger",options:this.getEntityMenuOptions(t),className:"tau-tab-item-quick-add",printable:!1},{enabledIf:{modeIn:[a.FULL]},type:"entity.quickAddTrigger",options:this.getEntityQuickAddOptions(),className:"tau-tab-item-quick-add",printable:!1}])}])}])},{enabledIf:{modeIn:[a.FULL]},type:"container",name:"additional info column container",layout:"list",selector:"#"+n,spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"additional_lazy info column container",children:this.getPanels()}]}])},{name:"imagePreview",type:"attachmentsPreview"}]})
},_mergeConfigRegistries:function(t,i){return i.context=t.context,i.context.registry=e.extend(i.context.registry||{},this.getContainerRegistry(t),t.registry),i},getContainerRegistry:function(){return{componentConfigHelper:this.helper}}})}),define("tau/models/model.extensions",["Underscore"],function(){var e=function(e,t){for(var i=this,n=i.config.context,a=n.entity.entityType.name,r=[],s=0;s<e.length;s++)r.push(e[s]);var o={id:n.entity.id,fields:e},l={innerCallback:function(e){for(var i=e.data,n=0,a=0;a<r.length;a++)n+=i[r[a]];t.callback.call(t.scope,{count:n})}};i.store.get(a,o,{success:l.innerCallback,scope:l}).done()};return{calculateTagsCount:function(t){e.call(this,["tags-count"],t)},calculateBugsAndTasksCount:function(t){var i=[];this.config.context.isPracticeAvailable("Planning")&&i.push("tasks-count"),this.config.context.isPracticeAvailable("Bug Tracking")&&i.push("bugs-count"),e.call(this,i,t)},calculateTasksCount:function(t){e.call(this,["tasks-count"],t)},calculateBugsCount:function(t){e.call(this,["bugs-count"],t)},calculateUserStoriesAndBugsCount:function(t){var i=[];i.push("userStories-count"),this.config.context.isPracticeAvailable("Bug Tracking")&&i.push("bugs-count"),e.call(this,i,t)},calculateIterationsCount:function(t){e.call(this,["iterations-count"],t)},calculateReleasesCount:function(t){e.call(this,["releases-count"],t)},calculateFeaturesCount:function(t){e.call(this,["features-count"],t)},calculateRequestsCount:function(t){e.call(this,["requests-count"],t)},calculateImpedimentsCount:function(t){e.call(this,["impediments-count"],t)},calculateTimesCount:function(t){e.call(this,["times-count"],t)},calculateAttachmentsCount:function(t){e.call(this,["attachments-count"],t)},calculateCommentsCount:function(t){e.call(this,["comments-count"],t)},calculateTesCasesCount:function(t){e.call(this,["testCases-count"],t)},calculateTestPlanRunsCount:function(t){e.call(this,["testPlanRuns-count"],t)},calculateUserStoriesCount:function(t){e.call(this,["userStories-count"],t)
},calculateTestCaseRunsCount:function(t){e.call(this,["testCaseRuns-count"],t)},calculateRelatedEntitiesCount:function(t){e.call(this,["relatedEntities-count"],t)},calculateRequestersCount:function(t){e.call(this,["requesters-count"],t)}}}),define("tau/ui/extensions/assignmentsList/ui.extension.assignmentsList.overlay",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus afterRender":function(e){this.element=e.data.element;var t=this.action||function(){};t.call(this),this.action=function(){}},getWidget:function(){return this.element.parents(".ui-placeholder:first")},showOverlay:function(){this.getWidget().tauOverlay()},hideOverlay:function(){this.getWidget().tauOverlay("hide")},"bus markElementToBeUpdated":function(){this.showOverlay()},"bus updateElement":function(){this.action=function(){this.hideOverlay()}},"bus markElementToBeDeleted":function(){this.showOverlay()},"bus afterAssignmentRemoved":function(){this.hideOverlay()},"bus beforeSaveAssignment":function(){this.showOverlay()},"bus beforeAddAssignment":function(){this.showOverlay()}})}),define("tau/configurations/baseAssignable.container.config",["Underscore","tau/configurations/base.container.config","tau/models/model.extensions","tau/ui/extensions/assignmentsList/ui.extension.assignmentsList.overlay"],function(e,t,i,n){return t.extend({init:function(e){t.prototype.init.call(this,e);var i=e.context.entity,a=e.context.configurator.getUrlBuilder();this.registerAction("Move to User Story",{label:"Move to Another User Story",command:function(){this.moveOrCopy()},editions:["~board"]}),this.registerAction("Find Duplicate",{label:"Find Duplicate",command:function(){this.markAsDuplicate()},editions:["~board"]}),this.registerAction("Split",{disabledIf:{feature:"tp3.only"},label:"Split",command:function(){this.split()}}),this.registerAction("Create Bug",{label:"Create "+this.getTermName("bug"),url:a.getAddBugForRequestUrl(i.id),practices:["Bug Tracking"]}),this.registerAction("Create Task",{label:"Create "+this.getTermName("task"),url:a.getAddTaskForRequestUrl(i.id)}),this.registerAction("Create User Story",{label:"Create "+this.getTermName("userStory"),url:a.getAddUserStoryForRequestUrl(i.id)}),this.registerAction("Create Feature",{label:"Create "+this.getTermName("feature"),url:a.getAddFeatureForRequestUrl(i.id),practices:["Requirements"]}),this.registerTab("Time",{enabledIf:{isBoard:!0},label:"times",header:[{type:"label.baseAssignable.timecount",text:"Time",countFieldNames:["times"]}],items:[{name:"Times",type:"entity.new.list",practices:["Time Tracking"],definition:{cells:{types:["time"]},cardSettings:{list_time:{list:[[{id:"unit_time",order:0},{id:"t_user_details",order:1},{id:"t_spent_remain",order:2},{id:"t_work_on",order:3},{id:"t_description_1line",order:4},{id:"action_delete",order:5}]]}}},lazy:!0,spinnerConfigForLazy:this.getSpinnerConfigForLazy()}]}),this.registerTab("Tp2 Time",{disabledIf:{isBoard:!0},label:"time",header:[{type:"label",text:"Time"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Time Tracking"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Time Tracking"],children:[{type:"collapsible",name:"time list collapsible",stateName:"times",collapsed:!1,header:[{type:"label",text:"Time records"}],items:[{type:"timeList"}]}]}]}],practices:["Time Tracking"]}),this.registerTab("Source",{label:"source",header:[{type:"label",text:"Source",practices:["Source Control"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Source Control"],children:[{type:"container",practices:["Source Control"],lazy:!0,children:[{type:"revisionList",practices:["Source Control"]}]}]}]}),this.registerPanel("Progress Bar",{type:"progressBar"}),this.registerPanel("Assignments",{type:"collapsible",stateName:"assignments",collapsed:!1,header:[{type:"label",text:"Assignments"}],items:[{type:"assignmentsList",extensions:[n]}]})
},getActionsAliases:function(){return["-----","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Release","Iteration"]},getTabsAliases:function(){return["Description","Source","Relations","Flow","Time","Tp2 Time","History"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Impediments","Assignments","Additional Info","Custom Fields"]}})}),define("tau/components/extensions/extension.labelRefresher.base",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({eventName:null,propertyListForEvict:[],init:function(){var t=this;t._super.apply(t,arguments),e.isArray(t.eventName)||(t.eventName=[t.eventName]);var i=t.bus.getGlobalBus();e(t.eventName).each(function(e){i.on(e,t.eventHandler,t)}),i.on("bugWasMarkedAsDuplicate",t.onBugWasMarkedAsDuplicate,t)},destroy:function(){var t=this,i=t.bus.getGlobalBus();e(t.eventName).each(function(e){i.removeListener(e,t.eventHandler,t)}),i.removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refresh:function(){var e=this.config.context.entity;this.config.store.evictProperties(e.id,e.entityType.name,this.propertyListForEvict),this.fire("refresh")},onBugWasMarkedAsDuplicate:function(e){var t=this.config?this.config.context.entity.id:null;t===e.data.bugId&&this.refresh()},eventHandler:function(e){this.isEntityInContext(e)&&this.refresh()}})}),define("tau/components/extensions/requestsList/extensions.requestList.labelRefresher",["tau/components/extensions/extension.labelRefresher.base"],function(e){return e.extend({eventName:["requestWasAttachedToEntity","requestIsDetachedFromEntity"],propertyListForEvict:["requests-count"]})}),define("tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher",["tau/components/extensions/extension.labelRefresher.base"],function(e){return e.extend({eventName:"testCase.items.added",propertyListForEvict:["testCases-count"]})}),define("tau/components/extensions/entity/extension.requestList.remover",["Underscore","tau/core/model-base","tau/models/model.extensions"],function(e,t,i){return t.extend({init:function(){this._super.apply(this,arguments),this.hideElementIfHelpDeskPracticeIsOff(this.config.context)
},hideElementIfHelpDeskPracticeIsOff:function(e){this.store=this.config.context.configurator.getStore(),e.isPracticeAvailable("Help Desk")<0&&(this.bus.getGlobalBus().on("requestWasAttachedToEntity",this._updateRefresh,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this._updateRefresh,this),this.bus.on("afterRender",this._update,this))},_updateRefresh:function(){var e=this.config.context;this.config.store.evictProperties(e.entity.id,e.entity.entityType.name,["requests-count"]),this._update()},_update:function(){i.calculateRequestsCount.call(this,{callback:function(e){var t=e.count,i=this.$el;t>0?i.show():i.hide()},scope:this})},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this._updateRefresh,this),this._super()},"bus afterRender":function(e){this.$el=e.data.element}})}),define("tau/models/dataprocessor/model.processor.assignments",["Underscore","tau/utils/utils.translation"],function(e,t){return{getAssignmentsForRole:function(t,i){return e.select(i.assignments,function(e){return e.role.id==t.id})},getAssignments:function(i){for(var n={groups:[]},a=i.roleEfforts,r=0;r<a.length;r++){for(var s=a[r].role,o={role:{id:s.id,name:t.shorten(s.name),fullName:s.name},users:[]},l=this.getAssignmentsForRole(s,i),u=0;u<l.length;u++){var c=l[u].generalUser,d=[];c.firstName?(d.push(c.firstName),c.lastName&&d.push(e.asString(c.lastName).substring(0,1)+".")):d.push(c.lastName?c.lastName:c.email),o.users.push({id:c.id,name:e.trim(d.join(" ")),assignmentId:l[u].id,avatarUri:c.avatarUri})}n.groups.push(o)}return n}}}),define("tau/models/dataprocessor/model.processor.importance",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e,t){this.min=e,this.max=t},getKind:function(e){var t="medium";return e==this.min?t="high":e==this.max&&(t="low"),t}});return i}),define("tau/models/dataProviders/model.provider.items.base",["Underscore","jQuery","tau/core/class","tau/models/dataprocessor/model.processor.assignments","tau/models/dataprocessor/model.processor.importance"],function(e,t,i,n,a){var r=i.extend({init:function(e){this.config=e,this.fields={generalUser:["id","firstName","lastName","avatarUri","email"],entityState:["id","name","isInitial","isFinal","numericPriority",{role:["id","name"]}],entityStateWithComment:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]},{role:["id","name"]}]}
},_chainResponse:function(e){var i=t.Deferred();return i.done(e),i.resolve},_createDetailCommand:function(e){var t={};return t[e]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:this.fields.entityState},{roleEfforts:["id",{role:["id","name"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]}],t},_createQuery:function(){return{}},_processAssignments:function(t){var i=n.getAssignments(t);return e.forEach(i.groups,function(t){e.forEach(t.users,function(e){e.avatarUrl=e.avatarUri+"24"})}),i},_processTags:function(t){return t.tags?e.isArray(t.tags)?t.tags:t.tags.toString().split(", "):[]},_calculateEffortToMaximum:function(t){if(0==t.length)return t;var i=e.max(t,function(e){return e.effort.total}),n=i.effort.total;return e.forEach(t,function(e){e.effort.percentFromCount=t.length,e.effort.percentFromMaximum=0==n?0:Math.round(e.effort.total/n*100)}),t},_convertData:function(t){var i=t,n=[],a=this;return e.forEach(i,function(e){var t=e.__type.toLowerCase(),i=e.entityType?e.entityType.name.toLowerCase():"";"solution"!==t&&"solution"!==i&&n.push(a._convertItem(e))}),n},_convertItem:function(e){return{id:e.id,name:e.name,numericPriority:e.numericPriority,__type:e.__type,entityState:{id:e.entityState.id,name:e.entityState.name},tags:this._processTags(e),effort:this._getEffortData(e),assignments:this._processAssignments(e),severity:{id:e.severity.id,name:e.severity.name}}},_getEffortData:function(e){var t={estimated:e.effort,spent:e.effortCompleted,remain:e.effortToDo};return t.total=t.spent+t.remain,t.percentComplete=0===t.total?0:Math.round(t.spent/t.total*100),t.percentFromMaximum=0,t.timeSpent=Math.round(100*e.timeSpent)/100,t.timeRemain=Math.round(100*e.timeRemain)/100,t.unit=this.config.context.getEffortPoint(e.__type),t},_getAssignedEffort:function(t){var i={},n=0,a=0,r=function(e){n+=e.effortToDo,a+=e.effortCompleted};return e.each(t.userStories,r),e.each(t.bugs,r),i.value=Math.round(100*(n+a))/100,i.unit=this.config.context.getEffortPoint(t.__type),i
},_getVelocityData:function(e){return{value:e.velocity,unit:this.config.context.getEffortPoint(e.__type)}},_fetch:function(t,i,n,r){var s=this.config.context,o=s.entity.entityType.name,l=s.entity.id,u=this.config.store,c=this._createDetailCommand(t),d=this._createQuery(t),p={id:l,nested:!0,fields:[c],$query:d},f=this,m=function(n){var a=n[0].data[t];e.map(a,function(e){e.__type=i});var s=f._convertData(a);r(s)};n&&(u=u.get(n,{fields:["id","importance"]}),m=function(n){var s=e(n[0].data).pluck("importance"),o=e.min(s),l=e.max(s);f.importanceProcessor=new a(o,l);var u=n[1].data[t];e.map(u,function(e){e.__type=i});var c=f._convertData(u);r(c)}),u=u.get(o,p),u.done({success:f._chainResponse(m),scope:f})},_sortByPriority:function(t){var i=e.max(t,function(e){return e.numericPriority||0});return i=i?i.numericPriority:0,e.sortBy(t,function(e){var t=e.numericPriority||0;return e.entityState.isFinal===!0&&(t+=i+1),t})},changePriority:function(t,i,n,a){var r=this.config.store;r.evictProperties(t.id,t.__type,["numericPriority"]);var s=[];s.push(function(e){r.save("prioritizer",{id:t.id,$set:{beforeId:n.id,afterId:i.id}}).done({success:function(){e(null,arguments)}})}),s.push(function(e){r.get(t.__type,{id:t.id,fields:["id","numericPriority"]}).done({success:function(t){e(null,t[0].data)}})}),e.series(s,function(t,i){e.isFunction(a)&&a.call(null,{changed:i[1]})})}});return r}),define("tau/models/dataProviders/model.provider.items.bugs",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("bugs","bug","severity",e)},_createDetailCommand:function(t){var i={};i[t]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{severity:["id","name","importance"]}];
var n={project:["id"]};return this.config.multiprojects&&n.project.push("abbreviation"),i[t].push(n),this.config.additionalFields&&e.indexOf(this.config.additionalFields,"iteration")>-1&&i[t].push({iteration:["id","name"]}),i},_convertData:function(e){return e=this._super(e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(t){var i=this;t.project=t.project||{};var n={id:t.id,name:t.name,numericPriority:t.numericPriority,__type:t.__type,entityState:{id:t.entityState.id,name:t.entityState.name,isInitial:t.entityState.isInitial,isFinal:t.entityState.isFinal,numericPriority:t.entityState.numericPriority},tags:this._processTags(t),effort:this._getEffortData(t),assignments:this._processAssignments(t),severity:{id:t.severity.id,name:t.severity.name,kind:i.importanceProcessor.getKind(t.severity.importance)},projectId:t.project.id,entitiesCount:0,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.__type,!0)};return this.config.multiprojects&&(n.project={id:t.project.id,abbreviation:t.project.abbreviation}),this.config.additionalFields&&e.indexOf(this.config.additionalFields,"iteration")>-1&&(n.iteration={id:t.iteration?t.iteration.id:null,name:t.iteration?t.iteration.name:null}),n}})}),define("tau/models/dataProviders/model.provider.items.tasks",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("tasks","task","priority",e)},_createDetailCommand:function(e){var t={};return t[e]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{userStory:["id"]},{entityState:this.fields.entityState},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{priority:["id","name","importance"]},{project:["id"]}],t},_convertItem:function(e){e.project=e.project||{};var t={id:e.id,name:e.name,numericPriority:e.numericPriority,__type:e.__type,entityState:{id:e.entityState.id,name:e.entityState.name,isInitial:e.entityState.isInitial,isFinal:e.entityState.isFinal,numericPriority:e.entityState.numericPriority},tags:this._processTags(e),effort:this._getEffortData(e),assignments:this._processAssignments(e),priority:null,projectId:e.project.id,entitiesCount:0};
return t}})}),define("tau/models/dataProviders/model.provider.items.tasks_bugs",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.bugs","tau/models/dataProviders/model.provider.items.tasks"],function(e,t,i,n){return t.extend({init:function(e){this.config=e,this.providers=[new n(e)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new i(e))},_convertData:function(e){return e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},fetch:function(t){var i=this,n=function(e){var n=i._convertData(e);t(n)},a=[];e.forEach(i.providers,function(e){a.push(function(t){e.fetch(function(e){t(null,e)})})}),e.parallel(a,function(t,i){var a=e.flatten(i);n(a)})}})}),define("tau/models/dataProviders/model.provider.groups.base",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(e){this.config=e},_mergeGroups:function(t){var i=null;return t.length&&(i={key:[],items:[],title:[],isInitial:!1,isPlanned:!1,isFinal:!1,realGroups:[]},e.forEach(t,function(e){i.key.push(e.key),i.title.push(e.title?e.title:e.key),i.isInitial=!!e.isInitial,i.isPlanned=!!e.isPlanned,i.isFinal=!!e.isFinal,i.realGroups=i.realGroups.concat(e.realGroups)})),i},_fetchState:function(t,i,n){var a=this,r=e(i).isFunction()?i:function(t){var n=a.config.context.getProcess(),r=t.entityType.name.toLowerCase();return t.process.id===n.id&&e.indexOf(i,r)>-1},s=this.config.store,o=["id","name","isFinal","isInitial","isPlanned","isCommentRequired","numericPriority",{entityType:["id","name"]},{process:["id"]},{nextStates:["id"]}],l={list:!0,fields:o};s=s.get("entityStates",l),s.done({success:function(t){var i=t[0].data;i=e(i).filter(r);var s=e.groupByComplex(i,function(e){return e.name});s=this._sortByState(s),e.forEach(s,function(t){t.collapsed=!!t.items[0].isFinal,t.isFinal=!!t.items[0].isFinal,t.isInitial=!!t.items[0].isInitial,t.isPlanned=!!t.items[0].isPlanned,t.realGroups=e.clone(t.items),t.items=[],delete t.stateWeight
});var o=e.select(s,function(e){return e.isInitial}),l=e.select(s,function(e){return!e.isInitial&&e.isPlanned}),u=e.select(s,function(e){return!e.isInitial&&!e.isFinal&&!e.isPlanned}),c=e.select(s,function(e){return!e.isInitial&&e.isFinal&&!e.isPlanned});s=[];var d=null;o.length&&(d=a._mergeGroups(o),s.push(d)),l.length&&(d=a._mergeGroups(l),s.push(d)),s=s.concat(u),c.length&&(d=a._mergeGroups(c),s.push(d)),e.forEach(s,function(t){t.collapsed=!!t.isFinal,t.title&&e.isArray(t.title)&&(t.title=t.title.join(", ")),e.isArray(t.key)&&1==t.key.length&&(t.key=t.key.pop()),delete t.isFinal,delete t.isInitial,delete t.isPlanned}),n(s)},scope:this})},_sortByState:function(t){return e.forEach(t,function(t){var i=[];e.forEach(t.items,function(e){i.push(e.numericPriority)});var n=e.sum(i),a=n?n/i.length:0;t.stateWeight=a}),t=e.sortBy(t,function(e){return e.stateWeight})},moveToGroup:function(){},_moveToGroupByState:function(t,i,n,a){var r=this.config.store,s=e.find(n.realGroups,function(e){return e.id==t.entityState.id}),o=e.find(i.realGroups,function(e){return e.entityType.name.toLowerCase()==t.__type.toLowerCase()&&e.process.id==s.process.id});if(!o||o.id==s.id)return void a.call(null);var l=[];l.push(function(e){r.save(t.__type,{id:t.id,$set:{entityState:{id:o.id}},fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(){e(null,arguments)}})}),l.push(function(e){r.get(t.__type,{id:t.id,fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(t){e(null,t[0].data)}})}),e.series(l,function(t,i){e.isFunction(a)&&a.call(null,{changed:i[1]})})},isAvailableForItem:function(){return!0},getCommentRequirements:function(){return[]}})}),define("tau/models/dataProviders/model.provider.groups.tasks_bugs",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(e,t){return t.extend({fetch:function(t,i,n){var a={tasks:[],bugs:[]},r=e(i).select(function(e){return"task"===e.__type}),s=e(i).select(function(e){return"bug"===e.__type});
a.tasks=e(r).chain().pluck("projectId").uniq().value(),this.config.context.isPracticeAvailable("Bug Tracking")&&(a.bugs=e(s).chain().pluck("projectId").uniq().value());var o=this.config.store,l=this;o.get("projects",{fields:[{process:["id"]}],list:!0}).done({success:function(i){var r=i[0].data,s={tasks:[],bugs:[]};e.forEach(a,function(t,i){s[i]=e(r).chain().select(function(i){return e(t).include(i.id)}).map(function(e){return e.process.id}).uniq().value()});var o=function(t){var i=(t.entityType.name||"").toLowerCase(),n=t.process.id;return"task"===i&&e(s.tasks).include(n)||"bug"===i&&e(s.bugs).include(n)};return l._fetchState(t,o,n)}})},moveToGroup:function(e,t,i,n){return this._moveToGroupByState(e,t,i,n)},isAvailableForItem:function(t,i,n){var a=e.find(n.realGroups,function(e){return e.id==t.entityState.id}),r=e.find(i.realGroups,function(e){return e.entityType.name.toLowerCase()==t.__type.toLowerCase()&&e.process.id==a.process.id}),s=e.pluck(a.nextStates,"id");return s.push(a.id),r&&e.include(s,r.id)},getCommentRequirements:function(t,i,n){var a=e.find(n.realGroups,function(e){return e.id==t.entityState.id}),r=[];return e.forEach(i,function(i){var n=e.find(i.realGroups,function(e){return e.entityType.name.toLowerCase()==t.__type.toLowerCase()&&e.process.id==a.process.id});r.push({isCommentRequired:n?n.isCommentRequired:!1})}),r}})}),define("tau/ui/extensions/list/extension.list.refresher",["tau/components/extensions/component.extension.base"],function(e){return e.extend({ENTITY_PROPS_MAP:{userStory:["tasks","bugs"],feature:["bugs"]},"bus afterInit":function(){if(!this.signedUp){this.signedUp=!0;var e=this.config.context.entity,t=e.entityType.name,i=this.config.store;this._refresher||(this._refresher=function(){i.evictProperties(e.id,t,this.ENTITY_PROPS_MAP[t]),this.fire("refresh")}.bind(this),i.unbind(this),i.on({eventName:"afterSave",type:t,listener:this,filter:{id:e.id},hasChanges:["entityState"]},this._refresher))}},"bus destroy":function(){this.config.store.unbind(this),delete this._refresher,this._super.apply(this,arguments)
}})}),define("tau/models/dataProviders/userstory/userstory.model.provider.testcases.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e){this._fetch("testCases","testCase","priority",e)},_convertData:function(t){return t=this._super(t),e.sortBy(t,function(e){var t=e.numericPriority||0;return t})},_createDetailCommand:function(e){var t={};return t[e]=["id","name","tags","lastStatus","lastRunDate","description","numericPriority"],t},_convertItem:function(e){var t={id:e.id,__type:e.__type,name:e.name,tags:[],lastStatus:e.lastStatus?"passed":"failed",lastRunDate:i.format.datetime.short(i.convertToTimezone(e.lastRunDate)),description:e.description,numericPriority:e.numericPriority,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};return t}})}),define("tau/ui/extensions/list/collapse/extension.list.actions.collapse",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({_toggle:function(t,i){e.isBoolean(i)?(t.find(".tau-list__itemexpander").toggleClass("tau-list__itemexpander_state_open",i).toggleClass("tau-list__itemexpander_state_closed",!i),t.find(".tau-list__table-additional").toggleClass("tau-list__table-additional_state_open",i).toggleClass("tau-list__table-additional_state_closed",!i)):(t.find(".tau-list__itemexpander").toggleClass("tau-list__itemexpander_state_open").toggleClass("tau-list__itemexpander_state_closed"),t.find(".tau-list__table-additional").toggleClass("tau-list__table-additional_state_open").toggleClass("tau-list__table-additional_state_closed"))},"bus afterRender":function(e,t){var i=t.element;this.$el=i;var n=i.find("[role=item]"),a=this;i.delegate("[role=item-expander-all]","click",function(){a._toggle(n,!0)}),i.delegate("[role=item-collapser-all]","click",function(){a._toggle(n,!1)}),i.delegate("[role=item-expander]","click",function(){var e=$(this),t=e.parents("[role=item]:first");
a._toggle(t)})}})}),define("tau/ui/extensions/list/testcases/extension.list.testcases.actions",["Underscore","tau/ui/extensions/list/collapse/extension.list.actions.collapse"],function(e,t){return t.extend({"bus prioritize.start":function(){var e=this.$el.find(".ui-richeditor:visible");e.length&&e.prev().richeditor("hideEditor")},"bus preDataBind":function(e){var t=e.data;t.labelAdd=this.config.labelAdd||"Add"},"bus testCaseWasAdded":function(){this.fire("evictTestCases")},"bus evictTestCases":function(){var e=this.config.context.entity;this.config.context.configurator.getStore().evictProperties(e.id,e.entityType.name,["testCases","testCases-count"]),this.fire("refresh")},"bus afterRender":function(t,i){this._super(t,i);var n=i.element;this.$el=n;var a=this,r=this.config.context.configurator.getStore(),s=function(e,t){r.save("testcase",{id:e.id,$set:{lastStatus:t,lastFailureComment:null},fields:["id","lastStatus","lastRunDate"]}).done({success:function(){}})},o=e.bind(this.addTestCaseClickHandler,this);n.delegate("[role=action-add]","click",function(e){e.preventDefault(),e.stopPropagation(),o(e)}),n.delegate("[role=action-pass]","click",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents("[role=item]:first"),i=t.data("tmplItem").data;s(i,!0),a._toggle(t,!1);var n=t.next("[role=item]");n.length&&a._toggle(n,!0)}),n.delegate("[role=action-fail]","click",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents("[role=item]:first"),i=t.data("tmplItem").data,n=!1;s(i,n),a._toggle(t,!1);var r=t.next("[role=item]");r.length&&a._toggle(r,!0)})},addTestCaseClickHandler:function(e){this.bus.fire("action.add",{originalEvent:e,entity:this.config.context.entity})}})}),define("tau/ui/tags/ui.tag.term",["Underscore","jQuery","tau/core/termProcessor"],function(e,t,i){return t.extend(t.tmpl.tag,{term:{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while($__t.parent && !$__t.$tau){$__t = $__t.parent}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")}}),{register:function(e,t){var n=e.context&&e.context.getTerms?e.context.getTerms():[],a=new i(n);
t.$tau=t.$tau||{},t.$tau.terms=function(e){return a.getTerms(e)}}}}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.progress",["tau/core/templates-factory"],function(e){var t=["{{if !$item.parent.parent.data.config.currentView.timeTrackingPolicies.disableSpentRemain}}","Time spent: ${timeSpent}{{if timeSpent}}h{{/if}}  ","Time remain: {{if !timeRemain && timeRemain !== 0}}N/A{{else}}${timeRemain}{{if timeRemain}}h{{/if}}{{/if}}  ","{{/if}}","Percent complete: ${percentComplete}%"].join(""),i={name:"cell-progress",markup:["{{if $item.textMode}}",'<div class="tau-extension-tooltip" title="'+t+'">',"${Math.round(percentComplete)}%","</div>","{{else}}",'<div{{if percentFromMaximum == 0}} class="tau-extension-tooltip" title="'+t+'"{{/if}}>',"{{if percentFromMaximum > 0}}",'    <div class="ui-progress-bar-progress ui-progressbar__progress tau-extension-tooltip" style="width:${percentFromMaximum}%;" title="'+t+'">','        <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${percentComplete}%;{{if percentComplete == 0}}display:none;{{/if}}"></span>',"    </div>","{{/if}}","</div>","{{/if}}"]};return e.register(i)}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.assignments",["tau/core/templates-factory"],function(e){var t={name:"cell-assignments",markup:['<span class="ui-assignment__group">','<span class="ui-assignment__group__title tau-extension-tooltip" title="${role.fullName}">${role.name}</span>',"{{if users.length}}",'<span class="ui-assignment__group__users">',"{{each users}}",'<span class="ui-assignment__user">','<img style="width:24px; height:24px;" src="${avatarUrl}" alt="${name}" title="${name}" />',"</span>","{{/each}}","</span>","{{else}}",'<span class="ui-assignment__group__unassigned">Unassigned</span>',"{{/if}}","</span>"]};return e.register(t)}),define("tau/ui/templates/title/ui.template.title.simple",["tau/core/templates-factory"],function(e){var t={name:"title.simple",engine:"jqote2",markup:['<div class="ui-title ui-title_type_simple">','<div class="ui-title__title i-role-title"><%! this.name %></div>',"</div>"],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.name",["tau/core/templates-factory","tau/ui/templates/title/ui.template.title.simple"],function(e){var t={name:"cell-name",markup:['<span class="tau-title-container">','<div class="tau-title tau-list-field-slot" title="${name}" runas="title" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="title.simple">${name}</div>',"</span>",'{{if typeof tags !== "undefined" && tags && tags.length}}','   <span class="tau-tags">${tags[0]}</span>','   {{if tags.length > 1}}<span class="tau-tags">&#133;</span>{{/if}}',"{{/if}}"]};return e.register(t)}),define("tau/ui/tags/ui.tag.abbr",["jQuery","tau/utils/utils.translation"],function(e,t){return e.extend(e.tmpl.tag,{abbr:{open:["var $__t = $item;","while($__t.parent && !$__t.$tau){$__t = $__t.parent}","_=_.concat($__t.$tau.abbr($2));"].join("")}}),{register:function(e,i){i.$tau=i.$tau||{},i.$tau.abbr=t.shorten.bind(t)}}}),define("tau/ui/templates/common/ui.template.userIcon",["tau/core/templates-factory"],function(e){return e.register({name:"ui.template.userIcon",markup:["{{if $item.showUser}}",'<span class="ui-assignment__user user tau-avatar_${id}"  userId="${id}">','   <img src="${avatar}" style="width:24px; height:24px;" alt="${name}" title="${name}" class="user-name" />',"</span>","{{/if}}","{{if $item.showEllipsis}}",'   <span class="ui-assignment__user ui-assignment__user_count">+${$item.count}</span>',"{{/if}}"].join(""),dependencies:[]})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList.mini",["tau/core/templates-factory","tau/ui/tags/ui.tag.abbr","tau/ui/templates/common/ui.template.userIcon","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(e,t){var i={name:"ui.template.assignmentsList.userList.mini",tags:[t],dependencies:["assignments-add-btn","ui.template.userIcon"],markup:['<div class="ui-assignment__group group" roleId="${role.id}">','<span class="ui-assignment__group__title">','<span class="tau-extension-tooltip" title="{{= role.name}}">{{abbr(role.name)}}</span>',"</span>","{{if users.length}}",'<span class="ui-assignment__group__users">',"{{each users}} ","{{if $index < 2}}",'{{tmpl($value,{showUser:true}) "ui.template.userIcon"}}',"{{/if}}","{{if $index == 2}}",'{{tmpl($value,{showEllipsis:true,count:users.length-2}) "ui.template.userIcon"}}',"{{/if}}","{{/each}}","</span>","{{/if}}","{{if allowAdd}}",'<span class="ui-assignment__group__unassigned">{{tmpl "assignments-add-btn"}}</span>',"{{/if}}","</div>"]};
return e.register(i)}),define("tau/ui/templates/assignmentsList/ui.template.assignments.mini",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList.mini"],function(e){var t={name:"ui.template.assignments.mini",markup:['<div class="assignments-table-readonly">','<div class="user-list">{{tmpl(assignments.groups) "ui.template.assignmentsList.userList.mini"}}</div>',"</div>"].join(""),dependencies:["ui.template.assignmentsList.userList.mini"]};return e.register(t)}),define("tau/ui/templates/property.effort/ui.template.property.effort.content",["tau/core/templates-factory"],function(e){var t="Estimated effort: ${effort}{{if effort}}${unit.shortName}{{/if}}",i={name:"ui.template.property.effort.content",markup:[' <div class="tau-extension-tooltip" title="'+t+'">','   <div class="entity-effort">${effort}<span class="entity-effort-info">${unit.shortName}</span></div>',"</div>"],dependencies:[]};return e.register(i)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__row",markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"   <tbody>",'       <tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a href="${url}"><em class="tau-entity-icon tau-entity-icon--${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','   {{tmpl($item.data) "cell-name"}}',"</td>","{{if $item.parent.data.config.currentView.multiprojects}}","   {{if project}}",'   <td class="tau-list__table__cell tau-list__table__cell-project">${project.abbreviation}</td>',"   {{else}}",'   <td class="tau-list__table__cell  tau-list__table__cell-project">&nbsp;</td>',"   {{/if}}","{{/if}}","{{if visibleEntityState}}",'   <td class="tau-list__table__cell tau-list__table__cell-state">','       <div runas="property.entityState" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${visibleEntityState.name}</div>',"   </td>","{{/if}}","{{if severity}}",'   <td class="tau-list__table__cell tau-list__table__cell-severity">','       <span runas="property.severity" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" class="tau-list-severity-${severity.kind}">${severity.name}</span>',"   </td>","{{else priority}}",'   <td class="tau-list__table__cell tau-list__table__cell-priority">','       <span class="tau-list-priority-${priority.kind}" runas="property.priority" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${priority.name}</span>',"   </td>","{{/if}}","{{if effortMock}}",'   <td class="tau-list__table__cell tau-list__table__cell-effort">',"   </td>",'   <td class="tau-list__table__cell tau-list__table__cell-progress">',"   </td>","{{/if}}","{{if effort}}",'   <td class="tau-list__table__cell tau-list__table__cell-effort">','      <div class="tau-list-field-slot" runas="property.effort" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-entities-count="${entitiesCount}">','        {{tmpl({effort: effort.estimated, unit: effort.unit}) "ui.template.property.effort.content"}}',"      </div>","   </td>",'   <td class="tau-list__table__cell tau-list__table__cell-progress tau-list__table__cell-progress-text-mode">','       <div runas="progressBar.small"',' data-text-mode="true"',' data-items-count="${effort.percentFromCount}"',' data-max-width-percents="${effort.percentFromMaximum}"',' data-context:general:id="${id}"',' data-context:general:entity-type:name="${__type}"',">",'           {{tmpl(effort, {textMode: true}) "cell-progress"}}',"       </div>","   </td>","{{/if}}","{{if responsible}}",'<td class="tau-list__table__cell tau-list__table__cell-responsible">','    <div class="tau-responsible"> <span class="tau-label">Res.</span><span class="tau-responsible-component"><span class="tau-list-responsible" runas="property.responsible" data-hidename="true" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${responsible.firstName}</span></span></div>',"</td>","{{/if}}","{{if assignments}}",'<td class="tau-list__table__cell tau-list__table__cell-assignments">','   <div class="tau-list-field-slot" runas="assignmentsList" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.assignments.mini">{{tmpl(assignments.groups) "cell-assignments"}}</div>',"</td>","{{/if}}","{{if velocity}}",'   <td class="tau-list__table__cell tau-list__table__cell-velocity">${velocity.value}&nbsp;${velocity.unit.shortName}</td>',"{{/if}}","{{if assignedEffort}}",'   <td class="tau-list__table__cell tau-list__table__cell-assignedEffort">','   <div class="tau-extension-tooltip" title="Assigned Effort: ${assignedEffort.value}&nbsp;${assignedEffort.unit.shortName}">',"       <div>${assignedEffort.value}&nbsp;${assignedEffort.unit.shortName}</div>","   </div>","   </td>","{{/if}}","{{if startDate}}",'   <td class="tau-list__table__cell tau-list__table__cell-date">${startDate}</td>',"{{/if}}","{{if endDate}}",'   <td class="tau-list__table__cell tau-list__table__cell-date">${endDate}</td>',"{{/if}}",'   <td class="tau-list__table__cell tau-list__table__cell-actions">','<div class="tau-list-field-slot" ','runas="entity.menuTrigger" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-options:external="true"',">","</div>","   </td>",'<td class="tau-list__table__cell tau-list__table__cell-quickadd">','<div class="tau-list-field-slot" ','runas="entity.quickAddTrigger" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-options:external="true"',">","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e,t){var i={name:"list-grid-entity__rowtestplanrun",tags:[t],markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a class="tau-entitylink" href="${url}" title="${name}"><em class="tau-entity-icon tau-entity-icon--${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-stat">','<div class="tau-testCasesRunResults">','<div class="tau-testCasesRunResults-container">','<span title="Passed" class="tau-testCasesRunResults-item tau-testCasesRunResults-passed">${passedCount}</span>','<span title="Failed" class="tau-testCasesRunResults-item tau-testCasesRunResults-failed">${failedCount}</span>','<span title="Not Run" class="tau-testCasesRunResults-item tau-testCasesRunResults-notRun">${notRunCount}</span>',"</div>","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-release">','<div runas="property.release" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-show-url="false" data-placeholder-text="assign to {{term("release") "name"}}">',"{{if release}}","${release.name}","{{/if}}","</div>","</td>","{{if isAvailableIteration}}",'<td class="tau-list__table__cell tau-list__table__cell-iteration">','<div runas="property.iteration" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-show-url="false"  data-placeholder-text="assign to {{term("iteration") "name"}}">',"{{if iteration}}","${iteration.name}","{{/if}}","</div>","</td>","{{/if}}",'<td class="tau-list__table__cell tau-list__table__cell-build">','<div runas="property.build.testPlanRun" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-show-url="false"  data-placeholder-text="assign to {{term("build") "name"}}">',"{{if build}}","${build.name}","{{/if}}","</div>","</td>","{{if assignments}}",'<td class="tau-list__table__cell tau-list__table__cell-assignments" >','   <div runas="assignmentsList" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.assignments.mini">{{tmpl(assignments.groups) "cell-assignments"}}</div>',"</td>","{{/if}}",'<td class="tau-list__table__cell tau-list__table__cell-additionalactions" >','<div runas="menu.testPlanRun" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}"></div>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-actions" >','<div class="tau-list-field-slot" ','runas="entity.menuTrigger" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-options:external="true"',">","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-quickadd" >','<div class="tau-list-field-slot" ','runas="entity.quickAddTrigger" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-options:external="true"',">","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(i)}),define("tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__rowtestcaserun",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${testcase.id} tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-expander tau-list__itemexpander tau-list__itemexpander_state_closed"  role="item-expander" ><div class="tau-list__itemexpander__indicator "></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a class="tau-entitylink" href="${testcase.url}" title="${testcase.name}"><em class="tau-entity-icon tau-entity-icon--testcase">${testcase.id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','{{tmpl($item.data.testcase) "cell-name"}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-priority">','<span class="tau-list-priority-${testcase.priority.kind}" runas="property.priority" data-context:general:id="${testcase.id}" data-context:general:entity-type:name="${testcase.__type}">',"${testcase.priority.name}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-laststatus">',"<div>",'<div class="ui-status {{if passed === true}}ui-status_type_passed green{{/if}}{{if passed === false}}ui-status_type_failed red{{/if}}{{if passed === null}}ui-status_type_na grey{{/if}}">',"{{if runDate !== null}}","{{if passed === true}}","Passed","{{/if}}","{{if passed === false}}","Failed","{{/if}}","{{if passed === null}}","Skipped","{{/if}}","{{/if}}","</div>","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-actions" >','<div class="tau-list-field-slot" ','runas="entity.menuTrigger" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-options:external="true"',">","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-quickadd" >','<div class="tau-list-field-slot" ','runas="entity.quickAddTrigger" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-options:external="true"',">","</div>","</td>","</tr>","</tbody>","</table>",'<table class="tau-list__table tau-list__table-additional tau-list__table-additional_state_closed">',"<tbody>","<tr>",'<td class="tau-list__table__cell tau-list__table__cell-dragdrop"></td>','<td class="tau-list__table__cell tau-list__table__cell-expander-additional"></td>','<td class="tau-list__table__cell">','<div class="ui-hide-empty-description">','<div runas="testStepRunList" data-editable="false" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"</div>","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun","tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun"],function(e){var t={name:"list-grid-entity__group",markup:['<div class="tau-list__group {{if collapsed}} tau-list__group_collapsed_true{{/if}}" role="group">','   <div class="tau-list__group__header tau-list__group__collapse" role="expander">',"       {{if realGroup}}","           {{if realGroup.url}}",'           <a class="tau-list__group__id" href="${realGroup.url}"><em class="tau-entity-icon tau-entity-icon--${realGroup.__type}">${realGroup.id}</em></a>',"           {{/if}}","       {{/if}}",'       <span class="tau-list__group__title" role="title">${title}</span>','       {{if subtitle}}<span class="tau-list__group__subtitle" >${subtitle}</span>{{/if}}','       <span class="tau-list__group__counter{{if items.length == 0}} tau-list__group__counter__empty{{/if}}" role="counter">${items.length}</span>',"   </div>",'${$item.data.config=$item.parent.data.config,""}','   <ul class="tau-list__list" role="list">',"      {{tmpl(items) $item.parent.data.config.currentView.rowTemplateName }}","   </ul>","</div>"],dependencies:["list-grid-entity__row","list-grid-entity__rowtestplanrun"]};return e.register(t)}),define("tau/ui/templates/list_/grid.entity/userstory/ui.template.list.grid.entity.row.testcase",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e,t){var i={tags:[t],name:"list-grid-entity__rowtestcase",markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-expander tau-list__itemexpander tau-list__itemexpander_state_closed"  role="item-expander" ><div class="tau-list__itemexpander__indicator "></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a class="tau-entitylink" href="${url}" title="${name}"><em class="tau-entity-icon tau-entity-icon--${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','   {{tmpl($item.data) "cell-name"}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-lastrundate">','<div runas="property.lastRunDate.list" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${lastRunDate}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-laststatus">','<div runas="property.lastStatus" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${lastStatus}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-testcaseactions">','<div class="button-group">','<button class="button success" role="action-pass">Pass</button>','<button class="button danger" role="action-fail">Fail</button>',"</div>","</td>","</tr>","</tbody>","</table>",'<table class="tau-list__table tau-list__table-additional tau-list__table-additional_state_closed">',"<tbody>","<tr>",'<td class="tau-list__table__cell tau-list__table__cell-dragdrop"></td>','<td class="tau-list__table__cell tau-list__table__cell-expander-additional"></td>','<td class="tau-list__table__cell">','<div class="ui-hide-empty-description">','<div runas="description" data-rich-editor-height="100" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${description}","</div>",'<div runas="testStepList" data-sortable="false" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"</div>","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(i)}),define("tau/ui/templates/list_/ui.template.list.comment",["tau/core/templates-factory"],function(e){var t={name:"list-grid__comment",markup:['<div class="ui-entity-state-comment" role="comment-form" style="display:none;">','<div class="ui-state-comment-header">Please, provide comment</div>','<div class="ui-state-comment-field-container">','<textarea rows="5" class="ui-state-comment-field"></textarea>',"</div>",'<div class="button-group">','<button type="button" class="save button">Save</button>','<button type="button" class="save button">Cancel</button>',"</div>","</div>"]};return e.register(t)}),define("tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun","tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun","tau/ui/templates/list_/grid.entity/userstory/ui.template.list.grid.entity.row.testcase","tau/ui/templates/list_/ui.template.list.comment"],function(e,t){var i={tags:[t],name:"list-grid-entity-testcase",markup:['<div class="tau-list tau-list-testcases">',"   {{if isEmpty === true}}",'<table class="tau-list__table tau-list__table-header">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-header">',"</td>","</tr>","</tbody>","</table>",'      <div class="tau-list__empty-message">${config.currentView.emptyMessage}</div>',"   {{else}}",'     <div class="tau-list__content">',"       {{if groups && groups.length}}",'          {{tmpl(groups) "list-grid-entity__group"}}',"       {{/if}}","       {{if items && items.length}}",'           <div class="tau-list__group tau-list__group_flat_true"  role="group">','<table class="tau-list__table tau-list__table-header">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"></td>','<td class="tau-list__table__cell tau-list__table__cell-expander tau-list__table__cell-header-expander" >','<div class="tau-list__itemexpander tau-list__itemexpander_state_closed"  role="item-expander-all">','<div class="tau-list__itemexpander__indicator "></div>',"</div>",'<div class="tau-list__itemexpander tau-list__itemexpander_state_open"  role="item-collapser-all">','<div class="tau-list__itemexpander__indicator "></div>',"</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-header">',"</td>","</tr>","</tbody>","</table>",'               <ul class="tau-list__list"  role="list">',"                   {{tmpl(items) $item.data.config.currentView.rowTemplateName }}","               </ul>","           </div>","       {{/if}}","     </div>","   {{/if}}",'   <div class="tau-list__comment-holder">','          {{tmpl({}) "list-grid__comment"}}',"   </div>","</div>"],dependencies:["list-grid-entity__group","list-grid-entity__row","list-grid-entity__rowtestplanrun","list-grid-entity__rowtestcaserun","list-grid-entity__rowtestcase","list-grid__comment"]};
return e.register(i)}),define("tau/models/dataProviders/userstory/userstory.model.provider.tasks.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("tasks","task","priority",e)},_createDetailCommand:function(e){var t={};return t[e]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{userStory:["id"]},{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{priority:["id","name","importance"]},{project:["id"]}],t},_convertData:function(e){return e=this._super(e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(e){e.project=e.project||{};var t={id:e.id,name:e.name,numericPriority:e.numericPriority,__type:e.__type,entityState:{id:e.entityState.id,name:e.entityState.name,isInitial:e.entityState.isInitial,isFinal:e.entityState.isFinal,numericPriority:e.entityState.numericPriority},tags:this._processTags(e),effort:this._getEffortData(e),assignments:this._processAssignments(e),priority:null,projectId:e.project.id,entitiesCount:0,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};return t.visibleEntityState=t.entityState,t}})}),define("tau/models/dataProviders/entity/entity.model.provider.bug.items",["Underscore","tau/models/dataProviders/model.provider.items.bugs"],function(e,t){return t.extend({_convertData:function(e){return e=this._super(e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(e){var t=this._super(e);return t.visibleEntityState=t.entityState,t}})}),define("tau/ui/extensions/list/request/extension.list.entityState",["tau/components/extensions/component.extension.base"],function(e){return e.extend({destroy:function(){this.config.store.unbind(this)},"bus afterInit+dataBind+afterRender":function(e){var t=e.afterInit.data.config.store,i=e.dataBind.data.items,n=e.afterRender.data.element,a=_.pluck(i,"id");
t.on({eventName:"afterSave",type:"general",listener:this,hasChanges:["entityState"]},function(e){var i=e.data.id;-1!=_.indexOf(a,i)&&t.get(e.data.cmd.type,{id:i,fields:["id",{entityState:["id","isFinal"]}]}).done({success:function(e){var t=e[0].data.entityState.isFinal;n.find(".i-item-"+i).toggleClass("tau-list__table__row_isfinalstate_true",t)}})})}})}),define("tau/configurations/userStory.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover","tau/models/dataProviders/model.provider.items.tasks_bugs","tau/models/dataProviders/model.provider.groups.tasks_bugs","tau/ui/extensions/list/extension.list.refresher","tau/models/dataProviders/userstory/userstory.model.provider.testcases.items","tau/ui/extensions/list/testcases/extension.list.testcases.actions","tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase","tau/models/dataProviders/userstory/userstory.model.provider.tasks.items","tau/models/dataProviders/entity/entity.model.provider.bug.items","tau/ui/extensions/list/request/extension.list.entityState"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m){return t.extend({init:function(e){this._super(e);var t=this;this.registerTab("Tasks",{label:"tasks",header:[{type:"label",text:t.getNames("task"),countFieldNames:["tasks"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"quick.add",printable:!1,property:"userStory",entityType:"task",evictProperties:["tasks","tasks-count"],label:"Add "+t.getNames("task")},{type:"list.editable",extensions:[l,m],externalRefreshEvents:["task.items.added"],itemsDataProvider:p,multiprojects:!0,views:[{type:"grid.entity"}]}]}]}]}),this.registerTab("Bugs",{label:"bugs",practices:["Bug Tracking"],header:[{type:"label",text:t.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Bug Tracking"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Bug Tracking"],children:[{practices:["Bug Tracking"],type:"quick.add",printable:!1,property:"userStory",entityType:"bug",evictProperties:["bugs","bugs-count"],label:"Add "+t.getNames("bug")},{type:"list.editable",extensions:[l,m],practices:["Bug Tracking"],externalRefreshEvents:["bug.items.added"],itemsDataProvider:f,multiprojects:!0,views:[{type:"grid.entity"}]}]}]}]}),this.registerTab("Test Cases",{label:"testcases",header:[{type:"label",text:t.getNames("testCase"),countFieldNames:["testCases"],extensions:[a]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Test Cases"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Test Cases"],children:[{practices:["Test Cases"],type:"quick.add",printable:!1,property:"userStory",entityType:"testCase",evictProperties:["testCases","testCases-count"],label:"Add "+t.getNames("testcase")},{type:"list.editable",itemsDataProvider:u,multiprojects:!0,practices:["Test Cases"],externalRefreshEvents:["testCase.items.added"],views:[{type:"grid.entity.testcase",rowTemplateName:"list-grid-entity__rowtestcase",emptyMessage:"No test cases found"}],template:d,extensions:[c]}]}]}],practices:["Test Cases"]})
},getTabsAliases:function(){return["Description","Tasks","Bugs","Test Cases","Relations","Source","Flow","Time","Tp2 Time","History"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Requests","Impediments","Assignments","Additional Info","Lead Cycle Time","Custom Fields"]},getActionsAliases:function(){return["Split","Attach to Request","Move or Copy","Copy to project","Convert","-----","Old Edit","Print","-----","Delete"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"time",relationName:"times",practices:["Time Tracking"]},{entityType:"task",relationName:"tasks"},{entityType:"bug",relationName:"bugs",practices:["Bug Tracking"]},{entityType:"testcase",relationName:"testCases",practices:["Test Cases"]},{entityType:"impediment",relationName:"impediments"}]}},getAdditionalInfoAliases:function(){return e.union(["Project","Team","Owner","Business Value","Release","Iteration","Team Iteration","Feature","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"])}})}),define("tau/configurations/task.container.config",["Underscore","tau/configurations/baseAssignable.container.config"],function(e,t){return t.extend({getAdditionalInfoAliases:function(){return["Project","Team","Owner","User Story For Task","CreationDate","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"]},getActionsAliases:function(){return["Attach to Request","Convert","-----","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Requests","Impediments","Assignments","Additional Info","Custom Fields"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"time",relationName:"times",practices:["Time Tracking"]},{entityType:"impediment",relationName:"impediments"}]}}})}),define("tau/configurations/bug.container.config",["Underscore","tau/configurations/baseAssignable.container.config"],function(e,t){return t.extend({init:function(e){this._super(e),this.registerPanel("Duplicated Bugs",{type:"duplicateBugListPanel"})
},getAdditionalInfoAliases:function(){return e.union(["Project","Team","Owner","Business Value","Severity","Release","Iteration","Team Iteration","User Story","Feature","Build","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"])},getEntityQuickAddOptions:function(){return{items:[{entityType:"time",relationName:"times",practices:["Time Tracking"]},{entityType:"impediment",relationName:"impediments"}]}},getActionsAliases:function(){return["Attach to Request","Move or Copy","Copy to project","Convert","Find Duplicate","-----","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Requests","Duplicated Bugs","Impediments","Assignments","Additional Info","Lead Cycle Time","Custom Fields"]}})}),define("tau/ui/extensions/list/request/extension.related_entities.action.detach",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus afterRender":function(e){var t=e.data.element,i=this.config.store,n=this.config.context.entity,a=this.bus;t.delegate("[role=action-detach]","click",function(e){var t=$(e.target).parents("[role=item]:first"),r=t.data("tmplItem").data;i.removeFromList(r.__type,{id:r.id,$set:{relatedRequests:{id:n.id}}}).done({success:function(){i.save("request",{id:n.id,$set:{relatedEntities:[]}}).done(),i.evictProperties(n.id,n.entityType.name,["relatedEntities","relatedEntities-count"]),a.fire("refresh")}})})}})}),define("tau/models/dataProviders/request/request.model.provider.requesters.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e){this._fetch("requesters","user",null,e)},_convertData:function(t){return t=this._super(t),e.reject(t,function(e){return null!=e.deleteDate})},_createDetailCommand:function(e){var t={};return t[e]=["id","firstName","lastName","deleteDate","email","login","kind"],t},_convertItem:function(e){var t=this.config.context.configurator.getUrlBuilder(),n=this.config.context.configurator.getFeaturesService().isEnabled("tp3.only"),a={id:e.id,firstName:e.firstName,lastName:e.lastName,deleteDate:e.deleteDate,login:e.login,email:e.email,endDate:i.format.date.short(e.endDate),avatar:t.getAvatarUrl(e.id,32),url:n?"user"==e.kind.toLowerCase()?t.getNewViewUrl(e.id,"user",!0):null:t.getUserUrl(e.id,e.kind)};
return a}})}),define("tau/ui/extensions/list/testplan/extension.list.editableCells",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus afterRender+component.ready":function(e){var t=e.afterRender.data.element;t.find(".tau-list__table__cell:has(.tau-property_editable_true)").addClass("tau-list__table__cell_editable_true"),t.delegate(".tau-list__table__cell:has(.tau-property_editable_true)","click",function(e){0==$(e.currentTarget).hasClass("tau-property__value")&&(e.stopPropagation(),$(this).find(".tau-property__value").click())})}})}),define("tau/ui/extensions/list/request/extension.requesters.tabs",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus afterRender":function(e){var t=this.$el=e.data.element;setTimeout(function(){t.find(":input[data-autofocus]:visible").focus()},10)},"bus tabs.switched":function(){var e=this;setTimeout(function(){e.$el.find(":input[data-autofocus]:visible").focus()},10)}})}),define("tau/ui/extensions/list/request/extension.requesters.action.add",["tau/components/extensions/component.extension.base","tau/ui/extensions/list/request/extension.requesters.tabs"],function(e,t){return e.extend({"bus afterInit":function(e){var t=e.data.config.store,i=e.data.config.context.entity,n=this;t.unbind(this),t.on({eventName:"afterSave",type:i.entityType.name,listener:this,filter:{id:i.id},hasChanges:["requesters"]},function(){t.evictProperties(i.id,i.entityType.name,["requesters"]),n.fire("refresh")})},"bus afterRender":function(e){var i=e.data.element.find("[role=action-add]"),n={actionOnBlur:"destroy",target:i,alignTo:i,componentsConfig:{components:[{type:"tabs",tabsHeader:{type:"tabsHeader",options:{more:!1}},cssClass:"tau-tabs-small",extensions:[t],tabs:[{label:"select",header:[{type:"label",text:"Select requester"}],items:[{type:"finder.requesters"}],selected:!0},{label:"add",header:[{type:"label",text:"Add new"}],items:[{type:"editor.requester"}]}]}]}};this.fire("initBubble",n);
var a=function(){i.tauBubble("empty")};i.on("close externalClose",a),i.on("show",function(){var e=i.tauBubble("widget");e.delegate("[role=action-cancel]","click",a)})}})}),define("tau/ui/extensions/list/request/extension.requesters.action.detach",["tau/components/extensions/component.extension.base","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension"],function(e){return e.extend({"bus afterRender":function(e){var t=e.data.element,i=this.config.store,n=this.config.context.entity,a=this.bus;t.delegate("[role=action-detach]","click",function(e){var t=$(e.target).parents("[role=item]:first"),r=t.data("tmplItem").data;i.removeFromList("request",{id:n.id,$set:{requesters:{id:r.id}}}).done({success:function(){a.fire("refresh")}})})}})}),define("tau/configurations/request.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/ui/extensions/list/request/extension.related_entities.action.detach","tau/models/dataProviders/request/request.model.provider.requesters.items","tau/ui/extensions/list/testplan/extension.list.editableCells","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list/request/extension.requesters.action.add","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/list/request/extension.requesters.action.detach"],function(e,t,i,n,a,r,s,o,l,u,c){return t.extend({init:function(e){this._super(e),this.registerAdditionalInfoItem("Owner",{label:{text:"Owner"},field:{type:"property.owner.request"}}),this.registerAdditionalInfoItem("RequestType",{label:{text:this.getTermName("RequestType")},field:{type:"property.requestType"}}),this.registerAdditionalInfoItem("Source",{label:{text:"Source"},field:{type:"property.requestSource"}}),this.registerTab("Requesters",{label:"requesters",header:[{type:"label",text:"Requesters",countFieldNames:["requesters"]}],items:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"list",sortable:!1,itemsDataProvider:a,extensions:[o,l,u,c],views:[{rowTemplateName:"list-grid-entity__row_requester",type:"grid.entity.requesters"}]}]}]})
},getTabsAliases:function(){return["Description","Requesters","Relations","Flow","Time","Tp2 Time","History"]},getAdditionalInfoAliases:function(){return["Project","Team","Owner","Business Value","IsPrivate","RequestType","Source","CreationDate","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"time",relationName:"times",practices:["Time Tracking"]}]}},getActionsAliases:function(){return["Create","Move or Copy","Copy to project","Convert","-----","Old Edit","Print","-----","Delete"]}})}),define("tau/models/dataProviders/testplanrun/testplanrun.model.provider.testcaseruns.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("testCaseRuns","testCaseRun","priority",e)},_createDetailCommand:function(e){var t={};return t[e]=["id","passed","executed","runDate",{testCases:["id","name","tags","numericPriority",{priority:["id","name","importance"]}]}],t},_convertData:function(t){return t=this._super(t),t=e.compact(t),e.sortBy(t,function(e){var t=e.testcase.numericPriority||0;return t})},_convertItem:function(e){if(0==e.testCases.length)return null;var t=e.testCases[0];t.priority.kind=this.importanceProcessor.getKind(t.priority.importance);var i={id:e.id,__type:e.__type,name:t.name,testcase:{id:t.id,__type:t.__type,name:t.name,tags:this._processTags(t),priority:t.priority,numericPriority:t.numericPriority,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.__type,!0)},passed:e.passed,runDate:e.runDate,executed:e.executed,status:e.passed===!0?"Passed":e.passed===!1?"Failed":"Skipped"};return i}})}),define("tau/ui/extensions/list/testplanrun/extension.list.testcaseruns.refresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t,i){var n=i.config.context,a=n.configurator,r=n.entity,s=r.entityType.name,o=this,l=a.getStore();l.unbind(this),e.forEach(["passedCount","failedCount","notRunCount"],function(e){l.on({eventName:"afterSave",type:s,listener:o,filter:{id:r.id},hasChanges:[e]},function(){l.evictProperties(r.id,s,["testCaseRuns"]),o.fire("refresh")
})})}})}),define("tau/models/model.menu.testPlanRun",["Underscore","jQuery","tau/core/model-base"],function(e,t,i){return i.extend({"bus beforeInit":function(t){var i=t.data.config,n=i.eventNamesSpecial||{};e.defaults(n,{dataBind:"dataBind"});var a=n.dataBind,r=i.context.entity;this._subscribeToStore(r),this._getActions(r).then(this._dataBind.bind(this,a))},_dataBind:function(t,i){"dataBind"!=t&&this.config.context.configurator.isBoardEdition&&(i=e.map(i,function(e,t){return{show:e.show&&!e.exclude,label:e.label,alias:t,command:this._executeAction.bind(this,e)}},this)),this.fire(t,{additionalActions:i})},_executeAction:function(e){this.fire("url.process",e.url)},_getActions:function(e){return this._getActionsData(e).then(this._buildActions.bind(this))},_getActionsData:function(e){var i=t.Deferred();return this.store.freeze(!0).done(function(t){this.store.get(e.entityType.name.toLowerCase(),{id:e.id,fields:["testCaseRuns-count","passedCount","failedCount","notRunCount",{entityState:["isFinal"]}]}).done({success:function(e){var t=e[0].data;i.resolve(t)}.bind(this),failure:i.reject}),t.unfreeze()}.bind(this)),i.promise()},_buildActions:function(e){var i=t.Deferred(),n=this._getDefaultActionMap(e);return!e.entityState.isFinal&&e["testCaseRuns-count"]>0&&(e.passedCount>0||e.failedCount>0?(n.newRun&&(n.newRun.show=!0),e.notRunCount>0?n.completeRun.show=!0:n.changeRun.show=!0):n.run.show=!0),i.resolve(n).promise()},_getDefaultActionMap:function(e){var t=this.config.context.configurator.getApplicationPath();return{run:{show:!1,url:t+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+e.id,label:"Run"},completeRun:{show:!1,url:t+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+e.id+"&CompleteRun=1",label:"Complete Run"},newRun:{show:!1,url:t+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+e.id+"&ReRun=1",label:"New Run"},changeRun:{show:!1,url:t+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+e.id+"&Edit=1",label:"Change Run"}}},_subscribeToStore:function(e){this.store.unbind(this),this.store.on({eventName:"afterSave",type:"testplanrun",listener:this,filter:{id:e.id},hasChanges:["testCaseRuns-count|passedCount|failedCount|notRunCount|entityState"]},function(){this.fire("refresh")
}.bind(this))},"bus beforeInit:last + $el.ready":function(e,i){var n=i.config.context.entity,a=t("body").tauIFramePopup();a.on("taupopuphide",function(){this.fire("testplanrun.runCompleted",n)}.bind(this)),this.fire("$iframed.ready",a)},"bus $iframed.ready:last + url.process":function(e,t,i){t.tauIFramePopup("option","url",i+"&rmnav=1&tp3=1"),t.tauIFramePopup("show")},"bus initConfig:last + $iframed.ready:last + destroy":function(e,t,i){this.store.unbind(this),i.tauIFramePopup("destroy")}})}),define("tau/configurations/const.page.testPlanRun.actions",{RUN:"run"}),define("tau/models/model.menu.testPlanRun.runner",["require","tau/models/model.menu.testPlanRun","tau/configurations/const.page.testPlanRun.actions"],function(e){var t=e("tau/models/model.menu.testPlanRun"),i=e("tau/configurations/const.page.testPlanRun.actions");return t.extend({_getDefaultActionMap:function(e){var t=this.config.context.configurator.getUrlBuilder(),n=t.getNewViewUrlWithAction(e.id,"testplanrun",!0,i.RUN);return{run:{show:!1,url:n,label:"Run"},completeRun:{show:!1,url:n,label:"Complete Run"},changeRun:{show:!1,exclude:!0,url:n,label:"Change Run"}}},_executeAction:function(){this.config.context.registry.runnerModel.start(),this.fire("close")}})}),define("tau/models/testPlanRun/model.testPlanRun.runner",["require","Underscore","tau/core/class"],function(e){var t=e("Underscore"),i=e("tau/core/class");return i.extend({init:function(e){this._store2=e.context.configurator.getStore2(),this._testPlanRun=e.context.entity,this._runned=0,this.started=t.Callbacks(),this.nextRun=t.Callbacks(),this.finished=t.Callbacks()},start:function(){this.started.fire(),this.runNext()},runNext:function(e){this._store2.findAll(["testPlanRun?","select={nextToRunPath("+(e||"null")+") as nextToRunPath}&","where=(id==",this._testPlanRun.id,")"].join("")).done(function(i){i&&!t.isEmpty(i[0].nextToRunPath)?this.nextRun.fire(i[0].nextToRunPath):this._finish(!!e)}.bind(this))},_finish:function(e){this.finished.fire(e)}})}),define("tau/models/page.testPlanRun/model.page.testPlanRun.runner",["require","tau/core/extension.base","tau/configurations/const.page.testPlanRun.actions"],function(e){var t=e("tau/core/extension.base"),i=e("tau/configurations/const.page.testPlanRun.actions");
return t.extend({SETTING_NAME:"generalTab",TAB_NAME:"testCases","bus beforeInit":function(e,t){this._config=t.config,this._runnerModel=this._config.context.registry.runnerModel,this._bind(),this._startIfRunAction()},_unBind:function(){this._runnerModel.started.remove(this._runStarted,this),this._runnerModel.finished.remove(this._runFinished,this)},_bind:function(){this._unBind(),this._runnerModel.started.add(this._runStarted,this),this._runnerModel.finished.add(this._runFinished,this)},_runStarted:function(){this._config.context.componentSettings.get({fields:[this.SETTING_NAME],callback:function(e){e[this.SETTING_NAME]!==this.TAB_NAME&&this._config.context.componentSettings.set({set:{generalTab:"testCases"}})}.bind(this)})},_runFinished:function(e){e&&this.fire("notification",{message:"All Test Cases in the Test Plan have been executed"})},_startIfRunAction:function(){this._config.action===i.RUN&&this._runnerModel.start()},"bus beforeInit > destroy":function(){this._unBind()}})}),define("tau/configurations/testplanrun.container.config",["require","Underscore","tau/configurations/baseAssignable.container.config","tau/ui/extensions/list/collapse/extension.list.actions.collapse","tau/models/dataProviders/testplanrun/testplanrun.model.provider.testcaseruns.items","tau/ui/extensions/list/testplanrun/extension.list.testcaseruns.refresher","tau/models/model.menu.testPlanRun.runner","tau/models/model.menu.testPlanRun","tau/models/testPlanRun/model.testPlanRun.runner","tau/models/page.testPlanRun/model.page.testPlanRun.runner","tau/components/extensions/error/extension.errorBar","tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase"],function(e){var t=e("Underscore"),i=e("tau/configurations/baseAssignable.container.config"),n=e("tau/ui/extensions/list/collapse/extension.list.actions.collapse"),a=e("tau/models/dataProviders/testplanrun/testplanrun.model.provider.testcaseruns.items"),r=e("tau/ui/extensions/list/testplanrun/extension.list.testcaseruns.refresher"),s=e("tau/models/model.menu.testPlanRun.runner"),o=e("tau/models/model.menu.testPlanRun"),l=e("tau/models/testPlanRun/model.testPlanRun.runner"),u=e("tau/models/page.testPlanRun/model.page.testPlanRun.runner"),c=e("tau/components/extensions/error/extension.errorBar"),d=e("tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase");
return i.extend({init:function(e){this._super(e),this.registerAdditionalInfoItem("Build",{label:{text:this.getTermName("build")},field:{type:"property.build.testPlanRun"}}),this.registerPanel("Last Run",{type:"collapsible",stateName:"lastRun",collapsed:!1,header:[{type:"label",text:"Last Run"}],items:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"testCasesRunResults"}]}]}),this.registerTab("Test Case Runs",{disabledIf:{isBoard:!0},label:"testcaseruns",header:[{type:"label",text:this.getNames("testCaseRun"),countFieldNames:["testCaseRuns"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Test Cases"],children:[{type:"container",lazy:!0,practices:["Test Cases"],name:"lazyPlaceholder container",children:[{type:"list.editable",itemsDataProvider:a,extensions:[r,n],template:d,sortable:!1,views:[{rowTemplateName:"list-grid-entity__rowtestcaserun",type:"grid.entity",emptyMessage:"No items found"}]}]}]}],practices:["Test Cases"]}),this.registerTab("Test Runs",{enabledIf:{isBoard:!0},label:"testCases",header:[{type:"label",text:"Test Runs",countFieldNames:["testCaseRuns"]}],items:[{name:"TestCaseRuns",type:"entity.new.list.testPlanRun.testCaseRuns",lazy:!0,spinnerConfigForLazy:this.getSpinnerConfigForLazy()}]})},getAdditionalInfoAliases:function(){return["Project","Team","Test Plan","Build","Release","Iteration","Team Iteration","CreationDate","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"]},getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Last Run","Impediments","Assignments","Additional Info","Custom Fields"]},getTabsAliases:function(){return["Description","Test Case Runs","Test Runs","Relations","Flow","Time","Tp2 Time","History"]},getEntityMenuOptions:function(){return{type:"menu.actions.testplanrun",Model:this.helper.valueOrDefault({enabledIf:{isBoard:!0},value:s,"default":o}),items:this.getActions()}
},getEntityQuickAddOptions:function(){return{items:[{entityType:"time",relationName:"times",practices:["Time Tracking"]}]}},getContainerRegistry:function(e){return t.extend(this._super(e),{runnerModel:new l(e)})},getConfig:function(e){var t=this._super(e);return t.extensions=[u,c],t}})}),define("tau/models/dataProviders/testcase/testcase.model.provider.testcaseruns.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e){this._fetch("testCaseRuns","testCaseRun","priority",e)},_createDetailCommand:function(e){var t={};return t[e]=["id","passed","executed","comment","runDate",{testPlanRun:["id","name","tags","numericPriority",{testPlan:["id","name"]},{priority:["id","name","importance"]},{release:["id","name"]},{iteration:["id","name"]},{build:["id","name"]}]}],t},_convertData:function(t){return t=this._super(t),t=e.compact(t),e.sortBy(t,function(e){return e.runDateReal}).reverse()},_convertItem:function(e){if(null==e.runDate)return null;if(null===e.passed)return null;var t=e.testPlanRun,n=t.testPlan,a={id:e.id,__type:e.__type,name:n.name,testplan:n,comment:e.comment,testplanrun:{id:t.id,__type:t.__type,name:t.name,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.__type,!0)},release:t.release,iteration:t.iteration,build:t.build,passed:e.passed,runDate:i.format.datetime.short(i.convertToTimezone(e.runDate)),runDateReal:e.runDate,executed:e.executed,status:e.passed===!0?"Passed":e.passed===!1?"Failed":"Skipped"};return a}})}),define("tau/ui/templates/testStepList/ui.template.testStepList",["tau/core/templates-factory"],function(e){var t={engine:"jqote2",name:"test-step-list",markup:['<div class="test-case_list i-role-list">','<div class="test-case-description">','<div class="test-case-description_title ">','<div class="test-case-description_colom">Step</div>','<div class="test-case-description_colom">Expected result</div>',"</div>","<% _.each(this.items, function(item) { %>",'<div class="test-case-description_rows tau-teststep i-role-teststep" data-id="<%= item.id %>">','<div class="test-case-description_colom">','<div class="tau-in-text i-role-property i-role-editable"><%= fn.sanitize(item.description) %></div>',"</div>",'<div class="test-case-description_colom">','<div class="tau-in-text i-role-property i-role-editable"><%= fn.sanitize(item.result) %></div>',"</div>",'<span class="tau-icon-general tau-icon-list-lanes-gray"/>','<span class="tau-icon-general tau-icon-close-red i-role-remove"/>',"</div>","<% }); %>",'<div class="test-case-description_rows tau-teststep i-role-teststep">','<div class="test-case-description_colom">','<div class="tau-in-text disable i-role-property i-role-editable">Add step</div>',"</div>",'<div class="test-case-description_colom">','<div class="tau-in-text disable i-role-property i-role-editable">Add result</div>',"</div>",'<span class="tau-icon-general tau-icon-list-lanes-gray"/>','<span class="hidden tau-icon-general tau-icon-close-red i-role-remove"/>',"</div>","</div>","</div>"].join("")};
return e.register(t)}),define("tau/configurations/testcase.container.config",["tau/configurations/base.container.config","tau/models/model.extensions","tau/models/dataProviders/testcase/testcase.model.provider.testcaseruns.items","tau/ui/templates/testStepList/ui.template.testStepList"],function(e,t,i,n){var a=e.extend({init:function(e){this._super(e),this.registerTab("Description",{selected:!0,label:"description",header:[{type:"label",text:"Description"}],items:[{type:"container",containsNestedContainers:!0,spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"tagsEditor",layout:"selectable",children:[{type:"tags",selector:".i-role-tagslistcontainer"},{type:"container",name:"tagsCloud.container",selector:".i-role-tagscloudcontainer",visible:!1,children:[{type:"tagsCloud"}]}]},{type:"container",name:"description container",cssClass:"ui-sub-control",children:[{type:"description"}]},{type:"testStepList",template:n},{type:"container",isNestedTopContainer:!0,lazy:!0,name:"lazyPlaceholder container",children:[this._buildRichTextCustomFieldsSummary(e),{type:"attachments"},{type:"label",text:"Comments",cssClass:"ui-ctrl-title"},{type:"container",name:"comments container",cssClass:"ui-sub-control",children:[{type:"comments"}]}]}]}]}]}),this.registerTab("Test Case Runs",{label:"testcaseruns",header:[{type:"label",text:"Runs"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Test Cases"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Test Cases"],children:[{type:"list",itemsDataProvider:i,sortable:!1,views:[{rowTemplateName:"list-grid-entity__rowtestcaserun_testcase",type:"grid.entity",emptyMessage:"No items found"}]}]}]}],practices:["Test Cases"]})},getTabsAliases:function(){return["Description","Test Case Runs","Relations","Time","History"]},getActionsAliases:function(){return["Move or Copy","Copy to project","-----","Old Edit","Print","-----","Delete"]
},getAdditionalInfoAliases:function(){return["Project","Business Value","User Story","Owner","CreationDate","Last Run Result","LastFailureComment","Last Run Date"]}});return a}),define("tau/ui/templates/testStepRunList/ui.template.testStepRunList",["tau/core/templates-factory"],function(e){var t={engine:"jqote2",name:"test-step-run-list",customFunctions:{getStatus:function(e,t){return t&&e?"passed":t&&!e?"failed":"skipped"},getStatusLabel:function(e,t,i){var n=this.getStatus(e,t);return"skipped"==n&&(n="not run"),i?this.capitaliseFirstLetter(n):n},capitaliseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},markup:['<div class="test-case_list i-role-list">','<div class="test-case-run-description">','<div class="test-case-run-description_title ">','<div class="test-case-run-description_colom">Step</div>','<div class="test-case-run-description_colom">Expected result</div>','<div class="test-case-run-description_colom ">Status</div>',"</div>","<% _.each(this.items, function(item) { %>",'<div class="test-case-run-description_rows tau-teststep i-role-teststep" data-id="<%= item.id %>">','<div class="test-case-run-description_colom">','<div class="tau-in-text i-role-editable"><%= fn.sanitize(item.step.Description) %></div>',"</div>",'<div class="test-case-run-description_colom">','<div class="tau-in-text i-role-editable"><%= fn.sanitize(item.step.Result) %></div>',"</div>",'<div class="test-case-run-description_colom i-role-state">','<%= fn.sub("test-step-run-status", item) %>',"</div>","</div>","<% }); %>","</div>","</div>"].join("")};return e.register(t)}),define("tau/configurations/testcaserun.container.config",["tau/configurations/base.container.config","tau/ui/templates/testStepRunList/ui.template.testStepRunList"],function(e,t){return e.extend({init:function(e){this._super(e),this.registerTab("Description",{selected:!0,label:"description",header:[{type:"label",text:"Description"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"container",name:"description container",cssClass:"ui-sub-control ui-hide-empty-description",children:[{type:"description",editable:!1,placeholder:"&nbsp;"}]},{type:"testStepRunList",template:t},{type:"testcaserun.result.container"}]}]}]})
},getTabsAliases:function(){return["Description"]},getActionsAliases:function(){return[]},getAdditionalInfoAliases:function(){return["Test Case","Test Plan Run","Run Result","Run Date"]}})}),define("tau/components/extensions/testCaseList/extension.testPlanRun.testCaseList.edit.addTestCase",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/core/termProcessor"],function(e,t,i,n){return i.extend({"bus afterRender+permissionsReady+dataBind":function(e){if(e.permissionsReady.data.editable){var i=(e.dataBind.data,e.afterRender.data.element),a=this.config.context.getTerms(),r=new n(a),s=i.find(".tau-add-testCase"),o=t('<a class="tau-add-testCase">Add '+r.getTerms("TestCase").names+"</a>");o.attr("href",this.config.context.configurator.getUrlBuilder().getAddTestCaseForTestPlanRunUrl(this.config.context.entity.id)),o.text(s.text()),s.replaceWith(o)}}})}),define("tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("testPlanRuns","testPlanRun","severity",e)},_createDetailCommand:function(t){var i={};i[t]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain","passedCount","failedCount","notRunCount","testCaseRuns-count",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{release:["id","name"]},{iteration:["id","name"]},{build:["id","name"]}];var n={project:["id"]};return this.config.multiprojects&&n.project.push("abbreviation"),i[t].push(n),this.config.additionalFields&&e.indexOf(this.config.additionalFields,"iteration")>-1&&i[t].push({iteration:["id","name"]}),i},_convertData:function(t){return t=this._super(t),e.sortBy(t,function(e){var t=e.numericPriority||0;return t})},_convertItem:function(t){var i=!0;
this.config.context.isPracticeAvailable("Iterations")||(i=!1),t.project=t.project||{};var n={id:t.id,name:t.name,numericPriority:t.numericPriority,__type:t.__type,entityState:{id:t.entityState.id,name:t.entityState.name,isInitial:t.entityState.isInitial,isFinal:t.entityState.isFinal,numericPriority:t.entityState.numericPriority},assignments:this._processAssignments(t),projectId:t.project.id,entitiesCount:0,release:t.release,iteration:t.iteration,build:t.build,passedCount:e.toNumber(t.passedCount)||0,failedCount:e.toNumber(t.failedCount)||0,notRunCount:e.toNumber(t.notRunCount)||0,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.__type,!0),isAvailableIteration:i,additionalActions:{}};return this.config.multiprojects&&(n.project={id:t.project.id,abbreviation:t.project.abbreviation}),this.config.additionalFields&&e.indexOf(this.config.additionalFields,"iteration")>-1&&(n.iteration={id:t.iteration?t.iteration.id:null,name:t.iteration?t.iteration.name:null}),n}})}),define("tau/models/dataProviders/strategies/model.provider.groups.strategy.base",["Underscore","tau/core/class"],function(e,t){return t.extend({fetch:function(){},moveToGroup:function(){},isAvailableForItem:function(){},getCommentRequirements:function(){}})}),define("tau/models/dataProviders/strategies/model.provider.groups.strategy.states",["Underscore","tau/models/dataProviders/strategies/model.provider.groups.strategy.base"],function(e,t){return t.extend({fetch:function(){},moveToGroup:function(t,i,n,a,r){var s=e.find(a.realGroups,function(e){return e.id==i.entityState.id}),o=e.find(n.realGroups,function(e){return e.entityType.name.toLowerCase()==i.__type.toLowerCase()&&e.process.id==s.process.id});if(!o||o.id==s.id)return void r.call(null);var l=[];l.push(function(e){t.save(i.__type,{id:i.id,$set:{entityState:{id:o.id}},fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(){e(null,arguments)}})}),l.push(function(e){t.get(i.__type,{id:i.id,fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(t){e(null,t[0].data)
}})}),e.series(l,function(t,i){e.isFunction(r)&&r.call(null,{changed:i[1]})})},isAvailableForItem:function(t,i,n){var a=e.find(n.realGroups,function(e){return e.id==t.entityState.id}),r=e.find(i.realGroups,function(e){return e.entityType.name.toLowerCase()==t.__type.toLowerCase()&&e.process.id==a.process.id}),s=e.pluck(a.nextStates,"id");return s.push(a.id),r&&e.include(s,r.id)},getCommentRequirements:function(t,i,n){var a=e.find(n.realGroups,function(e){return e.id==t.entityState.id}),r=[];return e.forEach(i,function(i){var n=e.find(i.realGroups,function(e){return e.entityType.name.toLowerCase()==t.__type.toLowerCase()&&e.process.id==a.process.id});r.push({isCommentRequired:n?n.isCommentRequired:!1})}),r}})}),define("tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states"],function(e,t,i){return t.extend({init:function(e){this._super(e),this.strategy=new i},fetch:function(t,i,n){var a=e(i).pluck("projectId"),r=this.config.store,s={fields:[{process:["id"]}],list:!0};r.get("projects",s,{scope:this,success:this.onProjects(a,t,n)}).done()},onProjects:function(t,i,n){return function(a){var r=e(a.data).chain().select(function(i){return e(t).include(i.id)}).map(function(e){return e.process.id}).uniq().value(),s=$.Deferred(),o=function(t){var i=(t.entityType.name||"").toLowerCase();return"testplanrun"===i&&e(r).include(t.process.id)};if(r.length)s.resolveWith(this,[o]);else{var l=this.config.store;l.get("processes",{fields:["id","IsDefault"],$query:{IsDefault:"true"}},{scope:this,fail:s.reject,success:function(t){r.push(e.chain(t.data).select(function(e){return e.IsDefault}).pluck("id").first().value()),s.resolveWith(this,[o])}}).done()}this._fetchStateAsync(i,s,n)}},_fetchStateAsync:function(e,t,i){t.always(function(t){return this._fetchState(e,t,i)})},moveToGroup:function(e,t,i,n){var a=this.config.store;return this.strategy.moveToGroup(a,e,t,i,n)
},isAvailableForItem:function(e,t,i){return this.strategy.isAvailableForItem(e,t,i)},getCommentRequirements:function(e,t,i){return this.strategy.getCommentRequirements(e,t,i)}})}),define("tau/ui/extensions/list/testplan/extension.list.testplanruns.refresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t,i){var n=i.config.context,a=n.configurator,r=n.entity,s=r.entityType.name,o=a.getStore();a.getGlobalBus().unbind(this),a.getGlobalBus().on("testplanrun.runCompleted",e.bind(function(){o.evictProperties(r.id,s,["testPlanRuns"]),this.fire("refresh")},this),this)},"bus beforeInit:last + destroy":function(e,t){var i=t.config.context,n=i.configurator;n.getGlobalBus().unbind(this)}})}),define("tau/models/dataProviders/testplan/testplan.model.provider.testcases.items",["Underscore","tau/models/dataProviders/userstory/userstory.model.provider.testcases.items"],function(e,t){return t.extend({})}),define("tau/ui/extensions/list/external.refresh.extension",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t,i){var n=this,a=e.bind(function(t,i){var n=this,a=i.data["evict-data"],r=e.bind(function(e,t){e.evictProperties(t.entityId,t.entityType,t.evictProperties),this.fire("refresh")},n,t,a);e.has(a,"$defer")?a.$defer.done(r):r()},n,i.config.store),r=i.config.context.configurator.getGlobalBus();r.removeAllListeners(this),e.each(i.config.externalRefreshEvents,function(e){r.on(e,a,n)}),this.fire("globalBus.ready",r)},"bus globalBus.ready:last + destroy":function(e,t){t.removeAllListeners(this)}})}),define("tau/configurations/testplan.container.config",["tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/components/extensions/testCaseList/extension.testPlanRun.testCaseList.edit.addTestCase","tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher","tau/ui/extensions/list/testplan/extension.list.editableCells","tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.items","tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.groups","tau/ui/extensions/list/testplan/extension.list.testplanruns.refresher","tau/models/dataProviders/testplan/testplan.model.provider.testcases.items","tau/ui/extensions/list/testcases/extension.list.testcases.actions","tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase","tau/ui/extensions/list/external.refresh.extension"],function(e,t,i,n,a,r,s,o,l,u,c){return e.extend({init:function(e){this._super(e);
var t=e.context.entity,i=e.context.configurator.getUrlBuilder();this.registerAction("Assign Test Cases",{disabledIf:{isBoard:!0},label:"Assign "+this.getTermName("TestCase"),url:i.getAssignTestCasesForTestPlanUrl(t.id),practices:["Test Cases"]}),this.registerAdditionalInfoItem("Initial Estimate",{label:{text:"Run Estimate"},field:{type:"property.initialEstimate"},practices:["Planning"]}),this.registerTab("Test Cases",{disabledIf:{isBoard:!0},label:"testcases",header:[{type:"label",text:this.getNames("testCase"),countFieldNames:["testCases"],extensions:[n]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Test Cases"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Test Cases"],children:[{practices:["Test Cases"],type:"quick.add",printable:!1,property:"testPlan",onBeforeAdd:function(e){var t=e.$set;e.fields=["id","name",{testPlans:["id","testCases-count"]}];var i=t.testPlan;delete t.testPlan,t.testPlans=[i]},entityType:"testCase",evictProperties:["testCases","testCases-count"],label:"Add "+this.getNames("testcase")},{type:"list.editable",itemsDataProvider:l,multiprojects:!0,practices:["Test Cases"],views:[{type:"grid.entity.testcase",rowTemplateName:"list-grid-entity__rowtestcase",emptyMessage:"No test cases found"}],template:c,externalRefreshEvents:["testCase.items.added"],extensions:[u],labelAdd:"Assign"}]}]}],practices:["Test Cases"]}),this.registerTab("Tests",{enabledIf:{isBoard:!0},label:"testCases",header:[{type:"label.testplan.testcasecount",text:"Tests"}],items:[{name:"TestCases",type:"entity.new.list",definition:{cells:{types:this.helper.valueOrDefault({enabledIf:{feature:"qa.area.improvements"},value:["testplan","testcase"],"default":["testcase"]})},cardSettings:{list_testcase:{list:[[{id:"entity_name_1line",order:0},{id:"general_entity_id",order:1},{id:"tc_last_status",order:2},{id:"tc_last_run_date",order:3}]]},list_testplan_testcase:{list:[[{id:"entity_name_1line",order:0},{id:"general_entity_id",order:1},{id:"tc_last_status",order:2},{id:"test_cases",order:2},{id:"tc_last_run_date",order:3}]]}}},listOptions:{disableDetailsViewForTypes:["testplan"]},lazy:!0,spinnerConfigForLazy:this.getSpinnerConfigForLazy()}]}),this.registerTab("Test Plan Runs",{label:"testPlanRuns",header:[{type:"label",text:this.getNames("testPlanRun"),countFieldNames:["testPlanRuns"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Test Cases"],children:[{type:"container",lazy:!0,practices:["Test Cases"],name:"lazyPlaceholder container",children:[{type:"quick.add",printable:!1,property:"testPlan",entityType:"testPlanRun",evictProperties:["testPlanRuns-count"],label:"Add "+this.getNames("TestPlanRun")},{type:"list.editable",itemsDataProvider:r,externalRefreshEvents:["testPlanRun.items.added"],groupsDataProvider:s,groupBy:"entityState.name",multiprojects:!0,views:[{rowTemplateName:"list-grid-entity__rowtestplanrun",type:"grid.entity",group:{dataIndex:"name"}}],extensions:[a,o]}]}]}],practices:["Test Cases"]})
},getTabsAliases:function(){return["Description","Tests","Test Cases","Test Plan Runs","Relations","Time","Tp2 Time","Flow","History"]},getAdditionalInfoAliases:function(){return["Project","Team","Owner","Business Value","Initial Estimate","StartDate","CreationDate","CompletionDate","PlannedStartDate","PlannedEndDate"]},getActionsAliases:function(){return["Copy to project","Assign Test Cases","Old Edit","Print","-----","Delete"]},getEntityQuickAddOptions:function(){return{items:this.helper.collection([{entityType:"time",relationName:"times",practices:["Time Tracking"]},{entityType:"testplanrun",relationName:"testPlanRuns",practices:["Test Cases"]},{entityType:"testcase",relationName:"testCases",practices:["Test Cases"]},{enabledIf:{feature:"qa.area.improvements"},entityType:"testplan",relationName:"testPlans",practices:["Test Cases"]}])}}})}),define("tau/models/dataProviders/model.provider.items.user_stories",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("userStories","userStory","priority",e)},fetchForGroup:function(t,i){var n=this.config.context,a=n.entity.entityType.name,r=n.entity.id,s=this.config.store,o="userStories",l="userStory",u=this._createDetailCommand(o),c={id:r,nested:!0,fields:[u]};s=s.get(a,c);var d=this,p=function(n){var a=e(n).pluck("data")[0][o];e.map(a,function(e){e.__type=l}),a=e.filter(a,function(e){return e.entityState.name==t.key});var r=d._convertData(a);i(r)};s.done({success:p,scope:d})},_createDetailCommand:function(t){var i={};i[t]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{feature:["id"]},{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]}];var n={project:["id"]};
return this.config.multiprojects&&n.project.push("abbreviation"),i[t].push(n),this.config.additionalFields&&e.indexOf(this.config.additionalFields,"iteration")>-1&&i[t].push({iteration:["id","name"]}),i},_convertData:function(e){return e=t.prototype._convertData.call(this,e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(t){var i=this;t.project=t.project||{};var n={id:t.id,name:t.name,__type:t.__type,numericPriority:t.numericPriority,entityState:{id:t.entityState.id,name:t.entityState.name,isInitial:t.entityState.isInitial,isFinal:t.entityState.isFinal,numericPriority:t.entityState.numericPriority},tags:this._processTags(t),priority:{id:t.priority.id,name:t.priority.name,kind:i.importanceProcessor.getKind(t.priority.importance)},effort:this._getEffortData(t),assignments:this._processAssignments(t),projectId:t.project.id,entitiesCount:t["tasks-count"],url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.__type,!0)};return this.config.multiprojects&&(n.project={id:t.project.id,abbreviation:t.project.abbreviation}),this.config.additionalFields&&e.indexOf(this.config.additionalFields,"iteration")>-1&&(n.iteration={id:t.iteration?t.iteration.id:null,name:t.iteration?t.iteration.name:null}),n}})}),define("tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(e,t,i,n){return t.extend({init:function(e){this.config=e,this.providers=[new i(e)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new n(e))},_convertData:function(e){return e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},fetch:function(t){var i=this,n=function(e){var n=i._convertData(e);t(n)},a=[];e.forEach(i.providers,function(e){a.push(function(t){e.fetch(function(e){t(null,e)})})}),e.parallel(a,function(t,i){var a=e.flatten(i);
n(a)})}})}),define("tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(e,t,i){return t.extend({init:function(e){this._super(e),this.strategy=new i},fetch:function(e,t,i){var n=["userstory"];return this.config.context.isPracticeAvailable("Bug Tracking")&&n.push("bug"),this._fetchState(e,n,i)},moveToGroup:function(e,t,i,n){var a=this.config.store;return this.strategy.moveToGroup(a,e,t,i,n)},isAvailableForItem:function(e,t,i){return this.strategy.isAvailableForItem(e,t,i)},getCommentRequirements:function(e,t,i){return this.strategy.getCommentRequirements(e,t,i)}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("userStories","userStory","priority",e)},_createDetailCommand:function(e){var t={};return t[e]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{project:["id"]}],t},_convertData:function(e){return e=t.prototype._convertData.call(this,e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(e){var t=this;e.project=e.project||{};var i={id:e.id,name:e.name,__type:e.__type,numericPriority:e.numericPriority,entityState:{id:e.entityState.id,name:e.entityState.name,isInitial:e.entityState.isInitial,isFinal:e.entityState.isFinal,numericPriority:e.entityState.numericPriority},tags:this._processTags(e),priority:{id:e.priority.id,name:e.priority.name,kind:t.importanceProcessor.getKind(e.priority.importance)},effort:this._getEffortData(e),assignments:this._processAssignments(e),projectId:e.project.id,entitiesCount:e["tasks-count"],url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};
return i.visibleEntityState=i.entityState,i}})}),define("tau/configurations/iteration.container.config",["tau/configurations/base.container.config","tau/models/model.extensions","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups","tau/ui/extensions/list/external.refresh.extension","tau/models/dataProviders/entity/entity.model.provider.bug.items","tau/models/dataProviders/release/release.model.provider.user_stories.items","tau/ui/extensions/list/request/extension.list.entityState"],function(e,t,i,n,a,r,s,o){return e.extend({init:function(e){this._super(e);var t=e.context.entity,i=e.context.configurator.getUrlBuilder();this.registerAction("Finish Iteration",{label:"Finish",url:i.getRelativeBoardPageUrl("finish-iteration/"+t.id),className:"tau-action-finish_iteration"}),this.registerPanel("Progress Bar",{type:"iteration.progressBar"});var n=this;this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:n.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"quick.add",printable:!1,property:"iteration",entityType:"userStory",evictProperties:["userStories","userStories-count"],label:"Add "+n.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],itemsDataProvider:s,views:[{type:"grid.entity"}],extensions:[o]}]}]}]}),this.registerTab("Bugs",{practices:["Bug Tracking"],label:"bugs",header:[{type:"label",text:n.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Bug Tracking"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Bug Tracking"],children:[{type:"quick.add",printable:!1,property:"iteration",entityType:"bug",practices:["Bug Tracking"],evictProperties:["bugs","bugs-count"],label:"Add "+n.getNames("Bug")},{type:"list.editable",practices:["Bug Tracking"],itemsDataProvider:r,views:[{type:"grid.entity"}],externalRefreshEvents:["bug.items.added"],extensions:[o]}]}]}]}),this.registerPanel("Can Be Finished",{type:"iteration.canBeFinished"})
},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Additional Info","Custom Fields","Can Be Finished"]},getActionsAliases:function(){return["Finish Iteration","Old Edit","Print","-----","Delete"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"userstory",relationName:"userStories"},{entityType:"bug",relationName:"bugs",practices:["Bug Tracking"]}]}},getTabsAliases:function(){return["Description","User Stories","Bugs","Relations","Time","History"]},getAdditionalInfoAliases:function(){return["Project","StartDate","FinishDate","Release For Iteration","Velocity","Assigned Effort"]}})}),define("tau/configurations/teamiteration.container.config",["tau/configurations/base.container.config","tau/models/model.extensions","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups","tau/ui/extensions/list/external.refresh.extension","tau/models/dataProviders/entity/entity.model.provider.bug.items","tau/models/dataProviders/release/release.model.provider.user_stories.items","tau/ui/extensions/list/request/extension.list.entityState"],function(e,t,i,n,a,r,s,o){var l=e.extend({init:function(t){e.prototype.init.call(this,t);var i=t.context.entity,n=t.context.configurator.getUrlBuilder();this.registerAction("Finish Iteration",{label:"Finish",url:n.getRelativeBoardPageUrl("finish-teamiteration/"+i.id),className:"tau-action-finish_iteration"}),this.registerPanel("Progress Bar",{type:"teamiteration.progressBar"});var a=this;this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:a.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"quick.add",printable:!1,property:"teamiteration",entityType:"userStory",evictProperties:["userStories","userStories-count"],label:"Add "+a.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],itemsDataProvider:s,views:[{type:"grid.entity"}],extensions:[o]}]}]}]}),this.registerTab("Bugs",{practices:["Bug Tracking"],label:"bugs",header:[{type:"label",text:a.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Bug Tracking"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Bug Tracking"],children:[{type:"quick.add",printable:!1,property:"teamiteration",entityType:"bug",practices:["Bug Tracking"],evictProperties:["bugs","bugs-count"],label:"Add "+a.getNames("Bug")},{type:"list.editable",practices:["Bug Tracking"],itemsDataProvider:r,views:[{type:"grid.entity"}],externalRefreshEvents:["bug.items.added"],extensions:[o]}]}]}]}),this.registerPanel("Can Be Finished",{type:"iteration.canBeFinished"})
},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Additional Info","Custom Fields","Can Be Finished"]},getActionsAliases:function(){return["Finish Iteration","Print","-----","Delete"]},getTabsAliases:function(){return["Description","User Stories","Bugs","Relations","History"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"userstory",relationName:"userStories"},{entityType:"bug",relationName:"bugs",practices:["Bug Tracking"]}]}},getAdditionalInfoAliases:function(){return["Team","StartDate","FinishDate","Velocity","Assigned Effort"]}});return l}),define("tau/models/dataProviders/feature/feature.model.provider.user_stories.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("userStories","userStory","priority",e)},_createDetailCommand:function(e){var t={};return t[e]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{project:["abbreviation"]},{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{project:["id"]}],t},_convertData:function(e){return e=t.prototype._convertData.call(this,e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(e){var t=this;e.project=e.project||{};var i={id:e.id,name:e.name,__type:e.__type,numericPriority:e.numericPriority,entityState:{id:e.entityState.id,name:e.entityState.name,isInitial:e.entityState.isInitial,isFinal:e.entityState.isFinal,numericPriority:e.entityState.numericPriority},tags:this._processTags(e),priority:{id:e.priority.id,name:e.priority.name,kind:t.importanceProcessor.getKind(e.priority.importance)},effort:this._getEffortData(e),assignments:this._processAssignments(e),projectId:e.project.id,project:{abbreviation:e.project.abbreviation},entitiesCount:e["tasks-count"],url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};
return i.visibleEntityState=i.entityState,i}})}),define("tau/models/dataProviders/model.provider.groups.user_stories",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(e,t){return t.extend({fetch:function(t,i,n){var a=e(i).pluck("projectId"),r=this.config.store,s={fields:[{process:["id"]}],list:!0};r.get("projects",s,{scope:this,success:this.onProjects(a,t,n)}).done()},onProjects:function(t,i,n){return function(a){var r=e(a.data).chain().select(function(i){return e(t).include(i.id)}).map(function(e){return e.process.id}).uniq().value(),s=function(t){var i=(t.entityType.name||"").toLowerCase();return"userstory"===i&&e(r).include(t.process.id)};return this._fetchState(i,s,n)}},fetchForGroup:function(){},moveToGroup:function(e,t,i,n){return this._moveToGroupByState(e,t,i,n)}})}),define("tau/models/dataProviders/feature/feature.model.provider.user_stories.groups",["Underscore","tau/models/dataProviders/model.provider.groups.user_stories","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(e,t,i){return t.extend({init:function(e){this._super(e),this.strategy=new i},moveToGroup:function(e,t,i,n){var a=this.config.store;return this.strategy.moveToGroup(a,e,t,i,n)},isAvailableForItem:function(e,t,i){return this.strategy.isAvailableForItem(e,t,i)},getCommentRequirements:function(e,t,i){return this.strategy.getCommentRequirements(e,t,i)}})}),define("tau/configurations/feature.container.config",["Underscore","jQuery","tau/configurations/base.container.config","tau/models/model.extensions","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover","tau/models/dataProviders/feature/feature.model.provider.user_stories.items","tau/models/dataProviders/feature/feature.model.provider.user_stories.groups","tau/ui/extensions/list/external.refresh.extension","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list/extension.list.refresher","tau/models/dataProviders/entity/entity.model.provider.bug.items"],function(e,t,i,n,a,r,s,o,l,u,c,d){return i.extend({init:function(e){this._super(e),this.registerPanel("Progress Bar",{type:"progressBar"}),this.registerPanel("Total Effort",{type:"totalEffort"}),this.registerPanel("Assignments",{type:"collapsible",collapsed:!1,stateName:"assignments",header:[{type:"label",text:"Assignments"}],items:[{type:"feature.assignmentList"}]}),this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:this.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"quick.add",printable:!1,property:"feature",entityType:"userStory",evictProperties:["userStories","userStories-count"],label:"Add "+this.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],multiprojects:!0,itemsDataProvider:s,views:[{type:"grid.entity"}],extensions:[u]}]}]}]}),this.registerTab("Bugs",{label:"bugs",practices:["Bug Tracking"],header:[{type:"label",text:this.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Bug Tracking"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Bug Tracking"],children:[{practices:["Bug Tracking"],type:"quick.add",printable:!1,property:"feature",entityType:"bug",evictProperties:["bugs","bugs-count"],label:"Add "+this.getNames("bug")},{type:"list.editable",extensions:[c,u],practices:["Bug Tracking"],externalRefreshEvents:["bug.items.added"],itemsDataProvider:d,multiprojects:!0,views:[{type:"grid.entity"}]}]}]}]})
},getTabsAliases:function(){return["Description","User Stories","Bugs","Relations","Flow","Time","History"]},getActionsAliases:function(){return["Attach to Request","Move or Copy","Copy to project","Convert","-----","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Total Effort","Assignments","Additional Info","Lead Cycle Time","Custom Fields"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"userstory",relationName:"userStories"},{entityType:"bug",relationName:"bugs",practices:["Bug Tracking"]},{entityType:"impediment",relationName:"impediments"}]}},getAdditionalInfoAliases:function(){return["Project","Team","Owner","Initial Estimate","Business Value","Release",this.configurator.getFeaturesService().isEnabled("entity.epics")?"Epic":"","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"]}})}),define("tau/models/dataProviders/model.provider.items.user_stories_bugs",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(e,t,i,n){return t.extend({init:function(e){this.config=e,this.providers=[new i(e)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new n(e))},_convertData:function(e){return e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},fetch:function(t){var i=this,n=function(e){var n=i._convertData(e);t(n)},a=[];e.forEach(i.providers,function(e){a.push(function(t){e.fetch(function(e){t(null,e)})})}),e.parallel(a,function(t,i){var a=e.flatten(i);n(a)})}})}),define("tau/models/dataProviders/release/release.model.provider.iterations.items",["Underscore","tau/models/dataProviders/model.provider.items.user_stories_bugs","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(e,t,i,n){return t.extend({init:function(e){this.config=e,e.additionalFields=["iteration"],this.providers=[new i(e)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new n(e))
},_convertData:function(i){return i=t.prototype._convertData.call(this,i),e.forEach(i,function(e){e.visibleEntityState=e.entityState}),this._sortByPriority(i)}})}),define("tau/models/dataProviders/release/release.model.provider.iterations.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e,t,i){var n=["userstory"];return this.config.context.isPracticeAvailable("Bug Tracking")&&n.push("bug"),this._fetchIterations(e,n,i)},_fetchIterations:function(t,n,a){var r=this.config.context,s=r.entity.id,o=this.config.store,l={id:s,nested:!0,fields:[{iterations:["id","name","startDate","endDate"]}]},u="d MMM",c=this.config.context.configurator.getUrlBuilder();o=o.get("release",l),o.done({success:function(t){var n=e.pluck(t,"data")[0].iterations,r=[];n=e.sortBy(n,function(e){return-1*i.parse(e.startDate)}),e.forEach(n,function(e){var t=i.parse(e.startDate);t=i.convertToTimezone(t);var n=i.parse(e.endDate);n=i.convertToTimezone(n);var a=!0,o=!1;i.Date.today().between(t,n)&&(a=!1,o=!0);var l=t.toString(u)+" / "+n.toString(u);l=l+" ("+Math.floor((n.getTime()-t.getTime())/1e3/60/60/24+1)+" days)",o&&(l+=" (current)"),e.url=c.getNewViewUrl(e.id,e.__type,!0),e.releaseId=s,r.push({key:e.id,title:e.name,subtitle:l,collapsed:a,realGroup:e})}),r.unshift({key:null,title:"Backlog",collapsed:!0,realGroup:{id:null,releaseId:s}}),e.forEach(r,function(e){e.items=[]}),a(r)},scope:this})},moveToGroup:function(e,t,i,n){return this._moveToGroupByIteration(e,t,i,n)},_moveToGroupByIteration:function(t,i,n,a){var r=this.config.store,s=i.realGroup;if(!s||t.iteration&&s.id==t.iteration.id)return void a.call(null);var o=[],l={release:{id:s.releaseId},iteration:s.id?{id:s.id}:null};o.push(function(e){r.save(t.__type,{id:t.id,$set:l,fields:["id",{iteration:["id"]}]}).done({success:function(){e(null,arguments)}})}),o.push(function(e){r.get(t.__type,{id:t.id,fields:["id",{iteration:["id"]}]}).done({success:function(t){e(null,t[0].data)
}})}),e.series(o,function(t,i){e.isFunction(a)&&a.call(null,{changed:i[1]})})}})}),define("tau/ui/extensions/list/iterations/extension.list.release_iterations",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus preDataBind":function(e){var t=e.data;t.isEmpty=t.groups.length<=1?!0:!1}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories_bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.user_stories_bugs","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(e,t,i,n){return t.extend({init:function(e){this.config=e,e.additionalFields=["iteration"],this.providers=[new i(e)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new n(e))},_convertData:function(e){var i=t.prototype._convertData.call(this,e);return this._sortByPriority(i)}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories_bugs.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states"],function(e,t,i){return t.extend({init:function(e){this._super(e),this.strategy=new i},fetch:function(e,t,i){var n=["userstory"];return this.config.context.isPracticeAvailable("Bug Tracking")&&n.push("bug"),this._fetchState(e,n,i)},moveToGroup:function(e,t,i,n){var a=this.config.store;return this.strategy.moveToGroup(a,e,t,i,n)},isAvailableForItem:function(e,t,i){return this.strategy.isAvailableForItem(e,t,i)},getCommentRequirements:function(e,t,i){return this.strategy.getCommentRequirements(e,t,i)}})}),define("tau/models/dataProviders/release/release.model.provider.features.items",["Underscore","jQuery","tau/models/dataProviders/model.provider.items.base"],function(e,t,i){return i.extend({fetch:function(e){this._fetch("features","feature","severity",e)},_chainResponse:function(i){var n=this,a=n.config.store,r=t.Deferred();return r.pipe(function(t){var n=e(t[1].data.features).chain().map(function(e){var t=e.project||{process:{id:null}};
return t.process.id}).uniq().without(null).value();if(n.length>0){var r={fields:["id",{entityStates:["id",{role:["id","name","hasEffort"]},{entityType:["id","name"]}]}],$query:{id:{$in:n}},list:!0};a.get("process",r).done(function(){i(t)})}else i(t)}),r.resolve},_createDetailCommand:function(e){var t={};return t[e]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{priority:["id","name","importance"]},{project:["id",{process:["id"]}]}],t},_convertData:function(e){return e=this._super(e),e=this._calculateEffortToMaximum(e),this._sortByPriority(e)},_convertItem:function(e){var t=this;e.project=e.project||{};var i={id:e.id,name:e.name,numericPriority:e.numericPriority,__type:e.__type,entityState:{id:e.entityState.id,name:e.entityState.name,isInitial:e.entityState.isInitial,isFinal:e.entityState.isFinal,numericPriority:e.entityState.numericPriority},tags:this._processTags(e),effort:this._getEffortData(e),assignments:this._processAssignments(e),priority:{id:e.priority.id,name:e.priority.name,kind:t.importanceProcessor.getKind(e.priority.importance)},projectId:e.project.id,entitiesCount:0,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};return i.visibleEntityState=i.entityState,i}})}),define("tau/configurations/release.container.config",["tau/configurations/base.container.config","tau/models/model.extensions","tau/models/dataProviders/release/release.model.provider.iterations.items","tau/models/dataProviders/release/release.model.provider.iterations.groups","tau/ui/extensions/list/iterations/extension.list.release_iterations","tau/models/dataProviders/release/release.model.provider.user_stories_bugs.items","tau/models/dataProviders/release/release.model.provider.user_stories_bugs.groups","tau/models/dataProviders/release/release.model.provider.features.items","tau/models/dataProviders/entity/entity.model.provider.bug.items","tau/models/dataProviders/release/release.model.provider.user_stories.items","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list/external.refresh.extension"],function(e,t,i,n,a,r,s,o,l,u,c){return e.extend({init:function(e){this._super(e),this.registerPanel("Progress Bar",{type:"release.progressBar"}),this.registerTab("Iterations",{practices:["Iterations"],label:"iterations",header:[{type:"label",text:this.getNames("iteration"),countFieldNames:["iterations"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Iterations"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Iterations"],children:[{practices:["Iterations"],type:"list",itemsDataProvider:i,groupsDataProvider:n,groupBy:"iteration.id",extensions:[a],externalRefreshEvents:["iteration.items.added"],views:[{type:"grid.entity",group:{dataIndex:"id"}}]}]}]}]});
var t=this;this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:t.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"quick.add",printable:!1,property:"release",entityType:"userStory",evictProperties:["userStories","userStories-count"],label:"Add "+t.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],itemsDataProvider:u,views:[{type:"grid.entity"}],extensions:[c]}]}]}]}),this.registerTab("Bugs",{practices:["Bug Tracking"],label:"bugs",header:[{type:"label",text:t.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Bug Tracking"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Bug Tracking"],children:[{type:"quick.add",printable:!1,property:"release",entityType:"bug",evictProperties:["bugs","bugs-count"],label:"Add "+t.getNames("Bug"),practices:["Bug Tracking"]},{type:"list.editable",itemsDataProvider:l,externalRefreshEvents:["bug.items.added"],views:[{type:"grid.entity"}],practices:["Bug Tracking"],extensions:[c]}]}]}]}),this.registerTab("Features",{practices:["Requirements"],label:"features",header:[{type:"label",text:t.getNames("feature"),countFieldNames:["features"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Requirements"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Requirements"],children:[{type:"quick.add",printable:!1,property:"release",entityType:"feature",evictProperties:["features","features-count"],label:"Add "+t.getNames("Feature"),practices:["Requirements"]},{practices:["Requirements"],type:"list.editable",externalRefreshEvents:["feature.items.added"],itemsDataProvider:o,views:[{type:"grid.entity"}]}]}]}]}),this.registerTab("Release Notes",{label:"notes",header:[{type:"label",text:"Notes"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"releaseNotes"}]}]}]})
},getAdditionalInfoAliases:function(){return["Project","StartDate","FinishDate","Release Assigned Effort"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Additional Info","Custom Fields"]},getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"iteration",relationName:"iterations",practices:["Iterations"]},{entityType:"feature",relationName:"features",practices:["Requirements"]},{entityType:"userstory",relationName:"userStories"},{entityType:"bug",relationName:"bugs",practices:["Bug Tracking"]}]}},getTabsAliases:function(){return["Description","Iterations","User Stories","Bugs","Features","Release Notes","Relations","Time","History"]}})}),define("tau/configurations/build.container.config",["tau/configurations/base.container.config"],function(e){var t=e.extend({init:function(e){this._super(e),this.registerAdditionalInfoItem("BuildDate",{label:{text:this.getTermName("Build")+" Date"},field:{type:"property.buildDate",editable:!0}})},getTabsAliases:function(){return["Description","Relations","Time","History"]},getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Project","Owner","BuildDate","Release","Iteration"]}});return t}),define("tau/configurations/impediment.container.config",["Underscore","tau/configurations/base.container.config"],function(e,t){return t.extend({getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},getTabsAliases:function(){return["Description","Relations","Time","History"]},getAdditionalInfoAliases:function(){return["Project","State","ImpedimentDate","StartDate","ResolvedOn","Priority","Assignable","Owner","Responsible","IsPrivate","PlannedStartDate","PlannedEndDate"]}})}),define("tau/models/dataProviders/project/project.model.provider.releases.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e){this._fetch("iterations","iteration",!1,e)
},_createDetailCommand:function(e){var t={};return t[e]=["id","name","tags","startDate","endDate","canBeFinished",{release:["id","name"]},"bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"],t},_getAssignedEffort:function(e){var t={},i=0,n=0;return i+=e["bugs-effortToDo-sum"],i+=e["userStories-effortToDo-sum"],n+=e["bugs-effortCompleted-sum"],n+=e["userStories-effortCompleted-sum"],t.value=Math.round(100*(i+n))/100,t.unit=this.config.context.getEffortPoint(e.__type),t},_convertItem:function(e){var t={id:e.id,name:e.name,__type:e.__type,tags:this._processTags(e),release:e.release,assignedEffort:this._getAssignedEffort(e),startDate:i.format.date.short(i.convertToTimezone(e.startDate)),endDate:i.format.date.short(i.convertToTimezone(e.endDate)),url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};return t},_convertData:function(e){return e=this._super(e),this._sortByStartDate(e)},_sortByStartDate:function(t){return e.sortBy(t,function(e){return-1*e.startDate})}})}),define("tau/models/dataProviders/project/project.model.provider.releases.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e,t,i){return this._fetchReleases(e,t,i)},_fetchReleases:function(t,n,a){var r=this.config.context,s=(r.entity.entityType.name,r.entity.id),o=this.config.store,l=this,u={id:s,nested:!0,fields:[{releases:["id","name","startDate","endDate"]}]};o.get("project",u).done({success:function(t){var n=e(t).pluck("data")[0].releases;n=e.sortBy(n,function(e){return-1*i.parse(e.startDate)});var r=[];e.forEach(n,function(e){r.push(l._processRelease(e))}),e.forEach(r,function(e){e.items=[]}),a(r)}})},_processRelease:function(e){var t=i.parse(e.startDate);t=i.convertToTimezone(t);var n=i.parse(e.endDate);n=i.convertToTimezone(n);var a=!0,r=!1;i.Date.today().between(t,n)&&(a=!1,r=!0);var s="d MMM",o=i.formatAs(t,s)+" / "+i.formatAs(n,s);
o=o+" ("+Math.floor((n.getTime()-t.getTime())/1e3/60/60/24+1)+" days)",r&&(o+=" (current)"),e.url=this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0);var l={key:e.id,title:e.name,subtitle:o,collapsed:a,realGroup:e};return l}})}),define("tau/models/dataProviders/project/project.model.provider.teams.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({sparklineLength:16,fetch:function(e){this._fetch("teamProjects","teamProject",!1,e)},_createDetailCommand:function(e){var t={};return t[e]=["id",{team:["id","name","icon",{teamMembers:[{user:["id","firstName","lastName","avatarUri"]}]}]}],t},_fetch:function(e,t,i,n){var a=this,r=this.config.context.entity,s=this.config.context.configurator;$.ajax({url:s.getApplicationPath()+"/api/v2/TeamProject?select={"+["id","isProjectAccessed","Project.ProjectMembers.Select(User.id) as projectMembers","Project.ProjectMembers.Count() as projectMembersCount",'"TeamProject" as __type',"new("+["Team.id","Team.name","Team.icon","Team.TeamMembers.Select({User.id, User.firstName, User.lastName, User.avatarUri}) AS members",'Team.Assignables.Count(entityType.Name == "Bug" and entityState.IsFinal != true) as openBugsCount','Team.Assignables.Count(entityType.Name == "Bug" and entityState.IsFinal == true) as closedBugsCount','Team.Assignables.Count(entityType.Name == "UserStory" and entityState.IsFinal != true) as openUsCount','Team.Assignables.Count(entityType.Name == "UserStory" and entityState.IsFinal == true) as closedUsCount','Team.Assignables.Where(entityType.Name == "UserStory" and Project.id = '+r.id+").Sparkline("+this.sparklineLength+") as userStoriesSparkline",'Team.Assignables.Where(entityType.Name == "Bug" and Project.id = '+r.id+").Sparkline("+this.sparklineLength+") as bugsSparkline"].join(",")+") as team"].join(",")+"}&where=(Project.id=="+r.id+")"}).done(function(e){n(a._convertData(e.items))}).fail(function(){n(a._convertData([]))})},_convertData:function(e){return e=this._super(e),this._sortByPriority(e)
},_sortByPriority:function(t){return e.sortBy(t,function(e){return-1*e.id})},_convertItem:function(t){var i=t.team.members;t.team.teamMembers=e.map(i,function(e){return e.id});var n=this.config.context.configurator.getLoggedUser(),a=e.find(i,function(e){return e.id==n.id});a&&(i=e.reject(i,function(e){return e.id==n.id}),i.unshift(a));var r=7,s=!1;i.length>r&&(s=!0,i=i.slice(0,r)),i=e.map(i,function(t){return t.name=e.trim(t.firstName+" "+t.lastName),t.uri="#user/"+t.id,t});var o=t.team.userStoriesSparkline,l=t.team.bugsSparkline,u=this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.team.id,"team",!0),c={id:t.id,__type:"teamProject",isProjectAccessed:t.isProjectAccessed,projectMembers:t.projectMembers,team:t.team,members:i,membersMore:s,teamMembersCount:t.team.teamMembers.length,teamMembersInProjectCount:e.intersection(t.team.teamMembers,t.projectMembers).length,uri:u,membersUri:u+"/members",appPath:this.config.context.configurator.getApplicationPath(),userStoriesSparkline:o,bugsSparkline:l};return c}})}),define("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach.base",["Underscore","jQuery","tau/core/extension.base.stateful"],function(e,t,i){return i.extend({"bus afterRender":function(i){i.data.element.on("click",".tau-unassign",function(i){var n=t(i.currentTarget);n.tauConfirm({content:["<h3>"+n.data("confirmMessage")+"</h3>"].join(""),callbacks:{success:this._actionSuccess.bind(this,n)},zIndex:130}),e.delay(e.bind(n.tauConfirm,n),100,"show")}.bind(this))},_actionSuccess:function(e){var t=e.parents("[role=item]:first");this._detach(t.data())},_detach:function(){throw new Error("not implemented")}})}),define("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach",["jQuery","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach.base"],function(e,t){return t.extend({_detach:function(t){var i=this.config.context.configurator,n=i.getStore(),a=this.config.context.entity,r=a.entityType.name,s=e.Deferred();
return n.removeFromList(r,{id:a.id,$set:{teamProjects:{id:t.entityId}}}).done({success:function(){n.evictProperties(a.id,r,["teamProjects"]),n.get(r,{id:a.id,fields:["id",{teamProjects:["id"]}]}).done(s.resolve.bind(s))}}),s.promise()}})}),define("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.assign.base",["tau/core/extension.base.stateful"],function(e){return e.extend({"bus afterRender":function(e,t){{var i=t.element,n=_.bind(this._getTeamProject,this),a=this.config.context.configurator.getStore(),r=this.config.context.entity;this.bus}i.on("click","[role=assign-all]",function(e){e.preventDefault();var i=$(e.currentTarget),s=_.bind(function(){var e=i.parents("[role=item]:first"),s=e.data(),o=_.find(t.data.items,function(e){return e.id==s.entityId}),l=n(r,t,o),u={projectMembers:_.map(_.difference(l.team.teamMembers,l.project.projectMembers),function(e){return{user:{id:e}}})};a.save("project",{id:l.project.id,$set:u,fields:["id","name","color",{projectMembers:[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}]}]}).done()},this);i.tauConfirm({content:["<h3>"+i.data("confirmMessage")+"</h3>"].join(""),callbacks:{success:s},zIndex:130}),_.delay(_.bind(i.tauConfirm,i),100,"show")})},_getTeamProject:function(){throw new Error("TeamProject should be provided")}})}),define("tau/ui/extensions/list/project/ui.extension.list.project.teams.action.assign",["tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.assign.base"],function(e){return e.extend({_getTeamProject:function(e,t,i){return{id:i.id,project:{id:e.id,projectMembers:i.projectMembers},team:{id:i.team.id,teamMembers:i.team.teamMembers}}}})}),define("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.access",["tau/core/extension.base.stateful"],function(e){return e.extend({"bus afterRender":function(e){{var t=e.data.element,i=this.config.context.configurator.getStore();this.config.context.entity,this.bus}t.on("click","[role=auto-assign]",function(e){var t=$(e.currentTarget),n=t.parents("[role=item]:first"),a=n.data();
i.save("teamProject",{id:a.entityId,$set:{isProjectAccessed:t.is(":checked")},fields:["id"]}).done({success:function(){},failure:function(){i.get("teamProject",{id:a.entityId,fields:["id","isProjectAccessed"]}).done(function(e){t.prop("checked",e[0].data.isProjectAccessed)})}})})}})}),define("tau/ui/extensions/list/project/ui.extension.list.project.teams.refresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator,n=i.getStore(),a=this;n.unbind(this),n.on({eventName:"afterSave",type:"project",listener:this,hasChanges:["teamProjects|projectMembers"]},function(){a.fire("refresh")}),this.on("destroy",function(){n.unbind(a)})}})}),define("tau/libs/sparklines/sparklines",["tau/core/class"],function(e){return Array.prototype.map&&require(["libs/d3/d3"],function(){}),e.extend({init:function(e){this.config=_.defaults(e,{width:100,height:50,letterWidth:7.5,letterHeight:8,emptyStart:8}),this.config.padding=this.config.padding||this.config.letterHeight+1,this.config.percent=Math.ceil(this.config.height/100)},createDrawData:function(e){for(var t=e.len||15,i=e.currentWeek,n=e.opened,a=e.closed,r=[],s=i-t;i>=s;s++){var o={open:0,closed:0},l=_.find(n,function(e){return s==e.key});o.open=l?l.count:0;var u=_.find(a,function(e){return s==e.key});o.closed=u?u.count:0,r.push(o)}return r},draw:function(e,t){var i=!1;if(null===e){var n=$(t).data("source");e=this.createDrawData(n),i=$(t).is(".tau-sparkline-bugs")}var a=this.config,r=d3.select(t||$("<svg />")[0]).attr("width",a.width).attr("height",a.height),s=_.pluck(e,"open"),o=_.pluck(e,"closed"),l=Math.max.apply(null,s),u=Math.max.apply(null,o),c=Math.max.apply(null,[l,u]),d=2;e.length&&(d=Math.max.apply(null,[(""+_.last(o)).length,(""+_.last(s)).length,2]));var p=d*a.letterWidth,f=_.all(o.slice(0,this.config.emptyStart),function(e){return 0==e}),m=_.all(s.slice(0,this.config.emptyStart),function(e){return 0==e}),h=f&&m;return this.drawTop(r,{items:o,max:c,legendSpace:p,height:a.height,width:a.width,padding:a.padding,percent:a.percent,emptyStartLabel:h?i?"fixed":"done":!1}),this.drawBottom(r,{items:s,max:c,legendSpace:p,height:a.height,width:a.width,padding:a.padding,percent:a.percent,emptyStartLabel:h?"added":!1}),r[0]
},drawTop:function(e,t){var i=t.items,n=t.legendSpace,a=t.max,r=t.height,s=t.width,o=t.padding,l=t.percent,u=e.append("g").attr("transform","translate(0,"+o+")"),c=null,d=null,p=null;i.length&&(c=_.reduce(i,function(e,t,i){return t>e.value?{index:i,value:t}:e},{index:0,value:i[0]}),c.index==i.length-1&&(c=null),d=_.last(i),p=_.reduce(i,function(e,t){return e?e.concat({diff:t-_.last(e).to,to:t,from:_.last(e).to}):[{diff:t,to:t,from:0}]},null));var f=_.all(i.slice(0,this.config.emptyStart),function(e){return 0==e}),m=d3.scale.ordinal().domain(_.keys(i)).rangeRoundBands([0,s-n]),h=m.rangeBand(),g=d3.scale.linear().domain([0,a]).range([r/2-o,0]),v=d3.scale.linear().domain([0,a]).range([0,r/2-o]);return 0==i.length?void this.drawAxis(u,_.extend(t,{scaleY:g})):(u.selectAll(".tau-sparkline__openbar").data(i).enter().append("rect").attr("class","tau-sparkline__openbar").attr("x",function(e,t){return m(t)}).attr("y",g).attr("height",v).attr("width",h),this.drawAxis(u,_.extend(t,{scaleY:g})),u.selectAll(".tau-sparkline__openmark").data(i).enter().append("rect").attr("class","tau-sparkline__openmark").attr("x",function(e,t){return m(t)}).attr("y",g).attr("height",function(e){return 0==e?0:l}).attr("width",h),u.selectAll(".tau-sparkline__diffmark-open").data(p).enter().append("rect").attr("class","tau-sparkline__diffmark-open").attr("x",function(e,t){return m(t)-1}).attr("y",function(e){return g(Math.max(e.from,e.to))+(e.diff>0?0:1)}).attr("height",function(e){return v(Math.abs(e.diff))}).attr("width",1),c&&u.selectAll("text").data([c]).enter().append("text").text(function(e){return e.value||""}).attr("x",function(e){return m(e.index)+(e.index?h/2:0)}).attr("y",function(e){return g(e.value)}).attr("text-anchor",function(e){return e.index?e.index==i.length-1?"right":"middle":"left"}).attr("dy",-2),u.selectAll("text.legend").data([d]).enter().append("text").attr("class","legend").text(function(e){return e}).attr("x",function(){return s-n}).attr("y",function(e){return g(e)+o/2>g(0)?g(0)-o/2:g(e)
}).attr("text-anchor","right").attr("dx",l).attr("dy",(o-1)/2),void(f&&t.emptyStartLabel&&u.selectAll("text.tau-sparkline__emptylegend").data([t.emptyStartLabel]).enter().append("text").attr("class","tau-sparkline__emptylegend").text(function(e){return e||""}).attr("x",function(){return m(0)}).attr("y",function(){return g(0)-o/2-3}).attr("text-anchor","left").attr("dx",l).attr("dy",(o-1)/2)))},drawBottom:function(e,t){var i=t.items,n=t.legendSpace,a=t.max,r=t.height,s=t.width,o=t.padding,l=t.percent;if(0!=i.length){var u=e.append("g").attr("transform","translate(0,"+r/2+")"),c=_.reduce(i,function(e,t,i){return t>e.value?{index:i,value:t}:e},{index:0,value:i[0]}),d=_.last(i);c.index==i.length-1&&(c=null);var p=_.all(i.slice(0,this.config.emptyStart),function(e){return 0==e}),f=_.reduce(i,function(e,t){return e?e.concat({diff:t-_.last(e).to,to:t,from:_.last(e).to}):[{diff:t,to:t,from:0}]},null),m=d3.scale.ordinal().domain(_.keys(i)).rangeRoundBands([0,s-n]),h=m.rangeBand(),g=d3.scale.linear().domain([0,a]).range([0,r/2-o]),v=d3.scale.linear().domain([0,a]).range([0,r/2-o]);u.selectAll(".tau-sparkline__closedmark").data(i).enter().append("rect").attr("class","tau-sparkline__closedmark").attr("x",function(e,t){return m(t)}).attr("y",g).attr("height",function(e){return 0==e?0:l}).attr("width",h),u.selectAll(".tau-sparkline__diffmark-closed").data(f).enter().append("rect").attr("class","tau-sparkline__diffmark-closed").attr("x",function(e,t){return m(t)-1}).attr("y",function(e){return g(Math.min(e.from,e.to))+(e.diff>0?1:0)}).attr("height",function(e){return v(Math.abs(e.diff))}).attr("width",1),c&&u.selectAll("text").data([c]).enter().append("text").text(function(e){return e.value||""}).attr("x",function(e){return m(e.index)+(e.index?h/2:0)}).attr("y",function(e){return g(e.value)+o}).attr("text-anchor",function(e){return e.index?e.index==i.length-1?"right":"middle":"left"}),u.selectAll("text.legend").data([d]).enter().append("text").attr("class","legend").text(function(e){return e
}).attr("x",function(){return s-n}).attr("y",function(e){return g(e)-o/2<g(0)?o/2:g(e)}).attr("text-anchor","right").attr("dx",l).attr("dy",(o-l)/2),p&&t.emptyStartLabel&&u.selectAll("text.tau-sparkline__emptylegend").data([t.emptyStartLabel]).enter().append("text").attr("class","tau-sparkline__emptylegend").text(function(e){return e||""}).attr("x",function(){return m(0)}).attr("y",function(){return g(0)+o/2+2}).attr("text-anchor","left").attr("dx",l).attr("dy",(o-l)/2)}},drawAxis:function(e,t){e.append("rect").attr("class","tau-sparkline__axis").attr("y",t.scaleY(0)).attr("x",0).attr("width",t.width-t.legendSpace).attr("height",t.percent)}})}),define("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.sparklines",["tau/core/extension.base","tau/libs/sparklines/sparklines"],function(e,t){return e.extend({"bus dataBind + afterRender":function(e,i,n){var a=n.element,r=a.find(".i-role-sparkline"),s={width:100,height:50,letterWidth:9,letterHeight:9};r.each(function(){var e=new t(s);e.draw(null,this)})}})}),define("tau/ui/templates/list_/project/ui.template.list.project.teams",["tau/core/templates-factory"],function(e){var t={name:"list.project.teams",engine:"jqote2",markup:['<div class="tau-team-control">',"<% if (this.items.length){ %>",'<table class="tau-team-info">',"<colgroup>",'<col class="tau-team">','<col class="tau-us-progress">','<col class="tau-us-total">','<col class="tau-bug-progress">','<col class="tau-bug-total">','<col class="tau-assign-info">',"</colgroup>","<thead>","<tr>","<th>Team</th>",'<th><i class="tau-entity-icon tau-entity-icon--userstory"><%=fn.term("userStory", "iconSmall")%></i><%=fn.term("userStory", "names")%></th>',"<th>Done / Open</th>",'<th><i class="tau-entity-icon tau-entity-icon--bug"><%=fn.term("bug", "iconSmall")%></i><%=fn.term("bug", "names")%></th>',"<th>Done / Open</th>","<th>Assigned People</th>","</tr>","</thead>","<tbody>","<% _.forEach(this.items, function(item){ %>",'<tr class="i-role-item" role="item" data-entity-id="<%= item.id %>">',"<td>",'<div class="tau-team">',"<h3>",'<a href="<%= item.uri %>">','<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= item.team.icon || "" %>"></i>',"<%! item.team.name %>","</a>",'<span class="tau-unassign" title="Unassign team from project?" ',"data-confirm-message=\"Are you sure you want to remove team '<%! item.team.name %>' from this project?\"></span>","</h3>",'<div class="tau-team-members">',"<div>",'<a href="<%= item.membersUri %>" title="Go to team members">',"<% _.forEach(item.members, function(user){ %>",'<img src="<%= user.avatarUri %>20">',"<% }); %>","</a>","</div>","<% if (item.membersMore) { %>",'<a class="tau-more" href="<%= item.membersUri %>" title="Go to team members">','<img src="<%= item.appPath %>/JavaScript/tau/css/images/more-members.gif" class="tau-more">',"</a>","<% } %>","</div>","</div>","</td>",'<td title="User Stories sparkline provides an overview of progress over the last 16 weeks. The numbers shown are: a maximum of user stories done/added at any given week out of those 16, and done/added in the current calendar week (on the right).">',"<svg class=\"tau-sparkline i-role-sparkline\" data-source='<%= JSON.stringify(item.userStoriesSparkline) %>'></svg>","</td>","<td>",'<div class="tau-fraction tau-userstory">','<span title="done"><%= item.team.closedUsCount %></span><br>','<b title="open"><%= item.team.openUsCount %></b>',"</div>","</td>",'<td title="Bugs sparkline provides an overview of progress over the last 16 weeks. The numbers shown are: a maximum of bugs fixed/added at any given week out of those 16, and fixed/added in the current calendar week (on the right).">',"<svg class=\"tau-sparkline tau-sparkline-bugs i-role-sparkline\" data-source='<%= JSON.stringify(item.bugsSparkline) %>'></svg>","</td>","<td>",'<div class="tau-fraction tau-bug">','<span title="done"><%= item.team.closedBugsCount %></span><br>','<b title="open"><%= item.team.openBugsCount %></b>',"</div>","</td>",'<td class="tau-assign-info">','<div class="tau-count" title="<%if (item.teamMembersInProjectCount === 0){%>No<%}%><% else {%><%= item.teamMembersInProjectCount%><%}%><% if (item.teamMembersInProjectCount !== 1){%> people<%}%><% else {%> person<%}%> in this Team assigned to Project"><%= item.teamMembersInProjectCount %> of <%= item.teamMembersCount %>','<a href="" class="i-role-item" role="assign-all" title="All people in the Team will be assigned to this Project" <% if (item.teamMembersInProjectCount === item.teamMembersCount) { %>style="display: none;"<% } %> data-confirm-message="Are you sure you want to assign all people from team \'<%! item.team.name %>\' to project?">Assign all</a>',"</div>",'<div class="tau-auto-assign">','<label class="tau-checkbox" title="Any new person in the Team will be auto-assigned to this Project">','<input type="checkbox" class="i-role-item" role="auto-assign" <% if (item.isProjectAccessed) { %> checked<% } %>><i class="tau-checkbox__icon"></i><span>Auto-assign new people</span>',"</label>","</div>","</td>","</tr>","<% }); %>","</tbody>","</table>","<% }else{ %>",'<div class="tau-message">This project has no teams</div>',"<% } %>","</div>"]};
return e.register(t)}),define("tau/ui/extensions/list/extension.list.checkEmpty",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus preDataBind":function(e){var t=e.data;t.isEmpty=0==t.groups.length?!0:!1}})}),define("tau/models/dataProviders/project/project.model.provider.releases_flat.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(e,t,i){return t.extend({fetch:function(e){this._fetch("releases","release",!1,e)},_createDetailCommand:function(e){var t={};return t[e]=["id","name","tags","startDate","endDate"],t},_convertItem:function(e){var t=i.parse(e.startDate),n=i.parse(e.endDate),a=!1;i.Date.today().between(t,n)&&(a=!0);var r={id:e.id,name:e.name+(a?" (current)":""),__type:e.__type,tags:this._processTags(e),startDate:i.format.date.short(e.startDate),endDate:i.format.date.short(e.endDate),url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)};return r},_convertData:function(e){return e=this._super(e),this._sortByStartDate(e)},_sortByStartDate:function(t){return e.sortBy(t,function(e){return-1*e.startDate})}})}),define("tau/models/dataProviders/model.provider.members.items",["Underscore","jQuery","tau/models/dataProviders/model.provider.items.base"],function(e,t,i){return i.extend({sparklineLength:16,fetchStrategy:{project:{collectionName:"projectMembers",typeName:"projectMember"},team:{collectionName:"teamMembers",typeName:"teamMember"}},fetch:function(e){var t=(this.config.context.entity.entityType.name||"").toLowerCase(),i=this.fetchStrategy[t];if(!i)throw new Error("Unknown fetch strategy");this._fetch(i.collectionName,i.typeName,null,e)},_createDetailCommand:function(e){var t={};return t[e]=["id",{user:["id","firstName","lastName","email","avatarUri","IsAdministrator","isActive","bug-count","userStorie-count"]},{role:["id","name"]}],t},_fetch:function(e,i,n,a){var r=this,s=this.config.context.entity,o=s.entityType.name,l=this.config.context.configurator;
t.ajax({url:l.getApplicationPath()+"/api/v2/"+i+"?select={"+["id",'"'+i+'" as __type',"new("+["User.id","User.firstName","User.lastName","User.email","User.avatarUri","User.isActive","User.isAdministrator",'User.Assignables.Count(entityType.Name == "Bug" AND entityState.IsFinal != true AND '+o+".id = "+s.id+") as bugsCount",'User.Assignables.Count(entityType.Name == "Task" AND entityState.IsFinal != true AND '+o+".id = "+s.id+") as tasksCount",'User.Assignables.Count(entityType.Name == "UserStory" AND entityState.IsFinal != true AND '+o+".id = "+s.id+") as userStoriesCount","User.Assignables.Where("+o+".id = "+s.id+").Sparkline("+this.sparklineLength+") as allSparkline"].join(",")+") as user","new("+["Role.id","Role.name"].join(",")+") as role "].join(",")+"}&where=("+o+".id=="+s.id+")&take=1000"}).done(function(e){a(r._convertData(e.items))}).fail(function(){a(r._convertData([]))})},_convertItem:function(t){t.user.name=e.trim(e.asString(t.user.firstName)+" "+e.asString(t.user.lastName))||"",t.user.url=this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.user.id,"user",!0);var i=this.config.context.configurator,n={id:t.id,__type:t.__type,user:t.user,role:t.role,appPath:i.getApplicationPath(),doneSparkline:t.user.doneSparkline,allSparkline:t.user.allSparkline};return i.getStore().register(n),n}})}),define("tau/ui/extensions/list/members/extension.list.members.action.detach",["tau/core/extension.base.stateful"],function(e){return e.extend({"bus afterRender":function(e){var t=e.data.element,i=this.config.context.configurator.getStore(),n=this.config.context.entity,a=n.entityType.name,r=a+"Members";t.delegate("[role=action-detach]","click",function(e){var t=$(e.target),s=t.parents("[role=item]:first"),o={};o[r]={id:s.data("entityId")},i.removeFromList(a,{id:n.id,$set:o}).done({success:function(){i.evictProperties(n.id,a,[r])}})})}})}),define("tau/ui/extensions/list/members/extension.list.members.refresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context,n=i.configurator,a=i.entity,r=a.entityType.name,s=r+"Members",o=this,l=n.getStore();
l.unbind(this),l.on({eventName:"afterSave",type:r,listener:this,hasChanges:[s]},function(){o.fire("refresh")})}})}),define("tau/libs/sparklines/sparklines.user",["tau/libs/sparklines/sparklines"],function(e){return e.extend({drawBottom:function(e,t){var i=t.items,n=t.legendSpace,a=t.max,r=t.height,s=t.width,o=t.padding,l=t.percent;if(0!=i.length){var u=e.append("g").attr("transform","translate(0,"+r/2+")"),c=_.reduce(i,function(e,t,i){return t>e.value?{index:i,value:t}:e},{index:0,value:i[0]}),d=_.last(i);c.index==i.length-1&&(c=null);var p=_.all(i.slice(0,this.config.emptyStart),function(e){return 0==e}),f=d3.scale.ordinal().domain(_.keys(i)).rangeRoundBands([0,s-n]),m=f.rangeBand(),h=d3.scale.linear().domain([0,a]).range([0,r/2-o]),g=d3.scale.linear().domain([0,a]).range([0,r/2-o]);u.selectAll(".tau-sparkline__closedbar").data(i).enter().append("rect").attr("class","tau-sparkline__closedbar").attr("x",function(e,t){return f(t)+m/2-.5}).attr("y",h(0)).attr("height",g).attr("width",1),c&&u.selectAll("text").data([c]).enter().append("text").text(function(e){return e.value||""}).attr("x",function(e){return f(e.index)+(e.index?m/2:0)}).attr("y",function(e){return h(e.value)+o}).attr("text-anchor",function(e){return e.index?e.index==i.length-1?"right":"middle":"left"}),u.selectAll("text.legend").data([d]).enter().append("text").attr("class","legend").text(function(e){return e}).attr("x",function(){return s-n}).attr("y",function(e){return h(e)-o/2<h(0)?o/2:h(e)}).attr("text-anchor","right").attr("dx",l).attr("dy",(o-l)/2),p&&t.emptyStartLabel&&u.selectAll("text.tau-sparkline__emptylegend").data([t.emptyStartLabel]).enter().append("text").attr("class","tau-sparkline__emptylegend").text(function(e){return e||""}).attr("x",function(){return f(0)}).attr("y",function(){return h(0)+o/2+2}).attr("text-anchor","left").attr("dx",l).attr("dy",(o-l)/2)}}})}),define("tau/ui/extensions/list/members/extension.list.members.sparklines",["tau/core/extension.base","tau/libs/sparklines/sparklines.user"],function(e,t){return e.extend({"bus dataBind + afterRender":function(e,i,n){var a=n.element,r=a.find(".i-role-sparkline"),s={width:100,height:50,letterWidth:9,letterHeight:9};
r.each(function(){var e=new t(s);e.draw(null,this)})}})}),define("tau/ui/templates/list_/ui.template.list.members",["tau/core/templates-factory"],function(e){var t={name:"list.members",engine:"jqote2",markup:['<div class="tau-teamView">','<% var name = this.config&&this.config.currentView.name||"team";%>','<% var isProject = name === "project";%>',"<% if (this.items.length){ %>",'<table class="tau-table">',"<colgroup>",'<col class="tau-teamView-people">','<col class="tau-teamView-role">','<col class="tau-teamView-activity">','<col class="tau-teamView-assignments">',"<%if(isProject){%>",'<col class="tau-teamView-startDate">','<col class="tau-teamView-endDate">',"<%}%>",'<col class="tau-teamView-actions tau-nonprintable">',"</colgroup>","<thead>","<tr>","<th>People</th>","<th>Role</th>","<th>Activity</th>","<th>Assignments</th>","<%if(isProject){%>","<th>Start Date</th>","<th>End Date</th>","<%}%>",'<th class="tau-nonprintable"></th>',"</tr>","</thead>","<tbody>","<% _.forEach(this.items, function(item){ %>",'<tr class="<% if (!item.user.isActive){ %>tau-inactive-tr<% } %> i-role-item" role="item" data-entity-id="<%= item.id %>">',"<td>",'<div class="tau-user-info">','<a href="<%= item.user.url %>">','<img width="20" height="20" alt="" class="tau-avatar" src="<%= item.user.avatarUri %>20">',"</a>",'<div class="tau-user-personal-data">','<div class="tau-name"><a href="<%= item.user.url %>"><%! item.user.name %></a></div>','<div class="tau-email"><a href="<%= item.user.url %>"><%! item.user.email %></a></div>',"</div>","</div>","</td>","<td>","<div>",'<span runas="property.role.modern" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="<%=name%>Member">',"<%! item.role.name %>","</span>","</div>","<% if (item.user.isAdministrator){ %>",'<span class="tau-user-system-role">admin</span>',"<% } %>","<% if (!item.user.isActive){ %>",'<span class="tau-user-system-role tau-user-system-role-inactive">inactive</span>',"<% } %>","</td>",'<td title="Activity sparkline provides an overview of progress over the last 16 weeks. The numbers shown are: a maximum of assignments done/added at any given week out of those 16, and done/added in the current calendar week (on the right).">',"<svg class=\"tau-sparkline tau-sparkline-user i-role-sparkline\" data-source='<%= JSON.stringify(item.allSparkline) %>'></svg>","</td>","<td>",'<div class="tau-user-assignments">','<span title="open tasks"><i class="tau-entity-icon tau-entity-icon--task"><%= fn.term("task", "iconSmall") %></i><b><%= item.user.tasksCount %></b></span>','<span title="open bugs"><i class="tau-entity-icon tau-entity-icon--bug"><%= fn.term("bug", "iconSmall") %></i><b><%= item.user.bugsCount %></b></span>','<span title="open user stories"><i class="tau-entity-icon tau-entity-icon--userstory"><%= fn.term("userStory", "iconSmall") %></i><b><%= item.user.userStoriesCount %></b></span>',"</div>","</td>","<%if(isProject){%>","<td>",'<div class="tau-user-startDate">','<div runas="property.startDate.projectMember" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="<%=name%>Member">',"</div>","</div>","</td>","<td>",'<div class="tau-user-endDate">','<div runas="property.endDate.projectMember" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="<%=name%>Member">',"</div>","</div>","</td>","<%}%>",'<td class="tau-nonprintable"><button type="button" class="tau-btn tau-attention" role="action-detach">Unassign</button></td>',"</tr>","<% },this); %>","</tbody>","</table>","<% }else{ %>",'<div class="tau-message">There are no people in this <%=name%></div>',"<% }  %>","</div>"]};
return e.register(t)}),define("tau/configurations/project.container.config",["tau/configurations/base.container.config","./project.colors","tau/models/model.extensions","tau/models/dataProviders/project/project.model.provider.releases.items","tau/models/dataProviders/project/project.model.provider.releases.groups","tau/models/dataProviders/project/project.model.provider.teams.items","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach","tau/ui/extensions/list/project/ui.extension.list.project.teams.action.assign","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.access","tau/ui/extensions/list/project/ui.extension.list.project.teams.refresher","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.sparklines","tau/ui/templates/list_/project/ui.template.list.project.teams","tau/ui/extensions/list/extension.list.checkEmpty","tau/models/dataProviders/project/project.model.provider.releases_flat.items","tau/models/dataProviders/model.provider.members.items","tau/ui/extensions/list/members/extension.list.members.action.detach","tau/ui/extensions/list/members/extension.list.members.refresher","tau/ui/extensions/list/members/extension.list.members.sparklines","tau/ui/templates/list_/ui.template.list.members"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b){var y=e.extend({colors:t,init:function(e){var t=this;this._super(e),e.context.configurator.getUrlBuilder(),this.registerPanel("Progress Bar",{type:"project.progressBar"}),this.registerAdditionalInfoItem("Owner",{label:{text:"Owner"},field:{type:"property.owner.project"}}),this.registerAdditionalInfoItem("Abbreviation",{label:{text:"Abbreviation"},field:{type:"property.abbreviation",cssClass:"abbr",editable:!0}}),this.registerAdditionalInfoItem("Color",{label:{text:"Color"},field:{type:"property.color",values:this.colors}}),this.registerAdditionalInfoItem("Reply Email",{label:{text:"Reply Email"},field:{type:"property.email",editable:!0}}),this.registerAdditionalInfoItem("IsActive",{label:{text:"Active?"},field:{type:"property.isActive",editable:!0}}),this.registerAdditionalInfoItem("IsProduct",{label:{text:"Product?"},field:{type:"property.isProduct",editable:!0}}),this.registerAdditionalInfoItem("Company",{label:{text:"Company"},field:{type:"property.company",editable:!0}}),this.registerAdditionalInfoItem("Program",{label:{text:"Program"},field:{type:"property.program",editable:!0}}),this.registerAdditionalInfoItem("Process",{label:{text:"Process"},field:{type:"property.process",editable:!0}}),this.registerAdditionalInfoItem("StartDate",{label:{text:"Start Date"},field:{type:"property.startDate.portfolio",editable:!0}}),this.registerAdditionalInfoItem("EndDate",{label:{text:"End Date"},field:{type:"property.endDate.portfolio",editable:!0}});
var i=["board","hasTeams"];this.registerTab("Teams",{cssClass:"tau-teamsProjects-tab",label:"teams",editions:i,header:[{type:"label",text:this.getNames("team"),countFieldNames:["teamProjects"],editions:i}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",editions:i,children:[{type:"container",editions:i,layout:"selectable",template:{name:"user.team.tab",markup:['<div class="tau-teamsProjects-tab" role="center"></div>']},children:[{type:"finder.team.byProject",selector:"[role=center]",printable:!1},{type:"list",selector:"[role=center]",itemsDataProvider:r,sortable:!1,extensions:[s,o,l,u,c],template:d,views:[{type:"grid.entity",emptyMessage:"No teams have been assigned",rowTemplateName:"list-grid-entity__rowteam_project"}]}]}]}]}]}),this.registerTab("People",{label:"people",header:[{type:"label",text:"People",countFieldNames:["projectMembers"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"container",layout:"selectable",template:{name:"user.project.tab",markup:['<div class="tau-teamsProjects-tab" role="center"></div>']},children:[{type:"inviter",selector:"[role=center]"},{type:"list.editable",selector:"[role=center]",itemsDataProvider:m,sortable:!1,extensions:[h,g,v],template:b,views:[{type:"grid.entity",name:"project",emptyMessage:"No teams have been assigned",rowTemplateName:"list-grid-entity__rowteam_project"}]}]}]}]}]}),this.registerTab("Releases",{practices:["Iterations"],label:"releases",header:[{type:"label",text:this.getNames("release"),countFieldNames:["releases"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["Iterations"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["Iterations"],children:[{practices:["Iterations"],type:"quick.add",printable:!1,property:"project",entityType:"release",evictProperties:["releases","releases-count"],label:"Add "+t.getTermName("release")},{practices:["Iterations"],type:"list.editable",itemsDataProvider:n,groupsDataProvider:a,extensions:[p],externalRefreshEvents:["release.items.added"],groupBy:"release.id",sortable:!1,views:[{type:"grid.entity",group:{dataIndex:"id"}}]}]}]}]}),this.registerTab("Releases (flat)",{practices:["~Iterations"],label:"releases-flat",header:[{type:"label",text:this.getNames("release"),countFieldNames:["releases"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),practices:["~Iterations"],children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",practices:["~Iterations"],children:[{practices:["~Iterations"],type:"quick.add",printable:!1,property:"project",entityType:"release",evictProperties:["releases","releases-count"],label:"Add "+t.getTermName("release")},{practices:["~Iterations"],type:"list.editable",itemsDataProvider:f,sortable:!1,externalRefreshEvents:["release.items.added"],views:[{type:"grid.entity"}]}]}]}]})
},getAdditionalInfoAliases:function(){return["Abbreviation","Color","Owner","IsActive","IsProduct","Program","Company","Process","StartDate","EndDate","Reply Email"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Additional Info","Custom Fields"]},getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"release",relationName:"releases"}]}},getTabsAliases:function(){return["Description","Teams","People","Releases","Releases (flat)","Relations","History"]}});return y}),define("tau/models/extensions/container/container.save.freezer",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({init:function(e){this._super.apply(this,arguments),this.setQueueBusForComponents(e.children),this.suspendedEvents=[]},setQueueBusForComponents:function(e){for(var t=0;t<e.length;t++){var i=e[t];i["queue.bus"]=!0,this.setQueueBusForComponents(i.children||[])}},handleChildComponentCreated:function(e){e.data.on("before_save",this.onBeforeSave,this),e.data.on("childComponentCreated",this.handleChildComponentCreated,this)},"bus childComponentCreated":function(e){this.handleChildComponentCreated(e)},onBeforeSave:function(t){t.suspendMain(),this.fire("event.suspended",t),this.suspendedEvents=e.reject(this.suspendedEvents,function(e){return e.sender===t.sender}),this.suspendedEvents.push(t)},"bus resumeSave":function(){e.each(this.suspendedEvents,function(e){e.resumeMain()})}})}),define("tau/components/extensions/user.view/user.view",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit","bus componentsCreated":function(t){var i=e.find(t.data,function(e){return"btnUpdateSettings"==e.component.name});this.fire("update.button.found",i.component)},"bus update.button.found":function(e){e.data.on("view.button.click",this.onButtonClickHandler,this)},"bus update.button.found:last+event.suspended":function(e){e["update.button.found"].data.fire("enable")
},"bus update.button.found:last+before_resumeSave":function(e){e["update.button.found"].data.fire("disable")},onButtonClickHandler:function(){this.fire("resumeSave")}})}),define("tau/models/dataProviders/user/user.model.provider.assignments.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(t){var i=this.config.context.entity.id,n=this.config.store,a=this,r=["id",{entityType:["id","name"]},"name","numericPriority","tags","isPrivate",{entityState:this.fields.entityStateWithComment},{owner:["id","firstName","lastName","avatarUri"]},{responsible:["id","firstName","lastName","avatarUri"]},{project:["id","abbreviation"]}],s={id:i},o={fields:[{assignable:["id",{entityType:["id","name"]},"name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:a.fields.generalUser}]},{project:["id","abbreviation"]}]}],$query:{assignable:{entityState:{isFinal:0},project:{isActive:1}},generalUser:s}},l=[function(t){n.find("assignment",o).done(function(i){var n=[];e.each(i[0].data,function(e){e=e.assignable,e&&(e.__type="assignable",n.push(e))}),t(!1,n)})},function(e){n.find("impediment",{fields:r,$query:{entityState:{isFinal:0},responsible:s}}).done(function(t){e(!1,t[0].data)})}];e.series(l,function(i,n){var r=[];e.each(n,function(e){r=r.concat(e)}),t(a._convertData(r))})},_convertData:function(t){return t=this._super(t),this._calculateEffortToMaximum(e.filter(t,function(e){return"assignable"==e.__type})),t=this._removeDuplicates(t),this._sortByPriority(t)},_removeDuplicates:function(t){var i={},n=e.filter(t,function(e){var t=i.hasOwnProperty(e.id);return i[e.id]=!0,0==t});return n},_convertItem:function(t){var i={id:t.id,name:t.name,numericPriority:t.numericPriority,__type:t.entityType.name,entityState:{id:t.entityState.id,name:t.entityState.name,isInitial:t.entityState.isInitial,isFinal:t.entityState.isFinal,numericPriority:t.entityState.numericPriority},tags:this._processTags(t),projectId:t.project?t.project.id:void 0,project:t.project,entitiesCount:0,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.entityType.name,!0)};
return"assignable"==t.__type?e.extend(i,{assignments:this._processAssignments(t),effort:this._getEffortData(t)}):"impediment"==t.__type&&e.extend(i,{responsible:t.responsible,effortMock:{}}),i.visibleEntityState=i.entityState,i}})}),define("tau/models/model.list.open.assignments",["Underscore","tau/core/model-base"],function(e,t){var i,n=0;return i=t.extend({name:"model.list.open.assignments",createSubscription:function(t,i){var a=this,r=(this.config.context.applicationContext.loggedUser,this.config.context.entity.id);a.store.on({eventName:"afterSave",type:t,listener:a},function(s){var o=s.data.id;s.data&&s.data.cmd&&"assignment"==s.data.cmd.type&&i(o)&&a.store.get(t,{id:o,fields:[{assignments:[{generalUser:["id"]}]}]}).done(function(t){var i=t[0].data.assignments,s=e.find(i,function(e){return e.generalUser.id===r});(0===i.length||void 0===s)&&(n--,0===n&&a.fire("refresh"),a.fire("model.assignment.did.removed",{id:o}))})}),a.store.on({eventName:"beforeSave",type:t,listener:a},function(e){var t=e.data.id;if(i(t)&&e.data.changes.entityState){var n=e.data.cmd,a=n.config.$include=n.config.$include||[];a.push({entityState:["id","isFinal"]})}}),a.store.on({eventName:"afterSave",type:t,listener:a},function(e){var t=e.data.id;if(i(t)){var r=e.data.changes.entityState;if(r)a.store.get("entityState",{id:r.id,fields:["isFinal"]}).done(function(e){var i=e[0].data;i.isFinal&&(n--,0===n&&a.fire("refresh"),a.fire("model.assignment.did.removed",{id:t}))});else{var s=e.data.changes.responsible;s&&(n--,0===n&&a.fire("refresh"),a.fire("model.assignment.did.removed",{id:t}))}}})},"bus afterItemsProvided":function(t){var i=this,a=t.data.data;if(n=a.length,a&&a.length){var r=function(t){return e(a).detect(function(e){return e.id==t})};e(a).chain().map(function(e){return e.__type}).unique().each(function(e){i.createSubscription(e,r)})}}})}),define("tau/ui/extensions/list/open.assignments/extension.list.open.assignments",["tau/components/extensions/component.extension.base"],function(e){return e.extend({getRowElement:function(e,t){var i=e.find(".i-item-"+t).parents(".tau-list__list__item");
return i},"bus afterRender:last+model.assignment.did.removed":function(e,t,i){var n=t.element,a=this.getRowElement(n,i.id);this.fire("markElementToBeDeleted",{element:a}),a.slideUp("slow"),this.fire("deleteElement",{element:a,callback:$.noop})}})}),define("tau/ui/extensions/ui.extension.add.css",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({category:"edit","bus afterRender":function(e){this.config.hasOwnProperty("cssClass")&&e.data.element.addClass(this.config.cssClass)}})}),define("tau/models/dataProviders/user/user.model.provider.teams.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("teamMembers","teamMember",null,e)},_createDetailCommand:function(e){var t={};return t[e]=["id",{team:["id","name","icon"]},{role:["id","name"]}],t},_convertData:function(t){var i=this._super(t);return e.sortBy(i,function(e){return e.team.name.toLowerCase()})},_convertItem:function(e){var t={id:e.id,__type:"teamMember",team:e.team,role:e.role,uri:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.team.id,"team",!0)};return t}})}),define("tau/ui/extensions/list/user/ui.extension.list.user.teams.refresh",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator,n=t.config.context.entity,a=i.getStore(),r=this;i.getGlobalBus().unbind(this),i.getGlobalBus().on("teamsAndUsers.connected",function(){a.evictProperties(n.id,n.entityType.name,["teamMembers"]),r.fire("refresh")},this),a.unbind(this);var s=function(){};a.on({eventName:"afterSave",type:"team",listener:this},s)},"bus beforeInit:last + destroy":function(e,t){var i=t.config.context.configurator;i.getGlobalBus().unbind(this),i.getStore().unbind(this)}})}),define("tau/ui/extensions/list/user/ui.extension.list.user.action.detach",["tau/core/extension.base"],function(e){return e.extend({"bus afterInit + afterRender":function(e,t,i){var n=i.element,a=t.config.context.configurator.getStore(),r=t.config.context.entity;
n.delegate("[role=action-detach]","click",function(e){var t=$(e.target);if(!t.data("confirmMessage")||confirm(t.data("confirmMessage"))){var i=t.parents("[role=item]:first"),n=i.data(),s={};s[n.entityType+"s"]={id:n.entityId};var o="projectmember"==n.entityType.toLowerCase()?"project":"team";a.removeFromList(o,{id:n[o+"Id"],$set:s}).done({success:function(){i.remove(),a.evictProperties(r.id,r.entityType.name,["project"==o?"projectMembers":"teamMembers"])}})}})}})}),define("tau/ui/templates/list_/user/ui.template.list.user.teams",["tau/core/templates-factory"],function(e){var t={name:"list.user.teams",engine:"jqote2",markup:["<div>","<% if (this.items.length == 0){ %>",'<div class="tau-message">User doesn\'t belong to any team</div>',"<% } else { %>",'<div class="tau-user-team-list">','<table class="tau-table">',"<colgroup>",'<col class="tau-team-name-col">','<col class="tau-role">','<col class="tau-remove-person">',"</colgroup>","<thead>","<tr>","<th>Team</th>","<th>Role</th>","<th></th>","</tr>","</thead>","<tbody>","<% _.forEach(this.items, function(item){ %>",'<tr class="i-role-item" role="item" data-entity-id="<%= item.id %>" data-entity-type="<%= item.__type.toLowerCase() %>"  data-team-id="<%= item.team.id %>">',"<td>",'<div class="tau-team-name">','<a href="<%= item.uri %>"><i class="tau-icon tau-icon_type_svg <% if (item.team.icon){ %>tau-icon_name_<%= item.team.icon  %><% } %>"></i><span><%! item.team.name %></span></a>',"</div>","</td>","<td>",'<div class="tau-team-user-role" runas="property.role.modern" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="<%= item.__type %>">',"<%! item.role.name %>","</div>","</td>","<td>",'<button class="tau-btn tau-attention" role="action-detach" type="button">Unassign</button>',"</td>","</tr>","<% }); %>","</tbody>","</table>","</div>","<% }  %>","</div>"]};return e.register(t)}),define("tau/models/dataProviders/user/user.model.provider.projects.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(e){this._fetch("projectMembers","projectMember",null,e)
},_createDetailCommand:function(e){var t={};return t[e]=["id",{project:["id","name","color"]},{role:["id","name"]}],t},_createQuery:function(){return{project:{isActive:1}}},_convertData:function(t){var i=this._super(t);return i=e.filter(i,function(e){return e.project}),e.sortBy(i,function(e){return e.project.name.toLowerCase()})},_convertItem:function(e){var t={id:e.id,__type:"projectMember",project:e.project,role:e.role,uri:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.project.id,e.project.__type,!0)};return t}})}),define("tau/ui/extensions/list/user/ui.extension.list.user.projects.refresh",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator,n=t.config.context.entity,a=i.getStore(),r=this;i.getGlobalBus().unbind(this),i.getGlobalBus().on("projectsAndUsers.connected",function(){a.evictProperties(n.id,n.entityType.name,["projectMembers"]),r.fire("refresh")},this),i.getGlobalBus().on("teamsAndUsers.connected",function(){a.evictProperties(n.id,n.entityType.name,["projectMembers"]),r.fire("refresh")},this),a.unbind(this);var s=function(){};a.on({eventName:"afterSave",type:"project",listener:this},s)},"bus beforeInit:last + destroy":function(e,t){var i=t.config.context.configurator;i.getGlobalBus().unbind(this),i.getStore().unbind(this)}})}),define("tau/ui/templates/list_/user/ui.template.list.user.projects",["tau/core/templates-factory"],function(e){var t={name:"list.user.projects",engine:"jqote2",markup:["<% if (this.items.length == 0){ %>",'<div class="tau-message">User doesn\'t belong to any project</div>',"<% } else { %>",'<div class="tau-user-project-list">','<table class="tau-table">',"<colgroup>",'<col class="tau-project-name">','<col class="tau-role">','<col class="tau-user-startDate">','<col class="tau-user-endDate">','<col class="tau-remove-person">',"</colgroup>","<thead>","<tr>","<th>Project</th>","<th>Role</th>","<th>Start Date</th>","<th>End Date</th>","<th></th>","</tr>","</thead>","<tbody>","<% _.forEach(this.items, function(item) { %>",'<tr class="i-role-item" role="item" data-entity-id="<%= item.id %>" data-entity-type="<%= item.__type.toLowerCase() %>" data-project-id="<%= item.project.id %>">',"<td>",'<div class="tau-project-name">','<a href="<%= item.uri %>"><i  <% if (item.project.color){ %> style="background-color: <%= item.project.color %>; "<% } %> class="tau-icon tau-icon_type_color"></i><span title="<%! item.project.name %>"><%! item.project.name %></span></a>',"</div>","</td>","<td>",'<div class="tau-team-user-role" runas="property.role.modern" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="<%= item.__type %>">',"<%! item.role.name %>","</div>","</td>","<td>",'<div class="tau-user-startDate">','<div runas="property.startDate.projectMember" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="ProjectMember">',"</div>","</div>","</td>","<td>",'<div class="tau-user-endDate">','<div runas="property.endDate.projectMember" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="ProjectMember">',"</div>","</div>","</td>","<td>",'<button class="tau-btn tau-attention" role="action-detach" type="button">Unassign</button>',"</td>","</tr>","<% }); %>","</tbody>","</table>","</div>","<% }  %>","</div>"]};
return e.register(t)}),define("tau/ui/templates/property/ui.template.property.title",["tau/core/templates-factory"],function(e){var t={name:"property.title",engine:"jqote2",markup:['<div class="user-title property-text user-title-<%! this.name %>" data-placeholder="<%! this.placeholderText %>">',"<%! _.asString(this.output) %>","</div>"]};return e.register(t)}),define("tau/configurations/user.container.config",["tau/configurations/base.container.config","tau/models/extensions/container/container.save.freezer","tau/components/extensions/user.view/user.view","tau/models/dataProviders/user/user.model.provider.assignments.items","tau/models/model.list.open.assignments","tau/ui/extensions/list/open.assignments/extension.list.open.assignments","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/ui.extension.add.css","tau/core/termProcessor","tau/models/dataProviders/user/user.model.provider.teams.items","tau/ui/extensions/list/user/ui.extension.list.user.teams.refresh","tau/ui/extensions/list/user/ui.extension.list.user.action.detach","tau/ui/templates/list_/user/ui.template.list.user.teams","tau/models/dataProviders/user/user.model.provider.projects.items","tau/ui/extensions/list/user/ui.extension.list.user.projects.refresh","tau/ui/extensions/list/user/ui.extension.list.user.action.detach","tau/ui/templates/list_/user/ui.template.list.user.projects","tau/ui/templates/property/ui.template.property.title","tau/utils/utils.date"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b){return e.extend({init:function(e){this._super(e),this.registerTab("Assignments",{selected:!0,label:"assignments",header:[{type:"label",text:"Open Assignments"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"list.editable",itemsDataProvider:n,extensions:[a,r],multiprojects:!0,views:[{type:"grid.entity"}]}]}]}]}),this.registerTab("Account Settings",{label:"accountSettings",header:[{type:"label",text:"Account Settings"}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"user.settings"}]}]}]}),this.registerTab("Teams and Projects",{label:"teams-projects",header:[{type:"label",text:[this.getNames("project"),this.getNames("team")]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"container",layout:"selectable",template:{name:"user.teamprojects.tab",markup:['<div class="tau-teamsProjects-tab">','<div class="tau-half-col" role="left"></div>','<div class="tau-half-col tau-right"  role="right"></div>',"</div>"].join("")},children:[{type:"finder.team.byUser",selector:"[role=right]"},{selector:"[role=right]",type:"list.editable",itemsDataProvider:u,sortable:!1,extensions:[c,d],template:p},{type:"finder.project.byUser",selector:"[role=left]"},{selector:"[role=left]",type:"list.editable",itemsDataProvider:f,sortable:!1,extensions:[m,h],template:g}]}]}]}]})
},getTabsAliases:function(){return["Assignments","Account Settings","Teams and Projects"]},getPanelsAliases:function(){return[]},getAdditionalInfoAliases:function(){return[]},getConfig:function(e){var t=e.context.getTerms(),i=e.context,n=i.entity.id,a=i.getLoggedUser(),r=n===a.id||a.isAdministrator;return this.termProcessor=new l(t),{children:[{type:"container",name:"main entity container",layout:"list",cssClass:"main-container tau-user-view",cellsCssClass:["general-info","additional-info"],children:[{type:"breadcrumbs"},{type:"container",layout:"table",children:[{type:"avatar",isEdit:r},{type:"container",name:"main entity container",layout:"list",children:[{type:"container",layout:"table",children:[{type:"property.text",propertyName:"firstName",restoreText:!0,editable:r,placeholderText:"first name",template:v},{type:"property.text",propertyName:"lastName",restoreText:!0,editable:r,placeholderText:"last name",template:v}]},{type:"container",layout:"table",children:[{type:"property.role",propertyName:"role",cssClass:"tau-role",extensions:[o],editable:!0},{type:"property.text",propertyName:"lastLoginDate",cssClass:"tau-last_login_date",extensions:[o],template:{name:"user.lastLoginDate",customFunctions:{format:function(e){return e?b.format.date.short(e):"unknown"}},engine:"jqote2",markup:['<div class="tau-last_login_date">','<span class="property tau-property">','<span class="property-text tau-property__value tau-property__value_margin_right">',"Last login: <%= fn.format(this.text) %>","</span>","</span>","</div>"].join("")}}]}]}]},{type:"container",name:"general info column container",children:[{type:"tabs",cssClass:"tau-tabs",stateName:"generalTab",tabs:this.getTabs(e)}]}]}]}}})}),define("tau/models/dataProviders/team/team.model.provider.projects.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({sparklineLength:16,fetch:function(e){this._fetch("teamProjects","teamProject",!1,e)},_fetch:function(e,t,i,n){var a=this,r=this.config.context.entity,s=this.config.context.configurator;
$.ajax({url:s.getApplicationPath()+"/api/v2/TeamProject?select={"+["id","isProjectAccessed","Team.TeamMembers.Select(User.id) as teamMembers","Team.TeamMembers.Count() as teamMembersCount",'"TeamProject" as __type',"new("+["Project.id","Project.name","Project.color","Project.ProjectMembers.Select(User.id) as projectMembers","Project.Bugs.Count(entityState.IsFinal != true AND Team.id = "+r.id+") as openBugsCount","Project.Bugs.Count(entityState.IsFinal == true AND Team.id = "+r.id+") as closedBugsCount","Project.UserStories.Count(entityState.IsFinal != true AND Team.id = "+r.id+") as openUsCount","Project.UserStories.Count(entityState.IsFinal == true AND Team.id = "+r.id+") as closedUsCount","Project.UserStories.Where(Team.id = "+r.id+").Sparkline("+this.sparklineLength+") as userStoriesSparkline","Project.Bugs.Where(Team.id = "+r.id+").Sparkline("+this.sparklineLength+") as bugsSparkline"].join(",")+") as project"].join(",")+"}&where=(Team.id=="+r.id+")"}).done(function(e){n(a._convertData(e.items))}).fail(function(){n(a._convertData([]))})},_convertData:function(e){return e=this._super(e),this._sortByPriority(e)},_sortByPriority:function(t){return e.sortBy(t,function(e){return-1*e.id})},_convertItem:function(t){var i=t.project.userStoriesSparkline,n=t.project.bugsSparkline,a={id:t.id,__type:"teamProject",teamMembers:t.teamMembers,isProjectAccessed:t.isProjectAccessed,teamMembersCount:t.teamMembers.length,teamMembersInProjectCount:e.intersection(t.teamMembers,t.project.projectMembers).length,project:t.project,uri:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.project.id,"project",!0),appPath:this.config.context.configurator.getApplicationPath(),userStoriesSparkline:i,bugsSparkline:n};return a}})}),define("tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.action.assign",["tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.assign.base"],function(e){return e.extend({_getTeamProject:function(e,t,i){return{id:i.id,project:{id:i.project.id,projectMembers:i.project.projectMembers},team:{id:e.id,teamMembers:i.teamMembers}}
}})}),define("tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.refresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator,n=i.getStore(),a=this;n.unbind(this),n.on({eventName:"afterSave",type:"team",listener:this,hasChanges:["teamProjects|teamMembers"]},function(){a.fire("refresh")}),n.on({eventName:"afterSave",type:"project",listener:this,hasChanges:["projectMembers"]},function(){a.fire("refresh")}),this.on("destroy",function(){n.unbind(a)})}})}),define("tau/ui/templates/list_/team/ui.template.list.team.projects",["tau/core/templates-factory"],function(e){var t={name:"list.team.projects",engine:"jqote2",markup:['<div class="tau-team-control">',"<% if (this.items.length){ %>",'<table class="tau-team-info">',"<colgroup>",'<col class="tau-team">','<col class="tau-us-progress">','<col class="tau-us-total">','<col class="tau-bug-progress">','<col class="tau-bug-total">','<col class="tau-assign-info">',"</colgroup>","<thead>","<tr>","<th>Project</th>",'<th><i class="tau-entity-icon tau-entity-icon--userstory"><%=fn.term("userStory", "iconSmall")%></i><%=fn.term("userStory", "names")%></th>',"<th>Done / Open</th>",'<th><i class="tau-entity-icon tau-entity-icon--bug"><%=fn.term("bug", "iconSmall")%></i><%=fn.term("bug", "names")%></th>',"<th>Done / Open</th>","<th>Assigned People</th>","</tr>","</thead>","<tbody>","<% _.forEach(this.items, function(item){ %>",'<tr class="i-role-item" role="item" data-entity-id="<%= item.id %>">',"<td>",'<div class="tau-project-name">',"<h3>",'<a href="<%= item.uri %>">','<i <% if (item.project.color) { %>style="background-color: <%= item.project.color %>;"<% } %> class="tau-icon tau-icon_type_color"></i>',"<%! item.project.name %>","</a>",'<span class="tau-unassign" title="Unassign project from this team?" ',"data-confirm-message=\"Are you sure you want to remove project '<%! item.project.name %>' from this team?\"></span>","</h3>","</div>","</td>",'<td title="User Stories sparkline provides an overview of progress over the last 16 weeks. The numbers shown are: a maximum of user stories done/added at any given week out of those 16, and done/added in the current calendar week (on the right).">',"<svg class=\"tau-sparkline i-role-sparkline\" data-source='<%= JSON.stringify(item.userStoriesSparkline) %>'></svg>","</td>","<td>",'<div class="tau-fraction tau-userstory">','<span title="done"><%= item.project.closedUsCount %></span><br>','<b title="open"><%= item.project.openUsCount %></b>',"</div>","</td>",'<td title="Bugs sparkline provides an overview of progress over the last 16 weeks. The numbers shown are: a maximum of bugs fixed/added at any given week out of those 16, and fixed/added in the current calendar week (on the right).">',"<svg class=\"tau-sparkline tau-sparkline-bugs i-role-sparkline\" data-source='<%= JSON.stringify(item.bugsSparkline) %>'></svg>","</td>","<td>",'<div class="tau-fraction tau-bug" >','<span title="done"><%= item.project.closedBugsCount %></span><br>','<b title="open"><%= item.project.openBugsCount %></b>',"</div>","</td>",'<td class="tau-assign-info">','<div class="tau-count" title="<%if (item.teamMembersInProjectCount === 0){%>No<%}%><% else {%><%= item.teamMembersInProjectCount%><%}%><% if (item.teamMembersInProjectCount !== 1){%> people<%}%><% else {%> person<%}%> in this Team assigned to Project"><%= item.teamMembersInProjectCount %> of <%= item.teamMembersCount %>','<a href="" class="i-role-item" role="assign-all" title="All people in the Team will be assigned to this Project" <% if (item.teamMembersInProjectCount === item.teamMembersCount) { %>style="display: none;"<% } %> data-confirm-message="Are you sure you want to assign all people from team to project \'<%! item.project.name %>\'?">Assign all</a>',"</div>",'<div class="tau-auto-assign">','<label class="tau-checkbox" title="Any new person in the Team will be auto-assigned to this Project">','<input type="checkbox" class="i-role-item" role="auto-assign" <% if (item.isProjectAccessed) { %> checked<% } %>><i class="tau-checkbox__icon"></i><span>Auto-assign new people</span>',"</label>","</div>","</td>","</tr>","<% }); %>","</tbody>","</table>","<% }else{ %>",'<div class="tau-message">This team has no projects</div>',"<% } %>","</div>"]};
return e.register(t)}),define("tau/configurations/team.container.config",["require","tau/configurations/base.container.config","tau/models/dataProviders/team/team.model.provider.projects.items","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach","tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.action.assign","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.access","tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.refresher","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.sparklines","tau/ui/templates/list_/team/ui.template.list.team.projects","tau/models/dataProviders/model.provider.members.items","tau/ui/extensions/list/members/extension.list.members.action.detach","tau/ui/extensions/list/members/extension.list.members.refresher","tau/ui/extensions/list/members/extension.list.members.sparklines","tau/ui/templates/list_/ui.template.list.members","./team.icons"],function(e){var t=e("tau/configurations/base.container.config"),i=e("tau/models/dataProviders/team/team.model.provider.projects.items"),n=e("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach"),a=e("tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.action.assign"),r=e("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.access"),s=e("tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.refresher"),o=e("tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.sparklines"),l=e("tau/ui/templates/list_/team/ui.template.list.team.projects"),u=e("tau/models/dataProviders/model.provider.members.items"),c=e("tau/ui/extensions/list/members/extension.list.members.action.detach"),d=e("tau/ui/extensions/list/members/extension.list.members.refresher"),p=e("tau/ui/extensions/list/members/extension.list.members.sparklines"),f=e("tau/ui/templates/list_/ui.template.list.members"),m=e("./team.icons");return t.extend({icons:m,init:function(e){this._super(e),this.registerAdditionalInfoItem("Icon",{label:{text:"Icon"},field:{type:"property.icon",values:this.icons}}),this.registerAdditionalInfoItem("Abbreviation",{label:{text:"Abbreviation"},field:{type:"property.abbreviation",cssClass:"abbr",editable:!0}}),this.registerTab("Projects",{label:"projects",header:[{type:"label",text:this.getNames("project"),countFieldNames:["teamProjects"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"container",layout:"selectable",template:{name:"team.projects.tab",markup:['<div class="tau-teamsProjects-tab" role="center"></div>']},children:[{type:"finder.project.byTeam",selector:"[role=center]",printable:!1},{type:"list",itemsDataProvider:i,selector:"[role=center]",sortable:!1,extensions:[n,a,r,s,o],template:l,views:[{type:"grid.entity",emptyMessage:"No projects have been assigned",rowTemplateName:"list-grid-entity__rowproject_team"}]}]}]}]}]}),this.registerTab("People",{label:"people",header:[{type:"label",text:"People",countFieldNames:["teamMembers"]}],items:[{type:"container",spinnerConfigForLazy:this.getSpinnerConfigForLazy(),children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"container",layout:"selectable",template:{name:"user.team.tab",markup:['<div class="tau-teamsProjects-tab" role="center"></div>']},children:[{type:"inviter",selector:"[role=center]",printable:!1},{type:"list.editable",selector:"[role=center]",itemsDataProvider:u,sortable:!1,extensions:[c,d,p],template:f}]}]}]}]})
},getAdditionalInfoAliases:function(){return["Abbreviation","Icon"]},getActionsAliases:function(){return["Print","-----","Delete"]},getTabsAliases:function(){return["Description","Projects","People","Relations"]}})}),define("tau/models/dataProviders/program/program.model.provider.projects.items",["jQuery","Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t,i){var n=i.extend({sparklineLength:16,fetch:function(e){this._fetch("projects","project",!1,e)},_fetch:function(e,t,i,n){var a=this.config.context.entity,r=this.config.context.configurator.getStore2();r.findAll("project?select={"+['"project" as __type',"id","name","color","Bugs.Count(entityState.IsFinal != true) as openBugsCount","Bugs.Count(entityState.IsFinal == true) as closedBugsCount","UserStories.Count(entityState.IsFinal != true) as openUsCount","UserStories.Count(entityState.IsFinal == true) as closedUsCount","UserStories.Sparkline("+this.sparklineLength+") as userStoriesSparkline","Bugs.Sparkline("+this.sparklineLength+") as bugsSparkline"].join(",")+"}&where=(program.id=="+a.id+")").then(this._convertData.bind(this)).then(n)},_convertData:function(e){return e=this._super(e),t.sortBy(e,this._sortOrder)},_sortOrder:function(e){return-1*e.id},_convertItem:function(e){return t.extend(e,{appPath:this.config.context.configurator.getApplicationPath(),sparklineLength:this.sparklineLength,uri:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,"project",!0)})}});return n}),define("tau/ui/extensions/list/teamprojects/ui.extension.list.programprojects.action.detach",["jQuery","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.detach.base"],function(e,t){return t.extend({_detach:function(t){var i=this.config.context.configurator,n=i.getStore(),a=this.config.context.entity,r=e.Deferred();return n.removeFromList("program",{id:a.id,$set:{projects:{id:t.entityId}}}).done({success:function(){n.evictProperties(a.id,"program",["projects"]),n.get("program",{id:a.id,fields:["id",{projects:["id"]}]}).done(r.resolve.bind(r))
}}),r.promise()}})}),define("tau/ui/extensions/list/program/projects/ui.extension.list.program.projects.refresher",["Underscore","tau/core/extension.base"],function(e,t){var i=t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;this._store=i.getStore(),this._store.unbind(this),this._store.on({eventName:"afterSave",type:"program",listener:this,hasChanges:["projects"]},this.fire.bind(this,"refresh"))},destroy:function(){this._store.unbind(this),this._super()}});return i}),define("template!tau/ui/templates/list_/program/ui.template.list.program.projects.list.item",["tau/core/templates-factory"],function(e){var t={name:"list.program.projects.list.item",engine:"jqote2",customFunctions:null,markup:'<tr class="i-role-item" role="item" data-entity-id="<%= this.id %>"> <td> <div class="tau-project-name"> <h3> <a href="<%= this.uri %>"> <i <% if (this.color) { %>style="background-color: <%= this.color %>;"<% } %> class="tau-icon tau-icon_type_color"></i> <%! this.name %> </a> </h3> </div> </td> <td title="User Stories sparkline provides an overview of progress over the last <%= this.sparklineLength %> weeks. The numbers shown are: a maximum of user stories done/added at any given week out of those 16, and done/added in the current calendar week (on the right)."> <svg class="tau-sparkline i-role-sparkline" data-source=\'<%= JSON.stringify(this.userStoriesSparkline) %>\'></svg> </td> <td> <div class="tau-fraction tau-userstory"> <span title="done"><%= this.closedUsCount %></span><br> <b title="open"><%= this.openUsCount %></b> </div> </td> <td title="Bugs sparkline provides an overview of progress over the last <%= this.sparklineLength %> weeks. The numbers shown are: a maximum of bugs fixed/added at any given week out of those 16, and fixed/added in the current calendar week (on the right)."> <svg class="tau-sparkline tau-sparkline-bugs i-role-sparkline" data-source=\'<%= JSON.stringify(this.bugsSparkline) %>\'></svg> </td> <td> <div class="tau-fraction tau-bug" > <span title="done"><%= this.closedBugsCount %></span><br> <b title="open"><%= this.openBugsCount %></b> </div> </td> <td class="tau-assign-info"> <button class="tau-btn tau-attention tau-unassign" type="button" data-confirm-message="Are you sure you want to remove project \'<%! this.name %>\' from this program?">Unassign</button> </td> </tr>'};
return e.register(t)}),define("tau/ui/templates/list_/program/ui.template.list.program.projects.fn",["template!tau/ui/templates/list_/program/ui.template.list.program.projects.list.item"],function(){return{}}),define("template!tau/ui/templates/list_/program/ui.template.list.program.projects",["tau/core/templates-factory","./ui.template.list.program.projects.fn"],function(e,t){var i={name:"list.program.projects",engine:"jqote2",customFunctions:t,markup:'<div class="tau-team-control i-role-project-list"> <% if (this.items.length){ %> <table class="tau-team-info tau-project-info"> <colgroup> <col class="tau-team"> <col class="tau-us-progress"> <col class="tau-us-total"> <col class="tau-bug-progress"> <col class="tau-bug-total"> <col class="tau-assign-info"> </colgroup> <thead> <tr> <th>Project</th> <th><i class="tau-entity-icon tau-entity-icon--userstory"><%=fn.term("userStory", "iconSmall")%></i><%=fn.term("userStory", "names")%></th> <th>Done / Open</th> <th><i class="tau-entity-icon tau-entity-icon--bug"><%=fn.term("bug", "iconSmall")%></i><%=fn.term("bug", "names")%></th> <th>Done / Open</th> <th></th> </tr> </thead> <tbody> <%= fn.sub("list.program.projects.list.item", this.items) %> </tbody> </table> <% }else{ %> <div class="tau-message">This program has no projects</div> <% } %> </div>'};return e.register(i)}),define("tau/configurations/program.projects.tab.config",["tau/models/dataProviders/program/program.model.provider.projects.items","tau/ui/extensions/list/teamprojects/ui.extension.list.programprojects.action.detach","tau/ui/extensions/list/team/projects/ui.extension.list.team.projects.action.assign","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.action.access","tau/ui/extensions/list/program/projects/ui.extension.list.program.projects.refresher","tau/ui/extensions/list/teamprojects/ui.extension.list.teamprojects.sparklines","template!tau/ui/templates/list_/program/ui.template.list.program.projects"],function(e,t,i,n,a,r,s){"use strict";
return{create:function(o){return{type:"container",spinnerConfigForLazy:o,children:[{type:"container",lazy:!0,name:"lazyPlaceholder container",children:[{type:"container",template:{name:"program.projects.tab",markup:['<div class="tau-teamsProjects-tab" role="center"></div>']},children:[{type:"finder.project.byProgram",printable:!1},{type:"list",itemsDataProvider:e,sortable:!1,extensions:[t,i,n,a,r],template:s,views:[{type:"grid.entity",emptyMessage:"No projects have been assigned",rowTemplateName:"list-grid-entity__rowproject_team"}]}]}]}]}}}}),define("tau/configurations/program.container.config",["tau/configurations/base.container.config","tau/configurations/program.projects.tab.config"],function(e,t){"use strict";return e.extend({init:function(e){this._super(e),this.registerPanel("Progress Bar",{type:"program.progressBar"}),this.registerAdditionalInfoItem("StartDate",{label:{text:"Start Date"},field:{type:"property.startDate.portfolio",editable:!0}}),this.registerAdditionalInfoItem("EndDate",{label:{text:"End Date"},field:{type:"property.endDate.portfolio",editable:!0}});var i=t.create(this.getSpinnerConfigForLazy());this.registerTab("Projects",{label:"projects",header:[{type:"label",text:this.getNames("project"),countFieldNames:["projects"]}],items:[i]})},getAdditionalInfoAliases:function(){return["CreationDate","StartDate","EndDate"]},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Additional Info","Custom Fields"]},getActionsAliases:function(){return["Old Edit","Print","-----","Delete"]},getTabsAliases:function(){return["Description","Projects","Relations","History"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"project",relationName:"project"}]}}})}),define("tau/ui/extensions/label/ui.extension.label.epic.featurecount",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i={definition:{cells:{items:[{id:"feature"}],filter:"?Epic.Id == "+t.config.context.entity.id}}};this.fire("comet.parameters.ready",i)
}})}),define("tau/ui/extensions/label/ui.extension.label.refresher.comet",["require","Underscore","tau/core/extension.base"],function(e){var t=e("Underscore"),i=e("tau/core/extension.base");return i.extend({"bus beforeInit":function(e,t){this.configurator=t.config.context.configurator,this.configurator.getFeaturesService().isEnabled("comet.notifications")&&this.fire("comet.enabled")},"bus comet.parameters.ready + comet.enabled:last":function(e,t){this._subscribe(t)},"bus destroy":function(){this._unsubscribe()},_subscribe:function(e){this._unsubscribe(),this.subscription=this.configurator.getComet().listen("slice",{parameters:e}).on({callback:function(e){var i=t.some(e.data.items,function(e){var t=e.modification.toLowerCase();return"added"===t||"deleted"===t});i&&this.fire("entity.changed")}.bind(this)}).aborted(function(){t.defer(this._subscribe.bind(this,e))}.bind(this)).start()},_unsubscribe:function(){this.subscription&&(this.subscription.stop(),this.subscription=null)}})}),define("tau/configurations/epic.container.config",["Underscore","jQuery","tau/configurations/base.container.config","tau/ui/extensions/label/ui.extension.label.epic.featurecount","tau/ui/extensions/label/ui.extension.label.refresher.comet"],function(e,t,i,n,a){return i.extend({init:function(e){this._super(e),this.registerTab("Features",{enabledIf:{isBoard:!0},label:"features",header:[{type:"label",text:this.getNames("feature"),countFieldNames:["features"],extensions:[n,a]}],items:[{name:"Features",type:"entity.new.list",lazy:!0,spinnerConfigForLazy:this.getSpinnerConfigForLazy(),definition:{cells:{types:["feature"]},cardSettings:{list_feature:{list:[[{id:"entity_name_1line",order:0},{id:"general_entity_id",order:1},{id:"release_short",order:2},{id:"state_short",order:3},{id:"effort_total",order:4},{id:"progress_long",order:5},{id:"action_delete",order:6}]]}}}}]}),this.registerPanel("Progress Bar",{type:"progressBar"}),this.registerPanel("Total Effort",{type:"totalEffort",extensions:[n,a]}),this.registerPanel("Assignments",{type:"collapsible",collapsed:!1,stateName:"assignments",header:[{type:"label",text:"Assignments"}],items:[{type:"feature.assignmentList"}]})
},getTabsAliases:function(){return["Description","Features","Relations"]},getActionsAliases:function(){return["Copy to project","-----","Print","-----","Delete"]},getEntityQuickAddOptions:function(){return{items:[{entityType:"feature",relationName:"features"},{entityType:"impediment",relationName:"impediments"}]}},getPanelsAliases:function(){return["Diagnostic","Progress Bar","Total Effort","Assignments","Additional Info","Lead Cycle Time","Custom Fields"]},getAdditionalInfoAliases:function(){return["Project","Team","Owner","Initial Estimate","Business Value","StartDate","CompletionDate","PlannedStartDate","PlannedEndDate"]}})}),define("tau/configurations/converters/converter.context",["Underscore"],function(e){var t=function(t,i){var n=[],a=[];e.forEach(t,function(e){"~"==e[0]?n.push(e.slice(1)):a.push(e)});var r=!0;a.length&&(r=e.intersection(i,a).length>0);var s=!1;return n.length&&(s=e.intersection(i,n).length>0),r&&!s},i=function(n,a,r){return e.forEach(n,function(s,o){if("tabs"==s.type)e.forEach(s.tabs,function(e,t){e.header=i(e.header,a,r),s.tabs[t].items=i(e.items,a,r),0==s.tabs[t].items.length&&(s.tabs[t]=!1)}),s.tabs=e.filter(s.tabs,function(e){return e!==!1}),s.tabs=i(s.tabs,a,r),s.tabs=e.filter(s.tabs,function(e){return e!==!1}),s.additionalHeaders=i(s.additionalHeaders,a,r),0==s.tabs.length&&(n[o]=!1);else if("additionalInfo"==s.type)s.children=i(s.children,a,r),0==s.children.length&&(n[o]=!1);else if("label"==s.type&&e.isArray(s.text))s.text=i(s.text,a,r),n[o]=0==s.text.length?!1:s;else if(s.practices||s.editions){var l=s.practices&&s.practices.length&&!t(s.practices,a),u=s.editions&&s.editions.length&&!t(s.editions,r);(l||u)&&(n[o]=!1)}else s.children?n[o].children=i(s.children,a,r):"undefined"!=typeof s.items?(n[o].items=i(s.items,a,r),0==s.items.length&&(n[o]=!1)):("children"==o||"items"==o)&&(n[o]=i(s,a,r))}),n=e.filter(n,function(e){return e!==!1})};return{convert:function(e,t,n){return i(e,t,n)}}}),define("tau/configurations/factory.container.config",["Underscore","tau/core/class","tau/configurations/base.container.config","tau/configurations/userStory.container.config","tau/configurations/task.container.config","tau/configurations/bug.container.config","tau/configurations/request.container.config","tau/configurations/testplanrun.container.config","tau/configurations/testcase.container.config","tau/configurations/testcaserun.container.config","tau/configurations/testplan.container.config","tau/configurations/iteration.container.config","tau/configurations/teamiteration.container.config","tau/configurations/feature.container.config","tau/configurations/release.container.config","tau/configurations/build.container.config","tau/configurations/impediment.container.config","tau/configurations/project.container.config","tau/configurations/user.container.config","tau/configurations/team.container.config","tau/configurations/program.container.config","tau/configurations/epic.container.config","tau/configurations/converters/converter.context"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b,y,_,x,w){var C=t.extend({init:function(t,i){this.originalConfigObject=t,this.appConfig=i,this.practices=[],this.editions=[];
var n=this.appConfig.context;n&&(this.practices=e.pluck(n.getPractices(),"name"),this.editions=n.getEdition())},getConfig:function(){var e=this.originalConfigObject.getConfig(this.appConfig);return w.convert(e,this.practices,this.editions)},_getActions:function(){var e=this.originalConfigObject._getActions(this.appConfig.context.applicationContext);return w.convert(e,this.practices,this.editions)}}),S=t.extend({init:function(){this.configs={base:i,userstory:n,task:a,bug:r,request:s,testplanrun:o,testcase:l,testplan:c,iteration:d,teamiteration:p,feature:f,epic:x,release:m,build:h,impediment:g,project:v,user:b,team:y,program:_,testcaserun:u}},_getConfig:function(e){return e=e.toLowerCase(),this.configs[e]},getConfig:function(e){var t=this.getEntityConfigObject(e);return t.getConfig(e)},getContextBasedConfigObject:function(e){var t=this.getEntityConfigObject(e);return new C(t,e)},getEntityConfigObject:function(e){var t=this._getConfig(e.context.entity.entityType.name)||this.configs.base;return new t(e)},getConfigByType:function(e){var t=this._getConfig(e);if(!t)throw new Error('No config for type "'+e+'"');return t}});return new S}),define("tau/models/page.entity/entity.context.factory",["require","Underscore","libs/jquery/jquery","tau/models/dataprocessor/model.processor.context","tau/core/tau","tau/core/termProcessor"],function(e){var t=e("Underscore"),i=e("libs/jquery/jquery"),n=e("tau/models/dataprocessor/model.processor.context"),a=e("tau/core/tau"),r=(e("tau/core/termProcessor"),a.Error),s=function(e){var i={};e.applicationContext.globalSettings=e.globalSettings,t.extend(i,{entity:e.entity,applicationContext:e.applicationContext,componentSettings:e.componentSettings,configurator:e.configurator});var a=n(i);return e.applicationContextAdditions.hasTeams&&(a.applicationContext.edition=["hasTeams"].concat(a.applicationContext.edition)),i},o={notFound:"%s with Id %d not found or access is forbidden",invalidType:'Entity type "%s" does not exist',context:"Context error",teams:"Teams error: %s"},l=["user","testcaserun"];
return{create:function(e,n){var a=i.Deferred(),u=[];return u.push(function(e){var t=n.getGlobalSettingsService();t.getGlobalSettings({success:function(t){e(!1,t)},failure:function(){e(!1,{})}})}),u.push(function(i){var a=n.getApplicationContextService(),s="";t.contains(l,e.entityType.name.toLowerCase())||(s=e.id);var u=n.getFeaturesService().isEnabled("contextPrototype"),c=!1;u&&(c=n.getPrototypeContextEntityService().tryBuildContextFromContextPrototype(e.projectId,e.teamId)),c?i(!1,c):a.getApplicationContext({id:s},{success:function(e){i(!1,e)},failure:function(n){var a;if(s){var l="general"==e.entityType.name?"Entity":t.titleize(t.underscored(e.entityType.name).replace("_"," "));a=new r(t.sprintf(o.notFound,l,s)),i(a,n)}else a=new r(t.sprintf(o.context)),i(a,n)}})}.bind(this)),u.push(function(i){"general"==e.entityType.name?n.getStore().get(e.entityType.name,{id:e.id,fields:["id",{entityType:["id","name"]}],failureGlobal:!1}).done({success:function(e){i(!1,e[0].data)},failure:function(){i(new r(t.sprintf(o.notFound,"Entity",e.id)),{})}}):"user"==e.entityType.name?n.getStore().get(e.entityType.name,{id:e.id,fields:["id"],failureGlobal:!1}).done({success:function(){i(!1,e)},failure:function(){i(new r(t.sprintf(o.notFound,"User",e.id)),{})}}):i(!1,e)}),u.push(function(t){var i=n.getBoardSettingsFactory().createComponentSettings({id:e.entityType.name});t(!1,i)}),u.push(function(e){var i=n.getConfig("hasTeams");t.isUndefined(i)?n.getStore().get("team",{fields:["id"]}).done({success:function(t){var i=t[0].data.length>0;n.setConfig("hasTeams",i),e(!1,{hasTeams:i})},failure:function(i){e(new r(t.sprintf(o.teams,i)),{})}}):e(!1,{hasTeams:i})}),t.parallel(u,function(e,t){e?a.reject(e):a.resolve(s({globalSettings:t[0],applicationContext:t[1],entity:t[2],componentSettings:t[3],applicationContextAdditions:t[4],configurator:n}))}),a}}}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-add",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/configurations/factory.container.config","tau/models/page.entity/entity.context.factory"],function(e,t,i,n,a){return i.extend({name:"Add",className:"i-role-card-context-menu-add",getDisabledEntityTypes:function(){return["user","impediment","team","build","testcase","projectmember"]
},itemClickCallback:function(e){var i=this.getBubbleCreator(e);a.create(i.entity,this.settings.configurator).done(t.bind(function(e){this.createBubble(i,e)},this))},createBubble:function(t,i){var a=n.getConfigByType(t.entity.entityType.name),r=a.prototype.getEntityQuickAddOptions(),s={alignTo:t.getAlignTo.bind(t,this),appendMethod:"appendTo",stackName:"quickAddGeneral",className:"tau-quick-add-dialog-general tau-quick-add-dialog-entity",hideOnScroll:!1,dontCloseSelectors:["#ui-datepicker-div"],context:i,onPositionConfig:function(i){i.my="center top",i.at="center bottom",i.collision="fit none";var n=e(t.cardSelector);if(0===n.length)return i;var a=n.offset().top,r=t.getTarget().tauBubble("widget").height();if(a>r){var s=e(window).height()-a-n.height();r>s&&(i.my="center bottom",i.at="center top")}return i},onArrowPositionConfig:function(e,t){return e.collision="fit none","bottom"===t?(e.my="center bottom",e.at="center top"):(e.my="center top",e.at="center bottom"),e},componentsConfig:{components:[{name:"entity quick add",type:"entity.quickAdd",options:r,useGlobalEntityViewer:!0}]}};t.createBubble(s)}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-assignments",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/utils/utils.boardCard","tau/models/page.entity/entity.context.factory"],function(e,t,i,n,a){return i.extend({name:"Change Assignment and Effort",className:"i-role-card-context-menu-change-assignments",getDisabledEntityTypes:function(){return["user","project","program","release","iteration","teamiteration","testcase","team","build","impediment","projectmember"]},itemClickCallback:function(e){var i=this.getBubbleCreator(e),r=n.convertToEntity(e.$trigger.data());a.create(r,this.settings.configurator).done(t.bind(this.createBubble,this,i,e.$trigger,r))},createBubble:function(i,n,a,r){var s=function(){if("timeline"===this.settings.viewMode){var n=e(i.cardSelector),a=n.parent(".i-role-timeline-card-holder,.i-role-timeline-planner-card-holder");
return a.length?a:n}var r=[i.cardSelector+" .tau-people:visible",i.cardSelector+" .tau-effort:visible",i.cardSelector],s=i.$trigger.data("card-selector");s&&r.push(s);var o;return t.find(r,function(t){return o=e(t),o.length>0}),o},o={context:r,className:"tau-context-menu-assignments",alignTo:t.bind(s,this),entitySubscriptionChanges:["effort","assignments"],closeOnStoreActions:!1,stackName:"assignmentsContextMenu",componentsConfig:{components:[{type:"assignmentsList",onBeforeInitializeComponent:function(e){e.on("afterRender",function(){t.defer(function(){i.getTarget().tauBubble("adjust")})})}}]}};i.createBubble(o)}})}),define("tau/models/finder.entity/queryBuilder",["Underscore","tau/core/class"],function(e,t){var i=t.extend({_collection:null,_orderBy:null,_orderDir:"asc",_page:1,_onPage:10,init:function(){this._parameters=[],this._values={},this._fields=[]},setFields:function(e){this._fields=e},setCollection:function(e){this._collection=e},registerParameters:function(t){this._parameters=e.toArray(t)},setParameter:function(t,i){if(!e.include(this._parameters,t))throw new Error('No "'+t+'" parameter for query');this._values[t]=i},unsetParameter:function(e){delete this._values[e]},setOnPage:function(e){this._onPage=e},setPage:function(e){this._page=e||1},setOrderBy:function(e){this._orderBy=e},setOrderDir:function(e){this._orderDir=e},create:function(){var e={fields:this._fields,$query:this.createWhere()},t=this.createPaging();e.$skip=t.skip,e.$limit=t.limit;var i="asc"===this._orderDir?"$orderBy":"$orderByDesc";return e[i]=this.createOrderBy(),{collection:this.createCollection(),request:e}},createCollection:function(){return this._collection},createWhere:function(){var t={};return e.each(this._values,function(e,i){t[i]=e}),t},createOrderBy:function(){return this._orderBy||"id"},createPaging:function(){return{limit:this._onPage,skip:(this._page-1)*this._onPage}}});return i}),define("tau/models/finder.entity/sliceQueryBuilder",["Underscore","./queryBuilder"],function(e,t){return t.extend({setAcid:function(e){this._acid=e
},create:function(){var t=this._extractFields();if(0==e.values(t).length)return!1;var i=this._values,n={global:{acid:this._acid},cells:{filter:this.createFilter(i),types:e.map(t,e.bind(function(e,t){return{type:t,data:this.convertFields("",e)}},this)),ordering:{name:this._orderBy,direction:"asc"===this._orderDir?"Asc":"Desc"}},user:{cardFilter:i.user_dsl_filter}};return{collection:this.createCollection(),request:n,command:{$take:this._onPage,$skip:(this._page>0?this._page-1:0)*this._onPage}}},createFilter:function(t){var i=e.map(t,function(e,t){switch(t){case"_id":return"id == "+e;case"init_dsl":return e;case"user_dsl_filter":return null;case"firstName":case"lastName":case"email":case"name":return'"'+e+'" in '+t;case"entityState.name":return t+' is "'+e+'"';case"entityType.name":return null;case"project.id":case"_project.id":return-1==e?"project is None":"project.id == "+e;case"team.id":return-1==e?"team is None":t+" == "+e;case"release.id":return-1==e||null===e?"release is None":t+" == "+e;case"iteration.id":return-1==e||null===e?"iteration is None":t+" == "+e;default:return null}});return i=e.compact(i),i=e.map(i,function(e){return"("+e+")"}),"?"+i.join(" and ")},convertWhere:function(t,i){var n=e.map(i,e.bind(function(i,n){var a;if(!e.startsWith(i,"$"))return e.isObject(n)?this.convertWhere(t,n):n;switch(i){case"$and":return a=this.convertWhere(t,n),a.join(" AND ");case"$or":return a=this.convertWhere(t,n),a.join(" OR ")}},this));return e.compact(["?"+n.join(" AND "),t]).join(" AS ")},convertFields:function(t,i){var n=e.map(i,e.bind(function(i){if(e.isObject(i)&&!e.isArray(i)){var n=e.keys(i)[0];return this.convertFields(n,i[n])}return e.compact([t,i]).join(".")},this));return e.compact(["{"+n.join(",")+"}",t]).join(" AS ")},_extractFields:function(){var t=e.clone(this._fields),i=e.without(e.keys(this._values),"user_dsl_filter","init_dsl");return this._values["entityType.name"]&&(t=e.pick(t,this._values["entityType.name"])),i.length&&(e.indexOf(i,"entityState.name")>=0&&(t.impediment&&e.keys(t).length>1&&delete t.impediment,e.forEach(t,e.bind(function(i,n){var a=e.find(i,function(e){return"entityState"==e
});a||delete t[n]},this))),e.indexOf(i,"team.id")>=0&&(delete t.teamiteration,e.forEach(t,e.bind(function(i,n){var a=e.find(i,function(t){return e.isObject(t)&&"team"==e.keys(t)[0]});a||delete t[n]},this))),(e.indexOf(i,"iteration.id")>=0||e.indexOf(i,"release.id")>=0)&&(delete t.iteration,delete t.testplanrun,delete t.build,e.forEach(t,e.bind(function(i,n){var a=e.find(i,function(t){return e.isObject(t)&&("release"==e.keys(t)[0]||"iteration"==e.keys(t)[0])});a||delete t[n]},this)))),t}})}),define("tau/models/finder.entity/sliceSearchResult",["tau/core/class"],function(e){var t=e.extend({init:function(e){var t=e.data.dynamic.items,i=t.length,n=e.data.fixed.items.length?!!e.data.fixed.items[0]:!1,a=e.command;this.items=t,this.paging={start:a.$skip||0,end:(a.$skip||0)+i,count:i,hasNext:n}}});return t}),define("tau/models/finder.entity/model.finder.entity.data",["Underscore","tau/core/extension.base","./sliceQueryBuilder","./sliceSearchResult"],function(e,t,i,n){return t.extend({"bus beforeInit":function(t,i){var n=i.config.context.configurator,a=i.config;a.acid=i.config.context.acid;var r=e.bind(this.fire,this);r("configurator.ready",n),this.createContext(n).then(e.bind(function(e){return a.acid=e.acid,this.processOptions(a,n)},this)).then(function(e){return e.allData=e.allData||{},r("options.ready",e),r("dataBind",{isAddPossible:e.allData.isAddPossible,fieldCaption:e.allData.fieldCaption,filter:e.filter,filterValues:e.filterValues,filterDisabled:e.filterDisabled,columnsDisabled:e.columnsDisabled,result:null}),r("types.ready",e.entityType),e}).then(e.bind(function(e){return this.createBuilder(e,n).done(function(e){r("builder.ready",e)}),e},this)).then(e.bind(function(e){return this.buildInitialParameters(e,n).done(function(e){r("search.parametersBound",e)})},this))},"bus builder.ready:last + search.parametersBound":function(t,i,n){e.forEach(n,function(t,n){e.isUndefined(t)||""===t?i.unsetParameter(n):i.setParameter(n,t)}),i.setPage(0),this.fire("search.readyToExecute")
},"bus builder.ready:last + search.pagingBound":function(e,t){t.setPage(t._page+1),this.fire("search.readyToExecute")},"bus builder.ready:last + search.orderBound":function(e,t,i){t.setOrderBy(i.value),t.setOrderDir(i.dir),t.setPage(0),this.fire("search.readyToExecute")},"bus beforeInit:last + configurator.ready:last + builder.ready:last + search.readyToExecute":function(t,i,n,a){this.doSearch(a,n).then(e.bind(this.processResult,this)).done(e.bind(function(e){this.fire("search.completed",{result:e})},this)).fail(e.bind(function(e){this.fire("search.completed",{result:e})},this))},"bus search.completed":function(e,t){this.fire("result.ready",t.result)},createContext:function(e){var t=$.Deferred();return e.getApplicationContextService().getApplicationContext({projectIds:"*",teamIds:"*"},{success:function(e){t.resolve(e)}}),t.promise()},processOptions:function(t,i){var n=$.Deferred(),a=["feature","userstory","task","bug","testplanrun","request"],r=e.defaults(t,{filter:{entityType:["program","release","iteration","teamiteration","testcase","testplan","build","impediment","feature","userstory","task","bug","testplanrun","request"]},filterValues:{},filterDisabled:[],fields:[],parameters:["_id","name","entityType.name","entityState.name","project.id","team.id","_project.id","release.id","iteration.id","user_dsl_filter","init_dsl","dsl"],onPage:15,ordering:{name:"Creation Date",dir:"desc"},columnsDisabled:{}});r.propertyName&&(r.entityType=r.propertyName.toLowerCase(),"assignable"==r.entityType&&(r.entityType=a)),r.entityType&&(r.entityType=e.isArray(r.entityType)?r.entityType:[r.entityType],r.filter.entityType=r.entityType),r.filter.entityType&&e.has(r.filter.entityType,"$in")?i.getStore().find("entityType",{fields:["id","name"],$query:{id:{$in:r.filter.entityType.$in}}}).done(function(t){r.entityType=e.map(e.pluck(t[0].data,"name"),function(e){return e.toLowerCase()}),n.resolve(r)}):(r.filter.entityType&&(r.entityType=r.filter.entityType),n.resolve(r));var s=n.then(function(t){t.entityType&&t.filter.entityType&&(delete t.filter.entityType,t.filterValues.entityType=t.filterValues.entityType||{},t.filterValues.entityType.name={$in:t.entityType},t.filterValues.entityState=t.filterValues.entityState||{},t.filterValues.entityState["entityType.name"]={$in:t.entityType}),e.each(["project","team","release","iteration"],function(i){e.isUndefined(t.filter[i])||(t.filter[i+".id"]=t.filter[i],delete t.filter[i])
}),1==t.entityType.length&&t.filterDisabled.push("entityType.name");var n=["project","release","iteration","team","entityState","firstName","lastName","avatarUri","email"];e.each(t.entityType,function(a){var r=i.getStore().config.proxy.getProperties(a);"feature"==a&&(r=e.without(r,"iteration")),"request"==a&&(r=e.without(r,"release","iteration")),e.contains(["team","teamiteration","project","program"],a)&&(r=e.without(r,"project")),i.isBoardEdition||t.context.hasEdition&&!t.context.hasEdition("hasTeams")&&(r=e.without(r,"team")),n=e.difference(n,r)});var a={};return e.forEach(n,function(i){a[i]=!0,t.parameters=e.without(t.parameters,i,i+".id")}),t.columnsDisabled=e.extend(t.columnsDisabled,a),t}).then(e.bind(this.processInitDsl,this,r,i)).then(function(t){var n=t.context.entity;if(!n)return t;var a=$.Deferred(),r=i.getStore(),s=r.config.proxy.getProperties(n.entityType.name),o=[];return e.indexOf(s,"project")>=0&&o.push({project:["id"]}),e.indexOf(s,"team")>=0&&o.push({team:["id"]}),i.getStore().get(n.entityType.name,{id:n.id,fields:o}).done({success:function(i){var n=i[0].data;n.project&&n.project.id&&e.contains(t.parameters,"project.id")&&(t.filter["project.id"]=n.project.id),a.resolve(t)},failure:function(){a.resolve(t)}}),a});return s.promise()},processInitDsl:function(t,i){var n=$.Deferred();if(t.propertyName){var a=t.context.entity,r=[{}];r[0][t.propertyName]=["id"],i.getStore().get(a.entityType.name,{id:a.id,fields:r}).done({success:function(i){var a=i[0].data,r=a[t.propertyName];if(r&&r.id){var s=[t.filter.init_dsl,e.sprintf("id != %d",r.id)];t.filter.init_dsl=e.compact(s).join(" and ")}n.resolve(t)},failure:function(){n.resolve(t)}})}else n.resolve(t);return n},createBuilder:function(t,n){var a=$.Deferred(),r={};e.forEach(t.entityType,function(i){var a,s={name:"name",entityState:"entityState",project:{project:["id","name","abbreviation","color"]},team:{team:["id","name","abbreviation","icon"]},release:{release:["id","name"]},iteration:{iteration:["id","name"]}};
if(t.fields.length)a=["id"].concat(t.fields);else{var o=n.getStore().config.proxy.getProperties(i);a=["id","entityType"],e.each(s,function(i,n){e.contains(o,n)&&!t.columnsDisabled[n]&&a.push(i)})}r[i]=a});var s=new i;return s.registerParameters(t.parameters),s.setOnPage(t.onPage),s.setFields(r),s.setAcid(t.acid),t.ordering&&(s.setOrderBy(t.ordering.name),s.setOrderDir(t.ordering.dir)),a.resolve(s)},buildInitialParameters:function(t){var i=$.Deferred(),n=e.reduce(t.filter||{},function(t,i,n){return e.isUndefined(i)||(t[n]=i),t},{});return i.resolve(n)},doSearch:function(t,i){var a=t.create();if(!a)return $.Deferred().reject(new n({data:{dynamic:{items:[]},fixed:{items:[]}},command:{}}));var r=i.getSliceFactory().create({definition:a.request});r.on("error",e.bind(function(e){this.fire("lookup.error",e.data)},this));var s=this;return r.list(a.command).then(function(e){return new n({data:e.data.items[0],command:e.command.config})},function(){return new n({data:{dynamic:{items:[]},fixed:{items:[]}},command:{}})}).then(function(e){return s.processSearchResults(e)})},processSearchResults:function(e){return e},processResult:function(t){return t.items=e.map(t.items,function(e){return e.data}),t}})}),define("tau/models/finder.entity/model.finder.entity.data.relation",["Underscore","tau/models/finder.entity/model.finder.entity.data"],function(e,t){return t.extend({processInitDsl:function(t,i){var n=t.context.entity,a=$.Deferred(),r=t.dependencyType;return i.getStore().get(n.entityType.name,{id:n.id,fields:[{masterRelations:[{master:["id"]}]},{slaveRelations:[{slave:["id"]}]}]}).done(function(i){var s=e.pluck(e.pluck(i[0].data[r+"Relations"],r),"id");s.push(n.id);var o=e.map(s,function(t){return e.sprintf("id != %d",t)});t.filter.init_dsl=o.join(" and "),a.resolve(t)}),a.promise()}})}),define("tau/models/finder.entity/model.finder.entity.data.user",["Underscore","./model.finder.entity.data"],function(e,t){return t.extend({processOptions:function(t,i){var n=e.defaults(t,{filter:{entityType:"user"},filterValues:{},filterDisabled:[],fields:["id","fullname","firstName","lastName","email","avatarUri"],parameters:["_id","name","email","firstName","lastName","entityType.name","entityState.name","project.id","team.id","_project.id","release.id","iteration.id","user_dsl_filter","init_dsl","dsl"],onPage:15,ordering:{name:"Creation Date",dir:"desc"},columnsDisabled:{name:!0,entityType:!0}});
return n.filter.init_dsl="isActive is true",this._super(n,i)},processSearchResults:function(t){return e.each(t.items,function(e){e.data.entityType={name:"user"}}),t}})}),define("tau/models/finder.entity/model.finder.entity.editable",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus result.ready":function(e,t){this.totalResult=(this.totalResult||[]).concat(t.items)},"bus item.selected":function(t,i){var n=e.find(this.totalResult,function(e){return e.id==i});this.fire("entitySelected",{entity:n})}})}),define("tau/models/finder.entity/model.finder.entity.editable.property",["Underscore","tau/core/model.editable.base"],function(e,t){return t.extend({"bus entitySelected":function(e,t){var i=this.config.propertyName;if(i){var n={};n[i]=null;var a=t.entity;a&&a.id&&(n[i]={id:a.id});var r=["id","name"],s={};s[i]=["id","name",{entityType:["id","name"]}],r.push(s);var o=this.config.context.entity;this.config.store.evictProperties(o.id,o.entityType.name,[i]),this.fire("save",{$set:n,$include:r})}}})}),define("tau/models/finder.entity/model.finder.entity.autocomplete",["Underscore","tau/core/extension.base","tau/models/board.editor/board.filter.suggestionManager"],function(e,t,i){return t.extend({"bus configurator.ready":function(e,t){var n=new i(t);this.fire("suggestionManager.ready",n)},"bus suggestionManager.ready:last + types.ready:last + filter.autocomplete.preload":function(t,i,n,a){var r=a.value;if(r&&0!==r.length&&"?"==r[0]){var s=[r.trim()+" ",r.trim()+"."];e.each(s,function(e){var t={query:{resourceTypes:n,script:e}};i.get(t)})}},"bus suggestionManager.ready:last + types.ready:last + filter.autocomplete.resolve":function(t,i,n,a){var r=a.request.term.slice(0,a.$input[0].selectionStart),s=function(t){var i=t.Suggestions?t.Suggestions.Items:[];i=e.map(i,function(e){return e.Source=t.Source,e.Position=t.Position,e}),a.next(i)},o=function(){a.next([])},l={query:{resourceTypes:n,script:r}};i.get(l).done(s).fail(o)}})}),define("tau/models/finder.entity/model.finder.entity.help",["Underscore","tau/core/model-base","tau/models/board.editor/board.filter.help"],function(e,t,i){return t.extend({"bus types.ready":function(e,t){var n=this;
(new i).get({user_dsl:{types:t}}).done(function(e){n.fire("refresh.help.content",e)})}})}),define("tau/ui/extensions/finder.entity/ui.extension.finder.entity.list",["Underscore","jQuery","tau/core/extension.base","tau/core/termProcessor"],function(e,t,i){return i.extend({init:function(e){this._super(e),this.config=e},"bus afterRender":function(i,n){this.toggleScroll(!1);var a=n.element;this.fire("$el.ready",a);var r=a.find("[role=list]"),s=a.find(".i-role-listholder");this.fire("$listholder.ready",s);var o=e.bind(this.fire,this);r.on("click",".i-role-option",function(e){o("item.selected",t(e.currentTarget).data("id"))});var l=e.throttle(function(){o("paging.tryNext")},100);s.on("scroll.finder",function(e){e.preventDefault(),e.stopPropagation(),l()}),this.toggleScroll(!0),this.fire("$list.ready",r);var u=a.find(".i-role-header");if(this.fire("$header.ready",u),this.config.allData&&this.config.allData.isAddPossible){var c=a.find(".i-role-add-entity");c.on("click",function(){this.fire("add.entity.request")}.bind(this))}this.fire("view.dom.ready")},"bus beforeInit + $el.ready + $list.ready + $listholder.ready":function(e,t,i,n,a){a.listSelectable({items:".i-role-option",className:"hover",saveScroll:!0,keyboardManager:t.config.context.configurator.getKeyBoardManager(),inner:n}),this.fire("$listSelectable.ready",a)},"bus $listSelectable.ready:last + $outerBubbled.shown":function(t,i){i.on("focus",function(){e.delay(function(){if(i.length&&i.data("ui-listSelectable")){i.listSelectable("enable",{saveScroll:!0});var e=0;i.data("ui-listSelectable")._index=e,i.data("ui-listSelectable").$items.eq(e).addClass("hover")}},100)}),i.on("blur",function(){i.length&&i.data("ui-listSelectable")&&(i.listSelectable("disable"),i.data("ui-listSelectable").$items&&i.data("ui-listSelectable").$items.removeClass("hover"))})},"bus $listSelectable.ready:last + $outerBubbled.hidden":function(e,t){t.length&&t.data("ui-listSelectable")&&t.data("ui-listSelectable").$items&&(t.listSelectable("disable"),t.data("ui-listSelectable").$items.removeClass("hover"))
},"bus beforeInit:last + options.ready:last + $el.ready:last + $list.ready:last + $listSelectable.ready:last + $header.ready:last + result.ready":function(t,i,n,a,r,s,o,l){var u=0===l.paging.start,c=i.config.context.configurator.getTemplateFactory().getTermProcessor();if(u){var d=e.isFunction(n.allowToReset)?n.allowToReset(n.context.entity):n.allowToReset;d&&n.data&&n.data.id&&l.items.splice(0,0,{isAction:!0,name:c.replaceTermTags(n.clearValueLabel)})}var p=i.config.templateList,f=p.get().bind({},{columnsDisabled:n.columnsDisabled,result:l});u&&r.data("tryNext",!0).empty(),this.toggleScroll(!1),f.appendTo(r),this.toggleScroll(!0),this.fire("result.rendered",l),u&&a.toggleClass("tau-lookup-body_state_empty",0===l.paging.count),e.delay(e.bind(this.fire,this,"headers.toSync"),200),l.paging.hasNext?this.fire("paging.tryNext"):r.data("tryNext",!1),e.delay(e.bind(function(){if(s.is(":focus")){var e=s.data("ui-listSelectable")._index;0>e&&(e=-1),s.listSelectable("reset",{saveScroll:!0}),s.data("ui-listSelectable")._index=e,e>=0&&s.data("ui-listSelectable").$items.eq(e).addClass("hover")}},this),100)},"bus $el.ready:last + $list.ready:last + $header.ready:last + headers.toSync":function(e,t){var i=t.find("table");i.eq(0).width(i.eq(1).width()),this.fire("adjustPosition")},"bus $el.ready:last + $list.ready:last + $listholder.ready:last + paging.tryNext":function(e,t,i,n){if(this.scrollAvailable&&i.data("tryNext")&&t.is(":visible")){var a=i[0].getBoundingClientRect(),r=n[0].getBoundingClientRect();a.bottom<=r.bottom+50&&this.fire("search.pagingBound")}},"bus $form.ready:last + search.readyToExecute":function(e,t){var i=t.find(".i-role-listholder");i.tauProgressIndicator(),i.tauProgressIndicator("show",{hover:!0})},"bus $form.ready:last + search.completed":function(e,t){var i=t.find(".i-role-listholder");i.data("ui-tauProgressIndicator")&&i.tauProgressIndicator("hide")},toggleScroll:function(e){this.scrollAvailable=e}})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.base.output",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.filter.output",engine:"jqote2",markup:['<span class="tau-cell-content">','<input type="text" name="<%= this.name %>" value="<%= this.value || \'\' %>" />','<span class="tau-bubble-target"><em class="i-role-trigger"><%! this.label || "filter" %></em></span>',"</span>","<% if (this.value){ %>",'<span class="tau-clear-filter i-role-reset"></span>',"<% } %>"]})
}),define("tau/ui/extensions/finder.entity/widgets/widget.base",["Underscore","jQuery","tau/core/class","./template.widget.base.output"],function(e,t,i,n){return i.extend({init:function(i,a,r){this.$el=i,this.configurator=a,r=e.defaults(r||{},{name:"field",value:null,templates:{output:n},onEditStart:t.noop,onRender:t.noop,editable:!0}),this.name=r.name,this.value=r.value,this.options=r},setup:function(){},refresh:function(t){return this.options=e.defaults(t,this.options),this.$bubbled&&this.$bubbled.remove(),this.$bubbled=null,this.render()},render:function(){return this.renderOutput().then(e.bind(function(e){return this.$el.html(e),this.$input=this.$el.find("input[name]"),this.$el},this)).then(e.bind(this.renderReset,this)).then(this.options.editable?e.bind(this.renderEdit,this):t.noop).then(e.bind(this.options.onRender,this,this))},getTemplate:function(e){return this.configurator.getTemplateFactory().get(e)},getOutputTemplate:function(){return this.getTemplate(this.options.templates.output.name)},renderOutputTemplate:function(e){return this.getOutputTemplate().bind({},e)},renderOutput:function(){var e=t.Deferred(),i=this.renderOutputTemplate({name:this.name,value:this.value,label:this.value,editable:this.options.editable});return e.resolve(i),e.promise()},renderReset:function(){var i=t.Deferred();return this.$el.off("click",".i-role-reset"),this.$el.on("click",".i-role-reset",e.bind(this.applyValue,this,"")),i.resolve(),i.promise()},applyValue:function(t){this.value=t,this.render().then(e.bind(function(){this.$input.trigger("change")},this))}})}),define("tau/ui/extensions/finder.entity/widgets/widget.text",["Underscore","jQuery","./widget.base"],function(e,t,i){return i.extend({renderEdit:function(){var i=t.Deferred();return this.$bubbled=this.$el.find(".i-role-trigger").tauBubble({className:this.options.bubbleClassName,onShow:e.bind(function(){this.renderEditField().then(e.bind(function(i){this.$bubbled.tauBubble("option","content",i);var n=i.find("input");n.val("").off("keypress").on("keypress",e.bind(function(i){i.keyCode===t.ui.keyCode.ENTER&&this.applyValue(e.trim(n.val()))
},this)).focus(100)},this))},this)}),i.resolve(),i},renderEditField:function(){var e=t.Deferred(),i=t('<div class="drop-down-list"><div class="drop-down-option"><input class="tau-in-text" type="text" /></div></div>');return i.find("input").attr("placeholder",this.options.placeholder||""),e.resolve(i)}})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.select.option",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.select.option",engine:"jqote2",markup:["<% _.forEach(this.items, function(v){ %>",'<div class="drop-down-option i-role-option" data-value="<%! v.value %>">',"<%! v.label %>","</div>","<% }); %>"]})}),define("tau/ui/extensions/finder.entity/widgets/widget.select",["Underscore","jQuery","./widget.base","./template.widget.select.option"],function(e,t,i,n){return i.extend({init:function(t,i,a){this._super(t,i,a),this.options=e.defaults(this.options,{query:null,fields:["id","name"]}),this.options.templates.option=n},renderOutput:function(){if(!this.value)return this._super();var i=t.Deferred();return this.getCurrentData().then(e.bind(this.getCurrentOption,this)).then(e.bind(function(e){var t=this.renderOutputTemplate({name:this.name,value:this.value,label:e.label,editable:this.options.editable});i.resolve(t)},this)),i.promise()},getCurrentData:function(){var i=t.Deferred();return this.configurator.getStore().get(this.options.collectionName,{id:this.value,fields:this.options.fields}).done(e.bind(function(e){var t=e[0].data;i.resolve(t)},this)),i.promise()},getCurrentOption:function(e){return{value:e.id,label:e.name}},renderEdit:function(){var i=t.Deferred(),n=this.$el.find(".i-role-trigger");return n.tauBubble({className:this.options.bubbleClassName,onPositionConfig:function(e){return e.my="center top",e.at="center bottom",e},onShow:e.bind(function(){this.renderEditList().then(e.bind(function(t){n.tauBubble("option","content",t.text()?t:'<div class="ui-drop-down__message">Nothing found</div>');var i={items:".drop-down-option:visible",className:"drop-down-option_hover",keyboardManager:this.configurator.getKeyBoardManager(),onSelect:e.bind(function(e){this.applyOption(e)
},this)};t.listSelectable(i).listSelectable("enable"),this.options.onEditStart(this)},this))},this)}),this.$bubbled=n,i.resolve(),i},renderEditList:function(){return this.renderEditOptions().then(function(e){return t('<div class="drop-down-list tau-filter-drop-down-list"/>').append(e)})},renderEditOptions:function(){return this.getEditData().then(e.bind(this.getEditOptions,this)).then(e.bind(function(e){return this.getTemplate(this.options.templates.option.name).bind({},{items:e})},this))},getEditData:function(){var e,i=t.Deferred(),n=this.configurator.getStore();return e=this.options.query||this.options.orderBy?n.find(this.options.collectionName,{fields:this.options.fields,$query:this.options.query,$orderBy:this.options.orderBy}):n.get(this.options.collectionName,{fields:this.options.fields}),e.done(function(e){i.resolve(e[0].data)}),i.promise()},getEditOptions:function(t){return e.map(t,function(e){return{value:e.id,label:e.name}})},applyOption:function(e){var t=e.data("value");this.applyValue(t)}})}),define("tau/ui/extensions/finder.entity/widgets/widget.entityState",["Underscore","jQuery","./widget.select"],function(e,t,i){return i.extend({init:function(e,t,i){this._super(e,t,i),this.options.collectionName="entityState"},renderOutput:function(){this.value||this._super();var i=t.Deferred();return this.configurator.getStore().get(this.options.collectionName,{fields:["id","name"]}).done(e.bind(function(t){var n=e.map(t[0].data,function(e){return{value:e.name.toLowerCase(),label:e.name}}),a=this.value,r=e.find(n,function(e){return e.value==a});r||(r={label:this.value});var s=this.renderOutputTemplate({name:this.name,value:this.value,label:r.label});i.resolve(s)},this)),i.promise()},getEditOptions:function(t){return t=e.unique(t,function(e){return e.name.toLowerCase()}),t=e.sortBy(t,function(e){return e.name.toLowerCase()}),e.map(t,function(e){return{value:e.name.toLowerCase(),label:e.name}})}})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.entityType.output",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.entityType.output",engine:"jqote2",markup:['<input type="text" name="<%= this.name %>" value="<%= (this.label || {type: \'\'}).type %>" />','<span class="tau-bubble-target">',"<% if (this.label){ %>",'<em class="i-role-trigger tau-noborder" title="<%! fn.term(this.label.name, \'name\') %>">','<i class="tau-entity-icon tau-entity-icon--<%! this.label.type %>">','<%= fn.term(this.label.type, "iconSmall") %>',"</i>","</em>","<% } else if (this.editable) { %>",'<em class="i-role-trigger">',"filter","</em>","<% } %>","</span>","<% if (this.value){ %>",'<span class="tau-clear-filter i-role-reset"></span>',"<% } %>"]})
}),define("tau/ui/extensions/finder.entity/widgets/template.widget.entityType.option",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.entityType.option",engine:"jqote2",markup:["<% _.forEach(this.items, function(v){ %>",'<div class="drop-down-option i-role-option" data-value="<%! v.value %>">','<i class="tau-entity-icon tau-entity-icon--<%! v.label.type %>">','<%= fn.term(v.label.type, "iconSmall") %>',"</i>",'<span class="tau-bubble-txt">','<%= fn.term(v.label.type, "name") %>',"</span>","</div>","<% }); %>"]})}),define("tau/ui/extensions/finder.entity/widgets/widget.entityType",["Underscore","jQuery","./widget.select","./template.widget.entityType.output","./template.widget.entityType.option"],function(e,t,i,n,a){return i.extend({init:function(e,t,i){this._super(e,t,i),this.options.collectionName="entityType",this.options.templates.output=n,this.options.templates.option=a},_value:function(e){return{value:e.id,label:{type:e.name.toLowerCase()}}},getCurrentOption:function(e){return this._value(e)},getEditOptions:function(t){return e.map(t,this._value)}})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.releaseIteration.output",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.releaseIteration.output",engine:"jqote2",markup:['<input type="text" name="_project.id" value="<%= this.value[\'_project.id\'] || \'\' %>" />','<input type="text" name="release.id" value="<%= this.value[\'release.id\'] || \'\' %>" />','<input type="text" name="iteration.id" value="<%= this.value[\'iteration.id\'] || \'\' %>" />','<span class="tau-bubble-target">','<em class="i-role-trigger" title="<%! this.label.fullName %>"><%! this.label.name || "filter" %></em>',"</span>","<% if (_.compact(_.values(this.value)).length) { %>",'<span class="tau-clear-filter i-role-reset"></span>',"<% } %>"]})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.releaseIteration.option",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.releaseIteration.option",engine:"jqote2",markup:["<% _.forEach(this.items, function(releases, projectName){ %>",'<div class="drop-down-group">',"<div><%! projectName %></div>","<% _.forEach(releases, function(release){ %>",'<div class="drop-down-option i-role-option"  data-type="release" data-project-id="<%=release.project.id %>" data-value="<%=release.value %>">','<i class="tau-entity-icon tau-entity-icon--release"><%= fn.term("Release", "iconSmall") %></i>','<span class="tau-bubble-txt"><%! release.label %></span>',"</div>",'<div class="drop-down-group">',"<% _.forEach(release.iterations, function(item){ %>",'<div class="drop-down-option i-role-option" data-type="iteration"  data-project-id="<%=item.project.id %>" data-release-id="<%=release.value %>"  data-value="<%= item.value %>">',"<% if (item.value != -1){ %>",'<i class="tau-entity-icon tau-entity-icon--iteration"><%= fn.term("Iteration", "iconSmall") %></i>',"<% } %>",'<span class="tau-bubble-txt"><%! item.label %></span>',"</div>","<% }); %>","</div>","<% }); %>","</div>","<% }); %>"]})
}),define("tau/ui/extensions/finder.entity/widgets/widget.releaseIteration",["Underscore","jQuery","./widget.select","./template.widget.releaseIteration.output","./template.widget.releaseIteration.option"],function(e,t,i,n,a){return i.extend({init:function(e,t,i){this._super(e,t,i),this.setup()},setup:function(){this.options.templates.output=n,this.options.templates.option=a,this.options.onlyReleases=this.options.onlyReleases||!1,this.options.fields=["id","name",{iterations:["id","name"]},{project:["id","name","isActive"]}],this.iterationBacklog={id:-1,name:"Backlog"},this.releaseBacklog={id:-1,name:"Backlog",iterations:[]}},loadSelectedRelease:function(e){var t=this.value["release.id"];t>0?this.configurator.getStore().get("release",{id:t,fields:["id","name"]}).done(function(t){e(!1,t[0].data)}):t==this.releaseBacklog.id?e(!1,this.releaseBacklog):e(!1,null)},loadSelectedIteration:function(e){var t=this.value["iteration.id"];t>0?this.configurator.getStore().get("iteration",{id:t,fields:["id","name",{release:["id","name"]}]}).done(function(t){e(!1,t[0].data)}):t==this.iterationBacklog.id?e(!1,this.iterationBacklog):e(!1,null)},_renderOutput:function(e,t){return this.renderOutputTemplate({name:this.name,value:this.value,label:{name:e,fullName:t},editable:this.options.editable})},renderOutput:function(){var i=t.Deferred();if(!e.compact(e.values(this.value)).length){var n=this._renderOutput("","");return i.resolve(n),i.promise()}var a=[e.bind(this.loadSelectedRelease,this),e.bind(this.loadSelectedIteration,this)];return e.parallel(a,e.bind(function(t,n){var a=n[1]||n[0],r=e.map(e.compact(n),function(e){return e.name}).join(", "),s=this._renderOutput(a.name,r);i.resolve(s)},this)),i.promise()},getEditOptions:function(t){var i=e.uniq(e.pluck(t,"project"),function(e){return e.id}),n=e.map(i,e.bind(function(t){var i=e.clone(this.releaseBacklog);return i.project=t,i},this));return t=e.filter(t,function(e){return e.project.isActive}),t=e.sortBy(t,function(e){return e.project.name+" "+e.name
}),t=e.map(t.concat(n),e.bind(function(t){var i={value:t.id,label:t.name,project:t.project};return this.options.onlyReleases?i.iterations=[]:(i.iterations=e.sortBy(t.iterations,function(e){return e.name}),i.iterations=e.map(i.iterations.length?[this.iterationBacklog].concat(i.iterations):i.iterations,function(e){return{value:e.id,label:e.name,project:t.project}})),i},this)),t=e.groupBy(t,function(e){return e.project.name})},applyOption:function(e){var t,i=e.data();t="iteration"===i.type?{"iteration.id":i.value,"release.id":i.releaseId,"_project.id":i.projectId}:{"iteration.id":null,"release.id":i.value,"_project.id":i.projectId},this.applyValue(t)}})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.project.output",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.project.output",engine:"jqote2",markup:['<input type="text" name="<%= this.name %>" value="<%= this.value || \'\' %>" />','<span class="tau-bubble-target">',"<% if (this.label) { %>",'<em class="i-role-trigger <% if (this.value >= 0) { %>tau-noborder<% } %>">',"<% if (this.value >= 0) { %>",'<span class="tau-project-name" style="background-color: <%= this.label.color %>" title="<%! this.label.name %>">',"<%= this.label.abbreviation %>","</span>","<% } else { %>","<%= this.label.abbreviation %>","<% } %>","</em>","<% } else { %>",'<em class="i-role-trigger">',"filter","</em>","<% } %>","</span>","<% if (this.value) { %>",'<span class="tau-clear-filter i-role-reset"></span>',"<% } %>"]})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.project.option",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.project.option",engine:"jqote2",markup:["<% _.forEach(this.items, function(v){ %>",'<div class="drop-down-option i-role-option" data-value="<%! v.value %>">','<% var color = v.label.color || "transparent"; %>','<i class="tau-icon tau-icon_type_color" style="background-color: <%= color %>"></i>','<span class="tau-bubble-txt"><%! v.label.name %></span>',"</div>","<% }); %>"]})
}),define("tau/ui/extensions/finder.entity/widgets/widget.project",["Underscore","jQuery","./widget.select","./template.widget.project.output","./template.widget.project.option"],function(e,t,i,n,a){return i.extend({init:function(e,t,i){this._super(e,t,i),this.options.collectionName="project",this.options.templates.output=n,this.options.templates.option=a,this.options.fields=["id","name","color","abbreviation","isActive"],this.options.query={isActive:1},this.options.orderBy="name",this.zero={id:-1,color:"",abbreviation:"No project",name:"No project"}},getCurrentOption:function(e){return{value:e.id,label:e}},getCurrentData:function(){var i=e.bind(this._super,this);if(this.value==this.zero.id){var n=t.Deferred();return n.resolve(this.zero).promise()}return i()},getEditOptions:function(t){return e.map([this.zero].concat(t),function(e){return{value:e.id,label:e}})}})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.team.output",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.team.output",engine:"jqote2",markup:['<input type="text" name="<%= this.name %>" value="<%= this.value || \'\' %>" />','<span class="tau-bubble-target">',"<% if (this.label){ %>",'<em class="i-role-trigger <% if (this.value >= 0){ %>tau-noborder<% } %>">',"<% if (this.value >=0){ %>",'<span class="tau-team-name" title="<%! this.label.name %>">','<span class="tau-icon tau-icon_type_svg tau-icon_name_<%= this.label.icon %>"></span>',"<i><%= this.label.abbreviation %></i>","</span>","<% } else { %>","<%= this.label.abbreviation %>","<% } %>","</em>","<% } else { %>",'<em class="i-role-trigger">',"filter","</em>","<% } %>","</span>","<% if (this.value){ %>",'<span class="tau-clear-filter i-role-reset"></span>',"<% } %>"]})}),define("tau/ui/extensions/finder.entity/widgets/template.widget.team.option",["tau/core/templates-factory"],function(e){return e.register({name:"finder.entity.team.option",engine:"jqote2",markup:["<% _.forEach(this.items, function(v){ %>",'<div class="drop-down-option i-role-option" data-value="<%! v.value %>">','<i class="tau-icon tau-icon_type_svg tau-icon_name_<%= v.label.icon %>"></i>','<span class="tau-bubble-txt"><%! v.label.name %></span>',"</div>","<% }); %>"]})
}),define("tau/ui/extensions/finder.entity/widgets/widget.team",["Underscore","jQuery","./widget.select","./template.widget.team.output","./template.widget.team.option"],function(e,t,i,n,a){return i.extend({init:function(e,t,i){this._super(e,t,i),this.options.templates.output=n,this.options.templates.option=a,this.options.fields=["id","name","icon","abbreviation"],this.options.orderBy="name",this.zero={id:-1,color:"",abbreviation:"No team",name:"No team"}},getCurrentOption:function(e){return{value:e.id,label:e}},getCurrentData:function(){var i=e.bind(this._super,this);if(this.value==this.zero.id){var n=t.Deferred();return n.resolve(this.zero).promise()}return i()},getEditOptions:function(t){return e.map([this.zero].concat(t),function(e){return{value:e.id,label:e}})}})}),define("tau/ui/extensions/finder.entity/ui.extension.finder.entity.filter",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/finder.entity/widgets/widget.text","tau/ui/extensions/finder.entity/widgets/widget.select","tau/ui/extensions/finder.entity/widgets/widget.entityState","tau/ui/extensions/finder.entity/widgets/widget.entityType","tau/ui/extensions/finder.entity/widgets/widget.releaseIteration","tau/ui/extensions/finder.entity/widgets/widget.project","tau/ui/extensions/finder.entity/widgets/widget.team"],function(e,t,i,n,a,r,s,o,l,u){return i.extend({"bus beforeInit + afterRender + dataBind":function(i,a,c,d){var p=e.bind(this.fire,this),f=a.config.context.configurator,m=c.element,h=m.find("form");h.find(".i-role-filter-input").tauResetableInput().placeholder();var g=h.find(".tau-filter-line"),v={_id:new n(g.filter("[data-filter-name=_id]"),f,{name:"_id",value:d.filter._id,placeholder:"id",bubbleClassName:"tau-bubble-lookup-id tau-bubble-auto-width"}),"entityType.name":new s(g.filter('[data-filter-name="entityType.name"]'),f,{name:"entityType.name",value:d.filter["entityType.name"],query:d.filterValues.entityType,editable:e.indexOf(d.filterDisabled,"entityType.name")<0}),name:new n(g.filter("[data-filter-name=name]"),f,{name:"name",value:d.filter.name,placeholder:"Name",bubbleClassName:"tau-bubble-lookup-name"}),firstName:new n(g.filter("[data-filter-name=firstName]"),f,{name:"firstName",value:d.filter.firstName,placeholder:"First Name",bubbleClassName:"tau-bubble-lookup-name"}),lastName:new n(g.filter("[data-filter-name=lastName]"),f,{name:"lastName",value:d.filter.lastName,placeholder:"Last Name",bubbleClassName:"tau-bubble-lookup-name"}),email:new n(g.filter("[data-filter-name=email]"),f,{name:"email",value:d.filter.email,placeholder:"Email",bubbleClassName:"tau-bubble-lookup-name"}),"entityState.name":new r(g.filter('[data-filter-name="entityState.name"]'),f,{name:"entityState.name",value:d.filter["entityState.name"],query:d.filterValues.entityState,bubbleClassName:"tau-bubble-auto-width"}),"project.id":new l(g.filter('[data-filter-name="project.id"]'),f,{name:"project.id",value:d.filter["project.id"],query:d.filterValues["project.id"],bubbleClassName:"tau-bubble-lookup-project"}),"release.id":new o(g.filter('[data-filter-name="release.id"]'),f,{onlyReleases:!0,name:"release_iteration",collectionName:"release",value:{"release.id":d.filter["release.id"],"iteration.id":d.filter["iteration.id"]},query:d.filterValues.releaseIteration}),"iteration.id":new o(g.filter('[data-filter-name="iteration.id"]'),f,{name:"release_iteration",collectionName:"release",value:{"release.id":d.filter["release.id"],"iteration.id":d.filter["iteration.id"]},query:d.filterValues.releaseIteration}),"team.id":new u(g.filter('[data-filter-name="team.id"]'),f,{name:"team.id",value:d.filter["team.id"],query:d.filterValues["team.id"],collectionName:"team",bubbleClassName:"tau-bubble-lookup-team"})};
e.forEach(v,function(e){e.options.onEditStart=function(e){p("$filter.loaded",e)},e.options.onRender=function(e){e.$bubbled&&e.$bubbled.tauBubble("option","appendTo",h)}});var b=e.throttle(function(e){p("search.parametersBound",e)},200),y=h.serialize();t.whenList(e.map(v,function(e){return e.render()})).done(function(){y=h.serialize(),p("$filters.rendered",h)}),this.fire("widgets.ready",v),h.off(".filter").on("submit.filter",function(e){e.preventDefault(),e.stopPropagation()}).on("input.filter",".i-role-filter-input",function(e){var i=e.currentTarget;i.value||t(i).trigger("specialChange")}).on("keydown.filter",".i-role-filter-input",function(e){if(e.keyCode==t.ui.keyCode.ENTER){var i=t(this);i.trigger("specialChange")}}).on("keyup.filter",".i-role-filter-input",function(i){var n=i.keyCode;if(16!=n&&17!=n&&18!=n){var a=t(this),r=a.val();e.startsWith(e.trim(r),"?")||a.trigger("specialChange")}}).on("change.filter _change.filter specialChange.filter",function(){var i=h.serializeArray(),n=t.param(i);if(y!==n){y=n;var a={};e.each(i,function(e){a[e.name]=e.value}),b(a)}}),this.fire("$form.ready",h)},"bus widgets.ready:last + search.parametersBound":function(e,t,i){var n=i["entityType.name"];t["entityState.name"].refresh(n?{query:{"entityType.name":n}}:{query:null});var a=i["project.id"];a?(t["release.id"].refresh({editable:-1!=a,query:{"project.id":a}}),t["iteration.id"].refresh({editable:-1!=a,query:{"project.id":a}})):(t["release.id"].refresh({editable:!0,query:!1}),t["iteration.id"].refresh({editable:!0,query:!1}))},"bus $form.ready + $listholder.ready + content.ready":function(e,t){var i=t.find(".i-role-filter-input"),n=t.find(".i-role-help");n.data("ui-tauBubble")&&n.tauBubble("option","content").on("click",function(){i.focus()});var a=i.data("ui-autocomplete");delete a._change}})}),define("tau/ui/extensions/finder.entity/ui.extension.finder.entity.bubble",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $outerBubbled.ready":function(t,i){var n=".finderEntityBubble"+this.__objectId;
i.on("taububbleshow"+n,e.bind(this.fire,this,"$outerBubbled.shown")),i.on("taububblehide"+n,e.bind(this.fire,this,"$outerBubbled.hidden"))},"bus $el.ready:last + $listholder.ready:last + $outerBubbled.shown":function(e,i,n){n.css("max-height",t(window).height()/3),this.fire("paging.tryNext"),i.find(":text").focus(),this.fire("headers.toSync")},"bus $outerBubbled.ready:last + $el.ready:last + result.rendered":function(e,t,i){i.is(":visible")&&this.fire("headers.toSync"),this.fire("headers.toSync"),this.fire("adjustPosition")},"bus $outerBubbled.ready:last + headers.toSync":function(){this.fire("adjustPosition")},"bus $outerBubbled.ready:last + destroy":function(e,t){var i=".finderEntityBubble"+this.__objectId;t.off(i)}})}),define("tau/ui/templates/finder.entity/ui.template.finder.entity.list.row",["tau/core/templates-factory"],function(e){var t={name:"finder.entity.list.row",engine:"jqote2",markup:["<% var columnsDisabled = this.columnsDisabled; %>","<% var items = (this.result && this.result.items) ? this.result.items : []; %>","<% _.forEach(items, function(v){ %>",'<tr role="option" class="i-role-option <%= v.isAction ? "action" : "" %>" data-id="<%! v.id %>">','<td class="tau-cell-id">','<span class="tau-cell-content"><%! v.id %></span>',"</td>","<% if (!columnsDisabled.entityType){ %>",'<td class="tau-cell-type">',"<% if (v.entityType){ %>",'<span class="tau-cell-content" title="<%! fn.term(v.entityType.name, "name") %>">','<i class="tau-entity-icon tau-entity-icon--<%= v.entityType.name.toLowerCase() %>">','<%! fn.term(v.entityType.name, "iconSmall") %>',"</i>","</span>","<% } %>","</td>","<% } %>","<% if (!columnsDisabled.avatarUri){ %>",'<td class="tau-cell-avatar">','<img class="tau-cell-content" src="<%=v.avatarUri + 20%>" title="<%=_.escape(_.trim(v.fullName) || v.email)%>"/>',"</td>","<% } %>","<% if (!columnsDisabled.name){ %>",'<td class="tau-cell-name">','<span class="tau-cell-content">',"<%! v.name %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.firstName){ %>",'<td class="tau-cell-name">','<span class="tau-cell-content">',"<%! v.firstName %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.lastName){ %>",'<td class="tau-cell-name">','<span class="tau-cell-content">',"<%! v.lastName %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.email){ %>",'<td class="tau-cell-name">','<span class="tau-cell-content">',"<%! v.email %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.entityState){ %>",'<td class="tau-cell-state">','<span class="tau-cell-content">',"<% if (v.entityState){ %>","<%! v.entityState.name %>","<% } %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.project){ %>",'<td class="tau-cell-project">','<span class="tau-cell-content">',"<% if (v.project){ %>",'<span style="background-color:<%! v.project.color %>;" class="tau-project-name">',"<%! v.project.abbreviation %>","</span>","<% } %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.release || !columnsDisabled.iteration){ %>",'<td class="tau-cell-release">','<span class="tau-cell-content">',"<% if (v.release && v.release.name){ %>","<% if (v.iteration && v.iteration.name){ %>",'<span class="tau-release-name" title="<%! v.iteration.name %>, <%! v.release.name %>">',"<%! v.iteration.name %>, <%! v.release.name %>","</span>","<% }else{ %>",'<span class="tau-release-name">',"<%! v.release.name %>","</span>","<% } %>","<% } %>","</span>","</td>","<% } %>","<% if (!columnsDisabled.team){ %>",'<td class="tau-cell-team">','<span class="tau-cell-content">',"<% if (v.team){ %>",'<div class="tau-team-name">','<span class="tau-icon tau-icon_type_svg tau-icon_name_<%! v.team.icon %>"></span>',"<i><%! v.team.abbreviation %></i>","</div>","<% } %>","</span>","</td>","<% } %>","</tr>","<% }); %>"]};
return e.register(t)}),define("tau/ui/templates/finder.entity/ui.template.finder.entity.list",["tau/core/templates-factory","tau/ui/templates/finder.entity/ui.template.finder.entity.list.row"],function(e){var t={name:"finder.entity.list",engine:"jqote2",markup:['<div class="tau-lookup-body">','<table class="i-role-header">',"<thead>","<tr>",'<th class="tau-cell-id">','<div class="tau-col-header">ID</div>','<div class="tau-filter-line" data-filter-name="_id"></div>',"</th>","<% if (!this.columnsDisabled.entityType){ %>",'<th class="tau-cell-type">','<div class="tau-col-header">Type</div>','<div class="tau-filter-line" data-filter-name="entityType.name"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.avatarUri){ %>",'<th class="tau-cell-avatar">','<div class="tau-col-header">Avatar</div>','<div class="tau-filter-line" data-filter-name="avatarUri"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.name){ %>",'<th class="tau-cell-name">','<div class="tau-col-header">Name</div>','<div class="tau-filter-line" data-filter-name="name"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.firstName){ %>",'<th class="tau-cell-name">','<div class="tau-col-header">First Name</div>','<div class="tau-filter-line" data-filter-name="firstName"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.lastName){ %>",'<th class="tau-cell-name">','<div class="tau-col-header">Last Name</div>','<div class="tau-filter-line" data-filter-name="lastName"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.email){ %>",'<th class="tau-cell-name">','<div class="tau-col-header">Email</div>','<div class="tau-filter-line" data-filter-name="email"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.entityState){ %>",'<th class="tau-cell-state">','<div class="tau-col-header">State</div>','<div class="tau-filter-line" data-filter-name="entityState.name"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.project){ %>",'<th class="tau-cell-project">','<div class="tau-col-header">Project</div>','<div class="tau-filter-line" data-filter-name="project.id"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.release && this.columnsDisabled.iteration){ %>",'<th class="tau-cell-release">','<div class="tau-col-header"><%= fn.term("release") %></div>','<div class="tau-filter-line" data-filter-name="release.id"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.iteration){ %>",'<th class="tau-cell-release">','<div class="tau-col-header"><%= fn.term("release") %>, <%= fn.term("iteration") %></div>','<div class="tau-filter-line" data-filter-name="iteration.id"></div>',"</th>","<% } %>","<% if (!this.columnsDisabled.team){ %>",'<th class="tau-cell-team">','<div class="tau-col-header">Team</div>','<div class="tau-filter-line" data-filter-name="team.id"></div>',"</th>","<% } %>","</tr>","</thead>","</table>",'<div class="tau-lookup-block__listholder i-role-listholder" tabindex="0">',"<table>",'<tbody role="list">','<%= fn.sub("finder.entity.list.row", this) %>',"</tbody>","</table>","</div>","<% if (this.isAddPossible === true) { %>",'<div class="tau-lookup-body__message">Nothing found. You need to <span class="i-role-add-entity ui-link">create <%= this.fieldCaption %></span> first.</div>',"<% } else { %>",'<div class="tau-lookup-body__message">Nothing found</div>',"<% }%>","</div>"]};
return e.register(t)}),define("tau/ui/templates/finder.entity/ui.template.finder.entity",["tau/core/templates-factory","tau/ui/templates/finder.entity/ui.template.finder.entity.list","tau/ui/templates/board.editor/ui.template.board.editor.filter"],function(e){var t={name:"finder.entity",engine:"jqote2",markup:['<div class="tau-lookup-block" tabindex="1" >','<form class="i-role-form">','<div class="tau-lookup-header">','<%= fn.sub("board.editor.filter", {name: "user_dsl", placeholder: "ID, Name or type ? for advanced filter"}) %>',"</div>",'<%= fn.sub("finder.entity.list", this) %>',"</form>","</div>"]};return e.register(t)}),define("tau/components/component.finder.entity",["tau/components/component.factory","tau/models/finder.entity/model.finder.entity.data","tau/models/finder.entity/model.finder.entity.data.relation","tau/models/finder.entity/model.finder.entity.data.user","tau/models/finder.entity/model.finder.entity.editable","tau/models/finder.entity/model.finder.entity.editable.property","tau/models/finder.entity/model.finder.entity.autocomplete","tau/models/finder.entity/model.finder.entity.help","tau/ui/extensions/finder.entity/ui.extension.finder.entity.list","tau/ui/extensions/finder.entity/ui.extension.finder.entity.filter","tau/ui/extensions/board.editor/ui.extension.board.editor.autocomplete","tau/ui/extensions/finder.entity/ui.extension.finder.entity.bubble","tau/ui/extensions/board.editor/ui.extension.board.editor.help","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/board.plus/ui.extension.board.plus.errors","tau/ui/templates/finder.entity/ui.template.finder.entity","tau/ui/templates/finder.entity/ui.template.finder.entity.list.row","libs/jquery/jquery.placeholder","libs/jquery/jquery.tau.resetableInput"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g){return e.define(function(e){e.templateList=g;var v={relation:i,user:n},b=e.allData&&e.allData.model?v[e.allData.model]||t:e.model||t,y={name:e.allData&&e.allData.name||"finder",extensions:[b,a,e.modelEditable||r,s,o,l,u,c,f,m,d,p],template:h};
return y})}),define("template!tau/ui/templates/ui.template.board.cell.convert.success",["tau/core/templates-factory"],function(e){var t={name:"board.cell.convert.success",engine:"jqote2",customFunctions:null,markup:'<h3>Success!</h3> <p> <%! this.srcType %> <%! this.name %> has been converted to <%! this.dstType %> <a class="ui-quick-add-notification-link i-role-card-view tau-entity-name" href="<%=this.url%>"><%!this.name%></a>. </p>\''};return e.register(t)}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-convert",["jQuery","Underscore","tau/components/component.finder.entity","tau/utils/utils.boardCard","tau/models/page.entity/entity.context.factory","tau/core/termProcessor","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/utils/utils.serverErrorTranslator","template!tau/ui/templates/ui.template.board.cell.convert.success"],function(e,t,i,n,a,r,s,o,l){var u=!1,c="entityTypesToConvertInto",d="i-role-card-context-menu-convert",p={entityTypes:["request","feature","bug","userstory","task"],allowedFor:function(e){return t.contains(this.entityTypes,e)}},f=function(e){return"Do you really want to convert "+e.srcEntityType.term+" to "+e.dstEntityType.term+"?"},m=function(t){return t.keyCode===e.ui.keyCode.ESCAPE},h=function(e,i){if(null!==i){var n=t.findWhere(e,{name:i});if(n){var a=e.indexOf(n);e.splice(a,1)}}},g={setup:function(i,n,a,r,s,o){var l=e("<div/>").append(n.element),u=e.Deferred(),c=l.append(['<div class="i-role-confirmation-content" style="display: none">',"<h3>"+f(o)+"</h3>",'<div class="tau-buttons">','<button type="button" class="tau-btn tau-primary i-role-actionok">Yes, I\'m sure</button>','<button type="button" class="tau-btn i-role-actioncancel">No</button>',"</div>","</div>"].join("")),d="hideSubmenu",p=r.tauBubble({alignTo:r,template:['<div class="tau-bubble">','<div class="tau-bubble__arrow" role="arrow"></div>','<div class="tau-bubble__inner tau-container" role="content"></div>',"</div>"].join(""),content:c,onPositionConfig:function(e){return e.my="center top",e.at="center bottom",e.collision="fit flip",e
},onArrowPositionConfig:function(e,t){return"bottom"===t?(e.my="center bottom",e.at="center top"):(e.my="center top",e.at="center bottom"),e},onHide:function(){o.configurator.getKeyBoardManager().popHandler(),h(i,d)},onShow:function(){e.contextMenu.op.registerKeyHandlerFilter(m),o.configurator.getKeyBoardManager().pushHandler({});var t=p.tauBubble("widget");t.find(".tau-lookup-block").show(),t.find(".i-role-confirmation-content").hide(),t.removeClass("tau-warning-bubble"),t.find(".filter-field").focus(),t.unbind("click"),r.tauBubble("adjustPosition"),t.one("click",".i-role-actioncancel",function(){p.tauBubble("hide"),u.reject()}),t.one("click",".i-role-actionok",function(){p.tauBubble("hide");var e=s.data();u.resolve(e.entityId)})},zIndex:99999});return p.tauBubble("show"),a.fire("$outerBubbled.shown",p),i.push({hide:t.bind(p.tauBubble,p,"hide"),name:d}),u},run:function(t,n,a,r,s,o,l,u){var d=i.create({entityType:"userstory"}),p=this,f=e.Deferred();d.on("afterRender",function(i,m){var h=p.setup(t,m,d,a,n,s);e.when(f,h).done(function(e,t){s.configurator.getActionsService().convertGeneralToTask(t,e).done(function(e){r.$menu.trigger("contextmenu:hide"),l.notifyAboutSuccess(s.srcEntityType,s.dstEntityType,e.d);var t=n.data();delete t[c],o(t)}).fail(u)})}),d.on("entitySelected",function(e,t){var i=a.tauBubble("widget");i.find(".tau-lookup-block").hide(),i.find(".i-role-confirmation-content").show(),i.addClass("tau-warning-bubble"),a.tauBubble("adjustPosition"),f.resolve(t.entity.id)}),d.on("result.ready",function(){a.tauBubble("adjustPosition")}),d.initialize({context:s.appContext})}};return{createMenuItem:function(i){var m=new s(i),v=function(){var n=i.configurator,a=i.bus,r=e.Deferred();return i.configurator.getComponentBusRegistry().getByName("entityViewer").done(r.resolve),{createNodeMessage:function(e,t,i){var a={srcType:e.term,dstType:t.term,name:i.Name,url:n.getUrlBuilder().getNewViewUrl(i.ID,t.name,!0)};return l.render(a)},notifyAboutSuccess:function(e,i,n){var s=this.createNodeMessage(e,i,n);
r.then(function(e){s.on("click",".i-role-card-view",t.bind(function(t){t.preventDefault(),e.fire("cardDataToShow.ready",{entityId:n.ID,entityType:i.name.toLowerCase()}),this.fire("close")},a)),a.fire("notification",{$node:s})})}}}(),b=function(e){m.deleteCard(e,i.bus)},y=function(e){var t=JSON.parse(e.responseText)||{Message:"Server is not available"},n=o.translateServerError.call(this,t);i.bus.fire("error",n)},_=function(e,n,a,r){var s=a.$trigger.data(),o=s.entityId,l=r.$node,u="confirm";l.tauConfirm({showEvent:null,content:["<h3>"+f(n)+"</h3>"].join(""),className:"context-menu-do-not-hide i-role-taububble-ignore",callbacks:{success:t.bind(function(e){e.$menu.trigger("contextmenu:hide");var t=n.dstEntityType.id;n.configurator.getActionsService().convertGeneralToType(o,t).done(function(e){v.notifyAboutSuccess(n.srcEntityType,n.dstEntityType,e.d),delete s[c],b(s)}).fail(y)},i.bus,a)},onHide:function(){h(e,u)}}),t.defer(t.bind(l.tauConfirm,l),"show"),e.push({hide:t.bind(l.tauConfirm,l,"hide"),name:u})},x=function(e,t,i,n){g.run(e,i.$trigger,n.$node,i,t,b,v,y)},w=function(t){var n=t.data();return n.hasOwnProperty(c)?e.Deferred().resolve(n[c]):u?e.Deferred().resolve([]):i.configurator.getActionsService().getEntityTypesToConvert(n.entityId).done(function(e){t.data(c,e)}).fail(y)},C=[],S=function(){t.each(C,function(e){e.hide()}),C=[]},T=function(e){return"task"===e.name.toLowerCase()},k=function(s,o){var l=e("<div>Loading&hellip;</div>"),u="submenu",c={template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__inner tau-container convert-menu-items" role="content" ></div>',"</div>"].join(""),showEvent:"",hideEvent:"",stackName:"context-menu-convert-action",content:l,onPositionConfig:function(e){return e.my="left center",e.at="right center",e.collision="flipfit",e},onHide:function(){h(C,u)}},d=o.$node.tauBubble(c);d.tauBubble("show"),C.push({hide:t.bind(d.tauBubble,d,"hide"),name:u});var p=s.$trigger,f=n.convertToEntity(p.data()),m=a.create(f,i.configurator),g=w(p);
e.when(m,g).then(function(n,a){var o=p.data("entityType"),u=new r(n.getTerms()),c={name:o,term:u.getTerm(o)},d=e("<div></div>").on({mouseenter:function(t){e(t.target).addClass("hover")},mouseleave:function(t){e(t.target).removeClass("hover")}},".i-role-convert-to");t.chain(a).sortBy(function(e){return T(e)?1:0}).each(function(t){var a=T(t)?t.term+"...":t.term,r=u.getTerms(t.name),o=e('<div class="custom-context-menu-item i-role-convert-to" data='+t.term.toLowerCase()+'><span><i class="tau-entity-icon tau-entity-icon--'+t.name.toLowerCase()+'">'+r.iconSmall+"</i>"+a+"</span></div>");o.click(function(a){var r=T(t)?x:_,o={srcEntityType:c,dstEntityType:t,appContext:n,configurator:i.configurator};r(C,o,s,{$node:e(this)}),a.stopPropagation()}).appendTo(d)}),l.empty().append(d)})};return{name:"Convert to&hellip;",className:d,isDisabled:u,onHide:function(){S()},disabled:function(){var e=this,t=e.data("entityType");return!p.allowedFor(t)},itemClickCallback:function(e,t){return k(e,t),!1}}}}}),define("tau/models/choice/model.choice.base",["Underscore","tau/core/model.editable.base"],function(e,t){return t.extend({getAssignable:function(e){var t=this.config.context.entity,i=t.entityType.name,n=t.id,a={id:n,fields:this.getRequiredFields()};return this.store.get(i,a).done({success:e}),this},sortProjects:function(t){var i=this.config.context.applicationContext,n=e.pluck(i.selectedProjects,"id"),a=t.sort(function(t,i){var a=e.indexOf(n,t.id),r=e.indexOf(n,i.id);return a>=0&&r>=0||0>a&&0>r?t.id-i.id:-1*a+r});return a},getCurrentEntityId:function(){var e=this.config.data;return e?e.id?e.id:e.value&&e.value.id?e.value.id:null:null},getRequiredFields:function(){return["id"]},onDataRetrieved:function(t){var i=e.pluck(t,"data");this.processData.apply(this,i)},"bus updateState":function(e,t){var i=null;t&&t.id&&(i={id:t.id});var n={};n[this.propertyType]=i;var a={$set:n,additionalData:t};this.fire("save",a)},isNullableValue:function(){return this.config.data&&e.has(this.config.data,"hasValue")?this.config.data.hasValue:null!==this.getCurrentEntityId()
}})}),define("tau/models/choice/model.choice.project",["Underscore","./model.choice.base"],function(e,t){var i={bug:["Bug Tracking"],feature:["Requirements"],release:["Requirements"],testcase:["Test Cases"],testplan:["Test Cases"],iteration:["Iterations"],request:["Help Desk"],epic:["Requirements"]};return t.extend({propertyType:"project",init:function(e,t){this._super(e),this.showCurrentProject=!!t},"bus beforeInit":function(t,i){var n=i.config.context.entity,a=i.config.context.configurator,r=a.getStore(),s=e.bind(this.fire,this),o={fields:["id","name","color","isActive",{process:["id",{practices:["id","name"]}]}]},l={id:n.id,fields:["id",{project:["id"]}]};r.get("project",o).done(function(e){s("items.ready",e[0].data)}),r.get(n.entityType.name,l).done(function(e){s("currentItem.ready",e[0].data.project||{})})},"bus beforeInit:last + items.ready + currentItem.ready":function(t,n,a,r){var s=n.config,o=n.config.context.entity.entityType.name.toLowerCase(),l=i[o]||[],u=r&&r.id;a=e.filter(a,function(t){var i=!0;if(l.length&&t.isActive){var n=e.pluck(t.process.practices,"name");i=e.any(n,function(t){return e.indexOf(l,t)>=0})}return t.isActive&&i}),a=e.sortBy(a,function(e){return e.name.toLowerCase()}),!this.showCurrentProject&&u&&(a=e.reject(a,function(e){return e.id===r.id}));var c={states:a,completed:!0,nullableValue:this.isNullableValue(),templateOption:s.templateOption};this.fire("dataBind",c)}})}),define("tau/models/choice/model.choice.copy.to.project",["tau/models/choice/model.choice.project","tau/utils/utils.serverErrorTranslator"],function(e,t){return e.extend({init:function(e){this._super(e,!0)},handleSave:function(e,t){var i=e.$set||e,n=i.project.id,a=t.id,r=this.config.context.configurator,s=r.getActionsService();this.fire("beforeSave",e.additionalData),s.copyGeneralToProject(a,n,this._saveCompleted.bind(this,e.additionalData),this._saveFailed.bind(this,e.additionalData))},_saveCompleted:function(e,t){var i=t.d,n=i.EntityTypeName.split("."),a=n[n.length-1],r={entityId:i.GeneralID,entityType:a,selectedProjectData:e};
this.fire("afterSave",r)},_saveFailed:function(e,i){var n=t.translateXhrError(i);n.data=e,this.fire("saveFailed",n)}})}),define("tau/ui/extensions/choice/ui.extension.choice.copy.to.project",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender:last + beforeSave":function(e,t,i){this._toggleProgressIndicator(t.element,i.id,!0)},"bus afterRender:last + afterSave":function(e,t,i){this._toggleProgressIndicator(t.element,i.id,!1)},"bus afterRender:last + saveFailed":function(e,t,i){this._toggleProgressIndicator(t.element,i.data.id,!1)},_toggleProgressIndicator:function(e,t,i){var n=e.find("[data-id="+t+"]");i?(n.tauProgressIndicator(),n.tauProgressIndicator("show",{hover:!0})):n.tauProgressIndicator("hide")}})}),define("tau/ui/templates/choice/project/ui.template.choice.project.option",["tau/core/templates-factory"],function(e){var t={name:"state.project.option",engine:"jqote2",markup:['<div role="option" data-id="<%! this.id %>" data-project-name="<%! this.name %>" class="drop-down-option drop-down-option-project  i-role-option" <% if (this.description) { %> title=<%! this.description %> <% } %> >','<span class="drop-down-option__prefix">',"<% if (this.color) { %>",'<i style="background-color: <%! this.color %>;" class="tau-icon tau-icon_type_color"></i>',"<% } else { %>",'<i class="tau-icon tau-icon_type_color tau-icon_name_empty "></i>',"<% } %>","</span>",'<span class="drop-down-option__text i-role-optiontext"><%! this.name %></span>',"</div>"]};return e.register(t)}),define("tau/services/entities/service.entities.copy-to-project",["tau/core/class","tau/models/page.entity/entity.context.factory","tau/models/choice/model.choice.copy.to.project","tau/ui/extensions/choice/ui.extension.choice.copy.to.project","tau/ui/templates/choice/project/ui.template.choice.project.option","tau/core/termProcessor"],function(e,t,i,n,a,r){return e.extend({createCopyToProjectBubbleConfig:function(e){var t=e.applicationContext,s=e.subscribeToComponentEvents,o=e.navigateToEntityDetails,l=e.eventBus,u=new r(t.getTerms());
return{destroyExistingBubble:!0,onPositionConfig:this._getPositionConfig,onArrowPositionConfig:this._getArrowPositionConfig,applyBubbleClasses:!1,closeOnStoreActions:!1,className:"tau-lookup-styled-drop-down i-role-card-context-menu-copyToProject",stackName:"entity.menu.copy.to.project",showEvent:"__show__empty",hideEvent:"__hide__empty",cleanupOnHide:!0,zIndex:99999,context:t,componentsConfig:{components:[{type:"choice",filter:!0,filterPlaceholder:"Search Project",templateOption:a.name,model:i,extensions:[n],handleComponentEvents:function(e,t){e("afterSave",function(e,i){this._onCopyCompleted(l,t,u,o,i)}.bind(this)),e("saveFailed",function(e,t){l.fire("error",t)}),s&&s(e)}.bind(this)}]}}},_onCopyCompleted:function(e,t,i,n,a){t.destroyBubble();var r=i.getTerm(a.entityType),s=a.selectedProjectData,o=s?s.projectName:"",l=["<h3>Success!</h3>","<p>",r,' copied to project "',o,'"</p>'].join("");e.fire("notification",{id:"entity.copied.to.project",$node:$(l),type:"success",delay:5e3,disableAutoClose:!1}),n&&n(a)}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-copy-to-project",["Underscore","jQuery","tau/models/page.entity/entity.context.factory","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/services/entities/service.entities.copy-to-project"],function(e,t,i,n,a){return n.extend({name:"Copy to project&hellip;",className:"i-role-card-context-menu-copyToProject",itemClickCallback:function(e){var t=this.getBubbleCreator(e);i.create(t.entity,this.settings.configurator).done(this._createBubble.bind(this,t))},_createBubble:function(e,i){var n=new a,r=this.settings.configurator,s=function(e){var t=r.getComponentBusRegistry().getByName("entityViewer");t.done(function(t){t.fire("cardDataToShow.ready",e)}.bind(this))}.bind(this),o=function(t){t("choice.editable.filter.changed",function(){e.getTarget().tauBubble("adjust")})},l=n.createCopyToProjectBubbleConfig({applicationContext:i,navigateToEntityDetails:s,subscribeToComponentEvents:o,eventBus:this.settings.bus});
l.alignTo=function(){var i=t(e.cardSelector);return 0===i.length&&(i=t(e.$trigger.data("card-selector"))),i},e.createBubble(l)},getSupportedEntityTypes:function(){return["feature","userstory","bug","testcase","testplan","request","epic"]}})}),define("tau/ui/extensions/board.plus/card-context-menu/menu-timeline-action-item-base",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base"],function(e,t,i){var n=i.extend({disabled:function(e,t){var i=Boolean(t.$trigger.closest(".i-role-cellholder").data("istimeline"));return!i||this._super.apply(this,arguments)},_getPlannableTypes:function(){return["feature","userstory","task","bug","request","testplan","testplanrun","project","impediment","program","epic"]}});return n}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-plan",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-timeline-action-item-base","tau/utils/utils.date"],function(e,t,i,n){var a=i.extend({name:"Plan",className:"i-role-card-context-menu-plan",itemClickCallback:function(e){var t=e.$trigger.data("data-item"),i={itemId:t.id,position:{plannedStartDate:this._serializeDate(t.actualStartDate),plannedEndDate:this._serializeDate(t.actualEndDate)}},n=this.settings.sliceReady.slice;n.movePlannedDatesBatch({$set:{items:[i]}})},disabled:function(e,i){var n=i.$trigger.data("data-item"),a=!t.isUndefined(n.plannedStartDate)||!t.isUndefined(n.plannedEndDate);return a||this._super.apply(this,arguments)},getSupportedEntityTypes:function(){return this._getPlannableTypes()},_serializeDate:function(e){return n.format.datetime.short(n.convertToTimezone(new Date(e)))}});return a}),define("tau/ui/extensions/board.plus/card-context-menu/menu-action-item-unplan",["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-timeline-action-item-base"],function(e,t,i){var n=i.extend({name:"Unplan",className:"i-role-card-context-menu-unplan",itemClickCallback:function(e){var t={itemId:e.$trigger.data("id"),position:{plannedStartDate:null,plannedEndDate:null}},i=this.settings.sliceReady.slice;
i.movePlannedDatesBatch({$set:{items:[t]}})},disabled:function(e,t){var i=t.$trigger.data("data-item");return!i.showPlanned||this._super.apply(this,arguments)},getSupportedEntityTypes:function(){return this._getPlannableTypes()}});return n}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.card-context-menu",["jQuery","Underscore","tau/core/extension.base","tau/ui/extensions/ui.context-menu","tau/ui/extensions/board.plus/card-context-menu/menu-action-open-new-tab","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-rename","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-change-tags","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-add","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-assignments","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-delete","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-convert","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-copy-to-project","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-plan","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-unplan","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return i.extend({resetLifecycle:!0,cardMenuActionActivatedCssClass:"i-role-permanent-context-menu-action-activated","bus slice.ready + domWrapper.ready:last + viewMode.ready:last + model.zoomLevelChanged:last + cardLayoutFactory.ready:last":function(e,t,i,m,h,g){this.options={bus:this,sliceReady:t,configurator:g.configurator,domWrapper:i,viewMode:m,zoomLevelData:h,boardSettings:{boardSettings:g.boardSettings},layout:g,activationCssClass:this.cardMenuActionActivatedCssClass,propertiesToEvict:[]};var v=i.board.closest(".tau-app-main-pane"),b={context:v,handlers:{open:new a(this.getSettings()),rename:new r(this.getSettings()),changeTagsAction:new s(this.getSettings({propertiesToEvict:["tags"],activationCssClass:["i-role-permanent-context-menu-tags",this.cardMenuActionActivatedCssClass].join(" ")})),assignments:new l(this.getSettings({propertiesToEvict:["entityState","assignments","roleEfforts"],activationCssClass:["i-role-permanent-context-menu-assignments",this.cardMenuActionActivatedCssClass].join(" ")})),addAction:new o(this.getSettings()),convert:c.createMenuItem(this.getSettings()),copyToProject:new d(this.getSettings()),plan:new p(this.getSettings()),sep1:"---------",unplan:new f(this.getSettings()),del:new u(this.getSettings())},showSelectors:[".i-role-card"],skipShowSelectors:[".tau-id"]};
"timeline"!==this.options.viewMode&&(delete b.handlers.plan,delete b.handlers.unplan),this.contextMenu=new n(b)},getSettings:function(e){return t.extend(t.clone(this.options),e)},destroy:function(){this.contextMenu&&(this.contextMenu.destroy(),this.contextMenu=null)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsUpdater",["Underscore","jQuery","tau/core/extension.base","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n){var a=function(e){return"tau-ui-size-"+(n.zoomToSize(e)||"min")};return i.extend({"bus view.skeleton.built":function(){this.fire("view.cards.update.complete")},"bus view.skeleton.built:last + model.zoomLevelChanged":function(e){var t=e["view.skeleton.built"].data.element,i=t.children(),r=i.data("zoomLevel"),s=e["model.zoomLevelChanged"].data.zoomLevel;r==s||t.hasClass("tau-board-becomes-old")||(i.data("zoomLevel",s),i.data("zoomSize",n.zoomToSize(s)),t.find(".i-role-card").length<=150&&!t.find(".tau-board-timeline-view").length&&(i.removeClass(a(r)),i.addClass(a(s))))}})}),define("tau/models/board.plus/model.board.plus.refresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus boardSettings.ready:last + refresh":function(e,t){this.fire("boardSettings.ready",t)},"bus configurator.ready":function(t,i){var n=i.getAppStateStore();n.unbind({listener:this}),n.bind({fields:["acid"],listener:this,callback:e.bind(function(){e.delay(e.bind(this.fire,this,"refresh"),100)},this)})},"bus configurator.ready + destroy":function(e,t){var i=t.getAppStateStore();i.unbind({listener:this})},bindBoardSettings:function(t,i){var n=i.boardSettings;n.unbind({listener:this}),n.get({fields:["viewMode"],callback:function(t){var i=["x","y","cells","focus","user","cardSettings","timelineGlobalDateRange","timelineSettings"];"timeline"==t.viewMode&&i.push("zoomLevel"),n.bind({fields:i,listener:this,callback:e.bind(function(){this.fire("refresh")},this)})}.bind(this)})},"bus configurator.ready:last + boardSettings.ready + overview.board.ready":function(e,t,i){this.bindBoardSettings(t,i)
},"bus configurator.ready:last + boardSettings.ready + no.data.in.slice":function(e,t,i){this.bindBoardSettings(t,i)},"bus boardSettings.ready + destroy":function(e,t){var i=t.boardSettings;i.unbind({listener:this})}})}),define("tau/models/board.plus/model.board.slice.metaInfo",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus model.cells.content.loaded":function(e){var t=e.data.metaInfo||e.data.data.metaInfo||{};this.fire("model.cells.metaInfo.ready",t)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.external.api",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus slice.ready:last + external.api.get.slice":function(e,t){this.fire("external.api.slice.ready",t)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.burnDown",["jQuery","tau/components/extensions/component.extension.base","Underscore","tp/reports/tp.application.reports"],function(e,t,i,n){return t.extend({"bus configurator.ready:last + domWrapper.ready":function(t,i,a){a.board.off("click",".tau-label__burnDown"),a.board.on("click",".tau-label__burnDown",function(){var t=i.getRestStorage();e.when(t.data("burnDownVer2Filter","setting",{scope:"Public",userData:{burnDownType:e(this).data("entity-type"),plannableId:e(this).data("entity-id")}})).done(function(){n.initialize(i,{active:"burnDown"})})})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.finish.iteration",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus configurator.ready:last + domWrapper.ready":function(t,i,n){n.board.on("click",".tau-label__finish",function(t){t.stopPropagation(),t.stopImmediatePropagation();var n=e(t.currentTarget).data();i.getComponentBusRegistry().getByName("entityViewer").done(function(e){e.fire("cardDataToShow.ready",{entityId:n.entityId,entityType:"finish-"+n.entityType})})})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.teamProject.batchMove",["Underscore","jQuery","tau/core/extension.base","tau/libs/store2/store2","tau/utils/utils.serverErrorTranslator"],function(e,t,i,n,a){return i.extend({resetLifecycle:!0,init:function(e){this._super(e);
var t=e.context.configurator;this.confirmTemplate=t.getTemplateFactory().register({name:"board.plus.teamProject.batchMove.confirm",engine:"jqote2",markup:['<div class="tau-system-message-body-inner">',"<h3>Please, confirm</h3>",'<p><a class="tau-target-link i-role-actionassign"">Assign</a>  all people from <%! this.teamTerm %> to <%! this.projectTerm %>?<p>',"</div>"]}),this.successTemplate=t.getTemplateFactory().register({name:"board.plus.teamProject.batchMove.success",engine:"jqote2",markup:['<div class="tau-system-message-body-inner">',"<h3>Success!</h3>","<p><%! this.count %> new <% if (this.count !== 1){%>people<%}%><% else {%>person<%}%> from <%! this.teamTerm %> assigned to <%! this.projectTerm %><p>","</div>"]})},"bus slice.ready + configurator.ready:last + domWrapper.ready:last":function(t,i,n,a){var r=i.full?i.full.config.definition:{},s=e.chain(r.cells?r.cells.types:[]).reject(function(e){return"project"!==e.type&&"team"!==e.type}).value();if(1===s.length){var o,l=e.intersection(r.x?r.x.types:[],["project","team"]);1===l.length?o="x":(l=e.intersection(r.y?r.y.types:[],["project","team"]),1===l.length&&(o="y")),o&&1===l.length&&(i.full.on("after.moveBatch",function(e,t){this._afterBatchMove(t,o,l,n,a)}.bind(this)),i.full.on("after.moveAndPrioritizeBatch",function(e,t){this._afterBatchMove(t,o,l,n,a)}.bind(this)))}},_afterBatchMove:function(t,i,n,a,r){var s=t.command.config.$set.items[0];if("x"===i&&s.oldX!=s.x||"y"===i&&s.oldY!=s.y){var o={};o[i]=s[i];var l=r.getAxisCellByCoordinate(o),u=l.find("[data-id="+o[i]+"]"),c=0===u.length;if(c)return;var d=u.data("entity-id");if(d){var p=e.map(t.result.items,function(e){return e.items[0].dataItem.data.cardData.id}),f=a.getTemplateFactory().termProcessor,m=f.getTerm("team","project"===n[0]&&p.length>1?"names":"name"),h=f.getTerm("project","team"===n[0]&&p.length>1?"names":"name"),g=this.confirmTemplate.get().bind({},{teamTerm:m,projectTerm:h});g.on("click",".i-role-actionassign",function(e){e.preventDefault(),"project"===n[0]?this._assignAllPeopleFromTeamsToProject(a,d,p,h,m):"team"===n[0]&&this._assignAllPeopleFromTeamToProjects(a,d,p,f.getTerm("project","name"),m)
}.bind(this)),this.fire("notification",{$node:g,disableAutoClose:!0})}}},_assignAllPeopleFromTeamsToProject:function(t,i,r,s,o){var l=new n(t);l.findAll("user?select={id}&where=(ProjectMembers.Count(Project.Id="+i+") = 0 and TeamMembers.Count(Team.Id in ["+r.join(",")+"]) > 0)&take=9999").done(function(n){if(n.length>0){var a=[];a.push({projectId:i,set:{projectMembers:e.map(n,function(e){return{user:{id:e.id}}})}}),this._addProjectMembers(t,a,s,o)}else{var r=this.successTemplate.get().bind({},{count:"No",projectTerm:s,teamTerm:o});this.fire("notification",{$node:r})}}.bind(this)).fail(function(e){var t=a.translateXhrError(e);this.fire("error",t)}.bind(this))},_assignAllPeopleFromTeamToProjects:function(t,i,r,s,o){var l=new n(t);l.findAll("TeamProject?select={"+["id","Team.TeamMembers.Select(User.id) as teamMembers","Team.TeamMembers.Count() as teamMembersCount","new("+["Project.id","Project.ProjectMembers.Select(User.id) as projectMembers"].join(",")+") as project"].join(",")+"}&where=(Project.id in ["+r.join(",")+"] and Team.id="+i+")&take=9999").done(function(i){var n=[];if(e.forEach(i,function(t){var i=e.difference(t.teamMembers,t.project.projectMembers);i.length>0&&n.push({projectId:t.project.id,set:{projectMembers:e.map(i,function(e){return{user:{id:e}}})}})}),n.length>0)this._addProjectMembers(t,n,s,o);else{var a=this.successTemplate.get().bind({},{count:"No",projectTerm:s,teamTerm:o});this.fire("notification",{$node:a})}}.bind(this)).fail(function(e){var t=a.translateXhrError(e);this.fire("error",t)}.bind(this))},_addProjectMembers:function(t,i,n,a){var r=t.getStore(),s=[],o=[];e.forEach(i,function(t){o.push(function(i){r.save("project",{id:t.projectId,$set:t.set,fields:["id","name","color",{projectMembers:[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}]}]}).done({success:function(n){s=s.concat(e.difference(e.map(t.set.projectMembers,function(e){return e.user.id}),s)),i(!1,n[0].data)}})})}),e.parallel(o,function(e,t){if(t.length){var i=this.successTemplate.get().bind({},{projectTerm:n,teamTerm:a,count:s.length});
this.fire("notification",{$node:i})}}.bind(this))}})}),define("tau/ui/templates/board.plus/ui.template.boardplus.skeleton.board",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i){var n={name:"boardplus.skeleton.board",engine:"jqote2",customFunctions:{generateId:i.generateId,generateCellData:i.generateElementData,hasAdditionalInfo:function(t,i,n){return e.any(t,function(t){return n&&(t=t[n]),e.contains(i,t)})}},markup:["<% var hasX = !this.x.isNull; %>","<% var hasY = !this.y.isNull; %>",'<% var xcols = hasX ? this.x.data : [{x:"null"}]; %>','<% var yrows = hasY ? this.y.data : [{y:"null"}]; %>','<% var xColsAdditionalInfo = fn.hasAdditionalInfo(this.definition.x&&this.definition.x.types,["release","iteration","teamiteration", "assigneduser"]); %>','<% var yRowsAdditionalInfo = fn.hasAdditionalInfo(this.definition.y&&this.definition.y.types,["release","iteration","teamiteration", "assigneduser"]); %>','<% var yRowsUserAvatar = fn.hasAdditionalInfo(this.definition.y&&this.definition.y.types,["team"])&&!fn.hasAdditionalInfo(this.definition.cells&&this.definition.cells.types,["user"],"type"); %>',"<% var additionalClasses = []; %>",'<% this.cardSize && additionalClasses.push("tau-ui-size-" + this.cardSize); %>','<% !hasX && additionalClasses.push("tau-no-cols"); %>','<% !hasY && additionalClasses.push("tau-no-rows"); %>',"<% var boardId = _.uniqueId('board'); %>",'<div id="<%= boardId %>" class="tau-board-body <%=xColsAdditionalInfo?"additional-info_x":""%> <%=yRowsUserAvatar?"additional-info_avatar":""%> <%=yRowsAdditionalInfo?"additional-info_y":""%> ">',"<div class=\"i-role-board-body-holder tau-board-view tau-board-table-view tau-board-grid-view <%= additionalClasses.join(' ') %>\" ",'data-zoom-level="<%= this.zoomLevel%>" data-zoom-size="<%=this.cardSize%>"',">",'<div role="board-body" class="i-role-board-body" id="<%=_.uniqueId(\'boardBody\')%>">',"<% if (hasX && hasY) { %>",'<div class="tau-x-header">','<div class="tau-cell">','<div class="tau-collapser">','<button class="tau-h-collapser i-role-collapser"></button>',"</div>",'<div class="tau-label">',"<%= this.y.title %>"," / ","<%= this.x.title %>","</div>","</div>","</div>","<% } %>","<% if (hasY) { %>",'<div role="header" data-dimension="y" class="i-role-header tau-rows-header tau-header-<%= this.definition.y.types[0].toLowerCase() %>">',"<ul>","<% for (var i = 0; i < this.y.data.length; i++) { %>","<% var m = this.y.data[i]; %>",'<li role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>',"</div>","</li>","<% } %>","</ul>","</div>","<% } %>","<% if (hasX) { %>",'<div role="header" data-dimension="x" class="i-role-header tau-cols-header tau-header-<%= this.definition.x.types[0].toLowerCase() %>">',"<ul>","<% for (var i = 0; i < this.x.data.length; i++) { %>","<% var m = this.x.data[i]; %>",'<li role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({x:m.x}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({x:m.x}) %>>',"</div>","</li>","<% } %>","</ul>","</div>","<% } %>",'<div role="grid" class="i-role-grid tau-grid <% if (!hasX){ %>tau-grid_x_false<% } %> <% if (!hasY){ %>tau-grid_y_false<% } %>" id="<%= boardId %>_grid">','<table class="tau-grid-table" cellpadding="0" cellspacing="0">',"<tbody>","<% for (var y = 0; y < yrows.length; y++) { %>","<tr>","<% for (var x = 0; x < xcols.length; x++) { %>","<% var coords = { x: xcols[x].x, y: yrows[y].y }; %>",'<td role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %> >','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %>>',"</div>","</td>","<% } %>","</tr>","<% } %>","</tbody>","</table>","</div>","</div>","</div>","</div>"]};
return t.register(n)}),define("tau/ui/templates/board.plus/ui.template.boardplus.skeleton.list",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i){var n={name:"boardplus.skeleton.list",engine:"jqote2",customFunctions:{generateId:i.generateId,generateCellData:i.generateElementData},markup:['<% var coords = { x: "null", y: "null" }; %>',"<% var additionalClasses = []; %>",'<% this.cardSize && additionalClasses.push(" tau-ui-size-" + this.cardSize); %>',"<% var boardId = _.uniqueId('board'); %>",'<div class="tau-board-body" id="<%= boardId %>">','<div role="board-body" class="i-role-board-body tau-board-view tau-board-composite-view <%= additionalClasses.join(" ") %>" data-zoom-size="<%=this.cardSize%>" data-zoom-level="<%=this.zoomLevel%>">','<div role="grid" class="i-role-grid tau-entity-list" id="<%= boardId %>_grid">','<div role="cellholder" class="i-role-cellholder" <%= fn.generateCellData(coords) %> id="ch_<%= fn.generateId(coords) %>">','<div role="cell" class="i-role-cell" id="<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %>></div>',"</div>","</div>",'<div role="card-details-holder" class="i-card-details-holder tau-entity-data tau-page-entity"></div>',"</div>","</div>"],dependencies:[]};return t.register(n)}),define("tau/ui/templates/board.plus/ui.template.boardplus.skeleton.timeline",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i){var n={name:"boardplus.skeleton.timeline",engine:"jqote2",customFunctions:{generateId:i.generateId,generateCellData:function(e,t){var n=i.generateElementData(e);return t&&(n+=' data-istimeline="true"'),n},hasAdditionalInfo:function(t,i,n){return e.any(t,function(t){return n&&(t=t[n]),e.contains(i,t)})},getBacklogCol:function(t){return e.find(t.data,function(t){return null!=e.find(t.dynamic.items,function(e){return e.data.isBacklog})}).x},getTimelineCol:function(t){var i=this.getBacklogCol(t),n=e.find(t.data,function(e){return e.x!=i
});return n.x}},markup:["<% var hasX = !this.x.isNull; %>","<% var hasY = !this.y.isNull; %>","<% var hasAxis = this.x.data.length > 0; %>",'<% var yrows = hasY ? this.y.data : [{y:"null"}]; %>','<% var yRowsAdditionalInfo = fn.hasAdditionalInfo(this.definition.y&&this.definition.y.types,["release","iteration","teamiteration"]); %>','<% var yRowsUserAvatar = fn.hasAdditionalInfo(this.definition.y&&this.definition.y.types,["team"])&&!fn.hasAdditionalInfo(this.definition.cells&&this.definition.cells.types,["user"],"type"); %>',"<% var additionalClasses = []; %>",'<% this.cardSize && additionalClasses.push(" tau-ui-size-" + this.cardSize); %>','<% !hasX && additionalClasses.push(" tau-no-cols"); %>','<% !hasY && additionalClasses.push(" tau-no-rows"); %>',"<% var boardId = _.uniqueId('board'); %>",'<div id="<%= boardId %>" class="tau-board-body <%=yRowsUserAvatar?"additional-info_avatar":""%> <%=yRowsAdditionalInfo?"additional-info_y":""%> ">',"<div class=\"i-role-board-body-holder tau-board-view tau-board-timeline-view tau-board-grid-view<%= additionalClasses.join('') %>\" ",'data-zoom-level="<%=this.zoomLevel%>" data-zoom-size="<%=this.cardSize%>"',">",'<div role="board-body" class="i-role-board-body i-role-timeline-bubble-holder">',"<% if (hasAxis) { %>","<% if (hasX && hasY) { %>",'<div class="tau-x-header">','<div class="tau-cell">','<div class="tau-collapser">','<button class="tau-h-collapser i-role-collapser"></button>',"</div>",'<div class="tau-label">',"<%= this.y.title %>"," / ","Timeline","</div>","</div>","</div>","<% } %>","<% if (hasY) { %>",'<div role="header" data-dimension="y" class="i-role-header tau-rows-header tau-header-<%= this.definition.y.types[0].toLowerCase() %>">',"<ul>","<% for (var i = 0; i < this.y.data.length; i++) { %>","<% var m = this.y.data[i]; %>",'<li role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>',"</div>","<% if (i === this.y.data.length - 1) { %>",'<div class="footer-pillow"></div>',"<% } %>","</li>","<% } %>","</ul>","</div>","<% } %>","<% if (hasX) { %>",'<div role="header" data-dimension="x" class="i-role-header tau-cols-header tau-header">',"<ul>",'<li role="cellholder" class="i-role-cellholder tau-cellholder i-role-timeline-header-cellholder" <%= fn.generateCellData({ x: fn.getBacklogCol(this.x), isBacklog: true }) %>>','<div  class="i-role-cell tau-cell i-role-timeline-header-cell" <%= fn.generateCellData({ x: fn.getBacklogCol(this.x), isBacklog: true }) %>>','<div class="tau-collapser">','<button class="tau-v-collapser i-role-collapser"></button>',"</div>",'<div class="tau-label">Backlog</div>',"</div>","</li>",'<li style="position:absolute" role="cellholder" class="i-role-cellholder tau-cellholder i-role-timeline-header-cellholder" <%= fn.generateCellData({ x: fn.getTimelineCol(this.x), isBacklog: false }) %>>','<div class="tau-timeline-scale i-role-timeline-header-cell i-role-cell" <%= fn.generateCellData({ x:fn.getTimelineCol(this.x), isBacklog:false }) %>>','<div class="tau-scale-ruler">',"</div>","</div>","</li>","</ul>","</div>","<% } %>",'<div role="grid" class="i-role-grid tau-timeline-grid <% if (!hasX){ %>tau-grid_x_false<% } %> <% if (!hasY){ %>tau-grid_y_false<% } %>" id="<%= boardId %>_grid">','<div class="tau-backlog i-role-timeline-column i-role-timeline-column-dynamic-width">','<div class="tau-backlog-body">',"<ul>","<% for (var y = 0; y < yrows.length; y++) { %>","<% var coords = { x: fn.getBacklogCol(this.x), y: yrows[y].y }; %>",'<li role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords, false) %> >','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords, false) %> >',"</div>","<% if (y ===  yrows.length - 1) { %>",'<div class="footer-pillow"></div>',"<% } %>","</li>","<% } %>","</ul>","</div>","</div>",'<div class="tau-timeline i-role-timeline-column">','<div class="tau-timeline-canvas">','<div class="tau-timeline-flow">',"<% for (var y = 0; y < yrows.length; y++) { %>","<% var coords = { x: fn.getTimelineCol(this.x), y: yrows[y].y }; %>",'<div role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords, true) %> >','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords, true) %> >',"</div>","<% if (y === yrows.length - 1) { %>",'<div class="footer-pillow"></div>',"<% } %>","</div>","<% } %>","</div>","</div>","</div>","</div>",'<div class="_tc-timeline-navigator"></div>',"<% } %>","</div>","</div>","</div>"],dependencies:[]};
return t.register(n)}),define("tau/ui/templates/board.plus/ui.template.boardplus.skeleton",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/templates/board.plus/ui.template.boardplus.skeleton.board","tau/ui/templates/board.plus/ui.template.boardplus.skeleton.list","tau/components/board.new.list/templates/template.new.list","tau/ui/templates/board.plus/ui.template.boardplus.skeleton.timeline"],function(e,t,i){var n={name:"boardplus.skeleton",engine:"jqote2",customFunctions:{generateId:i.generateId,generateCellData:i.generateElementData},markup:["<% var viewMode = this.viewMode; %>",'<%= fn.sub("boardplus.skeleton." + viewMode, this) %>'],dependencies:[]};return t.register(n)}),define("tau/ui/templates/board.plus/ui.template.boardplus.card.assignedUsers",["tau/core/templates-factory","tau/utils/utils.convertUserName"],function(e,t){var i={name:"boardplus.card.assignedUsers",engine:"jqote2",customFunctions:{name:function(e){return t.getFullName(e)},isNotCurrentStateResponsible:function(e,t){return!_.contains(t,e.id)}},markup:["<%_.forEach(this.items,function(item){%>",'<span class="tau-avatar tau-avatar_<%= item.id %> <%if(this.viewTrigger){%>i-role-cellaxis-viewtrigger<%}%> ','<%if(fn.isNotCurrentStateResponsible(item, this.currentStateResponsiblePersons)){%>tau-avatar-not-currentResponsible<%}%>" data-entity-id="<%= item.id %>" data-entity-type="user">',"<% var name = fn.name(item); %>",'<img  alt="<%! name %>" title="<%! name %>" src="<%= item.avatarUri%>24" />',"</span>","<%},this);%>","<%if(this.count>0) { %>",'<span class="count-users">+<%=this.count%></span>',"<%}%>"]};return e.register(i)}),define("tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.item",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/utils/utils.date","tau/utils/utils.translation","tau/ui/templates/board.plus/ui.template.boardplus.card.assignedUsers"],function(e,t,i,n,a){var r={name:"boardplus.cell.axis.item",engine:"jqote2",customFunctions:{generateCardData:i.generateElementData,generateFinishButtonOnDemand:function(t){var i="",n=["iteration","teamiteration"];
return t&&t.canBeFinished&&e.contains(n,t.type.toLocaleLowerCase())&&(i=[' <span class="i-role-finish-iteration tau-label__finish tau-linkentity__inner" data-entity-id="',t.id,'" data-entity-type="',t.type,'">Finish</span>'].join("")),i},processDates:function(e,t,i,r){function s(e,t){e=n.parse(e),t=n.parse(t);var i=Math.floor((t-e)/36e5),r=Math.ceil(i/24);return r?r+" "+a.pluralize("day|days",r)+" left":i+" "+a.pluralize("hour|hours",i)+" left"}var o=n.convertToTimezone(e),l=n.convertToTimezone(t),u=i?"tau-label__date_current":"",c=i?' <span class="time-left">'+s(new Date,l)+"</span>":"",d=o.getYear()==l.getYear()?"d-MMM":n.getFormatData().date.short;return'<span class="tau-label tau-label__date '+u+'">'+n.formatAs(o,d)+" &mdash; "+n.formatAs(l,d)+c+this.generateFinishButtonOnDemand(r)+"</span>"},velocity:function(e){var t=e.units||"",i=e.effortSum||0;i=Math.round(i);var n=Math.round(e.velocity),a="tau-label__velocity_perfect",r="Perfect match!",s=n-i;if(0!==n&&0!==s){var o=100*Math.abs(s)/n;s>0&&(r="left."),0>s&&(r="overhead."),5>o?a="tau-label__velocity_warning":0>s&&(a="tau-label__velocity_overhead")}else 0!==s&&(s>0&&(r="left."),0>s&&(r="overhead."),0>s&&(a="tau-label__velocity_overhead"));var l="";return!e.id||"Iteration"!=e.type&&"TeamIteration"!=e.type||(l=this.burnDownIcon(e)),s=Math.abs(s),s=s?s+" "+t+" ":"",'<span class="tau-label tau-label__text tau-label__velocity">'+l+'<span class="tau-label_mark">'+i+'</span> of <span class="tau-label_mark">'+n+" "+t+'</span> assigned. <span class="'+a+'">'+s+r+"</span></span>"},effort:function(e){var t="",i=" done.",n="";(!e.effortCompleted&&e.isCurrent||e.isPrevious||e.effortCompleted)&&(n='<span class="tau-label_mark">'+e.effortCompleted+"</span> of "),e.isCurrent&&(t="tau-label__effort_current"),e.isNext&&(t="tau-label__effort_next",e.effortCompleted||(i=" assigned.")),e.isPrevious&&(t="tau-label__effort_previous",e.effortCompleted==e.effortTotal&&(n=""));var a="";return"Release"==e.type&&e.id&&(a=this.burnDownIcon(e)),'<span class="tau-label tau-label__effort '+t+'">'+a+n+'<span class="tau-label_mark">'+e.effortTotal+" "+e.units+"</span>"+i+"</span>"
},burnDownIcon:function(e){return'<span class="tau-icon tau-icon_type_svg tau-icon_name_burn-down tau-label__burnDown" data-entity-id="'+e.id+'" data-entity-type="'+e.type.toLowerCase()+'"></span>'},processTags:function(t){return e.compact(e.asString(t).split(","))},capacityHours:function(t){if(!e.isUndefined(t.assignedHours)){var i='<span class="tau-label_mark">'+t.assignedHours;if(i+=e.isUndefined(t.capacityHours)?"h</span>":'</span> of <span class="tau-label_mark">'+t.capacityHours+"h</span>",i+=" assigned.",!e.isUndefined(t.availableHours)){var n=t.availableHours>0?"tau-label__velocity_perfect":"tau-label__velocity_overhead",a=t.availableHours>0?"left":"overhead",r=Math.abs(t.availableHours)+"h "+a;i+=' <span class="'+n+'">'+r+".</span>"}return i}return""},capacityPoints:function(t){if(!e.isUndefined(t.assignedPoints)){var i='<span class="tau-label_mark">'+t.assignedPoints+"pt</span>";return i+=e.isUndefined(t.assignedHours)?" assigned.":" and "}return""},getTimePeriodEntitiesText:function(t){var i=e.map(t.timePeriodEntities,function(e){return e.name}).join(", ");return'<span title="'+i+'">'+i+"</span>"},getCapacityHint:function(t){if(!e.isUndefined(t.assignedHours)&&!e.isUndefined(t.availableHours)&&!e.isUndefined(t.capacityHours)){var i=t.availableHours>0?"h of work can be assigned.":"h over capacity.";return t.assignedHours+"h of unfinished work assigned. "+t.capacityHours+"h total capacity until "+this.term(t.timePeriodEntities[0].entityType.name,"name")+" ends. "+Math.abs(t.availableHours)+i}return""}},markup:['<% var axis = this.itemData.hasOwnProperty("effort") ? "Y" : "X"; %>','<% if (this.entity.type == "user"){ %>','<div class="i-role-axis-item">','<div class="tau-axiscell__item tau-label i-role-focustrigger">',"<% if (this.isSupportView){ %>",'<span <% if (this.isSupportView){ %> class="i-role-cellaxis-viewtrigger" <% } %> <%= fn.generateCardData({ id: this.id, "entity-id": this.entity.id, "entity-type": this.entity.type}) %>>',"<% if (this.itemData.avatarUri){ %>",'<span class="tau-avatar tau-avatar_<%= this.entity.id %>" >','<img src="<%= this.itemData.avatarUri %>24" />',"</span>","<% } %>",'<span class="tau-label__text tau-name i-role-name"><%! this.name %></span>',"</span>","<% } else { %>",'<span class="i-role-name tau-name"><%! this.name %></span>',"<% } %>","</div>","<% if (this.itemData.capacity){ %>",'<span class="tau-label tau-label__user">','<span class="tau-label_mark"><%= this.itemData.roleName %></span>'," / <%= fn.getTimePeriodEntitiesText(this.itemData.capacity) %>","</span>",'<span class="tau-label tau-label__text tau-label__velocity  tau-label__user__velocity" title="<%= fn.getCapacityHint(this.itemData.capacity, axis) %>">','<span class="tau-label_mark"></span>',"<%= fn.capacityPoints(this.itemData.capacity) %>","<%= fn.capacityHours(this.itemData.capacity) %>","</span>","<% } %>","</div>",'<% } else if (axis == "Y" && (this.entity.type == "userstory" || this.entity.type == "feature") && this.itemData.id){ %>','<div class="i-role-axis-item tau-axiscell__item tau-label i-role-focustrigger">',"<% var item = this.itemData; %>",'<% if (item.hasOwnProperty("id")) { %>','<span class="<% if (this.isSupportView){ %>i-role-cellaxis-viewtrigger <% } %>tau-entity-icon tau-entity-icon--<%= this.entity.type %>" <%= fn.generateCardData({ id: this.id, "entity-id": this.entity.id, "entity-type": this.entity.type}) %>>',"<%= item.id %>","</span>","<% } %>",'<div class="tau-state"><%! item.entityState.name %></div>','<div class="<% if (this.isSupportView){ %>i-role-cellaxis-viewtrigger <% } %> tau-name  i-role-name"  <%= fn.generateCardData({ id: this.id, "entity-id": this.entity.id, "entity-type": this.entity.type}) %>><%! this.name %></div>',"<% if (item.project && item.project.abbreviation) {%>",'<div <% if (item.project.color){ %> style="background-color: <%= item.project.color %>;"<% } %> ','class="tau-project-abbr" title="<%! item.project.name %>"',">","<%! item.project.abbreviation %>","</div>","<% } %>","<% var usersCount = item.assignedUsers.length - 2;%>",'<%if (item.hasOwnProperty("assignedUsers")) {%>','<div class="tau-people">','<%= fn.sub("boardplus.card.assignedUsers",{count:usersCount,items:item.assignedUsers.slice(0,2),viewTrigger:true}) %>',"</div>","<% } %>",'<% if (item.hasOwnProperty("effort")){ %>','<div class="tau-effort">',"<%= item.effort %>",'<%= item.units || "pt" %>',"</div>","<% } %>","</div>",'<% } else if (this.entity.type === "entitystate" || this.entity.type === "priority") { %>','<div class="i-role-axis-item">','<div class="tau-axiscell__item tau-label i-role-focustrigger">',"<% if (this.isSupportView){ %>",'<span class="i-role-cellaxis-viewtrigger" <%= fn.generateCardData({ id: this.id, "entity-id": this.entity.id, "entity-type": this.entity.type}) %> >','<% if (this.entity.type == "team"){ %>',"<span>","<% if (this.itemData.icon){ %>","<i class=\"tau-icon tau-icon_type_svg tau-icon_name_<%= this.itemData.icon || '' %>\"></i>","<% } else { %>",'<i class="tau-icon tau-icon_type_svg tau-icon_name_trihead"></i>',"<% } %>","</span>",'<% } else if (this.entity.type == "project") { %>',"<% if (this.itemData.color){ %>",'<i class="tau-icon tau-icon_type_colortau-icon_type_color--axis" style="background-color: <%= this.itemData.color %>;"></i>',"<%} else {%>",'<i class="tau-icon tau-icon_type_color tau-icon_type_color--axis tau-icon_name_empty"></i>',"<%}%>","<% } else { %>",'<span class="tau-entity-icon tau-entity-icon--<%= this.entity.type %>" >',"<%= this.entity.id %>","</span>","<% } %>",'<span class="tau-label__text  i-role-name"><%! this.name %><%if(this.itemData.isCurrent){%> <span class="tau-label__text_current">(Current)</span><%}%></span></span>',"<% } else { %>",'<span class="i-role-name" <%= fn.generateCardData({ids: this.itemData.ids}) %>><%! this.name %><%if(this.itemData.isCurrent){%> <span class="tau-label__text_current">(Current)</span><%}%></span>',"<% } %>","</div>","<% } else { %>",'<div class="i-role-axis-item  tau-cell__wrap  <% if (this.entity.type == "testplan"){ %> tau-name-multiline <% } %> ">','<div class="tau-axiscell__item tau-label i-role-focustrigger  <% if (this.entity.type == "testplan"){ %> tau-name-multiline <% } %> ">',"<% if (this.isSupportView){ %>",'<span class="i-role-cellaxis-viewtrigger <% if (this.entity.type == "testplan"){ %> tau-name-multiline <% } %> " <%= fn.generateCardData({ id: this.id, "entity-id": this.entity.id, "entity-type": this.entity.type}) %> >','<% if (this.entity.type == "team"){ %>',"<span>","<% if (this.itemData.icon){ %>","<i class=\"tau-icon tau-icon_type_svg tau-icon_name_<%= this.itemData.icon || '' %>\"></i>","<% } else { %>",'<i class="tau-icon tau-icon_type_svg tau-icon_name_trihead"></i>',"<% } %>","</span>",'<% } else if (this.entity.type == "project") { %>',"<% if (this.itemData.color){ %>",'<i class="tau-icon tau-icon_type_color tau-icon_type_color--axis" style="background-color: <%= this.itemData.color %>;"></i>',"<%} else {%>",'<i class="tau-icon tau-icon_type_color tau-icon_type_color--axis tau-icon_name_empty"></i>',"<%}%>","<% } else { %>",'<span class="tau-entity-icon tau-entity-icon--<%= this.entity.type %>" >',"<%= this.entity.id %>","</span>","<% } %>",'<span class="tau-label__text  i-role-name"><%! this.name %><%if(this.itemData.isCurrent){%> <span class="tau-label__text_current">(Current)</span><%}%></span></span>',"<% } else { %>",'<span class="i-role-name"><%! this.name %><%if(this.itemData.isCurrent){%> <span class="tau-label__text_current">(Current)</span><%}%></span>',"<% } %>","</div>",'<% if (this.entity.type == "team"){ %>','<div class="tau-team-members">',"<% var users = this.itemData.users || []; _.forEach(users, function(user,index,users){ %>","<%if(index < 7){%>",'<span class="tau-avatar i-role-cellaxis-viewtrigger" <%= fn.generateCardData({ id: user.id, "entity-id": user.id, "entity-type": "user"}) %> ><img title="<%= user.name %>" src="<%= user.avatarUri %>24" /></span>',"<%}%>","<%if(index == 7){%>",'<span class="count-users">+ <%=users.length - index%></span>',"<%}%>","<% });  %>","</div>","<% } %>","<% if (this.itemData.startDate && this.itemData.endDate){ %>","<%= fn.processDates(this.itemData.startDate, this.itemData.endDate, this.itemData.isCurrent, {id:this.entity.id, type:this.entity.type, canBeFinished:this.itemData.canBeFinished})%>","<% } %>","<% if (this.itemData.velocity !== undefined){%>","<%= fn.velocity(this.itemData)%>","<%}%>","<% if (this.itemData.effortCompleted !== undefined && this.itemData.effortTotal !== undefined){%>","<%= fn.effort(this.itemData)%>","<%}%>","</div>","<% } %>"],dependencies:[]};
return t.register(r)}),define("tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.skeleton",["tau/core/templates-factory","tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.item"],function(e){var t={name:"boardplus.cell.axis.skeleton",engine:"jqote2",markup:["<% if (this.dynamic) { %>",'<%= fn.sub("boardplus.cell.axis.item", this) %>','<div class="i-role-axis-mark-collapser tau-axiscell__item tau-collapser">','<button role="collapser" class="i-role-collapser tau-v-collapser"></button>',"</div>",'<label class="i-role-axis-mark-selector tau-axiscell__item tau-selector">','<input type="checkbox" name="focus" />',"</label>","<% } %>"]};return e.register(t)}),define("tau/ui/templates/board.plus/customized/ui.template.boardplus.cell.grid.skeleton.customized",["tau/core/templates-factory","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized"],function(e){var t={name:"boardplus.cell.grid.skeleton.customized",engine:"jqote2",markup:[["<% for(var itemIndex = 0; itemIndex < this.dynamic.items.length; itemIndex++) { %>","<% var dataItem = this.dynamic.items[itemIndex]; %>","<% var type = dataItem.type.toLowerCase(); %>",'<%= fn.sub("board.plus.default.card.customized", {dataItem:dataItem, layout:this.getLayout(type), configurator: this.configurator}) %>',"<% } %>"].join("")]};return e.register(t)}),define("tau/components/component.board.plus.base",["Underscore","tau/core/bus.profiler","tau/components/component.creator","tau/ui/extensions/board.plus/ui.extension.board.plus.view","tau/ui/extensions/board.plus/ui.extension.board.plus.controller","tau/ui/extensions/board.plus/ui.extension.board.plus.templateBinder","tau/ui/extensions/board.plus/ui.extension.board.plus.card-context-menu","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsUpdater","tau/models/board.plus/model.board.plus.refresher","tau/models/board.plus/model.board.slice.metaInfo","tau/ui/extensions/board.plus/ui.extension.board.plus.errors","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/board.plus/ui.extension.board.plus.external.api","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/board.plus/ui.extension.board.plus.burnDown","tau/ui/extensions/board.plus/ui.extension.board.plus.finish.iteration","tau/ui/extensions/board.plus/ui.extension.board.plus.teamProject.batchMove","tau/ui/templates/board.plus/ui.template.boardplus.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.skeleton","tau/ui/templates/board.plus/customized/ui.template.boardplus.cell.grid.skeleton.customized"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v){return{create:function(e,t){var b={ViewType:e.ViewType||n,"queue.bus":!0,extensions:e.extensions.concat([e.controller||a,r,u,c,d,o,l,p,f,m,h,s,g,v])};
t["queue.bus"]=!0;var y=i.create(b,t);return y}}}),define("tau/components/board.new.list/destroyable",["Underscore","tau/core/class"],function(e,t){return t.extend({_addChildDestroyable:function(e){this._childDestroyables||(this._childDestroyables=[]),this._childDestroyables.push(e)},destroy:function(){e.invoke(this._childDestroyables,"destroy"),this._childDestroyables=[]}})}),define("tau/core/controller.base",["Underscore","tau/components/board.new.list/destroyable"],function(e,t){return t.extend({})}),define("tau/components/board.new.list/controllers/controller.new.list.paging",["Underscore","tau/core/controller.base"],function(e,t){return t.extend({init:function(t,i){this._treeModel=i,this._treeModel.pagingUpdated.add(function(){t.update(i)}),this._treeModel.pagingLoadingStarted.add(function(){t.showProgress()}),this._pagingView=t;var n=function(t,n){taus.track({action:n+" page",cardTypes:e.map(i.hierarchyMetaInfo.cardTypes,function(e){return e.typeName}),pageSize:i.pagingModel.pageSize,pagingType:t,skip:i.pagingModel.getSkip(),cardCount:i.nodes.items.length,tags:["newlist"]})};this._pagingView.nextPageClicked.add(function(e){i.goToNextPage().then(function(){n(e.pagingType,e.direction)})}),this._pagingView.prevPageClicked.add(function(e){i.goToPreviousPage().then(function(){n(e.pagingType,e.direction)})}),this._pagingView.lastPageClicked&&this._pagingView.lastPageClicked.add(function(e){i.goToLastPage().then(function(){n(e.pagingType,e.direction)})}),this._pagingView.firstPageClicked&&this._pagingView.firstPageClicked.add(function(e){i.goToFirstPage().then(function(){n(e.pagingType,e.direction)})}),this._pagingView.pageSizeChanged.add(e.bind(this._pageSizeChangedHandler,this))},startLifeCycle:function(){this._pagingView.render(this._treeModel)},_pageSizeChangedHandler:function(e){this._treeModel.setPageSize(e),taus.track({action:"page size",pageSize:e,tags:["newlist"]})}})}),define("tau/components/board.new.list/controllers/controller.new.list.editor",["Underscore","jQuery","tau/core/controller.base"],function(e,t,i){var n=i.extend({init:function(e,t,i,n){this._view=e,this._treeNodeModel=t,this.configurator=n,this._editorComponentBuilder=i,this._initSubscriptions()
},startLifeCycle:function(){this._view.startListen()},_initSubscriptions:function(){this._view.unitClicked.add(this._onUnitClicked.bind(this))},_onUnitClicked:function(t){var i=this.configurator.getUnitsRegistry().getUnitById(t.unitId),n=this._treeNodeModel.hierarchy.findChildByCardId(t.cardId).card,a=i&&n&&i.editorConfig;if(a){var r=null;r=e.delay(function(){this._view.toggleUnitBusyIndicator(t.$unit,!0)}.bind(this),200),this._createEditorComponent(n,i,t.$card,t.$unit).then(function(){clearTimeout(r),this._view.toggleUnitBusyIndicator(t.$unit,!1)}.bind(this)),taus.track({action:"open editor",unit:i.name,cardType:n.type,tags:["newlist"]})}},_createEditorComponent:function(e,t,i,n){return this._editorComponentBuilder.createEditorView(e,t,i,n).then(this._initEditorViewSubscriptions.bind(this,e,t))},_initEditorViewSubscriptions:function(e,t,i){i.toggleFocus(!0),i.unitEditorUpdating.add(function(){i.toggleBusyIndicator(!0)}),i.unitEditorUpdated.add(function(e){this._treeNodeModel.loadCard(e.cardId,e.cardType).always(function(){i.toggleBusyIndicator(!1)})}.bind(this)),i.unitEditFinished.add(function(){i.toggleFocus(!1)}.bind(this))}});return n}),define("tau/components/board.new.list/controllers/controller.new.list.tree.node.collection",["jQuery","Underscore","tau/core/controller.base","tau/components/board.new.list/controllers/controller.new.list.paging","tau/components/board.new.list/controllers/controller.new.list.editor"],function(e,t,i,n,a){var r=i.extend({init:function(e,t,i,n,a,r,s,o){this._model=e,this._treeModel=i,this._view=t,this._eventAggregator=n,this._editorComponentBuilder=a,this._quickAddComponentBuilder=r,this._configurator=s,this._modelSettings=o,this._initSubscriptions(this._model,this._view)},_initSubscriptions:function(e,i){e.applyAndObserve(function(e){e.nodeCollectionCreated.add(function(){this._addChildCollectionController(e)}.bind(this)),e.modelReset.add(function(){this._view.removeChildTreeNodeView(e.card.id),this._view.updateHeaderExpansionState()
}.bind(this))}.bind(this)),e.duplicateNodesRemoved.add(function(e){this._view.removeCardsSilent(e)}.bind(this)),e.nodesAdded.add(function(e){i.appendNodes(e)}),e.cardUpdated.add(function(e){t.each(e.properties,function(t,n){i.updateCardUnit(e.card,n,t)}),i.updateCardFinalState(e.card.id,e.card.entity.isFinal||e.card.entity.isInPast)}),e.cardDeleted.add(function(e){i.removeCard(e.card),this._eventAggregator.cardRemoved.fire(e)}.bind(this)),e.cardMoved.add(function(e){i.moveCard(e.card,e.index)}),e.cardAdded.add(function(t){i.addCard(e,t.card,t.index)}),e.cardAdded.once(function(){i.calculateColumnWidths()}),i.expansionStateToggled.add(this._onExpansionStateToggled.bind(this)),i.collapseAllClicked.add(this._onCollapseAllClicked.bind(this)),i.openCardDetailsClicked.add(this._onOpenCardDetailsClicked.bind(this))},startLifeCycle:function(){return this._view.renderTree().then(this._onNodeExpanded.bind(this,{node:this._treeModel})).then(this._initChildControllers.bind(this)).then(function(){var e=new n(this._view.createPagingView(),this._treeModel,this._configurator);e.startLifeCycle();var t=new a(this._view.createEditorView(),this._treeModel,this._editorComponentBuilder,this._configurator);t.startLifeCycle(),this._view.createCountsView(this._treeModel.countsModel),this._view.createQuickAddView(this._treeModel.quickAddModel),this._view.quickAddView.showQuickAddClicked.add(this._onShowQuickAddClicked.bind(this))}.bind(this))},_initChildControllers:function(){var i=t.reduce(this._model.items,function(e,t){return t.getIsExpanded()&&e.push(this._addChildCollectionController(t)),e},[],this);return e.when.all(i)},_onOpenCardDetailsClicked:function(e){this._eventAggregator.entityDetailsViewRequested.fire(e)},_onShowQuickAddClicked:function(e){this._quickAddComponentBuilder.createQuickAddComponent(e.target,this._treeModel)},_onExpansionStateToggled:function(e){var t,i,n=this._treeModel.hierarchy.findChildByCardId(e);n.getIsExpanded()?(t=this._collapseNode,i="collapse"):(t=this._expandNode,i="expand"),t.call(this,n),taus.track({action:i,cardType:n.card.type,tags:["newlist"]})
},_expandNode:function(e){var i=function(t){t.isLoading||e.loadingStatusChanged.remove(i),this._view.toggleNodeExpansionProgress(e.card.id,t.isLoading)}.bind(this);e.loadingStatusChanged.add(i);var n=t.uniqueId("statistics_newlist_expand");taus.start("statistics_newlist_expand",{},n),this._calculateColumnWidthsWhenNodeIsExpanded(e),e.expand().then(function(){taus.stop(n,{cardType:e.card.type,cardsCount:e.getCardsCount(),levelType:e.parent.hierarchyMetaInfo.levelType})}.bind(this)).then(function(){this._eventAggregator.expansionStateChanged.fire(this._treeModel.getRoot().getExpansionState(!1))}.bind(this))},_calculateColumnWidthsWhenNodeIsExpanded:function(e){e.nodeCollectionCreated.once(function(){var i=t.range(e.level+1,e.hierarchyMetaInfo.totalLevelCount);this._view.skeleton.calculateColumnWidthsForMultipleLevels(i,!0)},this)},_onCollapseAllClicked:function(){var e=t.filter(this._model.items,function(e){return e.getIsExpanded()});t.each(e,this._collapseNode,this),taus.track({action:"collapseAll",tags:["newlist"]})},_collapseNode:function(e){this.removeNode(e),this._modelSettings.listSettings.apiService.treeViewCollapse({$set:{path:e.hierarchy.getPath()}}),this._eventAggregator.expansionStateChanged.fire(this._treeModel.getRoot().getExpansionState(!1))},removeNode:function(e){e.collapse(),e.pagingModel.reset(),this._view.removeChildTreeNodeView(e.card.id),this._view.updateHeaderExpansionState()},_onNodeExpanded:function(e){e.node.card&&this._view.parentView.setExpandedStateForCardId(e.node.card.id),this._view.parentView&&this._view.parentView.updateHeaderExpansionState()},_addChildCollectionController:function(e){var t=new r(e.nodes,this._view.createTreeView(e.nodes),e,this._eventAggregator,this._editorComponentBuilder,this._quickAddComponentBuilder,this._configurator,this._modelSettings);return t.startLifeCycle()}});return r}),define("tau/components/board.new.list/controllers/controller.new.list.tree.root",["Underscore","tau/core/controller.base","./controller.new.list.tree.node.collection"],function(e,t,i){return t.extend({init:function(e,t,i,n,a,r,s){this._model=e,this._viewBuilder=t,this._eventAggregator=i,this._configurator=r,this._editorComponentBuilder=n,this._quickAddComponentBuilder=a,this._modelSettings=s,this._model.nodeCollectionCreated.add(this._whenLoaded.bind(this)),this._model.loadingStatusChanged.add(this._onLoadingStatusChanged.bind(this))
},startLifeCycle:function(){this._model.loadTreeData().then(function(){this._eventAggregator.expansionStateChanged.fire(this._model.getRoot().getExpansionState(!1)),taus.stop("statistics_newlist_cardLoad",{"@":"--save-statistics_newlist_cardLoad",cardsCount:this._model.getCardsCount()}),taus.track("statistics",{"@":["--restore-statistics_newlist_cardLoad","--cast-statistics_newlist_cardLoad-to-statistics","--exclude-board-context"]})}.bind(this))},_whenLoaded:function(){var e=taus.start("statistics_newlist_initialRender",{});this._destroyTreeView();var t=this._model.nodes;this._rootTreeView=this._viewBuilder.createTreeView(t);var n=new i(t,this._rootTreeView,this._model,this._eventAggregator,this._editorComponentBuilder,this._quickAddComponentBuilder,this._configurator,this._modelSettings);this._addChildDestroyable(n),n.startLifeCycle().then(this._whenInitialListIsRendered.bind(this)).then(e.stop.bind(e)),this._eventAggregator.cellModelLoaded.fire(t)},_whenInitialListIsRendered:function(){this._viewBuilder.appendRoot(),this._viewBuilder.updateEmptyListMessage();var t=this._rootTreeView.$treeContainer;e.defer(function(){this._eventAggregator.treeRendered.fire(t)}.bind(this))},_onLoadingStatusChanged:function(e){this._viewBuilder.toggleProgress(e.isLoading)},destroy:function(){this._destroyTreeView(),this._super()},_destroyTreeView:function(){this._rootTreeView&&(this._rootTreeView.destroy(),this._rootTreeView=null)}})}),define("tau/models/board.plus/augmenter/board.plus.augmenter",["Underscore","tau/core/class"],function(e,t){var i="id,name,entityType.name as type",n=[i,"tags,effort"].join(","),a="entityState.IsFinal as isFinalState",r="it.isInPast() as isInPast",s="assignedUser.Select({id,firstName,lastName,email,avatarUri}) as assignedUsers",o="units",l="tasks.Count() as allTasks,tasks.Count(entityState.IsFinal != true) as openTasks",u="bugs.Count() as allBugs, bugs.Count(entityState.IsFinal != true) as openBugs",c="userStories.Count() as userStoriesCount, userStories.Count(entityState.IsFinal != true) as openUserStoriesCount",d="features.Count() as featuresCount, features.Count(entityState.IsFinal != true) as openFeaturesCount",p='firstName+ " " +LastName as name',f="login as login",m="role.Name as roleName",h="requesters.Count() as votes",g="TeamMembers.Count() as teamCount",v="comments.Count() as commentsCount",b="CurrentAllocation",y="Assignables.Count(entityState.IsFinal != true) as relatedEntitiesCount",_="lastCommentedUser",x="severity.name as severityName",w="{Project.id, Project.name, Project.abbreviation, Project.color} as Project",C="{Release.name} as release",S="{Team.id, Team.name, Team.icon, Team.abbreviation} as Team",T="CurrentStateResponsiblePersons as CurrentStateResponsiblePersons",k="{slaveRelations.ActiveSlaveRelationsCount() as activeSlaveCount, masterRelations.ActiveMasterRelationsCount() as activeMasterCount} as relations",I={user:{type:"user",data:["id",'"user" as type',"modifyDate","avatarUri",p,f,m,g,b,y]},userstory:{type:"userstory",data:[o,n,s,l,u,a,w,S,T],lazy:["id",k]},bug:{type:"bug",data:[o,n,s,x,a,w,S,T],lazy:["id",k]},feature:{type:"feature",data:[o,n,s,c,a,w,S,T],lazy:["id",k]},request:{type:"request",data:[o,n,s,h,"createDate",v,_,a,w,S,T],lazy:["id",k]},task:{type:"task",data:[o,n,s,a,w,S,T],lazy:["id",k]},impediment:{type:"impediment",data:[i,"{responsible.avatarUri as avatarURI,responsible.lastName,responsible.firstName,responsible.id} as responsible","createDate","priority.name as priorityName",a,w],lazy:["id",k]},testcase:{type:"testcase",data:[i,"tags","lastStatus","lastRunDate",w],lazy:["id",k]},testplan:{type:"testplan",data:[i,"tags","testCases.Count as testCaseCount","testPlanRuns.Count as testRunCount","LastCompletedTestPlanRun.Id as lastRunId","LastCompletedTestPlanRun.PassedCount as lastRunPassedCount","LastCompletedTestPlanRun.FailedCount as lastRunFailedCount","LastCompletedTestPlanRun.EndDate as lastRunEndDate",w],lazy:["id",k]},testplanrun:{type:"testplanrun",data:[i,"tags",w,S,s,a,T,"build","notRunCount","failedCount","passedCount"],lazy:["id",k]},project:{type:"project",data:["id","name","entityType.name AS type","color","tags","teamProjects.Count() AS teamProjectsCount","teamProjects.Select({Team.id, Team.name, Team.icon}) AS Teams"],lazy:["id",k,"{ userStories.Sparkline(16) AS userStories, bugs.Sparkline(16) AS bugs } as sparklines"]},release:{type:"release",data:[i,o,u,c,d,w,r,"startDate","endDate","isCurrent","EffortCompleted() as effortCompleted","EffortTotal() as effortTotal","units"],lazy:["id",k]},iteration:{type:"iteration",data:[i,"id","name",u,c,w,C,r,"startDate","endDate","isCurrent","canBeFinished","entityType.name AS type","EffortCompleted() as effortCompleted","EffortTotal() as effortTotal","units"]},teamiteration:{type:"teamiteration",data:[i,"id","name",u,c,S,r,"startDate","endDate","isCurrent","canBeFinished","entityType.name AS type","EffortCompleted() as effortCompleted","EffortTotal() as effortTotal","units"]},team:{type:"team",data:["id","name","entityType.name AS type","icon","tags","teamMembers.Count() AS teamMembersCount",'teamMembers.Select({User.id, User.firstName+ " " + User.lastName as name, User.avatarUri}) AS Members'],lazy:["id",k,'{ Assignables.Where(EntityType.name == "UserStory").Sparkline(16) AS userStories, Assignables.Where(EntityType.name == "Bug").Sparkline(16) AS bugs } as sparklines']},build:{type:"build",data:[i,"tags",w,"buildDate"],lazy:["id",k]},projectmember:{type:"projectmember",data:["id",'"projectmember" as type',w,"membershipStartDate as startDate","membershipEndDate as endDate","{User.fullName, User.avatarUri} as user","allocation"]}},D=["id","name","isCurrent","EffortCompleted() as effortCompleted","EffortTotal() as effortTotal","isNext","isPrevious","startDate","endDate","units","entityType.name AS type"],P=["id","name","isCurrent","canBeFinished","startDate","EffortSum() as effortSum","velocity","endDate","units","entityType.name AS type"],E=["id","firstName",'"user" as type',"lastName","email","avatarUri","isActive","it.UnknownCapacity() as capacity","role.name as roleName"],R=["id","name","entityType.name AS type"],A=e.without(P,"units"),F={team:{type:"team",data:["id","name","entityType.name AS type","icon"]},release:{type:"release",data:D},iteration:{type:"iteration",data:P},teamiteration:{type:"teamiteration",data:A},assigneduser:{type:"assigneduser",data:E},project:{type:"release",data:["id","name","entityType.name AS type","color"]},inboundrelations:{type:"inboundrelations",data:R},outboundrelations:{type:"outboundrelations",data:R}},M={team:{type:"team",data:["id","name","entityType.name AS type","icon","teamMembers.Select({User.id, User.firstName, User.lastName, User.email, User.avatarUri}) AS users"]},userstory:{type:"userstory",data:["id","name","entityType.name AS type","entityType","{entityState.name} as entityState","effort","units",s,w]},feature:{type:"feature",data:["id","name","entityType.name AS type","entityType","{entityState.name} as entityState","effort","units",s,w]},release:{type:"release",data:D},iteration:{type:"iteration",data:P},teamiteration:{type:"teamiteration",data:A},assigneduser:{type:"assignedUser",data:E},project:{type:"release",data:["id","name","entityType.name AS type","color"]},inboundrelations:{type:"inboundrelations",data:R},outboundrelations:{type:"outboundrelations",data:R}},N=function(t,i){var n=I[t],a=[];
return e.each(i,function(t){var i=n[t]||[];a=e.union(a,i)}),{type:n.type,data:"{"+e.compact(a).join(",")+"}"}};return e.each(M,function(t,i){M[i].data="{"+e.compact(t.data).join(",")+"}"}),e.each(F,function(t,i){F[i].data="{"+e.compact(t.data).join(",")+"}"}),t.extend({augmentCells:function(t,i){i=i||["data","lazy"];var n=t.types;return e.each(n,function(e,t){e=e.toLowerCase(),I.hasOwnProperty(e)&&(n[t]=N(e,i))}),t},augmentAxisY:function(e){if(e.types&&e.types.length){var t=e.types[0].toLowerCase();M.hasOwnProperty(t)&&(e.data=M[t].data)}return e},augmentAxisX:function(e){if(e.types&&e.types.length){var t=e.types[0].toLowerCase();F.hasOwnProperty(t)&&(e.data=F[t].data)}return e},augmentCellsLazyInfo:function(t){var i=e.deepClone(t),n=i.cells.types;return e.each(n,function(e,t){var i=e.type.toLowerCase();I.hasOwnProperty(i)&&(n[t]=N(i,["lazy"]))}),i}})}),define("tau/models/board.customize.units/board.customize.cards.builderSelector.lazyAware",["Underscore","tau/models/board.customize.units/board.customize.cards.builderSelector"],function(e,t){return t.extend({createItemData:function(e,t){if(this.suit(t.unit)){var i=t.unit.getModelByTypeAndSize(e);return t.unit.id+":{"+i+"}"}},suit:function(){throw new Error("Method suit() should be overridden")}})}),define("tau/models/board.customize.units/board.customize.cards.builderSelector.base",["Underscore","tau/models/board.customize.units/board.customize.cards.builderSelector.lazyAware"],function(e,t){return t.extend({suit:function(e){return e.lazy!==!0}})}),define("tau/models/board.customize.units/board.customize.cards.builderSelector.lazy",["Underscore","tau/models/board.customize.units/board.customize.cards.builderSelector.lazyAware"],function(e,t){return t.extend({suit:function(e){return e.lazy===!0}})}),define("tau/models/board.plus/model.board.slice.extender",["Underscore","jQuery","tau/core/class","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.settings.default","tau/models/board.plus/augmenter/board.plus.augmenter","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/models/board.customize.units/board.customize.cards.builderSelector.base","tau/models/board.customize.units/board.customize.cards.builderSelector.lazy"],function(e,t,i,n,a,r,s,o,l){return i.extend({extend:function(i,n){var a=i.slice.config.definition,r=a.cells,s=r.types;
return e.isArray(r)&&(s=r),t.when(n.getCardLayoutsByTypesAndSize(s),n.getCardLayoutsByTypesAndSize(a.x?a.x.types:[]),n.getCardLayoutsByTypesAndSize(a.y?a.y.types:[])).then(this._createTypes.bind(this)).then(this._extendSliceDataUsingTypes.bind(this,i))},_createTypes:function(e,t,i){return{cellTypes:this._createTypesFromLayouts(e),xTypes:this._createTypesFromLayouts(t),yTypes:this._createTypesFromLayouts(i)}},_createTypesFromLayouts:function(t){var i={fullTypes:new s,baseTypes:new o,lazyTypes:new l};return e.reduce(t,function(t,n,a){return e.each(t,function(e,t){e.push({type:a,data:i[t].build(a,n)})}),t},{fullTypes:[],baseTypes:[],lazyTypes:[]})},_augmentAxisData:function(t,i){if(t.data){var n=i.getCardDataByType(e.first(t.types));return t.data.substr(0,t.data.length-1)+","+n+"}"}return t.data},_augment:function(e,t,i){e.x&&(e.x=t.augmentAxisX(e.x),e.x.data=this._augmentAxisData(e.x,i)),e.y&&(e.y=t.augmentAxisY(e.y),e.y.data=this._augmentAxisData(e.y,i))},_extendSliceDataUsingTypes:function(e,t){var i=e.slice,n=e.slice.clone(),a=e.slice.clone(),o=i.config.definition,l=n.config.definition,u=a.config.definition;if(o.cells.types=t.cellTypes.fullTypes,l.cells.types=t.cellTypes.baseTypes,u.cells.types=t.cellTypes.lazyTypes,"newlist"===e.slice.config.definition.viewMode)o.x&&t.xTypes.fullTypes.length&&(o.x.data=t.xTypes.fullTypes[0].data),o.y&&t.yTypes.fullTypes.length&&(o.y.data=t.yTypes.fullTypes[0].data);else{var c=new r,d=new s;this._augment(o,c,d),this._augment(l,c,d)}return e.slice=i,e.full=i,e.base=n,e.lazy=a,e}})}),define("tau/components/board.new.list/models/card",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(t){e.each(t,function(e,t){this[t]=e},this),this.entity=e.extend(t.data.cardData||{},{entityType:{name:t.type}})},getCardProperties:function(){return e.chain(e.keys(this)).filter(function(t){return!e.isObject(this[t])},this).map(function(e){return{key:e,propertyName:e,getValue:function(t){return t[e]},setValue:function(t,i){t[e]=i
}}},this).union(e.map(this.data,function(e,t){return{key:"data__"+t,propertyName:t,getValue:function(e){return e.data[t]},setValue:function(e,i){e.data[t]=i}}},this)).value()},getDiff:function(t){var i=this,n=t.getCardProperties();return e.chain(this.getCardProperties()).map(function(a){var r=e.find(n,function(e){return a.key==e.key});if(!r)return null;var s=e.isEqual(r.getValue(t),a.getValue(i));return s?null:r}).compact().value()},getId:function(){return this.data.cardData.id},getEncodedId:function(){return this.id},getEntityType:function(){return this.data.cardData.type},isNoValueCard:function(){return!!this.data.empty}})}),define("tau/components/board.new.list/models/model.new.list.node.collection",["Underscore","tau/core/class","./card"],function(e,t,i){return t.extend({hierarchy:null,pagingModel:null,init:function(t,i,n,a,r,s,o,l){this.options=t,this.items=i||[],this.cardId=n,this.level=a,this.hierarchyMetaInfo=r||{},this.hierarchy=s,this.isPrioritizable=this.hierarchyMetaInfo.isPrioritizable,this.ordering=this._getDefaultOrdering(),this.pagingModel=o,this.createChildNode=l,this._itemSubscriptions=[],this.nodesAdded=e.Callbacks(),this.duplicateNodesRemoved=e.Callbacks(),this.cardDeleted=e.Callbacks(),this.cardAdded=e.Callbacks(),this.cardUpdated=e.Callbacks(),this.cardMoved=e.Callbacks(),this._initSubscriptions()},_initSubscriptions:function(){var t=function(t){e.each(this._itemSubscriptions,function(e){e(t)})}.bind(this);this.nodesAdded.add(function(i){e.each(i,t)}),this.cardAdded.add(function(e){t(e.nodeModel)})},createCard:function(e){return new i(e)},applyAndObserve:function(t){e.each(this.items,function(e){t(e)}),this._itemSubscriptions.push(t)},getLevelKey:function(){var e=this.hierarchyMetaInfo.parentEntityType;return e?this.level+"_"+e.toLowerCase():this.level.toString()},getCardTypes:function(){return this.hierarchyMetaInfo.cardTypes||[]},isEmpty:function(){return 0===this.items.length||1===this.items.length&&this.items[0].hasNoValueCard()},isCellLevel:function(){return"cells"===this.hierarchyMetaInfo.levelType
},isInnerCollectionsLevel:function(){return"innerCollections"===this.hierarchyMetaInfo.levelType},canExpandCard:function(t){var i=this.hierarchyMetaInfo.levelType;if("x"==i||"y"==i)return this.hierarchyMetaInfo.hasNextLevel();if(t){var n=this.hierarchyMetaInfo.findCardTypeByValueType(t);return n&&n.canExpand}return e.any(this.hierarchyMetaInfo.cardTypes,function(e){return e.canExpand})},isShowDetailsDisabled:function(t){return t&&e.contains(this.options.disableDetailsViewForTypes,t.toLowerCase())},removeDuplicatesWith:function(t){var i=e.filter(this.items,function(e){return this._findCardIndex(t,e.card.id)>=0},this);return this.items=e.without(this.items,i),this.duplicateNodesRemoved.fire(i),i},addNewItems:function(t){this.items=e.union(this.items,t),this.nodesAdded.fire(t)},removeNodeItemByCard:function(e){var t=this.findCardIndex(e);return t>=0?this.items.splice(t,1)[0]:null},findCardIndex:function(e){return this._findCardIndex(this.items,e.id)},_findCardIndex:function(t,i){return e.findIndex(t,function(e){return e.card.id===i})},sortCards:function(){if("Rank"==this.ordering.name){var e="Asc"==this.ordering.direction?-1:1;this.items.sort(function(t,i){return e*(t.card.orderingValue-i.card.orderingValue)})}},deleteCard:function(e){var t=this._tryRemoveCard(e);t&&this.cardDeleted.fire({card:e})},updateCardWith:function(t,i,n){var a=n&&t.orderingValue!==i.orderingValue,r=e.object(e.map(i.getDiff(t),function(e){var n=e.getValue(t);return e.setValue(i,n),[e.propertyName,n]},this));i.entity.isFinal=t.entity.isFinal,this.cardUpdated.fire({card:i,properties:r}),a&&(this.sortCards(),this.cardMoved.fire({card:i,index:this.findCardIndex(i)}))},removeCardFromView:function(e){var t=this._tryRemoveCard(e);t&&this.cardMoved.fire({card:e,index:null})},_tryRemoveCard:function(e){return null!==this.removeNodeItemByCard(e)},setCustomOrdering:function(e){this.ordering=e||this._getDefaultOrdering()},_getDefaultOrdering:function(){return e.defaults(this.hierarchyMetaInfo.ordering||{},{name:"",direction:""})
}})}),define("tau/components/board.new.list/models/hierarchy.structure",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(e){this._node=e},getExpandedModelsAtLevel:function(t){if(0===t)return[this._node];var i=e.filter(this._node.nodes.items,function(e){return e.nodes});return e.flatMap(i,function(e){return e.hierarchy.getExpandedModelsAtLevel(t-1)})},accept:function(t){t.visit(this._node),this._node.nodes&&e.each(this._node.nodes.items,function(e){e.hierarchy.accept(t)})},getAllNodesAtLevel:function(t){if(0===t)return[this._node];var i=this._node.nodes.items;return e.flatMap(i,function(e){return e.hierarchy.getAllNodesAtLevel(t-1)})},findNodeByPath:function(e){return this._findNodeByPathInternal(this._node,e,function(e,t){return e.hierarchy.findChildByCardId(t)})},findRawNodeByPath:function(t,i){return this._findNodeByPathInternal(t,i,function(t,i){return e.find(t.nodes.items,function(e){return e.dataItem.id==i})})},_findNodeByPathInternal:function(t,i,n){if(!i.length)return t;var a=n(t,i[0]);return a?this._findNodeByPathInternal(a,e.rest(i),n):null},findChildByCardId:function(t){return this._node.nodes?e.find(this._node.nodes.items,this._getCardIdComparison(t)):null},findAllDescendantNodesByCardIdAndType:function(t,i){var n=this._getCardIdComparison(t),a=function(t,r){return r.nodes?(i=i.toLowerCase(),e.each(r.nodes.items,function(e){n(e)&&e.getCardType().toLowerCase()===i&&t.push(e),a(t,e)}),t):t};return a([],this._node)},getPath:function(){for(var e=[],t=this._node;t&&t.card;)e.unshift(t.card.id.toString()),t=t.parent;return e},_getCardIdComparison:function(t){if(e.isString(t)&&0===t.indexOf("b64_"))return function(e){return e.card&&e.card.getEncodedId()===t};var i=parseFloat(t);return e.isNaN(i)?function(e){return e.card&&e.card.getId()===t}:function(e){return e.card&&e.card.getId()===i}}})}),define("tau/components/board.new.list/models/hierarchy.meta",["Underscore","tau/core/class","tau/utils/utils.debug"],function(e,t,i){return t.extend({init:function(t){this._globalMeta=t,i.assertWarn(e.isArray(t),"Global meta should be an array"),e.each(t,this._extendMetaForLevel.bind(this))
},getMetaForLevelAndType:function(t,n){var a=this._globalMeta[t];return a?a.groups?(i.assertError(e.isString(n),"Parent entity type should be specified for entities at inner levels"),a.groups[n.toLowerCase()]):a:null},getMetaForCells:function(){var t=e.find(this._globalMeta,function(e){return"cells"==e.levelType});return t?(i.assertError(e.isUndefined(t.groups),"Cell level meta should not contain entity groups"),t):null},_extendMetaForLevel:function(t,i,n){var a={levelType:t.levelType,totalLevelCount:n.length,findCardTypeByValueType:function(t){return t=t.toLowerCase(),e.find(this.cardTypes,function(e){return e.valueType.toLowerCase()===t})},hasNextLevel:function(){var e=n[i+1];return e&&("cells"!==e.levelType||e.cardTypes.length>0)}};t.groups?t.groups=this._createExtendedLevelMetaGroups(t.groups,a):e.defaults(t,a)},_createExtendedLevelMetaGroups:function(t,i){return e.reduce(t,function(t,n,a){var r=a.toLowerCase();return t[r]=e.defaults(n,i,{parentEntityType:r}),t},{})},_getCardTypesForLevel:function(t){return t.groups?e.flatMap(t.groups,function(e){return e.cardTypes}):t.cardTypes}})}),define("tau/components/board.new.list/models/model.new.list.tree.data",["jQuery","Underscore","tau/core/class"],function(e,t,i){return i.extend({init:function(e,i){this.treeModel=e,this.slice=i,this.data=null,this.dataLoaded=t.Callbacks()},loadData:function(){if(this._isSupported()){var e=this._getParamsForLoadData();return this._loadData(e).done(this._handleDataResponse.bind(this))}},_loadData:function(){},_getParamsForLoadData:function(){return{$set:{path:this.treeModel.hierarchy.getPath(),expansionState:this.getExpansionStateForLoadData()}}},getExpansionStateForLoadData:function(){},_handleDataResponse:function(e){this._bindData(e.data)},_bindData:function(e){e.dataItem.dataItem.data&&(this.data=e.dataItem.dataItem.data),this.dataLoaded.fire(),t.each(e.nodes.items,function(e){var t=this.treeModel.hierarchy.findChildByCardId(e.dataItem.nodeId);this._getDataModelFromNodeModel(t)&&this._getDataModelFromNodeModel(t)._bindData(e)
},this)},_bindSparseData:function(e){e.dataItem.dataItem&&(this.data=e.dataItem.dataItem.data,this.dataLoaded.fire()),t.each(e.nodes.items,function(e){var t=this.treeModel.hierarchy.findChildByCardId(e.dataItem.nodeId);t&&this._getDataModelFromNodeModel(t)&&this._getDataModelFromNodeModel(t)._bindSparseData(e)},this)},setSparseData:function(e){this._bindSparseData(e)},collapse:function(){this.data=null},_getDataModelFromNodeModel:function(){},_isSupported:function(){return!this.treeModel.nodes.isInnerCollectionsLevel()}})}),define("tau/components/board.new.list/models/model.new.list.tree.quickAdd",["jQuery","Underscore","tau/components/board.new.list/models/model.new.list.tree.data"],function(e,t,i){return i.extend({_loadData:function(e){return this.slice.treeViewPossibleActions(e)},getExpansionStateForLoadData:function(){return this.treeModel.getExpansionState(!0)},_getDataModelFromNodeModel:function(e){return e.quickAddModel}})}),define("tau/components/board.new.list/models/model.new.list.tree.counts",["jQuery","Underscore","tau/components/board.new.list/models/model.new.list.tree.data"],function(e,t,i){return i.extend({init:function(e,t){this._super(e,t),this.data=this._getInitialDataValue(),this.treeModel.nodeCollectionCreated.add(this._onNodeCollectionCreated.bind(this))},_getInitialDataValue:function(){return{types:[]}},_onNodeCollectionCreated:function(e){var t=e.nodes;t.cardAdded.add(function(e){this._onCardAdded(e.card)},this),t.cardDeleted.add(function(e){this._onCardDeleted(e.card)},this)},_loadData:function(e){return this.slice.treeViewCounts(e)},getExpansionStateForLoadData:function(){return this.treeModel.getNodesPaths()},_bindData:function(e){this._resetCounts(),e.dataItem.dataItem.data&&t.each(e.dataItem.dataItem.data.types,function(e){var t=this._getTypeCount(e.type);t&&(t.count=e.count)},this),this.dataLoaded.fire(),t.each(e.nodes.items,function(e){var t=this.treeModel.hierarchy.findChildByCardId(e.dataItem.nodeId);t&&this._getDataModelFromNodeModel(t)&&this._getDataModelFromNodeModel(t)._bindData(e)
},this)},_initializeCountsIfRequired:function(){this.data.types.length||(this.data.types=t.map(this.treeModel.hierarchyMetaInfo.cardTypes,function(e){return{type:e.valueType,typeName:e.typeName,count:0}}))},_resetCounts:function(){this.data=this._getInitialDataValue(),this._initializeCountsIfRequired()},_onCardAdded:function(e){this.increaseCount(e.type)},increaseCount:function(e){this._initializeCountsIfRequired();var t=this._getTypeCount(e);t&&(t.count+=1),this.dataLoaded.fire()},_onCardDeleted:function(e){var t=this._getTypeCount(e.type);t&&(t.count-=1),this.dataLoaded.fire()},_getTypeCount:function(e){return t.find(this.data.types,function(t){return t.type.toLowerCase()===e.toLowerCase()})},getAllCount:function(){var e=0;return t.each(this.data.types,function(t){e+=t.count}),e},getPagesCount:function(){return Math.ceil(this.getAllCount()/this.treeModel.pagingModel.getTake())},_getDataModelFromNodeModel:function(e){return e.countsModel},collapse:function(){this.data=this._getInitialDataValue()}})}),define("tau/components/board.new.list/models/model.new.list.tree.base",["jQuery","Underscore","tau/core/class","./card","./model.new.list.node.collection","./hierarchy.structure","./hierarchy.meta","./node.modification.strategies","./model.new.list.tree.quickAdd","./model.new.list.tree.counts","./hierarchy.innerLevels","tau/services/customize/service.customize.card.layout.factory.newlist"],function(e,t,i,n,a,r,s,o,l,u,c,d){return i.extend({init:function(e,i,n,a,s){this._modelSettings=e,this._listSettings=e.listSettings,this._apiService=this._listSettings.apiService,this.card=i||null,this.nodes=n||null,this.level=t.isNumber(a)?a:-1,this.parent=s,this.nodeCollectionCreated=t.Callbacks(),this.loadingStatusChanged=t.Callbacks(),this.hierarchy=new r(this),this.pagingModel=this._createPaging(),this.pagingUpdated=t.Callbacks(),this.pagingLoadingStarted=t.Callbacks(),this.quickAddModel=new l(this,this._apiService),this.countsModel=new u(this,this._apiService),this.modelReset=t.Callbacks()
},hasNoValueCard:function(){return this.card.isNoValueCard()},resetModel:function(){},updateChildrenNodes:function(e,t){this.resetModel(),this._handleTreeResponse(e,t),this.pagingModel.reset(),this._updatePagingState()},getIsExpanded:function(){return!!this.nodes},hasChildren:function(){return this.nodes&&this.nodes.items.length>0},_executeTreeDataWorkflow:function(t){return this.loadingStatusChanged.fire({isLoading:!0}),e.when(t.call(this,this._apiService)).then(function(e){var t=this.card?this.card.type:void 0;return this._handleTreeResponse(e.data.nodes,e.data.meta,t)}.bind(this),this._handleFailedTreeResponse.bind(this)).always(function(){this.loadingStatusChanged.fire({isLoading:!1}),this._updatePagingState()}.bind(this)).fail(function(e){if(e)throw e}).done(this.countsModel.loadData.bind(this.countsModel)).done(this.quickAddModel.loadData.bind(this.quickAddModel))},_handleTreeResponse:function(t,i,n){try{var a=new s(i),r=new d(this._listSettings.serviceContainer,this._listSettings.boardSettingsService);return e.when(c.createInnerLevelsDefinition(a,r)).then(this._apiService.setInnerLevelsDefinition.bind(this._apiService)).then(this._populateTreeNodeWith.bind(this,t,a,this.level,!0,n))}catch(o){return e.Deferred().reject(o)}},_populateTreeNodeWith:function(e,t,i,n,a){this.hierarchyMetaInfo=t.getMetaForLevelAndType(i+1,a),this.nodes=this._createNodeCollectionModel(e,t,i,n,a),this.pagingModel.updateWithResponseData(e),this.nodes&&(this.nodes.cardAdded.add(this._updatePagingState,this),this.nodes.cardMoved.add(this._updatePagingState,this),this.nodes.cardDeleted.add(this._updatePagingState,this),this.nodeCollectionCreated.fire({nodes:this.nodes}))},_createNodeCollectionModel:function(e,i,r,s,o){var l=this,u=l.card;if(e.items.length||s){var c=l._getNodeConstructor(),d=t.map(e.items,function(e){var t=new c(l._modelSettings,new n(e.dataItem),null,r+1,l);return t._populateTreeNodeWith(e.nodes,i,r+1,!1,e.dataItem.type),t},this),p=u?u.id:null,f=i.getMetaForLevelAndType(r+1,o),m=function(e){return new c(l._modelSettings,new n(e),null,l.level+1,l)
}.bind(this);return new a(this._listSettings.options,d,p,r+1,f,l.hierarchy,l.pagingModel,m)}return null},_handleFailedTreeResponse:function(){},_updatePagingState:function(){var e=this.nodes||{items:[]};this.pagingModel.isEnabled=!!e.items.length,this.pagingModel.actualPageSize=e.items.length,this.pagingUpdated.fire()},getRoot:function(){return this.parent?this.parent.getRoot():this},getExpansionState:function(e){return this._getNodesPaths(this.nodes.items,function(t){return e?t.hasChildren():t.getIsExpanded()})},getNodesPaths:function(){return this._getNodesPaths(this.nodes.items,t.constant(!0))},_getNodesPaths:function(e,i){return t.chain(e).filter(i).reduce(function(e,t){return e.push(t.hierarchy.getPath()),t.hasChildren()&&(e=e.concat(this._getNodesPaths(t.nodes.items,i))),e},[],this).value()},getCardsCount:function(){var e={count:0,visit:function(e){e.nodes&&(this.count+=e.nodes.items.length)}};return this.hierarchy.accept(e),e.count},loadCard:function(e,i){var n=this.getRoot().hierarchy.findAllDescendantNodesByCardIdAndType(e,i),a=t.map(n,function(t){return{cardId:e,pathToParent:t.parent?t.parent.hierarchy.getPath():[]}});return this._apiService.treeViewCards({$set:{cards:a}}).then(this.applyCardsChanges.bind(this,o.regular,n))},applyCardsChanges:function(e,i,n){var a=t.compact(t.map(n.data,function(e){return e.dataItem&&e.dataItem.data&&!e.dataItem.data.empty?{card:e.dataItem,path:e.path,fullPath:e.path.join(",")+","+e.dataItem.id}:void 0}));this.getRoot().addOrUpdateCards(a,e);var r=t.map(i,function(e){var t=e.parent?e.parent.hierarchy.getPath():[];return{card:e.card,path:t,fullPath:t.join(",")+","+e.card.id}}),s=t.filter(r,function(e){return!t.some(a,function(t){return t.fullPath===e.fullPath})});this.getRoot().deleteCards(s)}})}),define("tau/components/board.new.list/models/showMorePaging",["tau/core/class"],function(e){return e.extend({_currentPage:0,pageSize:25,hasPrev:!1,hasNext:!1,nextOrderingValue:null,prevOrderingValue:null,updateWithResponseData:function(e){this.hasNext=e.hasNextPage,this.nextOrderingValue=e.nextOrderingValue
},getSkip:function(){return 0},getTake:function(){return(this._currentPage+1)*this.pageSize},goToNextPage:function(){this._currentPage+=1},reset:function(){this._currentPage=0}})}),define("tau/components/board.new.list/models/model.new.list.tree.node",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.utils","./model.new.list.tree.base","./hierarchy.meta","./card","./showMorePaging"],function(e,t,i,n,a,r,s,o){var l=a.extend({_createPaging:function(){return new o},_getNodeConstructor:function(){return l},resetModel:function(){this.collapse(),this.pagingModel.reset(),this.modelReset.fire()},expand:function(){var e=this._createTreeViewRequestArguments(0);return this._executeTreeDataWorkflow(function(t){return t.treeViewExpand(e)})},collapse:function(){this.nodes=null},goToNextPage:function(){if(!this.pagingModel.hasNext)return t.Deferred().resolve();this.pagingLoadingStarted.fire();var i=this.nodes.items.length<this.pagingModel.getTake()?this.nodes.items.length:this.pagingModel.getTake();return this._apiService.treeView(this._createTreeViewRequestArguments(i)).done(e.bind(function(e){var t=this.card?this.card.type:void 0,i=this._createNodeCollectionModel(e.data.nodes,new r(e.data.meta),this.level,!1,t),n=i&&i.items&&i.items.length;if(n){var a=i.items;this.nodes.removeDuplicatesWith(a),this.nodes.addNewItems(a)}this.pagingModel.updateWithResponseData(e.data.nodes),this.pagingModel.goToNextPage(),this.pagingUpdated.fire()},this)).done(this.countsModel.loadData.bind(this.countsModel)).fail(this._handleFailedTreeResponse.bind(this))},getCardId:function(){return this.card?this.card.getId():null},getCardType:function(){return this.card?this.card.getEntityType():null},_createTreeViewRequestArguments:function(e){var t=this.hierarchy.getPath();return{$skip:e,$take:this.pagingModel.getTake(),$set:{path:t}}}});return l}),define("tau/components/board.new.list/models/paging",["tau/core/class"],function(e){return e.extend({_currentPage:0,isEnabled:!1,pageSize:50,actualPageSize:0,hasPrev:!1,hasNext:!1,availablePageSizes:[20,50,100],nextOrderingValue:null,prevOrderingValue:null,totalCount:null,setCurrentPage:function(e){this._currentPage=e,this.hasPrev=this._currentPage>0
},updateWithResponseData:function(e){this.hasNext=e.hasNextPage,this.nextOrderingValue=e.nextOrderingValue,this.prevOrderingValue=e.prevOrderingValue},getCurrentPage:function(){return this._currentPage},goToPreviousPage:function(){this.setCurrentPage(this._currentPage-1)},goToNextPage:function(){this.setCurrentPage(this._currentPage+1)},getSkip:function(){return this._currentPage*this.pageSize},getTake:function(){return this.pageSize},getFrom:function(){return this.getSkip()+1},getTo:function(){return this.getSkip()+this.actualPageSize},reset:function(){this.setCurrentPage(0)}})}),define("tau/components/board.new.list/models/model.new.list.tree.root",["jQuery","Underscore","./model.new.list.tree.base","./model.new.list.tree.node","./paging","./hierarchy.meta"],function(e,t,i,n,a,r){return i.extend({init:function(e,t,i,n,a){this._super(e,t,i,n,a),this.countsModel.dataLoaded.add(function(){this.pagingModel.totalCount=this.countsModel.getAllCount(),this.pagingUpdated.fire()},this)},_createPaging:function(){var e=new a,t=this._modelSettings.paging;return e.pageSize=t?t.onPage:50,e},_getNodeConstructor:function(){return n},loadTreeData:function(){return this._loadTreeDataInternal(this.pagingModel.getSkip(),this.pagingModel.getTake()).then(this._updatePagingState.bind(this))},_loadTreeDataInternal:function(e,t){var i={$skip:e,$take:t};return this._executeTreeDataWorkflow(function(e){return e.treeView(i)})},_handleTreeResponse:function(e,t){return this._globalMeta=new r(t),this._super(e,t)},goToPage:function(e){var t=e*this.pagingModel.getTake();return this._loadTreeDataInternal(t,this.pagingModel.getTake()).done(function(){this.pagingModel.setCurrentPage(e),this._updatePagingState()}.bind(this))},goToNextPage:function(){return this.pagingModel.hasNext?this.goToPage(this.pagingModel.getCurrentPage()+1):e.Deferred().resolve()},goToPreviousPage:function(){return this.pagingModel.hasPrev?this.goToPage(this.pagingModel.getCurrentPage()-1):e.Deferred().resolve()},goToLastPage:function(){return this.goToPage(this.countsModel.getPagesCount()-1)
},goToFirstPage:function(){return this.goToPage(0)},setPageSize:function(e){this._modelSettings.listSettings.boardSettingsService.set({set:{cellPaging:{onPage:e}},callback:function(){var t=e;this._loadTreeDataInternal(0,t).done(function(){this.pagingModel.pageSize=t,this.pagingModel.setCurrentPage(0),this._updatePagingState()}.bind(this))}.bind(this)})},addOrUpdateCards:function(e,i){t.each(e,function(e){var t=e.card,n=this.hierarchy.findNodeByPath(e.path);if(n&&n.nodes){var a=n.hierarchy.findChildByCardId(t.id);a?i.updateCard(n.nodes,a,t):i.addCard(n,t)}},this)},deleteCards:function(e){t.each(e,function(e){var t=e.card,i=this.hierarchy.findNodeByPath(e.path);if(i&&i.nodes){var n=i.hierarchy.findChildByCardId(t.id);n&&i.nodes.deleteCard(t)}},this)},deleteDescendantsByCardIdAndType:function(e,i){var n=this.hierarchy.findAllDescendantNodesByCardIdAndType(e,i);t.each(n,function(e){e.parent.nodes.deleteCard(e.card)})},refreshDescendantsByCardIdAndType:function(e,i){var n=this.hierarchy.findAllDescendantNodesByCardIdAndType(e,i);t.each(n,this._refreshNode,this)},_refreshNode:function(e){var i=t.object(t.map(e.card.getCardProperties(),function(t){return[t.propertyName,t.getValue(e.card)]}));e.parent.nodes.cardUpdated.fire({card:e.card,properties:i})}})}),define("tau/components/board.new.list/controllers/controller.new.list",["require","Underscore","tau/core/controller.base","./controller.new.list.tree.root","tau/models/board.plus/model.board.slice.extender","../models/model.new.list.tree.root","tau/libs/boardSettings/board.settings.to.definition.translator"],function(e){var t=e("Underscore"),i=e("tau/core/controller.base"),n=e("./controller.new.list.tree.root"),a=e("tau/models/board.plus/model.board.slice.extender"),r=e("../models/model.new.list.tree.root"),s=e("tau/libs/boardSettings/board.settings.to.definition.translator");return i.extend({_lastRenderedElement:null,init:function(e,t,i,n,a,r,s,o,l){this._skeletonView=e,this._listModel=t,this._eventAggregator=i,this._configurator=r,this._editorComponentBuilder=n,this._quickAddComponentBuilder=a,this._sliceFactory=s,this._componentBus=o,this._behaviorsConfig=l
},startLifeCycle:function(e,t,i){taus.start("statistics_newlist_cardLoad",{},"statistics_newlist_cardLoad");var n=new s(e,i);n.getBoardDefinition().then(function(e){var i=e.definition,n=e.configuration;this._eventAggregator.acidRetrieved.fire(i.global.acid),this._eventAggregator.boardSettingsRetrieved.fire(n),this._eventAggregator.definitionReady.fire(i,n);var r={definition:i},s=this._sliceFactory.create(r),o=new a;o.extend({slice:s},t).then(function(e){this._eventAggregator.sliceServiceCreated.fire({service:e.slice,definition:i})}.bind(this))}.bind(this))},buildSkeleton:function(e,t){var i=this._listModel.getEmptyModelInfoArgs(e.config.definition);this._eventAggregator.sliceInfoRetrieved.fire(i),this._skeletonView.buildSkeleton(e.config.definition,i,t)},render:function(e,i,a){var s=i.config.definition;e.get(["cellPaging"]).then(t.bind(function(o){var l={paging:o.cellPaging,boardId:e.settings.id,listSettings:{apiService:i,boardSettingsService:e,serviceContainer:this._configurator,options:a}},u=new r(l);if(this._listModel.setup(u,s),this._listModel.isNotConfigured())this._skeletonView.showNotConfiguredMessage();else{var c=new n(u,this._skeletonView,this._eventAggregator,this._editorComponentBuilder,this._quickAddComponentBuilder,this._configurator,l);c.startLifeCycle(),this._addChildDestroyable(c),t.each(this._createBehaviors(l,c),function(e){this._addChildDestroyable(e),e.attach()},this)}},this))},_createBehaviors:function(e,i){var n={eventAggregator:this._eventAggregator,skeletonView:this._skeletonView,configurator:this._configurator,componentBus:this._componentBus,rootTreeController:i,modelSettings:e,listModel:this._listModel,behaviorsSettings:this._behaviorsConfig.settings};return t.map(this._behaviorsConfig.behaviors,function(e){return new e(n)})}})}),define("tau/components/board.new.list/views/editors/view.new.list.editor.unit",["Underscore","tau/components/board.new.list/destroyable","tau/components/board.new.list/views/editors/editor.utils"],function(e,t,i){return t.extend({init:function(t,i,n,a,r){this._card=t,this._$card=n,this._$unit=a,this.unitEditorUpdating=e.Callbacks(),this.unitEditorUpdated=e.Callbacks(),this.unitEditFinished=e.Callbacks(),this._initEditorComponentSubscriptions(r)
},_initEditorComponentSubscriptions:function(e){var t=function(t,i){e[t].add(function(){this[i].fire({cardId:this._card.getId(),cardType:this._card.getEntityType()})}.bind(this))}.bind(this);t("editorSaving","unitEditorUpdating"),t("editorSaved","unitEditorUpdated"),t("editFinished","unitEditFinished"),e.cleanedUp.add(this._cleanUp.bind(this))},toggleFocus:function(e){this._$card.toggleClass("tau-card_focusedit_true",e)},toggleBusyIndicator:function(e){i.toggleElementBusyIndicator(this._$unit,e)},_cleanUp:function(){this.unitEditorUpdating.empty(),this.unitEditorUpdated.empty(),this.unitEditFinished.empty()}})}),define("tau/components/board.new.list/views/editors/editor.workflow",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(e,t,i,n){this._finishedEvent=i.finishedEvent,this._savingEvent=i.savingEvent,this._savedEvent=i.savedEvent,this._saveFailedEvent=i.saveFailedEvent,this._$bubbled=e,this._editorBus=t,this._events=n,this._shouldFinishOnFirstSave=this._finishedEvent===this._savedEvent},start:function(){var e=this._editorBus,t={isFinished:!1,isSaving:!1,isCleanedUp:!1};this._savedEvent?this._savingEvent?(e.on(this._savingEvent,this._onSaving.bind(this,t),this),e.on(this._savedEvent,this._onSaved.bind(this,t),this),e.on(this._saveFailedEvent,this._onSaveFailed.bind(this,t),this)):(console.warn('"savedEvent" was specified without the matching "savingEvent". This will probably cause card update issues when bubble is closed while saving is in progress'),e.on(this._savedEvent,function(){this._onSaving(t),this._onSaved(t)}.bind(this),this),e.on(this._saveFailedEvent,function(){this._onSaving(t),this._onSaveFailed(t)}.bind(this),this)):(this._saveFailedEvent&&console.error('"saveFailedEvent" was specified without matching "savedEvent"'),this._savingEvent&&console.error('"savingEvent" was specified without matching "savedEvent"')),this._finishedEvent&&e.once(this._finishedEvent,this.onFinished.bind(this,t),this),e.once("destroy",this.onFinished.bind(this,t),this),this._$bubbled.one("taububblehide.adapterDefault",function(){this.onFinished(t)
}.bind(this))},onFinished:function(e){e.isFinished||(e.isFinished=!0,this._events.editFinished.fire());var t=!e.isCleanedUp&&e.isFinished&&!e.isSaving;t&&(e.isCleanedUp=!0,this._editorBus.removeAllListeners(this),this._$bubbled.off(".adapterDefault"),this._tryDestroyBubble(this._$bubbled),this._events.cleanedUp.fire())},_onSaving:function(e){e.isSaving=!0,this._events.editorSaving.fire(),this._shouldFinishOnFirstSave&&this._$bubbled.tauBubble("hide")},_onSaved:function(e){e.isSaving=!1,this._events.editorSaved.fire(),(this._shouldFinishOnFirstSave||e.isFinished)&&this.onFinished(e)},_onSaveFailed:function(e){this._onSaved(e)},_tryDestroyBubble:function(e){e&&e.data("ui-tauBubble")&&e.tauBubble("destroy")}})}),define("tau/components/board.new.list/views/editors/editor.adapter.default",["Underscore","jQuery","tau/core/class","./editor.workflow"],function(e,t,i,n){return i.extend({init:function(){this.editorSaving=e.Callbacks(),this.editorSaved=e.Callbacks(),this.editFinished=e.Callbacks(),this.cleanedUp=e.Callbacks()},adaptEditorData:function(t,i){return e.cloneDeep(i)},createEditableElement:function(e){return this._editableDeferred||(this._editorBus=e,this._editableDeferred=t.Deferred(),this._getEditable(this._editorBus,this._editableDeferred)),this._editableDeferred},startEdit:function(e,i){t.when(this._editableDeferred).then(function(t){this._initEditor(t,e,i)}.bind(this))},_getEditable:function(e,t){e.on("afterRender",function(e,i){t.resolve(i.element)})},_initEditor:function(e,t,i){t.tauBubble("adjust");var a=new n(t,this._editorBus,i,this);a.start()},_enableBubbleAdjustOnKeydown:function(t,i){i.on("keydown",e.throttle(function(){t.data("ui-tauBubble")&&t.tauBubble("adjust")},400))},_focusOnText:function(e){e.find(":text").focus(1)}})}),define("tau/components/board.new.list/views/editors/editor.adapter.text",["require","Underscore","jQuery","./editor.adapter.default"],function(e){var t=(e("Underscore"),e("jQuery"),e("./editor.adapter.default"));return t.extend({_initEditor:function(e,t){this._super(e,t,{savingEvent:"beforeSave",savedEvent:"afterSave",finishedEvent:"afterSave"}),e.on("blur",function(){t.tauBubble("hide")
})}})}),define("tau/components/board.new.list/views/editors/editor.adapter.title",["require","./editor.adapter.text"],function(e){var t=e("./editor.adapter.text");return t.extend({_getEditable:function(e,t){e.on("$editable.ready",function(e,i){t.resolve(i)})},_initEditor:function(e,t){this._super(e,t),this._enableBubbleAdjustOnKeydown(t,e),e.editableText("activate"),this._focusOnText(e)}})}),define("tau/components/board.new.list/views/editors/editor.adapter.assignments",["Underscore","jQuery","./editor.adapter.default"],function(e,t,i){return i.extend({_initEditor:function(t,i){this._super(t,i,{savingEvent:"assignment.editor.saving",savedEvent:"assignment.editor.saved"}),e.delay(function(){t.toggleClass("tau-assignments_state_loaded",!0),this._focusOnText(t)}.bind(this),200)}})}),define("tau/components/board.new.list/views/editors/editor.adapter.tags",["Underscore","jQuery","./editor.adapter.default"],function(e,t,i){return i.extend({_initEditor:function(e,t){this._super(e,t,{savingEvent:"tags.inline.changing",savedEvent:"tags.inline.changed",finishedEvent:"tags.inline.edit.finished"}),this._focusOnText(e)}})}),define("tau/components/board.new.list/views/editors/editor.adapter.choice",["Underscore","jQuery","./editor.adapter.default"],function(e,t,i){return i.extend({adaptEditorData:function(e,t){var i=this._super(e,t);return e.hideIf&&(i.hasValue=!e.hideIf(t)),i},_initEditor:function(e,t){this._super(e,t,{savingEvent:"beforeSave",savedEvent:"afterSave",saveFailedEvent:"saveFailed",finishedEvent:"afterSave"})}})}),define("tau/components/board.new.list/new.list.editor.component.builder",["Underscore","jQuery","tau/core/class","./views/editors/view.new.list.editor.unit","./views/editors/editor.adapter.default","./views/editors/editor.adapter.title","./views/editors/editor.adapter.text","./views/editors/editor.adapter.assignments","./views/editors/editor.adapter.tags","./views/editors/editor.adapter.choice"],function(e,t,i,n,a,r,s,o,l,u){return i.extend({configsByEditor:{defaults:{maxWidth:!1,minWidth:!0,className:null,positionVertical:"center",adapter:a},title:{maxWidth:!0,minWidth:!0,adapter:r},choice:{minWidth:!0,positionVertical:"top",adapter:u},tags:{className:"tau-bubble-newlist-editor-tags-inline",adapter:l},assignments:{minWidth:!1,className:"tau-bubble-newlist-editor-assignments",positionVertical:"top",adapter:o},"time.description.edit":{maxWidth:!1,minWidth:!1,adapter:s,bubbleConfig:{appendTo:null}},"finder.entity":{adapterConfig:{savingEvent:"beforeSave",savedEvent:"afterSave",saveFailedEvent:"saveFailed",finishedEvent:"afterSave"}},effort:{minWidth:!1,className:"tau-bubble-newlist-editor-effort",positionVertical:"top",adapterConfig:{savingEvent:"effort.editor.saving",savedEvent:"effort.editor.saved",saveFailedEvent:"effort.editor.saveFailed",finishedEvent:"effort.editor.finished"}},time:{minWidth:!1,className:"tau-bubble-newlist-editor-effort",positionVertical:"top",adapterConfig:{savingEvent:"time.editor.saving",savedEvent:"time.editor.saved",saveFailedEvent:"time.editor.saveFailed",finishedEvent:"time.editor.finished"}},"entity.delete":{minWidth:!1,className:null,positionVertical:"center",adapterConfig:{savingEvent:"delete.editor.saving",savedEvent:"delete.editor.saved",saveFailedEvent:"delete.editor.saveFailed",finishedEvent:"delete.editor.finished"}},date:{maxWidth:!1,minWidth:!1,bubbleConfig:{dontCloseSelectors:["#ui-datepicker-div"],zIndex:1e4},adapterConfig:{savingEvent:"beforeSave",savedEvent:"afterSave",saveFailedEvent:"saveFailed",finishedEvent:"afterSave"}}},init:function(e,t,i,n){this._bus=e,this._configurator=t,this._eventAggregator=i,this._viewContainer=n
},createEditorView:function(e,i,r,s){var o={configurator:this._configurator,entity:e.entity},l=i.editorConfig,u=this._getEditorConfig(l.type),c=u.adapter||a,d=new c,p=d.adaptEditorData(i,e.data[i.id]),f=this._createBubbleConfigOptions(u,s,r),m=this._createComponentConfig(l,o,p,f),h=this._configurator.getComponentBuilder();return h.createAsChild(m,this._bus).then(function(e){var i,n=t.Deferred(),a=t.Deferred();return e.once("childrenBuses.ready",function(e,t){i=t[0],d.createEditableElement(i).then(function(){a.resolve(d)})}),e.once("$bubbled.ready",function(e,t){i.fire("$outerBubbled.ready",t),n.resolve(t)}),e.initialize({context:o}),e.fire("view.dom.ready"),e.fire("$trigger.ready",s),t.when(n,a)}).then(function(t,a){return a.startEdit(t,u.adapterConfig),new n(e,i,r,s,a)})},_getEditorConfig:function(t){var i=e.find(this.configsByEditor,function(i,n){return e.startsWith(t,n)});return e.extend({},this.configsByEditor.defaults,i)},_findEditorContainer:function(){return this._viewContainer.findBoardContainer()},_createBubbleConfigOptions:function(t,i,n){var a=n.closest(".general-info"),r=a.length?a:n;return e.extend({appendTo:r,within:this._findEditorContainer(),className:t.className,showArrow:!1,template:['<div class="tau-bubble tau-bubble-newlist-editor" style="',t.maxWidth?" max-width: "+i.width()+"px;":"",t.minWidth?" min-width: "+i.outerWidth()+"px;":"",'">','<div class="tau-bubble__inner" role="content"></div>',"</div>"].join(""),onPositionConfig:function(e){e.my="left "+t.positionVertical,e.at="left "+t.positionVertical,e.collision="flipfit flipfit"}},t.bubbleConfig)},_createComponentConfig:function(t,i,n,a){var r=e.extend({},t,{context:i,extensions:[],data:n,$within:this._findEditorContainer()});return{type:"bubble.container",visible:!0,children:[r],extensions:[],options:a}}})}),define("tau/components/board.new.list/extension.base.new.list",["Underscore","jQuery","tau/core/extension.base","tau/components/board.new.list/controllers/controller.new.list","tau/components/board.new.list/new.list.editor.component.builder"],function(e,t,i,n,a){return i.extend({_lastRenderedElement:null,init:function(e,t,i,n,r){this._super(e),this.config=e,this._listModel=t,this._skeletonView=i,this._eventAggregator=n,this._configurator=e.context.configurator,this._editorComponentBuilder=new a(e.bus,e.context.configurator,this._eventAggregator,i),this._quickAddComponentBuilder=r,this._initControllerSubscriptions(this._eventAggregator),this._initViewSubscriptions(this._eventAggregator)
},_initControllerSubscriptions:function(e){var t=this.fire.bind(this);e.definitionReady.add(function(e){t("definition.ready",e)}),e.sliceServiceCreated.add(function(e){t("slice.ready",{slice:e.service})}),e.cellModelLoaded.add(function(e){t("model.cells.content.loaded",{metaInfo:e.hierarchyMetaInfo})}),e.sliceInfoRetrieved.add(function(e){t("model.sliceInfo.retrieved",e),t("board.paging.settings",e);var i=e.x.onPage,n=e.y.onPage,a=i||1,r=n||1,s=a*r+i+n;t("metaInfo",{expectedCellsCount:s,refActualCellsCount:0,refActualCellsData:[]})}),e.cardRemoved.add(function(e){t("card.removed",e)}),e.itemAddedToContext.add(function(e){t("newlist.highlightItem",e)})},_initViewSubscriptions:function(e){var t=this.fire.bind(this);e.skeletonBuilt.add(function(e){t("view.skeleton.built",{element:e})}),e.treeRendered.add(function(e){t("view.cell.skeleton.built",e)}),e.entityDetailsViewRequested.add(function(e){t("new.list.open.card.details.view",e)})},"bus initialize":function(e,t){var i=this._extractOptions(t.options||this.config.options,{dragndrop:{containmentRefreshTimeout:null},clipboard:{processTimeout:null}});this.fire("options.ready",i),this.fire("configurator.ready",e.data.context.configurator),this.fire("board.configurator.initialized",{configurator:e.data.context.configurator}),this.fire("start.lifecycle",e.data)},"bus refresh":function(){this._super(),this.fire("start.lifecycle",this.config)},"bus configurator.ready > refresh":function(e,t){this.fire("configurator.ready",t)},"bus options.ready > refresh":function(e,t){this.fire("options.ready",t)},"bus newlist.highlightItem > model.cells.content.loaded":function(e,t){var i=this._skeletonView.findView(t.hierarchyPath);i&&i.highlightCard(t.cardId)},"bus boardSettings.ready:last + sliceFactory.ready:last + cardLayoutFactory.ready:last + start.lifecycle":function(e,t,i,a){this.fire("afterInit",{}),this._skeletonView.cleanup(),this._skeletonView.setCardLayoutFactory(a),this._newListController&&this._newListController.destroy(),this._newListController=new n(this._skeletonView,this._listModel,this._eventAggregator,this._editorComponentBuilder,this._quickAddComponentBuilder,this._configurator,i,this.config.bus,{behaviors:this.config.behaviors,settings:this.config.behaviorsSettings||{}}),this._newListController.startLifeCycle(t.boardSettings,a,this._getAppStateStore())
},"bus boardSettings.ready:last + slice.ready":function(e,t,i){this._newListController.buildSkeleton(i.slice,t.boardSettings)},"bus boardSettings.ready:last + view.dom.ready + slice.ready":function(e,t,i,n){this._newListController.render(t.boardSettings,n.slice,this.config.listOptions)},"bus view.skeleton.built":function(e){this.fire("afterRender",e.data)},"bus afterRender":function(e){var t=e.data.element;this._lastRenderedElement&&this._lastRenderedElement!==t&&this.fire("element.updated",{newElement:t,oldElement:this._lastRenderedElement}),this._lastRenderedElement=e.data.element;var i=t.find(".i-role-grid");this.fire("$el.ready",t),this.fire("$grid.ready",i)},"bus metaInfo":function(){this.onViewCellSkeletonBuiltTick=this._onViewCellSkeletonBuiltTickHandler},"bus overview.cells.skeletons.ready":function(){this.onViewCellSkeletonBuiltTick=t.noop},"bus metaInfo:last + view.cell.skeleton.built":function(e,t,i){this.onViewCellSkeletonBuiltTick(t,i)},"bus metaInfo + view.cards.update.complete":function(e,t){this.fire("overview.cards.ready",{cards:t.refActualCellsCardsHash,cardGroups:t.refActualCellsCardsGroupedHash})},"bus view.skeleton.built + overview.cells.skeletons.ready":function(e,t,i){this.fire("overview.board.ready",{element:t.element,cells:i.cells})},"bus slice.ready:last + before_destroy":function(e,t){this.fire("clearError"),t.slice.abort()},"bus slice.ready:last + before_refresh":function(e,t){this.fire("clearError"),t.slice.abort()},destroy:function(){this._newListController&&this._newListController.destroy(),this._skeletonView&&this._skeletonView.destroy(),this._super()},_onViewCellSkeletonBuiltTickHandler:function(e,t){e.refActualCellsCount+=1,e.refActualCellsData.push(t),e.refActualCellsCount===e.expectedCellsCount&&this.fire("overview.cells.skeletons.ready",{cells:e.refActualCellsData,cardGroups:e.refActualCellsCardsGroupedHash})}})}),define("tau/slice/api.new.list",["Underscore","jQuery","tau/slice/slice.space.cached","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/services/customize/service.customize.card.layout.factory.newlist","tau/models/board.customize.units/const.card.sizes"],function(e,t,i){return i.extend({init:function(t,i,n){this._super(t,i),this._newListSliceOptions=n,this.innerLevelsDefinitionChanged=e.Callbacks()
},getCometParameters:function(){var t=this._super();return e.extend(t,{boardId:this._newListSliceOptions.boardId}),t},setInnerLevelsDefinition:function(e){this.config.definition.innerLevels=e,this.innerLevelsDefinitionChanged.fire(e)},treeView:function(e){return this.resolveDeferred("treeView",e)},treeViewPossibleActions:function(e){return this.resolveDeferred("treePossibleActions",e)},treeViewPossibleActionsSparse:function(e){return this.resolveDeferred("treePossibleActionsSparse",e)},treeViewCounts:function(e){return this.resolveDeferred("counts",e)},treeViewCountsSparse:function(e){return this.resolveDeferred("countsSparse",e)},treeViewCards:function(e){return this.resolveDeferred("cards",e)},treeViewExpand:function(e){return this.resolveDeferred("expand",e)},treeViewCollapse:function(e){return this.resolveDeferred("collapse",e)},treeViewPrioritizeBatch:function(e){return this.resolveDeferred("prioritizeBatch",e)},treeViewByLevel:function(e){return this.resolveDeferred("sort",e)},resolveDeferred:function(e,t){var i=this._prepareCommand({method:e,config:t});return this._super(i.method,i.config)},_createApiRequestConfig:function(e,t){var i=this._super(e,t);return i.parameters.definition.innerLevels=this.config.definition.innerLevels,i},_prepareCommand:function(e){return e.config=t.extend(!0,e.config,{$set:{boardId:this._newListSliceOptions.boardId}}),e}})}),define("tau/slice/new.list.factory",["Underscore","tau/core/class","tau/slice/api.new.list","tau/slice/url.resolver"],function(e,t,i,n){var a=t.extend({init:function(e,t){this.defaults=e||{},this._newListSliceOptions=t},create:function(t){return e.defaults(t,this.defaults),this._createSlice(t,new n({prefix:this._newListSliceOptions.prefix||"TreeView"}))},_createSlice:function(e,t){return new i(e,t,this._newListSliceOptions)}});return a}),define("tau/components/board.new.list/extensions/model.new.list.quick.add",["Underscore","jQuery","tau/models/quick.add/model.board.quick.add.base"],function(e,t,i){return i.extend({resolveSliceAddData:function(){var e=this.config.options;
return t.Deferred().resolve({slice:e.slice,types:e.types,path:e.path,expansionState:e.expansionState,onAfterAdd:e.onAfterAdd,shouldSkipNotification:e.shouldSkipNotification})},getDataItemTemplateParam:function(e){return{path:e.path}},getDoAddParams:function(e,t){var i={path:t.path,expansionState:t.expansionState,type:e.type,values:e.fields};return i},onAfterAddData:function(e,t,i){taus.track({action:"quick add entity",entityType:t.data[0].dataItem.type.toLowerCase(),tags:["newlist"]}),e.shouldSkipNotification(t.data[0])&&(i.skipNotification=!0),this._super(e,t,i),e.onAfterAdd(t)}})}),define("tau/components/board.new.list/new.list.quickAdd.component.builder",["Underscore","jQuery","tau/core/class","tau/components/board.new.list/extensions/model.new.list.quick.add","tau/components/board.new.list/models/node.modification.strategies"],function(e,t,i,n,a){return i.extend({_optionDefaults:{positionConfig:{collision:"fit flipfit"}},init:function(t,i,n,a){this._bus=t,this._configurator=i,this._eventAggregator=n,this._options=e.defaults(a||{},this._optionDefaults)},createQuickAddComponent:function(e,t){var i=e,a=t.getRoot().getExpansionState(!0),r=this.onAfterAdd.bind(this,t),s={type:"board.cell.quick.add",QuickAddModel:n,options:{slice:t._apiService,path:t.hierarchy.getPath(),types:t.quickAddModel.data.types,expansionState:a,onAfterAdd:r,shouldSkipNotification:this._isContextEntity.bind(this,t)}},o={type:"bubble.container",visible:!0,children:[s],options:{target:i,stackName:"quickAdd",zIndex:1e4,within:i.closest(".i-role-board-body"),dontCloseSelectors:["#ui-datepicker-div"],onShow:function(){i.parent().addClass("tau-quick-add_expand")},onHide:function(){i.parent().removeClass("tau-quick-add_expand"),i.tauBubble("destroy")},onPositionConfig:function(e){var t=i.tauBubble("widget").height()<i.offset().top;return{my:t?"left bottom":"left top",at:t?"left-30 top":"left-30 bottom",of:i,within:e.within,collision:this._options.positionConfig.collision}}.bind(this),onArrowPositionConfig:function(e,t){var n={my:"center top",at:"center bottom",of:i,within:e.within,collision:"fit flipfit"};
return"bottom"===t&&(n.my="center bottom",n.at="center top"),n}.bind(this)},componentsConfig:{components:[s]}};this._configurator.getComponentBuilder().createAsChild(o,this._bus).then(function(e){e.fire("initialize",{context:{configurator:this._configurator}}),e.fire("view.dom.ready"),e.fire("$trigger.ready",i)}.bind(this))},onAfterAdd:function(t,i){e.each(i.data,function(e){if(this._isContextEntity(t,e))this._updateContext(e.path,e.dataItem);else{var i=this._getNodeModelByPath(t,e.path);i&&i.nodes&&a.regular.addCard(i,e.dataItem)}},this)},_getNodeModelByPath:function(e,t){var i=e.getRoot();return i.hierarchy.findNodeByPath(t)},_isContextEntity:function(e,t){var i=this._getNodeModelByPath(e,t.path);if(!i||!i.nodes)return!1;var n=t.dataItem.type;return!i.nodes.isCellLevel()&&("Project"===n||"Team"===n)},_updateContext:function(e,t){var i=this._configurator.getAppStateStore(),n=this._configurator.getApplicationContextService();n.appendToContext(t.type,[t.data.cardData.id],i).then(function(){this._eventAggregator.itemAddedToContext.fire({cardId:t.id,hierarchyPath:e})}.bind(this))}})}),define("tau/components/board.new.list/extension.new.list",["tau/components/board.new.list/extension.base.new.list","tau/slice/new.list.factory","tau/components/board.new.list/new.list.quickAdd.component.builder"],function(e,t,i){return e.extend({init:function(e,t,n,a){var r=new i(e.bus,e.context.configurator,a);this._super(e,t,n,a,r)},"bus configurator.ready + boardSettings.ready":function(e,i,n){var a={boardId:n.boardSettings.settings.id},r=new t(i.getSliceFactoryOptions(),a);this.fire("sliceFactory.ready",r)},_initControllerSubscriptions:function(e){this._super(e),e.acidRetrieved.add(function(e){this.fire("acid.ready",e)},this),e.boardSettingsRetrieved.add(function(e){this.fire("board.configuration.ready",e),this.fire("viewMode.ready",e.viewMode)},this),e.definitionReady.add(function(e,t){taus.track({"@":["open-board-action"],boardSettings:t,definition:e})},this)},_initViewSubscriptions:function(e){this._super(e),e.hasDataInSliceChanged.add(function(e){this.fire("board.nodata.status.ready",this._listModel.getIsEmptyObject(e))
},this)},_getAppStateStore:function(){return this._configurator.getAppStateStore()}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.base",["Underscore","jQuery","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/components/extensions/component.extension.base"],function(e,t,i,n,a){return a.extend({appOptions:{},requireApplicationComponent:function(e){var t=this.config.context.configurator.require;t(["all.components"],function(){t(["tau/components/component.application"],e)})},loadCardDetails:function(e){this.fire("view.load.cardDetails",e)},isSupportedCardForView:function(e){return n.isSupportedCardForView(e)},cleanupStore:function(e){e.configurator.getStore().evictData()},"bus start.lifecycle":function(){var e=this;e.requireApplicationComponent(function(t){e.fire("applicationComponent.ready",{component:t})})},"bus start.lifecycle+applicationComponent.ready":function(t,i,n){var a=i.context.configurator.createChild();a._id=e.uniqueId("board_cardView_"),a.isBoardEdition=!0,a.getHashService().setFakeWindow();var r={context:{configurator:a},options:this.appOptions};r.options.comet.enabled=!0;var s=n.component.create(r),o=e.bind(this.fire,this);this.fire("viewerBus.ready",s),s.on("afterRender",function(e){o("viewPort.afterRender",e.data)}),s.on("application.error",function(e){o("view.cardDetails.lastResult",{type:"error",data:e.data})}),s.on("application.navigate",function(){o("view.cardDetails.routing")}),s.on("contentRendered",function(e){o("view.cardDetails.loaded",e.data),o("view.cardDetails.lastResult",{type:"loaded",data:e.data})}),s.initialize(r),this.fire("viewPort.created",{application:s,configurator:a})},"bus view.cardDetails.lastResult":function(e){var t=e.data;"error"===t.type&&this.fire("error",t.data)},"bus view.skeleton.built":function(e){var t=e.data.element;t.on("mousedown",".tau-id",function(e){e.stopPropagation()}),this.subscribe(t)},"bus refresh + viewerBus.ready":function(e,t,i){i.destroy()
},_openProcessDetails:function(e){var t=this.config.context.configurator;t.getTp2Service().showEditProcessPopup(t,e.entityId)},"bus destroy + viewerBus.ready":function(e,t,i){i.destroy()}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.board",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.base","tau/ui/extensions/card.viewer.progress.indicators","tau/configurations/const.page.entity.actions"],function(e,t,i,n,a){return i.extend({appOptions:{applicationId:"boardPopup",integration:{showInCoverView:!0,keepAlive:!0},routing:{silent:!0,executeOnStart:!1},comet:{enabled:!1}},init:function(e){this.progressIndicators=new n,this._super(e)},subscribe:function(i){var n=e.debounce(function(e,i,n){var a=t(e.currentTarget).data();this._openCardDetails(a,i,n)}.bind(this),500,!0);this._subscribeWithClickHandler(i,n)},_subscribeWithClickHandler:function(e,i){e.on("dblclick",".i-role-card",function(e){i(e,t(e.currentTarget),{hover:!0})}),e.on("click",".i-role-cellaxis-viewtrigger",function(e){i(e,t("body"))}),this._subscribeToIdUnitClicks(e,i)},_subscribeToIdUnitClicks:function(e,i){e.on("click",".tau-id",function(e){e.ctrlKey||(e.stopPropagation(),e.preventDefault(),i(e,t("body")))})},_openCardDetails:function(e,t,i){"process"===e.entityType?this._openProcessDetails(e):(this.progressIndicators.show(t,i),this.loadCardDetails(e))},"bus view.cardDetails.lastResult":function(){this.progressIndicators.hideAll()},"bus acid.ready:last + viewPort.created:last + view.load.cardDetails":function(e,t,i,n){this.cleanupStore(i),i.configurator.getBoardCacheService().setData(n.cardData),i.application.fire("history.reset"),i.application.fire("application.navigate.entity",{id:n.entityId,type:n.entityType,acid:t,action:a.SILENT})}})}),define("tau/components/board.new.list/extensions/extension.new.list.cards.viewer",["tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.board"],function(e){return e.extend({_subscribeWithClickHandler:function(e,t){this._subscribeToIdUnitClicks(e,t)
},"bus new.list.open.card.details.view":function(e,t){this._openCardDetails(t.cardData,t.$card)}})}),define("tau/components/board.new.list/templates/template.new.list.stickyHeader",["tau/core/templates-factory"],function(e){var t={name:"new.list.stickyHeader",engine:"jqote2",markup:['<style id="<%=this.id%>">',"#<%= this.containerId %> .tau-board-list-sticky-header {","position: fixed;","width: 100%;","z-index: 22;","top: <%=this.top%>px;","}","#<%= this.containerId %> .tau-board-list-sticky-header + .i-role-cardsholder {","margin-top: 27px;","}","</style>"]};return e.register(t)}),define("tau/components/board.new.list/views/stickyHeaderBehavior",["jQuery","Underscore","tau/core/class","tau/components/board.new.list/templates/template.new.list.stickyHeader","tau/components/board.new.list/views/units/nameUnit"],function(e,t,i,n,a){return i.extend({CLASS_MAP:{headerHolder:"i-role-headerholder",stickyHeader:"tau-board-list-sticky-header"},_$currentLevel:null,init:function(e){this._headerHolderSelector="."+this.CLASS_MAP.headerHolder,this._globalBus=e.configurator.getGlobalBus(),this._eventAggregator=e.eventAggregator,this._skeletonView=e.skeletonView,this._boardSettings=e.modelSettings.listSettings.boardSettingsService,this._$el=e.skeletonView.$el,this._$container=this._$el.find(".tau-board-list-view__inner"),this._containerId=this._$el.attr("id"),this._styleId="stickyListStyles-"+this._containerId,this._currentOffsets={innerContainer:{},container:{}}},_appendStyle:function(e){this._$el.append(n.render(e))},_removeStyle:function(){this._$el.find("#"+this._styleId).remove()},_findHeaderHolders:function(e){return e=e||this._$el,e.find(this._headerHolderSelector)},_unStickHeader:function(){this._$currentLevel=null,this._findHeaderHolders().removeClass(this.CLASS_MAP.stickyHeader).removeClass("invisible")},_stickHeader:function(t){var i=t||this._currentOffsets.container,n=i.left+this._pointFirstCard.left,a=i.top+this._pointFirstCard.top,r=document.elementFromPoint(Math.ceil(n),Math.ceil(a)),s=e(r);
if(!s.closest(this._headerHolderSelector).length){var o=s.closest(".tau-list-level");o!==this._$currentLevel&&(this._unStickHeader(),this._$currentLevel=o,this._findHeaderHolders(o).eq(0).addClass(this.CLASS_MAP.stickyHeader).removeClass("invisible"),this._currentOffsets.container.top!==i.top&&(this._currentOffsets.container=i,this._removeStyle(),this._appendStyle({id:this._styleId,containerId:this._containerId,top:this._currentOffsets.innerContainer.top})))}},_toggleStickHeader:function(){this._$container[0].scrollTop&&0===this._$container[0].scrollLeft?this._stickHeader():this._unStickHeader()},_attachStickyHeader:function(){var e=this._findHeaderHolders().find(".tau-name-cell")[0];if(e){var i=e.getBoundingClientRect();this._pointFirstCard={top:i.bottom-this._$el.offset().top+10,left:i.left+a.prototype.MIN_UNIT_WIDTH-20},this._setupOffset();var n=this._toggleStickHeader.bind(this);this._skeletonView.treeViewCreated.add(function(){t.defer(n)}.bind(this)),this._boardSettings.unbind(this),this._boardSettings.bind({fields:["edit"],listener:this,callback:this._adjustStickyHeader.bind(this)}),this._$container.on("scroll",t.throttle(n,100)),this._globalBus.unbind(this),this._globalBus.on("tab.activate.completed",this._adjustStickyHeader,this)}},_adjustStickyHeader:function(){this._findHeaderHolders().filter("."+this.CLASS_MAP.stickyHeader).addClass("invisible"),t.delay(this._setupOffset.bind(this),300)},_setupOffset:function(){this._currentOffsets.innerContainer=this._$container.offset(),this._stickHeader(this._$el.offset()),this._toggleStickHeader()},attach:function(){this._eventAggregator.treeRendered.once(this._attachStickyHeader,this)},destroy:function(){this._boardSettings.unbind(this),this._globalBus.unbind(this),this._removeStyle()}})}),define("tau/components/board.new.list/extensions/extension.new.list.comet",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus slice.ready":function(e,t){this.fire("comet.parameters",t.slice.getCometParameters())
}})}),define("tau/components/component.board.new.list",["tau/components/component.board.plus.base","tau/components/component.base.new.list","tau/components/board.new.list/extension.new.list","tau/components/board.new.list/extensions/extension.new.list.cards.viewer","tau/components/board.new.list/views/stickyHeaderBehavior","tau/components/board.new.list/extensions/extension.new.list.comet"],function(e,t,i,n,a,r){return{create:function(s){var o=t.createNewListConfig(_.extend(s,{notificationsHubName:"slice-newlist"}));return s.behaviors=t.getDefaultBehaviors().concat([a]),o.extensions=[{extType:i,args:[o.newList.model,o.newList.view,o.newList.busEventAggregator]},n,r].concat(o.extensions),e.create(o,s)}}}),define("tau/models/board.overview/model.board.overview",["Underscore","tau/core/extension.base"],function(e,t){var i=t.extend({"bus beforeInit":function(t,i){this.fire("dataBind",{viewMode:"board"});var n=i.config.context.configurator,a=e.defaults(i.config,{boardName:"board_plus"});this.fire("options.ready",a),this.fire("configurator.ready",n)},"bus options.ready:last + configurator.ready:last + boardSettings.ready":function(t,i,n){n.getComponentBusRegistry().getByName(i.boardName,e.bind(function(e){this.fire("boardBus.ready",e)},this))},"bus boardBus.ready":function(e,t){var i=this;t.removeAllListeners(this),t.on("overview.board.retrieved",function(e,t){i.fire("$boardEl.ready",t),i.fire("$boardGrid.ready",t.find(".i-role-grid"))},this),t.on("overview.board.updated",function(e,t){i.fire("$boardEl.ready",t),i.fire("$boardGrid.ready",t.find(".i-role-grid"))},this),t.fire("overview.board.retrieve")},"bus boardBus.ready > destroy":function(e,t){t.removeAllListeners(this)}});return i}),define("tau/ui/extensions/board.overview/ui.extension.board.overview",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus beforeInit + view.dom.ready":function(){var e=t('<div style="overflow:scroll;width:30px;">s g s e l e m e n t s f s e </div>');t("body").append(e),this.scrollWidth=e.width()-e[0].clientWidth,e.remove();
var i=this;Array.prototype.map?require(["libs/d3/d3"],function(e){i.fire("draw.ready",e)}):i.fire("draw.ready",!1)},"bus $boardGrid.ready":function(t,i){i.unbind("scroll.overview"),i.bind("scroll.overview",e.bind(function(){this.fire("visiblerPosition.update")},this))},"bus $el.ready:last + $boardGrid.ready:last + svg.ready:last + visiblerPosition.update":function(e,t,i){var n={x:i.scrollLeft(),y:i.scrollTop()},a=Math.max(0,Math.min(this.maxVisiblerOrigin.x,n.x/this.verticalProportion)),r=Math.max(0,Math.min(this.maxVisiblerOrigin.y,n.y/this.horizontalProportion));t.find(".tau-boardoverview__visibler").attr("x",a).attr("y",r).data([{x:a,y:r}])},"bus afterRender":function(e,t){this.fire("$el.ready",t.element)},"bus options.ready:last + draw.ready:last + $el.ready:last + $boardEl.ready":function(t,i,n,a,r){if(n){var s={width:i.width,height:i.height,$boardElement:r},o=a.find("[role=holder]");this.drawOverview(o,s).done(e.bind(function(e){this.fire("svg.ready",e)},this))}},drawOverview:function(i,n){var a=t.Deferred(),r=i.find("svg");i.toggleClass("tau-boardoverview__holder_state_redraw",!0);var s=e.defaults(n,{width:t.ui.ie?206:207,height:400}),o=this.draw(i,s)[0];return i.toggleClass("tau-boardoverview__holder_state_redraw",!1),r.remove(),a.resolve(o)},getGridMetrics:function(e){var i=t(e).find("table"),n=i[0],a={w:i.width(),h:i.height()},r={contentSize:{width:a.w,height:a.h},clientSize:{width:Math.min(e.clientWidth,n.clientWidth),height:Math.min(e.clientHeight,n.clientHeight)}};return r},getViewMetrics:function(e,t){var i={w:e.width,h:e.height},n=i.w,a=this.getGridMetrics(t),r=this.verticalProportion=this.horizontalProportion=a.contentSize.width/n,s=Math.ceil(a.contentSize.height/r),o={clientSize:{width:e.width,height:Math.min(e.height,s)},contentSize:{width:Math.ceil(a.contentSize.width/r),height:s},selectorSize:{width:Math.ceil(a.clientSize.width/r),height:Math.ceil(a.clientSize.height/r)}};return{width:n,verticalProportion:r,horizontalProportion:r,overviewMetrics:o}
},getFitsViewMetrics:function(t,i){var n=this.getGridMetrics(i);this.horizontalProportion=n.contentSize.width/t.width,this.veticalProportion=n.contentSize.height/t.height;var a={clientSize:e.clone(t),contentSize:e.clone(t),selectorSize:{width:Math.ceil(n.clientSize.width/this.horizontalProportion),height:Math.ceil(n.clientSize.height/this.veticalProportion)}};return{width:t.width,verticalProportion:this.veticalProportion,horizontalProportion:this.horizontalProportion,overviewMetrics:a}},draw:function(i,n){{var a=n.$boardElement,r=a.find(".i-role-grid"),s=r[0],o=r.find("table");o[0]}if(o=o.length?o:r.children().eq(0),!o.length)return!1;n=e.clone(n);var l=this.scrollWidth,u=this.getViewMetrics(n,s),c=u.overviewMetrics.clientSize.height,d=c>=u.overviewMetrics.contentSize.height;0==d?(n.width-=l+(l>0?1:0),u=this.getViewMetrics(n,s),c>u.overviewMetrics.clientSize.height&&(n.width+=l,u=this.getFitsViewMetrics(n,s),l=0)):l=0,c=u.overviewMetrics.clientSize.height;var p=this.getData(a),f=(u.width,u.verticalProportion),m=u.horizontalProportion,h=u.overviewMetrics,g=h.selectorSize;i.parent().width(n.width+l+(t.ui.ie?1:0)),i.width(h.clientSize.width),i.parent().height(c+2);var v=function(t){return e.isNaN(t)?0:t},b=d3.select(i[0]).append("svg").attr("class","tau-boardoverview__chart").attr("width",v(h.clientSize.width)).attr("height",v(h.contentSize.height)),y=0,_=0,x=0,w=this.maxVisiblerOrigin={x:h.contentSize.width-g.width,y:h.contentSize.height-g.height};e.forEach(p.rows,function(t){var i=t.height/f;y=0,e.forEach(t.cells,function(t){var n=t.width/m;b.append("rect").attr("class","tau-boardoverview__cell").attr("width",v(n)).attr("height",v(i)).attr("x",v(y)).attr("y",v(_)),e.forEach(t.cards,function(e){{var t="tau-boardoverview__card-"+e.type.toLowerCase(),i=e.width/m,n=e.height/f;b.append("rect").attr("class","tau-boardoverview__card "+t).attr("width",v(i)).attr("height",v(n)).attr("x",v(e.offsetLeft/m)).attr("y",v(e.offsetTop/f))}}),y+=n}),x+=t.height,_=x/f});var C={x:s.scrollLeft/m,y:s.scrollTop/f},S=b.append("rect").data([{x:C.x,y:C.y}]).attr("class","tau-boardoverview__visibler").attr("width",v(h.selectorSize.width)).attr("height",v(h.selectorSize.height)).attr("x",function(e){return v(e.x)
}).attr("y",function(e){return v(e.y)}),T=function(){var e=d3.mouse(b[0][0]),t=Math.max(0,Math.min(w.x,e[0]-g.width/2)),i=Math.max(0,Math.min(w.y,e[1]-g.height/2));S.attr("x",v(t)).attr("y",v(i)).data([{x:t,y:i}]);var n=t*m,a=i*f;s.scrollLeft=n,s.scrollTop=a};b.on("click",T);var k=function(e){var t=Math.max(0,Math.min(w.x,d3.event.x)),i=Math.max(0,Math.min(w.y,d3.event.y));S.attr("x",e.x=v(t)).attr("y",e.y=v(i))},I=function(){var e=S.attr("x"),t=S.attr("y"),i=e*m,n=t*f;s.scrollLeft=i,s.scrollTop=n},D=d3.behavior.drag().origin(Object).on("drag",k).on("dragend",I);return S.call(D),b},getData:function(i){var n=function(t,i){var n=getComputedStyle(t)[i];return e.isNaN(n)?0:parseInt(getComputedStyle(t)[i],10)},a={rows:[],colNum:0,rowNum:0},r=i.find(".i-role-grid"),s=r.find("tr");return s=s.length?s:r.find(".i-role-cellholder"),s.each(function(){var e={height:this.clientHeight||t(this).height(),cells:[]};a.rows.push(e);var i=t(".i-role-cellholder",this);i=i.length?i:t(this),i.each(function(){if(!this.getAttribute("data-is-hidden")){var i=n(this,"width");if("none"!=t(this).css("display")){var a={width:i,cards:[]};e.cells.push(a),t(".i-role-card",this).each(function(){a.cards.push({id:this.id,type:this.getAttribute("data-entity-type").toLowerCase(),offsetLeft:this.offsetLeft+(this.offsetParent?this.offsetParent.offsetLeft:0),offsetTop:this.offsetTop+(this.offsetParent?this.offsetParent.offsetTop:0),width:n(this,"width"),height:n(this,"height")})})}}})}),a.rows.length&&(a.colNum=i.find(".i-role-header[data-dimension=x] .i-role-cellholder:not([data-is-hidden=1])").length,a.rowNum=i.find(".i-role-header[data-dimension=y] .i-role-cellholder:not([data-is-hidden=1])").length),a}})}),define("tau/ui/templates/board.overview/ui.template.board.overview",["tau/core/templates-factory"],function(e){var t={name:"board.overview",engine:"jqote2",markup:['<% if (this.viewMode == "board"){ %>','<div class="tau-boardoverview <% if (this.isCollapsed == false) { %>tau-boardoverview_active_true<% } %>">','<div role="holder" class="tau-boardoverview__holder">',"</div>","</div>","<% } else { %>","<div></div>","<% } %>"],dependencies:[]};
return e.register(t)}),define("tau/components/component.board.overview",["Underscore","tau/components/component.creator","tau/models/board.overview/model.board.overview","tau/ui/extensions/board.overview/ui.extension.board.overview","tau/ui/templates/board.overview/ui.template.board.overview"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[i,n],template:a};return t.create(r,e)}}}),define("tau/models/board.owner/model.board.owner",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterInit":function(e,t){this.fire("configurator.ready",t.config.context.configurator)},"bus boardSettings.ready:last + configurator.ready":function(t,i){i.boardSettings.get({fields:["ownerIds"],callback:e.bind(function(e){this.fire("ownerIds.ready",{ownerIds:e.ownerIds})},this)})},"bus configurator.ready:last + ownerIds.ready":function(t,i,n){i.getStore().find("user",{$query:{id:{$in:n.ownerIds},deleteDate:{$isNull:!0}},fields:["id","firstName","lastName","avatarUri","email"]}).done({success:e.bind(function(e){var t=e[0].data;this._dataBind(t,n,i)},this),failure:e.bind(function(){this._dataBind([],n,i)},this)})},_dataBind:function(e,t,i){var n=this._createViewModel(e,t.ownerIds,i.getLoggedUser());this.fire("dataBind",n)},_createViewModel:function(t,i,n){var a=e.bind(function(e,t){return t==e},this,n.id),r=1===t.length,s=n.isAdministrator||e.some(i,a),o=e.map(t,function(t){return{displayName:(e.trim([t.firstName,t.lastName].join(" "))||t.email).replace(/\s/g,"&nbsp;"),avatarUri:t.avatarUri,canBeDeleted:s&&!a(t.id)&&!r,userId:t.id}});return{canBeAdded:s,owners:e.sortBy(o,function(t){return e.indexOf(i,t.userId)})}}})}),define("tau/ui/extensions/board.owner/ui.extension.board.owner",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus boardSettings.ready + afterRender":function(e,t,i){var n=this._getBubbleConfig(i.element,t);this.fire("initBubble",n)},"bus initBubble:last + afterRender":function(e,t,i){i.element.tauBubble("adjust")
},_getBubbleConfig:function(e,t){var i=function(){e.toggleClass("tau-checked")};return{target:e,alignTo:e.find(".i-role-owners-wrap"),applyBubbleClasses:!1,zIndex:999,componentsConfig:{components:[{type:"board.owner.list",data:{boardSettingsArg:t}}],context:this.config.context},onShow:i,onHide:i,className:"tau-owners-bubble",stackName:"boardOwnerList"}}})}),define("tau/ui/extensions/board.owner/ui.extension.board.owner.refresher",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus boardSettings.ready":function(t,i){var n=i.boardSettings;n.unbind({listener:this}),n.bind({listener:this,fields:["ownerIds"],callback:e.bind(function(){this.fire("refresh",{refreshSelector:".i-role-owners"})},this)})},"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})}})}),define("tau/ui/extensions/board.tooltip/ui.extension.board.tooltip",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return e.widget("ui.tauBubbleTooltip",e.ui.tauBubble,{}),t.extend({_initTooltip:function(e){e.tauBubbleTooltip({content:"<span>"+e.data("title")+"</span>",zIndex:999,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),className:"tau-bubble-tooltip",showEvent:"mouseenter",hideEvent:"mouseleave mousedown",mode:"tooltip",stackName:"tooltip",delay:500,onPositionConfig:this._tooltipPositionConfig,onArrowPositionConfig:this._tooltipPositionConfig,onBeforeShow:this._tooltipBeforeShow})},_tooltipPositionConfig:function(e){e.at="center bottom-1",e.my="center top"},_tooltipBeforeShow:function(){var e=this.$target,t=e.data("title"),i=e.data("collapsed-selector")||".tau-collapsed";if(e.is(i)){var n=e.data("title-collapsed");n&&(t=n)}var a=e.data("expanded-selector")||".tau-expanded";if(e.is(a)){var r=e.data("title-expanded");r&&(t=r)}return t?void this.option("content","<span>"+t+"</span>"):!1
},"bus afterRender":function(){var t=this,i=function(i){var n=e(i.currentTarget);n.data("ui-tauBubbleTooltip")||(t._initTooltip(n),n.trigger("mouseenter"))};e(document).on("mouseenter.tooltip",".tau-extension-board-tooltip",i);var n=function(t){e(t.currentTarget).closest(".tau-template-item__inner").trigger("mouseleave")};e(document).on("mouseenter.tooltip",".tau-extension-board-tooltip-inner",n);var a=function(t){e(t.currentTarget).closest(".tau-template-item__inner").trigger("mouseenter")};e(document).on("mouseleave.tooltip",".tau-extension-board-tooltip-inner",a),this.on("destroy",function(){e(document).on("mouseenter.tooltip",".tau-extension-board-tooltip",i),e(document).off("mouseenter.tooltip",".tau-extension-board-tooltip-inner",n),e(document).off("mouseleave.tooltip",".tau-extension-board-tooltip-inner",a)})}})}),define("tau/ui/templates/board.owner/ui.template.board.owner",["tau/core/templates-factory"],function(e){var t={name:"board.owner",engine:"jqote2",markup:['<button class="tau-btn tau-board-owner">','<span class="tau-label">View owners</span>','<span class="tau-owners-wrap i-role-owners-wrap">','<span class="i-role-owners">',"<% _.each(_.first(this.owners, 3), function(owner) { %>",'<img src="<%! owner.avatarUri %>20" class="tau-extension-board-tooltip" data-title="<%! owner.displayName %>" />',"<% }); %>","</span>","</span>","</button>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.owner",["Underscore","tau/components/component.creator","tau/models/board.owner/model.board.owner","tau/ui/extensions/board.owner/ui.extension.board.owner","tau/ui/extensions/board.owner/ui.extension.board.owner.refresher","tau/ui/extensions/board.tooltip/ui.extension.board.tooltip","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/board.owner/ui.template.board.owner"],function(e,t,i,n,a,r,s,o,l){return{create:function(e){var u={extensions:[i,n,a,r,s,o],template:l};
return t.create(u,e)}}}),define("tau/models/board.owner/model.board.owner.list",["tau/models/board.owner/model.board.owner"],function(e){return e.extend({"bus afterInit":function(e,t){this._super(e,t),this.fire("boardSettings.ready",t.config.data.boardSettingsArg)}})}),define("tau/ui/extensions/board.owner/ui.extension.board.owner.list",["Underscore","jQuery","tau/core/extension.base","tau/libs/store2/store2","tau/ui/extensions/user/jquery.tauUserAutocomplete"],function(e,t,i,n){return i.extend({"bus ownerIds.ready":function(e,t){this.ownerIds=t.ownerIds},"bus configurator.ready:last + boardSettings.ready:last + afterRender":function(e,t,i,n){var a=i.boardSettings;this._bindDelete(a,n.element),this._bindAdd(t,a,n.element)},_bindDelete:function(i,n){n.filter(":not(.i-role-delete-bound)").on("click",".i-role-delete",e.bind(function(n){var a=t(n.target).data("userid");this._updateOwners(i,function(t){return e.without(t,a)})},this)).addClass("i-role-delete-bound")},_bindAdd:function(t,i,a){var r=a.find(".i-role-add");r.data("tauuserautocomplete")||r.tauUserAutocomplete({position:{my:"right top",at:"right bottom+5",collision:"none"},store2:new n(t),rejectUserIdsGetter:e.bind(this._rejectUserIdsGetter,this),open:function(){t.getKeyBoardManager().pushHandler({})},close:function(){t.getKeyBoardManager().popHandler()},select:e.bind(function(e,t){this._updateOwners(i,function(e){return e.push(t.item.id),e})},this)})},_updateOwners:function(t,i){t.get({fields:["ownerIds"],callback:e.bind(function(e){t.set({set:{ownerIds:i(e.ownerIds)}})},this)})},_rejectUserIdsGetter:function(){return this.ownerIds}})}),define("tau/ui/templates/board.owner/ui.template.board.owner.list",["tau/core/templates-factory"],function(e){var t={name:"board.owner.list",engine:"jqote2",markup:["<div>",'<ul class="tau-owners i-role-owners">',"<% _.each(this.owners, function(owner) { %>",'<li class="tau-menu-item">','<img src="<%! owner.avatarUri %>20" class="tau-extension-board-tooltip" data-title="<%! owner.displayName %>" />',"<span><%! owner.displayName %></span>","<% if (owner.canBeDeleted) { %>",'<i class="tau-delete i-role-delete" data-userId="<%! owner.userId %>"><!-- --></i>',"<% } %>","</li>","<% }); %>","</ul>","<% if (this.canBeAdded) { %>",'<div class="tau-invite-wrap i-role-add-wrap">','<input type="text" class="tau-in-text i-role-add" placeholder="Add owner">',"</div>","<% } %>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/components/component.board.owner.list",["tau/components/component.creator","tau/models/board.owner/model.board.owner.list","tau/ui/extensions/board.owner/ui.extension.board.owner.list","tau/ui/extensions/board.owner/ui.extension.board.owner.refresher","tau/ui/extensions/board.tooltip/ui.extension.board.tooltip","tau/ui/templates/board.owner/ui.template.board.owner.list"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[t,i,n,a],template:r};return e.create(o,s)}}}),define("tau/models/board.paging/model.board.paging",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({"bus afterInit":function(t,i){var n=i.config,a=i.config.context.configurator;this.fire("configurator.ready",a),a.getComponentBusRegistry().getByName(n.boardName).done(e.bind(function(e){this.fire("boardBus.ready",e)},this))},"bus boardBus.ready":function(t,i){var n=e.bind(this.fire,this),a=function(e){return function(t){n(e||t.name,t.data)}};i.removeAllListeners(this),i.on("board.paging.settings",a("pagingData.ready"),this),i.on("board.paging.settings.retrieved",a("pagingData.retrieved"),this),i.on("page.move.to",a("refresh"),this),i.fire("board.paging.settings.retrieve",{})},"bus pagingData.retrieved":function(e,t){var i=this._calculatePaging(t);this.fire("dataBind",i),this.fire("paging.ready",i)},"bus paging.ready:last + pagingData.ready":function(e,t,i){var n=this._calculatePaging(i);(t.pagesX!=n.pagesX||t.pagesY!=n.pagesY)&&this.fire("refresh")},"bus boardBus.ready:last+page.switched":function(e,t,i){t.fire("page.switched",i)},"bus boardBus.ready+destroy":function(e,t){t.removeAllListeners(this)},_calculatePaging:function(e){var t={pagesX:e.x.totalPages||1,pagesY:e.y.totalPages||1,current:e.page};return t}});return i}),define("tau/ui/extensions/board.paging/ui.extension.board.paging",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var i=e.data.element,n=this;i.delegate(".i-role-page","click",function(){var e=t(this),a=e.data(),r={x:a.x,y:a.y};
i.find(".i-role-page").removeClass("tau-boardpaging__page_current_true"),e.addClass("tau-boardpaging__page_current_true"),n.fire("page.switched",r)})}})}),define("tau/ui/templates/board.paging/ui.template.board.paging",["tau/core/templates-factory"],function(e){var t={name:"board.paging",engine:"jqote2",markup:['<div class="tau-boardpaging">','<div class="tau-boardpaging__holder">',"<% if (this.pagesY > 1 || this.pagesX > 1){ %>","<table>","<% for (var y=0; y<this.pagesY; y++){ %>","<tr>","<% for (var x=0; x<this.pagesX; x++){ %>",'<td class="tau-boardpaging__page i-role-page',"<% if (this.current.x == x && this.current.y == y){ %>"," tau-boardpaging__page_current_true","<% } %>",'" data-x="<%= x %>" data-y="<%= y %>">',"</td>","<% } %>","</tr>","<% } %>","</table>","<% } %>","</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.paging",["Underscore","tau/components/component.creator","tau/models/board.paging/model.board.paging","tau/ui/extensions/board.paging/ui.extension.board.paging","tau/ui/templates/board.paging/ui.template.board.paging"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[i,n],template:a};return t.create(r,e)}}}),define("tau/ui/extensions/board.plus.container/ui.extension.board.plus.container.view",["Underscore","jQuery","tau/views/view.container"],function(e,t,i){return i.extend({"bus initialize":function(e,t){this.fire("configurator.ready",t.context.configurator)},"bus initialize + boardSettings.ready + configurator.ready":function(e,t,i,n){this.startLifeCycle(t,i.boardSettings,n)},"bus refresh":function(){this.destroyChildren(),this.startLifeCycle()},"bus beforeInit + boardSettings.ready":function(t,i,n){var a=n.boardSettings;a.unbind({listener:this}),a.bind({fields:["viewMode"],listener:this,callback:e.bind(this.fire,this,"refresh")})},startLifeCycle:function(t,i,n){i=i||this.boardSettings,n=n||this.configurator,this.setDefaultConfig(),e.extend(this.config,(t||{}).data),this.boardSettings=i,this.configurator=n,this.children=[],i.get({fields:["viewMode"],callback:e.bind(function(t){var i=t.viewMode,n=e.filter(this.config.children,function(e){return e.viewMode==i
});this.fire("beforeInit",{config:this.config});var a=e.isArray(n)&&e.size(n)>0&&this.config.visible;if(a){var r=this.config.context||{};this.fire("createComponents",{components:n,context:r})}else this.completeInitializationWithoutChildren()},this)})}})}),define("tau/components/component.board.plus.container",["Underscore","tau/components/component.container","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.plus.container/ui.extension.board.plus.container.view"],function(e,t,i,n){return{create:function(a){a.queuedBus=!1;var r={extensions:[i],ViewType:n,template:{engine:"jqote2",name:"board.plus.container",markup:'<div class="tau-board-body-wrapper"></div>'}};return t.create(e.extend(a,r))}}}),define("tau/ui/extensions/board.plus/ui.board.plus.domWrapper.collapser",["Underscore","jQuery"],function(e,t){var i={__getAxisCellHolderSelectors:function(){return[".i-role-header .i-role-cellholder"]},__getXHeaderCollapserSelector:function(){return".tau-x-header .i-role-collapser"},__getAxisCollapserSelector:function(){return".i-role-header .i-role-collapser"},__getParentCellHolder:function(e){return e.closest(".i-role-cellholder")},iterateHeadersItems:function(e){var i=this.__getAxisCellHolderSelectors().join(","),n=this.board.find(i);n.each(function(){var i=t(this),n=i.attr("data-x")?"x":"y",a=i.attr("data-"+n);e({dimension:n,value:a})})},subscribeToAxisCollapser:function(e){var i=this,n=this.board,a=this.__getAxisCollapserSelector();n.on("click",a,function(){var n=i.__getParentCellHolder(t(this)),a=n.attr("data-x")?"x":"y",r=n.attr("data-"+a),s=n.hasClass("tau-collapsed")?"expand":"collapse",o={dimension:a,dimensionId:r,action:s};e(o)})},subscribeToXHeaderCollapser:function(e){var i=this.board;i.on("click",this.__getXHeaderCollapserSelector(),function(){var i=t(this),n=i.hasClass("tau-collapsed")?"expand":"collapse",a={dimension:"axisY",dimensionId:0,action:n};e(a)})},toggleHeaderCollapsing:function(){var e=this.board.find(this.__getXHeaderCollapserSelector());
e.toggleClass("tau-collapsed").closest(".i-role-board-body-holder").toggleClass("rows-h-collapsed")},expandAxis:function(e){var i=e.x?"x":"y",n=this.getCellHoldersAxisLineBySliceCoordinates(e);n.removeClass("tau-collapsed_"+i),n.each(function(){var e=t(this);e.hasClass("tau-collapsed_x")||e.hasClass("tau-collapsed_y")||e.removeClass("tau-collapsed")})},collapseAxis:function(e){var t=e.x?"x":"y",i=this.getCellHoldersAxisLineBySliceCoordinates(e);i.addClass("tau-collapsed_"+t),i.addClass("tau-collapsed")},_expandCell:function(e,t){t.setting="expand",e.fire("board.save.header.collapsing.settings",t)},expandCell:function(e,t,i){e.fire("view.axis.collapser.executed.before"),t&&this.expandAxis({x:t}),i&&this.expandAxis({y:i}),e.fire("view.axis.collapser.executed.after"),t&&this._expandCell(e,{id:t,dimension:"x"}),i&&this._expandCell(e,{id:i,dimension:"y"})}};return i}),define("tau/ui/extensions/board.plus/ui.board.plus.domWrapper",["Underscore","jQuery","tau/core/class","tau/core/event","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/extensions/board.plus/ui.board.plus.domWrapper.collapser","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/core/termProcessor"],function(e,t,i,n,a,r,s,o){var l={cardLayoutFactory:null,cardTemplateName:"board.plus.default.card.customized",init:function(e,t,i,n){this.$el=e,this.board=e,this.grid=this.board.find("#"+this.board.attr("id")+"_grid"),this.urlBuilder=n.getUrlBuilder(),this.templateFactory=n.getTemplateFactory(),this.featuresService=n.getFeaturesService(),this.configurator=n,this.termProcessor=new o,this.definition=t,this.metainfo=i},ANIMATION_CARD_UPDATED:"tau-operation_card_updated",animateWithClass:function(e,t){return s.animated(t,e)},getCellPagingMore:function(e){return e.siblings(".i-role-cell-paging-more")},executeAxisLineUpdate:function(e,t){for(var i=t.suspendAnimation?"":"tau-operation_axis_updated",n=0,a=e.length;a>n;n++){var r=e[n],s=r.$cardEx,o=r.$cardNV;s.replaceWith(o),this.animateWithClass(i,o)}},executeAxisLineRemove:function(e,i){if(e.length){var n=e.find("*");
n.each(function(){var e=t(this);e.removeProp("checked"),e.prop("disabled",!0);var i=e.attr("class")||"",n=i.replace(/i-role-/gi,"i-disabled-role-");e.attr("class",n)}),this.getCellPagingMore(i).remove(),i.find(".i-role-card").remove();var a=e.add(i);a.each(function(){var e=t(this),i=e.attr("class")||"";i=i.replace(/i-role-(?!cell\b)/gi,"tau-disabled-role-"),e.attr("class",i).addClass("tau-cellaxis__removed").css("opacity",.3);var n=e.parent(".i-role-cellholder"),a=n.attr("class")||"";a=a.replace(/i-role-(?!cellholder\b)/gi,"tau-disabled-role-").replace(/tau-selected/gi,"tau-disabled-selected"),n.attr("class",a)})}},executeRemove:function(e,i){var n=this,a=t.Deferred();if(e.length){var r=i.suspendAnimation?"":"tau-operation_card_deleted";e.removeClass("i-role-card"),this.animateWithClass(r,e).done(function(){n.executeClear(e),a.resolve()})}else a.reject();return a},executeClear:function(e){this.fire("beforeRemoveCards",e),e.remove()},executeUpdate:function(t,i){return e.map(t,e.bind(function(e){var t=e.$cardEx,n=e.$cardNV;return this.fire("beforeRemoveCards",t),t.replaceWith(n),i.suspendAnimation||t.text()===n.text()||this.animateWithClass(this.ANIMATION_CARD_UPDATED,n),n},this))},replaceCardsFastMethod:function(e,t,i){var n,a=t.first().prev();if(a.size()>0)n=function(){a.after(i)};else{var r=t.last().next();n=r.size()>0?function(){r.before(i)}:function(){e.append(i)}}t.remove(),n()},_isDescOrdering:function(){var e=this.definition.cells.ordering;if(e&&e.direction){var t=e.direction.toLowerCase()||"desc";return"desc"===t}return!0},compareOrderings:function(e,t){if(!this.metainfo.isPrioritizable)return 0;var i=parseFloat(e),n=parseFloat(t);return this._isDescOrdering()?i-n:n-i},insert$cardTo$cell:function(e,t,i){var n=e.data("orderingValue"),a=this.getCellPagingMore(t);if(a.size()>0){var r=a.data("nextOrderingValue");if(this.compareOrderings(n,r)>0)return i?(e.appendTo(a),e):null}var s=this.findPriorityPredecessor(n,t);return s.before(e),e},executeAppend:function(e,t){for(var i=t.suspendAnimation?"":"tau-operation_card_added",n=[],a=0,r=e.length;r>a;a++){var s=e[a],o=s.$card,l=this.insert$cardTo$cell(o,s.$cell,t.forceAppend);
l&&n.push(l),this.animateWithClass(i,o)}return n},findPriorityPredecessor:function(i,n){var a={stub:!0,before:function(e){n.append(e)}},r=n.find(".i-role-card");return e.chain(r).map(function(e){return t(e)}).filter(e.bind(function(e){return this.compareOrderings(i,e.data("orderingValue"))<0},this)).first().value()||a},isListMode:function(){return this.isNewListMode()||"list"==this.definition.viewMode},isNewListMode:function(){return"newlist"==this.definition.viewMode},cellHasCards:function(e){var i=t(e).find(".i-role-card");return i.length>0},getCellsEmptyStatuses:function(i){var n=this,a=e.reduce(t(i),function(e,t){return e.push({$cell:t,emptyBeforeAdd:!n.cellHasCards(t)}),e},[]);return a},getCardBySliceId:function(e){return this.getCardBySliceIdInTarget(e,this.grid)},getCardBySliceIdInTarget:function(e,t){return t.find(".i-role-card[data-id="+e+"]")},getCellHoldersBySliceCoordinatesInTarget:function(t,i){var n=e.map(t,function(e,t){return"[data-"+t+"="+e+"]"});return i.find(".i-role-cellholder"+n.join(""))},getCellHoldersAxisLineBySliceCoordinates:function(e){return this.getCellHoldersBySliceCoordinatesInTarget(e,this.board)},getCellsBySliceCoordinatesInTarget:function(t,i){var n=e.map(t,function(e,t){return"[data-"+t+"="+e+"]"});return i.find(".i-role-cell"+n.join(""))},getCellsAxisLineBySliceCoordinates:function(e){return this.getCellsBySliceCoordinatesInTarget(e,this.board)},getAxesHeaders:function(e){var t=".i-role-header";return e&&(t+="[data-dimension="+e+"]"),this.board.find(t)},getAxesCells:function(){return this.board.find(".i-role-header .i-role-cell")},updateAxisCellMetaInfo:function(e,i,n){var a=e.children(".tau-cards-count"),r=i.limit,s=i.count,o=i.title,l=i.dimension,u="";r==s&&(u="tau-axis-limit_warning_"+l),s>r&&(u="tau-axis-limit_overhead_"+l),""===r&&(u="tau-axis-limit_"+l);var c=n.closest(".i-role-cellholder");c.removeClass("tau-axis-limit_"+l+" tau-axis-limit_warning_"+l+" tau-axis-limit_overhead_"+l),c.addClass(u);var d;a.length?d=a.text():(a=t('<div class="tau-axiscell__item tau-cards-count"></div>'),e.append(a),d="");
var p=""===r?"":" of "+r,f=s+p;return f!=d&&a.html("<span>"+f+"</span>"),a.attr("title",o),a},updateAxesMetaInfo:function(i,n){var a=function(t){var a=e.find(i,function(e){return e.x==t.x&&e.y==t.y}),r=e.reduce(n,function(i,n){var a=parseInt(n[t.x],10),r=parseInt(n[t.y],10);return i="",e.isNumber(a)&&!e.isNaN(a)?i=a:e.isNumber(r)&&!e.isNaN(r)&&(i=r),i},""),s={count:0,title:"",limit:r,dimension:t.x&&"x"||t.y&&"y"};return a&&(s=e.reduce(a.counts,function(e,t){e.count+=t.count;var i=e.title?" / ":"",n=t.title||this.termProcessor.getTerm(t.type,"names");return e.title+=i+n+": "+t.count,e}.bind(this),s)),s}.bind(this),r=this.getAxesCells();e.each(r,function(i){var n=t(i),r=e.pick(n.data(),"x","y"),s=a(r),o=this.getCellsAxisLineBySliceCoordinates(r),l=this.updateAxisCellMetaInfo(n,s,o);l.toggle(s.count>0||""!==s.limit)},this)},getCardByPositionOrLast:function(e){var t=this.board.find(".i-role-card");return e<t.size()?t.eq(e):t.last()},getGrid:function(){return this.grid},getCards:function(){return this.getGrid().find(".i-role-card")},getCells:function(){return this.getGrid().find(".i-role-cell")},hasDataItemInCoordinates:function(e,t){var i=this.getCellHolderByCoordinates(t),n=this.getCardBySliceIdInTarget(e.id,i);return 0!==n.size()},applyCellPagingUpdate:function(e){for(var i=this,n=i.getAppendedCardsForCell(e.$cell),a=t(),r=n.size(),s=0;r>s;s++){var o=n.eq(s),l=o.data("id"),u=e.$cards.is(".i-role-card[data-id="+l+"]");u&&(a=a.add(o))}a.remove()},getAppendedCardsForCell:function(e){return this.getCellPagingMore(e).find(".i-role-card")},getAxisCellByCoordinate:function(e){return this.board.find("#"+a.generateId(e))},getCellByCoordinate:function(e){var t=this._prepareCoordinates(e);return this.board.find("#"+a.generateId(t))},getCellHolderByCoordinates:function(e){var t=this._prepareCoordinates(e);return this.board.find("#"+a.generateHolderId(t))},getCellHoldersForAxis:function(e,t){return this.grid.find(".i-role-cellholder[data-"+e+'="'+t+'"]')},renderCardWithLayout:function(e,t){var i=this.templateFactory.get(this.cardTemplateName);
return i.bindPure({},a.getCardRenderData(e,t,this.configurator))},renderCardAsText:function(e,i){return t.when(i||this.getCardLayout(e)).then(this.renderCardWithLayout.bind(this,e))},renderCardAsHtml:function(e){return t.when(this.renderCardAsText(e)).then(t)},$createAxisMark:function(e){var t=this.templateFactory.get("boardplus.cell.axis.item"),i=a.convertCellAxisData({dynamic:{items:[e]}});return i.dynamic=!0,t.bind({},i)},applyCardsBatchAdd:function(i){var n=this;i=e.defaults(i,{options:{forceAppend:!1},items:[]});var a=i.options,r=i.items,s=e.chain(r).map(function(e){return{item:e,coordinates:{x:e.x,y:e.y}}}).filter(function(e){return!n.hasDataItemInCoordinates(e.item.data,e.coordinates)}).map(function(e){var t=e.item;return n.renderCardAsHtml(t.data).then(function(i){return{affectedDataItem:t.data.data,cell:n.getCellByCoordinate(e.coordinates),card:i}})}).value();return t.whenList(s).then(function(){var i=e.chain(arguments),r=i.map(function(e){return e.cell}).filter(function(e){return e.length}).compact().value(),s=i.map(function(e){return e.affectedDataItem}).unique(function(e){return e.id+e.type}).value(),o=i.map(function(e){return{$card:e.card,$cell:e.cell}}).value();return t.when(n.executeAppend(o,a)).then(function(e){return{$affectedCells:r,cards:e,affectedDataItems:s}})})},applyCardsBatchRemove:function(i){for(var n=i.options,a=i.items,r={},s=[],o=a.length,l=t(),u=0;o>u;u++){var c=a[u],d=c.data.data;r[d.id+d.type]=d;var p=this.getCardBySliceId(c.data.id);l=l.add(p)}return l.each(function(e,i){var n=t(i).closest(".i-role-cell");n.length&&s.push(n)}),t.when(this.executeRemove(l,n)).then(function(){return{$affectedCells:s,affectedDataItems:e.values(r)}})},applyCardsBatchUpdate:function(i){var n="tauselectable",a=this;i=e.defaults(i,{options:{forceAppend:!1},items:[]});var r=i.options,s=i.items,o=s[0].data.id,l=this.getCardBySliceId(o),u=this.isListMode()?[s[0]]:s,c=e.filter(u,function(e){return!e.notInSlice}),d=e.any(c.slice(1),function(e){return o!==e.data.id
});if(d)throw new Error("DEBUG INFO: Multiple IDs in batch update are not supported");var p=e.map(c,function(i){return t.when(a.renderCardAsHtml(i.data)).then(function(r){var s={x:i.x,y:i.y},l=a.getCellByCoordinate(s),u=a.getCellHolderByCoordinates(s),c=a.getCardBySliceIdInTarget(o,u);r.data(n,t.extend({},c.data(n)));var d=c.attr("class")&&c.attr("class").split(/\s+/),p=e.filter(d,function(e){return 0===e.indexOf("i-role-permanent-")});e.each(p,function(e){r.addClass(e)});var f=0,m=0,h=i.data.hasOwnProperty("orderingValue");h&&(f=i.data.orderingValue,m=c.data("orderingValue"));var g={cell:l,affectedDataItem:i.data.data};return c.size()>0&&0===a.compareOrderings(m,f)?(g.cardToDelete=c.eq(0),g.cardToUpdate={$cardNV:r,$cardEx:c}):g.cardToAdd={$card:r,$cell:l},g})});return t.whenList(p).then(function(){var i=[],n=[],s=[],o=[];e.each(arguments,function(e){n.push(e.affectedDataItem),e.cell&&i.push(e.cell),e.cardToDelete&&(l=l.not(e.cardToDelete)),e.cardToUpdate&&s.push(e.cardToUpdate),e.cardToAdd&&o.push(e.cardToAdd)}),n=e.unique(n,function(e){return e.id+e.type});var u=a.executeClear(l),c=a.executeUpdate(s,r),d=a.executeAppend(o,r);return t.when(u,c,d).then(function(t,a,r){return{$affectedCells:i,cards:e.union(a,r),affectedDataItems:n}})}).then(e.bind(function(e){return this.fire("afterUpdateCards",e),e},this))},applyAxisBatchAdd:function(i){i=e.defaults(i,{options:{force:!1},items:[]});for(var n=i.items,a=[],r={},s=n.length,o=0;s>o;o++){var l=n[o],u=l.data.data;r[u.id+u.type]=u;var c=t("<div/>");c.data(l.data),a.push(c)}return{$affectedCells:a,affectedDataItems:e.values(r)}},applyAxisBatchUpdate:function(i){var n=this;i=e.defaults(i,{options:{forceAppend:!1},items:[]});for(var a,r=i.options,s=i.items,o=[],l={},u=[],c=function(e,t){if(0===t)a=e;else if(a!==e)throw new Error("DEBUG INFO: Multiply IDs in batch update are not supported")},d=n.isListMode()?0:s.length,p=[],f=0;d>f;f++){var m=s[f];c(m.data.id,f);var h=m.data.data;l[h.id+h.type]=h;var g=m.location.toLowerCase().charAt(0),v={};
v[g]=m[g];var b=n.getAxisCellByCoordinate(v);p.push(b);var y=b.find(".i-role-axis-item"),_=n.$createAxisMark(m.data);o.push({$cardNV:_,$cardEx:y}),u.push(_)}return t.when(this.executeAxisLineUpdate(o,r)).then(function(){return{$affectedCells:p,cards:u,affectedDataItems:e.values(l)}})},_getAffectedCellsForItemDuringBatchRemoveAxis:function(i){var n=i.location.toLowerCase().charAt(0),a=this.getGrid(),r=this,s=function(i,n,a){var s=e.filter(r.board.find(".i-role-cell"),function(n){return e.chain(i.data.data.ids).map(function(e){return'[data-ids*="'+e+'"]'}).filter(function(e){return t(n).find(e).length}).value().length}),o=e.chain(s).map(function(e){return t(e).data(n)}).map(function(e){return a.find(".i-role-cell[data-"+n+'="'+e+'"]')}).flatten().value();return{$axisCell:t(s),$cells:t(o)}},o=function(e,t,i){var n={};return n[t]=e.data.id,{$axisCell:this.getAxisCellByCoordinate(n),$cells:this.getCellsBySliceCoordinatesInTarget(n,i)}},l={entitystate:e.bind(s,this),priority:e.bind(s,this),"default":e.bind(o,this)},u=l[i.data.type.toLowerCase()]||l["default"];return u(i,n,a)},applyAxisBatchRemove:function(i){i=e.defaults(i,{options:{},items:[]});var n=i.items,a=this,r=e.chain(n).map(function(e){var t=e.data.data;return{itemData:t,uniqueKey:t.id+t.type,affectedCells:a._getAffectedCellsForItemDuringBatchRemoveAxis(e)}}),s=r.map(function(t){return e.flatten(t.affectedCells.$cells)}).flatten().value(),o=r.map(function(t){return e.flatten(t.affectedCells.$axisCell)}).flatten().value(),l=e.map(s,function(e){return t(e)}),u=r.map(function(e){return e.itemData}).value();return t.when(this.executeAxisLineRemove(t(o),t(s))).then(function(){return{$affectedCells:l,affectedDataItems:u}})},highlightAxesLines:function(e){for(var i=t(),n=t(),a=this,r=0,s=e.length;s>r;r++){var o=e[r],l={};l[o.location.charAt(0).toLowerCase()]=o.data.id;var u=this.getAxisCellByCoordinate(l);if(1===u.length){i=i.add(u);var c=this.getCellHoldersAxisLineBySliceCoordinates(l);n=n.add(c)}}i.length&&t.scrollTo(i.eq(0),{onAfter:function(){a.animateWithClass("tau-axis_highlighted",n)
}})},applyCardsBatchMove:function(i){var n=t.Deferred(),r=this;if(!i.targetCellCoordinates)throw new Error("Target cell coordinates are not provided for move operation");i=e.defaults(i,{options:{forceAppend:!1},items:[]});var s=i.targetCellCoordinates,o=i.options,l=[],u=[];e.each(i.items,function(e){1===e.length&&e[0].x==s.x&&e[0].y==s.y?l.push(e[0]):u.push(e)});var c=e.sortBy(l,function(e){return e.data.orderingValue||0}),d=[],p=[],f=[],m="",h=t(),g={},v="tauselectable";return t.whenList(e.map(c,function(e){return r.renderCardAsText(e.data).then(function(i){var n=e.data.data.cardData.id,s=a.getLatestCardId(n);p.push(s),e.domId=s;var o=r.getCardBySliceId(e.data.id);return o.size()&&(h=h.add(o),g[s]=t.extend({},o.data(v))),i})})).done(function(){if(e.each(arguments,function(e){m+=e}),c.length){var s=e.pick(c[0],"x","y"),l=r.getCellByCoordinate(s);l.size()&&(d=[l],r.replaceCardsFastMethod(l,h,m))}t.whenList(e.map(p,function(i){var n=a.getDomNodeByIdFast(d[0],i),s=t.Deferred();if(n)s.resolve(t(n));else{var o=e.find(c,function(e){return e.domId===i});s=r.renderCardAsHtml(o.data)}return s.done(function(e){e.data(v,g[i]),f.push(e)}),s})).done(function(){var a=e.map(u,function(){return t.Deferred()});t.whenList(a).then(function(){var t=e.toArray(arguments),i=d,a=f;e.each(t,function(e){i=i.concat(e.$affectedCells),a=a.concat(e.cards)}),o.suspendAnimation||e.each(a,e.bind(r.animateWithClass,r,r.ANIMATION_CARD_UPDATED)),n.resolve({$affectedCells:i,cards:a})}),e.each(u,function(e,t){r.applyCardsBatchUpdate({items:e,layout:i.layout}).then(a[t].resolve)})})}),n},getUnsortedCardsHolder:function(e){return e.next(".i-role-cell-paging-more")},createUnsortedCardsHolder:function(){return t(['<div class="i-role-cell-paging-more tau-cell-paging-more">','<div class="i-role-cell-paging-more-link tau-cell-paging-more-link">show more&hellip;</div>',"</div>"].join(""))},getCardLayout:function(e){return this.isNewListMode()&&console.warn("Getting card layout via DomWrapper.getListLayout is not supported anymore"),this.cardLayoutFactory.getCardLayoutByType(e.type.toLowerCase())
},findCellById:function(e){return this.$el.find(".i-role-cell#"+e)},_prepareCoordinates:function(t){var i=this.isListMode(),n=i?{x:"null",y:"null"}:e.clone(t);return n.x=n.x||"null",n.y=n.y||"null",n}};return e.extend(l,r),n.extend(i.extend(l))}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.operations.strategies",["Underscore","jQuery","tau/slice/api.cache.axes.instance"],function(e,t,i){var n={user:"assigneduser"},a={applyCompleteHandler:function(e,t,i){var n=i.operation,r=n.options||{},s=n.location;if(a.evictCache(n),"card"!==s)if(r.force)"added"===n.name?a.highlight(i,t,e,n):a.refresh(e);else if(i.affected$CellsArray.length>0)switch(n.name){case"added":a.generateNotificationMessage(e,n.items);break;case"notinslice":case"deleted":a.generateNotificationMessage(e,null)}},highlight:function(t,i,n,r){var s=t.dataItems;if(e.isArray(s)&&s[0]&&e.contains(["project","team"],s[0].type.toLowerCase())){var o=i.getAppStateStore(),l=i.getApplicationContextService();l.appendToContext(s[0].type.toLowerCase(),e.pluck(s,"id"),o).then(function(){n.fire("operation.highlightItems",r.items)})}else a.refresh(n,r.items)},refresh:function(e,t){t&&e.fire("operation.highlightItems",t),e.fire("refresh")},generateNotificationMessage:function(i,n){var a=this,r=t(["<h3>","Attention","</h3>","<p>","The lanes have been updated, please, ",'<a href="#" class="i-role-refresh-action">refresh the View.</a>.',"</p>"].join(""));r.delegate(".i-role-refresh-action","click",e.bind(function(e){var t=this;return e.preventDefault(),a.refresh(t,n),!1},i)),i.fire("notification",{$node:r,type:"warning"})},evictCache:function(t){e.forEach(t.items,function(e){var t=(e.data.type||e.data.data.type).toLowerCase(),a=n[t]||t;i.evict(a)})}};return a}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.operations",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/board.plus/ui.board.plus.domWrapper","tau/ui/extensions/board.plus/ui.extension.board.plus.operations.strategies","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n,a,r){var s={added:"Add",updated:"Update",cascade:"Update",deleted:"Remove",notinslice:"Remove"};
return i.extend({resetLifecycle:!0,locationNamesMap:{card:"Cards",x:"Axis",y:"Axis"},operationNamesMap:s,allowedOperationNames:e.keys(s),createDomWrapper:function(){throw new Error("Create [DomWrapper] instance in component according to view mode specific")},"bus configurator.ready + definition.ready + model.cells.metaInfo.ready + view.skeleton.built + board.paging.settings + cardLayoutFactory.ready":function(e,t,i,n,a,r,s){var o=this.createDomWrapper(a.element,t,i,n);o.getPagingSettings=function(){return r},o.cardLayoutFactory=s,this.fire("domWrapper.ready",o)},"bus domWrapper.ready:last > view.cell.skeleton.element.beforeUpdate":function(e,i,n){i.applyCellPagingUpdate({$cell:n.cell,$cards:t(n.content)})},"bus domWrapper.ready:last + comet.tick":function(e,t,i){this.fire("operation.execute",i.data)},"bus domWrapper.ready:last + operation.execute":function(e,t,i){this.executeCometOperation(t,i)},"bus configurator.ready:last + operation.execute.done":function(e,t,i){this._onOperationExecuted(t,i)},executeCometOperation:function(e,t){var i=this.createOperation(t);this.isAllowedToExecute(i)&&this.executeOperation(e,i)},createOperation:function(t){var i=t.items,n=e.first(i);return{name:(t.name||n.modification).toLowerCase(),location:this.createLocation(n),items:i,options:t.options||{}}},createLocation:function(e){return e.location?e.location.toLowerCase().replace(/^(\w)axis$/,"$1"):"card"},isAllowedToExecute:function(t){return e.contains(this.allowedOperationNames,t.name)},executeOperation:function(i,n){return this.fire("operation."+n.name,n),n=e.defaults(n,{options:{}}),"cascade"===n.name&&(n.options.suspendAnimation=!0),t.when(e.bind(this.performOperation,this,i,n)()).then(e.bind(this.completeOperation,this,i,n))},performOperation:function(e,t){return e[this.createMethodName(t)](t)},completeOperation:function(e,t,i){var n={operation:t,dataItems:i.affectedDataItems,affected$CellsArray:i.$affectedCells,cards:i.cards||[]};this.notifyUpdatedCells(n),this.reapplySelection(n,e),this.notifyUpdatedCards(n),this.fire("operation.execute.done",n)
},_onOperationExecuted:function(e,t){a.applyCompleteHandler(this,e,t)},createMethodName:function(e){return["apply",this.locationNamesMap[e.location],"Batch",this.operationNamesMap[e.name]].join("")},notifyUpdatedCells:function(e){for(var t=e.affected$CellsArray,i=t.length,n=0;i>n;n++){var a=t[n];this.fire("view.cell.skeleton.updated",{element:a})}},reapplySelection:function(e,t){t.isListMode()&&"deleted"===e.operation.name?this._debounceSelectionReapply():this.fire("selection.reapply",{})},notifyUpdatedCards:function(t){this.isCardReBuildOperation(t.operation)&&e.forEach(t.cards,function(e){var t=e.data();this.fire("view.card.skeleton.built",{element:e,data:{id:t.id,type:t.type}})},this)},isCardReBuildOperation:function(e){return r.isCardReBuildOperation(e)},_debounceSelectionReapply:e.debounce(function(){this.fire("selection.reapply",{})},500)})}),define("tau/models/board.plus/model.board.base",["Underscore","tau/components/board.core/models/model.board.core","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(e,i){this._model=i||new t,this._super.apply(this,arguments)},getModel:function(){return this._model}})}),define("tau/components/board.core/models/model.board.plus",["Underscore","jQuery","tau/components/board.core/models/model.board.core","tau/models/board.plus/model.board.slice.extender","tau/services/customize/service.customize.card.layout.factory","tau/models/board.customize.units/const.card.sizes","tau/libs/boardSettings/board.settings.to.definition.translator"],function(e,t,i,n,a,r,s){return i.extend({init:function(){this._super.apply(this,arguments),this.onZoomLevelChanged=e.Callbacks(),this.onPageChanged=e.Callbacks(),this.onSliceInfoRetrieved=e.Callbacks(),this.onBoardPagingSettingsRetrieved=e.Callbacks(),this.onAcidReady=e.Callbacks(),this.onBoardConfigurationReady=e.Callbacks(),this.onViewModeReady=e.Callbacks(),this.onDefinitionReady=e.Callbacks(),this.onPageReady=e.Callbacks(),this.onSliceReady=e.Callbacks(),this.onCardLayoutFactoryReady=e.Callbacks(),this.onBoardDefinitionReady=e.Callbacks(),this.onCacheInvalidated=e.Callbacks(),this._getSliceDeferred=t.Deferred()
},_zoomToSize:function(e){var t=r.zoomToSize(e.zoomLevel);return t||1!==e.zoomLevel||(t="min"),t},startLifeCycle:function(e,i){this.updateBoardSettings(i),this._layoutFactory=new a(e,this.getBoardSettings()),this._configurator=e,this.onCardLayoutFactoryReady.fire(this._layoutFactory);var n=t.Deferred();e.getAppStateStore().get({fields:["acid"],callback:function(e){this.onAcidReady.fire(e.acid),n.resolve(e.acid)}.bind(this)});var r=t.Deferred();this.getBoardSettings().get({fields:["x","y","cells","zoomLevel","viewMode","page","focus","selectedMarks","cardSettings","user","acid","timelineLocalDateRange","timelineGlobalDateRange","timelineSettings"]}).then(function(e){this.onBoardConfigurationReady.fire(e),this.onViewModeReady.fire(e.viewMode),r.resolve(e)}.bind(this)),t.when(n,r).then(this._boardConfigReady.bind(this))},_boardConfigReady:function(t,i){this._acid=t,this._boardConfig=i,this._updateSlice(),this.onZoomLevelChanged.fire(e.pick(i,"zoomLevel"))},_updateSlice:function(t){this.abortCurrentSlice();var i=this._updateDefinition(t),a={definition:e.deepClone(i)};a.definition.global={acid:this._acid},this._sliceData={slice:this.getSliceFactory().create(a)};var r=new n;r.extend(this._sliceData,this._layoutFactory).done(function(e){this._sliceData=e,this.onSliceReady.fire(e)}.bind(this)),this._getSliceDeferred.resolve(function(){return this._sliceData.slice}.bind(this))},getSliceFactory:function(){return this.getConfigurator().getSliceFactory()},getConfigurator:function(){return this._configurator},_updateDefinition:function(t){var i=this.createDefinition();return this.onDefinitionReady.fire(i),this.onPageReady.fire(e.deepClone(i.page)),this.onBoardDefinitionReady.fire(i,this._boardConfig),t&&t.zoomLevel&&(i.zoomLevel=t.zoomLevel),i},createDefinition:function(){return s.prototype.createDefinition(this._boardConfig)},unbindBoardSettings:function(){this.getBoardSettings()&&this.getBoardSettings().unbind({listener:this})},abortCurrentSlice:function(){this._sliceData&&e.each(this._sliceData,function(e){e.abort()
})},getBoardSettings:function(){return this._boardSettings},updateBoardSettings:function(e){this.unbindBoardSettings(),this._boardSettings=e,this._boardSettings.bind({fields:["zoomLevel"],listener:this,callback:this._onZoomLevelChanged.bind(this)}),this._boardSettings.bind({fields:["page"],listener:this,callback:this.onPageChanged.fire.bind(this.onPageChanged)})},onGetSliceInfo:function(){},_onZoomLevelChanged:function(t){t.name||(this.onZoomLevelChanged.fire(e.pick(t,"zoomLevel")),this._boardConfig&&this._forceUpdateSliceOnZoomLevelChanged())},_forceUpdateSliceOnZoomLevelChanged:function(){this._updateSlice()}})}),define("tau/models/board.plus/model.board.plus",["Underscore","tau/models/board.plus/model.board.base","tau/components/board.core/models/model.board.plus","tau/services/customize/service.customize.card.layout.factory","tau/models/board.plus/model.board.slice.extender","tau/ui/extensions/board.plus/ui.extension.board.plus.operations.strategies"],function(e,t,i,n,a,r){return t.extend({init:function(t,n){var a=n||new i;a.onZoomLevelChanged.add(this.fire.bind(this,"model.zoomLevelChanged")),a.onPageChanged.add(function(t){this.fire("page.changed",e.deepClone(t.page))}.bind(this)),a.onSliceInfoRetrieved.add(this.fire.bind(this,"model.sliceInfo.retrieved")),a.onBoardPagingSettingsRetrieved.add(this.fire.bind(this,"board.paging.settings")),a.onAcidReady.add(this.fire.bind(this,"acid.ready")),a.onBoardConfigurationReady.add(this.fire.bind(this,"board.configuration.ready")),a.onViewModeReady.add(this.fire.bind(this,"viewMode.ready")),a.onDefinitionReady.add(this.fire.bind(this,"definition.ready")),a.onPageReady.add(this.fire.bind(this,"page.ready")),a.onBoardDefinitionReady.add(this.fire.bind(this,"board.definition.ready")),a.onBoardDefinitionReady.add(function(e,t){taus.track({"@":["open-board-action"],boardSettings:t,definition:e})}),a.onSliceReady.add(function(e){this.fire("slice.ready",e),this.fire("comet.parameters",e.slice.getCometParameters())}.bind(this)),a.onCardLayoutFactoryReady.add(this.fire.bind(this,"cardLayoutFactory.ready")),a.onCacheInvalidated.add(function(){r.generateNotificationMessage(this,[])
}.bind(this)),this._super(t,a)},destroy:function(){this.getModel().unbindBoardSettings(),this._super()},"bus configurator.ready:last + boardSettings.ready + start.lifecycle":function(e,t,i){this.getModel().startLifeCycle(t,i.boardSettings)},"bus configurator.ready > slice.ready":function(e,t,i){this.getModel().onGetSliceInfo(i.base,t)},"bus slice.ready:last + before_destroy":function(){this.fire("clearError"),this.getModel().abortCurrentSlice()},"bus slice.ready:last + before_refresh":function(){this.fire("clearError"),this.getModel().abortCurrentSlice()}})}),define("tau/components/board.core/models/model.board.plus.grid",["Underscore","jQuery","tau/components/board.core/models/model.board.plus"],function(e,t,i){var n=i.extend({getViewMode:function(){return"board"},boardSettingsSilentSet:function(t){this.getBoardSettings().get({fields:["page","focus"],callback:function(i){var n=i.page||{},a=i.focus||{},r={page:n,focus:a};e.extend(n,t.page),e.extend(a,t.focus),this.getBoardSettings().set({set:r,isSilent:!0})}.bind(this)})},onGetSliceInfo:function(i){var n=e.deepClone(i.config.definition),a=this.requestSize(i),r=this.requestMarks("x",n,i),s=this.requestMarks("y",n,i);t.when(r,s).done(function(t,i){var r={viewMode:this.getViewMode(),definition:n,zoomLevel:n.zoomLevel||3};r.cardSize=this._zoomToSize(r),r.titleX=t.title,r.titleY=i.title;var s=this.publishSliceInfoEvent(r,t,i);a.done(function(t){e.each(["x","y"],function(e){s[e].isFocus&&(t[e]=s[e].onPage)}),this.publishBoardPagingSettingsEvent(t,s)}.bind(this))}.bind(this))},requestSize:function(i){var n=t.Deferred(),a=function(t){var i=t?t.data:{x:0,y:0};n.resolve(e.deepClone(i))};return i.size().done(a).fail(a),n},_getPageMoveStrategies:function(e){return{page:e,up:function(){this.page.y--},down:function(){this.page.y++},left:function(){this.page.x--},right:function(){this.page.x++}}},moveToPage:function(e,t,i){var n=this._getPageMoveStrategies(e);n[t](),i.boardSettings.set({set:{page:e}})},setPage:function(e,t){e.set({set:{page:t}})
},requestMarks:function(i,n,a){var r=function(){this.publishCacheInvalidated(i)}.bind(this),s=this,o=t.Deferred(),l=n.page,u=function(e,t,n){var a={},r=t?s.getAxisPagingObject(i,e.items,l):s.getAxisNullPagingObject();r.isNull=!t,r.isFocus=!!n,a[i]=r,a["marks"+i.toUpperCase()]=r.data,a.title=e.metaInfo?e.metaInfo.name:null,o.resolve(a)}.bind(this),c=function(){var e=s.getSlicePagingArgs(i,l);return n.focus[i].length>0&&(e={id:{$in:n.focus[i]}},l[i]=0),a[i](e,r).fail(function(){u({items:[]},!1,!1)})},d=function(t,r){var o=!a.isUndefinedAxis(i);if(r&&t&&t.items){var p={};e.each(t.items,function(t){e.each(n.focus[i],function(e){e.toLowerCase()==t[i].toLowerCase()&&(p[e.toLowerCase()]=t)})}),t.items=e.values(p),t.items.length&&(l.size[i]=t.items.length)}var f=t.items&&0!==t.items.length,m=l[i]>0||r;if(o&&!f&&m){var h={page:{},focus:{}};return l[i]=0,h.page[i]=0,r&&(h.focus[i]=[],n.focus[i]=[]),c().done(function(e){d(e.data)}),s.boardSettingsSilentSet(h),!1}u(t,o,r)};return c().done(function(e){var t=!1;e&&e.command&&e.command.config&&(t=e.command.config.hasOwnProperty("id")),d(e.data,t)}),o},publishSliceInfoEvent:function(t,i,n){e.extend(t,i),e.extend(t,n);var a={up:t.y.hasPrev,down:t.y.hasNext,left:t.x.hasPrev,right:t.x.hasNext};return t=e.extend(t,{availableDirections:a,page:{x:t.x.currentPage,y:t.y.currentPage}}),t.x.title=t.titleX,t.y.title=t.titleY,this.onSliceInfoRetrieved.fire(t),t},publishCacheInvalidated:function(e){this.onCacheInvalidated.fire(e)},publishBoardPagingSettingsEvent:function(t,i){var n=this;e.each(["x","y"],function(e){if(t[e]){var a=i[e];a.total=t[e],a.totalPages=n.getPagesCountForAxis(t[e],a.maxOnPage)}}),this.onBoardPagingSettingsRetrieved.fire(i)}});return n}),define("tau/models/board.plus/model.board.plus.grid",["Underscore","jQuery","tau/models/board.plus/model.board.plus","tau/components/board.core/models/model.board.plus.grid","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n){return i.extend({init:function(e,t){var i=t||new n;
this._super(e,i)},"bus board.paging.settings:last + board.paging.settings.retrieve":function(e,t){this.fire("board.paging.settings.retrieved",t)},"bus page.move.to + board.paging.settings:last + boardSettings.ready:last":function(e,t,i,n){this.getModel().moveToPage(i.page,t.direction,n)},"bus boardSettings.ready:last + page.switched":function(e,t,i){this.getModel().setPage(t.boardSettings,i)}})}),define("tau/models/board.plus/model.board.cell",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus slice.ready:last+model.get.cell.content":function(e,t,i){var n=t.base;this.onGetCellContent(n,i)},onGetCellContent:function(e,t){var i=this,n=t.from,a=t.to-t.from+1,r={$take:i.generateExcessTake(a),$skip:n};"null"!==t.x&&(r.x=t.x),"null"!==t.y&&(r.y=t.y),e.cell(r).done(function(e){var n=e.data.items.length>0?e.data.items[0]:{},a=i.preProcessCellResponse(n,t);i.fireCellBasicInfoRetrieved(a)})},"bus model.get.cell.basicInfo":function(e){var t=this,i=e.data;i.x=i.x||null,i.y=i.y||null,i.x&&i.y?(i.x=i.x.toString(),i.y=i.y.toString(),t.fire("model.get.cell.content",i)):t.fire("model.get.axisCell.basicInfo",i)},"bus model.sliceInfo.retrieved:last+model.get.axisCell.basicInfo":function(t){var i=t["model.get.axisCell.basicInfo"].data,n=t["model.sliceInfo.retrieved"].data,a=(i.hasOwnProperty("x"),i.hasOwnProperty("y"),i.x?"X":"Y"),r=n["marks"+a],s=e(r).find(function(e){var t=a.toLowerCase();return e[t]==i[t]});this.fireCellBasicInfoRetrieved({dataItem:s,coords:i})},fireCellBasicInfoRetrieved:function(t){var i=t.dataItem;i.paging=e(t.coords).pick("from","to"),this.fire("model.cell.basicInfo.retrieved",i)},"bus configurator.ready:last + acid.ready:last + before_model.cell.basicInfo.retrieved":function(t,i,n,a){var r=i.getUrlBuilder();e.forEach(a.dynamic.items,function(t){var i=t.data;i.entityRef=r.getNewViewUrl(e.asString(i.id),e.asString(i.type),n)})},fireCardsDataReady:function(e){this.fire("model.cards.data.ready",{cards:e})},preProcessCellResponse:function(t,i){var n=e.defaults(t||{},{dynamic:{items:[]},fixed:{items:[]},x:i.x,y:i.y}),a=e(n.fixed.items).find(function(e){return"cellpaging"===e.type
});if(a){var r=i.to-i.from+1,s=n.dynamic.items;n.dynamic.items=s.slice(0,r),a.data=a.data||{},a.data.nextOrderingValue=this.getNextOrderingValue(r,s)}else i.to=i.from+(n.dynamic.items.length-1);return{dataItem:n,coords:i}},getNextOrderingValue:function(e,t){if(e>=t.length)throw"DEBUG: index is out of range. To implement cell paging logic we must query more card items then show to user";return t[e].orderingValue},generateExcessTake:function(e){return e+Math.round(e/4)}})}),define("tau/models/board.plus/model.board.cell.freezable",["Underscore","jQuery","./model.board.cell"],function(e,t,i){return i.extend({"bus start.lifecycle":function(){this.onGetCellContent=t.noop,this.fire("model.get.cell.basicInfo.dump",{dump:{}})},preProcessAggregatedCellItem:function(t){var i=t.coords,n=t.dataItem,a=i.to-i.from+1,r=n.dynamic.items.length;if(a>=r)return t;var s=e(n.fixed.items).find(function(e){return"cellpaging"===e.type});return s?t=this.preProcessCellResponse(n,i):t},processResponse:function(t,i,n){for(var a=t.data.items,r=0,s=a.length;s>r;r++){var o=a[r],l=this.getKey(o);if(i.hasOwnProperty(l)){var u=i[l].dataItem;o.dynamic.items=u.dynamic.items.concat(o.dynamic.items),o.fixed.items=u.fixed.items.concat(o.fixed.items),e.extend(i[l].dataItem,o)}}for(var c=[],d=0;d<n.length;d++){var p=this.preProcessAggregatedCellItem(n[d]),f=this.fireCellBasicInfoRetrieved(p);c=c.concat(f)}this.fireCardsDataReady(c)},getKey:function(e){var t=e.x||"null",i=e.y||"null";return t+"_"+i},"bus model.cells.content.loaded+model.cards.data.ready":function(){var e=this;delete e.onGetCellContent},"bus model.cells.content.loaded+model.get.cell.basicInfo.dump:last+model.get.cell.basicInfo.end":function(t){var i=t["model.get.cell.basicInfo.dump"].data.dump,n=e.values(i),a=t["model.cells.content.loaded"].data;this.processResponse(a,i,n)},"bus slice.ready:last+model.get.cell.basicInfo.dump:last+model.get.cell.basicInfo.end":function(t){var i=t["model.get.cell.basicInfo.dump"].data.dump,n=e.values(i),a=this,r={},s={},o=0;
e.each(n,function(e){var t=e.coords.to-e.coords.from+1;t>o&&(o=t);var i=e.dataItem;i.x&&"null"!=i.x&&(r[i.x]=1),i.y&&"null"!=i.y&&(s[i.y]=1)}),r=e.keys(r),s=e.keys(s);var l={};r.length&&(l.x={$in:r}),s.length&&(l.y={$in:s}),l.$skip=0,l.$take=a.generateExcessTake(o),a.fire("model.execute.cell.query",{query:l})},skipQueryCells:function(){this.fire("model.cells.content.loaded",{data:{items:[]}})},queryCells:function(e,t){e.cell(t).done(function(e){this.fire("model.cells.content.loaded",e)}.bind(this)).fail(this.skipQueryCells.bind(this))},"bus slice.ready:last+model.execute.cell.query":function(e,t,i){var n=t.base,a=i.query;this.queryCells(n,a)},generateDefaultContent:function(e){var t={x:e.x.toString(),y:e.y.toString(),dynamic:{items:[]},fixed:{items:[]}};return t},"bus model.get.cell.basicInfo.dump:last+model.get.cell.basicInfo":function(e){var t=e["model.get.cell.basicInfo.dump"].data.dump,i=e["model.get.cell.basicInfo"].data;if(i.x&&i.y){var n=this.generateDefaultContent(i);t[this.getKey(n)]={dataItem:n,coords:i}}}})}),define("tau/ui/templates/board.plus/ui.template.boardplus.show-more",["tau/core/templates-factory","tau/nls/translator"],function(e,t){var i={name:"boardplus.show-more",engine:"jqote2",markup:['<div class="i-role-tau-always-last i-role-cell-paging-stack tau-show-more-cards-trigger"><button>'+t("show more&hellip;")+"</button></div>"],dependencies:[]};return e.register(i)}),define("tau/ui/extensions/board.plus/cells.paging.size.config",[],function(){return{0:[100,100,100],1:[100,50,25],2:[50,25,25]}}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cells.paging",["Underscore","jQuery","tau/core/class","tau/core/extension.base","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tau/nls/translator","tau/ui/templates/board.plus/ui.template.boardplus.show-more","tau/ui/extensions/board.plus/cells.paging.size.config"],function(e,t,i,n,a,r,s,o){var l=function(e,t){var i=0;return t>1&&5>t?i=1:t>=5&&(i=2),o[e][i]},u=function(){return o[0][0]
},c=function(e,i){var n=e.clone().attr("id",!1),a=t('<div style="visibility: hidden; display: block; position: absolute;" class="tau-ui-size-'+i+'"/>');n.appendTo(a),t("body").append(a);var r=n.outerHeight(),s=n.outerWidth();return a.remove(),{height:r,width:s}},d=i.extend({init:function(e){this.template=s,this.$cellHolder=e.parent(),this.alreadyBuiltIn=this.getTrack().length>0,this.showPagingTriggerInTrack=!0},getTrack:function(){return this.$cellHolder.children(".i-role-cell-paging-more")},getTrigger:function(){return this.$cellHolder.find(".i-role-cell-paging-stack")},isEnabled:function(){return this.alreadyBuiltIn},disable:function(){this.getTrack().css("visibility","hidden"),this.getTrigger().css("visibility","hidden")},remove:function(){this.getTrack().remove(),this.getTrigger().remove()},enable:function(e){var i=this.$cellHolder,n=this.getTrack();if(0===n.length){var a=this.showPagingTriggerInTrack?'<div class="i-role-cell-paging-more-link tau-cell-paging-more-link">'+r("show more&hellip;")+"</div>":"";n=t(['<div class="i-role-cell-paging-more tau-cell-paging-more">',a,"</div>"].join("")).data(e).appendTo(i)}var s=this.getTrigger();0===s.length&&(s=this.template.get().bind({},{}).appendTo(t(".i-role-cell",i))),s.css("visibility","visible"),n.css("visibility","visible")}}),p=d.extend({init:function(e){this._super(e),this.template=s,this.showPagingTriggerInTrack=!1},setShowMoreTriggerDimensions:function(e){var t=e.closest(".i-role-board-body-holder");if(t.hasClass("i-role-board-body-holder")){var i=t.hasClass("tau-ui-size-min"),n=!i&&t.hasClass("tau-ui-size-xl");if(!i&&!n){var a=t.data("zoomSize"),r=e.parent().find(".i-role-card").last();r.length&&e.css(c(r,a))}}},enable:function(e){this._super(e),this.setShowMoreTriggerDimensions(this.getTrigger())}}),f=p,m=function(e,t){var i=e[t];return i&&i.types&&i.types.length>0};return n.extend({lifeCycleCleanUp:function(){this.resetSubscriptions()},fireModelGetCellBasicInfo:function(t){var i=e.deepClone(t);e.has(i,"x")&&(i.x=null===i.x?"null":i.x),e.has(i,"y")&&(i.y=null===i.y?"null":i.y),this.fire("model.get.cell.basicInfo",i)
},"bus boardSettings.ready":function(t){var i=this,n=t.data.boardSettings;n.get({fields:["x","y","zoomLevel","viewMode","collapse"],callback:function(t){var n=0;"list"!==t.viewMode&&(m(t,"x")&&++n,m(t,"y")&&++n);var a=t.zoomLevel,r=t.collapse||{x:[],y:[]},s=l(n,a);i.fire("cell.paging.settings",{amountOfAxes:n,zoomLevel:a,pageSize:s,maxPageSize:u(),collapse:r,getPageSize:function(t){var i=this.pageSize;return(-1!==e(this.collapse.x).indexOf(t.x)||-1!==e(this.collapse.y).indexOf(t.y))&&(i=this.maxPageSize),i}})}})},"bus overview.cells.skeletons.ready:last > view.cell.skeleton.updated":function(e,t,i){this._moveAlwaysVisibleToEnd(i.element)},"bus view.card.batch.move.$successCards":function(e,t){if(t.length>0){t[0].parent()}},"bus overview.board.ready + cell.paging.settings":function(e,t,i){i.pageSize=u(),this.fire("cell.paging.settings",i)},"bus overview.cells.skeletons.ready:last+cell.paging.settings:last+cell.paging.byFilter":function(e,t,i,n){var a=this;a.triggerPagingOnCells(n.filter,t.cells,i)},triggerPagingOnCells:function(t,i,n){var a=this,r=e(i).filter(function(e){var i=e.element,n=i.data();return n.hasOwnProperty("x")&&n.hasOwnProperty("y")&&t(n)});e(r).each(function(e){var t=e.element,i=t.data(),r=n.getPageSize({x:i.x,y:i.y}),s=t.find(".i-role-card").size(),o=new f(t),l=o.isEnabled();if(l&&r>s){var u={x:i.x,y:i.y,from:s,to:r};o.disable(),a.fireModelGetCellBasicInfo(u)}})},"bus cell.paging.settings:last+view.cellSlot.built":function(e,t,i){var n=i.data;n.from=0,n.to=t.getPageSize(n)-1,this.fireModelGetCellBasicInfo(n)},"bus view.cell.skeleton.built":function(t){var i=t.data,n=i.data,a=i.element,r=e(n.fixed.items).find(function(e){var t=e.type||"";return"cellpaging"===t.toLowerCase()}),s=new f(a);r?s.enable(r.data):s.remove()},"bus view.skeleton.built:last + cardsFullyLoaded":function(e,i){var n=i.element.find(".i-role-cell");n.each(function(){var e=t(this),i=new f(e);i.setShowMoreTriggerDimensions(i.getTrigger())})},"bus cell.paging.settings:last + view.skeleton.built":function(e,i,n){var r=this,s=n.element,o=function(e){r.fire("paging.cell.show.more",{});
var t=e.data(),n=e.children(".i-role-card").size();new f(e).disable(),a.get(e).show(),e.parent().css("opacity",.5),r.fireModelGetCellBasicInfo({x:t.x,y:t.y,from:n,to:n+(i.getPageSize(t)-1)})},l=function(){var e=t(this).parent(".i-role-cell-paging-more").siblings(".i-role-cell");o(e)},u=function(){var e=t(this).parent(".i-role-cell");o(e)};s.delegate(".i-role-cell-paging-more-link","click",l),s.delegate(".i-role-cell-paging-stack","click",u)},"bus overview.board.ready:last > view.cell.skeleton.built":function(e,t,i){a.get(i.element).hide(),i.element.parent().css("opacity",1),this.fire("view.cell.skeleton.updated",i)},"bus overview.board.ready:last > view.cell.skeleton.element.beforeUpdate":function(e,t,i){i.content.css("opacity",.15)},"bus scrollManager.ready:last > overview.board.ready:last > view.cell.skeleton.element.afterUpdate":function(t,i,n,a){var r=a.content;r.size()>0&&e.defer(function(){i.scrollToVisibility(r.last(),{axis:"y",duration:1e3,easing:"easeInSine",offset:{top:20},onAfter:function(){r.animate({opacity:1},"slow","easeOutBounce")}})})},_moveAlwaysVisibleToEnd:function(e){var i=t(".i-role-tau-always-last",e).detach();e.append(i)}})}),define("tau/ui/extensions/board.plus/layout/size.calculator-board",["Underscore","jQuery"],function(e,t){return{initializeHeaderCells:function(e){var i=e.model,n=e.$element,a=[],r=function(e){var n="x"===e?"cols":"rows",r="x"===e?"width":"height";return function(){var s=t(this);if(!s.parent().attr("data-is-hidden")){var o=s.data(),l=o[e],u={$el:s,data:o,syncItem:i[n][l],syncSize:r};a.push(u)}}},s=n.find(".i-role-header");return s.filter("[data-dimension=x]").find(".i-role-cell").each(r("x")),s.filter("[data-dimension=y]").find(".i-role-cell").each(r("y")),a},calculateHeight:function(i){var n=i.row,a=n.items[0].$el.parent(),r=a.parent(),s=t.ui.ie?r[0].clientHeight-1:a[0].clientHeight;if(t.ui.ie&&0>s){var o=r.children(),l=e.map(o,function(e){return parseFloat(getComputedStyle(e,null).height)});s=Math.max.apply(null,l)}return s
},applyHeight:function(e,t){var i=t.headerCell;i&&i.lastHeight!==e&&(i.lastHeight=e,i.$el.height(e))},calculateWidth:function(e){var t=e.col,i=e.getCardWidth(t);return t.cardsInRow*i+t.extraWidth},applyWidth:function(e,t){var i=t.headerCell;i&&i.lastWidth!==e&&(i.lastWidth=e,i.$el.width(e))}}}),define("tau/ui/extensions/board.plus/layout/cards.incrementation.calculator",["Underscore"],function(e){return{coeffs:null,availableCards:0,freeCards:0,absoluteCardsIncrementation:null,_createFilledArray:function(e,t){for(var i=0,n=new Array(e);e>i;i++)n[i]=t;return n},_translateCoeff:function(e,t){var i=Math.min(this.availableCards,Math.round(this.freeCards*e));this.absoluteCardsIncrementation[t]+=i,this.availableCards-=i},_translateCoeffs:function(){this.freeCards=this.availableCards,e.each(this.coeffs,this._translateCoeff,this),this.coeffs.pop()},_normalizeCoeffs:function(){var t=1/e.sum(this.coeffs);this.coeffs=e.map(this.coeffs,function(e){return e*t})},_distributionByCardsCount:function(t){var i=e.reduce(t,function(e,t){return e+t.cardsNum},0);i=i||1;var n=!0,a=e.map(t,function(t){var a=t.cardsNum>0?e.chain(t.items).pluck("cardsNum").max().value()/i:0;return 0!==a&&(n=!1),a});if(n){var r=1/a.length;a=this._createFilledArray(a.length,r)}return a},calculate:function(e,t){for(this.coeffs=this._distributionByCardsCount(e),this.absoluteCardsIncrementation=this._createFilledArray(e.length,0),this.availableCards=t;this.availableCards>0;)this._normalizeCoeffs(),this._translateCoeffs();return this.absoluteCardsIncrementation}}}),define("tau/ui/extensions/board.plus/layout/ui.board.plus.layout",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/layout/size.calculator-board","tau/ui/extensions/board.plus/layout/cards.incrementation.calculator"],function(e,t,i,n,a){var r=i.extend({init:function(e){this.sizeCalculator=e||n},setConfig:function(t){this.config=t,e.defaults(this.config,{useFixedColumnSizes:!1,columnSizes:{}}),this.setSizes(t.sizes)},isColumnCollapsed:function(e){return this.cols[e].isCollapsed
},setFixedColumnSize:function(t){e.extend(this.config.columnSizes,t),e.each(t,function(e,t){this.cols[t].extraWidth=0},this)},getFixedColumnSize:function(e){return!this.config.useFixedColumnSizes||this.isColumnCollapsed(e)?null:this.config.columnSizes[e]||null},resolveColumnSize:function(e){var t=this.getFixedColumnSize(e);if(!t){var i=this.cols[e],n=i.items[0].$el,a=this.getItemZoomLevelOrDefault(i.isCollapsed),r=this.getSizeInfo(a).width;t=n.width()/r}return Math.floor(t)},setSizes:function(t){e.forEach(t,function(t){e.defaults(t,{cardsInRowMin:0,cardsInRowMax:99999,clientColsMin:99999,clientRowsMin:99999})}),this.config.sizes=t},getSizeInfo:function(e){return this.config.sizes[e]},setCurrentZoomLevel:function(e){return e=e||this.currentZoom||1,e in this.config.sizes||(e=5),this.currentZoom=e,this.currentZoom},getCurrentZoomLevel:function(){return this.currentZoom||1},getColumnsCount:function(){return e.keys(this.cols).length},getItemZoomLevelOrDefault:function(e){return e?"collapsed":this.getCurrentZoomLevel()},setElement:function(e){this.$el=e,this.$grid=e.find(".i-role-grid"),this.cells=[],this.rows={},this.cols={},this.headerCells=[];var t=0;this.padding=2*this.config.padding||14,this.scrollWidth=t+this.padding,this.cellBorderWidth=0,this.initializeGridModel()},refreshElement:function(){this.setElement(this.$el)},initializeGridModel:function(){var i=this.$grid.find(".i-role-cell");e.each(i,function(e){var i=t(e),n=i.parent();if("none"!==n.css("display")){var a=n.hasClass("tau-collapsed_x"),r=n.hasClass("tau-collapsed_y"),s=i.data(),o=s.x,l=s.y,u={$el:i,cardsNum:i.find(".i-role-card").length,isCollapsed:a,data:s,width:null,height:null,isHidden:!1};this.cols[o]=this.cols[o]||{x:o,items:[],_sizes:[],cardsNum:0,extraWidth:0,isCollapsed:a},this.rows[l]=this.rows[l]||{y:l,items:[],height:null,_sizes:[],cardsNum:0,isCollapsed:r},this.cols[o].cardsNum+=u.cardsNum,this.cols[o].items.push(u),this.rows[l].cardsNum+=u.cardsNum,this.rows[l].items.push(u),this.cells.push(u)}},this),this.headerCells=this.sizeCalculator.initializeHeaderCells({$element:this.$el,model:e.pick(this,"cols","rows")})
},updateSize:function(){this.calculateOptimalSize(),this.justifyWidth(),this.justifyHeight(),this.justifyHeightByHeader(),this.updateCells(),this.updateHeaders()},calculateOptimalSize:function(){var t=this,i=t.getCurrentZoomLevel(),n=this.$grid[0].clientWidth||this.$grid.width(),a=this.$grid[0].clientHeight||this.$grid.height(),r=t.getSizeInfo(i),s=r.width,o=r.height,l=this.scrollWidth,u=this.cellBorderWidth,c=e.values(this.rows).length||1,d=e.values(this.cols).length||1,p=n/Math.min(r.clientColsMin,d)-l,f=Math.floor((p-l-u)/s)||1,m=a/Math.min(r.clientRowsMin,c),h=Math.floor(m/o),g=3;e.each(this.cells,function(e){var i=t.getSizeInfo(t.getItemZoomLevelOrDefault(e.isCollapsed)),n=t.getCellResizeInfo(e,g,f,h,i);e.height=n.height,e.cardsInCol=n.cardsInCol,e.cardsInRow=n.cardsInRow}),e.each(this.rows,function(t){t.height=e.max(t.items,function(e){return e.height}).height,t.cardsInCol=e(t.items).chain().pluck("cardsInCol").max().value()}),e.each(this.cols,function(t){t.extraWidth=0,t.cardsInRow=e(t.items).chain().pluck("cardsInRow").max().value()}),e.each(this.cells,function(e){e.cardsInRow=t.cols[e.data.x].cardsInRow,e.height=t.rows[e.data.y].height,e.cardsInCol=t.rows[e.data.y].cardsInCol})},beforeRowsHeightRecalculation:function(){},afterRowsHeightRecalculation:function(){},getCellResizeInfo:function(t,i,n,a,r){var s=t.cardsNum,o=r.width,l=r.height,u=o*l,c=s||1,d=Math.sqrt(c*u/i),p=null,f=this.getFixedColumnSize(t.data.x);f?p=f:6!==this.getCurrentZoomLevel()||this.isColumnCollapsed(t.data.x)?(p=e.min([Math.ceil(d/o),n,r.cardsInRowMax]),p=e.max([p,r.cardsInRowMin])):p=1;var m=Math.ceil(c/p);return{height:m*l,cardsInCol:m,cardsInRow:p}},getActualTableWidth:function(){return e.reduce(this.cols,function(e,t){return e+this.calculateColumnWidth(t)+1},1,this)},getTargetColumns:function(t){var i=this,n=e.filter(t,function(e){return!i.getFixedColumnSize(e.x)}),a=e.filter(n,function(e){return!e.isCollapsed});return a.length?a:n},getZoomLevelCardWidth:function(t,i){var n=e.some(i,function(e){return!e.isCollapsed
}),a=n?t:"collapsed",r=this.getSizeInfo(a);return r.width},justifyWidth:function(){if(0!==e.keys(this.rows).length){var t=this.$grid[0].clientWidth||this.$grid.width(),i=t-this.getActualTableWidth();if(!(0>=i)){var n=this.getTargetColumns(this.cols);if(0!==n.length){var r=this.getCurrentZoomLevel(),s=this.getZoomLevelCardWidth(r,n),o=Math.floor(i/s);if(o>0){var l=a.calculate(n,o);this.distributeCardsIncrementation(n,l),i=t-this.getActualTableWidth()}this.distributeExtraWidthToColumns(n,i)}}}},distributeCardsIncrementation:function(t,i){e.each(t,function(t,n){var a=i[n];e.each(t.items,function(e){var i=e.cardsInRow+a;e.cardsInRow=i,t.cardsInRow=i})})},distributeExtraWidthToColumns:function(t,i){if(i>0){var n=t.length||1,a=this._distribute(i,n,Math.floor);e.each(t,function(e,t){e.extraWidth=a[t]})}return t},justifyHeight:function(){var t=this.getCurrentZoomLevel(),i=this.getSizeInfo(t),n=i.height,a=this;e.forEach(this.rows,function(e){e._sizes=[]}),e.forEach(this.cells,function(e){var t=e.cardsInCol,i=Math.ceil(e.cardsNum/e.cardsInRow)||1;if(t>=i){var r=n*i;e.cardsInCol=i,e.height=r}a.rows[e.data.y]._sizes.push(e.height)}),e.forEach(this.rows,function(e){e.height=Math.max.apply(null,e._sizes)}),e.forEach(this.cells,function(e){e.height=a.rows[e.data.y].height})},justifyHeightByHeader:function(){e.forEach(this.rows,function(t,i){t.minHeight=null;var n=e.find(this.headerCells,function(e){return e.data.y==i});n&&!n.isCollapsed&&(t.minHeight=n.$el.children().height())},this),e.forEach(this.cells,function(e){e.minHeight=this.rows[e.data.y].minHeight},this)},updateCells:function(){e.each(this.cells,this.iteratorUpdateCell,this)},iteratorUpdateCell:function(e){var t=e.$el,i=this.calculateCellWidth(e),n={width:i};e.minHeight&&(n["min-height"]=e.minHeight),t.css(n)},calculateCellWidth:function(e){return this.calculateColumnWidth(this.cols[e.data.x])},calculateColumnWidth:function(e){var t=e.items[0].$el;if(t.is(":hidden"))return 0;var i=this._getCardWidthByColumn(e);return i*e.cardsInRow+e.extraWidth+this.scrollWidth
},_getCardWidthByColumn:function(e){var t=this.getItemZoomLevelOrDefault(e.isCollapsed);return this.getSizeInfo(t).width},updateHeaders:function(){var t=this,i=t.sizeCalculator,n=function(i,n){var a=null===n?"null":n;return e.find(t.headerCells,function(e){return e.data[i]==a})};this.beforeRowsHeightRecalculation(),e.each(t.rows,function(e){var t=i.calculateHeight({row:e}),a=n("y",e.y);i.applyHeight(t,{headerCell:a,row:e})}),this.afterRowsHeightRecalculation(),e.each(t.cols,function(e){var a=i.calculateWidth({col:e,getCardWidth:t._getCardWidthByColumn.bind(t),zoomLevel:t.getCurrentZoomLevel()}),r=n("x",e.x);i.applyWidth(a,{headerCell:r,col:e})})},_distribute:function(e,t,i){var n=[],a=e;i=i||Math.round;for(var r=i(e/t),s=0;t>s;s++)n[s]=a?r:0,a-=r;return n[n.length-1]+=a,n}});return r}),define("tau/ui/extensions/board.plus/ui.board.plus.decorator.columns-resize",["Underscore","jQuery"],function(e,t){return function(i,n){e.defaults(n,{onResize:t.noop,resetTrigger:t.Deferred});var a=150,r=150,s=150,o=!1,l={__$decreaser:t('<button type="button" class="tau-board-grid-resize-controls__btn tau-board-grid-resize-controls__decreaser">-</button>'),__$increaser:t('<button type="button" class="tau-board-grid-resize-controls__btn tau-board-grid-resize-controls__increaser">+</button>'),__$element:t('<div class="tau-board-grid-resize-controls tau-board-grid-resize-controls_trigger-type-"/>'),__onControlClick:function(e){this.__deactivate(),this.hide(!0),o=!0,this.__$decreaser.is(e.target)&&!this.__$decreaser.is(":disabled")?c.decreaseColSize(this.__showConfig.colIndex):this.__$increaser.is(e.target)&&!this.__$increaser.is(":disabled")&&c.increaseColSize(this.__showConfig.colIndex),setTimeout(function(){o=!1},s)},__onMouseEnter:function(){this.__$element.removeClass("tau-board-grid-resize-controls_hiding"),this.__hideTimeoutId&&(clearTimeout(this.__hideTimeoutId),this.__hideTimeoutId=null)},__onMouseLeave:function(){this.__$element.addClass("tau-board-grid-resize-controls_hiding"),this.hide()
},__activate:function(){this.__isActive||(this.__isActive=!0,this.__$element.addClass("tau-active"))},__deactivate:function(){this.__isActive&&(this.__isActive=!1,this.__$element.removeClass("tau-active"))},__setControlsPosition:function(){var e=this.__showConfig.cursorY-this.__$element[0].getBoundingClientRect().top;this.__$element.children().css("top",e)},show:function(e){this.__showConfig=e,this.__$decreaser.attr("disabled",null).removeClass("tau-board-grid-resize-controls__btn__disabled"),this.__$increaser.attr("disabled",null).removeClass("tau-board-grid-resize-controls__btn__disabled"),n.decreaserEnabled(e.x)||(this.__$decreaser.attr("disabled","disabled"),this.__$decreaser.addClass("tau-board-grid-resize-controls__btn__disabled")),n.increaserEnabled(e.x)||(this.__$increaser.attr("disabled","disabled"),this.__$increaser.addClass("tau-board-grid-resize-controls__btn__disabled")),this.__$element.attr("class",function(t,i){return i.replace(/(tau-board-grid-resize-controls_trigger-type-)\w*/g,"$1"+e.triggerType)}),c.showResizer(this.__$element,e.position),this.__setControlsPosition(),this.__activateTimeoutId||(this.__activateTimeoutId=setTimeout(this.__getActivateTimeoutProxy(),a))},__activateTimeout:function(){this.__activateTimeoutId=null,this.__activate()},__getActivateTimeoutProxy:function(){return this.__showTimeoutProxy||(this.__showTimeoutProxy=t.proxy(this,"__activateTimeout")),this.__showTimeoutProxy},hide:function(t){this.__activateTimeoutId?(clearTimeout(this.__activateTimeoutId),this.__activateTimeoutId=null,this.__hideTimeout()):t?this.__hideTimeout():this.__hideTimeoutId||(this.__hideTimeoutId=setTimeout(e.bind(this.__hideTimeout,this),r))},__hideTimeout:function(){this.__hideTimeoutId=null,this.__deactivate(),c.hideResizer(this.__$element)},tryHide:function(e){e(this.__$element)&&this.hide()},destroy:function(){this.__$element.off(".resizer"),this.__$decreaser.remove(),this.__$increaser.remove(),this.__$element.remove()},init:function(){return this.__$element.append(this.__$decreaser,this.__$increaser),this.__$element.on({"click.resizer":e.bind(this.__onControlClick,this),"mouseenter.resizer":e.bind(this.__onMouseEnter,this),"mouseleave.resizer":e.bind(this.__onMouseLeave,this)}),this
}}.init(),u={__$element:t('<span class="tau-board-grid-resize-trigger"></span>'),__$triggerA:t('<div class="tau-board-grid-resize-trigger__a"/>'),__$triggerB:t('<div class="tau-board-grid-resize-trigger__b"/>'),__getResizerConfigInternal:function(e,t,i){return{x:e.data("x"),position:t[0].getBoundingClientRect().left,colIndex:e.index(),triggerType:i}},__getResizerConfig:function(e){var t=null,i=e.target,n=this.__$element.closest(".i-role-cellholder"),a=n.data("x"),r=n.closest(".i-role-board-body"),s=r.find('.i-role-header[data-dimension="x"] .i-role-cellholder[data-x="'+a+'"]');if(this.__$triggerA.is(i)){var o=s.prev(".i-role-cellholder");t=this.__getResizerConfigInternal(o,this.__$triggerA,"a")}else this.__$triggerB.is(i)&&(t=this.__getResizerConfigInternal(s,this.__$triggerB,"b"));return t.cursorY=e.clientY,t},__onMouseEnter:function(e){o||l.show(this.__getResizerConfig(e))},__onMouseLeave:function(e){o||l.tryHide(function(i){return t(e.relatedTarget).closest(i).length<=0})},attachTo:function(i){if(this.__$element[0].parentNode!==i){this.__$element.on({"mouseenter.resizer":e.bind(this.__onMouseEnter,this),"mouseleave.resizer":e.bind(this.__onMouseLeave,this)}),l.hide();var a=t(i).closest(".i-role-cellholder"),r=n.getLRVisibilityOptions(a),s=this.__$triggerA,o=this.__$triggerB;r.hideL?s.hide():s.show(),r.hideR?o.hide():o.show();var u=a.height();s.height(u),o.height(u),t(i).css("position","relative"),this.__$element.prependTo(i)}},detach:function(){l.hide(),this.__$element.closest(".i-role-cell").css("position",""),this.__$element.detach(),this.__$element.off(".resizer")},destroy:function(){this.__$element.remove(),this.__$triggerA.remove(),this.__$triggerB.remove()},init:function(){return this.__$element.append(this.__$triggerA,this.__$triggerB),this}}.init(),c={__toGridCoordinates:function(e){var t=this.__$element.find(".i-role-grid"),i=e-this.__$element[0].getBoundingClientRect().left,n=t.position(),a=n.left,r=t[0].clientWidth||t.width(),s=a+r-8,o=20,l=0;return Math.abs(a-i)<o?l=1:Math.abs(s-i)<o&&(l=-1),{coordinate:i,shift:l}
},increaseColSize:function(e){var t=this.__$element.find(".tau-cols-header, .tau-grid").find(".tau-cellholder:nth-child("+(e+1)+") .tau-cell").eq(0);n.onResize({type:"+",x:t.data("x")})},decreaseColSize:function(e){var t=this.__$element.find(".tau-cols-header, .tau-grid").find(".tau-cellholder:nth-child("+(e+1)+") .tau-cell").eq(0);n.onResize({type:"-",x:t.data("x")})},showResizer:function(e,t){var i=this.__toGridCoordinates(t),n=i.coordinate,a={0:"",1:"tau-board-grid-resize-controls__btn__right-shift","-1":"tau-board-grid-resize-controls__btn__left-shift"};e.removeClass(a[1]).removeClass(a[-1]).addClass(a[i.shift]),e.css("left",n).appendTo(this.__$element.find(".i-role-board-body"))},hideResizer:function(e){e.detach()},init:function(e){return this.__$element=e.find(".i-role-board-body-holder"),this.__$element.find(".i-role-grid").on({"mouseenter.resizer":function(){if(n.isAvailable()){var e=t(this),i=e.find(".i-role-cell");u.attachTo(i.get(0))}else u.detach()}},".i-role-cellholder"),e.on("remove",function(){this.__$element.find(".i-role-grid").off(".resizer"),u.destroy(),l.destroy()}.bind(this)),n.resetTrigger.progress(function(){u.detach()}),this}}.init(i)}}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.layout",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/layout/ui.board.plus.layout","tau/ui/extensions/board.plus/ui.board.plus.decorator.columns-resize","tau/models/board.customize.units/const.card.sizes","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n,a,r,s){return i.extend({init:function(t){this._triggerResizeDelayed=e.throttle(this.triggerResize.bind(this),100),this._super(t)},resetLifecycle:!0,isFixedSizeApplicable:function(e){var t=e.getCurrentZoomLevel(),i=e.getColumnsCount();return t>1&&6>t&&i>1},updateFixedColumnSize:function(t,i,n){t.get({fields:["columnSizes"],callback:function(a){e.defaults(a,{columnSizes:{}}),a.columnSizes[i.x]=i.size,n({col:i.x,size:i.size}),t.set({set:{columnSizes:a.columnSizes}})
}})},getResizeDecoratorSettings:function(e,t,i){var n=this;return{resetTrigger:e,isAvailable:function(){return n.isFixedSizeApplicable(t)},resolveColumnSize:function(e){return t.resolveColumnSize(e)},decreaserEnabled:function(e){var i=t.resolveColumnSize(e);return i>1},increaserEnabled:function(){return!0},onResize:function(e){var a=this.resolveColumnSize(e.x),r=e.type;"+"===r&&++a,"-"===r&&--a,e.size=a,n.updateFixedColumnSize(i,e,function(e){var i={};i[e.col]=e.size,t.setFixedColumnSize(i)})},getLRVisibilityOptions:function(e){var t="tau-collapsed_x",i=!1,n=!1;e.hasClass(t)&&(n=!0);var a=e.index();if(0===a)i=!0;else if(a>0){var r=e.parent(),s=r.children().eq(a-1);s.hasClass(t)&&(i=!0)}return{hideL:i,hideR:n}}}},applyColumnResizeDecorator:function(e,i,n,r){var s=this,o=t.Deferred();s.on("resize.executed",o.notify);var l=a(e,s.getResizeDecoratorSettings(o,i,r));return r.bind({fields:["columnSizes"],listener:s,callback:function(){s.triggerResize({})}}),l},createBoardLayout:function(){return new n},"bus cardsFullyLoaded":function(){this.triggerResize({})},"bus start.lifecycle + boardSettings.ready + overview.board.ready + view.dom.ready":function(e,t,i,n){var a=this,r=this.boardSettings=i.boardSettings,s=n.element,o=s.css("fontSize")||16,l=parseFloat(o),u=this.px=function(e){var t=Math.round(l);return e*t},c=u(.5),d=a.createBoardLayout();r.get({fields:["focus","zoomLevel","cells","columnSizes"],callback:function(e){var t=e.focus||{},i=t.x&&t.x.length>0,n=i?{}:e.columnSizes;d.setConfig({columnSizes:n,sizes:a._getSizes(u,e.cells.types),padding:c,scrollY:!1}),d.setElement(s),d.setCurrentZoomLevel(e.zoomLevel),i||a.applyColumnResizeDecorator(s,d,e,r),a.fire("boardLayout.ready",d),a.triggerResize({refreshElement:!0})}})},triggerResize:function(e){this.fire("resize.executed",e)},"bus initialize":function(i){var n=i.data.context.configurator;this._getSizes=this._getSizesV2;var a=e.throttle(e.bind(this.triggerResize,this,{}),250);t(n.getWindow()).on("resize.board",a)},"bus configurator.ready:last + boardSettings.ready":function(e,t,i){var n=i.boardSettings,a=this;
n.unbind({listener:a}),n.bind({fields:["zoomLevel"],listener:this,callback:function(e){a.triggerResize({zoomLevel:e.zoomLevel})}}),n.bind({fields:["edit"],listener:this,callback:function(){a.fire("view.edit.applied")}}),n.bind({fields:["cells"],listener:this,callback:function(){a.fire("cells.changed")}})},"bus view.edit.applied":function(){var e=this;setTimeout(function(){e.triggerResize({})},1)},"bus view.card.batch.move.completed":function(){this.triggerResize({onlyHeaders:!0})},"bus view.card.batch.move":function(){this.triggerResize({onlyHeaders:!0})},"bus view.card.order.changed":function(){},"bus view.card.group.changed":function(){this.triggerResize({onlyHeaders:!0})},"bus view.axis.collapser.executed.after":function(){this.triggerResize({refreshElement:!0})},"bus view.cell.skeleton.updated":function(){this._triggerResizeDelayed({})},"bus operation.execute.done":function(e,t){t&&t.operation&&"deleted"==t.operation.name&&this.triggerResize({refreshElement:!0})},"bus boardLayout.ready:last > resize.executed":function(t,i,n){var a=e.clone(n);i.setSizes(this._getSizes(this.px,this.boardSettings.settings.cells.types)),e.defaults(a,{onlyHeaders:!1,refreshElement:!1,zoomLevel:i.getCurrentZoomLevel()}),i.setCurrentZoomLevel(a.zoomLevel),i.config.useFixedColumnSizes=this.isFixedSizeApplicable(i),a.refreshElement&&i.refreshElement(),a.onlyHeaders?i.updateHeaders():(i.updateSize(),this.fire("board.size.updated",{element:i.$el}),this.fire("board.layout.updated",{element:i.$el})),this.fire("resize.completed",a),this.fire("overview.board.updated",i.$el)},"bus overview.board.ready:last+overview.board.retrieve":function(t){var i=e.values(t)[0].data.element;this.fire("overview.board.retrieved",i)},"bus boardSettings.ready:last+destroy":function(t){var i=e.values(t)[0].data.boardSettings;i.unbind({listener:this})},"bus initialize:last+destroy":function(i){var n=e.values(i)[0].data.context.configurator;t(n.getWindow()).off("resize.board")},_getSizesV2:function(e,t){for(var i,n={collapsed:{width:12,height:12,cardsInRowMax:5,cardsInRowMin:5},1:{width:24,height:24,cardsInRowMax:3,cardsInRowMin:3,clientColsMin:5,clientRowsMin:5}},a=t[0],o=8,l=2;6>=l;l++)i=s.getCardSize(a,r.zoomToSize(l),o),n[l]={width:i.width,height:i.height,clientColsMin:2,clientRowsMin:2};
return n}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.dom.updater.board",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({hideRawSkeleton:function(e){e.children().css({opacity:0})},showRawSkeleton:function(e){e.children().animate({opacity:1})},"bus view.skeleton.built":function(e,t){this.hideRawSkeleton(t.element)},"bus view.skeleton.built > board.size.updated":function(e,t){this.showRawSkeleton(t.element)},"bus view.skeleton.built > no.data.in.slice":function(e,t){this.showRawSkeleton(t.element)},"bus page.ready > page.changed":function(e,t,i){var n=this.getDirection(t,i);this.fire("refresh",{page:{from:t,to:i,direction:n}})},"bus refresh > board.element.updated":function(t,i,n){var a=i||{},r=n.oldElement,s=n.newElement,o=r.parent();o.append(s);var l=e.Deferred(),u=null;u=a.page&&a.page.direction?function(){this.swap(r,s,a.page.direction)}.bind(this):function(){r.hide().removeClass("tau-board-becomes-old").replaceWith(s)},l.done(u).fail(function(){r.hide().remove()}),this.fire("board.reload",l)},"bus afterRender:last > refresh":function(e,t,i){i&&i.page&&i.page.direction||t.element.addClass("tau-board-becomes-old")},"bus board.reload > refresh":function(e,t){t.reject()},"bus board.reload > no.data.in.slice":function(e,t){t.resolve()},"bus board.reload > overview.board.ready > board.size.updated":function(e,t){t.resolve()},"bus operation.highlightItems > domWrapper.ready":function(e,t,i){i.highlightAxesLines(t)},swap:function(e,t,i){var n=this.directionToProperty(i),a={};e.find(".i-role-grid").css("overflow","hidden"),t.find(".i-role-grid").css("overflow","hidden"),a[n]="+=100%",t.css(n,"-100%"),e.add(t).animate(a,{duration:750,complete:function(){t.css(n,""),t.find(".i-role-grid").css("overflow",""),setTimeout(function(){e.remove()},50)}})},getDirection:function(e,t){var i=null;return e.x==t.x?e.y-t.y==1?i="up":e.y-t.y==-1&&(i="down"):e.y==t.y&&(e.x-t.x==1?i="left":e.x-t.x==-1&&(i="right")),i
},directionToProperty:function(e){return{up:"top",down:"bottom",left:"left",right:"right"}[e]}})}),define("tau/models/board.plus/model.board.dragndrop",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n=i.extend({resetLifecycle:!0,defaultOptions:{simpleCommands:{move:!0}},_onBoardSettingsReady:function(e){var t=this.fire.bind(this,"dndOptions.refresh");e.get(["prioritization"]).then(t),e.unbind({listener:this}),e.bind({fields:["prioritization"],listener:this,callback:t})},"bus configurator.ready":function(e,t){this._onBoardSettingsReady(t.service("boardSettings"))},"bus configurator.ready:last + model.cells.metaInfo.ready:last + dndOptions.refresh":function(i,n,a){var r=e.pick(a,"isPrioritizable");t.when(this._prepareOptionsOnInit(r,n)).then(e.bind(function(e){n.getGlobalBus().fire("isPrioritizable.ready",e.isPrioritizable),this.fire("dndOptions.ready",e||{})},this))},"bus model.sliceInfo.retrieved":function(t,i){var n={};e.forEach(["x","y"],function(t){n[t]=e.map(i[t].data,function(e){return e[t]})}),this.fire("conditions.ready",n)},"bus conditions.ready:last + dndOptions.ready:last + slice.ready:last + shift.isPressed + view.card.batch.move":function(i,n,a,r,s,o){t.when(this._prepareOptionsOnExecute(a,s)).then(e.bind(function(e){return this.fire("shift.isPressed",s),this._prepareCommand(r.slice,o,e,n)},this)).then(function(e){return e()}).always(this._afterCardBatchMove.bind(this,o))},"bus dndOptions.ready:last + slice.ready:last + model.sliceInfo.retrieved:last + view.card.batch.move.before":function(t,i,n,a,r){var s=this._getMoveSuggestedCells(n.slice,a,r,i);this._moveBefore={command:s},s.then(e.complexProperty("data.items"),this._failureMoveHandler.bind(this,[],i)).then(this._afterMoveBefore.bind(this,r))},"bus view.card.batch.move.before.abort":function(){this._moveBefore&&this._moveBefore.command&&this._moveBefore.command.reject({data:{status:0}})},_afterMoveBefore:function(e,t){this._moveBefore=null,this.fire("view.card.batch.move.before.completed",t)
},_afterCardBatchMove:function(e,t){this.fire("view.card.batch.move.after",t)},_prepareOptionsOnInit:function(t,i){var n=i.service("boardSettings");return n.get(["cells","prioritization"]).then(e.bind(function(i){var n=e.defaults(i.cells.ordering||{},{direction:"Desc"}),a=e.defaults(i.prioritization||{},{mode:"enabled"});return t=e.clone(t),t=e.defaults(t,e.deepClone(this.defaultOptions),{isPrioritizable:!0,simpleCommands:{},prioritizationSettings:a}),t.sortAfter=t.isPrioritizable,t.sortAfterDir=n.direction.toLowerCase(),"disabled"==t.prioritizationSettings.mode&&(t.isPrioritizable=!1),t.isPrioritizable&&(t.simpleCommands.prioritize=!0),t.enable=this._hasCommands(t),t.isPrioritizable&&"shift"===t.prioritizationSettings.mode&&(t.isPrioritizable="shift"),t},this))},_hasCommands:function(t){return e.any(t.simpleCommands)},_prepareCommandName:function(t){var i;return this._hasCommands(t)&&(i=e.keys(t.simpleCommands).sort(),i=e.camelize(i.join(" and "))+"Batch"),i},_prepareOptionsOnExecute:function(e,t){return e.isPrioritizable&&"shift"===e.prioritizationSettings.mode&&(t?e.simpleCommands.prioritize=!0:delete e.simpleCommands.prioritize),e},_prepareParameters:function(t,i,n){var a=e.map(t,function(t){var n=t.source,a=t.target,r={itemId:n.entityId};return i.simpleCommands.move&&(r=e.extend(r,{oldX:n.x,oldY:n.y,x:a.x,y:a.y,type:n.entityType})),i.simpleCommands.prioritize&&(r=e.extend(r,{beforeItemId:a.beforeEntityId||null,afterItemId:a.afterEntityId||null})),r}),r={$set:{items:a}};return n.x.length&&(r.x={$in:n.x}),n.y.length&&(r.y={$in:n.y}),r},_createResponseItems:function(t,i){var n=e.unique(t,!1,function(e){return e.sliceId}),a=e.map(i,function(t){var i=e.find(n,function(e){if(!t.items||0===t.items.length)return null;var i=t.items[0];return i.dataItem.id===e.sliceId});return{srcItem:i,responseItem:t}}),r=e.filter(a,function(e){return e.srcItem}),s=e.filter(a,function(e){return!e.srcItem&&e.responseItem.items&&0!==e.responseItem.items.length}),o=e.map(s,function(e){var t=e.responseItem.items[0],i={sliceId:t.dataItem.id,targetX:t.x,targetY:t.y,entityType:t.dataItem.type,entityId:t.dataItem.id,commands:[{moveAndPrioritizeBatch:{executed:!1,error:!1,result:[]}}]};
return{srcItem:i,responseItem:e.responseItem}});return e.union(r,o)},_successMoveHandler:function(t,i,n){var a=this._createResponseItems(t,n.data.items),r=this._prepareCommandName(i);return e.map(a,function(t){var n=t.srcItem,a=t.responseItem.items;0===a.length&&a.push({x:"__x_not_in_slice__",y:"__y_not_in_slice__",dataItem:{id:n.sliceId,type:n.entityType,data:{id:n.entityId,type:n.entityType,name:""}},notInSlice:!0});var s=e.map(a,function(e){var t={dataItem:e.dataItem,notInSlice:e.notInSlice};return i.simpleCommands.move&&(t.x=e.x,t.y=e.y),t});return n.commands[r]={executed:!0,error:!1,result:s},n})},_failureMoveHandler:function(t,i,n){var a=this._prepareCommandName(i),r=this._getError(n);return e.forEach(t,function(e){e.commands[a]={executed:!0,error:r,result:[]}}),t},_getError:function(e){return e?e.data?e.data.responseText:{message:e.response.Message}:{message:"Error"}},_generateDefaultOutput:function(t,i){var n=this._prepareCommandName(i);return e.map(t,function(e){var t=e.uid,i=e.source,a=e.target,r={sliceId:i.sliceId,targetX:a.x,targetY:a.y,entityType:i.entityType,entityId:i.entityId,elementId:i.elementId,uid:t,commands:{}};return r.commands[n]={executed:!1,error:!1,result:[]},r})},_command:function(i,n,a,r){var s=this._generateDefaultOutput(n,a),o=this._prepareParameters(n,a,r),l=this._prepareCommandName(a);return l?t.when(l,o).then(function(e,t){return i[e](t)}).then(this._successMoveHandler.bind(this,s,a),this._failureMoveHandler.bind(this,s,a)):(e.each(s,function(e){e.commands={moveAndPrioritizeBatch:{error:{isCanceled:!0}}}}),t.Deferred().resolve(s))},_prepareCommand:function(t,i,n,a){return i=e.filter(i,function(e){return e.source.sliceId}),e.bind(this._command,this,t,i,n,a)},_getMoveSuggestedCells:function(t,i,n){var a=e.pluck(i.x.data,"x"),r=e.pluck(i.y.data,"y");n=e.filter(n,function(e){return e.source.sliceId});var s={$whereX:a.length?{x:{$in:a}}:void 0,$whereY:r.length?{y:{$in:r}}:void 0,$set:{items:e.map(n,function(e){return{itemId:e.source.entityId}
})}};return t.getCellsUnavailableToMove(s)}});return n}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.base",["Underscore","jQuery","tau/core/extension.base","tau/ui/extensions/board.plus/ui.board.plus.dom.utils"],function(e,t,i,n){return i.extend({resetLifecycle:!0,_eventNameSpace:".dragndrop",_groups:".i-role-grid .i-role-cellholder",_items:".i-role-card","bus $el.ready":function(i,n){var a=n.find(".i-role-header[data-dimension=x]"),r=n.find(".i-role-header[data-dimension=y]");this.fire("$headerX.ready",a),this.fire("$headerY.ready",r);var s=e.bind(this.fire,this,"shift.isPressed");s(!1);var o=function(e){this.isShiftPressed=!0,e.shiftKey&&s(this.isShiftPressed)},l=function(){this.isShiftPressed=!1,s(this.isShiftPressed)};t(document).on("keydown"+this._eventNameSpace,o).on("keyup"+this._eventNameSpace,l)},"bus $selectable.ready":function(e,t){this._$selectable=t},destroy:function(){t(document).off(this._eventNameSpace),this._$selectable=null,this._super()},_$containment:function(e,t){return e.find("newlist"===t?".i-role-cellholder":"list"===t?".i-role-cellholder":"table")},_$sortable:function(e,t,i){return"newlist"===i?t.find(".i-role-cell"):e},_$getSelectableByCard:function(){return this._$selectable},_get$selectable:function(e){return e},"bus $el.ready:last + $grid.ready:last + viewMode.ready:last + dndOptions.ready + configurator.ready:last":function(e,t,i,n,a){var r=this._$containment(i,n),s=this.$sortable=this._$sortable(i,t,n);this.dndOptions=a,s.data("ui-tauSortable")&&(s.tauSortable("destroy"),s.off(".board")),("newlist"!==n||"disabled"!=a.prioritizationSettings.mode)&&a.enable&&(s.tauSortable({groups:this._groups,items:this._items,appendTo:i,containment:r,addClasses:!1,useSelectable:this._get$selectable(i),createPlaceholderContent:this._getPlaceholderContentCreator.bind(this)(),moveInGroup:a.isPrioritizable,processToGroup:this._processToGroup.bind(this)}),this.fire("$sortable.ready",s))},_getPlaceholderContentCreator:function(){return n.createDragNDropPlaceholderContent
},_processToGroup:function(e,t,i){if(!t.is(i)){var n=i;i.is(".i-role-cellholder")&&(n=i.children(".i-role-cell")),t.is(n)||(n.data("emptyBeforeDrop",!this.cellHasCards(n)),e.appendTo(n))}},"bus $sortable.ready":function(){this.onSortableReady()},onSortableReady:function(){this.$sortable.on("tausortablestart.board",function(e,t){t.helper&&t.helper.find(".i-role-card").addClass("tau-card-v2_dnd_helper").removeClass("i-role-card"),t.items.removeClass("i-role-card"),this.fire("sort.started",[e,t]),this.fire("sort.connected.started",[e,t])}.bind(this)),this.$sortable.on("tausortablechanged.board",function(e,t){this.fire("sort.changed",[e,t])}.bind(this)),this.$sortable.on("tausortablegroupentered.board",function(e,t){this.fire("sort.groupentered",[e,t])}.bind(this)),this.$sortable.on("tausortablegroupleft.board",function(e,t){this.fire("sort.groupleft",[e,t])}.bind(this)),this.$sortable.on("tausortablegroupchanged.board",function(e,t){this.fire("sort.groupchanged",[e,t])}.bind(this)),this.$sortable.on("tausortablestop.board",function(e,t){t.items.addClass("i-role-card"),this.fire("sort.stopped",[e,t]),this.fire("sort.connected.stopped",[e,t])}.bind(this)),this.$sortable.on("tausortablestartconnected.after.board",function(e,t){this.fire("sort.connected.started",[e,t])}.bind(this)),this.$sortable.on("tausortablestopconnected.after.board",function(e,t){this.fire("sort.connected.stopped",[e,t])}.bind(this))},"bus options.ready:last+sort.started":function(i,n,a){if(n.dragndrop.containmentRefreshTimeout){var r=a[1],s=t(r.item);e.delay(function(e){e&&e.data("ui-draggable")&&e.data("ui-draggable")._setContainment()},n.dragndrop.containmentRefreshTimeout,s)}},"bus configurator.ready:last + sort.connected.started":function(i,n,a){if(n.getFeaturesService().isEnabled("move.highlight")){var r=e.chain(a[1].items).map(function(e){return t(e).data("boardDnd")}).compact().value();this._highlightNotAvailableCells(r)}},"bus $sortable.ready:last+sort.changed":function(){this.fire("view.card.order.changed")
},"bus $sortable.ready:last+$headerX.ready:last+$headerY.ready:last+sort.groupentered":function(e,t,i,n,a){var r=a[1];r&&r.group&&(r.group.is(".tau-cell-not_available")?this._toggleCursor(r,!0):this._toggleCursor(r,!1),this.highlightTarget(t,r.group,i,n)),this.fire("view.card.group.changed")},"bus $sortable.ready:last+$headerX.ready:last+$headerY.ready:last+sort.groupleft":function(e,t,i,n,a){var r=a[1];r&&r.group&&this.unhighlightTarget(t,r.group,i,n),this.fire("view.card.group.changed")},"bus $sortable.ready:last+$headerX.ready:last+$headerY.ready:last+sort.stopped":function(e,t,i,n,a){var r=a[1];r&&r.group&&this.unhighlightTarget(t,r.group,i,n)},"bus sort.stopped":function(i,n){this.fire("view.card.batch.move.before.abort");var a=n[1];if(a.item){var r=e.compact(e.map(a.items,function(e){return t.data(e,"boardDnd")}));if(r=e.sortBy(r,function(e){return e.order}),a.isReverted){var s=e.map(r,function(t){var i=e.pick(t.source,"elementId","entityId","entityType","sliceId");return i.commands={moveAndPrioritizeBatch:{error:{isCanceled:!0}}},i});this.fire("view.card.batch.move.after",s)}else this.fire("view.card.batch.move",r)}},_highlightDroppedCards:function(t,i,n){var a=t.getSliceFactoryOptions().options.DnDTurnOffCometWhenItemsCountExceed,r=n.cards||[];return r.length>a&&e.each(r,e.bind(i,null,"tau-card_highlighted")),n},_expandEmptyCollapsedCells:function(i,n){return e.each(n.$affectedCells,e.bind(function(e){var n=t(e);n.data("emptyBeforeDrop")&&n.parent().hasClass("tau-collapsed")&&i.expandCell(this,n.data("x"),n.data("y"))},this)),n},_orderingValue:function(e){return parseFloat(e.data("orderingValue"))},"bus configurator.ready:last + cardLayoutFactory.ready:last + domWrapper.ready:last + dndOptions.ready:last + view.card.batch.move.after":function(i,n,a,r,s,o){var l=this,u=l.unpackMovementResponse(o,r),c={x:o.length>0?o[0].targetX:null,y:o.length>0?o[0].targetY:null},d=t();e.each(u.error,e.bind(function(e){d=d.add(e.$card),r.animateWithClass("tau-card_failed",e.$card),e.error.isCanceled||l.fire("dragndrop.error",e.error)
}),this);var p=e.map(d.toArray(),function(e){var i=t(e),n=i.data("boardDnd");return{$card:i,source:n.source||{},target:n.target||{}}});this.restoreErrorCardsPositions(p).then(e.bind(this.processCardsPositions,this,u,c,r,n,a)).then(e.bind(this._highlightDroppedCards,this,n,r.animateWithClass)).then(e.bind(this._expandEmptyCollapsedCells,this,r)).then(e.bind(function(i){if(s.sortAfter){var n="asc"==s.sortAfterDir?function(e,t){return e>t}:function(e,t){return t>e};e.each(i.cards,function(e){var i=l._orderingValue(e),a=e.parents(".i-role-cell:first"),s=a.children(".i-role-card").not(e);if(n(l._orderingValue(s.last()),i)){var o=r.getUnsortedCardsHolder(a);o.length||(o=a.find(".i-role-cell-paging-stack").length?r.createUnsortedCardsHolder().appendTo(a):a),o.append(e)}else{var u=s.filter(function(e,a){return n(l._orderingValue(t(a)),i)});if(u.length){var c=u.last();c.next().is(e)||(r.animateWithClass(r.ANIMATION_CARD_UPDATED,e),c.after(e))}else e.prependTo(a)}})}else e.each(i.cards,function(e){var t=e.parents(".i-role-cell:first"),i=r.getUnsortedCardsHolder(t);i.length||(i=t),e.prev(".i-role-card").length||e.next(".i-role-card").length||i.append(e)});return i.cards||[]},this)).done(e.bind(function(e){this.completeEventsProtocol(e),this.fire("view.card.batch.move.finished",{})},this))},"bus domWrapper.ready:last + sort.connected.started:last + view.card.batch.move.before.completed":function(t,i,n,a){var r=n[1],s="tau-cell-not_available";e.each(a,function(t){var n=null;if(t.xIsAny)n=i.getCellHoldersForAxis("y",t.y);else if(t.yIsAny)n=i.getCellHoldersForAxis("x",t.x);else{var a=e.clone(t);a.x=a.x||"null",a.y=a.y||"null",n=i.getCellHolderByCoordinates(a)}n&&(n.toggleClass(s,!0),this._toggleTargetCells(n,!1),this._toggleCrossingCells(n,!1))},this),r.group.is(".tau-cell-not_available")&&this._toggleCursor(r,!0),this.fire("view.card.batch.move.highlighted")},"bus domWrapper.ready:last + sort.connected.stopped":function(i,n){var a="tau-cell-not_available",r=n.getGrid().find(".i-role-cellholder.tau-cell-not_available");
e.each(r,function(e){t(e).toggleClass(a,!1)})},_cardBatchMoveVisualEffects:function(e){return e.getFeaturesService().isEnabled("board.cardBatchMoveVisualEffects")},"bus configurator.ready:last + domWrapper.ready:last + view.card.batch.move":function(t,i,n,a){this._cardBatchMoveVisualEffects(i)&&e.each(a,function(e){n.getCardBySliceId(e.target.sliceId).tauProgressIndicator().tauProgressIndicator("show",{hover:!0})})},"bus configurator.ready:last + domWrapper.ready:last + view.card.batch.move.after":function(t,i,n,a){this._cardBatchMoveVisualEffects(i)&&e.each(a,function(e){n.getCardBySliceId(e.sliceId).tauProgressIndicator().tauProgressIndicator("hide")})},"bus configurator.ready:last + view.card.batch.move.$successCards":function(e,t,i){var n=t.getSliceFactoryOptions().options.DnDTurnOffCometWhenItemsCountExceed;i.length>n&&this.fire("refresh")},processCardsPositions:function(e,t,i,n,a){var r=e.success;if(!r.length)return{};var s=this.extractBatchesUpdates(r);return i.applyCardsBatchMove({targetCellCoordinates:t,options:this._getAnimationOptions(n,r),layout:a,items:s})},_getAnimationOptions:function(e,t){return{suspendAnimation:!this._shouldShowAnimation(e,t)}},_shouldShowAnimation:function(e,t){return this._cardsAreBelowAnimationLimit(e,t)&&this._cardBatchMoveVisualEffects(e)},_cardsAreBelowAnimationLimit:function(e,t){return t.length<=e.getSliceFactoryOptions().options.DnDTurnOffCometWhenItemsCountExceed},extractBatchesUpdates:function(t){for(var i=[],n=function(e){return{x:e.x,y:e.y,data:e.dataItem,notInSlice:e.notInSlice}},a=0,r=t.length;r>a;a++){var s=t[a],o=e.map(s.moves,n);o.length&&o[0].data.data&&i.push(o)}return i},completeEventsProtocol:function(e){this.fire("view.card.batch.move.$successCards",e),this.fire("view.card.batch.move.completed",e),e.length&&this.fire("selection.reapply",{})},restoreErrorCardsPositions:function(i){var n=t.Deferred(),a=this;i=e.sortBy(i,function(e){return e.source.index});var r=e.map(i,function(e){return function(n){var r=e.$card,s=e.source,o=t("#"+s.cellElementId);
if(s.beforeElementId){var l=o.find("#"+s.beforeElementId);l.length?r.insertAfter(l):r.prependTo(o)}else r.prependTo(o);a._$getSelectableByCard(r).tauSelectable("option","fireEvents",!1),a._$getSelectableByCard(r).tauSelectable("select",r),a._$getSelectableByCard(r).tauSelectable("option","fireEvents",!0),1==i.length&&a._$getSelectableByCard(r).tauSelectable("raiseChanged",r,!0,!0),n()}});return r=e.map(r,function(e){return function(t){e(t)}}),e.series(r,function(){n.resolve()}),n},toggleTarget:function(e,t,i,n,a){if(e.find(t).length){var r=t.index()+1,s=e.find("tr > .i-role-cellholder:nth-child("+r+")").not(t),o=a?s.not(".tau-cell-not_available"):s,l=t.siblings(),u=a?l.not(".tau-cell-not_available"):l;if(l.length>0&&(this._toggleCrossingCells(o,a),i.length)){var c=i.find(".i-role-cellholder:nth-child("+r+")");this._toggleCrossingCells(c,a)}if(s.length>0&&(this._toggleCrossingCells(u,a),n.length)){var d=n.find(".i-role-cellholder[data-y="+t.data("y")+"]");this._toggleCrossingCells(d,a)}if(!t.is(".tau-cell-not_available")){var p=l.length>0,f=s.length>0;p&&f?this._toggleTargetCells(t,a):(p||f)&&this._toggleCrossingCells(t,a)}}},cellHasCards:function(e){var i=t(e).children(".i-role-card");return i.length>0},highlightTarget:function(e,t,i,n){this.toggleTarget(e,t,i,n,!0)},unhighlightTarget:function(e,t,i,n){this.toggleTarget(e,t,i,n,!1)},assignResponseItemUID:function(t){var i=t.uid;return e.forEach(t.commands,function(t){t.result=e.map(t.result,function(e){return e.uid=i,e})}),t},unpackMovementResponse:function(t,i){for(var n=i.getCards(),a={error:[],success:[]},r=0,s=t.length;s>r;r++){var o=t[r];o=this.assignResponseItemUID(o);var l=e.chain(e.values(o.commands));o.error=l.pluck("error").concat().compact().value()[0]||null,o.moves=l.pluck("result").concat().compact().value()||[];var u=o.error?"error":"success";o.$card=n.filter("#"+o.elementId),a[u].push(o)}return a},_toggleCrossingCells:function(e,t){e.toggleClass("tau-cellholder_dndcrossing_true",t)},_toggleTargetCells:function(e,t){e.toggleClass("tau-cellholder_dndtarget_true",t)
},_toggleCursor:function(e,t){e.helper.find(".tau-card-v2_dnd_helper").css("cursor",t?"not-allowed":"")},_highlightNotAvailableCells:t.noop})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.base","tau/ui/behaviour/common/ui.behaviour.progressIndicator"],function(e,t,i){return i.extend({_appendToGroupDelay:500,_addCardToGroup:function(e,t){e.appendTo(t),this.fire("view.card.group.changed")},_resetAppendToGroupTimer:function(){clearTimeout(this._appendToGroupTimer),this._appendToGroupTimer=null},_processToGroup:function(e,t,i){if(!t.is(i)){var n=i;if(i.is(".i-role-cellholder")&&(n=i.children(".i-role-cell")),!t.is(n)){n.data("emptyBeforeDrop",!this.cellHasCards(n));var a=this.dndOptions.isPrioritizable,r=a===!0||"shift"===a&&this.isShiftPressed,s=r||this._isDragBeingStopped;s?e.appendTo(n):(this._$currentGroup=n,this._$draggedItem=e,this._appendToGroupTimer=setTimeout(function(){this._addCardToGroup(e,n)}.bind(this),this._appendToGroupDelay))}}},onSortableReady:function(){this._super(),this.$sortable.on("tausortablestart.board",function(){this._isDragBeingStopped=!1}.bind(this)),this.$sortable.on("tausortablebeforegroupentered.board",function(e,t){var i=t.group.is(this._$currentGroup);!i&&this._appendToGroupTimer&&this._resetAppendToGroupTimer()}.bind(this)),this.$sortable.on("tausortablebeforestop.board",function(){this._appendToGroupTimer&&(this._resetAppendToGroupTimer(),this._$draggedItem.appendTo(this._$currentGroup)),this._isDragBeingStopped=!0}.bind(this))},_highlightNotAvailableCells:function(e){this.fire("view.card.batch.move.before",e)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.selection.board",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({resetLifecycle:!0,createSelectableContainers:function(e){return[{element:e[0]}]},"bus configurator.ready":function(e,t){var i=t.getClipboardManager();i.getAll(function(e,t){this.fire("cardsData.ready",{cards:t,isInitial:!0})
}.bind(this)),i.unbind(this),i.bind(this,function(e,t){this.fire("cardsData.ready",{cards:t,isInitial:!1})}.bind(this))},"bus configurator.ready+options.ready":function(t,i,n){var a=e.bind(function(e,t,i){e[t](i)},this,i.getClipboardManager());n.clipboard.processTimeout&&(a=e.debounce(a,n.clipboard.processTimeout)),this.fire("clipboardProcess.ready",a)},"bus configurator.ready:last + $grid.ready":function(t,i,n){var a=this.createSelectableContainers(n);e.each(a,e.bind(this._configureSelectableItem,this,i,a))},"bus scrollManager.ready:last+$selectable.ready:last+view.card.selected":function(t,i,n,a){var r=n.closest(".tau-app-main-pane"),s=!r.hasClass("tau-layout-board_south-expanded_true"),o=a.element;s&&a.selected&&e.delay(function(){var e=r.hasClass("tau-layout-board_south-expanded_true");e&&1==o.length&&i.scrollToVisibility(o)},1e3)},"bus view.cell.skeleton.updated":function(e,t){this.fire("$selectionScope.ready",t.element.parents(".i-role-grid:first"))},"bus overview.board.ready":function(e,t){this.fire("$selectionScope.ready",t.element.find(".i-role-grid"))},"bus $selectable.ready:last+$selectionScope.ready:last+cardsData.ready:last":function(e,t,i,n){this._applySelection(t,i,n.cards,n.isInitial)},"bus $selectable.ready:last+$selectionScope.ready:last+cardsData.ready:last + selection.reapply":function(e,t,i,n){this._applySelection(t,i,n.cards,n.isInitial)},"bus configurator.ready:last + $selectable.ready:last+clipboardProcess.ready:last+view.card.selected":function(e,i,n,a,r){var s=r.element,o=r.selected,l=[],u=[],c=n.tauSelectable("getSelected").not(s);s.each(function(){var e=t(this),i=e.data(),n=c.filter(function(){var n=t(this),a=n.data();return i.id==a.id&&i.entityType.toLowerCase()==a.entityType.toLowerCase()&&n.attr("id")!=e.attr("id")});if(!n.length){var a;a={id:i.id,isSelected:!0,data:{cardData:i.cardData,id:i.entityId,type:i.entityType}},o?l.push(a):u.push(a)}}),a("add",l),a("remove",u)},"bus $selectable.ready:last + sort.stopped":function(e,i,n){var a=n[1],r=a.items||t();
i.tauSelectable("option","fireEvents",!1),i.tauSelectable("reset",r),i.tauSelectable("option","fireEvents",!0)},"bus clipboardProcess.ready:last+view.card.batch.move.$successCards":function(t,i,n){var a=[];e(n).each(function(e){var t=e.data(),i={id:t.id,data:{cardData:t.cardData,id:t.entityId,type:t.entityType}};a.push(i)}),i("remove",a)},"bus clipboardProcess.ready:last + operation.notinslice":function(e,t,i){this._cometRemove(t,i.items)},"bus clipboardProcess.ready:last + operation.deleted":function(e,t,i){this._cometRemove(t,i.items)},_cometRemove:function(t,i){var n=e.map(i,function(e){var t=e.data;return{id:t.id,data:{type:t.type}}});t("remove",n)},_configureSelectableItem:function(e,i,n){var a="tau-selected",r=".tau-cellholder .tau-card-v2",s=":not(.tau-board-unit-not-selectable,[contenteditable=true])",o=".i-role-cellholder, .i-role-cell",l=t(n.element);l.tauSelectable({items:".i-role-card",triggerSelector:s,ctrl:!0,selectOnMouseup:!0,className:a,changed:function(e,t){var n=t.item,a=t.selected;this.fire("view.card.selected",{element:n,selected:a}),a&&this._clearSelectionExcept(i,l[0])}.bind(this)}),this.fire("$selectable.ready",l),l.pscroller({getScrollHeight:n.getScrollHeight,applyVerticalScrollOffset:n.applyVerticalScrollOffset}),l.rselect({getVerticalScrollPosition:n.getVerticalScrollPosition,clipHorizontal:n.clipHorizontal,clipVertical:n.clipVertical,trigger:this._concatSelectors([o,n.rectSelectTriggers]),selectionClass:a,selectable:r,show:function(e){t(e.target).pscroller("enable")},end:function(e,n){t(e.target).pscroller("disable"),l.tauSelectable("option","fireEvents",!1),l.tauSelectable("select",t(n.selection)),l.tauSelectable("option","fireEvents",!0),this.fire("view.card.selected",{element:t(n.selection),selected:!0}),this.fire("view.card.selected",{element:t(n.deselection),selected:!1}),this._clearSelectionExcept(i,l[0])}.bind(this)})},_applySelection:function(i,n,a,r){var s="tau-is-selected-duplicate",o=i.tauSelectable("getSelected").filter(function(){return t(this).parents().is(n)
}),l=t(),u=n.find(".i-role-card");u.removeClass(s),e(a).each(function(e){var i=u.filter(function(){var i=t(this).data();return e.data.id==i.entityId&&e.data.type.toLowerCase()==i.entityType.toLowerCase()});i.length>1&&i.addClass(s);var n=i.filter(function(){return o.is(this)});n.length&&(i=n),r&&(i=i.eq(0)),l=l.add(i)});var c=o.not(l);i.tauSelectable("option","fireEvents",!1),i.tauSelectable("reset",c),i.tauSelectable("select",l),i.tauSelectable("option","fireEvents",!0)},_clearSelectionExcept:function(i,n){e.each(i,function(e){if(n!==e.element){var i=t(e.element);i.rselect("clearSelection"),i.tauSelectable("clearSelection")}})},_concatSelectors:function(t){return e.compact(t).join(", ")}})}),define("tau/ui/extensions/board.plus/ui.board.plus.scrollManager",["jQuery","tau/core/class"],function(e,t){var i=t.extend({init:function(){this.$element=null},setElement:function(t){this.$element=e(t)},getScrollableElement:function(){return this.$element},getScrollableChild:function(e){return e.children("table")},scrollToVisibility:function(e,t){var i=this.getScrollableElement(),n=this.getScrollableChild(i);t=t||!1;var a=i[0].getBoundingClientRect(),r=e[0].getBoundingClientRect();if(r.bottom>=a.bottom)if(t)i.scrollTo(e,t);else if(n.length){var s=n[0].getBoundingClientRect();i[0].scrollTop=Math.ceil(r.top)-Math.ceil(s.top)-Math.ceil(a.height)+Math.ceil(r.height)+20}t&&t.onAfter&&t.onAfter.call()}});return i}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.scrollManager",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({init:function(e,t){this._super(e),this.scrollManagerInstance=t},getScrollManager:function(){return this.scrollManagerInstance},"bus $el.ready+$grid.ready":function(e,t,i){var n=this.getScrollManager();n.setElement(i),this.fire("scrollManager.ready",n)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.scroll",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready:last + $grid.ready:last + view.axis.collapser.executed.before":function(i,n,a){var r,s,o=a[0].getBoundingClientRect(),l=a.find(".tau-cell");
if(l.each(function(){var e=t(this),i=this.getBoundingClientRect();return i.left=i.left-1,i.top>=o.top&&i.top<=o.bottom&&i.left>=o.left&&i.left<=o.right?(s=e,!1):void 0}),s||l.each(function(){var e=t(this),i=this.getBoundingClientRect();return i.left=i.left-1,i.top<=o.top&&i.bottom>=o.top&&i.left>=o.left&&i.left<=o.right?(s=e,!1):void 0}),s||l.each(function(){var e=t(this),i=this.getBoundingClientRect();return i.left=i.left-1,i.top>=o.top&&i.top<=o.bottom&&i.left<=o.left&&i.right>=o.left?(s=e,!1):void 0}),s||l.each(function(){var e=t(this),i=this.getBoundingClientRect();return i.left=i.left-1,i.top<=o.top&&i.bottom>=o.top&&i.left<=o.left&&i.right>=o.left?(s=e,!1):void 0}),r=s,r&&r.length){var u=r.position();u.top<0&&(u.top=0),u.left<0&&(u.left=0);var c=this,d=e.bind(c.propScroll,c,a,r,u);c.fire("propScroll.ready",d)}},"bus propScroll.ready > view.axis.collapser.executed.after > resize.completed":function(e,t){t()},propScroll:function(e,t,i){var n=t[0].getBoundingClientRect(),a=e.find("table:first")[0].getBoundingClientRect(),r={top:n.top-a.top,left:n.left-a.left},s=0;e.parents(".i-browser_engine_ie").length&&(s=-1);var o={top:Math.round(r.top)-Math.round(i.top)+s,left:Math.round(r.left)-Math.round(i.left)};e.scrollTo(o)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.sync-scroll",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n=function(e,t){t()};return i.extend({"bus $el.ready+$grid.ready":function(t,i,n){var a=this,r=i.find(".i-role-header[data-dimension=x]"),s=r.find("ul"),o=i.find(".i-role-header[data-dimension=y]"),l=o.find("ul"),u=e.bind(a.syncScroll,a,n,s,l),c=function(){u(),n.trigger("sync-scroll")};n.on({scroll:c});var d=60,p={mousewheel:function(e,t){var i=-n.scrollTop()+Math.round(t*d);n.scrollTop(-i),c()}};o.on(p),r.on(p),a.fire("syncScroll.ready",u)},"bus syncScroll.ready:last + view.dom.ready":n,"bus syncScroll.ready:last + view.axis.collapser.executed.after":n,"bus syncScroll.ready:last + resize.completed":n,syncScroll:function(e,t,i){var n={x:e.scrollLeft(),y:e.scrollTop()};
t.length&&t.css("margin-left",-1*n.x),i.length&&i.css("margin-top",-1*n.y)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.hints",["Underscore","jQuery","tau/core/extension.base","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/models/board.customize.units/const.card.sizes","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized"],function(e,t,i,n,a){return i.extend({init:function(e){this._super(e),this.builderCardHint=t.Deferred(),this.configurator=e.context.configurator},"bus boardSettings.ready":function(t,i){var n=i.boardSettings;n.get({fields:["zoomLevel"],callback:e.bind(function(e){this.fire("zoomLevel.ready",e.zoomLevel)},this)}),n.unbind({listener:this}),n.bind({fields:["zoomLevel"],listener:this,callback:e.bind(function(e){this.fire("zoomLevel.ready",e.zoomLevel)},this)})},buildCard:function(){},"bus configurator.ready:last + cardLayoutFactory.ready:last + definition.ready + acid.ready:last":function(t,i,r,s,o){var l=new n,u=e.cloneDeep(s);r.getCardLayoutsByTypesAndSize(u.cells.types,a.L).then(function(t){return e.reduce(t,function(e,t,i){return e.types.push({type:i,data:l.build(i,t)}),e.mapLayouts[i]=t,e},{types:[],mapLayouts:{}})}).done(function(e){u.cells.types=e.types,u.global={acid:o};var t={definition:u},n=i.getSliceFactory().create(t),a=i.getTemplateFactory().get("board.plus.default.card.customized");this.buildCard=function(t,r){t.on("close",function(){n.abort()});var s=r.data("cardData"),o=r.data("entityType"),l={dataItem:{id:r.data("id"),orderingValue:r.data("orderingValue"),type:o,data:{cardData:s}},configurator:i,layout:e.mapLayouts[o]};if(t.data("ui-tauBubble")){t.tauBubble("option",{alignTo:this.alignTo(r),className:"tau-ui-size-l",content:a.bind({},l)}),t.tauBubble("show");var u=t.tauBubble("widget");u.addClass("tau-board-lazy-animation"),u.toggleClass("tau-card-v2_final-state",!!s.isFinal);var c={$set:{CardsIds:[s.id]}};n.cardDetails(c).done(function(e){l.dataItem=e.data.items[0];
var i=a.bind({},l);t.tauBubble("option",{content:i}),u.removeClass("tau-board-lazy-animation"),this.fire("showHint",{$card:i})}.bind(this))}},this.builderCardHint.resolve()}.bind(this))},"bus configurator.ready:last + $grid.ready":function(e,t,i){i.tauBubble({className:"tau-cardtooltip",showEvent:"nothing",template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),zIndex:100}),this.fire("$bubbled.ready",i),this.fire("hint.enable",i)},"bus $bubbled.ready:last + sort.started":function(e,t){this._disableHints(t)},"bus configurator.ready:last + $bubbled.ready:last + view.card.batch.move.after":function(t,i,n){e.delay(e.bind(this.fire,this,"hint.enable",n),100)},"bus zoomLevel.ready:last + hint.enable":function(e,t,i){this._enableHints(i,t)},"bus zoomLevel.ready + hint.enable:last":function(e,t,i){this._enableHints(i,t)},"bus hint.enable:last + hint.hide":function(e,t){this._hideHandler(t)},alignTo:function(e){return e},_getCard:function(e){return e},_showHint:function(e,t){var i=this._getCard(t);this.builderCardHint.done(function(){this.buildCard(e,i)}.bind(this))},_showHandler:function(i,n){var a=t(n.currentTarget);clearTimeout(this.timeout),this.timeout=setTimeout(e.bind(this._showHint,this,i,a),750)},_hideHandler:function(e){clearTimeout(this.timeout),e.data("ui-tauBubble")&&e.tauBubble("hide")},_enableHints:function(t,i){this._disableHints(t);var n=this._getHolderClass(i),a=e.bind(this._hideHandler,this,t);t.on("mouseenter.cardHint",n,e.bind(this._showHandler,this,t)),t.on("mouseleave.cardHint",n,a),t.on("mousedown.cardHint",n,function(e){2===e.button&&a()})},_getHolderClass:function(e){var t=".i-role-card";return 5===e&&(t=".i-role-cellholder.tau-collapsed .i-role-card"),t},_disableHints:function(e){this._hideHandler(e),e.off(".cardHint")}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.hintsHeader",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready":function(e,t){var i=t.find(".i-role-header");
i.length&&this.fire("$headers.ready",i)},"bus $headers.ready":function(e,t){var i=function(e){e.my="center top",e.at="center-1 bottom+5"};t.tauBubble({className:"tau-cardtooltip tau-cardtooltip-header",showEvent:"nothing",template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),zIndex:1e3,onPositionConfig:i,onArrowPositionConfig:i}),this.fire("$bubbledHeader.ready",t),this.fire("hintHeader.enable",t)},"bus $bubbledHeader.ready:last + sort.started":function(e,t){this._disableHints(t)},"bus $bubbledHeader.ready:last + view.card.batch.move.after":function(t,i){e.delay(e.bind(this.fire,this,"hintHeader.enable",i),100)},"bus hintHeader.enable":function(e,t){this._enableHints(t)},destroy:function(){clearTimeout(this.timeout),this._super()},_showHint:function(e,i){var n=i.find(".i-role-cellaxis-viewtrigger"),a=n.data("entityType");if(a){var r=e.tauBubble("widget");r.length&&a!=r.data("entityType")&&(r.removeClass("tau-cardtooltip-header-"+r.data("entityType")),r.data("entityType",a),r.addClass("tau-cardtooltip-header-"+a)),"y"==e.data("dimension")&&n.children().length&&(n=n.children().first());var s=i.find(".i-role-name").text(),o=['<div class="tau-card-v2  tau-card-v2_type_'+a+'">','<div class="tau-card-v2__section tau-card-v2__section_double">','<div class="tau-board-unit tau-board-unit_format_max tau-board-unit_alignment_base tau-board-unit_type_entity-name-extended">','<div class="tau-board-unit__value tau-name">'+s+"</div>","</div>","</div>",'<div class="tau-card-v2__section"></div>',"</div>"].join(""),l={content:t(o),alignTo:n};r.length||(l.className="tau-cardtooltip tau-cardtooltip-header tau-cardtooltip-header-"+a),e.tauBubble("option",l),e.tauBubble("show")}},_showHandler:function(i,n){var a=t(n.currentTarget);if("y"==i.data("dimension")){if(!i.parents(".rows-h-collapsed:first").length)return void i.tauBubble("disable");i.tauBubble("enable")
}else{if(!a.parents(".i-role-cellholder:first").hasClass("tau-collapsed"))return void i.tauBubble("disable");i.tauBubble("enable")}clearTimeout(this.timeout),this.timeout=setTimeout(e.bind(this._showHint,this,i,a),500)},_hideHandler:function(e){clearTimeout(this.timeout),e.data("ui-tauBubble")&&e.tauBubble("hide")},_enableHints:function(t){this._disableHints(t);var i=".tau-label";t.on("mouseenter.headerHint",i,e.bind(this._showHandler,this,t)),t.on("mouseleave.headerHint",i,e.bind(this._hideHandler,this,t))},_disableHints:function(e){this._hideHandler(e),e.off(".headerHint")}})}),define("tau/libs/working-queue",["Underscore"],function(e){var t=function(t){var i=this;i.queue=[],i.interval=t.interval,i.iterator=t.iterator,i.proceed=e.bind(i.proceed,i),i.start=e.bind(i.start,i)};return t.prototype={tick:function(){return+new Date},clean:function(){this.queue=[]},start:function(){var e=this;e.lastResume=e.tick(),e.next()},next:function(){var t=this;t.queue.length>0&&e.defer(t.proceed)},push:function(e){var t=this;t.queue.push(e),1===t.queue.length&&t.start()},proceed:function(){var e=this;if(0!==e.queue.length){e.iterator(e.queue.shift());var t=e.tick()-e.lastResume;t>e.interval?e.wait():e.next()}},wait:function(){var t=this;e.delay(t.start,t.interval)}},t}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsSparklines",["jQuery","tau/core/extension.base","tau/libs/working-queue","tau/libs/sparklines/sparklines","Underscore"],function(e,t,i,n,a){function r(t){var i={width:100,height:50,letterWidth:9,letterHeight:9},a=new n(i);a.draw(null,t),e(t).parent().removeClass(s)}var s="tau-sparkline-loading";return t.extend({init:function(){this.sparklineDrawQueue=new i({interval:150,iterator:r}),this._super.apply(this,arguments)},"bus showHint":function(e,t){var i=t.$card.find(".i-role-sparkline");i.each(function(){r(this)})},"bus overview.board.ready:last + cardsFullyLoaded":function(t,i,n){if(n.isRunAdditionalAction){this.sparklineDrawQueue.clean();var r=i.element;
a.each(r.find(".i-role-card"),function(t){var i=e(t).find(".i-role-sparkline");i.children().length||this._pushToDrawingQueue(i)},this)}},"bus overview.board.ready:last + operation.execute.done":function(e,t){var i=t.element,n=this._extractEmptySparkline(i);this._pushToDrawingQueue(n)},"bus overview.board.ready:last + view.card.batch.move.finished":function(e,t){var i=t.element,n=this._extractEmptySparkline(i);this._pushToDrawingQueue(n)},_extractEmptySparkline:function(e){return e.find(".i-role-card .i-role-sparkline:empty")},_pushToDrawingQueue:function(e){var t=this;e.parent().addClass(s),e.each(function(){t.sparklineDrawQueue.push(this)})}})}),define("tau/models/board.plus/model.board.collapse",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus boardSettings.ready":function(e,t){var i=this;t.boardSettings.get({fields:["collapse"],callback:function(e){i.fire("settings.collapse.provided",e.collapse)}})},"bus settings.collapse.provided":function(e){var t=e.data||{x:[],y:[]};this.fire("view.collapsed.axis",t)},"bus boardSettings.ready:last + board.save.header.collapsing.settings":function(e,t,i){var n=this,a=t.boardSettings;a.get({fields:["collapse"],callback:function(e){a.set({set:{collapse:n.toggleCollapsedId(e.collapse,i)}})}})},toggleCollapsedId:function(t,i){var n={collapse:"union",expand:"without"};return t=t||{x:[],y:[]},t[i.dimension]=e[n[i.setting]](t[i.dimension],i.id),t}})}),define("tau/models/board.plus/model.board.collapse.empty",["Underscore","./model.board.collapse"],function(e,t){return t.extend({_isAxisValueEmpty:function(e){return 0===e.length},"bus model.sliceInfo.retrieved + model.cells.content.loaded":function(t){var i=t["model.cells.content.loaded"].data,n=t["model.sliceInfo.retrieved"].data,a=this,r=function(t){var r=[],s=n["marks"+t.toUpperCase()]||[];return e.each(s,function(n){var s=n[t],o=e.filter(i.data.items,function(e){return e[t]==s&&e.dynamic.items.length>0});a._isAxisValueEmpty(o,n)&&r.push(s)}),r},s=r("x"),o=r("y");
this.fire("model.empty.data.ready",{x:s,y:o})},"bus settings.collapse.provided + model.empty.data.ready":function(t){var i=t["model.empty.data.ready"].data,n=t.data||{x:[],y:[]},a={x:e.without(i.x,e.keys(n.x)),y:e.without(i.y,e.keys(n.y))};this.fire("model.empty.axis.info",a)},"bus settings.collapse.provided":function(){},_fireCollapsedDataEvent:function(t){var i=t["settings.collapse.provided"]||t["board.empty.collapsed.changed"],n=e.cloneDeep(i.data||{x:[],y:[]}),a=t["model.empty.axis.info"].data;n.x=e.union(n.x,a.x),n.y=e.union(n.y,a.y),this.fire("view.collapsed.axis",n)},"bus settings.collapse.provided + model.empty.axis.info":function(e){this._fireCollapsedDataEvent(e)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.collapse",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus domWrapper.ready + view.collapsed.axis":function(e,t,i){this.applyCollapseSettingsOnInit(t,i)},"bus domWrapper.ready":function(e,t){var i=this;t.subscribeToAxisCollapser(function(e){i.fire("view.axis.collapser.executed.before");var n={};n[e.dimension]=e.dimensionId;var a={collapse:"collapseAxis",expand:"expandAxis"};t[a[e.action]](n),i.fire("view.axis.collapser.executed.after"),i.fire("board.save.header.collapsing.settings",{id:e.dimensionId,dimension:e.dimension,setting:e.action})}),t.subscribeToXHeaderCollapser(function(e){t.toggleHeaderCollapsing(),i.fire("view.axis.collapser.executed.after"),i.fire("board.save.header.collapsing.settings",{id:0,dimension:"axisY",setting:e.action})})},applyCollapseSettingsOnInit:function(e,i){var n=function(e,n){return t.contains(i[e],n)};e.iterateHeadersItems(function(t){if(n(t.dimension,t.value)){var i={};i[t.dimension]=t.value,e.collapseAxis(i)}}),n("axisY",0)&&e.toggleHeaderCollapsing(),this.fire("view.axis.collapser.executed.after")},"bus view.cell.skeleton.element.afterUpdate":function(t,i){var n=i.cell,a=n.find(".more-collapsed");a.length||(a=e('<span class="more-collapsed">&#8230;</span>')),n.find(".i-role-card:last").after(a)
}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.focus",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils","Underscore"],function(e,t,i,n){return t.extend({focusCells:function(t,n){var a=n.closest(".i-role-cellholder"),r=a.closest(".i-role-header").data("dimension"),s=i.dimension(t,a).add(a);return s.toggleClass("tau-selected_"+r),s.each(function(){var t=e(this);t.toggleClass("tau-selected",t.hasClass("tau-selected_x")||t.hasClass("tau-selected_y"))}),{cell:a,dimension:r}},_processSelectedMarks:function(t,a,r,s){var o=this;n.each(a,function(n){var a={};a[t]=n;var l=i.generateId(a),u=e("#"+l,r).find("[name=focus]");u.prop("checked",!0),o.focusCells(s,u)})},"bus board.selection.defaults.process":function(e){var t=this,i=n.defaults(e.data.selectedMarks||{},{x:[],y:[]}),a=e.data.element,r=a.find(".i-role-grid");n.each(["x","y"],function(e){t._processSelectedMarks(e,i[e],a,r)}),t.fire("board.selection.defaults.ready",e.data)},"bus board.selection.saveChanges":function(e){var t=e.data.mark,i=e.data.boardSettings,a=n.defaults(e.data.selectedMarks||{},{x:[],y:[]});t.checked?a[t.dimension].push(t.value):a[t.dimension]=n.without(a[t.dimension],t.value),i.set({set:{selectedMarks:a}})},"bus board.selection.defaults.ready":function(t){var i=t.data.boardSettings,n=t.data.element,a=this,r=n.find(".i-role-grid"),s=n.find(".i-role-header");s.delegate("[name=focus]","change",function(){var t=e(this),n=a.focusCells(r,t),s=n.dimension,o={checked:t.prop("checked"),dimension:s,value:n.cell.attr("data-"+s)};i.get({fields:["selectedMarks"],callback:function(e){var t={selectedMarks:e.selectedMarks,boardSettings:i,mark:o};a.fire("board.selection.saveChanges",t)}})})},"bus boardSettings.ready:last+overview.board.ready":function(e){var t=n.values(e)[0].data.boardSettings,i=n.values(e)[1].data.element,a=this;t.get({fields:["selectedMarks"],callback:function(e){a.fire("board.selection.defaults.process",{selectedMarks:e.selectedMarks,element:i,boardSettings:t})
}})},"bus boardSettings.ready:last+destroy":function(e){var t=n.values(e)[0].data.boardSettings;t.unbind({listener:this})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.paging",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i){return i.extend({init:function(e){this._super(e),this.buttons={up:{className:"tau-nav-up",data:"up",code:"&uarr;"},right:{className:"tau-nav-right",data:"right",code:"&rarr;"},down:{className:"tau-nav-down",data:"down",code:"&darr;"},left:{className:"tau-nav-left",data:"left",code:"&larr;"}}},"bus afterRender + board.paging.settings":function(i){var n=i.afterRender.data.element,a=e(".i-role-board-body-holder",n),r=i["board.paging.settings"].data,s=this;t.each(r.availableDirections,function(e,t){e&&s.getNavigationButton(s.buttons[t]).appendTo(a)});var o=function(){a.undelegate(".tau-page-navigation-button","click",o),e(".tau-page-navigation-button",a).hide(),s.fire("page.move.to",{direction:e(this).data("direction"),element:n})};a.on("click",".tau-page-navigation-button",o),s.fire("ui.board.paging.ready",{element:n})},getNavigationButton:function(t){return e('<button class="'+t.className+' tau-page-navigation-button" data-direction="'+t.data+'">'+t.code+"</button>")}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.full-counts.base",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({resetLifecycle:!0,init:function(e){this._super(e),this._updateMetaInfoDebouncedHandler=t.debounce(this.updateMetaInfoAsync,500)},updateMetaInfoAsync:function(e,i,n,a){var r=this;r._request&&r._request.reject({data:{status:0}});var s=t.pluck(e.x.data,"x"),o=t.pluck(e.y.data,"y"),l={$whereX:s.length?{x:{$in:s}}:void 0,$whereY:o.length?{y:{$in:o}}:void 0};(l.$whereX||l.$whereY)&&(r._request=i.axesCounts(l).done(function(e){r._request=null,r.postUpdateAxesMetaInfo(e.data.items,n,a)}))},postUpdateAxesMetaInfo:function(e,t,i){i.updateAxesMetaInfo(e,t),this.fire("view.axes.counters.updated")
},"bus boardSettings.ready":function(e,i){i=i.boardSettings;var n=t.bind(function(e){this.fire("boardSettings.limitsReady",e.limits||{})},this);i.get({fields:["limits"],listener:this,callback:n}),i.bind({fields:["limits"],listener:this,callback:n})},"bus model.sliceInfo.retrieved + slice.ready + domWrapper.ready + boardSettings.limitsReady":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(t,i.slice,a,n)},"bus boardSettings.limitsReady:last > model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last >  view.card.batch.move.completed":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(i,n.slice,t,a)},"bus model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last > boardSettings.limitsReady":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(t,i.slice,a,n)}})}),define("tau/models/board.plus/model.counts",["tau/core/event"],function(e){return Object.create(new e,{data:{value:{counts:[],limits:{}},writable:!0},update:{value:function(e){this.data=e,this.fire("update",e)},writable:!1},get:{value:function(){return this.data},writable:!1},clear:{value:function(){this.data={counts:[],limits:{}}},writable:!1}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.full-counts.client",["jQuery","Underscore","tau/ui/extensions/board.plus/ui.extension.board.plus.full-counts.base","tau/models/board.plus/model.counts"],function(e,t,i,n){var a=function(e,t,i){e[t]=e[t]?e[t].concat(i):[].concat(i)},r=function(e,t){return e=e||"null",t=t||"null",e+"-"+t};return i.extend({init:function(t){this._super(t),this.countsModel=Object.create(n),this.boardModel={},this.on("refresh",function(){this.countsModel&&this.countsModel.clear(),this.boardModel={}}.bind(this)),this.domWrapper=e.Deferred(),this.on("domWrapper.ready",function(t,i){this.domWrapper=e.Deferred().resolve(i)}.bind(this)),this.countsModel.on("update",function(e,t){this.domWrapper.done(function(e){e.updateAxesMetaInfo(t.counts,t.limits),this.fire("view.axes.counters.updated")
}.bind(this))}.bind(this))},postUpdateAxesMetaInfo:function(e,t){this.countsModel&&this.countsModel.update({counts:e,limits:t})},updateCount:function(e){var i=this.countsModel.get(),n=function(e){return{count:1,type:e}}.bind(this),a=function(e,a,r,s){var o=t.find(i.counts,function(t){return t[a]==e});if(o){var l=t.find(o.counts,function(e){return e.type.toLowerCase()==s.toLowerCase()});l?l.count+=r:o.counts.push(n(s))}else if("null"!==e){var u={counts:[n(s)]};u[a]=e,i.counts.push(u)}},r=function(e,i){t.each(e,function(e,n){n=n.split("-"),t.each(e,function(e){a(n[0],"x",i,e.type),a(n[1],"y",i,e.type)})})};r(e.added,1),r(e.removed,-1),this.countsModel.update(i)},updateModel:function(e,i){var n=t.reduce(i,function(e,t){return e.push(r(t.x,t.y)),e},[]),s={removed:{},added:{}};return t.each(i,function(i){var o=r(i.x,i.y),l=e[o]||{},u=i.dataItem,c=u.id,d=l[c];d||(e[o]=l,a(s.added,o,u),e[o][c]=u),t.each(e,function(e,i){e[c]&&(t.contains(n,i)||(a(s.removed,i,u),delete e[c]))})},this),s},processBatchComet:function(e){return t.reduce(e,function(e,t){return t.location&&"card"===t.location.toLowerCase()&&e.push({dataItem:t.data,x:t.x,y:t.y}),e},[])},"bus comet.batch":function(e,i){var n={removed:{},added:{}};t.each(i.items,function(e){var i=this.updateModel(this.boardModel,this.processBatchComet(e.items));t.each(i.removed,function(e,t){a(n.removed,t,e)}),t.each(i.added,function(e,t){a(n.added,t,e)})},this),this.updateCount(n)},"bus boardSettings.limitsReady:last > model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last > after.slice.cells.updated":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(i,n.slice,t,a)},_updateModelAfterCells:function(e,i){t.each(i.result&&i.result.items||[],function(e){var i=r(e.x,e.y);this.boardModel[i]=this.boardModel[i]||{},t.each(e.dynamic.items||[],function(e){this.boardModel[i][e.id]=e},this)},this),this.fire("after.slice.cells.updated")},_updateModelAfterMove:function(e,i){t.each(i.result.items,function(e){this.updateModel(this.boardModel,e.items)
},this)},"bus slice.ready":function(e,t){t.base.on("after.cells",this._updateModelAfterCells,this),t.full.on(["after.moveBatch","after.moveAndPrioritizeBatch"],this._updateModelAfterMove,this)},"bus slice.ready:last + destroy":function(e,t){t.base.removeAllListeners(this),t.full.removeAllListeners(this)}})}),define("tau/models/board.plus/model.board.plus.quick.add.axes",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus overview.board.ready":function(){var t=e.bind(this.fire,this,"axesActions.init");e.delay(t,500)},"bus configurator.ready + slice.ready + axesActions.init":function(e,t,i){var n=i.slice.clone();this.fire("slice.axes.quickadd.api.ready",n)},"bus slice.ready + model.sliceInfo.retrieved + axesActions.init":function(e,t,i){var n=this;i.definition.x&&i.definition.x.types.length||i.definition.y&&i.definition.y.types.length?t.slice.axesActions().done(function(e){n.fire("model.axesActions.ready",e.data)}):n.fire("model.axesActions.ready",{items:[]})}})}),define("tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add.base",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({isActivated:!1,element:null,init:function(e,t){this.settings=t,this.findElements(e),this.attachEvents()},createQuickAddPanel:function(){return t('<div class="tau-quick-add" style="display: none; position: absolute;"><button class="tau-btn tau-btn-big tau-add tau-success"></button></div>')},findElements:function(){throw new Error("Abstract method call")},attachEvents:function(){throw new Error("Abstract method call")},matchLocation:function(e,t){return t.x==e.x&&t.y==e.y},predicateAddAction:function(t){var i=this.matchLocation;return e.find(this.settings.items,function(n){if(i(t,n)){var a=e.find(n.fixed.items,function(e){return"AddAction"===e.type});if(a)return!0}return!1})},deactivate:function(){this.isActivated=!1},destroy:function(){this.$buttonPanel&&this.$buttonPanel.remove(),this.detachEvents()},detachEvents:function(){},activate:function(e,t){this.isActivated=!0,this.activatedOn=e,this.settings.onActivate({target:this.activatedOn,data:t,deactivate:this.deactivate.bind(this)})
}})}),define("tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add-axes",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add.base"],function(e,t,i){var n=2,a=i.extend({activatedScope:null,lastScope:null,sharedState:null,findElements:function(e){this.element=e.getAxesHeaders(),this.$buttonPanel=this.createQuickAddPanel(),this.$button=this.$buttonPanel.find(".tau-btn")},matchLocation:function(e,t){return t.location.toLowerCase()===e.dimension.toLowerCase()},deactivate:function(){this.isActivated=!1,this.activatedScope!==this.lastScope&&this.$buttonPanel.hide()},setPosition:function(e){this.$buttonPanel.appendTo(e);var t=e.data("dimension"),i=e.width()-this.$buttonPanel.width()-2*n;"y"===t?this.$buttonPanel.css({top:e.height()-this.$buttonPanel.height()-2*n,left:i}):"x"===t&&this.$buttonPanel.css({top:n,left:i}),this.$buttonPanel.show()},showButton:e.throttle(function(e){this.sharedState&&this.setPosition(e)},500),hideButton:function(){this.$buttonPanel.hide()},onClick:function(){this.sharedState&&(this.activatedScope=this.lastScope,this.activate(this.$button,this.sharedState))},onDblClick:e.debounce(function(e){var i=t(e.target);(i.hasClass("i-role-cellholder")||i.hasClass("i-role-cell")||i.hasClass("footer-pillow"))&&this.onMouseEnter(e).actionAllowed&&this.$button.click()},300),onMouseEnter:function(e){var i=t(e.delegateTarget),n=this.getCellData(i);if(this.lastScope="enter_"+n.dimension,!this.isActivated){var a=this.predicateAddAction(n);if(a)return this.sharedState={actionItems:a},this.showButton(i),{actionAllowed:!0}}return{}},onMouseLeave:function(e){var i=t(e.delegateTarget),n=this.getCellData(i);if(this.lastScope="leave_"+n.dimension,!this.isActivated){var a=this.predicateAddAction(n);a&&(this.sharedState=null,this.hideButton())}},attachEvents:function(){this.$button.on("click",this.onClick.bind(this)),this.element.on({dblclick:this.onDblClick.bind(this),mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)})
},getCellData:function(e){return e.data()}});return a}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.axes",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add-axes"],function(e,t,i,n){return i.extend({resetLifecycle:!0,"bus slice.axes.quickadd.api.ready:last + domWrapper.ready:last + model.axesActions.ready":function(t,i,a,r){i.on("after.addAxisData",e.bind(this.onAfterAddData,this)),this.decorator=new n(a,{items:r.items,onActivate:e.bind(this.showQuickAddPopup,this,i,a)})},onAfterAddData:function(e){var t=e.data.result,i=t[0];this.itemsToAdd.push({data:i.dataItem,location:i.location})},setupBatchAddOperation:function(){this.itemsToAdd=[]},triggerBatchAddOperation:function(){0!==this.itemsToAdd.length&&this.fire("operation.execute",{name:"added",options:{force:!0},items:this.itemsToAdd})},showQuickAddPopup:function(t,i,n){var a=this,r=n.target,s=n.data.actionItems,o=e.find(s.fixed.items,function(e){return"AddAction"===e.type}),l="axis",u=i.getGrid().parents(".i-role-board-body-holder,.tau-entity-list"),c="x"===(s.location||"").toLowerCase(),d=function(e){e=!!e,u.prop("disabled",e),r.parent().toggleClass("tau-quick-add_expand",e)},p={target:r,cleanupOnHide:!0,stackName:"quickAdd",showOnCreation:!0,zIndex:1e4,onShow:function(){d(!0),a.setupBatchAddOperation()},onHide:function(){d(!1),a.triggerBatchAddOperation(),n.deactivate()},onPositionConfig:function(){return{my:c?"left top":"left bottom",at:c?"left-30 bottom":"left-30 top",of:r,collision:"fit flip"}},onArrowPositionConfig:function(e){c&&(e.offset="-5 0")},dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:{components:[{name:"board axis quick add",type:"board.cell.quick.add",options:{slice:t,action:s,addAction:o,viewMode:l}}]}};a.fire("initBubble",p)},destroy:function(){this.decorator&&(this.decorator.destroy(),this.decorator=null),this._super()}})}),define("tau/models/board.plus/nodata/nodata-strategies",["Underscore","tau/utils/timeline/utils.timeline.date-range"],function(e,t){var i=function(e,t){var i=e[t].data;
if(0===i.length)return!0;if(1!==i.length)return!1;var n=i[0].dynamic.items;return 1===n.length&&n[0].data.empty};return{board:{isEmpty:function(t,n,a){var r={isEmpty:!1,noCards:!1,noValuableAxis:!1,noCardsSetup:!1,noLanesSetup:!1,noSetup:!1},s=t.x.data||[],o=t.y.data||[],l=!t.x.isNull,u=!t.y.isNull,c=n.data.items;return r.noCards=0===c.length||0===c[0].dynamic.items.length,r.isEmpty=(0===s.length||u&&0===o.length)&&(0===o.length||l&&0===s.length)&&r.noCards,r.noLanesSetup=!e.any([a.x,a.y],this.isConfigured.bind(this)),r.noCardsSetup=!this.isConfigured(a.cells),r.noSetup=r.noLanesSetup&&r.noCardsSetup,r.noValuableAxis=!r.noLanesSetup&&e.every(["x","y"],i.bind(null,t)),r}},list:{isEmpty:function(t,i,n){var a={isEmpty:!1,noCards:!1,noValuableAxis:!1,noCardsSetup:!1,noLanesSetup:!1,noSetup:!1},r=i.data.items;return a.isEmpty=0===r.length||0===r[0].dynamic.items.length,a.noCards=a.isEmpty,a.noLanesSetup=!e.any([n.x,n.y],this.isConfigured.bind(this)),a.noCardsSetup=!this.isConfigured(n.cells),a.noSetup=a.noLanesSetup&&a.noCardsSetup,a}},timeline:{isEmpty:function(n,a,r){var s={noCards:!1,noValuableAxis:!1,noCardsSetup:!1,noLanesSetup:!1},o=n.y.data||[],l=!n.y.isNull,u=0==n.x.data.length,c=a.data.items;return s.noCards=0===c.length||0===c[0].dynamic.items.length,s.noCardsSetup=!this.isConfigured(r.cells),s.noLanesSetup=!this.isConfigured(r.y),s.noSetup=s.noLanesSetup&&s.noCardsSetup,s.isEmpty=u||s.noSetup||!t.tryParseWithRoundedDays(r.timelineGlobalDateRange).isValid||l&&0===o.length,s.noValuableAxis=!s.noLanesSetup&&e.every(["y"],i.bind(null,n)),s}}}}),define("tau/components/board.core/models/model.nodata",["Underscore","tau/components/board.core/models/model.board.core"],function(e,t){return t.extend({init:function(e,t){if(this._super(e),!t)throw new Error("[model.board.nodata] configure empty checker");this._emptyChecker=t},createEmptyChecker:function(){return this._emptyChecker},isEmpty:function(e,t,i){return this.createEmptyChecker().isEmpty.apply(this,[e,t,i])}})}),define("tau/models/board.plus/model.board.nodata",["Underscore","./model.board.base","tau/components/board.core/models/model.nodata"],function(e,t,i){return t.extend({init:function(e,t){var n=new i(e,t);
this._super(e,n)},"bus model.sliceInfo.retrieved + model.cells.content.loaded + definition.ready:last":function(e,t,i,n){var a=this.getModel().isEmpty(t,i,n);a.isEmpty?this.fire("no.data.in.slice",{reason:{noData:a.isEmpty,noSetup:a.noSetup},type:a.noSetup?"notConfigured":"isEmpty"}):this.fire("has.data.in.slice",{}),this.fire("board.nodata.status.ready",a)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.empty.data",["jQuery","tau/core/extension.base","tau/ui/templates/board.plus/ui.template.board.plus.emptyMessage"],function(e,t,i){return t.extend({init:function(e,t){if(this._super(e),!t)throw new Error('[ui.extension.board.plus.empty.data] configure "no data" message');this._message=t},"bus configurator.ready:last + view.skeleton.built:last + no.data.in.slice":function(e,t,n,a){a.message=a.reason.noSetup?this.getNoSetupMessage():"Yikes...! Nothing in there :-|";var r=t.getTemplateFactory().get(i.name).bind({},a),s=n.element;s.toggleClass("no-data-in-slice-container",!0),this.preProcessSkeleton(s),this.removeEmptyMessage(s),s.find(".i-role-board-body").append(r)},getNoSetupMessage:function(){return this._message},preProcessSkeleton:function(){},"bus view.skeleton.built:last + has.data.in.slice":function(e,t){var i=t.element;this.removeEmptyMessage(i),i.toggleClass("no-data-in-slice-container",!1)},"bus operation.added":function(){this.fire("has.data.in.slice")},removeEmptyMessage:function(e){e.find(".i-role-empty-message").remove()}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cards-lazy-loading.customized",["Underscore","jQuery","tau/core/extension.base","tau/models/board.customize.units/board.customize.cards.builderSelector"],function(e,t,i,n){var a=function(e){return e.data&&e.data.cardData&&e.data.cardData.id},r=i.extend({resetLifecycle:!0,init:function(e){this.cards={},this.forceRefresh=!1,this._super(e)},getZoomControl:function(){return t('.tau-board-header [role="zoomer"]')},toggleZoomControl:function(e){var t=this.getZoomControl();
t.data("ui-slider")&&t.slider(e?"enable":"disable")},disableZoomControl:function(){this.toggleZoomControl(!1)},enableZoomControl:function(){this.toggleZoomControl(!0)},reset:function(){this.cards={},this.enableZoomControl()},"bus before_destroy":function(){this.reset()},"bus before_refresh":function(){this.reset()},_failCardDetails:function(e,t){this.forceRefresh&&this.fire("refresh");var i=t.command.method;"cardsDetails"==i&&this.fire("lazy.cards.ready",this.cards)},_refreshOnLazySliceAbort:function(){this.fire("refresh")},_refreshOnBaseSliceAbort:function(e,t){this.fire("refresh"),this._failCardDetails(e,t)},_refreshOnSliceAbort:function(e,t){this._failCardDetails(e,t)},handlerSliceFail:function(e){e.lazy.on("abort",this._refreshOnLazySliceAbort,this),e.base.on("abort",this._refreshOnBaseSliceAbort,this),e.slice.on("abort",this._refreshOnSliceAbort,this)},"bus afterInit":function(){this.disableZoomControl()},"bus domWrapper.ready":function(){this.enableZoomControl()},_removeCellCardsFromCache:function(t,i){var n=this.readCardsCells(i);e.each(n,function(e,t){this.removeFromCache(t)},this)},"bus slice.ready":function(e,t){this.getCards(t).done(function(e){this.isNeedLazy(t.lazy.config.definition)||this.fire("lazy.cards.ready",e)}.bind(this)),t.slice.on("after.cells",this._removeCellCardsFromCache,this),this.handlerSliceFail(t)},"bus operation.execute":function(t,i){e.each(i.items,function(e){this.removeFromCache(a(e.data))},this)},removeFromCache:function(e){delete this.cards[e]},"bus domWrapper.ready:last + lazy.cards.ready":function(e,t,i){this.updateCards(i,t,!0)},redrawCards:function(i,n,a){var r=n.getCards();if(e.each(r,e.bind(function(e){var i=t(e),n=i.data("entityId");this.cards[n]||(this.cards[n]={id:i.data("id"),orderingValue:i.data("orderingValue"),type:i.data("entityType"),data:{cardData:i.data("cardData")}})},this)),this.forceRefresh=!1,r.length>150)return this.forceRefresh=!0,void this.fire("refresh");this.fire("startLazyLoadCard"),n.getGrid().removeClass("tau-board-lazy-animation_unit"),n.getGrid().addClass("tau-board-lazy-animation_unit"),this.updateCards(this.cards,n);
var s=[];this.cards=e.reduce(this.cards,function(i,n,a){return e.each(r,function(e){t(e).data("entityId")==a&&(i[a]=n)}),i},{}),this.isNeedLazy(a.slice.config.definition)&&(s=e.keys(this.cards)),this.getCardDetails(s,a.slice,{}).done(function(t){e.mergeDeep(this.cards,t),this.fire("lazy.cards.ready",t)}.bind(this)).fail(function(){this.fire("lazy.cards.ready",this.cards)}.bind(this))},"bus lazy.cards.ready > domWrapper.ready:last > slice.ready":function(e,t,i,n){this.redrawCards(t,i,n)},updateCards:function(i,n,a){var r=this,s=e.size(i),o=0,l=function(){r.fire("cardsFullyLoaded",{isRunAdditionalAction:!!a}),n.getGrid().removeClass("tau-board-lazy-animation_unit")};e.each(i,function(i){n.renderCardAsHtml(i).done(function(a){var r=i.id,u=n.getCardBySliceId(r),c=u.length;0===u.length?(s-=1,s==o&&l()):o++,e.each(u,function(e,i){t(e).html(a.html()),s==o&&c-1==i&&l()})})})},"bus view.skeleton.built:last + startLazyLoadCard":function(e,t){this.startAnimate(t)},"bus view.skeleton.built:last + lazy.cards.ready":function(e,t){this.stopAnimate(t)},startAnimate:function(e){e.element.addClass("tau-board-lazy-animation")},stopAnimate:function(e){e.element.removeClass("tau-board-lazy-animation")},isNeedLazy:function(t){var i=new n;return e.reduce(t.cells&&t.cells.types||[],function(e,t){return e||"{}"!==i.buildSelectorWithoutCardData(t.data||"")},!1)},getCardDetails:function(i,n,r){var s={$set:{CardsIds:i}};return n.cardDetails(s).then(function(t){var i=t.data.items;return e.reduce(i,function(t,i){var n=a(i),r=e.deepClone(t[n]&&t[n].data||{});return r=e.mergeDeep(r,i.data),t[n]=e.mergeDeep(t[n]||{},i),t[n].data=r,t},r)},function(){return t.Deferred().reject()})},readCardsCells:function(t){var i=t.result.items;return e.reduce(i,function(t,i){return e(i.dynamic.items).each(function(e){t[a(e)]=e}),t},{})},_cellLoad:function(t,i,n,a){var r=this.readCardsCells(a);this.cards=e.mergeDeep(this.cards,r),this.isNeedLazy(t.lazy.config.definition)&&(this.fire("startLazyLoadCard"),this.getCardDetails(e.keys(r),t.lazy,r).done(function(e){this.fire("lazy.cards.ready",e)
}.bind(this)).fail(function(){this.fire("lazy.cards.ready",r)}.bind(this))),i.resolve(r)},getCards:function(e){var i=t.Deferred();return e.base.on(["after.cells","after.list"],this._cellLoad.bind(this,e,i),this),i},"bus slice.ready:last + destroy":function(e,t){t.base.removeAllListeners(this),t.lazy.removeAllListeners(this),t.slice.removeAllListeners(this)}});return r}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.progress",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus initialize + $el.ready":function(e,t,i){i.tauProgressIndicator(),i.tauProgressIndicator("show")},"bus initialize + $el.ready + overview.board.ready":function(e,t,i){i.data("ui-tauProgressIndicator")&&(i.tauProgressIndicator("hide"),i.tauProgressIndicator("destroy"))},"bus initialize + $el.ready + no.data.in.slice":function(e,t,i){i.data("ui-tauProgressIndicator")&&(i.tauProgressIndicator("hide"),i.tauProgressIndicator("destroy"))},"bus initialize + $el.ready + view.dom.ready":function(e,t,i){var n=i.parent().tauProgressIndicator(),a=function(e){n.data("ui-tauProgressIndicator")&&n.tauProgressIndicator(e)};this.fire("progressProcess.ready",a)},"bus progressProcess.ready:last + before_refresh":function(e,t){this.timeout=setTimeout(function(){t("show")},500)},"bus progressProcess.ready:last + overview.board.ready":function(e,t){clearTimeout(this.timeout),t("hide")},"bus progressProcess.ready:last + no.data.in.slice":function(e,t){clearTimeout(this.timeout),t("hide")},"bus progressProcess.ready:last + destroy":function(e,t){t("destroy")}})}),define("tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add-cells",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add.base"],function(e,t,i){var n=2,a=i.extend({activatedScope:null,lastScope:null,sharedState:null,findElements:function(e){this.element=e.getGrid(),this.$buttonPanel=this.createQuickAddPanel(),this.$buttonPanel.css({top:0,left:0}).appendTo(this.element),this.buttonPanelHeight=this.$buttonPanel.height(),this.buttonPanelWidth=this.$buttonPanel.width(),this.$button=this.$buttonPanel.find(".tau-btn"),this.element.find(".i-role-cellholder").addClass("i-role-ch-quickadd-target")
},deactivate:function(){this.isActivated=!1,this.activatedScope!==this.lastScope&&this.$buttonPanel.hide()},setPosition:function(i){var a=this.element,r=t(i.currentTarget),s=r.position(),o=r.height(),l=r.width(),u=r.offset(),c=a.offset(),d=a[0],p=d.offsetHeight-d.clientHeight,f=d.offsetWidth-d.clientWidth,m=o-this.buttonPanelHeight,h=s.top+m+a.scrollTop()-1.5*n,g=c.top+a.height()-p,v=u.top+o,b=e.max([0,v-g]);h-=b;var y=e.max([0,this.buttonPanelHeight+2*n-(o-b)]);h+=y;var _=l-this.buttonPanelWidth,x=s.left+_+a.scrollLeft()-n,w=c.left+a.width()-f,C=u.left+l,S=e.min([0,w-C]);x+=S;var T=e.max([0,this.buttonPanelWidth-(l-S)-n]);x+=T,this.$buttonPanel.css({top:h,left:x}).appendTo(r)},showButton:e.throttle(function(e){this.sharedState&&(this.setPosition(e),this.$buttonPanel.show())},500),hideButton:function(){this.$buttonPanel.hide()},onClick:function(){this.sharedState&&!this.isActivated&&(this.activatedScope=this.lastScope,this.activate(this.$button,this.sharedState))},onDblClick:e.debounce(function(e){var i=t(e.target);(i.hasClass("i-role-ch-quickadd-target")||i.hasClass("i-role-cell")||i.hasClass("footer-pillow"))&&this.onMouseEnter(e).actionAllowed&&this.$button.click()},300),onMouseEnter:function(e){var i=this.getCellData(t(e.currentTarget));if(this.lastScope="enter_"+i.x+"_"+i.y,!this.isActivated){var n=this.predicateAddAction(i);if(n)return this.sharedState={actionItems:n},this.showButton(e),{actionAllowed:!0}}return{}},onMouseLeave:function(e){var i=this.getCellData(t(e.currentTarget));if(this.lastScope="leave_"+i.x+"_"+i.y,!this.isActivated){var n=this.predicateAddAction(i);n&&(this.sharedState=null,this.hideButton())}},onScroll:e.throttle(function(){var e=this.$buttonPanel.closest(".i-role-ch-quickadd-target");e.length&&this.setPosition({currentTarget:e})},150),attachEvents:function(){this.$button.on("click",this.onClick.bind(this)),this.onScrollBound=this.onScroll.bind(this),this.element.on("sync-scroll",this.onScrollBound),this.onDblclickBound=this.onDblClick.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.element.on({dblclick:this.onDblclickBound,mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave},".i-role-ch-quickadd-target")
},detachEvents:function(){this.element.off("sync-scroll",this.onScrollBound),this.element.off({dblclick:this.onDblclickBound,mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave},".i-role-ch-quickadd-target")},getCellData:function(e){return e.data()}});return a}),define("tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add-list",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add.base"],function(e,t,i){var n=2,a=32,r=i.extend({activatedScope:null,lastScope:null,sharedState:null,findElements:function(e){this.element=e.getGrid().closest(".i-role-board-body"),this.$buttonPanel=this.createQuickAddPanel(),this.$button=this.$buttonPanel.find(".tau-btn"),this.$buttonPanel.css({bottom:n}).addClass("i-role-quick-add-decorator-list").appendTo(this.element)},deactivate:function(){this.isActivated=!1,this.activatedScope!==this.lastScope&&this.$buttonPanel.hide()},setPosition:function(){var e=this.element.find(".i-role-cellholder").width();this.$buttonPanel.css({left:e-a-n})},showButton:function(){this.sharedState&&(this.setPosition(),this.$buttonPanel.show())},hideButton:function(){this.$buttonPanel.hide()},onClick:function(){this.sharedState&&(this.activatedScope=this.lastScope,this.activate(this.$button,this.sharedState))},onDblClick:e.debounce(function(e){var i=t(e.target);i.hasClass("i-role-cellholder")&&this.$button.is(":visible")&&this.$button.click()},300),onMouseEnter:function(e){var i=this.getCellData(t(e.delegateTarget));if(this.lastScope="enter_"+i.x+"_"+i.y,!this.isActivated){var n=this.predicateAddAction(i);n&&(this.sharedState={actionItems:n},this.showButton())}},onMouseLeave:function(){this.lastScope=null,this.isActivated||(this.sharedState=null,this.hideButton())},attachEvents:function(){this.$button.on("click",this.onClick.bind(this)),this.element.on({dblclick:this.onDblClick.bind(this),mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)},".i-role-grid,.i-role-quick-add-decorator-list")
},getCellData:function(e){var t=e.find(".i-role-cellholder");return t.data()}});return r}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.cells",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add-cells","tau/ui/extensions/board.plus/ui.board.plus.decorator.quick-add-list"],function(e,t,i,n,a){return i.extend({resetLifecycle:!0,"bus cardLayoutFactory.ready:last + slice.cells.quickadd.api.ready:last + model.cellActions.ready":function(t,i,n){n.on(["after.addData","after.listAddData"],e.bind(this.onAfterAddData,this,i))},"bus slice.cells.quickadd.api.ready:last + domWrapper.ready:last + model.cellActions.ready":function(t,i,r,s){var o;switch(r.definition.viewMode){case"list":o=a;break;default:o=n}this.decorator&&this.decorator.destroy(),this.decorator=new o(r,{items:s.items,onActivate:e.bind(this.showQuickAddPopup,this,i,r)})},onAfterAddData:function(e,t){var i=t.data.result,n=i[0];this.fire("operation.execute",{name:"added",options:{forceAppend:!0},items:[{data:n.dataItem,x:n.x,y:n.y}],layout:e})},showQuickAddPopup:function(i,n,a){var r=this,s=a.target,o=a.data.actionItems,l=e.find(o.fixed.items,function(e){return"AddAction"===e.type}),u=n.getCellByCoordinate(o),c=n.getCellsEmptyStatuses(u),d=n.isListMode()?"list":"board",p=n.getGrid().parents(".i-role-board-body-holder,.tau-entity-list"),f=function(e){e=!!e,p.prop("disabled",e),s.parent().toggleClass("tau-quick-add_expand",e),r.decorator&&(r.decorator.isActivated=e)},m={target:s,cleanupOnHide:!0,stackName:"quickAdd",showOnCreation:!0,zIndex:1e4,within:this.decorator.element,onShow:function(){f(!0)},onHide:function(){f(!1),a.deactivate(),e.each(c,function(e){e.emptyBeforeAdd&&n.cellHasCards(e.$cell)&&n.expandCell(r,t(e.$cell).attr("data-x"),t(e.$cell).attr("data-y"))})},onPositionConfig:function(e){var t=s.tauBubble("widget").height()<s.offset().top,i={my:t?"left bottom":"left top",at:t?"left-30 top":"left-30 bottom",of:s,within:e.within,collision:"fit flipfit"};
return i},onArrowPositionConfig:function(e,t){var i={my:"center top",at:"center bottom",of:s,within:e.within,collision:"fit flipfit"};return"bottom"===t&&(i.my="center bottom",i.at="center top"),i},dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:{components:[{name:"board plus quick add cells",type:"board.cell.quick.add",options:{slice:i,action:o,addAction:l,viewMode:d}}]}};this.fire("initBubble",m)}})}),define("tau/models/board.plus/model.board.plus.quick.add.cells",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({resetLifecycle:!0,"bus overview.board.ready":function(){var t=e.bind(this.fire,this,"cellActions.init");e.delay(t,500)},"bus configurator.ready:last + slice.ready + cellActions.init:last":function(e,t,i){this.slice&&this.slice.abort();var n=i.slice.clone();this.slice=n,this.fire("slice.cells.quickadd.api.ready",n)},"bus model.sliceInfo.retrieved:last > slice.cells.quickadd.api.ready":function(t,i,n){if(i.definition.cells&&0===i.definition.cells.types.length)return void this.fire("model.cellActions.ready",{items:[]});var a,r=e.pluck(i.x.data,"x"),s=e.pluck(i.y.data,"y"),o={$whereX:r.length?{x:{$in:r}}:void 0,$whereY:s.length?{y:{$in:s}}:void 0};switch(i.viewMode){case"board":a=n.cellActionsV2(o);break;case"timeline":a=n.cellActionsV2(o);break;default:a=n.listModeActionsV2(o)}a.done(e.bind(function(e){this.fire("model.cellActions.ready",e.data)},this))}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.hide.empty.lanes",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({cells:null,"bus boardSettings.ready + overview.board.ready":function(e,t,i){this._extractCellData(i),this._attachListeners(t.boardSettings),this.boardSettings.get({fields:["hideEmptyLanes"],callback:function(e){this._setHiddenState(!!e.hideEmptyLanes)}.bind(this)})},"bus operation.execute.done":function(i,n){var a=n.operation||{};if("card"===a.location&&0!==n.cards.length&&("added"===a.name||"updated"===a.name)){var r=t.flatMap(n.affected$CellsArray,t.resultOf("toArray")),s=this._findCellByElement(r);
if(s&&!s.hasItems)if(this.hidden){var o=this._findCellsOnEmptyLanes();s.hasItems=1;var l=this._findCellsOnEmptyLanes(),u=t.difference(o.toArray(),l.toArray());u.length&&(this._toggleCells(e(u),!1),this._resizeBoard())}else s.hasItems=1}},"bus view.card.batch.move":function(e,t){var i=t[0].target,n=this._findCellByCoordinates(i.x,i.y);n&&!n.hasItems&&(n.hasItems=1)},_setHiddenState:function(e){this.hidden=e,this._toggleCells(this._findCellsOnEmptyLanes(),e),this._resizeBoard()},_toggleCells:function(e,t){e.parent().toggleClass("hidden",t)},_resizeBoard:function(){this.fire("resize.executed",{onlyHeaders:!1,refreshElement:!0})},_findCellByElement:function(i){var n=e(i);return t.find(this.cells,function(e){return n.index(e.element)>=0})},_findCellByCoordinates:function(e,i){return e=""+e,i=""+i,t.find(this.cells,function(t){return t.x===e&&t.y===i})},_extractCellData:function(e){this.cells=t.map(e.cells,function(e){var t=e.data;return{x:t.x,y:t.y,element:e.element,hasItems:t.dynamic.items.length}})},_findCellsOnEmptyLanes:function(){var i={},n={};t.each(this.cells,function(e){e.x&&e.y&&e.hasItems&&(i[e.x]=!0,n[e.y]=!0)},this);var a=e();return t.each(this.cells,function(e){(e.x&&!i[e.x]||e.y&&!n[e.y])&&(a=a.add(e.element))}),a},_viewIsEmpty:function(){var e=t.any(this.cells,function(e){return e.x&&e.y&&e.hasItems});return!e},_attachListeners:function(t){this._removeListeners(),this.boardSettings=t,this.boardSettings.bind({listener:this,fields:["hideEmptyLanes"],callback:function(t){var i=!!t.hideEmptyLanes;this._setHiddenState(i),i&&this._viewIsEmpty()&&this.fire("notification",{type:"information",$node:e("<div><h3>All columns and rows on this View are empty.</h3></div>")})}.bind(this)})},_removeListeners:function(){this.boardSettings&&(this.boardSettings.unbind({listener:this}),this.boardSettings=null)},destroy:function(){this._removeListeners(),this._super()}})}),define("tau/components/component.board.plus",["tau/components/component.board.plus.base","tau/models/board.plus/model.board.slice.comet","tau/ui/extensions/board.plus/ui.board.plus.domWrapper","tau/ui/extensions/board.plus/ui.extension.board.plus.operations","tau/models/board.plus/model.board.plus.grid","tau/models/board.plus/model.board.cell.freezable","tau/ui/extensions/board.plus/ui.extension.board.plus.cells.paging","tau/ui/extensions/board.plus/ui.extension.board.plus.layout","tau/ui/extensions/board.plus/ui.extension.board.plus.dom.updater.board","tau/models/board.plus/model.board.dragndrop","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop","tau/ui/extensions/board.plus/ui.extension.board.plus.selection.board","tau/ui/extensions/board.plus/ui.board.plus.scrollManager","tau/ui/extensions/board.plus/ui.extension.board.plus.scrollManager","tau/ui/extensions/board.plus/ui.extension.board.plus.scroll","tau/ui/extensions/board.plus/ui.extension.board.plus.sync-scroll","tau/ui/extensions/board.plus/ui.extension.board.plus.hints","tau/ui/extensions/board.plus/ui.extension.board.plus.hintsHeader","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsSparklines","tau/models/board.plus/model.board.collapse","tau/models/board.plus/model.board.collapse.empty","tau/ui/extensions/board.plus/ui.extension.board.plus.collapse","tau/ui/extensions/board.plus/ui.extension.board.plus.focus","tau/ui/extensions/board.plus/ui.extension.board.plus.paging","tau/ui/extensions/board.plus/ui.extension.board.plus.full-counts.client","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.board","tau/models/board.plus/model.board.plus.quick.add.axes","tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.axes","tau/models/board.plus/nodata/nodata-strategies","tau/models/board.plus/model.board.nodata","tau/ui/extensions/board.plus/ui.extension.board.plus.empty.data","tau/ui/extensions/board.plus/ui.extension.board.plus.cards-lazy-loading.customized","tau/ui/extensions/board.plus/ui.extension.board.plus.progress","tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.cells","tau/models/board.plus/model.board.plus.quick.add.cells","tau/ui/extensions/board.plus/ui.extension.board.plus.hide.empty.lanes"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b,y,_,x,w,C,S,T,k,I,D,P,E,R,A,F,M,N){return{create:function(y){var j=y.context.configurator.getFeaturesService();
n=n.extend({createDomWrapper:function(e,t,n,a){return new i(e,n,a,t)}});var L={extensions:[a,r,s,l,o,u,c,d,{extType:f,args:[new p]},m,h,g,v,b,_,x,w,C,T,R,{extType:P,args:[D.board]},{extType:E,args:["Set up your board View"]},n,A,F,M,k,I,S,N].concat(y.extensions||[])};return j.isEnabled("comet.notifications")&&L.extensions.push({extType:t,args:[y.context.configurator]}),e.create(L,y)}}}),define("tau/components/board.core/models/model.board.plus.list",["Underscore","tau/components/board.core/models/model.board.plus"],function(e,t){return t.extend({init:function(){this._super()},onGetSliceInfo:function(e){var t=e.config.definition,i=this.getEmptyModelInfoArgs(t);i.viewMode="list",i.cardSize=this._zoomToSize(i),this.onSliceInfoRetrieved.fire(i),this.onBoardPagingSettingsRetrieved.fire(i)}})}),define("tau/models/board.plus/model.board.plus.list",["Underscore","tau/models/board.plus/model.board.plus","tau/components/board.core/models/model.board.plus.list"],function(e,t,i){return t.extend({init:function(e){var t=new i;this._super(e,t)}})}),define("tau/models/board.plus/model.board.cell.list",["Underscore","tau/models/board.plus/model.board.cell"],function(e,t){return t.extend({onGetCellContent:function(e,t){var i=this,n=t.from,a=t.to-t.from+1,r={$take:i.generateExcessTake(a),$skip:n},s=function(e){e.data.items=0!==e.data.items.length?e.data.items:[{}];var n=i.preProcessCellResponse(e.data.items[0],t);e.data.items[0]=n.dataItem,i.fire("model.cells.content.loaded",e),i.fireCellBasicInfoRetrieved(n),i.fireCardsDataReady(n.dataItem.dynamic.items)};e.list(r).done(s).fail(function(){s({data:{items:[]}})})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.dom.updater.list",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus view.skeleton.built":function(e){e.data.element.children().css({opacity:0})},"bus board.element.updated":function(e){var t=e.data,i=t.oldElement,n=t.newElement;i.replaceWith(n)},"bus overview.board.ready":function(e){var t=e.data.element;
t.children().css({opacity:1})}})}),define("tau/models/board.plus/model.board.dragndrop.list",["Underscore","./model.board.dragndrop"],function(e,t){return t.extend({defaultOptions:{simpleCommands:{}}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.selection.list",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(){this._super.apply(this,arguments),this.fire("view.card.selection.ref",{last:{position:-1},stack:[]})},"bus configurator.ready:last + view.card.selection.ref:last + domWrapper.ready":function(e,i,n,a){var r=this,s="tau-selected",o=a.getGrid();o.tauSelectable({items:".i-role-card",triggerSelector:":not([contenteditable=true])",ctrl:!0,forceSelection:!0,className:s,changed:function(e,i){var a=i.item,s=i.selected,o=a.data();if(s)n.last.position=a.index(),n.stack[n.stack.length-1]!==o.id&&n.stack.push(o.id);else{var l=t.indexOf(n.stack,o.id);n.stack.splice(l,1)}r.fire("view.card.selected",{element:a,selected:s})}}),r.fire("$selectable.ready",o)},"bus $selectable.ready + domWrapper.ready + overview.board.ready":function(e,t,i){var n=i.getCardByPositionOrLast(0);t.tauSelectable("select",n)},"bus domWrapper.ready:last + $selectable.ready:last + view.card.selection.ref:last + selection.reapply":function(i,n,a,r){var s=a.tauSelectable("getSelected");a.tauSelectable("option","fireEvents",!1),a.tauSelectable("select",s),a.tauSelectable("option","fireEvents",!0);var o=[];s.each(function(){o.push(e(this).data("id"))}),r.stack=t.intersection(r.stack,o);var l=null;if(0===r.stack.length)l=n.getCardByPositionOrLast(r.last.position),l.size()>0?a.tauSelectable("select",l):this.fire("view.empty.cardDetails");else{var u=r.stack[r.stack.length-1];l=n.getCardBySliceId(u),r.last.position=l.index()}},"bus $selectable.ready:last + view.card.selected":function(e,t,i){t.tauSelectable("option","fireEvents",!1),t.tauSelectable(i.selected?"select":"reset",i.element),t.tauSelectable("option","fireEvents",!0)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.list",["jQuery","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.base"],function(e,t,i,n){return n.extend({resetLifecycle:!0,appOptions:{applicationId:"listPopup",turnOffLoadingIndicator:!0,integration:{showInPopup:!1},routing:{silent:!0,executeOnStart:!1},comet:{enabled:!1}},"bus viewerBus.ready + view.skeleton.built + viewPort.afterRender":function(e,t){var i=e["view.skeleton.built"].data.element,n=e["viewPort.afterRender"].data.element;
i.find(".i-card-details-holder").append(n),t.fire("view.dom.ready")},subscribe:function(t){this._viewCardSelectedHandler&&this.bus.removeListener("view.card.selected",this._viewCardSelectedHandler,this.bus),this._viewCardSelectedHandler=function(e){if(e.data.selected){var t=e.data.element.data();this.isSupportedCardForView(t)&&this.loadCardDetails(t)}}.bind(this);var i=_.debounce(this._openCardDetails.bind(this),500,!0);t.on("click",".tau-id",function(t){t.ctrlKey||(t.stopPropagation(),t.preventDefault(),i(e(t.currentTarget).data()))}),this.on("view.card.selected",this._viewCardSelectedHandler)},_openCardDetails:function(t){if("process"===t.entityType){var i=this.config.context.configurator;i.loggedUser.isAdministrator&&this._openProcessDetails(t)}else e(this).closest(".tau-card").trigger("mousedown")},"bus acid.ready:last + viewPort.created:last + view.load.cardDetails":function(e,t,i,n){this.fire("has.data.in.slice"),i.configurator.getBoardCacheService().setData(n.cardData),i.application.fire("history.reset"),i.application.fire("application.navigate.entity",{id:n.entityId,entity:n.entityType,acid:t})},"bus viewPort.created:last + view.empty.cardDetails":function(e,t){t.application.fire("application.exit"),this.fire("no.data.in.slice",{type:"isEmpty",reason:{noData:!0,noSetup:!1}})},"bus view.skeleton.built:last + view.cardDetails.routing":function(e,t){var i=t.element;this.showProgress(i)},"bus view.skeleton.built:last + view.cardDetails.lastResult":function(e,t){var i=t.element;this.removeProgress(i)},"bus view.skeleton.built:last + view.empty.cardDetails":function(e,t){var i=t.element;this.removeProgress(i)},"bus view.card.batch.move.completed":function(){this.fire("view.card.batch.move.completed.spec.cardsViewer")},"bus view.skeleton.built:last + refresh":function(e,t){var i=t.element;this.removeProgress(i)},"bus view.skeleton.built:last + destroy":function(e,t){var i=t.element;this.removeProgress(i)},toggleProgress:function(e,i){var n=e.find(".i-card-details-holder"),a=t.get(n);
i?a.show():a.hide()},showProgress:function(e){this.toggleProgress(e,!0)},removeProgress:function(e){this.toggleProgress(e,!1)}})}),define("tau/components/component.board.plus.list",["tau/components/component.board.plus.base","tau/models/board.plus/model.board.slice.comet","tau/ui/extensions/board.plus/ui.board.plus.domWrapper","tau/ui/extensions/board.plus/ui.extension.board.plus.operations","tau/models/board.plus/model.board.plus.list","tau/models/board.plus/model.board.cell.list","tau/ui/extensions/board.plus/ui.extension.board.plus.dom.updater.list","tau/ui/extensions/board.plus/ui.extension.board.plus.cells.paging","tau/models/board.plus/model.board.dragndrop.list","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.base","tau/ui/extensions/board.plus/ui.extension.board.plus.selection.list","tau/ui/extensions/board.plus/ui.board.plus.scrollManager","tau/ui/extensions/board.plus/ui.extension.board.plus.scrollManager","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.list","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsSparklines","tau/models/board.plus/nodata/nodata-strategies","tau/models/board.plus/model.board.nodata","tau/ui/extensions/board.plus/ui.extension.board.plus.empty.data","tau/ui/extensions/board.plus/ui.extension.board.plus.cards-lazy-loading.customized","tau/ui/extensions/board.plus/ui.extension.board.plus.progress","tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.cells","tau/models/board.plus/model.board.plus.quick.add.cells"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b,y,_,x){return{create:function(w){var C=w.context.configurator.getFeaturesService();n=n.extend({createDomWrapper:function(e,t,n,a){return new i(e,n,a,t)}}),v=v.extend({preProcessSkeleton:function(e){e.children().css({opacity:1})}});var S={extensions:[a,r,s,o,l,u,c,{extType:p,args:[new d]},f,m,b,n,{extType:g,args:[h.list]},{extType:v,args:["Set up your details View"]},y,_,x]};return C.isEnabled("comet.notifications")&&S.extensions.push({extType:t,args:[w.context.configurator]}),e.create(S,w)
}}}),define("tau/components/board.timeline/views/card/view.card-base",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.dom.utils"],function(e,t,i,n){var a=i.extend({init:function(t){this._setModel(t),this.onCleared=e.Callbacks()},$dom:function(){return this._$dom},_setModel:function(e){this._model=e,this.id=this._model.id,this._$dom=this._$render()},_$render:function(){throw new Error("_$render method is not implemented in CardViewBase")},insertAt:function(){throw new Error("insertAt method is not implemented in CardViewBase")},update:function(){throw new Error("update method is not implemented in CardViewBase")},appendTo:function(e){e.append(this._$dom)},remove:function(){this._isPlaceholder()||this._$dom.remove()},clear:function(){return this._isPlaceholder()?void 0:(this.remove(),this.onCleared.fire(this),!0)},clearArtifacts:function(){throw new Error("clearArtifacts method is not implemented in CardViewBase")},markAsChanged:function(){this._changed=!0},markAsNotChanged:function(){this._changed=!1},animateAdd:function(e){return this.whenAnimated("tau-operation_card_added",e.suspendAnimation)},animateUpdate:function(e){var t=e.suspendAnimation||!this._changed;return this.markAsNotChanged(),this.whenAnimated("tau-operation_card_updated",t)},animateRemove:function(e){return this.whenAnimated("tau-operation_card_deleted",e.suspendAnimation)},whenAnimated:function(e,i){return t.when(i?!0:n.animated(this._$dom,i?"":e))},_isPlaceholder:function(){return this._$dom.is(".tau-sortable__placeholder")}});return a}),define("tau/components/board.timeline/views/card/view.board.card",["Underscore","jQuery","tau/components/board.timeline/views/card/view.card-base","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized"],function(e,t,i,n,a){var r=i.extend({init:function(e,t,i){this._configurator=t,this._layoutFactory=i,this._super(e)},_$render:function(){var e=this._model.cardData(),t={configurator:this._configurator,dataItem:e,lazy:e.lazy,layout:this._layoutFactory(e.type.toLowerCase())};
return a.render(t)},insertAt:function(e,t){this._$dom.insertAt(e,t,".i-role-card")},clearArtifacts:function(){this._$dom=t()},update:function(t){if(!this._isPlaceholder()){var i=this._$dom,n=e.filter(i.classes(),function(e){return 0===e.indexOf("i-role-permanent-")});this._setModel(t),this._$dom.addClass(n.join(" ")),i.replaceWith(this._$dom),this._$dom.text()!==i.text()&&this.markAsChanged()}},index:function(){return this._$dom.index()},isPromise:function(){return this._model.isPromise}});return r}),define("tau/components/board.timeline/views/card/view.board.existing-card",["Underscore","jQuery","tau/components/board.timeline/views/card/view.board.card"],function(e,t,i){var n=i.extend({init:function(e,t,i,n){this._$dom=e,this._super(t,i,n)},_$render:function(){return this._$dom}});return n}),define("tau/components/board.timeline/views/card/view.board.null-card",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=i.extend({init:function(e){this._id=e},clearArtifacts:function(){},clear:function(){},$dom:function(){return t()},animateRemove:function(){return t.when(!0)}});return n}),define("tau/components/board.timeline/models/card/model.board.card",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e){this.id=e.id,this.update(e)},update:function(e){return this._cardData=e,this},cardData:function(){return this._cardData},augment:function(t){e.extend(this._cardData.data,t),this._cardData.lazy=!1}});return i}),define("tau/components/board.timeline/view/view.cell.base",["Underscore","jQuery","tau/core/class","tau/components/board.timeline/views/card/view.board.card","tau/components/board.timeline/views/card/view.board.existing-card","tau/components/board.timeline/views/card/view.board.null-card","tau/components/board.timeline/models/card/model.board.card"],function(e,t,i,n,a,r){var s=i.extend({init:function(t,i,n,a,r){this._cellModel=t,t.onCardsAdded.add(this._addCards.bind(this)),t.onCardsUpdated.add(this._updateCards.bind(this)),t.onCardsCleared.add(this._clearCards.bind(this)),t.onCardRemoved.add(this._removeCard.bind(this)),t.onRefresh.add(this.refresh.bind(this)),this.onViewUpdated=e.Callbacks(),this._$cell=i,this._configurator=a,this._layoutFactory=n,this._renderConfig=e.defaults(r,{beforeInsert:e.identity,afterInsert:e.identity}),this._cards={}
},render:function(){var e=this._createCellContent();this._appendCellContent(e)},refresh:function(){var e=this._createCellContent();this._$cell.empty(),this._appendCellContent(e)},moveCardIn:function(e,t){e.detach();var i=e.data("data-item");i.data={cardData:e.data("card-data")};var n=this._cellModel.moveCardIn(i);this._addCardToDom(this._createCardFromDom(n,e),t)},moveCardOut:function(e){this._clearCards([e.data("id")])},clearCardArtifacts:function(e){delete this._cards[e.data("id")]},_appendCellContent:function(e,t){var i=this._renderConfig,n={cell:this._$cell,content:e,dataItem:this._cellModel.dataItem,scrollToTarget:t};i.beforeInsert(n),this._$cell.append(e),i.afterInsert(n)},_convertCardsToCellContent:function(e){var t=new o;return e.forEach(function(e){this._createCard(e).appendTo(t)},this),t.children()},_createCellContent:function(){return this._convertCardsToCellContent(this._cellModel.getCardModels().range())},_createCard:function(e){return this._cards[e.id]=new n(e,this._configurator,this._layoutFactory),this._cards[e.id]},_createCardFromDom:function(e,t){return this._cards[e.id]=new a(t,e,this._configurator,this._layoutFactory),this._cards[e.id]},_getCard:function(e){return this._cards[e]||new r(e)},_clearCards:function(t){e.each(t,this._clearCard.bind(this))},_clearCard:function(e){var t=this._getCard(e);t.clear()&&delete this._cards[e]},_removeCard:function(e,t){var i=this._getCard(e.id);return i.$dom().removeClass("i-role-card"),i.animateRemove(t).then(this._clearCard.bind(this,e.id)).then(this._fireOnViewUpdated.bind(this,"deleted",[],[e.cardData()]))},_addCardToDom:function(e,t){e.insertAt(this._$cell,t.index)},_updateCardDom:function(e,t,i){i.metricsOnly?e.updateMetrics(t):e.update(t)},_updateCards:function(t,i){var n=e.map(t,function(e){e.cardData().lazy=!1;var t=this._cards[e.id];return t?this._updateCardDom(t,e,i):(t=this._createCard(e),t.markAsChanged(),this._addCardToDom(t,i)),{$dom:t.$dom(),cardData:e.cardData(),hasAnimated:t.animateUpdate(i)}},this);
return this._completeUpdateOperation(n)},_addCards:function(t,i){var n=e.map(t,function(e){e.cardData().lazy=!1;var t=this._createCard(e);return this._addCardToDom(t,i),{$dom:t.$dom(),cardData:e.cardData(),hasAnimated:t.animateAdd(i)}},this);return this._completeUpdateOperation(n)},_completeUpdateOperation:function(i){return this._fireOnViewUpdated("updated",e.pluck(i,"$dom"),e.pluck(i,"cardData")),t.when.apply(t,e.pluck(i,"hasAnimated"))},_fireOnViewUpdated:function(e,t,i){this.onViewUpdated.fire({name:e,location:"card"},{$cell:this._$cell,cards:t||[],dataItems:i})}}),o=i.extend({init:function(){this._children=[]},append:function(e){this._children.push(e[0])},children:function(){return t(this._children)}});return s}),define("tau/components/board.timeline/models/cell/collection.cards",["Underscore","tau/core/class"],function(e,t){var i={id:function(e){return function(t){return t.id===e}}},n=t.extend({init:function(e,t){this._cards=e,this._ordering=t},actualCount:function(){return e.reject(this._cards,e.property("isPromise")).length},insert:function(e){var t=null;return this._ordering.isImplemented?(t=this._getSortedIndex(e),this._cards.splice(t,0,e)):(t=this._cards.length,this._cards.push(e)),t},sort:function(e){return this._ordering.isImplemented?(this.remove(e.id),this.insert(e)):this._cards.indexOf(e)},get:function(t){return e.find(this._cards,i.id(t))},range:function(e,t){return e=e||0,t=t||this._cards.length-1,this._cards.slice(e,t+1)},has:function(t){return e.any(this._cards,i.id(t))},remove:function(t){this._cards=e.reject(this._cards,i.id(t))},_getSortedIndex:function(t){return e.chain(this._cards).pluck("_cardData").pluck("orderingValue").sortedIndex(t.cardData().orderingValue,this._ordering.predicate).value()}});return n}),define("tau/components/board.timeline/models/cell/model.cell-paging.extension",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/cells.paging.size.config"],function(e,t,i,n){return i.extend({getPageSize:function(e,t){var i=0;
return t>1&&5>t?i=1:t>=5&&(i=2),n[e][i]},isAxisExist:function(e,t){var i=e[t];return i&&i.types&&i.types.length>0},getMaxPageSize:function(){return n[0][0]}})}),define("tau/components/board.timeline/models/cell/model.cell.base",["Underscore","tau/core/class","tau/components/board.timeline/models/cell/collection.cards","tau/components/board.timeline/models/cell/model.cell-paging.extension","tau/components/board.timeline/models/card/model.board.card"],function(e,t,i,n,a){var r=t.extend({init:function(t,i){this.definition=t,this._cardModels=null,this._setDataItem(i),this.onRefresh=e.Callbacks(),this.modelCellPagingExtension=new n;var a=0;this.modelCellPagingExtension.isAxisExist(this.definition,"y")&&++a,this.pageSize=this.modelCellPagingExtension.getPageSize(a,this.definition.zoomLevel),this.onCardRemoved=e.Callbacks(),this.onCardsAdded=e.Callbacks(),this.onCardsUpdated=e.Callbacks(),this.onCardsCleared=e.Callbacks()},processRawCardItem:e.identity,triggerRefresh:function(e){this._setDataItem(e),this.onRefresh.fire()},getCardModels:function(){return this._cardModels},_createCardModel:function(e){return new a(e)},_setDataItem:function(e){this.dataItem=e,this._cardModels=new i(this._convertCardItemsToModels(this.dataItem.dynamic.items),this._getOrdering())},_convertCardItemsToModels:function(t){return e.chain(t).unique(e.property("id")).map(this.processRawCardItem.bind(this)).map(this._createCardModel.bind(this)).value()},_removeCardById:function(e){var t=this._cardModels.get(e);return this._cardModels.remove(e),t},addCard:function(){throw new Error("addCard should be implemented in derived class")},updateCard:function(){throw new Error("updateCard should be implemented in derived class")},clearCard:function(e){this._cardModels.has(e)&&(this._cardModels.remove(e),this.onCardsCleared.fire([e]))},removeCard:function(e,t){var i=this._removeCardById(e);i&&this.onCardRemoved.fire(i,t)},_checkIfCardCanBeAdded:function(e){return!this._cardModels.has(e.id)},augmentCards:function(t){e.each(t,function(e){var t=this._cardModels.get(e.id);
t&&t.augment(e.data)},this)},_getOrdering:function(){var t=e.defaults(e.pick(this.definition.cells.ordering,"name","direction"),{name:"Rank",direction:"Desc",isImplemented:!1,predicate:function(){throw new Error(this.name+" sort is not implemented")}});return"Rank"===t.name&&(t.isImplemented=!0,t.predicate="Desc"===t.direction?function(e){return e}:function(e){return-e}),t}});return r}),define("tau/ui/templates/timeline/ui.template.timeline.card-holder",["tau/core/templates-factory"],function(e){var t={name:"timeline.card-holder",engine:"jqote2",markup:['<div class="tau-timeline-card i-role-timeline-card">','<div class="tau-card-planner i-role-card-planner <%=this.metrics.planned.showAsFixed ? "tau-planned-fixed-date": ""%>">','<div class="tau-start-date i-role-range-editor">','<div class="tau-start-date-arrow"></div>','<div class="ui-resizable-handle ui-resizable-w"></div>',"</div>",'<div class="tau-end-date i-role-range-editor">','<div class="tau-end-date-arrow"></div>','<div class="ui-resizable-handle ui-resizable-e"></div>',"</div>",'<div class="tau-card-holder i-role-timeline-planner-card-holder">','<div class="i-role-card-placeholder"></div>',"</div>","</div>",'<div class="i-role-timeline-card-holder tau-card-holder">','<div class="i-role-card-placeholder"></div>',"</div>",'<div class="i-role-card-predictor tau-card-predictor"></div>',"</div>"]};return e.register(t)}),define("tau/utils/timeline/utils.timeline.relative.position.calculator",[],function(){return{cutToViewport:function(e,t){return 0>e&&(t+=e,e=0),e+t>1&&(t=1-e),{left:e,width:t}}}}),define("tau/components/board.timeline/views/card/view.timeline.card.section-base",["Underscore","jQuery","tau/core/class","tau/utils/timeline/utils.timeline.relative.position.calculator"],function(e,t,i,n){var a=i.extend({init:function(e,t,i){this._model=e,this._viewMetrics=t,this._$section=i},$section:function(){return this._$section},setPosition:function(){this._prepareSection(this._$section);var t=this._isVisible();if(this._$section.visibility(t),t){var i=this._metrics(),a=n.cutToViewport(i.left,i.width);
this._$section.css({left:e.isNull(i.left)?"0":this._toCssPercent(a.left),width:e.isNull(i.width)?"":this._toCssPercent(a.width)})}},_metrics:function(){throw new Error("_metrics is not implemented in SectionBase")},_isVisible:function(){throw new Error("_isVisible is not implemented in SectionBase")},_prepareSection:function(){},_toCssPercent:function(e){return 100*e+"%"},_zeroIfNaN:function(t){return e.isNaN(t)?0:t}});return a}),define("tau/components/board.timeline/views/card/view.timeline.card.actual-section",["Underscore","jQuery","tau/components/board.timeline/views/card/view.timeline.card.section-base"],function(e,t,i){var n=i.extend({init:function(e,t,i,n){this._super(e,t,i),this._$section.find(".i-role-card-placeholder").replaceWith(n)},setContent:function(e){this._$section.find(".i-role-card").replaceWith(e)},setPosition:function(){this._super(),this._$section.toggleClass("tau-timeline-part-card",this._metrics().left<0)},_prepareSection:function(e){e.css({left:"",width:0}).mousedown(function(e){var i=t(this).offset();taus.track("action",{name:"timeline-actual-part-click",width:t(this).width(),height:t(this).height(),offsetX:e.pageX-i.left,offsetY:e.pageY-i.top})})},_isVisible:function(){return this._viewMetrics.actual.show?!0:this._viewMetrics.forecast.show&&this._model.hasActual?!0:this._isForecastPlannerVisible()},_isForecastPlannerVisible:function(){return Boolean(this._viewMetrics.forecast.show&&this._model.hasPlanned&&!this._model.hasActual)},_metrics:function(){return{left:this._zeroIfNaN(this._getLeft()),width:this._width()}},_getLeft:function(){return this._viewMetrics.actual.show?this._viewMetrics.actual.from:this._isForecastPlannerVisible()?this._viewMetrics.planned.from:this._viewMetrics.forecast.from},_width:function(){var e,t=this._viewMetrics.forecast.to-this._viewMetrics.forecast.from,i=this._viewMetrics.actual.to-this._viewMetrics.actual.from;return this._isForecastPlannerVisible()?e=this._viewMetrics.forecast.from-this._zeroIfNaN(this._viewMetrics.planned.from):(e=i,t=this._viewMetrics.forecast.show?t:0),this._zeroIfNaN(e)+Math.max(t,0)
}});return n}),define("tau/components/board.timeline/views/card/view.timeline.card.forecast-section",["Underscore","jQuery","tau/components/board.timeline/views/card/view.timeline.card.section-base"],function(e,t,i){var n=i.extend({_isVisible:function(){return this._viewMetrics.forecast.show&&(this._model.hasActual||this._model.hasPlanned)},_metrics:function(){return{left:this._viewMetrics.forecast.from,width:Math.max(this._viewMetrics.forecast.to-this._viewMetrics.forecast.from,0)}}});return n}),define("tau/components/board.timeline/views/timeline.card-metrics-editor",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e,t){this._model=e,this._viewMetrics=t},commit:function(){this._model.commitEdit()},resize:function(){throw new Error("Resize should be implemented in derived class")},drag:function(){throw new Error("Drag should be implemented in derived class")},leftResizeAvailable:function(){return!0},rightResizeAvailable:function(){return!0},plannedRange:function(){throw new Error("plannedRange should be implemented in derived classes")},_applyEdit:function(){throw new Error("_applyEdit should be implemented in derived classes")}}),n=i.extend({begin:function(){this._initial=e.pick(this.plannedRange(),"from","to"),this.drag(0)},drag:function(e){var t=-this._initial.to,i=1-this._initial.from,n=r(e,t,i);this._applyEdit(n,n)},resize:function(e,t){e==-t?this._resizeLeft(e):this._resizeRight(t)},leftResizeAvailable:function(){return this._viewMetrics.planned.from>=0},rightResizeAvailable:function(){return this._viewMetrics.planned.to<=1},plannedRange:function(){return{from:this._model.isStartDateInfinite?0:this._viewMetrics.planned.from,to:this._model.isEndDateInfinite?1:this._viewMetrics.planned.to}},_resizeLeft:function(e){var t=-this._initial.from,i=Math.min(this._initial.to,1)-this._initial.from;this._applyEdit(r(e,t,i),0)},_resizeRight:function(e){var t=this._initial.to-this._initial.from,i=-t,n=1-(this.plannedRange().from+t);this._applyEdit(0,r(e,i,n))
},_applyEdit:function(e,t){var i=this._initial.from+e,n=this._initial.to+t;this._viewMetrics.applyEdit(i,n)}}),a=i.extend({begin:function(){this._initial={from:this.plannedRange().from}},drag:function(e){this._applyEdit(r(e,-this._initial.from,-this._initial.from+1),0)},leftResizeAvailable:function(){return!1},rightResizeAvailable:function(){return!1},plannedRange:function(){return{from:this._viewMetrics.planned.from,to:null}},_applyEdit:function(e){var t=this._initial.from+e;this._viewMetrics.applyEdit(t,t)}}),r=function(e,t,i){return Math.max(t,Math.min(i,e))},s={fixed:a,durable:n};return{createFor:function(e,t){return new s[e.type](e,t)}}}),define("tau/components/board.timeline/views/card/view.timeline.card.tooltip",["Underscore","jQuery","tau/core/class","tau/utils/utils.date"],function(e,t,i,n){var a=i.extend({init:function(t){this._$dom=this._render(),this._model=t,this._model.onPlannedDatesUpdating.add(this._updatePosition,this),this._model.onPlannedDatesUpdating.add(e.throttle(this._updateContent,200),this),this._model.onPlannedDatesUpdated.add(this._hide,this),this._$dom.on("remove",this._destroy.bind(this))},appendTo:function(e){this._$dom.appendTo(e)},_render:function(){return t('<div class="tau-timeline-card-tooltip" style="width:100%;"></div>').tauBubble({zIndex:999,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),className:"tau-bubble-tooltip",mode:"tooltip",showEvent:"none",stackName:"tooltip",delay:500,onPositionConfig:this._tooltipPositionConfig,onArrowPositionConfig:this._tooltipPositionConfig})},_tooltipPositionConfig:function(e){e.at="center bottom-1",e.my="center top"},_updatePosition:function(){this._$dom.tauBubble("option","appendTo",t(".i-role-timeline-bubble-holder")),this._$dom.tauBubble("show")},_updateContent:function(){this._destroyed||this._$dom.tauBubble("setContent",r[this._model.type](this._model.plannedDateRange()))
},_hide:function(){this._$dom.tauBubble("hide")},_destroy:function(){this._destroyed=!0,this._model.onPlannedDatesUpdating.remove(this),this._model.onPlannedDatesUpdated.remove(this)}}),r={fixed:function(e){return s(e.startDate)},durable:function(e){return l(e)}},s=function(e){return n.format.datetime.short(n.convertToTimezone(e))},o=function(e){return null===e?"-&infin;":n.format.date.short(n.convertToTimezone(e))},l=function(e){return o(e.startDate)+"&nbsp;&nbsp;"+o(e.endDate)};return a}),define("tau/components/board.timeline/views/card/view.timeline.card.planned-section",["Underscore","jQuery","tau/components/board.timeline/views/card/view.timeline.card.section-base","tau/components/board.timeline/views/timeline.card-metrics-editor","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/components/board.timeline/views/card/view.timeline.card.tooltip"],function(e,t,i,n,a,r){var s=i.extend({init:function(t,i,s,o,l){this._super(t,i,s),this._$section.find(".i-role-card-placeholder").replaceWith(o),this._cardMetricsEditor=n.createFor(t,i),this._cardMetricsConverter=l,this.onEditStarted=e.Callbacks(),this.onEditStopped=e.Callbacks(),this._$section.find(".i-role-range-editor").on("dblclick mouseenter mousemove mouseleave",a.redirectEvent.bind(this,o)),this._$section.resizable({handles:{w:this._$section.find(".ui-resizable-w"),e:this._$section.find(".ui-resizable-e")},minWidth:3,resize:this._onResize.bind(this),start:this._onEditStart.bind(this),stop:this._onEditStop.bind(this)}).draggable({axis:"x",scroll:!1,drag:this._onDrag.bind(this),start:this._onEditStart.bind(this),stop:this._onEditStop.bind(this)}).css("position","absolute"),new r(t).appendTo(this._$section)},_prepareSection:function(e){e.css({left:"",width:0})},_isVisible:function(){return this._model.showPlanned||this._model.showFixed},_metrics:function(){var t=this._cardMetricsEditor.plannedRange();return{left:t.from,width:e.isNull(t.to)?null:t.to-t.from}},setPosition:function(){if(this._super(),this._viewMetrics.planned.show&&this._viewMetrics.forecast.show&&!this._model.hasActual){var t=this._$section.find(".i-role-card");
if(this._viewMetrics.planned.from<this._viewMetrics.forecast.from)t.hide();else{var i=this._model.cardData().data.cardData.type.toLowerCase();t.removeClass("tau-card-v2_type_"+i)}}var n=this._metrics();this._$section.find(".tau-start-date").toggle(n.left>=0),this._$section.find(".tau-end-date").toggle(!e.isNull(n.width)&&n.left+n.width<=1),this._$section.find(".ui-resizable-w").toggle(this._cardMetricsEditor.leftResizeAvailable()),this._$section.find(".ui-resizable-e").toggle(this._cardMetricsEditor.rightResizeAvailable()),this._$section.toggleClass("tau-timeline-part-card",this._model.isStartDateInfinite||this._metrics().left<0)},_onResize:function(e,t){var i=this._cardMetricsConverter.toRelative(t.position.left-t.originalPosition.left),n=this._cardMetricsConverter.toRelative(t.size.width-t.originalSize.width);this._cardMetricsEditor.resize(i,n)},_onDrag:function(e,t){var i=this._cardMetricsConverter.toRelative(t.position.left-t.originalPosition.left);this._cardMetricsEditor.drag(i),t.position.left=this._$section.position().left},_onEditStart:function(){this._cardMetricsEditor.begin(),this.onEditStarted.fire()},_onEditStop:function(){this._cardMetricsEditor.commit(),this.onEditStopped.fire()}});return s}),define("tau/components/board.timeline/views/card/view.timeline.card",["Underscore","jQuery","tau/components/board.timeline/views/card/view.card-base","tau/components/board.timeline/models/cell/model.cell.base","tau/ui/templates/timeline/ui.template.timeline.card-holder","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/components/board.timeline/views/card/view.timeline.card.actual-section","tau/components/board.timeline/views/card/view.timeline.card.forecast-section","tau/components/board.timeline/views/card/view.timeline.card.planned-section","tau/components/board.timeline/views/timeline.card-metrics-editor"],function(e,t,i,n,a,r,s,o,l){var u=i.extend({init:function(t,i,n,a){this._boardCardView=i,this._cardMetricsConverter=n,this._viewMetrics=a,this.onEditStarted=e.Callbacks(),this.onEditStopped=e.Callbacks(),this._super(t),this._updateCardHolderGeometry(),this._model.onPlannedDatesUpdating.add(this._refreshMetrics,this)
},cardData:function(){return this._model.cardData()},metrics:function(){return this._viewMetrics.get()},_refreshMetrics:function(e){this._viewMetrics.update(e),this._clearCache(),this._updateCardHolderGeometry()},insertAt:function(e,t){this._$dom.insertAt(e,t)},_updateCardHolderGeometry:function(){this._sections.actual.setPosition(),this._sections.planned.setPosition(),this._sections.forecast.setPosition()},_$render:function(){var e=a.render({metrics:this.metrics()}),t=this._boardCardView.$dom();return this._sections={planned:new l(this._model,this._viewMetrics,e.find(".i-role-card-planner"),t,this._cardMetricsConverter),actual:new s(this._model,this._viewMetrics,e.find(".i-role-timeline-card-holder"),t.clone(!0)),forecast:new o(this._model,this._viewMetrics,e.find(".i-role-card-predictor"))},this._sections.planned.onEditStarted.add(this.onEditStarted.fire.bind(this.onEditStarted,this)),this._sections.planned.onEditStopped.add(this.onEditStopped.fire.bind(this.onEditStopped,this)),this._sections.planned.onEditStopped.add(this.markAsNotChanged.bind(this)),this._sections.forecast.$section().on("contextmenu mouseup mousedown dblclick click mouseenter mouseleave",function(e){r.redirectEvent(this._sections.actual.$section().find(".i-role-card"),e)}.bind(this)),e.data("visualMetrics",this.metrics()),e},update:function(e){this._model.update(e.cardData()),this._refreshMetrics(e),this._boardCardView.update(this._model),this._sections.actual.setContent(this._boardCardView.$dom().clone(!0)),this._checkVisualMetricsChanged()},updateMetrics:function(e){this._model.update(e.cardData()),this._refreshMetrics(e),this._updateCardHolderGeometry()},remove:function(){this._$dom.remove()},$dom:function(){return this._$dom.find(".i-role-card")},clearArtifacts:function(){this.remove(),this.onCleared.fire(this)},animateUpdate:function(e){return this._changed&&(this._boardCardView.markAsChanged(),this.markAsNotChanged()),this._boardCardView.animateUpdate(e)},whenAnimated:function(e,t){return this._boardCardView.whenAnimated(e,t)
},_checkVisualMetricsChanged:function(){var t=this._$dom.data("visualMetrics"),i=this.metrics();e.isEqual(t,i)||(this.markAsChanged(),this._$dom.data("visualMetrics",i))},_clearCache:function(){this._effectiveCardPosition=null}});return u}),define("tp/jquery.utils",["jQuery"],function(e){e.fn.right=function(){return this.offset().left+this.width()},e.fn.bottom=function(){return this.offset().top+this.height()},e.fn.id=function(){return this.attr("id")},e.fn.visibility=function(e){e?"hidden"===this.css("visibility")&&this.css("visibility","visible"):this.css("visibility","hidden")},e.fn.selectClass=function(e,t,i){e?(this.removeClass(i),this.addClass(t)):(this.removeClass(t),this.addClass(i))},e.fn.stretch=function(){var t=e("html");this.height(t.height()),this.width(t.width())},e.fn.outerclick=function(t){function i(e,t){return e[0]==t[0]?!0:e.has(t).length>0}function n(n){i(this,e(n.target))||t.call(this,n)}e("body").click(e.proxy(n,this))},e.widget("ui.modal",{overlay:null,resizeHandler:null,_create:function(){this.overlay=this._createOverlay(),this.resizeHandler=e.proxy(this._onResize,this)},_createOverlay:function(){var t=e('<div class="modalBackground" style="position:absolute; left:0px; top:0px;"/>');return t.attr("disabled","disabled"),t.zIndex(this.element.zIndex()-1),t},_onResize:function(){this.overlay.stretch()},show:function(){this._onResize(),e(window).bind("resize",this.resizeHandler),this.overlay.appendTo("body"),this.element.show()},hide:function(){e(window).unbind("resize",this.resizeHandler),this.overlay.remove(),this.element.hide()}});var t=function(e,t,i){var n={complete:i,duration:300,queue:!0};e.animate(t,n)};e.fn.minimizeTo=function(e){var i=this,n=e.target,a=e.callback,r=i.offset(),s={left:r.left,top:r.top,width:i.width(),height:i.height()};i.data(s);var o=n.offset(),l={left:o.left,top:o.top,width:0,height:0},u=function(){i.hide(),a&&a()};t(i,l,u)},e.fn.maximizeFrom=function(i){var n=this,a=i.target,r=i.callback,s=i.settings||{},o=a.offset(),l=n.data(),u=["left","top","width","height"];
e.each(u,function(e,t){l.hasOwnProperty(t)&&(s[t]=l[t])}),n.hide(),n.width(0),n.height(0),n.css("left",o.left),n.css("top",o.top),n.show();var c=function(){r&&r()};t(n,s,c)};var i={getEnable:function(e){return!e.hasClass("disabled")},setEnabled:function(e,t){t?e.removeClass("disabled"):e.addClass("disabled")}},n={getEnable:function(e){return e.is(":enabled")},setEnabled:function(e,t){t?e.removeAttr("disabled"):e.attr("disabled","disabled")}};e.fn.enabled=function(t){var a=e(this),r=a.is("a")?i:n;return null==t?r.getEnable(a):void r.setEnabled(a,t)},e.repeat=function(e,t){for(var i=[],n=0;t>n;n++)i.push(e);return i},e.fn.serializeObject=function(){var t={},i=this.serializeArray();return e.each(i,function(){void 0===t[this.name]?t[this.name]=this.value||"":(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||""))}),t},e.fn.insertAt=function(e,t,i){this.detach();var n=e.children(i);if(!n.length||!t)return this.prependTo(e);var a=Math.min(n.length,t);return this.insertAfter(n.eq(a-1))},e.fn.classes=function(){return(this.attr("class")||"").split(/\s+/).filter(function(e){return 0!==e.length})}}),define("tau/components/board.timeline/views/timeline.card-placement-strategy",["Underscore","tau/core/class"],function(e,t){var i=t.extend({_minimumCardWidth:3,init:function(e){this._tracks=[],this._minWidthInPercent=this._minimumCardWidth/e,this._lockedCards=[]},lockCard:function(e){this._lockedCards.push(e)},unlockCard:function(t){this._lockedCards=e.without(this._lockedCards,t)},unlockAllCards:function(){this._lockedCards=[]},updatePositions:function(){var t=this._tracks;this._tracks=e.map(t,function(t,i){return{index:i,cards:e.intersection(t.cards,this._lockedCards)}},this);var i={tracksChanges:[],inTrackChanges:[]};return t.forEach(function(t){var n=e.difference(t.cards,this._lockedCards);e.each(n,function(e){var n=this.addCard(e);(t.index!==n.track||t.cards.indexOf(e)!==n.index)&&i.tracksChanges.push({cardId:e.id,position:n})},this)},this),0===this._lockedCards.length?i.tracksChanges:(t.forEach(function(t){var n=e.intersection(t.cards,this._lockedCards);
e.each(n,function(e){var n=t.cards.indexOf(e),a=this._tracks[t.index].cards,r=a.indexOf(e);if(r!==n){var s,o,l;for(r>n?(s=0,o=a.length,l=1):(s=a.length-1,o=-1,l=-1);s!==o;){if(s!==r){var u=a[s].id,c={track:t.index,index:s};i.inTrackChanges.push({cardId:u,position:c})}s+=l}}},this)},this),i.tracksChanges.concat(i.inTrackChanges))},removeCard:function(t){this._tracks.forEach(function(i){i.cards=e.filter(i.cards,function(e){return e.id!==t})})},_getEffectiveCardPosition:function(e){return e._effectiveCardPosition=e._effectiveCardPosition||this._calculateEffectiveCardPosition(e),e._effectiveCardPosition},_calculateEffectiveCardPosition:function(t){var i=t.metrics(),n=t.cardData(),a=[i.actual.from,i.planned.from],r=i.planned.showAsFixed?2:1,s=[Math.max(i.actual.to,i.actual.from+this._minWidthInPercent),Math.max(i.planned.to,i.planned.from+this._minWidthInPercent*r)];return(n.showActual||(n.hasActual||n.hasPlanned)&&n.showForecast)&&(a.push(i.forecast.from),s.push(Math.max(i.forecast.to,i.forecast.from+this._minWidthInPercent))),{from:e.min(a,function(t){return e.isNaN(t)?1/0:t}),to:e.max(s,function(t){return e.isNaN(t)?-1/0:t})}},_doesNotIntersect:function(e,t){var i=this._getEffectiveCardPosition(e),n=this._getEffectiveCardPosition(t),a=1e-10;return i.from+a>n.to||i.to<n.from+a},_findTrackFor:function(t){return e.find(this._tracks,function(i){return e.every(i.cards,this._doesNotIntersect.bind(this,t),this)},this)},_getTrack:function(e){return this._tracks[e]},addCard:function(t,i){return e.isUndefined(i)?this._addCard(t,this._findTrackFor(t)):(this.lockCard(t),this._addCard(t,this._getTrack(i)))},_addCard:function(e,t){return t||(t={cards:[],index:this._tracks.length},this._tracks.push(t)),t.cards.push(e),t.cards.sort(function(e,t){return this._getEffectiveCardPosition(e).from-this._getEffectiveCardPosition(t).from}.bind(this)),{track:t.index,index:t.cards.indexOf(e)}},getMinWidthInPercent:function(){return this._minWidthInPercent}});return i}),define("tau/ui/templates/timeline/ui.template.timeline.track",["tau/core/templates-factory"],function(e){var t={name:"timeline.track",engine:"jqote2",markup:['<div class="<%= this.roleCssClass %> tau-timeline-track"></div>']};
return e.register(t)}),define("tau/components/board.timeline/views/timeline.track-view-creation-strategies",["Underscore","tau/core/class","tau/ui/templates/timeline/ui.template.timeline.track"],function(e,t,i){var n="i-role-timeline-track",a=t.extend({_createDom:function(){return i.render({roleCssClass:n})},init:function(){this._$dom=this._createDom()},appendTo:function(e){this._$dom.appendTo(e)}}),r=t.extend({init:function(){this._tracks=[]},get:function(e){for(;!this._tracks[e];)this._tracks.push(new a);return this._tracks[e]._$dom},$content:function(){return e.map(this._tracks,function(e){return e._$dom})}}),s=t.extend({init:function(e){this._$dom=e},get:function(e){for(;0===this.$content().eq(e).length;)(new a).appendTo(this._$dom);return this.$content().eq(e)},$content:function(){return this._$dom.find("."+n)}}),o={InMemory:function(){return new r},InDom:function(e){return new s(e)}};return o}),define("tau/components/board.timeline/views/view.timeline.cell.tracks",["Underscore","jQuery","tp/jquery.utils","tau/core/class","tau/components/board.timeline/views/timeline.card-placement-strategy","tau/components/board.timeline/views/timeline.track-view-creation-strategies"],function(e,t,i,n,a,r){var s=n.extend({init:function(e,t){this._busEvents=t,this._cardPlacementStrategy=new a(e),this._tracks=r.InMemory(),this._cards={}},_onCardCleared:function(e){this.removeCard(e.id),this.updateCardCascade()},addCard:function(t,i){t.onEditStarted.add(this._cardPlacementStrategy.lockCard,this._cardPlacementStrategy),t.onEditStopped.add(this._cardPlacementStrategy.unlockCard,this._cardPlacementStrategy),t.onCleared.add(this._onCardCleared.bind(this));var n=this._cardPlacementStrategy.addCard(t,i.track);this._storeTracksCount(),this._setCardPosition(t,n),this._cards[t.id]=t,e.isUndefined(i.track)||(this._updatePositions(),i.forceUnlock&&this._cardPlacementStrategy.unlockCard(t)),this._checkTracksCountChanged()},unlockAllCards:function(){this._cardPlacementStrategy.unlockAllCards()
},_setCardPosition:function(e,t){e.insertAt(this._tracks.get(t.track),t.index)},removeCard:function(e){this._cardPlacementStrategy.removeCard(e),this._cards[e]&&(this._cards[e].remove(),delete this._cards[e])},updateCardCascade:function(){this._storeTracksCount(),this._updatePositions(),this._checkTracksCountChanged()},setContainer:function(e){this._tracks=r.InDom(e)},$content:function(){return this._tracks.$content()},_updatePositions:function(){var t=this._cardPlacementStrategy.updatePositions();e.each(t,function(e){e.position?this._setCardPosition(this._cards[e.cardId],e.position):this.removeCard(e.cardId)},this),this.$content().filter(":empty").remove()},_storeTracksCount:function(){this._storedTracksCount=this.$content().length},_checkTracksCountChanged:function(){this.$content().length!=this._storedTracksCount&&this._busEvents.viewTimelineTracksCountChanged.fire()}});return s}),define("tau/components/board.timeline/views/view.timeline.cell.axisDates",["Underscore","jQuery","tp/jquery.utils","tau/core/class","tau/utils/timeline/utils.timeline.relative.position.calculator"],function(e,t,i,n,a){var r=n.extend({init:function(){},render:function(i){return this._$cellPlanner=t('<div class="tau-cell-planner i-role-cell-planner"></div>'),i&&this._$cellPlanner.attr("title","planned start/end dates of "+e.escape(i)),this._$cellPlanner},setCoords:function(e){var t=a.cutToViewport(e.from,e.to-e.from);return t.width?void this._$cellPlanner.css({left:100*Math.max(0,t.left)+"%",width:100*t.width+"%",visibility:"visible"}):void this._$cellPlanner.css({visibility:"hidden"})}});return r}),define("tau/components/board.timeline/view/view.cell.timeline",["Underscore","jQuery","tau/core/class","tau/utils/utils.date","tau/components/board.timeline/view/view.cell.base","tau/components/board.timeline/views/card/view.timeline.card","tau/components/board.timeline/views/view.timeline.cell.tracks","tau/components/board.timeline/views/view.timeline.cell.axisDates"],function(e,t,i,n,a,r,s,o){function l(e){return"cell-view-"+e.dataItem.x+e.dataItem.y
}var u=a.extend({init:function(t,i,n,a,r,l,u){this._busEvents=l,this._viewMetricsFactory=u,t.onYAxisUpdated.add(this._updateAxisPlannerPosition,this),this._cellPlanner=new o,this._tracks=new s(r.timelineWidth,this._busEvents),this._debouncedUpdateCardCascade=e.debounce(this._tracks.updateCardCascade.bind(this._tracks),1),this._cardMetricsConverter=new c(i),this._super(t,i,n,a,r)},refresh:function(){this._tracks=new s(this._renderConfig.timelineWidth,this._busEvents),this._super()},_createTimelineCard:function(e,t){e.onPlannedDatesUpdating.add(this._busEvents.hintHide.fire,this._busEvents.hintHide),e.onPlannedDatesUpdated.add(function(){this._busEvents.cardUnselect.fire(t.$dom())},this);var i=this._viewMetricsFactory.create(e);return i.onUpdated.add(this._debouncedUpdateCardCascade,this),new r(e,t,this._cardMetricsConverter,i)},_createCard:function(e){return this._cards[e.id]=this._createTimelineCard(e,this._super(e)),this._cards[e.id]},_createCardFromDom:function(e,t){return this._cards[e.id]=this._createTimelineCard(e,this._super(e,t)),this._cards[e.id]},_createCellContent:function(){e.each(this._cellModel.getVisibleCardModels(),function(e){var t=this._createCard(e);this._addCardToDom(t,{})},this);var t=this._tracks.$content();return this._tracks.setContainer(this._$cell),t},_appendCellContent:function(e,t){this._super(e,t);var i=this._cellModel.getYAxisDataRange();this._$cell.closest(".i-role-cellholder").append(this._cellPlanner.render(i.data?i.data.name:null)),this._updateAxisPlannerPosition(i)},_addCardToDom:function(e,t){this._tracks.addCard(e,t)},_completeUpdateOperation:function(e){return this._tracks.updateCardCascade(),this._super(e)},_clearCards:function(e){this._super(e),this._tracks.updateCardCascade()},moveCardIn:function(e,t){if(!this._cards[e.data("id")]){e.detach();var i=e.data("data-item");i.data={cardData:e.data("card-data")};var n=this._cellModel.moveCardIn(i),a=new d(this._$cell),r=this._createCardFromDom(n,e),s=new p(r._viewMetrics,a,t.at);this._addCardToDom(r,t),s.edit({pageX:t.at.x}),e.on("drag."+l(this._cellModel),s.edit.bind(s))
}},clearCardArtifacts:function(e){var t=e.data("id");this._getCard(t).clearArtifacts(),delete this._cards[t],this._cellModel.moveCardOut(t),e.off("."+l(this._cellModel))},moveCardOut:function(e){this.clearCardArtifacts(e)},unlockAllTrackCards:function(){this._tracks.unlockAllCards()},_updateAxisPlannerPosition:function(t){var i=this._viewMetricsFactory.create({cardData:e.constant(t),onPlannedDatesUpdating:e.Callbacks()});this._cellPlanner.setCoords(i.planned)},createPlaceholderContent:t.noop}),c=i.extend({init:function(e){this._$container=e},toRelative:function(e){return e/this._$container.width()}}),d=i.extend({init:function(e){this._$container=e,this._offset=this._$container.offset(),this._maxOffset={left:e.outerWidth()-3,top:e.outerHeight()}},toRelative:function(e){return Math.min(e-this._offset.left,this._maxOffset.left)/this._$container.width()}}),p=i.extend({init:function(e,t,i){this._viewMetrics=e,this._cardMetricsConverter=t;var n=this._cardMetricsConverter.toRelative(i.x);this._applyEdit(n)},edit:function(e){var t=this._cardMetricsConverter.toRelative(e.pageX);this._applyEdit(t)},_applyEdit:function(e){var t=this._viewMetrics.planned.to-this._viewMetrics.planned.from;this._viewMetrics.applyEdit(e,e+t)}});return u}),define("tau/ui/templates/board.plus/ui.template.boardplus.cell-paging-track",["tau/core/templates-factory","tau/nls/translator"],function(e){var t={name:"boardplus.cell-paging-track",engine:"jqote2",markup:['<div class="i-role-cell-paging-more tau-cell-paging-more"></div>'],dependencies:[]};return e.register(t)}),define("tau/components/board.timeline/view/view.cell.board",["Underscore","tau/core/class","jQuery","tau/components/board.timeline/view/view.cell.base","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/ui/templates/board.plus/ui.template.boardplus.show-more","tau/ui/templates/board.plus/ui.template.boardplus.cell-paging-track","tau/ui/behaviour/common/ui.behaviour.progressIndicator"],function(e,t,i,n,a,r,s,o){var l=t.extend({init:function(){this.onClick=e.Callbacks()
},render:function(){return r.render({}).on("click",this.onClick.fire.bind(this.onClick))}}),u=t.extend({render:function(){return s.render({})}}),c=n.extend({init:function(t,i,n,a,r){this._pagingTriggerView=new l,this._pagingTriggerView.onClick.add(this.processPagingInCell.bind(this)),this._tempCardsTrackView=new u,this._getCellPagingTrigger=e.once(this._pagingTriggerView.render.bind(this._pagingTriggerView)),this._getTempCardsTrack=e.once(this._tempCardsTrackView.render.bind(this._tempCardsTrackView)),this._super(t,i,n,a,r),t.onDonePaging.add(this.renderRange.bind(this))},processPagingInCell:function(){this._showProgress(),this._cellModel.doPaging()},renderRange:function(e){var t=this._createContentRange(e);this._appendCellContent(t,!0)},_createContentRange:function(e){return this._convertCardsToCellContent(this._cellModel.getCardModels().range(e.from,e.to))},_appendCellContent:function(e,t){var i=this._getCellPagingTrigger(),n=this._getTempCardsTrack();this._super(e,t),this._cellModel.hasPaging?(this._adjustCellPagingTrigger(i),this._$cell.append(i).append(n)):(i.detach(),n.detach()),this._hideProgress()},_showProgress:function(){o.get(this._$cell).show(),this._$cell.parent().css("opacity",.5)},_hideProgress:function(){o.get(this._$cell).hide(),this._$cell.parent().css("opacity",1)},_adjustCellPagingTrigger:function(e){var t=this._$cell.closest(".i-role-board-body-holder"),i=t.hasClass("tau-ui-size-min"),n=!i&&t.hasClass("tau-ui-size-xl");if(!i&&!n){var a=this._$cell.find(".i-role-card:eq(0)");e.css({height:a.outerHeight(),width:a.outerWidth()})}},_addCardToDom:function(e,t){e.isPromise()?e.appendTo(this._getTempCardsTrack()):this._super(e,t)},_updateCardDom:function(t,i,n){e.isUndefined(n.index)||n.index!==t.index()&&(t.markAsChanged(),t.insertAt(this._$cell,n.index)),this._super(t,i,n)},createPlaceholderContent:a.createDragNDropPlaceholderContent});return c}),define("tau/components/board.timeline/view/view.axis-cell.board",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n,a){return i.extend({init:function(t,i,n,a,r){this._$axisCell=i,this._model=t,this._template=a.getTemplateFactory().get("boardplus.cell.axis.skeleton"),this._renderConfig=e.defaults(r,{beforeInsert:e.identity,afterInsert:e.identity}),this.onViewUpdated=e.Callbacks(),t.onAxisUpdated.add(this._updateAxis.bind(this)),t.onAxisRemoved.add(this._removeAxis.bind(this))
},_$createAxisItem:function(e){var t=a.convertCellAxisData({dynamic:{items:[e]}});return t.dynamic=!0,this._template.bind({},t)},render:function(){var e={cell:this._$axisCell,content:t(),dataItem:this._model.dataItem};this._renderConfig.beforeInsert(e),this._$axisCell.append(this._$createAxisItem(this._model.dataItem.dynamic.items[0])),this._renderConfig.afterInsert(e)},_fireOnViewUpdated:function(t,i,n){this.onViewUpdated.fire({name:t,items:e.map(n,function(e){return{data:e}}),location:"axis"},{$cell:this._$axisCell,cards:i||[],dataItems:n})},_updateAxis:function(e){var i=e.card.data,a=this._$createAxisItem(i);this._$axisCell.empty().append(a),t.when(n.animated(a,"tau-operation_axis_updated")).then(t.noop),this._fireOnViewUpdated("updated",[a],[i])},_removeAxis:function(i){var n=this._$axisCell,a=function(t,i){var n=t.attr("class")||"",a=e.reduce(i,function(e,t){return e.replace(t.key,t.val)},n);return t.attr("class",a),t},r=function(){var e=[{key:/i-role-/gi,val:"i-disabled-role-"}];a(t(this),e).removeProp("checked").prop("disabled",!0)},s=function(){var e=t(this);a(e,[{key:/i-role-(?!cell\b)/gi,val:"tau-disabled-role-"}]).addClass("tau-cellaxis__removed").css("opacity",.3),a(e.parent(".i-role-cellholder"),[{key:/i-role-(?!cellholder\b)/gi,val:"tau-disabled-role-"},{key:/tau-selected/gi,val:"tau-disabled-selected"}])};n.find("*").each(r),n.each(s),this._fireOnViewUpdated("deleted",[],[i])}})}),define("tau/components/board.timeline/models/collection.coords.based",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n={coords:function(e){return function(t){return t.coords.x===e.x&&t.coords.y===e.y}}},a=i.extend({init:function(){this.clear()},clear:function(){this._items=[]},insert:function(t,i){t=this._extractCoords(t);var a=e.find(this._items,n.coords(t));a?a.value=i:this._items.push({coords:t,value:i})},has:function(t){return t=this._extractCoords(t),e.any(this._items,n.coords(t))},get:function(t){t=this._extractCoords(t);var i=e.find(this._items,n.coords(t));
return i?i.value:null},remove:function(t){t=this._extractCoords(t),this._items=e.reject(this._items,n.coords(t))},forEach:function(t,i){e.each(this._items,function(e){t.call(i,e.value,e.coords)})},_extractCoords:function(t){return e.defaults(e.pick(t,"x","y"),{x:"null",y:"null"})}});return a}),define("tau/components/board.timeline/views/card/view.timeline.card-metrics",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(t,i){this._cardModel=t,this._timelineRangeModel=i,this.onUpdated=e.Callbacks(),this.update(t)},update:function(t){e.extend(this,this.calculateViewMetrics(t.cardData())),this.onUpdated.fire()},get:function(){return e.pick(this,"actual","planned","forecast")},applyEdit:function(e,t){var i=this._timelineRangeModel.getCorrespondingDateRange({from:e,to:t});this._cardModel.applyEdit(i)},calculateViewMetrics:function(e){var t=e.showPlanned&&this._processPlannedSection(e),i=e.showFixed&&this._processFixedSection(e);return{planned:t||i||this._noMetrics(),actual:e.showActual?this._processActualSection(e):this._noMetrics(),forecast:e.showForecast?this._processForecastSection(e):this._noMetrics()}},_noMetrics:function(){return{show:!1,from:0/0,to:0/0}},_processFixedSection:function(e){return{show:!0,showAsFixed:!0,from:this._timelineRangeModel.toRelativeOffset(e.fixedDate),to:null}},_processActualSection:function(e){return{show:!0,from:this._timelineRangeModel.toRelativeOffset(e.actualStartDate),to:this._timelineRangeModel.toRelativeOffset(e.actualEndDate)}},_processPlannedSection:function(e){return{show:!0,from:this._cardModel.isStartDateInfinite?-1/0:this._timelineRangeModel.toRelativeOffset(e.plannedStartDate),to:this._cardModel.isEndDateInfinite?+1/0:this._timelineRangeModel.toRelativeOffset(e.plannedEndDate)}},_processForecastSection:function(e){return{show:!0,from:this._timelineRangeModel.toRelativeOffset(e.forecastStartDate),to:this._timelineRangeModel.toRelativeOffset(e.forecastEndDate)}}});return{_timelineRangeModel:null,setRangeModel:function(e){this._timelineRangeModel=e
},create:function(e){return new i(e,this._timelineRangeModel)}}}),define("tau/components/board.timeline/view/view.timeline.registry",["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/components/board.timeline/view/view.cell.timeline","tau/components/board.timeline/view/view.cell.board","tau/components/board.timeline/view/view.axis-cell.board","tau/components/board.timeline/models/collection.coords.based","tau/components/board.timeline/views/card/view.timeline.card-metrics"],function(e,t,i,n,a,r,s,o,l){var u=i.extend({init:function(e,t){l.setRangeModel(e),this._timelineRangeModel=e,this._busEvents=t,this._cellViews=new o},renderCell:function(e,t,i,n,a){return i.isTimeline?this._renderTimelineCell(a,e,t,i,n):this._renderBoardCell(e,t,i,n)},renderAxisCell:function(e,t,i,n){this._renderCell(s,e,t,i,n).done(this._addAxisCellToRegistry.bind(this))},_addCellToRegistry:function(e){return e.onViewUpdated.add(function(t,i){this._busEvents.onCellUpdated.fire({target:e,operation:t,result:i})},this),this._cellViews.insert(e._$cell.data(),e),e},_addAxisCellToRegistry:function(e){return e.onViewUpdated.add(function(t,i){this._busEvents.onAxisUpdated.fire({target:e,operation:t,result:i})},this),e},axisCellsAdded:function(i,n){this._busEvents.onAxisUpdated.fire({target:null,operation:{name:"added",location:"axis",items:i,options:n},result:{cards:[],dataItems:e.pluck(i,"data"),$cell:t("<div></div>").data(e.first(i).data)}})},moveCard:function(e,t,i,n){this.moveCardToCell(e,i,n),this.clearCardFromCell(e,t)},clearCardArtifacts:function(e,t){this._getCellViewByCoords(t).clearCardArtifacts(e)},moveCardToCell:function(e,t,i){this._getCellViewByCoords(t).moveCardIn(e,i)},clearCardFromCell:function(e,t){this._getCellViewByCoords(t).moveCardOut(e)},unlockAllTrackCards:function(){this._cellViews.forEach(function(e){e.unlockAllTrackCards&&e.unlockAllTrackCards()})},_getCellViewByCoords:function(e){return this._cellViews.get(e)||new c},_getCellElement:function(e,t){var i=n.generateId(e);
return t.find("#"+i)},_renderTimelineCell:function(e,t,i,n,r){return e.then(function(e){return this._renderCell(a,t,i,n,r,{timelineWidth:e})}.bind(this)).then(this._addCellToRegistry.bind(this))},_renderBoardCell:function(e,t,i,n){return this._renderCell(r,e,t,i,n).then(this._addCellToRegistry.bind(this))},_renderCell:function(t,i,n,a,r,s){var o=this._getCellElement(a.dataItem,r);return s=e.extend({beforeInsert:this._busEvents.onBeforeUpdateCell.fire.bind(this._busEvents.onBeforeUpdateCell),afterInsert:this._busEvents.onAfterUpdateCell.fire.bind(this._busEvents.onAfterUpdateCell)},s),n.getLayoutFactory().then(function(e){var n=new t(a,o,e,i,s,this._busEvents,l);return n.render(),n}.bind(this))}}),c=i.extend({init:function(){},_$cell:t(),moveCardIn:t.noop,clearCardArtifacts:t.noop,createPlaceholderContent:t.noop});return u}),define("tau/ui/extensions/timeline/dom-wrapper/timeline.dom-wrapper",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.board.plus.domWrapper","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i){return i.extend({executeClear:function(){throw new Error("Invalid usage")},insert$cardTo$cell:function(){throw new Error("Invalid usage")},getCellsEmptyStatuses:function(e){var i=this.getCellsAxisLineBySliceCoordinates({y:t(e).attr("data-y")});return this._super(i)}})}),define("tau/ui/extensions/timeline/ui.extension.timeline.view",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.extension.board.plus.view","tau/ui/extensions/timeline/dom-wrapper/timeline.dom-wrapper","tau/ui/extensions/board.plus/ui.extension.board.plus.operations.strategies","tau/components/board.timeline/models/cell/model.cell-paging.extension"],function(e,t,i,n,a,r){var s=i.extend({resetLifecycle:!0,init:function(e){this._timelineWidthDeferred=t.Deferred(),this.modelCellPagingExtension=new r,this._super(e)},_getCustomizedBacklogTemplateConfig:function(i,n,a){var r=t.Deferred();return n.getLayoutFactory().done(function(t){var n=e.extend({getLayout:t,configurator:i},a);
r.resolve({name:"boardplus.cell.grid.skeleton.customized",data:n})}),r},buildCellSkeleton:function(e,t,i,n){this.fire("build.timeline.cell.skeleton",{configurator:e,boardLayout:t,buildCellCommand:i,boardSkeleton:n,timelineWidthDeferred:this._timelineWidthDeferred})},buildAxisSkeleton:function(e,t,i,n){this.fire("build.timeline.axis.skeleton",{configurator:e,boardLayout:t,buildAxisCellCommand:i,boardSkeleton:n})},getCellTemplateConfig:function(e,t,i){return this._getCustomizedBacklogTemplateConfig(e,t,i)},getCoords:function(e){var t=this._super(e);return e.hasAttribute("data-istimeline")&&(t.isTimeline="true"===e.getAttribute("data-istimeline")),t},createDomWrapper:function(e,t,i,a){return new n(e,i,a,t)},"bus configurator.ready + definition.ready + model.cells.metaInfo.ready + view.skeleton.built + board.paging.settings + cardLayoutFactory.ready":function(e,t,i,n,a,r,s){var o=this.createDomWrapper(a.element,t,i,n);o.getPagingSettings=function(){return r},o.cardLayoutFactory=s,this.fire("domWrapper.ready",o)},"bus configurator.ready:last + operation.execute.done":function(e,t,i){a.applyCompleteHandler(this,t,i)},fireModelGetCellBasicInfo:function(t){var i=e.deepClone(t);e.has(i,"x")&&(i.x=null===i.x?"null":i.x),e.has(i,"y")&&(i.y=null===i.y?"null":i.y),this.fire("model.get.cell.basicInfo",i)},"bus definition.ready:last + boardSettings.ready:last + view.cellSlot.built":function(t,i,n,a){var r,s=n.boardSettings.settings.collapse||{x:[],y:[]};if(-1!==e(s.x).indexOf(a.data.x)||-1!==e(s.y).indexOf(a.data.y))r=this.modelCellPagingExtension.getMaxPageSize();else{var o=0;this.modelCellPagingExtension.isAxisExist(i,"y")&&++o,r=this.modelCellPagingExtension.getPageSize(o,i.zoomLevel)}var l=a.data;l.from=0,l.to=r-1,this.fireModelGetCellBasicInfo(l)},"bus overview.board.ready:last > view.cell.skeleton.built":function(e,t,i){this.fire("view.cell.skeleton.updated",i)},"bus overview.board.ready:last > view.cell.skeleton.element.beforeUpdate":function(e,t,i){i.scrollToTarget&&i.content.css("opacity",.15)
},"bus scrollManager.ready:last > view.cell.skeleton.element.afterUpdate > resize.completed":function(t,i,n){var a=n.content;n.scrollToTarget&&a.size()>0&&e.defer(function(){i.scrollToVisibility(a.last(),{axis:"y",duration:1e3,easing:"easeInSine",offset:{top:20},onAfter:function(){a.animate({opacity:1},"slow","easeOutBounce")}})})},"bus view.skeleton.built + view.dom.ready:last":function(e,t){var i=t.element.find(".tau-timeline-flow").width();this._timelineWidthDeferred.resolve(i)}});return s}),define("tau/components/board.timeline/models/model.timeline.slice.comet",["Underscore","tau/models/board.plus/model.board.slice.comet"],function(e,t){return t.extend({fireCometTick:function(e){this.fire("operation.execute",e.data)}})}),define("tau/ui/extensions/timeline/ui.extension.timeline.operations",["Underscore","tau/core/class","tau/core/extension.base"],function(e,t,i){var n=t.extend({init:function(e,t){this._timelineCellModelRegistry=e,this._timelineAxesModelRegistry=t},getHandler:function(e,t){var i="_"+e+"_"+t;if(!this[i])throw new Error("Comet operation ["+i+"] is not supported");return this[i].bind(this)},_card_notinslice:function(e,t){this._timelineCellModelRegistry.removeCards(e,t)},_card_deleted:function(e,t){this._timelineCellModelRegistry.removeCards(e,t)},_card_updated:function(e,t){this._timelineCellModelRegistry.updateCards(e,t)},_card_cascade:function(e,t){t.suspendAnimation=!0,this._timelineCellModelRegistry.updateCards(e,t)},_card_added:function(e,t){this._timelineCellModelRegistry.addCards(e,t)},_axis_notinslice:function(e,t){this._timelineAxesModelRegistry.removeAxes(e,t)},_axis_deleted:function(e,t){this._timelineAxesModelRegistry.removeAxes(e,t)},_axis_updated:function(e,t){this._timelineAxesModelRegistry.updateAxes(e,t)},_axis_cascade:function(e,t){t.suspendAnimation=!0,this._timelineAxesModelRegistry.updateAxes(e,t)},_axis_added:function(e,t){this._timelineAxesModelRegistry.addAxes(e,t)}});return i.extend({init:function(e,t,i){this._operationsMap=new n(t,i),this._super(e)
},"bus operation.highlightItems > domWrapper.ready":function(e,t,i){i.highlightAxesLines(t)},"bus operation.execute":function(e,t){var i=this.createOperation(t);this.executeOperation(i),this.fire("operation.execute.comet.done")},createOperation:function(t){var i=t.items,n=e.first(i);return{name:(t.name||n.modification).toLowerCase(),location:this._extractLocation(n.location),items:i,options:t.options||{}}},executeOperation:function(t){t=e.defaults(t,{options:{}}),this.fire("operation."+t.name,t),"cascade"===t.name&&(t.options.suspendAnimation=!0),this.handleOperationItems(t.items,t.location,t.name,t.options)},handleOperationItems:function(e,t,i,n){this._operationsMap.getHandler(t,i)(e,n)},_extractLocation:function(e){var t=(e||"card").toLowerCase();return"card"===t?"card":"axis"}})}),define("tau/utils/timeline/utils.timeline.date.position.calculator",["tau/utils/utils.date","libs/date.js/build/date"],function(e,t){return function(i){var n=e.getDiff(i.endDate,i.startDate);if(0>=n)throw new Error("End date should be greater or equal to start date.");var a=i.startDate;return{getRelativeDatePosition:function(t){var a=e.getDiff(t,i.startDate);return a/n},getCorrespondingDate:function(e){return new t(a+n*e)}}}}),define("tau/components/board.timeline/models/model.timeline.date-range",["Underscore","tau/core/class","tau/utils/timeline/utils.timeline.date.position.calculator","tau/utils/utils.date","tau/utils/timeline/utils.timeline.date-range"],function(e,t,i,n,a){var r=t.extend({init:function(){this._dateRange=null},setDateRange:function(e){this._dateRange=e,this.positionCalculator=i(e)},getDateRange:function(){return this._dateRange},toRelativeOffset:function(t){var i=e.isString(t)?n._convertToServerTime(n.parse(t)):t;return this.positionCalculator.getRelativeDatePosition(i)},getRelativeNowOffset:function(){return this.positionCalculator.getRelativeDatePosition(n.getServerNow())},getCorrespondingDateRange:function(e){return new a(null===e.from?null:this.positionCalculator.getCorrespondingDate(e.from),null===e.to?null:this.positionCalculator.getCorrespondingDate(e.to))
},createDateRange:function(e){return new a(e.from,e.to)},serializeDate:function(e){return n.format.datetime.short(n.convertToTimezone(e))},isInRange:function(e,t){return this._dateRange.intersects(new a(e,t))}});return r}),define("tau/slice/timeline.factory",["Underscore","tau/core/class","tau/slice/slice.space.cached","tau/slice/url.resolver"],function(e,t,i,n){return t.extend({init:function(e){this.defaults=e||{}},create:function(t){e.defaults(t,this.defaults);var a=i.extend({isUndefinedAxis:function(e){return"x"===e?!1:this._super(e)}});return new a(t,new n({prefix:"timeline"}))}})}),define("tau/utils/timeline/utils.timeline.local-period-calculator",["tau/core/class","tau/utils/timeline/utils.timeline.date-range","libs/date.js/build/date","tau/utils/utils.date"],function(e,t,i,n){return e.extend({DEFAULT_LOCAL_DATE_RANGE_IN_PERCENT:.3,MIN_LOCAL_DATE_RANGE_IN_PERCENT:.1,MAX_LOCAL_DATE_RANGE_IN_PERCENT:.9,_setLocalDateRangeCloseToDate:function(e,n,a){var r=e.getDurationInTicks(),e=new t(new i(a-r/2),new i(a+r/2));return e.startDate.getTime()<n.startDate.getTime()?e=new t(n.startDate.clone(),new i(n.startDate+r)):e.endDate.getTime()>n.endDate.getTime()&&(e=new t(new i(n.endDate-r),n.endDate.clone())),e},scaleLocalDateRangeProportionally:function(e,n,a){var r,s=t.tryParseWithRoundedDays(n),o=t.tryParse(e),l=o.getDurationInTicks();s.isValid?r=l/s.getDurationInTicks():(r=l/a.getDurationInTicks(),r<this.MIN_LOCAL_DATE_RANGE_IN_PERCENT?r=this.MIN_LOCAL_DATE_RANGE_IN_PERCENT:r>this.MAX_LOCAL_DATE_RANGE_IN_PERCENT&&(r=this.MAX_LOCAL_DATE_RANGE_IN_PERCENT));var u=new i(o.startDate+l/2);return this._setLocalDateRangeCloseToDate(a.scale(r),a,u)},setLocalDateRangeCloseToNow:function(e){var t=n.getServerNow();return this._setLocalDateRangeCloseToDate(e.scale(this.DEFAULT_LOCAL_DATE_RANGE_IN_PERCENT),e,t)}})}),define("tau/components/board.core/models/model.board.plus.timeline",["require","Underscore","jQuery","tau/components/board.core/models/model.board.plus.grid","tau/utils/timeline/utils.timeline.date-range","tau/slice/timeline.factory","tau/utils/timeline/utils.timeline.local-period-calculator"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/components/board.core/models/model.board.plus.grid"),a=e("tau/utils/timeline/utils.timeline.date-range"),r=e("tau/slice/timeline.factory"),s=e("tau/utils/timeline/utils.timeline.local-period-calculator"),o=n.extend({init:function(e){this.timelineRangeModel=e,this.onTimelineLocalDateRangeChanged=t.Callbacks(),this.onTimelineGlobalDateRangeChanged=t.Callbacks(),this.localRangeCalculator=new s,this._super(e)
},setDateRange:function(e){this.timelineRangeModel.setDateRange(e)},startLifeCycle:function(e,t){this._queryDeferred=i.Deferred(),this._super(e,t)},getViewMode:function(){return"timeline"},getSliceFactory:function(){var e=this.getConfigurator().getSliceFactoryOptions();return new r(e)},createDefinition:function(){var e=this._super(),t=this._boardConfig.timelineGlobalDateRange;return e.timelineGlobalDateRange=t,e.user.globalDateRange=a.tryParseWithRoundedDays(t).toJSON(),e.user.plannedInPast=this._boardConfig.timelineSettings.showPlannedInPast,e.user.showForecast=this._boardConfig.timelineSettings.showForecast,e},updateBoardSettings:function(e){this._super(e),e.bind({fields:["timelineLocalDateRange"],listener:this,callback:this._onTimelineLocalDateRangeChanged.bind(this)}),e.bind({fields:["timelineGlobalDateRange"],listener:this,callback:this._onTimelineGlobalDateRangeChanged.bind(this)})},_boardConfigReady:function(e,t){this._super(e,t),this._onTimelineGlobalDateRangeChanged(t),this._onTimelineLocalDateRangeChanged(t)},_getDefaultTimelineLocaDateRange:function(e){return this.localRangeCalculator.setLocalDateRangeCloseToNow(e)},_onTimelineLocalDateRangeChanged:function(e){var t=a.tryParse(e.timelineLocalDateRange);if(!t.isValid){var i=a.tryParseWithRoundedDays(e.timelineGlobalDateRange);if(!i.isValid)return;t=this._getDefaultTimelineLocaDateRange(i),e.timelineLocalDateRange=t.toFullISOString(),this.setTimelineLocalDateRange(t)}this.timelineRangeModel.setDateRange(t),this.onTimelineLocalDateRangeChanged.fire(t)},_onTimelineGlobalDateRangeChanged:function(e){var t=a.tryParseWithRoundedDays(e.timelineGlobalDateRange);this.onTimelineGlobalDateRangeChanged.fire(t)},setQuery:function(e){this._queryDeferred.resolve(e)},queryCells:function(e){return this._getSliceDeferred.then(function(t){return t().cell(e)})},queryDensity:function(e){var n={$set:{BucketsCount:e}};return i.when(this._getSliceDeferred,this._queryDeferred).then(function(e,i){return e().density(t.extend(n,i))}.bind(this))
},movePlannedDates:function(e){var n={itemId:e.id,position:{plannedStartDate:e.plannedStartDate?e.plannedStartDate:null,plannedEndDate:e.plannedEndDate?e.plannedEndDate:null}},a={$set:{items:[n]}};return i.when(this._getSliceDeferred).then(function(i){return i().movePlannedDatesBatch(a).fail(e.onError.bind(e)).done(function(i){var n=t.find(i.data.items[0].items,function(t){return t.dataItem.id==e.id});t.extend(e,n.dataItem),e.onSuccess()})})},setTimelineLocalDateRange:function(e){this.getBoardSettings().set({set:{timelineLocalDateRange:e.toFullISOString()}})},queryForecasts:function(){return i.when(this._getSliceDeferred,this._queryDeferred).then(function(e,t){return e().forecasts(t)}).then(function(e){return e.data})},requestMarks:function(e,i,n){var a=t.clone(i);return i.focus.x=[],this._super(e,a,n)},_forceUpdateSliceOnZoomLevelChanged:function(){}});return o}),define("tau/components/board.timeline/models/timeline.model.board.cell.freezable",["Underscore","jQuery","tau/models/board.plus/model.board.cell.freezable"],function(e,t,i){return i.extend({init:function(e,t,i){this.timelineCellModelRegistry=t,this.timelineAxesModelRegistry=i,this._super(e),this.on("refresh",function(){this.timelineCellModelRegistry.clear(),this.timelineAxesModelRegistry.clear()}.bind(this)),this.on("definition.ready",function(e){this.timelineCellModelRegistry.setDefinition(e.data)}.bind(this))},_isCell:function(e){var t=e.coords;return t.x&&t.y},fireModelGetCellBasicInfo:function(t){var i=e.deepClone(t);e.has(i,"x")&&(i.x=null===i.x?"null":i.x),e.has(i,"y")&&(i.y=null===i.y?"null":i.y),this.fire("model.get.cell.basicInfo",i)},_initializeCells:function(e){if(this._isCell(e)){var t=this.timelineAxesModelRegistry.get({y:e.coords.y}),i=this.timelineCellModelRegistry.registerCell(e.coords,e.dataItem,t);i.onDoPaging&&i.onDoPaging.add(function(e){this.fire("paging.cell.show.more",{}),this.fireModelGetCellBasicInfo(e)}.bind(this))}else this.timelineAxesModelRegistry.registerAxis(e.coords,e.dataItem)
},_updateCellsPaging:function(t){if(this._isCell(t)){var i=this.timelineCellModelRegistry.get(t.coords),n=e(t.coords).pick("from","to");n.dataItem=t.dataItem,i.triggerPaging(n)}},fireCellBasicInfoRetrieved:function(e){0===e.coords.from?this._initializeCells(e):this._updateCellsPaging(e),this._super(e)},"bus slice.ready":function(e,t){t.lazy.on("after.cardsDetails",function(e){this.timelineCellModelRegistry.forEach(function(t){t.augmentCards(e.data.result.items)})}.bind(this))},queryCells:function(e,t){var i=e.config.definition;i.user.globalDateRange?this._super(e,t):this.skipQueryCells()}})}),define("tau/components/board.timeline/models/card/model.timeline.card",["Underscore","tau/core/class","tau/components/board.timeline/models/card/model.board.card"],function(e,t,i){var n=i.extend({type:"base",init:function(t,i){if(e.isUndefined(i))throw new Error("dateRangeModel should be defined");this._isDirty=!1,this.onPlannedDatesUpdating=e.Callbacks(),this.onPlannedDatesUpdated=e.Callbacks(),this._dateRangeModel=i,this.id=t.id,this.update(t)},update:function(e){this._isDirty||this._updateCore(e)},_updateCore:function(t){if(t.showActual&&!t.hasActual)throw new Error("Actual inconsistency");if(t.showPlanned&&!t.hasPlanned)throw new Error("Planned inconsistency");if(t.fixedDatePlan&&t.showPlanned)throw new Error("Planned and Fixed inconsistency");e.extend(this,this._extractProperties(t)),this._cardData=t,this._validState=e.clone(t)},isUnfinished:function(){return this._cardData.hasActual&&this._cardData.inProgress},_extractProperties:function(){return{}},plannedRange:function(){throw new Error("plannedRange should be implemented in derived classes")},plannedDateRange:function(){return this._dateRangeModel.createDateRange(this.plannedRange())},applyEdit:function(){this._isDirty=!0,this.onPlannedDatesUpdating.fire(this)},commitEdit:function(){this._isDirty=!1,this.onPlannedDatesUpdated.fire(this)},rollbackEdit:function(){this.update(this._validState),this.onPlannedDatesUpdating.fire(this)
}});return n}),define("tau/components/board.timeline/models/card/model.timeline.durable-card",["Underscore","tau/core/class","tau/utils/timeline/utils.timeline.date","tau/components/board.timeline/models/card/model.timeline.card"],function(e,t,i,n){var a=n.extend({type:"durable",_extractProperties:function(e){return{showPlanned:e.showPlanned,showActual:e.showActual,showFixed:e.showFixed,showForecast:e.showForecast,hasActual:e.hasActual,hasPlanned:e.hasPlanned,isStartDateInfinite:i.isInfinite(e.plannedStartDate),isEndDateInfinite:i.isInfinite(e.plannedEndDate)}},plannedRange:function(){var e=this.cardData();return{from:this.isStartDateInfinite?null:e.plannedStartDate,to:this.isEndDateInfinite?null:e.plannedEndDate}},applyEdit:function(e){this._cardData.plannedStartDate=e.startDate,this._cardData.plannedEndDate=e.endDate,this._super(e)}});return a}),define("tau/components/board.timeline/models/card/model.timeline.fixed-card",["Underscore","tau/core/class","tau/components/board.timeline/models/card/model.timeline.card"],function(e,t,i){var n=i.extend({type:"fixed",_extractProperties:function(e){return{showFixed:e.showFixed,fixedDatePlan:e.fixedDatePlan}},applyEdit:function(e){this._cardData.fixedDate=e.startDate,this._super(e)},plannedRange:function(){var e=this.cardData();return{from:e.fixedDate,to:null}}});return n}),define("tau/components/board.timeline/models/cell/model.cell.timeline",["Underscore","jQuery","tau/components/board.timeline/models/cell/model.cell.base","tau/utils/utils.date","tau/utils/timeline/utils.timeline.date-range","tau/components/board.timeline/models/card/model.timeline.durable-card","tau/components/board.timeline/models/card/model.timeline.fixed-card"],function(e,t,i,n,a,r,s){var o=i.extend({init:function(t,i,n,a){if(!t)throw new Error("definition is not defined");if(!i)throw new Error("dataItem is not defined");if(!n)throw new Error("timelineRangeModel is not defined");this.onYAxisUpdated=e.Callbacks(),this._yAxisModel=a||u,this._yAxisModel.onAxisUpdated.add(this._fireYAxisDataUpdated,this),this.isTimeline=!0,this.timelineRangeModel=n,this.onMovePlannedDates=e.Callbacks(),this._super(t,i)
},_createCardModel:function(e){var t=e.fixedDatePlan?new s(e,this.timelineRangeModel):new r(e,this.timelineRangeModel);return t.onPlannedDatesUpdated.add(this.movePlannedDates,this),t},_fireYAxisDataUpdated:function(e){this.onYAxisUpdated.fire(this.processRawCardItem(e.card.data))},getYAxisDataRange:function(){return this.processRawCardItem(this._yAxisModel.getAxisCellItem(this.dataItem.y))},_processFixedSection:function(e){e.fixedDate=l(e.plannedStartDate),this.timelineRangeModel.isInRange(e.fixedDate,e.fixedDate)&&(e.showFixed=!0)},_processActualSection:function(e){e.inProgress=e.inProgress||!e.actualEndDate,e.actualEndDate=l(e.actualEndDate,n.getServerNow(),e.inProgress),e.actualStartDate=l(e.actualStartDate,e.actualEndDate);var t=e.actualStartDateBoundToPlannedStartDate?e.actualStartDate<e.actualEndDate:!0;this.timelineRangeModel.isInRange(e.actualStartDate,e.actualEndDate)&&t&&(e.showActual=!0)},_processPlannedSection:function(e){e.plannedEndDate=l(e.plannedEndDate),e.plannedStartDate=l(e.plannedStartDate),this.timelineRangeModel.isInRange(e.plannedStartDate,e.plannedEndDate)&&(e.showPlanned=!0)},_processForecastSection:function(e){e.forecastStartDate=n.getServerNow(),e.forecastEndDate=l(e.forecastEndDate,n.getServerNow());var t=e.hasActual&&e.hasPlanned&&e.plannedEndDate<e.forecastStartDate;(t||this.timelineRangeModel.isInRange(e.forecastStartDate,e.forecastEndDate))&&(e.showForecast=!0)},processRawCardItem:function(t){return e.extend(t,{showActual:!1,showPlanned:!1,showForecast:!1,showFixed:!1}),t.fixedDatePlan&&t.plannedStartDate&&this._processFixedSection(t),t.hasActual&&(t.actualStartDate||t.actualEndDate)&&this._processActualSection(t),t.hasPlanned&&t.plannedStartDate&&t.plannedEndDate&&this._processPlannedSection(t),t.forecastEndDate&&this._processForecastSection(t),t.isVisible=t.showFixed||t.showActual||t.showPlanned||t.showForecast,t},extendUnfinishedCardsToNow:function(t){return e.chain(this.getVisibleCardModels()).filter(function(e){return e.isUnfinished()
}).each(this._reprocessCardModel,this).tap(function(e){!t&&e.length&&this.onCardsUpdated.fire(e,{suspendAnimation:!0,metricsOnly:!0})}.bind(this)).value()},updateCardsPositions:function(){var t=this.getVisibleCardModels();e.each(this.getCardModels().range(),this._reprocessCardModel,this);var i=this.getVisibleCardModels(),n=e.difference(i,t),a=e.difference(t,i);this.extendUnfinishedCardsToNow(!0),this.onCardsCleared.fire(e.pluck(a,"id")),this.onCardsAdded.fire(n,{suspendAnimation:!0}),this.onCardsUpdated.fire(i,{suspendAnimation:!0,metricsOnly:!0}),this.onYAxisUpdated.fire(this.getYAxisDataRange())},addCard:function(e,t){e=this.processRawCardItem(e);var i=this._createCardModel(e);this._checkIfCardCanBeAdded(i)&&(this._cardModels.insert(i),e.isVisible&&(this.onCardsAdded.fire([i],t),this.extendUnfinishedCardsToNow(!1)))},_reprocessCardModel:function(e){var t=this.processRawCardItem(e.cardData());e.update(t)},getVisibleCardModels:function(){return e.filter(this._cardModels.range(),function(e){return e._cardData.isVisible})},updateCard:function(e,t){e=this.processRawCardItem(e);var i=this._cardModels.get(e.id);i?i.update(e):this._cardModels.insert(this._createCardModel(e)),e.isVisible?(this.onCardsUpdated.fire([this._cardModels.get(e.id)],t),this.extendUnfinishedCardsToNow(!1)):this.onCardsCleared.fire([e.id])},updateForecasts:function(t){var i=e.chain(t).map(function(t){var i=this._cardModels.get(t.id);if(i){var n=e.extend({},i.cardData(),t.data);return i.update(this.processRawCardItem(n)),i}},this).compact().value();this.onCardsUpdated.fire(i,{suspendAnimation:!0,metricsOnly:!0})},movePlannedDates:function(t){var i=this,n={id:t.id,onError:function(){t.rollbackEdit()},onSuccess:function(){var n=e.pick(this,"plannedStartDate","plannedEndDate");i.updateCard(e.extend({},t.cardData(),n),{suspendAnimation:!0})}},a=t.plannedRange();null!==a.from&&(n.plannedStartDate=this.timelineRangeModel.serializeDate(a.from)),null!==a.to&&(n.plannedEndDate=this.timelineRangeModel.serializeDate(a.to)),this.onMovePlannedDates.fire(n)
},_checkIfCardCanBeAdded:function(e){var t=e.cardData();return(this.timelineRangeModel.isInRange(t.actualStartDate,t.actualEndDate)||this.timelineRangeModel.isInRange(t.plannedStartDate,t.plannedEndDate))&&this._super(e)},getMoveParameters:function(e){return e.forEach(function(e){if(this._cardBeingEdited){var t=this._cardBeingEdited.cardData();e.position={plannedStartDate:this.timelineRangeModel.serializeDate(t.plannedStartDate),plannedEndDate:this.timelineRangeModel.serializeDate(t.plannedEndDate)}}}.bind(this)),e},moveCardIn:function(t){var i=this.timelineRangeModel.getCorrespondingDateRange({from:0,to:.3}),n={isVisible:!0,plannedStartDate:i.startDate,plannedEndDate:i.endDate,showPlanned:!0};return this._cardBeingEdited=this._createCardModel(e.extend(n,t)),this._cardBeingEdited},moveCardOut:function(){this._cardBeingEdited=null}}),l=function(t,i,a){return t=a?i:t||i,e.isString(t)?n._convertToServerTime(n.parse(t)):t},u={onAxisUpdated:e.Callbacks(),getAxisCellItem:function(){return{}}};return o}),define("tau/components/board.timeline/models/cell/model.cell.board",["Underscore","jQuery","tau/components/board.timeline/models/cell/model.cell.base"],function(e,t,i){var n={type:function(e){return function(t){return t.type===e}}},a=i.extend({init:function(t,i){this._super(t,i),this.isTimeline=!1,this.onDoPaging=e.Callbacks(),this.onDonePaging=e.Callbacks(),this.processPaging(this.dataItem.fixed.items)},processPaging:function(t){var i=e.find(t,n.type("cellpaging"));i?(this.hasPaging=!0,this.nextOrderingValue=i.data.nextOrderingValue):(this.hasPaging=!1,this.nextOrderingValue=e.MAX_INT)},doPaging:function(){var e=this.getCardModels().actualCount();this.onDoPaging.fire({x:this.dataItem.x,y:this.dataItem.y,from:e,to:e+this.pageSize-1})},triggerPaging:function(t){var i=this._convertCardItemsToModels(t.dataItem.dynamic.items),n=e.pluck(i,"id"),a=e.filter(n,this._cardModels.has.bind(this._cardModels));e.each(a,this.clearCard,this),e.each(i,this._cardModels.insert.bind(this._cardModels)),this.processPaging(t.dataItem.fixed.items);
var r=e.pick(t,"from","to");this.onDonePaging.fire(r)},_isInCellPaging:function(e){if(!this.hasPaging)return!1;var t=this._getOrdering();return t.isImplemented&&t.predicate(e.orderingValue)>=this.nextOrderingValue},updateCard:function(e,t){e=this.processRawCardItem(e);var i=this._cardModels.get(e.id);(i||!this._isInCellPaging(e))&&(i?(i.update(e),t.index=this._cardModels.sort(i)):t.index=this._cardModels.insert(this._createCardModel(e)),this.onCardsUpdated.fire([this._cardModels.get(e.id)],t))},addCard:function(e,t){e=this.processRawCardItem(e);var i=this._isInCellPaging(e);if(!i||t.forceAppend){var n=this._createCardModel(e);i?(n.isPromise=!0,this._cardModels.insert(n),this.onCardsAdded.fire([n],t)):this._checkIfCardCanBeAdded(n)&&(t.index=this._cardModels.insert(n),this.onCardsAdded.fire([n],t))}},moveCardIn:function(e){return this._createCardModel(e)},getMoveParameters:e.identity});return a}),define("tau/components/board.timeline/models/model.timeline.cells.registry",["Underscore","jQuery","tau/core/class","tau/components/board.timeline/models/collection.coords.based","tau/components/board.timeline/models/cell/model.cell.timeline","tau/components/board.timeline/models/cell/model.cell.board"],function(e,t,i,n,a,r){return i.extend({init:function(e){this._collection=new n,this.timelineRangeModel=e},setDefinition:function(e){this.definition=e},clear:function(){this._collection.clear()},forEach:function(e){this._collection.forEach(e)},get:function(e){return this._collection.get(e)},registerCell:function(t,i,n){var s=e.find(i.fixed.items,e.matches({type:"timeline"})),o=s?new a(this.definition,i,this.timelineRangeModel,n):new r(this.definition,i);return this._collection.insert(t,o),o},addCards:function(t,i){e.each(t,function(e){var t=this._collection.get(e);t&&t.addCard(e.data,i)},this)},updateCards:function(t,i){e.each(t,function(e){var t=this._collection.get(e);t&&t.updateCard(e.data,i)},this);var n=e.uniq(e.map(t,function(e){return e.data.id}));this._collection.forEach(function(i,a){var r=e.any(t,function(t){var i=this._collection._extractCoords(t);
return e.isEqual(i,a)},this);r||e.each(n,function(e){i.clearCard(e)})},this)},removeCards:function(t,i){this._collection.forEach(function(n){e.each(t,function(e){n.removeCard(e.data.id,i)})})}})}),define("tau/components/board.timeline/models/cell/model.cell.timeline.axes",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(t){this.dataItem=t,this.onAxisRemoved=e.Callbacks(),this.onAxisUpdated=e.Callbacks()},_findItemById:function(t,i){return e.find(t,function(e){return e.id===i})},_removeAxisCellItemById:function(t){var i=this.getAxisCellItems(),n=this._findItemById(i,t);if(n){var a=e.indexOf(i,n);i.splice(a,1)}return n},getAxisCellItem:function(t){return e.find(this.getAxisCellItems(),function(e){return e.id==t})},getAxisCellItems:function(){return this.dataItem.dynamic.items},removeAxis:function(e){var t=this._removeAxisCellItemById(e);t&&this.onAxisRemoved.fire(t)},updateAxis:function(t){var i=this.getAxisCellItems(),n=this._findItemById(i,t.data.id);n?e.extend(n,{plannedStartDate:null,plannedEndDate:null},t.data):i.push(t.data),this.onAxisUpdated.fire({card:t,diff:[]})}})}),define("tau/components/board.timeline/models/model.timeline.axes.registry",["Underscore","jQuery","tau/core/class","tau/components/board.timeline/models/collection.coords.based","tau/components/board.timeline/models/cell/model.cell.timeline.axes"],function(e,t,i,n,a){return i.extend({init:function(){this._collection=new n,this.onAxisCellsAdded=e.Callbacks()},clear:function(){this._collection.clear()},get:function(e){return this._collection.get(e)},registerAxis:function(e,t){var i=new a(t);this._collection.insert(e,i),i.onAxisRemoved.add(this._collection.remove.bind(this._collection,e))},addAxis:function(t){var i=e.pick(t,"x","y"),n=e.extend({fixed:{items:[]},dynamic:{items:[t.data]}},i);this.registerAxis(i,n)},addAxes:function(t,i){e.each(t,this.addAxis,this),this.onAxisCellsAdded.fire(t,i)},updateAxes:function(t){var i=[];e.each(t,function(e){var t=this._collection.get(e);
t?t.updateAxis(e):i.push(e)},this),i.length&&this.addAxes(i)},removeAxes:function(t){this._collection.forEach(function(i){e.each(t,function(e){i.removeAxis(e.data.id)})})}})}),define("tau/ui/extensions/board.plus/layout/size.calculator-timeline",["Underscore","jQuery"],function(e,t){return{initializeHeaderCells:function(e){var i=e.model,n=e.$element,a=[],r=function(e){var n="x"===e?"cols":"rows",r="x"===e?"width":"height";return function(){var s=t(this);if(!s.parent().attr("data-is-hidden")){var o=s.data(),l=o[e],u={$el:s,data:o,syncItem:i[n][l],syncSize:r};a.push(u)}}},s=n.find(".i-role-header");return s.filter("[data-dimension=x]").find(".i-role-cell").each(r("x")),s.filter("[data-dimension=y]").find(".i-role-cell").each(r("y")),a},calculateHeight:function(i){var n=t();e.each(i.row.items,function(e){n=n.add(e.$el)}),n.css({height:"","min-height":""});var a=e.pluck(n,"clientHeight").concat(i.row.minHeight);return e.max(a)},applyHeight:function(t,i){var n=i.headerCell;n&&n.lastHeight!==t&&(n.lastHeight=t,n.$el.css({height:t,"min-height":t})),e.each(i.row.items,function(e){e.$el.css({height:t})})},getCardsInRow:function(e,t){return e.isCollapsed?e.cardsInRow:6==t?1:e.cardsInRow},calculateWidth:function(e){var t=e.col,i=this.getCardsInRow(t,e.zoomLevel),n=e.getCardWidth(t);return i*n+t.extraWidth},_isBacklogHeader:function(e){var t=e.data();return t.isbacklog},applyWidth:function(e,t){var i=t.headerCell;if(i.lastWidth!==e&&this._isBacklogHeader(i.$el)){var n=".i-role-timeline-column",a=i.$el.closest(".i-role-board-body"),r=a.find(n).eq(0);i.lastWidth=e;var s=parseInt(i.$el.css("padding-left"),10),o=2*s+e;i.$el.css({width:o});var l=parseInt(r.css("left"),10);r.css({width:o}).next(n).css({left:l+o})}}}}),define("tau/ui/extensions/board.plus/layout/ui.timeline.layout",["Underscore","jQuery","tau/ui/extensions/board.plus/layout/ui.board.plus.layout","tau/ui/extensions/board.plus/layout/size.calculator-timeline"],function(e,t,i,n){return i.extend({init:function(){this._super(n),this.scrollKeeperClass="i-role-scroll-keeper",this.scrollKeeperSelector="."+this.scrollKeeperClass
},getFixedColumnSize:function(e){var t=this._super(e),i=this.isColumnCollapsed(e);if(!t&&!i){var n=this.getBacklogColumnId();if(n&&e==n)return 2}return t},iteratorUpdateCell:function(e){e.data.x===this.getBacklogColumnId()&&this._super(e)},beforeRowsHeightRecalculation:function(){var e=this.$el.find(".tau-timeline-flow");this.$el.find(this.scrollKeeperSelector).remove(),t("<div></div>").addClass(this.scrollKeeperClass).css({height:e[0].scrollHeight,position:"absolute",width:"1px"}).prependTo(e)},afterRowsHeightRecalculation:function(){this.lastRowHeightCalculation(),this.$el.find(this.scrollKeeperSelector).remove()},lastRowHeightCalculation:function(){var e=this.$el.find(".tau-timeline-canvas"),t=this.$el.find(".tau-timeline-flow"),i=t.last().offset(),n=this.$el.find(".footer-pillow"),a=n.last().offset(),r=e.outerHeight(),s=this.$el.find(".i-role-cell").last(),o=s.find(".i-role-cell-planner");if(a.top-i.top<r){var l=r-(a.top-i.top);o.height(l+s.outerHeight()),n.height(l)}else o.css("height",""),n.height(0)},calculateColumnWidth:function(e){var t=this.sizeCalculator.calculateWidth({col:e,getCardWidth:this._getCardWidthByColumn.bind(this),zoomLevel:this.getCurrentZoomLevel()});return t+this.scrollWidth},getBacklogColumnId:e.memoize(function(){var t=e.find(this.headerCells,function(e){return e.data.isbacklog});return t.data.x})})}),define("tau/ui/extensions/timeline/ui.extension.timeline.layout",["Underscore","tau/ui/extensions/board.plus/ui.extension.board.plus.layout","tau/ui/extensions/board.plus/layout/ui.timeline.layout"],function(e,t,i){return t.extend({createBoardLayout:function(){return new i},getResizeDecoratorSettings:function(t,i,n){var a=this._super(t,i,n),r={increaserEnabled:function(e){var t=!1;if(i.getBacklogColumnId()===e){var n=i.resolveColumnSize(e);t=5>n}return t},getLRVisibilityOptions:function(e){var t=!0,n=!0,a=i.getBacklogColumnId(),r=e.data("x"),s=i.isColumnCollapsed(a);return r===a?n=s:t=s,{hideL:t,hideR:n}}};return e.extend({},a,r)},"bus view.timeline.tracks.count.changed":function(){this._triggerResizeDelayed({})
}})}),define("tau/models/timeline/model.timeline.dragndrop",["Underscore","tau/models/board.plus/model.board.dragndrop","tau/utils/utils.date"],function(e,t){var i=t.extend({init:function(e,t){this._super(e),this._timelineCellModelRegistry=t},_onBoardSettingsReady:function(e){this._super(e);var t=this.fire.bind(this,"ordering.refresh");e.get(["cells"]).then(t),e.bind({fields:["cells"],listener:this,callback:t})},"bus conditions.ready:last + dndOptions.ready:last + slice.ready:last + shift.isPressed + view.card.batch.move":function(e,t,i,n,a,r){this._super(e,t,i,n,a,r)},_afterCardBatchMove:function(t,i){i.forEach(function(i){var n=e.find(t,function(e){return i.entityId===e.source.entityId});n?(i.track=n.target.track,i.sourceX=n.source.x,i.sourceY=n.source.y):(i.sourceX=i.targetX,i.sourceY=i.targetY)}),this._super(t,i)},_prepareParameters:function(e,t,i){var n=this._super(e,t,i),a=this._timelineCellModelRegistry.get(e[0].target);return n.$set.items=a.getMoveParameters(n.$set.items),n}});return i}),define("tau/ui/extensions/timeline/ui.extension.timeline.dragndrop",["Underscore","jQuery","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.base"],function(e,t,i){var n=function(){return!t(this).parent().is(".i-role-timeline-card-holder")},a=function(e){for(var t=e.currentGroup.find(".i-role-timeline-track"),i=0,n=t.length;n>i;i++){var a=t.eq(i);if(e._within(a,e.cursorPosition))return i}return void 0},r=function(e){return function(t){return e.$card=t,e}},s=function(e){return t(e).tauSortable("instance")},o=i.extend({init:function(e,t){this._timelineViewRegistry=t,this._super(e)},_$containment:function(e){return e},_$sortable:function(e){return e.find(".tau-backlog-body .i-role-cellholder")},_getPlaceholderContentCreator:function(){return function(e,t){return this._timelineViewRegistry._getCellViewByCoords(t.data()).createPlaceholderContent(e)}.bind(this)},unpackMovementResponse:function(t,i){var a=this._super.apply(this,arguments),r=i.getCards();return e.each(a.success,function(e){e.$card=e.$card.add(r.filter('[data-id="'+e.entityId+'"]'))
}),e.each(t,function(e){e.$card=e.$card.filter(n),e.moves.forEach(function(t){t.track=e.track})}),a},completeEventsProtocol:function(){this._super(this._$successCardsArray)},_expandEmptyCollapsedCells:function(e,t){return t.$affectedCells=this._$affectedCells,this._super(e,t)},_restoreErrorCardPosition:function(e){this._timelineViewRegistry.clearCardArtifacts(e.$card,e.target)},restoreErrorCardsPositions:function(t){return this._super(t).then(e.each(t,this._restoreErrorCardPosition,this))},_processSuccessCardsPositions:function(i){var n=e.toArray(arguments).slice(1);this._$affectedCells=t();var a=e.filter(n,function(t){var i={x:t.sourceX,y:t.sourceY},n={x:t.targetX,y:t.targetY};return!e.isEqual(i,n)});return a.forEach(function(e){e.$card.each(function(e,n){t(n).detach(),this._timelineViewRegistry.clearCardArtifacts(t(n),i)}.bind(this)),e.moves.forEach(function(e){this._$affectedCells=this._$affectedCells.add(this._timelineViewRegistry._getCellViewByCoords(e)._$cell)}.bind(this))}.bind(this)),this._$successCardsArray=e.pluck(n,"$card"),a},processCardsPositions:function(i,n,a,s,o){var l=i.success,u=e.map(l,function(e){return t.when(e.$card.length?e.$card:a.renderCardAsHtml(e.moves[0].dataItem)).then(r(e))});return t.when.apply(t,u).then(this._processSuccessCardsPositions.bind(this,n)).then(function(e){var t=this._getAnimationOptions(s,l);"Rank"!=this._ordering&&(i.success=e),this.fire("timeline.card.batch.move.after",{items:i.success,options:t}),i.success=[]}.bind(this)).then(function(){return this._super(i,n,a,s,o)}.bind(this))},_get$selectable:function(e){return e.find(".i-role-selectable")},_$getSelectableByCard:function(e){return e.parents(".i-role-selectable")},"bus ordering.refresh":function(e,t){this._ordering=t.cells.ordering?t.cells.ordering.name:null},"bus sort.started:last + sort.groupchanged":function(t,i,n){var r=n[1],o=s(i[1].sender),l=a(o);e.isUndefined(l)?r.item.removeData("track"):r.item.data("track",l);var u={track:l,at:o.cursorPosition};this._timelineViewRegistry.moveCard(r.item,r.groupFrom.data(),r.groupTo.data(),u),this.fire("view.card.group.changed")
},"bus sort.changed":function(e,i){var n=i[1],a=s(i[1].sender),r=t(n.item),o={index:n.index,track:t(n.item).data("track"),at:a.cursorPosition};a.currentGroup.find(".i-role-timeline-planner-card-holder:empty").append(r),this._timelineViewRegistry.moveCardToCell(r,a.currentGroup.data(),o)},"bus sort.stopped":function(e,i){var a=i[1];t(a.item).off("drag"),a.isReverted&&a.items.each(function(e,i){var n=t(i),r=n.data("boardDnd")||{};r.target=s(a.sender).currentGroup.data(),n.data("boardDnd",r)});var r=a.items.last().data("track");a.items.filter(n).each(function(e,i){t(i).data("boardDnd").target.track=r}.bind(this)),this._timelineViewRegistry.unlockAllTrackCards(),this._super(e,i)},"bus sort.started":function(e,i){var n=i[1],a=n.helper.parent().find(".tau-timeline-canvas");n.items.filter(function(){return t(this).draggable("instance")}).each(function(){var e=t(this).draggable("instance");e.scrollParent=a,e.overflowOffset=a.offset()})}});return o}),define("tau/ui/extensions/timeline/ui.extension.timeline.selection.board",["jQuery","tau/ui/extensions/board.plus/ui.extension.board.plus.selection.board"],function(e,t){var i=function(e){return e.find(".tau-timeline-canvas")[0]};return t.extend({createSelectableContainers:function(e){var t=function(){return i(e).scrollHeight},n=function(){return i(e).scrollTop},a=function(t){i(e).scrollTop+=t},r=[{element:e.find(".tau-backlog-body")[0],getScrollHeight:t,applyVerticalScrollOffset:a,getVerticalScrollPosition:n,clipVertical:!1,rectSelectTriggers:".footer-pillow"},{element:e.find(".tau-timeline-canvas")[0],rectSelectTriggers:".tau-timeline-flow, .i-role-timeline-track, .i-role-timeline-card-holder, .footer-pillow"}];return r},"bus $selectable.ready:last + card.unselect":function(e,t,i){t.tauSelectable("reset",i)},"bus $selectable.ready:last+$selectionScope.ready:last+cardsData.ready:last":function(t,i,n,a){n.find(".i-role-selectable").each(function(t,i){this._applySelection(e(i),n,a.cards,a.isInitial)}.bind(this))}})}),define("tau/ui/extensions/timeline/ui.timeline.scrollManager",["jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.scrollManager"],function(e,t,i){var n=i.extend({getScrollableElement:function(){return this.$element.find(".tau-timeline-canvas")
},getScrollableChild:function(e){return e.children().first()}});return n}),define("tau/ui/extensions/timeline/ui.extension.timeline.sync-scroll",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n=function(e,t){t()};return i.extend({"bus $el.ready+$grid.ready":function(t,i,n){var a=this,r=i.find(".tau-rows-header > ul, .tau-backlog-body ul"),s=n.find(".tau-timeline-canvas"),o=e.bind(a.syncScroll,a,s,r),l=function(){o(),n.trigger("sync-scroll")};s.on({scroll:l});var u=60;r.on({mousewheel:function(e,t){var i=-s.scrollTop()+Math.round(t*u);s.scrollTop(-i),l()}}),a.fire("syncScroll.ready",o)},"bus syncScroll.ready:last + view.dom.ready":n,"bus syncScroll.ready:last + view.axis.collapser.executed.after":n,"bus syncScroll.ready:last + resize.completed":n,syncScroll:function(e,t){var i={x:e.scrollLeft(),y:e.scrollTop()};t.length&&t.css("margin-top",-i.y)}})}),define("tau/components/board.timeline/views/board.timeline.view.now-marker",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(e){if(!e)throw new Error("timelineRangeModel is not defined");this._timelineRangeModel=e},render:function(e,i){e.find(".tau-timeline-now-marker").remove(),this._marker=t('<div class="tau-timeline-now-marker"></div>').prependTo(e),this.updatePosition(i)},isRendered:function(){return!!this._marker},updatePosition:function(e){var t=this._timelineRangeModel.getRelativeNowOffset(),i=t>0&&1>t;this.isRendered()&&this._marker.css("left",e?e*t+"px":100*t+"%").toggle(i)}})}),define("tau/ui/templates/board.timeline/ui.template.board.timeline.ruler10",["tau/core/templates-factory"],function(e){var t={name:"board.templates.timeline.ruler",engine:"jqote2",customFunctions:{segmentClass:function(e,t){var i=["tau-ruler-segment"];return e.isPeriodStart&&i.push("tau-is-period-start"),0===t&&i.push("tau-ruler-segment-first"),e.partStart&&i.push("tau-ruler-segment-part"),i.join(" ")},segmentStyle:function(e){var t=[];return t.push("width: "+(100*e.width).toFixed(12)+"%"),t.push("left: "+(100*e.left).toFixed(12)+"%"),t.join("; ")
}},markup:["<% fn._.each(this, function(segment, i) { %>",'<div class="<%= fn.segmentClass(segment, i) %>" style="<%= fn.segmentStyle(segment) %>">',"<% if (!segment.partStart) { %>","<% if (segment.label) { %>",'<div class="tau-notch-label"><%= segment.label %></div>',"<% } %>",'<%= segment.content || "" %>',"<% } else if (segment.displayPartContent) { %>",'<%= segment.content || "" %>',"<% } %>","</div>","<% }.bind(this)); %>"]};return e.register(t)}),define("tau/components/board.timeline/views/ruler/scale",["Underscore","tau/core/class","tau/utils/utils.date","libs/date.js/build/date","tau/utils/timeline/utils.timeline.date.position.calculator"],function(e,t,i,n,a){var r={isMonthFirstMonday:function(e){return e.getDate()<8},isJanuary:function(e){return 0===e.getMonth()},isMonthFirstDay:function(e){return 1===e.getDate()},isYearFirstDay:function(e){return this.isJanuary(e)&&this.isMonthFirstDay(e)},moveToBeginningOfDay:function(e){return e.setHours(0).setMinutes(0).setSeconds(0).setMilliseconds(0)}},s={year:function(e){return i.formatAs(e,"yyyy")},monthAndYear:function(e){return i.formatAs(e,"MMM yyyy")},month:function(e){return i.formatAs(e,"MMM")},fullDate:function(e){return i.formatAs(e,"d MMM yyyy")},shortDate:function(e){return i.formatAs(e,"d MMM")},date:function(e){return r.isYearFirstDay(e)?this.fullDate(e):this.shortDate(e)},monday:function(e){return r.isMonthFirstMonday(e)?r.isJanuary(e)?this.fullDate(e):this.shortDate(e):e.getDate().toString()},time:function(e){return i.formatAs(e,"H:mm")}},o=t.extend({_spaceBetweenLabels:20,init:function(e,t){this._dateRange=e,this._globalWidth=t},setFirstLabelFormat:function(e){this._firstLabelFormat=e},isFirstLabelSpaceAvailable:function(e,t,i,n,a){var r=this._globalWidth*e.originalWidth*(n-t)+this._globalWidth*e.width-a/2;return r>=i+this._spaceBetweenLabels},setSegmentFirstLabel:function(e,t,i,n,a){if(this.isFirstLabelSpaceAvailable(e,t,i,n,a)){e.label=void 0;var r=e.start<this._dateRange.startDate?this._dateRange.startDate:e.start;
e.firstLabel=this._firstLabelFormat(r)}},checkFirstLabel:function(t,i){var n=e.find(t,function(t){return!e.isUndefined(t.firstLabel)});if(e.isUndefined(n)){var a;for(a=0;a<t.length;a++)if(t[a].label&&!t[a].partStart&&i(t[a])){t[a].label=this._firstLabelFormat(t[a].start);break}}},isPartContentAvailable:function(e,t){return this._globalWidth*e>=t}}),l=t.extend({init:function(e,t){this._dateRange=e,this._positionCalculator=a(e),this._firstLabelBuilder=t,this._firstLabelBuilder.setFirstLabelFormat(this._firstLabelFormat)},_minSegmentWidth:30,_minSegmentFirstLabelWidth:45,_minLabelWidth:24,_emptySegmentsCount:10,_firstLabelFormat:s.fullDate,getFirstLabelFormat:function(){return this._firstLabelFormat},isOkForWidth:function(e){return e/(this._dateRange.getDurationInDays()*this._segmentsInDay)>=this._minSegmentWidth},segments:function(){throw new Error("'segments' method not implemented")},_getRawSegments:function(e,t,i){for(var n=[],a=e.clone();t>a;a.add(i)){var r={start:a.clone(),end:a.clone().add(i)};r.start<this._dateRange.startDate?(r.width=this._getWidthForRange(this._dateRange.startDate,r.end),r.originalWidth=this._getWidthForRange(r.start,r.end),r.partStart=!0,r.left=0):(r.left=this._getWidthForRange(this._dateRange.startDate,r.start),r.end>this._dateRange.endDate?(r.width=this._getWidthForRange(r.start,this._dateRange.endDate),r.originalWidth=this._getWidthForRange(r.start,r.end)):(r.width=this._getWidthForRange(r.start,r.end),r.start.getTime()==this._dateRange.startDate.getTime()&&(r.originalWidth=r.width))),r.width>=0&&n.push(r)}return n},_getCurrentSegmentAndSegmentsCount:function(e,t,i){for(var n=e.start.clone(),a=0;!t(n);)n=n.addDays(-i),a++;var r=0;for(n=n.addDays(i);!t(n);)n=n.addDays(i),r++;return{emptySegmentsCount:r,currentSegmentIndex:a}},_getWidthForRange:function(e,t){return parseFloat((this._positionCalculator.getRelativeDatePosition(t)-this._positionCalculator.getRelativeDatePosition(e)).toFixed(12))}}),u=l.extend({_segmentsInDay:24,_emptySegmentsCount:23,_minLabelWidth:30,_minSegmentFirstLabelWidth:70,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{hours:1});
return e.each(i,function(e,t){var i=0===e.start.getHours(),n=e.start.getHours()%4!==0;n||(e.isPeriodStart=i,e.label=i?s.date(e.start):s.time(e.start)),0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,e.start.getHours(),this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}.bind(this)),this._firstLabelBuilder.checkFirstLabel(i,function(e){return 0===e.start.getHours()}),i}}),c=l.extend({_segmentsInDay:6,_minSegmentWidth:45,_emptySegmentsCount:5,_minLabelWidth:30,_minSegmentFirstLabelWidth:70,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{hours:4});return e.each(i,function(e,t){var i=0===e.start.getHours();e.label=i?s.date(e.start):s.time(e.start),e.isPeriodStart=i,0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,e.start.getHours()/4,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}.bind(this)),this._firstLabelBuilder.checkFirstLabel(i,function(e){return 0===e.start.getHours()}),i}}),d=l.extend({_minSegmentWidth:45,_minSegmentFirstLabelWidth:70,_segmentsInDay:3,_minLabelWidth:30,_emptySegmentsCount:2,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{hours:8});return e.each(i,function(e,t){var i=0===e.start.getHours();e.label=i?s.date(e.start):s.time(e.start),e.isPeriodStart=i,0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,e.start.getHours()/8,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}.bind(this)),this._firstLabelBuilder.checkFirstLabel(i,function(e){return 0===e.start.getHours()}),i}}),p=l.extend({_segmentsInDay:3,_minLabelWidth:30,_emptySegmentsCount:2,_minSegmentFirstLabelWidth:70,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{hours:8});return e.each(i,function(e,t){var i=0!==e.start.getHours();i||(e.label=s.date(e.start),e.isPeriodStart=!0),0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,e.start.getHours()/8,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)
}.bind(this)),this._firstLabelBuilder.checkFirstLabel(i,function(e){return 0===e.start.getHours()}),i}}),f=l.extend({_minSegmentWidth:45,_minSegmentFirstLabelWidth:55,_minLabelWidth:45,_segmentsInDay:1,_emptySegmentsCount:5,_firstLabelFormat:s.monthAndYear,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{days:1});return e.each(i,function(e,t){var i=r.isMonthFirstDay(e.start);e.label=i?s.monthAndYear(e.start):"",e.content=e.start.getDate().toString(),e.isPeriodStart=i,0==t&&(this._emptySegmentsCount=e.start.getDaysInMonth()-1,this._firstLabelBuilder.setSegmentFirstLabel(e,e.start.getDate()-1,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth))}.bind(this)),i}}),m=l.extend({_minSegmentWidth:150,_segmentsInDay:1/7,_minSegmentFirstLabelWidth:60,_minLabelWidth:54,_firstLabelFormat:s.monthAndYear,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{days:1});return e.each(i,function(e,t){if(1==e.start.getDay()&&(e.label=s.monday(e.start),e.isPeriodStart=r.isMonthFirstMonday(e.start)),0==t){var i=this._getCurrentSegmentAndSegmentsCount(e,function(e){return 1==e.getDay()&&r.isMonthFirstMonday(e)},1),n=i.currentSegmentIndex;this._emptySegmentsCount=i.emptySegmentsCount,this._firstLabelBuilder.setSegmentFirstLabel(e,n,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}}.bind(this)),this._firstLabelBuilder.checkFirstLabel(i,function(e){return r.isMonthFirstMonday(e.start)}),i}}),h=l.extend({_minSegmentWidth:50,_segmentsInDay:1/7,_minSegmentFirstLabelWidth:60,_minLabelWidth:54,_firstLabelFormat:s.monthAndYear,_moveBackToMonday:function(e){var t=0===e.getDay(),i=t?-6:1-e.getDay();return r.moveToBeginningOfDay(e.addDays(i))},segments:function(){var t=this._moveBackToMonday(this._dateRange.startDate.clone()),i=this._getRawSegments(t,this._dateRange.endDate,{days:7});return e.each(i,function(e,t){if(e.label=s.monday(e.start),e.isPeriodStart=r.isMonthFirstMonday(e.start),0==t){var i=this._getCurrentSegmentAndSegmentsCount(e,r.isMonthFirstMonday,7),n=i.currentSegmentIndex;
this._emptySegmentsCount=i.emptySegmentsCount,this._firstLabelBuilder.setSegmentFirstLabel(e,n,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}}.bind(this)),this._firstLabelBuilder.checkFirstLabel(i,function(e){return r.isMonthFirstMonday(e.start)}),i}}),g=l.extend({_segmentsInDay:1/30,_minSegmentWidth:45,_emptySegmentsCount:11,_firstLabelFormat:s.year,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone().moveToFirstDayOfMonth()),i=this._getRawSegments(t,this._dateRange.endDate,{months:1});return e.each(i,function(e,t){e.label=r.isJanuary(e.start)?s.year(e.start):void 0,e.content=s.month(e.start),e.isPeriodStart=r.isJanuary(e.start),0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,e.start.getMonth(),this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}.bind(this)),i}}),v=l.extend({_segmentsInDay:4/365,_minSegmentWidth:55,_emptySegmentsCount:11,_firstLabelFormat:s.year,segments:function(){var t=r.moveToBeginningOfDay(this._dateRange.startDate.clone().moveToFirstDayOfMonth()),i=this._getRawSegments(t,this._dateRange.endDate,{months:1});return e.each(i,function(e,t){var i=e.start.getMonth();i%4===0&&(e.label=r.isJanuary(e.start)?s.year(e.start):s.month(e.start),e.isPeriodStart=r.isJanuary(e.start)),0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,i,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}.bind(this)),i}}),b=l.extend({_segmentsInDay:2/365,_minSegmentWidth:60,_emptySegmentsCount:1,_firstLabelFormat:s.year,_getFirstDayOfHalfYear:function(e){var t=e.getFullYear(),i=new n(t,0,1),a=new n(t,6,1);return e>=a?a:i},segments:function(){var t=this._getFirstDayOfHalfYear(this._dateRange.startDate),i=this._getRawSegments(t,this._dateRange.endDate,{months:6});return e.each(i,function(e,t){var i=e.start.getMonth(),n=0===i?0:1;0===i&&(e.label=s.year(e.start),e.isPeriodStart=!0),0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,n,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)
}.bind(this)),i}}),y=l.extend({_segmentsInDay:1/365,_getFirstDayOfYear:function(e){return new n(e,0,1)},segments:function(){var t=this._getFirstDayOfYear(this._dateRange.startDate.getFullYear()),i=this._getRawSegments(t,this._dateRange.endDate,{years:1});return e.each(i,function(e){e.content=s.year(e.start),e.isPeriodStart=!0,e.partStart&&(e.displayPartContent=this._firstLabelBuilder.isPartContentAvailable(e.width,this._minSegmentWidth))}.bind(this)),i}}),_=l.extend({_segmentsInDay:10/365,_emptySegmentsCount:9,_firstLabelFormat:s.year,_getFirstDayOfYear:function(e){return new n(e,0,1)},segments:function(){var t=this._getFirstDayOfYear(this._dateRange.startDate.getFullYear()),i=this._getRawSegments(t,this._dateRange.endDate,{years:1});return e.each(i,function(e,t){var i=e.start,n=i.getYear()%10,a=0===n;e.label=a?s.year(i):"",e.isPeriodStart=a,0==t&&this._firstLabelBuilder.setSegmentFirstLabel(e,n,this._minSegmentFirstLabelWidth,this._emptySegmentsCount,this._minLabelWidth)}.bind(this)),i}}),x=[u,c,d,p,f,m,h,g,v,b,y,_];return{createFor:function(t,i){var n=new o(i,t),a=e.find(x,function(e){return new e(i,n).isOkForWidth(t)}.bind(this))||e.last(x);return new a(i,n)}}}),define("tau/components/board.timeline/views/board.timeline.view.first-label",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(){this._firstLabel=""},render:function(e){e.parent().find(".tau-period-label").remove(),t('<div class="tau-period-label"></div>').html(this._firstLabel).insertBefore(e)},setLabel:function(e){this._firstLabel=e||""},isEmpty:function(){return""===this._firstLabel}})}),define("tau/components/board.timeline/views/ruler/board.timeline.view.ruler",["Underscore","jQuery","tau/core/class","tau/ui/templates/board.timeline/ui.template.board.timeline.ruler10","tau/components/board.timeline/views/ruler/scale","tau/components/board.timeline/views/board.timeline.view.first-label"],function(e,t,i,n,a,r){var s=i.extend({init:function(e){this._$placeholder=null,this._dateRange=null,this._nowMarker=e,this._firstLabel=new r
},_html:function(){var e=a.createFor(this._$placeholder.width(),this._dateRange).segments();return this._firstLabel.setLabel(e[0].firstLabel),n.get().bind({},e)},bind:function(e){this._dateRange=e,this._$placeholder&&this._doRender()},renderTo:function(e){this._$placeholder=e.find(".tau-scale-ruler"),this._$placeholder.width(e.find(".tau-timeline-flow").width()),this._dateRange&&this._doRender()},_doRender:function(){if(this._$placeholder.html(this._html()),this._nowMarker.render(this._$placeholder),this._firstLabel.isEmpty()){var e=this._$placeholder.find(".tau-ruler-segment.tau-is-period-start").first(),t=e.position(),i=e.find(".tau-notch-label");i.length>0&&i.width()/2>t.left&&(this._firstLabel.setLabel(i.html()),i.empty())}this._firstLabel.render(this._$placeholder)}});return s}),define("tau/components/board.timeline/templates/template.timeline.navigator",["tau/core/templates-factory"],function(e){var t={name:"board.templates.timeline.navigator",engine:"jqote2",customFunctions:{},markup:['<div class="tc-histogram <%= this.buckets.length == 0 ? "tc-histogram-empty": ""%>">',"<% var width = 100 / this.buckets.length; %>","<% var left = 0; %>","<% _.each(this.buckets, function(item){ %>",'<div class="tc-item" style="left: <%= left%>%; width: <%= width %>%">',"<% left += width; %>","<% _.each(item, function(value, key){ %>",'<div class="tc-meter tc-<%= key.toLowerCase()%>" style="height:<%=value%>px;"></div>',"<% }); %>","</div>","<% }); %>","</div>","<% if (this.buckets.length > 0){ %>",'<div class="tc-focus-range" data-range-min="0" data-range-max="<%= this.buckets.length - 1 %>">','<div class="tc-start"></div>','<div class="tc-end"></div>','<div class="tc-space"></div>',"</div>","<% }; %>",'<button class="tau-btn refresh-histogram tau-extension-board-tooltip" data-title="Refresh navigator"></button>']};return e.register(t)}),define("tau/components/board.timeline/views/timeline.navigator.histogram",["Underscore","tau/core/class"],function(e,t){function i(t,i){return e.chain(t).keys().reduce(function(e,n){return e[n]=i(t[n]),e
},{}).value()}var n=function(t){return e.sum(e.values(t))};return t.extend({_items:null,init:function(e){this._items=e},gerRenderData:function(t){var a=e.reduce(this._items,function(t,i,n){return e.each(i,function(e,i){t[i]=t[i]||{},t[i][n]=e}),t},[]),r=e.chain(a).map(n).max().value(),s=t/r;return e.map(a,function(e){return i(e,function(e){return Math.round(e*s)})})}})}),define("tau/components/board.timeline/views/view.timeline.navigator",["Underscore","jQuery","tau/core/class","tau/components/board.timeline/templates/template.timeline.navigator","tau/components/board.timeline/views/timeline.navigator.histogram","tau/components/board.timeline/views/board.timeline.view.now-marker"],function(e,t,i,n,a,r){var s=4,o=1;return i.extend({init:function(t){this._model=t,this.bucketWidth=s+o,this.onDateRangeChanged=e.Callbacks(),this._nowMarker=new r(t)},_getBucketsCount:function(){return Math.floor(this._containerBaseWidth/this.bucketWidth)},_refreshDensity:function(){return t.when(this._model.queryDensity(this._getBucketsCount())).then(this._render.bind(this))},renderTo:function(e){this._$placeholder&&this._$placeholder[0]==e[0]||(this._$placeholder=e,this._$placeholder.tauProgressIndicator(),this._containerBaseWidth=this._$placeholder.outerWidth(),this._model.globalDateRangeIsDefined()&&this._refreshDensity())},_alignRange:function(e,t,i){var n=i.position().left+i.outerWidth()-t.position().left;e.css("width",(100*n/this._$placeholder.outerWidth()).toFixed(2)+"%")},_render:function(e){var t=new a(e),i=t.gerRenderData(this._$placeholder.height());if(this._$placeholder.html(this._html(i)),i.length>0){var n=this._model.getRelativeSelectedRange(),r=Math.round(n.start*i.length),s=Math.round(n.end*i.length),o=this._$placeholder.find(".tc-item"),l=this._$placeholder.find(".tc-focus-range");this._alignRange(l,o.eq(r),o.eq(s-1)),this._$placeholder.tauSlider({grid:o,value:r,handle:l,selectionWidth:s-r,min:l.data("range-min"),max:l.data("range-max"),animate:!0,slide:function(e,t){var n=t.value,a=n+this._$placeholder.tauSlider("option","selectionWidth");
this.onDateRangeChanged.fire(this._model.convertToDateRange(n/i.length,a/i.length))}.bind(this),change:function(e,t){var n=this._$placeholder.tauSlider("option","selectionWidth"),a=t.value+n-1;l.tauResizable("option",{startValue:t.value,endValue:a}),this._model.setRelativeSelectedRange(t.value/i.length,(a+1)/i.length)}.bind(this)}),l.tauResizable({gridContainment:o,handles:{e:".ui-resizable-e",w:".ui-resizable-w"},startValue:r,endValue:s-1,resize:function(e,t){this.onDateRangeChanged.fire(this._model.convertToDateRange(t.startValue/i.length,(t.endValue+1)/i.length))}.bind(this),stop:function(e,t){this._$placeholder.tauSlider("option",{selectionWidth:t.endValue-t.startValue+1}),this._$placeholder.tauSlider("setValueWithoutEvents",t.startValue);var n=100*t.size.width/this._$placeholder.outerWidth();l.css("width",n+"%"),this._model.setRelativeSelectedRange(t.startValue/i.length,(t.endValue+1)/i.length)}.bind(this)}),this._$placeholder.find(".refresh-histogram").on("click",function(){this._$placeholder.tauSlider("destroy")}.bind(this))}this._renderNowMarker(o),this._$placeholder.find(".refresh-histogram").on("click",this._refresh.bind(this))},_refresh:function(){taus.track("action",{name:"timeline-navigator-refresh"}),this._$placeholder.tauProgressIndicator("show",{hover:!0}),this._refreshDensity().then(function(){this._$placeholder.tauProgressIndicator("hide")}.bind(this))},_html:function(e){return n.get().bind({},{buckets:e})},_getGridWidth:function(e){if(e&&e.length>0)var t=e.last(),i=t.position().left+t.outerWidth();return i},_renderNowMarker:function(e){var t=this._getGridWidth(e);this._nowMarker.render(this._$placeholder,t)},updateNowPosition:function(){if(this._$placeholder&&this._model.globalDateRangeIsDefined()){var e=this._$placeholder.find(".tc-item");if(0!==e.length){var t=this._getGridWidth(e);this._nowMarker.updatePosition(t)}}}})}),define("tau/components/board.timeline/models/model.timeline.navigator",["require","jQuery","tau/core/class","tau/utils/timeline/utils.timeline.date-range","tau/utils/timeline/utils.timeline.date.position.calculator","tau/utils/utils.date"],function(e){var t=e("jQuery"),i=e("tau/core/class"),n=e("tau/utils/timeline/utils.timeline.date-range"),a=e("tau/utils/timeline/utils.timeline.date.position.calculator"),r=e("tau/utils/utils.date");
return i.extend({init:function(e){this._dataProvider=e,this._dataProvider.onTimelineLocalDateRangeChanged.add(this.onLocalDataRangeChanged.bind(this)),this._dataProvider.onTimelineGlobalDateRangeChanged.add(this.onGlobalDataRangeChanged.bind(this)),this._positionCalculator=null,this._localDateRange=null},onLocalDataRangeChanged:function(e){this._localDateRange=e},onGlobalDataRangeChanged:function(e){this._positionCalculator=e.isValid?a(e):null},globalDateRangeIsDefined:function(){return!!this._positionCalculator},getRelativeNowOffset:function(){return this._positionCalculator.getRelativeDatePosition(r.getServerNow())},getRelativeSelectedRange:function(){return{start:this._positionCalculator.getRelativeDatePosition(this._localDateRange.startDate),end:this._positionCalculator.getRelativeDatePosition(this._localDateRange.endDate)}},convertToDateRange:function(e,t){var i=this._positionCalculator.getCorrespondingDate(e),a=this._positionCalculator.getCorrespondingDate(t);return new n(i,a)},setRelativeSelectedRange:function(e,t){this._localDateRange=this.convertToDateRange(e,t),this._dataProvider.setTimelineLocalDateRange(this._localDateRange)},queryDensity:function(e){return this._positionCalculator?t.when(this._dataProvider.queryDensity(e)).then(function(e){return e.data}):[]}})}),define("tau/components/board.timeline/controllers/controller.timeline",["Underscore","jQuery","tau/core/class","tau/components/board.timeline/views/board.timeline.view.now-marker","tau/components/board.timeline/views/ruler/board.timeline.view.ruler","tau/components/board.timeline/views/view.timeline.navigator","tau/components/board.timeline/models/model.timeline.navigator"],function(e,t,i,n,a,r,s){var o={seconds:function(e){return 1e3*e},minutes:function(e){return this.seconds(60*e)}},l={TIMELINE_SCROLLING_RENDER:o.seconds(.2),NOW_MARKER_UPDATE:o.minutes(1),FORECASTS_UPDATE:o.minutes(60)},u=i.extend({init:function(t){this._interval=t,this._timerId=null,this.onTick=e.Callbacks()},start:function(){this._timerId=setInterval(this.onTick.fire.bind(this.onTick),this._interval)
},stop:function(){clearInterval(this._timerId),this._timerId=null},destroy:function(){this.onTick.removeAll(),this.stop()}}),c=i.extend({init:function(e,t,i){this._busEvents=i,this._timelineViewRegistry=t.view,this._timelineCellModelRegistry=t.cellModel,this._timelineAxesModelRegistry=t.axesModel,this._timelineModel=e,this._timelineModel.onTimelineLocalDateRangeChanged.add(this._onTimelineLocalDateRangeChanged.bind(this)),this._timelineAxesModelRegistry.onAxisCellsAdded.add(function(e,t){this._timelineViewRegistry.axisCellsAdded(e,t)},this),this._rulerNowMarker=new n(this._timelineModel.timelineRangeModel),this._rulerView=new a(this._rulerNowMarker),this._nowMarker=new n(this._timelineModel.timelineRangeModel);var o=new u(l.NOW_MARKER_UPDATE);o.onTick.add(this._updateNowPositions,this);var c=new u(l.FORECASTS_UPDATE);c.onTick.add(this._updateForecasts,this),this._timers=[o,c],this._navigatorModel=new s(this._timelineModel),this._navigatorView=new r(this._navigatorModel),this._navigatorView.onDateRangeChanged.add(this._updateLocalDateRange.bind(this))},destructor:function(){e.invoke(this._timers,"destroy"),this._timelineModel.unbindBoardSettings()},_onTimelineLocalDateRangeChanged:function(e){this._rulerView.bind(e),this._updateNowMarkers()},_updateNowMarkers:function(){this._rulerNowMarker.updatePosition(),this._nowMarker.updatePosition(),this._navigatorView.updateNowPosition()},_updateNowPositions:function(){this._updateNowMarkers(),this._timelineCellModelRegistry.forEach(function(e){e.isTimeline&&e.extendUnfinishedCardsToNow(!1)})},_updateForecasts:function(){this._timelineModel.queryForecasts().then(function(e){this._timelineCellModelRegistry.forEach(function(t){t.isTimeline&&t.updateForecasts(e)})}.bind(this))},resize:function(t){var i=t.find(".tau-timeline-flow"),n={width:i.outerWidth(),height:i.outerHeight()};e.isEqual(this._size,n)||this.render(t)},render:function(t){this._navigatorView.renderTo(t.find("._tc-timeline-navigator"));var i=t.find(".tau-timeline-flow");
this._size={width:i.outerWidth(),height:i.outerHeight()},this._rulerView.renderTo(t),this._nowMarker.render(t.find(".tau-timeline-flow")),e.invoke(this._timers,"stop"),this._updateNowMarkers(),e.invoke(this._timers,"start"),this._busEvents.rendered.fire()},_updateLocalDateRange:function(e){this._rulerView.bind(e),this._applyLocalDateToTimelineCards(e)},_applyLocalDateToTimelineCards:e.throttle(function(e){this._timelineModel.setDateRange(e),this._timelineCellModelRegistry.forEach(function(e){e.isTimeline&&e.updateCardsPositions()}),this._updateNowMarkers()},l.TIMELINE_SCROLLING_RENDER),onCellsContentLoaded:function(){this._timelineCellModelRegistry.forEach(function(e){e.isTimeline&&e.onMovePlannedDates.add(this._timelineModel.movePlannedDates.bind(this._timelineModel))}.bind(this))},onCardsMoved:function(t){this._timelineCellModelRegistry.forEach(function(i){e.each(t,function(e){i.clearCard(e.dataItem.id)})}),e.each(t,function(t){var i=e.extend(e.pick(t,"track"),i,{forceUnlock:!0}),n=this._timelineCellModelRegistry.get(t);n&&n.updateCard(t.dataItem,i)},this)},onBuildCellSkeleton:function(e,t,i,n,a){if(0===i.paging.from){var r=this._timelineCellModelRegistry.get(i);this._timelineViewRegistry.renderCell(e,t,r,n.element,a)}},onBuildAxisSkeleton:function(e,t,i,n){var a=this._timelineAxesModelRegistry.get(i);this._timelineViewRegistry.renderAxisCell(e,t,a,n.element)}});return c}),define("tau/ui/extensions/timeline/ui.extension.timeline",["Underscore","tau/components/board.timeline/controllers/controller.timeline","tau/core/extension.base"],function(e,t,i){return i.extend({resetLifecycle:!0,init:function(i,n,a,r){this._super.apply(this,arguments),this._model=n,this._timelineAxesModelRegistry=a.axesModel,this._timelineViewRegistry=a.view,this._busEvents=r,this._model.onPageChanged.add(function(t){this.fire("page.changed",e.deepClone(t.page))}.bind(this)),this._model.onZoomLevelChanged.add(this.fire.bind(this,"model.zoomLevelChanged")),this._model.onSliceInfoRetrieved.add(this.fire.bind(this,"model.sliceInfo.retrieved")),this._model.onBoardPagingSettingsRetrieved.add(this.fire.bind(this,"board.paging.settings")),this._model.onAcidReady.add(this.fire.bind(this,"acid.ready")),this._model.onBoardConfigurationReady.add(this.fire.bind(this,"board.configuration.ready")),this._model.onViewModeReady.add(this.fire.bind(this,"viewMode.ready")),this._model.onDefinitionReady.add(this.fire.bind(this,"definition.ready")),this._model.onPageReady.add(this.fire.bind(this,"page.ready")),this._model.onBoardDefinitionReady.add(this.fire.bind(this,"board.definition.ready")),this._model.onBoardDefinitionReady.add(function(e,t){taus.track({"@":["open-board-action"],boardSettings:t,definition:e})
}),this._model.onSliceReady.add(function(e){this.fire("slice.ready",e),this.fire("comet.parameters",e.slice.getCometParameters())}.bind(this)),this._model.onCardLayoutFactoryReady.add(this.fire.bind(this,"cardLayoutFactory.ready")),this._busEvents.onBeforeUpdateCell.add(function(e){this.fire("view.cell.skeleton.element.beforeUpdate",e)}.bind(this)),this._busEvents.onAfterUpdateCell.add(function(e){this.fire("view.cell.skeleton.element.afterUpdate",e),this.fire("view.cell.skeleton.built",{element:e.cell,data:e.dataItem})}.bind(this)),this._translateViewEvents(),this._timelineController=new t(n,a,r),this._busEvents.rendered.add(this.fire.bind(this,"ruler.view.afterRender")),this._busEvents.hintHide.add(this.fire.bind(this,"hint.hide")),this._busEvents.cardUnselect.add(this.fire.bind(this,"card.unselect")),this._busEvents.viewTimelineTracksCountChanged.add(e.debounce(this.fire.bind(this,"view.timeline.tracks.count.changed"),1))},_translateEvent:function(t,i){var n=t.result;n.$cell.data("istimeline")||this.fire("view.cell.skeleton.updated",{element:n.$cell}),this.fire("selection.reapply",{}),e.each(n.cards,function(e,t){var i=n.dataItems[t];this.fire("view.card.skeleton.built",{element:e,data:{id:i.id,type:i.type}})}.bind(this));var a=i();this.fire("operation.execute.done",{operation:t.operation,dataItems:e.pluck(n.dataItems,"data"),affected$CellsArray:a,cards:n.cards})},_translateViewEvents:function(){this._busEvents.onCellUpdated.add(function(e){this._translateEvent(e,function(){return[e.result.$cell]})}.bind(this)),this._busEvents.onAxisUpdated.add(function(t){this._translateEvent(t,function(){var i=t.result.$cell,n=i.data("y"),a=[];if("added"===t.operation.name)a.push(i);else{var r=i.closest(".i-role-board-body").find(".i-role-grid .i-role-cell").filter(function(e,t){var i=$(t);return i.data("y")===n});a=e.map(r.toArray(),$)}return a})}.bind(this))},destroy:function(){this._timelineController.destructor()},"bus $el.ready:last + view.dom.ready:last + resize.completed":function(e,t){this._timelineController.resize(t)
},"bus $el.ready:last + view.dom.ready":function(e,t){this._timelineController.render(t)},"bus model.execute.cell.query":function(e,t){this._model.setQuery(t.query)},"bus board.paging.settings:last + board.paging.settings.retrieve":function(e,t){this.fire("board.paging.settings.retrieved",t)},"bus page.move.to + board.paging.settings:last + boardSettings.ready:last":function(e,t,i,n){this._model.moveToPage(i.page,t.direction,n)},"bus boardSettings.ready:last + page.switched":function(e,t,i){this._model.setPage(t.boardSettings,i)},"bus configurator.ready:last + boardSettings.ready + start.lifecycle":function(e,t,i){this._model.startLifeCycle(t,i.boardSettings)},"bus configurator.ready > slice.ready":function(e,t,i){this._model.onGetSliceInfo(i.slice,t)},"bus slice.ready:last + before_destroy":function(){this.fire("clearError"),this._model.abortCurrentSlice()},"bus slice.ready:last + before_refresh":function(){this.fire("clearError"),this._model.abortCurrentSlice()},"bus model.cells.content.loaded":function(){this._timelineController.onCellsContentLoaded()},"bus build.timeline.cell.skeleton":function(e,t){this._timelineController.onBuildCellSkeleton(t.configurator,t.boardLayout,t.buildCellCommand,t.boardSkeleton,t.timelineWidthDeferred)},"bus build.timeline.axis.skeleton":function(e,t){this._timelineController.onBuildAxisSkeleton(t.configurator,t.boardLayout,t.buildAxisCellCommand,t.boardSkeleton)},"bus timeline.card.batch.move.after":function(t,i){var n=e.chain(i.items).pluck("moves").flatten().value();this._timelineController.onCardsMoved(n,i.options)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.hints.timeline",["tau/ui/extensions/board.plus/ui.extension.board.plus.hints"],function(e){return e.extend({alignTo:function(e){return e.parent().is(".i-role-timeline-card-holder,.i-role-timeline-planner-card-holder")?e.parent():e},_getHolderClass:function(){return".i-role-card,.i-role-timeline-card-holder,.i-role-timeline-planner-card-holder"},_getCard:function(e){return e.is(".i-role-card")?e:e.find(".i-role-card")
}})}),define("tau/models/board.plus/model.board.collapse.timeline.empty",["Underscore","tau/models/board.plus/model.board.collapse.empty"],function(e,t){return t.extend({_isAxisValueEmpty:function(t,i){var n=i.dynamic.items[0].data||{},a=e.has(i,"x")&&!n.isBacklog;return this._super(t,i)&&!a}})}),define("tau/ui/extensions/board.plus/ui.extension.full-counts",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({resetLifecycle:!0,init:function(){var e=this;e._super.apply(e,arguments),e._updateMetaInfoDebouncedHandler=t.debounce(e.updateMetaInfoAsync,500)},updateMetaInfoAsync:function(e,i,n,a){var r=this;r._request&&r._request.reject({data:{status:0}});var s=t.pluck(e.x.data,"x"),o=t.pluck(e.y.data,"y"),l={$whereX:s.length?{x:{$in:s}}:void 0,$whereY:o.length?{y:{$in:o}}:void 0};(l.$whereX||l.$whereY)&&(r._request=i.axesCounts(l).done(function(e){r._request=null,a.updateAxesMetaInfo(e.data.items,n),r.fire("view.axes.counters.updated")}))},"bus boardSettings.ready":function(e,i){i=i.boardSettings;var n=t.bind(function(e){this.fire("boardSettings.limitsReady",e.limits||{})},this);i.get({fields:["limits"],listener:this,callback:n}),i.bind({fields:["limits"],listener:this,callback:n})},"bus model.sliceInfo.retrieved + slice.ready + domWrapper.ready + boardSettings.limitsReady":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(t,i.slice,a,n)},"bus boardSettings.limitsReady:last > model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last >  view.card.batch.move.completed":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(i,n.slice,t,a)},"bus boardSettings.limitsReady:last > model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last > boardSettings.limitsReady:last > operation.execute.done":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(i,n.slice,t,a)},"bus model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last > boardSettings.limitsReady":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(t,i.slice,a,n)
}})}),define("tau/ui/extensions/timeline/ui.extension.timeline.full-counts",["tau/ui/extensions/board.plus/ui.extension.full-counts"],function(e){return e.extend({"bus boardSettings.limitsReady:last > model.sliceInfo.retrieved:last > slice.ready:last > domWrapper.ready:last > operation.execute.comet.done":function(e,t,i,n,a){this._updateMetaInfoDebouncedHandler(i,n.slice,t,a)},updateMetaInfoAsync:function(e,t,i,n){var a=e.definition;a.user.globalDateRange&&a.user.globalDateRange.startDate&&a.user.globalDateRange.endDate&&this._super(e,t,i,n)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cards-lazy-loading.timeline.customized",["tau/ui/extensions/board.plus/ui.extension.board.plus.cards-lazy-loading.customized"],function(e){var t=e.extend({handlerSliceFail:function(){},redrawCards:function(){}});return t}),define("tau/components/board.timeline/bus.timeline.event.aggregator",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(){this.rendered=e.Callbacks(),this.hintHide=e.Callbacks(),this.cardUnselect=e.Callbacks(),this.viewTimelineTracksCountChanged=e.Callbacks(),this.onBeforeUpdateCell=e.Callbacks(),this.onAfterUpdateCell=e.Callbacks(),this.onCellUpdated=e.Callbacks(),this.onAxisUpdated=e.Callbacks()}})}),define("tau/ui/extensions/timeline/ui.extension.timeline.hide.empty.lanes",["jQuery","Underscore","tau/ui/extensions/board.plus/ui.extension.board.plus.hide.empty.lanes"],function(e,t,i){return i.extend({_extractCellData:function(e){this.cells=[],t.each(e.cells,function(e){var t=e.data;e.element.length&&this.cells.push({x:t.x,y:t.y,element:e.element,hasItems:t.dynamic.items.length})},this)},_findCellsOnEmptyLanes:function(){var i={};t.each(this.cells,function(e){e.x&&e.y&&e.hasItems&&(i[e.y]=!0)},this);var n=e();return t.each(this.cells,function(e){e.y&&!i[e.y]&&(n=n.add(e.element))}),n}})}),define("tau/components/component.board.plus.timeline",["Underscore","tau/components/extensions/error/extension.errorBar","tau/components/component.creator","tau/components/component.board.plus.base","tau/components/board.timeline/view/view.timeline.registry","tau/ui/extensions/timeline/ui.extension.timeline.view","tau/components/board.timeline/models/model.timeline.slice.comet","tau/ui/extensions/timeline/ui.extension.timeline.operations","tau/components/board.timeline/models/model.timeline.date-range","tau/components/board.core/models/model.board.plus.timeline","tau/components/board.timeline/models/timeline.model.board.cell.freezable","tau/components/board.timeline/models/model.timeline.cells.registry","tau/components/board.timeline/models/model.timeline.axes.registry","tau/ui/extensions/timeline/ui.extension.timeline.layout","tau/ui/extensions/board.plus/ui.extension.board.plus.dom.updater.board","tau/models/timeline/model.timeline.dragndrop","tau/ui/extensions/timeline/ui.extension.timeline.dragndrop","tau/ui/extensions/timeline/ui.extension.timeline.selection.board","tau/ui/extensions/board.plus/ui.extension.board.plus.scrollManager","tau/ui/extensions/timeline/ui.timeline.scrollManager","tau/ui/extensions/board.plus/ui.extension.board.plus.scroll","tau/ui/extensions/timeline/ui.extension.timeline.sync-scroll","tau/ui/extensions/timeline/ui.extension.timeline","tau/ui/extensions/board.plus/ui.extension.board.plus.hints.timeline","tau/ui/extensions/board.plus/ui.extension.board.plus.hintsHeader","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsSparklines","tau/models/board.plus/model.board.collapse","tau/models/board.plus/model.board.collapse.timeline.empty","tau/ui/extensions/board.plus/ui.extension.board.plus.collapse","tau/ui/extensions/board.plus/ui.extension.board.plus.focus","tau/ui/extensions/board.plus/ui.extension.board.plus.paging","tau/ui/extensions/timeline/ui.extension.timeline.full-counts","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.board","tau/models/board.plus/model.board.plus.quick.add.axes","tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.axes","tau/models/board.plus/nodata/nodata-strategies","tau/models/board.plus/model.board.nodata","tau/ui/extensions/board.plus/ui.extension.board.plus.empty.data","tau/ui/extensions/board.plus/ui.extension.board.plus.progress","tau/ui/extensions/board.plus/ui.extension.board.plus.cards-lazy-loading.timeline.customized","tau/ui/extensions/board.plus/ui.extension.board.plus.quick.add.cells","tau/models/board.plus/model.board.plus.quick.add.cells","tau/components/board.timeline/bus.timeline.event.aggregator","tau/ui/extensions/timeline/ui.extension.timeline.hide.empty.lanes"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b,y,_,x,w,C,S,T,k,I,D,P,E,R,A,F,M,N,j,L,U,B,O,$,z,q){return{create:function(e){var t=e.context.configurator.getFeaturesService(),i=new l,_=new d(i),k=new p,H=new u(i),V=new z,G=new a(i,V);
c=c.extend({generateDefaultContent:function(e){var t=this._super(e);return e.isTimeline&&t.fixed.items.push({id:"timeline",type:"timeline"}),t}});var W={ViewType:r,extensions:[{extType:c,args:[_,k]},{extType:h,args:[_]},{extType:g,args:[G]},m,f,v,{extType:b,args:[new y]},x,B,{extType:w,args:[H,{cellModel:_,axesModel:k,view:G},V]},C,S,T,I,D,P,E,A,{extType:j,args:[N.timeline]},{extType:L,args:["Set up your timeline View"]},{extType:o,args:[_,k]},U,O,$,F,M,q].concat(e.extensions||[])};return W.extensions.push(R),t.isEnabled("comet.notifications")&&W.extensions.push({extType:s,args:[e.context.configurator,"slice-timeline"]}),n.create(W,e)}}}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.remove",["Underscore","jQuery","app.path","tau/core/extension.base.stateful"],function(e,t,i,n){return n.extend({"bus configurator.ready:last + boardSettings.ready:last + afterRender":function(e,t,i,n){var a=n.element.find("[role=action-remove]");a.tauConfirm({content:["<h3>"+a.data("confirmMessage")+"</h3>"].join(""),callbacks:{success:function(){var e=t.getBoardOperationsService();e.removeBoard(i.boardSettings.settings.id,i.boardSettings.settings.acid).then(function(){e.redirectToDefaultBoard()})}.bind(this)},zIndex:130})}})}),define("tau/components/component.board.remove",["Underscore","tau/components/component.creator","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.remove","tau/components/extensions/error/extension.errorBar","tau/core/helpers/extension.configurator"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[i,n,a],template:{engine:"jqote2",name:"removeBoardButton",markup:['<span class="tau-inline-group tau-board-remove">','<button data-confirm-message="Do you really want to delete this View?" class="tau-btn tau-board-terminator" role="action-remove" type="button">Remove View</button>',"</span>"]}};e["queue.bus"]=!0;var s=t.create(r,e);return s.on("afterInit",function(e){e.sender.fire("dataBind",{})}),s}}}),define("tau/components/context.selector/templates/template.context.program.add.fn",["tau/ui/templates/board.context.selector/ui.template.board.context.selector.projects.list"],function(){return{}
}),define("template!tau/components/context.selector/templates/template.context.program.add",["tau/core/templates-factory","./template.context.program.add.fn"],function(e,t){var i={name:"template.context.program.add",engine:"jqote2",customFunctions:t,markup:'<form class="i-role-form"> <div class="tau-new-entity-form"> <div class="tau-new-entity-form__row"> <div class="tau-note"><b>New program</b></div> <div class="tau-new-entity-info tau-new-entity-info--full"><input type="text" class="tau-in-text tau-new-entity-name" placeholder="Enter program name here" name="name"> </div> </div> <div class="tau-new-entity-form__row"> <div class="tau-note">Include projects</div> <% if(_.isEmpty(this.projects)) { %> <div class="tau-no-items"><strong>No Projects available so far.</strong><br>You can add new Projects to Program later.</div> <% } else { %> <div class="tau-projects"> <ul class="tau-category-items-selector i-role-list" style="max-height: 264px; overflow-y: auto;"> <%= fn.sub(\'board.context.selector.projects.list\', this.projects) %> </ul> </div> <% } %> </div> <div class="tau-new-entity-form__row"> <button type="submit" class="tau-btn tau-success">Create program</button> <button type="reset" class="tau-btn">Cancel</button> </div> </div> </form>'};return e.register(i)}),define("tau/components/context.selector/views/view.context.program.add",["Underscore","jQuery","tau/core/class","template!tau/components/context.selector/templates/template.context.program.add"],function(e,t,i,n){var a=i.extend({init:function(t){this.onProgramCreate=e.Callbacks(),this._$container=t,t.on("click","[type=submit]",this._onSubmit.bind(this))},render:function(t){t.projects=e.map(t.projects,function(t){return e.extend({tooltip:""},t)}),this._$container.empty().append(n.render(t))},focus:function(){this._$container.find(".i-role-form :text:first").focus()},error:function(){this._$container.find(".i-role-form :text:first").focus().select().addClass("tau-error")},_onSubmit:function(){return this.onProgramCreate.fire(this._collectFormData()),!1
},_getValueAsId:function(e){return parseInt(e.val(),10)},_collectFormData:function(){var e=t("input.tau-new-entity-name",this._$container).val(),i=t(".i-role-project [type=checkbox]:checked",this._$container).map(function(e,i){return{id:this._getValueAsId(t(i))}}.bind(this)).toArray();return{name:e,projects:i}}});return a}),define("tau/components/context.selector/models/model.context.program",["Underscore","jQuery","tau/core/class"],function(e,t,i){var n=i.extend({init:function(e){this._store=e},getAvailableProjects:function(e){var i=t.Deferred();return this._store.find("project",{$query:{program:{$isNull:!0},isActive:"true"},fields:e}).done(function(e){i.resolve(e[0].data)}),i.promise()}});return n}),define("tau/components/context.selector/models/model.context.program.add",["Underscore","jQuery","tau/components/context.selector/models/model.context.program"],function(e,t,i){var n=["id","name","color","isActive"],a=["id","name","projects["+n.join(",")+"]"],r=i.extend({init:function(t){this.onProjectSaved=e.Callbacks(),this._super(t),this._store.on({type:"project",eventName:"afterSave",listener:this},this._onProjectSaved.bind(this))},getData:function(){return this.getAvailableProjects(n).then(function(e){return{projects:e}})},setData:function(e){var i=t.Deferred();return this._store.save("program",{$set:e,fields:a},{failure:i.reject}).done(function(e){i.resolve(e[0].data)}),i.promise()},_onProjectSaved:function(e){this.onProjectSaved.fire(e)}});return r}),define("tau/components/context.selector/controllers/controller.context.program.add",["jQuery","tau/core/class","tau/components/context.selector/views/view.context.program.add","tau/components/context.selector/models/model.context.program.add"],function(e,t,i,n){var a=t.extend({init:function(t,a){this._$element=e('<div class="tau-managed-category tau-programs tau-managed-category_formactive_true"></div>'),this._model=new n(t),this._model.onProjectSaved.add(this._refresh,this),this._view=new i(this._$element),this._view.onProgramCreate.add(this._onProgramCreate,this),this._dispatcher=a
},render:function(){return this._render().then(function(){return{element:this._$element}}.bind(this))},completeShow:function(){this._view.focus()},destroy:function(){this._view.onProgramCreate.remove(this)},_render:function(){return this._model.getData().then(this._view.render.bind(this._view))},_onProgramCreated:function(e){this._dispatcher.addCompleted(e),this._refresh()},_refresh:function(){this._dispatcher.refresh()},_onProgramCreate:function(e){this._model.setData(e).then(this._onProgramCreated.bind(this)).fail(this._onProgramError.bind(this))},_onProgramError:function(){this._view.error()}});return a}),define("tau/components/component.board.selector.add-program",["jQuery","tau/components/component.creator","tau/core/extension.base","tau/components/context.selector/controllers/controller.context.program.add"],function(e,t,i,n){return{create:function(e){var a={extensions:[i.extend({"bus beforeInit":function(e){var t=e.data.config.context.configurator;this._controller=new n(t.getStore(),this)},"bus afterInit":function(){this._controller.render().then(this.fire.bind(this,"afterRender"))},"bus destroy":function(){this._controller.destroy()},"bus show.completed":function(){this._controller.completeShow()},refresh:function(){this.fire("afterInit",{config:this.config})},addCompleted:function(e){this.fire("program.add.completed",e)}})]};return t.create(a,e)}}}),define("tau/models/board.startScreen/model.board.startScreen",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus beforeInit":function(i,n){var a=n.config.context.configurator;this.fire("configurator.ready",a);var r=e.defaults(n.config.options||{},{boardTemplatesGroupName:"boardTemplates",boardTemplateGroupsGroupName:"boardTemplateGroups",boardsGroupName:"boards"});this.fire("options.ready",r);var s=t.Deferred();a.getLoggedUser().isAdministrator?a.getRestStorage().select(r.boardsGroupName,{$where:'(publicData.isShared == "true")',$fields:["key"]}).done(function(e){var t=e.data||[];
0===t.length?s.resolve():s.reject()}):s.reject(),s.done(e.bind(function(){this.fire("dataBind",{})},this)).fail(function(){a.getRouting().redirect(a.getUrlBuilder().getRelativeBoardUrl("current"))})},"bus configurator.ready:last + options.ready:last + boardsSet.selected":function(i,n,a,r){var s=t.Deferred(),o=n.getHelpScenarioService(),l=o.getScenarioById(r),u=l.requiredProject;u?n.getApplicationContextService().getApplicationContext({projectIds:[u],teamIds:[]},{success:s.resolve}):s.resolve({acid:void 0});var c=t.Deferred(),d=this;t.post(n.getApplicationPath()+"/board/generate/"+r).fail(function(e){console.log("ERROR: "+e.responseText)}).done(function(){d.fire("boardsSet.applied"),c.resolve()}),t.when(s,c).done(e.bind(function(e){var t=o.checkScenarioPrerequisites(e,l)?r:"scratch";o.setCurrentFlow(t),o.setState(o.stateTypes.ToBeStarted),n.getRouting().redirect(n.getUrlBuilder().getRelativeBoardUrl("current",e.acid)),this.fire("helpFlow.activated")},this))}})}),define("tau/ui/extensions/board.startScreen/ui.extension.board.startScreen",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender":function(t,i){var n=i.element;n.on("click",".i-role-trigger",_.bind(function(t){var i=e(t.currentTarget);n.children().css("visibility","hidden"),n.tauProgressIndicator({className:"tau-start"}),n.tauProgressIndicator("show"),this.fire("boardsSet.selected",i.data("type"))},this))}})}),define("tau/ui/templates/board.startScreen/ui.template.board.startScreen",["tau/core/templates-factory"],function(e){var t={name:"board.startScreen",engine:"jqote2",markup:['<div class="tau-start-screen">','<div class="tau-start-screen__invitation">',"<h1>targetprocess<sup>3</sup></h1>","<h2>Start Your Experiments!</h2>",'<ul class="tau-start-screen__menu">','<li class="tau-start-screen__menu-item-scrum">','<a class="i-role-trigger" data-type="scrum">',"<h3>Scrum</h3>","<p>","Iterate as needed","<br>","until the distillate is clear.","</p>","</a>","</li>",'<li class="tau-start-screen__menu-item-kanban">','<a class="i-role-trigger" data-type="kanban">',"<h3>Kanban</h3>","<p>","Want to keep the flow going?","<br>","Heat to increase throughput.","</p>","</a>","</li>",'<li class="tau-start-screen__menu-item-from-scratch">','<a class="i-role-trigger" data-type="scratch">',"<h3>From Scratch</h3>","<p>","Whip up a custom process.","<br>","Alchemists are welcome!","<br>","(advanced mode)","</p>","</a>","</li>","</ul>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.board.startScreen",["Underscore","tau/components/component.creator","tau/models/board.startScreen/model.board.startScreen","tau/ui/extensions/board.startScreen/ui.extension.board.startScreen","tau/ui/templates/board.startScreen/ui.template.board.startScreen"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[i,n],template:a};return t.create(r,e)}}}),define("tau/ui/extensions/board.main.menu/ui.extension.board.system-info",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){function n(e){return 10>e&&(e=10),(e/1e3).toFixed(2)+" s"}return i.extend({init:function(e){this.globalBus=e.bus.globalBus,this._super(e)},"bus initialize:last + afterRender:last":function(e,t,i){this.configurator=t.context.configurator,this.diagnostics=t.context.configurator.getDiagnosticsService();var a=i.element.find(".tau-changelog-link"),r=this.configurator.getChangelogController();a.click(r.show.bind(r));var s=i.element.find(".tau-system-info"),o=s.find(".tau-server-time"),l=s.find(".tau-client-time"),u=this.configurator.getDiagnosticsService(),c=u.get("page");c&&(o.html(n(c.server)),l.html(n(c.client)));var d=function(e){var t=e.data;if(t){var i=s.find(".tau-board-server-time"),a=s.find(".tau-board-client-time");i.html(n(t.server)),a.html(n(t.client)),s.find(".tau-board-time").show()}};u.on("board",d),d({data:this.diagnostics.get("board")})}})}),define("tau/ui/templates/board.main.menu/ui.template.board.system-diagnostics",["tau/core/templates-factory"],function(e){var t={name:"board.system-diagnostics",engine:"jqote2",markup:['<div class="diagnostic-report">','<div class="diagnostic-report_body">','<div class="diagnostic-report_title">Diagnostic report</div>','<div class="tau-txt i-role-diagnostics-description">',"<p>This performance diagnostic report will help us improve the performance.</p>","</div>",'<div class="i-role-loader tau-txt" style="display: none;">','<a href="#"><span class="tau-icon-general tau-icon-loading"></span>Report in progress</a>',"</div>",'<div class="tau-txt i-role-see-full-report" style="display: none;">','<a href="#">See full report</a>',"</div>",'<div class="i-role-report-body diagnostic-report_result" style="display: none;"></div>','<div class="diagnostic-report_wrap-btn diagnostic-report_bottom diagnostic-report_bottom--scroll">','<button class="tau-btn tau-primary tau-btn-large i-role-send-button" disabled="disabled" onclick="return false;">Send report</button>','<div class="wrap-textarea">','<textarea class="i-role-comment" placeholder="Share more details"></textarea>',"</div>","</div>","</div>","</div>"],dependencies:[]};
return e.register(t)}),define("tau/ui/templates/board.main.menu/ui.template.board.system-diagnostics.full-report",["tau/core/templates-factory","tau/utils/utils.date"],function(e,t){var i={name:"board.system-diagnostics.full-report",engine:"jqote2",customFunctions:{formatDate:function(e){return t.formatAs(e,"dd MMM yyyy")},formatTime:function(e){return t.formatAs(e,"hh:mm:ss tt")},formatDuration:function(e){return t.getAge(e,new Date)},jsonStringify:function(e){return JSON.stringify(e,null,4)}},markup:['<div class="diagnostic-report_result_colom">','<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th"><%=fn.formatDate(this.page.now)%><br/><%=fn.formatTime(this.page.now)%></div>','<div class="diagnostic-report_result_td">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">User</div>','<div class="diagnostic-report_result_td">#<%= this.user.id %> <%= this.user.name %></div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td"></div>','<div class="diagnostic-report_result_td"><%= this.user.email %></div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td"></div>','<div class="diagnostic-report_result_td">',"<% if (!this.user.isAdministrator) { %><strike><% } %>Administrator <% if (!this.user.isAdministrator) { %></strike><% } %>","<% if (!this.user.isObserver) { %><strike><% } %>Observer<% if (!this.user.isObserver) { %></strike><% } %>","</div>","</div>",'<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_td">Account</div>','<div class="diagnostic-report_result_td" title="<%= this.account.name %>"><span class="txt"><%= this.account.name %></span><i class="tau-version tau-version--pro"><%= this.account.edition %></i></div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Created</div>','<div class="diagnostic-report_result_td"><%= fn.formatDuration(this.page.age) %></div>',"</div>","</div>","</div>","</div>","</div>","</div>",'<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_title">','<% if (this.layout.viewMode) { %><span class="tau-icon-general tau-icon-<%= this.layout.viewMode %>"></span><% } %><%= this.layout.pageType %> view',"</div>","<% if (this.board.timing) {%>",'<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th">Load</div>','<div class="diagnostic-report_result_td"><%= this.board.timing.network %> ms</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th">Processing</div>','<div class="diagnostic-report_result_td"><%= this.board.timing.processing %> ms</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th">Context</div>','<div class="diagnostic-report_result_td"><%= this.context.selectedProjects %> project(s)</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th"></div>','<div class="diagnostic-report_result_td"><%= this.context.selectedTeams %> team(s)</div>',"</div>","<% if (this.layout.cards) { %>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th"></div>','<div class="diagnostic-report_result_td"><%= this.layout.cards %> card(s)</div>',"</div>","<%}%>","</div>","<% } %>",'<div class="diagnostic-report_result_link">','<a href="<%= this.page.location %>"><%= this.page.location %></a>',"</div>",'<div class="diagnostic-report_result_table">',"<% if (this.board.boardDefinition) {%>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th">Settings</div>','<div class="diagnostic-report_result_td"><pre class="diagnostic-report_result_row_json"><%= fn.jsonStringify(this.board.boardDefinition) %></pre></div>',"</div>","<% };%>","<% _.forEach(this.board.cardsData, function(data) {%>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th"><%= data.typeName %> card</div>','<div class="diagnostic-report_result_td"><%= data.data %></div>',"</div>","<% });%>","</div>","</div>","</div>",'<div class="diagnostic-report_result_colom">',"<% if (this.serverUsage) {%>",'<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_th">Server configuration</div>','<div class="diagnostic-report_result_td"><%= this.os.VersionString %></div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th"></div>','<div class="diagnostic-report_result_td">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td" style="width: 100px">Available RAM:</div>','<div class="diagnostic-report_result_td"><%= this.serverUsage.availableRam.toFixed(2) %> <span class="tau-text_type_gray">of <%= this.serverUsage.totalRam.toFixed(2) %> GB</span></div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">CPU usage:</div>','<div class="diagnostic-report_result_td"><%= this.serverUsage.cpu.toFixed(2) %>%</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Free disk space:</div>','<div class="diagnostic-report_result_td"><%= this.serverUsage.diskFreeSpace.toFixed(2) %> <span class="tau-text_type_gray">of <%= this.serverUsage.diskSize.toFixed(2) %> GB</span></div>',"</div>","</div>","</div>","</div>","</div>","</div>","<% }%>",'<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_th">Network</div>','<div class="diagnostic-report_result_td">','<div class="diagnostic-report_result_table">',"<% if (this.browser.timing && this.browser.timing.network) { %>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Page load</div>','<div class="diagnostic-report_result_td"><%= this.browser.timing.network %> ms</div>',"</div>","<% } %>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Latency</div>','<div class="diagnostic-report_result_td"><%= this.network.latency.toFixed(0) %> ms</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Speed benchmark</div>','<div class="diagnostic-report_result_td"><%= this.network.speed %> ms</div>',"</div>","</div>","</div>","</div>","</div>","</div>",'<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_th">Browser</div>','<div class="diagnostic-report_result_td"><%= this.browser.userAgent %></div>',"</div>",'<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_th"></div>','<div class="diagnostic-report_result_td"><%= this.browser.platform %>, <%= this.browser.language %></div>',"</div>",'<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_th">Performance</div>','<div class="diagnostic-report_result_td">','<div class="diagnostic-report_result_table">',"<% if (this.browser.timing && this.browser.timing.processing) { %>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Page processing</div>','<div class="diagnostic-report_result_td"><%= this.browser.timing.processing %> ms</div>',"</div>","<% } %>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">JS benchmark</div>','<div class="diagnostic-report_result_td"><%= this.browser.benchmark %> ms</div>',"</div>","</div>","</div>","</div>","<% if (this.browser.memory) { %>",'<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_th">Memory</div>','<div class="diagnostic-report_result_td">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Heap size limit</div>','<div class="diagnostic-report_result_td"><%= this.browser.memory.jsHeapSizeLimit.toFixed(2) %> MB</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Used heap size</div>','<div class="diagnostic-report_result_td"><%= this.browser.memory.usedJSHeapSize.toFixed(2) %> MB</div>',"</div>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td">Total heap size</div>','<div class="diagnostic-report_result_td"><%= this.browser.memory.totalJSHeapSize.toFixed(2) %> MB</div>',"</div>","</div>","</div>","</div>","<% } %>","</div>","</div>",'<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_table">','<div class="diagnostic-report_result_row space">','<div class="diagnostic-report_result_th"><%= this.mashups.length%> mashups</div>','<div class="diagnostic-report_result_td">',"<% _.forEach(this.mashups, function(mashup) {%>","<%= mashup %><br>","<% });%>","</div>","</div>","</div>","</div>","<% if (this.errors.length > 0) {%>",'<div class="diagnostic-report_result_item">','<div class="diagnostic-report_result_title">Activity log</div>','<div class="diagnostic-report_result_table diagnostic-report_activity-log">',"<%  _.each(this.errors, function(day) { %>","<%  _.each(day.errors, function(error, index) { %>",'<div class="diagnostic-report_result_row">','<div class="diagnostic-report_result_td"><%= index === 0 ? fn.formatDate(day.date) : "" %></div>','<div class="diagnostic-report_result_td">','<span class="tau-text_type_gray"><%= fn.formatTime(error.timestamp) %></span>',"</div>",'<div class="diagnostic-report_result_td">error: <%= error.message %><br><%= error.uri %>:<%= error.line %><br><%= error.page %></div>',"</div>","<% }); %>","<% }); %>","</div>","</div>","<% } %>","</div>"],dependencies:[]};
return e.register(i)}),define("tau/ui/extensions/board.main.menu/ui.extension.board.system-diagnostics",["jQuery","Underscore","tau/core/extension.base","tp/mashups","tau/ui/templates/board.main.menu/ui.template.board.system-diagnostics","tau/ui/templates/board.main.menu/ui.template.board.system-diagnostics.full-report","app.path","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/services/customize/service.customize.card.layout.factory","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n,a,r,s,o,l,u){return i.extend({init:function(e){this._super(e),this.initialized=!1},"bus afterRender:last + initialize:last + boardSettings.ready":function(e,t,i,n){this._configurator=i.context.configurator,this.diagnostics=this._configurator.getDiagnosticsService(),this._window=this._configurator.getWindow(),this._$systemInfo=t.element.find(".tau-system-info"),this._layoutFactory=new l(this._configurator,n.boardSettings),this.initialized||(this._$systemInfo.find(".i-role-diagnostic").click(this._collectDiagnosticData.bind(this)),this.initialized=!0),this._boardSettings=n.boardSettings.settings,this.fire("system.diagnostics.report.initialized")},_collectDiagnosticData:function(){var i=a.render(),n=i.find(".i-role-see-full-report"),s=function(t){n.click(function(){t.find(".i-role-report-body").show(),e(this).hide(),e(".i-role-diagnostics-description").hide()})};s(i);var o=i.find(".i-role-loader");o.show();var l=i.find(".i-role-report-body"),u=e.when(this.diagnostics.networkLatency(),this.diagnostics.networkSpeed(),this._urlContext(),this._boardDefinition(),this.diagnostics.serverUsage(),this._cardsSettings());u.then(function(e,a,s,u,c,d){var p=this._configurator.getLoggedUser(),f={id:p.id,name:p.name,email:p.email,isAdministrator:p.isAdministrator||!1,isObserver:p.isObserver||!1},m={name:this._window.location.host,edition:this._window.tauSystemInfo.edition},h={location:this._window.location.href,timestamp:e.timestamp,age:this._window.tauServerInfo.created,now:new Date},g={latency:e.latency,speed:a.speed},v="context"===s.__type?{processes:s.processes.length,projects:s.projectIdsAvailable.length,selectedProjects:s.selectedProjects.length,teams:s.teamIdsAvailable.length,selectedTeams:s.selectedTeams.length}:"Couldn't get context",b=this.diagnostics.get("board"),y={boardDefinition:u.data,cardsData:d?this._adaptCardsData(d):null,timing:b?{network:b.server,processing:b.client}:null},_={page:h,network:g,context:v,board:y,os:this._window.tauSystemInfo.os,serverUsage:t.isEmpty(c)?null:c,mashups:this._listInstalledMashups(),browser:this.diagnostics.browser(),user:f,account:m,layout:this._pageTypeInfo(),errors:this._getErrors()},x=r.render(_);
l.html(x);var w=i.find(".i-role-send-button");w.removeAttr("disabled").click({data:_,popup:i},this._sendReport.bind(this)),o.hide(),n.show(),this.fire("system.diagnostics.report.rendered",{element:i})}.bind(this)),this._renderReport(i)},_getErrors:function(){var e=this._window.getJavascriptErrors?this._window.getJavascriptErrors():[];return t.chain(e.reverse()).groupBy(function(e){var t=new Date(Date.parse(e.timestamp));return new Date(t.getFullYear(),t.getMonth(),t.getDate())}).map(function(e,t){return{date:new Date(t),errors:e}}).value()},_adaptCardsData:function(e){var i=new o,n=function(e){return t.map(t.keys(e),function(t){return{typeName:t,data:i.build(t,e[t])}})};return e.length?t.flatMap(e,function(e){return n(e)}):n(e)},_cardsSettings:function(){var t=[],i=function(e,i){e.length>0&&t.push(this._layoutFactory.getCardLayoutsByTypesAndSize(e,i))}.bind(this);return"newlist"===this._boardSettings.viewMode?(i(this._boardSettings.cells.types,"list"),i(this._boardSettings.x.types,"list"),i(this._boardSettings.y.types,"list")):i(this._boardSettings.cells.types,u.zoomToSize(this._boardSettings.zoomLevel)),e.when.apply(this,t)},_sendReport:function(e){var t=e.data.popup,i=t.find(".i-role-comment"),n=t.find(".i-role-send-button"),a=e.data.data;a.comment=i.val(),n.text("Sending..."),this.diagnostics.sendReport(a).done(function(){n.text("Sent").attr("disabled","disabled"),i.attr("disabled","disabled"),this.fire("notification",{$node:"<h3>Report sent successfully</h3>"}),this.fire("system.diagnostics.report.sent")}.bind(this)).fail(function(){n.text("Send report"),this.fire("error",{$node:"<h3>There was an error sending report</h3>"}),this.fire("system.diagnostics.report.failed")}.bind(this))},_renderReport:function(e){e.tauPopup({className:"ui-popup_gray",hideOnEscape:!0,popupContent:e}),e.tauPopup("show")},_listInstalledMashups:function(){var e=n.prototype.getRegisteredMashups();return t.map(e,function(e,t){var i=n.prototype.getFolderPathFromKey(t),a=i.split("/");return a[a.length-2]
})},_urlContext:function(){var e=this._configurator.getAppStateStore().settings.acid;return this._configurator.getApplicationContextService().getApplicationContext({acid:e})},_boardDefinition:function(){var t=/(?:=board\/(\d+))/.exec(location.hash),i=t&&t[1];return i?this._configurator.getBoardDefinitionFactory().boardService.getBoardData(i):e.Deferred().resolve({data:null})},_pageTypeInfo:function(){if("none"===this._boardSettings.id)return{pageType:"Entity"};var t=e("body").find(".i-role-board-body"),i={board:"Board",list:"Details",timeline:"Timeline",newlist:"List"};return{viewMode:this._boardSettings.viewMode,pageType:i[this._boardSettings.viewMode],cards:t.find(".i-role-card").length}}})}),define("tau/components/component.board.system-info",["tau/components/component.creator","jQuery","tau/utils/utils.date","tau/ui/extensions/board.main.menu/ui.extension.board.system-info","tau/ui/extensions/board.main.menu/ui.extension.board.system-diagnostics","tau/components/extensions/error/extension.errorBar"],function(e,t,i,n,a,r){return{create:function(t){var s={name:"board.system-info",engine:"jqote2",customFunctions:{dateToString:function(e){return i.formatAs(e,"MMM dd, yyyy")}},markup:['<ul class="tau-user-submenu">','<li class="tau-system-info">','<table class="tau-system-info_table">',"<tr>","<th>Load time</th>","<th>Server</th>","<th>Client</th>","</tr>","<tr>","<td>Page</td>",'<td><span class="tau-server-time">...</span></td>','<td><span class="tau-client-time">...</span></td>',"</tr>","<tr>","<td>View</td>",'<td><span class="tau-board-server-time">...</span></td>','<td><span class="tau-board-client-time">...</span></td>',"</tr>","</table>",'<button class="tau-btn i-role-diagnostic" onclick="return false;">Get diagnostic report</button>','<div class="tau-line">','<span class="tau-version">Version <%= window.tauSystemInfo.version %></span>','<span class="tau-date">Updated on <%= fn.dateToString(window.tauSystemInfo.date) %></span>','<a class="tau-changelog-link" href="#">What is new?</a>',"</div>","</li>","</ul>"]},o={extensions:[n,a,r],template:s},l=e.create(o,t);
return l.fire("dataBind",{}),l}}}),define("tau/models/tags/tagsProcessor",["tau/core/class"],function(e){return e.extend({init:function(){},asArray:function(e){return this._process(e)},asString:function(e){var t=this._process(e);return t.join(", ")},_process:function(e){return _.isString(e)&&(e=e.split(",")),e=_.map(e,function(e){return _.trim(e)}),e=_.compact(e),e=_.uniq(e,!1,function(e){return e.toLowerCase()})}})}),define("tau/models/board.templates.editor/model.board.templates.editor",["Underscore","tau/core/extension.base","tau/models/tags/tagsProcessor"],function(e,t,i){return t.extend({fieldsToClone:["cells","x","y","zoomLevel","viewMode","cardSettings","timelineSettings"],"bus beforeInit":function(t,n){var a=n.config.context.configurator;this.fire("configurator.ready",a),this.fire("dataBind",{}),this.fire("tagsProcessor.ready",new i);var r=e.defaults(n.config.options||{},{groupName:"boardTemplates"});this.fire("options.ready",r)},"bus boardSettings.ready:last + form.submitted":function(t,i){var n=i.boardSettings;n.get({fields:this.fieldsToClone,callback:e.bind(function(e){this.fire("boardData.ready",e)},this)})},"bus options.ready:last + configurator.ready:last + tagsProcessor.ready:last + boardData.ready + form.submitted":function(t,i,n,a,r,s){var o=n.getRestStorage(),l={name:e.asString(s.name).trim().slice(0,50),description:e.asString(s.description).trim().slice(0,255),tags:a.asArray(a.asArray(s.tags).concat(["custom"])),definition:e.pick(r,this.fieldsToClone),numericPriority:(new Date).getTime()};l.name.length?o.data(i.groupName,void 0,{scope:"Public",publicData:l}).done(e.bind(function(e){this.fire("form.processed",e)},this)):this.fire("form.failed",{name:"Should not be empty"})}})}),define("tau/ui/extensions/board.templates.editor/ui.extension.board.templates.editor",["Underscore","jQuery","tau/core/extension.base","libs/jquery/jquery.placeholder"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){var i=t.element;this.fire("$el.ready",i)},"bus boardSettings.ready + $el.ready":function(t,i,n){var a=i.boardSettings,r=n.find(".i-role-formtrigger"),s=n.find("form"),o=n.find(".i-role-formholder").detach();
r.tauBubble({zIndex:120,content:o,onShow:function(){s.find(":text:first").focus(),a.get({fields:["name"],callback:function(t){s.find("[name=name]").val(e.asString(t.name))}})}}),this.fire("$form.ready",s),this.fire("$bubbled.ready",r)},"bus $form.ready":function(i,n){n.placeholder(),n.on("submit",e.bind(function(e){e.preventDefault();var i={};t(e.currentTarget).find(":input").each(function(){i[this.name]=this.value}),this.fire("form.submitted",i)},this))},"bus $bubbled.ready:last + $form.ready:last + form.processed":function(e,t,i){this.fire("notification",{message:"View template was added"}),t.tauBubble("hide"),i.trigger("reset")},"bus $bubbled.ready:last + $form.ready:last + form.failed":function(t,i,n,a){var r=n.find(":input");r.removeClass("tau-error"),e.forEach(a,e.bind(function(e,t){r.filter("[name="+t+"]").addClass("tau-error"),this.fire("error",{message:e})},this)),r.filter(".tau-error:first").focus()}})}),define("tau/ui/templates/board.templates.editor/ui.template.board.templates.editor",["tau/core/templates-factory"],function(e){var t={name:"board.templates.editor",engine:"jqote2",markup:['<div class="tau-inline-group tau-board-save-template">',"<div>",'<button type="button" class="tau-btn tau-save-template i-role-formtrigger">Save as Template</button>',"</div>",'<div class="tau-save-template-form i-role-formholder">',"<form>",'<div class="tau-field"><input type="text" class="tau-in-text" placeholder="Name" name="name"></div>','<div class="tau-field"><textarea placeholder="Description" class="tau-in-text" name="description"></textarea></div>','<div class="tau-field"><input type="text" class="tau-in-text" placeholder="Tags, comma separated" name="tags"></div>','<div class="tau-field"><button class="tau-btn" type="submit">Save</button></div>',"</form>","</div>","</div>"]};return e.register(t)}),define("tau/components/component.board.templates.editor",["Underscore","tau/components/component.creator","tau/models/board.templates.editor/model.board.templates.editor","tau/ui/extensions/board.templates.editor/ui.extension.board.templates.editor","tau/components/extensions/error/extension.errorBar","tau/ui/templates/board.templates.editor/ui.template.board.templates.editor"],function(e,t,i,n,a,r){return{create:function(e){var s={extensions:[i,n,a],template:r},o=t.create(s,e);
return o}}}),define("tau/models/board.templates.selector/model.board.templates.selector",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t,i){var n=i.config.context.configurator,a=e.defaults(i.config.options||{},{groupName:"boardTemplates",sliceTagsAt:!1});this.fire("configurator.ready",n),this.fire("options.ready",a),this.fire("itemsDefault.ready",[])},"bus options.ready + configurator.ready":function(t,i,n){var a=n.getRestStorage();a.removeAllListeners(this),a.on("afterInsert",function(e){e.data.$group==i.groupName&&this.fire("refresh")},this),a.on("afterRemove",function(e){e.data.$group==i.groupName&&this.fire("item.remove.completed",e.data.id)},this),a.select(i.groupName,{$fields:["key","publicData.name","publicData.description","publicData.tags","publicData.definition","publicData.numericPriority","publicData.previewName"],$limit:{start:0,max:10}}).done(e.bind(function(e){this.fire("itemsCustom.ready",e.data)},this))},"bus itemsDefault.ready + itemsCustom.ready":function(t,i,n){var a=i.concat(n);e.each(a,function(e,t){e.id=t}),this.fire("items.ready",a)},"bus configurator.ready + options.ready + items.ready":function(t,i,n,a){var r=[{name:"All",count:99999,isSelected:!0},{name:"Scrum",count:99998},{name:"Kanban",count:99997},{name:"Custom",count:99996}],s=e.reduce(a,function(e,t){return e.concat(t.tags||[])},[]);s=e.groupBy(s,function(e){return e.toLowerCase()}),s=e.map(s,function(e){return{name:e[0],count:e.length}}),r=r.concat(s),r=e.uniq(r,!1,function(e){return e.name.toLowerCase()}),r=e.sortBy(r,function(e){return-e.count});var o=e.reduce(r,function(e,t,i){return e[i+1]=(e.length?e[i]:0)+t.name.length+5,e},[0]),l=($("body").width()-600)/10,u=e.find(o,function(e){return e>l}),c=e.indexOf(o,u),d=n.sliceTagsAt||(0>c?o.length:c),p=i.getApplicationPath(),f=i.getLoggedUser();a=e.sortBy(a,"numericPriority"),a=e.map(a,function(e,t){return{id:e.id,name:e.name,description:e.description||"",previewSrc:p+"/JavaScript/tau/css/images/board_templates/"+(e.previewName||"default.png"),access:{remove:t>0&&f.isAdministrator?!0:!1}}
});var m=r.slice(d);m=e.sortBy(m,function(e){return e.name.toLowerCase()}),this.fire("dataBind",{items:a,tags:r.slice(0,d),moreTags:m})},"bus boardSettings.ready:last + items.ready:last + item.selected":function(t,i,n,a){var r=i.boardSettings,s=n[a];if(s){var o=s.definition;o.name=s.name,o.viewMode=o.viewMode||"board",e.forEach(["cells","x","y"],function(t){o[t]=o[t]||{types:[]},o[t]&&(o[t]=e.defaults(o[t],{types:[],ordering:null,filter:""}))}),o&&r.setDef({set:o}).done(e.bind(function(){this.fire("board.template.selected",o),this.fire("item.selected.completed",a)},this))}},"bus configurator.ready:last + options.ready:last + items.ready:last + item.remove":function(t,i,n,a,r){var s=e.find(a,function(e){return e.id==r});if(s){var o=i.getRestStorage();o.remove(n.groupName,{id:s.id,$key:s.key}).done()}},"bus configurator.ready > destroy":function(e,t){var i=t.getRestStorage();i.removeAllListeners(this)}})}),define("tau/ui/extensions/board.templates.selector/ui.extension.board.templates.selector.main",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({resetLifecycle:!0,"bus afterRender":function(e,t){var i=t.element;this.fire("confirmation.toggle",!0),this.fire("$el.ready",i),this.fire("$list.ready",i.find(".tau-templates-body")),this.fire("$items.ready",i.find(".i-role-item"))},"bus $items.ready":function(e,t){var i=this;t.find(".i-role-tabheader").on("click",function(e){e.stopPropagation(),i.fire("setup.pressed")})},"bus $el.ready:last + $items.ready:last + confirmation.toggle":function(t,i,n,a){var r=this,s=i.data("confirmation");s!=a&&(n.each(function(){var t=e(this),i=t.data("id"),a=t.tauBubble({template:['<div class="tau-bubble tau-warning-bubble">','<div class="tau-bubble__inner tau-container"  role="content"></div>',"</div>"].join(""),content:["<h3>This View settings will be reset and new template will be applied. Do you want to do that?</h3>",'<div class="tau-buttons">','<button class="tau-btn tau-attention i-role-actionok">Ok</button>','<button class="tau-btn i-role-actioncancel">Cancel</button>',"</div>"].join(""),onPositionConfig:function(e){e.my="center center",e.at="center center"
},onBeforeShow:function(){return t.hasClass("tau-template-item-checked")?!1:void 0},onHide:function(){t.toggleClass("tau-template-item_hover",!1)},onShow:function(){t.toggleClass("tau-template-item_hover",!0);var e=a.tauBubble("widget");e.unbind("click"),e.one("click",".i-role-actioncancel",function(){a.tauBubble("hide")}),e.one("click",".i-role-actionok",function(){n.not(t).removeClass("tau-template-item-checked"),t.toggleClass("tau-template-item-checked",!0),a.tauBubble("hide"),r.fire("item.selected",i)})},zIndex:130})}),a?(n.tauBubble("enable"),n.unbind("click.boardTemplates")):(n.tauBubble("disable"),n.on("click.boardTemplates",function(){var t=e(this),i=t.data("id");n.not(t).removeClass("tau-template-item-checked"),t.toggleClass("tau-template-item-checked",!0),r.fire("item.selected",i)})),i.data("confirmation",!!a))},"bus $el.ready:last + $list.ready:last + $items.ready:last + external.setFocusOnSelected":function(e,t,i,n){var a=n.filter(".tau-template-item-checked");a.length&&i.scrollTo(a)},"bus $el.ready:last + $list.ready:last + $items.ready:last + external.selectDefault":function(e,t,i,n){var a=n.first().toggleClass("tau-template-item-checked",!0);a.length&&i.scrollTo(a)},"bus $el.ready:last + $list.ready:last + $items.ready:last + external.selectNone":function(e,t,i,n){n.filter(".tau-template-item-checked").toggleClass("tau-template-item-checked",!1)}})}),define("tau/ui/extensions/board.templates.selector/ui.extension.board.templates.selector.filter",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready":function(e,i){var n=this,a=i.find("form.i-role-filterform"),r=a.find("[name=tag]");a.on("submit",function(e){e.preventDefault(),n.fire("filter.submitted",t(this).serializeArray())}),i.delegate("input[name=name]","keyup",function(){a.submit()}),i.delegate("input[name=name]","keydown",function(e){e.keyCode==t.ui.keyCode.ESCAPE&&e.stopPropagation(),e.which==t.ui.keyCode.ENTER&&t(this).trigger("blur")});var s=i.find(".i-role-moretagstrigger"),o=i.find(".i-role-moretagslist").detach();
i.on("click",".i-role-tag",function(){var e=t(this);i.find(".i-role-tag.tau-active").not(this).toggleClass("tau-active",!1),e.toggleClass("tau-active",!0),r.val(e.text()),a.submit()}),s.length&&(i.on("click",".i-role-tag",function(){s.toggleClass("tau-active",!1),s.text(s.data("labelText"))}),s.tauBubble({zIndex:130,content:o}),o.find("ul").css("maxHeight",.4*t(window).height()),o.on("click",".i-role-tag",function(){i.find(".i-role-tag.tau-active").not(this).toggleClass("tau-active",!1);var e=t(this),n=e.text();s.toggleClass("tau-active",!0),s.text(n),s.tauBubble("hide"),r.val(e.text()),a.submit()}))},matchName:function(t,i){var n=t.toLowerCase();return 0==i.length||e.any(i,function(e){return n.indexOf(e)>=0})},matchTag:function(t,i){var n=t.toLowerCase();return 0==i.length||e.any(i,function(e){return n==e})},"bus $el.ready:last + items.ready:last + filter.submitted":function(t,i,n,a){var r={};e.forEach(a,function(e){r[e.name]=e.value});var s={name:e.compact(e.trim(r.name).toLowerCase().split(/\s+/g)),tag:e.compact("all"!=e.trim(r.tag).toLowerCase()?[e.trim(r.tag).toLowerCase()]:[])},o={name:this.matchName,tag:this.matchTag},l=i.find(".i-role-item"),u=0;e.any(s,function(e){return e.length>0})?(e.forEach(n,function(t){var i=0==t.tags.length&&0==s.tag.length||e.any(t.tags||[],function(e){return o.tag(e,s.tag)}),n=o.name(t.name,s.name)||o.name(t.description,s.name),a=i&&n,r=l.filter("[data-id="+t.id+"]");a&&r.length&&(u+=1),r.toggleClass("tau-templates-settings__item_filtered_false",!a),r.toggleClass("tau-templates-settings__item_filtered_true",a)}),i.toggleClass("tau-templates-settings_filtered_none",0==u)):(i.toggleClass("tau-templates-settings_filtered_none",!1),l.toggleClass("tau-templates-settings__item_filtered_false",!1),l.toggleClass("tau-templates-settings__item_filtered_true",!1)),this.fire("filter.completed")}})}),define("tau/ui/extensions/board.templates.selector/ui.extension.board.templates.selector.remove",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus $items.ready":function(t,i){var n=this;
i.each(function(){var t=e(this),i=t.find(".i-role-actionremove"),a=i.parents(".i-role-item:first").data("id"),r=i.tauBubble({template:['<div class="tau-bubble tau-warning-bubble">','<div class="tau-bubble__arrow"  role="arrow"></div>','<div class="tau-bubble__inner tau-container"  role="content"></div>',"</div>"].join(""),content:["<h3>Do you really want to delete this template?</h3>",'<div class="tau-buttons">','<button class="tau-btn tau-danger i-role-actionok">Delete</button>','<button class="tau-btn i-role-actioncancel">Cancel</button>',"</div>"].join(""),onPositionConfig:function(e){e.my="center top",e.at="center-70 bottom"},onHide:function(){t.toggleClass("tau-template-item_hover",!1)},onShow:function(){t.toggleClass("tau-template-item_hover",!0);var e=r.tauBubble("widget");e.unbind("click"),e.one("click",".i-role-actioncancel",function(){r.tauBubble("hide")}),e.one("click",".i-role-actionok",function(){r.tauBubble("hide"),n.fire("item.remove",a)})},zIndex:130})})},"bus $el.ready:last + item.remove.completed":function(e,t,i){t.find(".i-role-item[data-id="+i+"]").remove(),t.find("form.i-role-filterform").submit()}})}),define("tau/ui/templates/board.templates.selector/ui.template.board.templates.selector",["tau/core/templates-factory"],function(e){var t={name:"board.templates.selector",engine:"jqote2",markup:['<div class="tau-templates-settings">','<div class="tau-board-settings-group__help">','<span class="tau-help i-role-tooltipArticle" data-article-id="board.templates">',"About Templates","</span>","</div>",'<div class="tau-templates-header">','<form class="i-role-filterform">','<span class="tau-inline-group tau-search">','<input type="text" name="name" placeholder="Search templates" class="tau-in-text">','<input type="hidden" name="tag" />','<button type="submit" class="tau-btn tau-search"></button>',"</span>",'<div class="tau-templates-tags">','<ul class="i-role-tagslist">',"<% _.forEach(this.tags, function(item) { %>",'<li class="i-role-tag <% if (item.isSelected) { %>tau-active<% } %> tau-extension-board-tooltip" data-title="Browse template categories">',"<span><%! item.name %></span>","</li>","<% }); %>","<% if (this.moreTags.length) { %>",'<li class="tau-more i-role-moretagstrigger tau-extension-board-tooltip" data-title="Browse template categories" data-label-text="more"><span>more</span></li>',"<% } %>","</ul>","</div>","<% if (this.moreTags.length) { %>",'<div class="tau-template-tags-list  i-role-moretagslist">','<ul class="tau-templates-tags">',"<% _.forEach(this.moreTags, function(item){ %>",'<li class="i-role-tag">',"<span><%! item.name %></span>","</li>","<% }); %>","</ul>","</div>","<% } %>","</form>","</div>",'<div class="tau-templates-body">',"<% _.forEach(this.items, function(item, k) { %>",'<div class="tau-template-item i-role-item" data-id="<%= item.id %>">','<div class="tau-template-item__inner tau-extension-board-tooltip" data-title="Click to apply a template">',"<% if (item.access.remove) { %>",'<button type="button" data-title="Delete template" class="tau-button-link tau-delete i-role-actionremove tau-extension-board-tooltip tau-extension-board-tooltip-inner"></button>',"<% } %>",'<div class="tau-template-preview">','<img height="50" width="83" alt="" src="<%= item.previewSrc %>">','<button type="button" class="tau-btn tau-primary i-role-tabheader" data-label="setup">Setup</button>',"</div>",'<div class="tau-template-name"><%! item.name %></div>','<div class="tau-template-desc"><%! item.description %></div>',"</div>","</div>","<% }); %>","</div>",'<div class="tau-templates-settings__message" data-text-nofound="No such template found" data-text-noitems="No available templates"></div>',"</div>"]};
return e.register(t)}),define("tau/components/component.board.templates.selector",["Underscore","tau/components/component.creator","tau/models/board.templates.selector/model.board.templates.selector","tau/ui/extensions/board.templates.selector/ui.extension.board.templates.selector.main","tau/ui/extensions/board.templates.selector/ui.extension.board.templates.selector.filter","tau/ui/extensions/board.templates.selector/ui.extension.board.templates.selector.remove","tau/ui/templates/board.templates.selector/ui.template.board.templates.selector"],function(e,t,i,n,a,r,s){return{create:function(e){var o={extensions:[i,n,a,r],template:s},l=t.create(o,e);return l}}}),define("tau/models/const.view.modes",{LIST:"newlist",BOARD:"board",DETAILS:"list",TIMELINE:"timeline"}),define("tau/models/board.toolbar/model.board.toolbar",["Underscore","tau/core/model-base","tau/models/board.editor/board.filter.help","tau/models/const.view.modes"],function(e,t,i,n){return t.extend({"bus beforeInit":function(e){var t=e.data.config.context.configurator;this.fire("configurator.ready",t)},"bus afterInit + boardSettings.ready:last + configurator.ready:last":function(t,a,r,s){var o=r.boardSettings,l=s.getLoggedUser(),u=s.getBoardAccessService(),c=e.bind(function(t,i){var r=t.cells||{types:[]};r.name="cells",r.filter=t.user&&t.user.cardFilter?t.user.cardFilter:"";var o=t.viewMode,c=o===n.BOARD||o===n.DETAILS,d=function(t){return t&&e.contains(t.types,"entitystate")},p=(d(t.x)||d(t.y))&&s.loggedUser.isAdministrator;r.predefinedFilters=i,this.fire("cell.types",r.types),this.fire("dataBind",{name:t.name,isShared:t.isShared,viewMode:t.viewMode,isPrintable:c,canSetupStates:p,cells:r,zoom:{value:t.zoomLevel,min:a.config.min,max:a.config.max},isEditable:u.isEditable(t,l)})},this);o.get({fields:["ownerIds","user","id","name","isShared","viewMode","zoomLevel","cells","x","y"],callback:function(e){(new i).get({cells:e.cells}).done(function(t){c(e,t.cells||[])})}}),o.unbind({listener:this}),o.bind({fields:["cells"],listener:this,callback:e.bind(function(e){this.fire("cell.types",e.cells.types)
},this)}),o.bind({listener:this,fields:["x","y"],callback:function(){this.fire("refresh")}.bind(this)}),s.getAppStateStore().unbind({listener:this}),s.getAppStateStore().bind({fields:["acid"],listener:this,callback:function(){this.fire("refresh")}.bind(this)})},"bus configurator.ready:last + user.filter.changed":function(e,t,i){t.service("boardSettings").set({set:{user:{cardFilter:i}}})},"bus boardSettings.ready:last + configurator.ready:last + destroy":function(e,t,i){t.boardSettings.unbind({listener:this}),i.getAppStateStore().unbind({listener:this})}})}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.focus",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils","Underscore"],function(e,t,i,n){return t.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus boardSettings.ready:last + afterRender":function(t){var i=n.values(t)[0].data.boardSettings,a=n.values(t)[1].data.element,r=a.find("[role=action-focus]"),s=a.find("[role=action-unfocus]"),o=function(e,t){e.removeClass("tau-btn-active-highlight"),t&&e.addClass("tau-btn-active-highlight")},l=function(){i.get({fields:["focus","selectedMarks"],callback:function(e){var t=n.defaults(e.selectedMarks||{},{x:[],y:[]}),i=!(!t.x.length&&!t.y.length);r.prop("disabled",!i),o(r,i);var a=n.defaults(e.focus||{},{x:[],y:[]}),l=!(!a.x.length&&!a.y.length);s.prop("disabled",!l),o(s,l)}})};i.unbind({listener:this}),i.bind({fields:["focus","selectedMarks"],skipSilentCallsFiltering:!0,listener:this,callback:l}),i.get({fields:["focus","selectedMarks"],callback:l});var u=function(e){i.get({fields:["focus","selectedMarks"],callback:function(t){var n=t.focus||{x:[],y:[]},a=t.selectedMarks||{x:[],y:[]};e?(a.x.length>0&&(n.x=a.x),a.y.length>0&&(n.y=a.y)):n={x:[],y:[]},i.set({set:{focus:n,selectedMarks:{x:[],y:[]}}})}})};r.on("click",function(){var t=u(!0);return e(this).blur(),t}),s.on("click",function(){var t=u(!1);
return e(this).blur(),t})}})}),define("tau/models/board.toolbar/model.board.toolbar.zoom",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({"bus boardSettings.ready":function(t,i){var n=i.boardSettings;n.unbind({listener:this}),n.bind({fields:["zoomLevel"],listener:this,callback:e.bind(this.onZoomLevelUpdated,this)}),n.get({fields:["zoomLevel"],callback:e.bind(this.onDataReady,this)})},onDataReady:function(e){var t=this.normalize(e.zoomLevel,this.config);this.isValid(t,this.config)&&this.fire("zoom.provided",{value:t})},onZoomLevelUpdated:function(e){var t=this.normalize(e.zoomLevel,this.config);this.isValid(t,this.config)&&this.fire("zoom.provided",{value:t})},"bus boardSettings.ready:last + zoom.updated":function(e,t,i){var n=t.boardSettings,a=this.normalize(i.value,this.config);this.isValid(a,this.config)&&n.get({fields:["zoomLevel"],callback:function(e){e.zoomLevel!=a&&n.set({set:{zoomLevel:a}})}})},"bus boardSettings.ready + destroy":function(e,t){this.onDataReady=function(){};var i=t.boardSettings;i.unbind({listener:this})},isValid:function(e,t){return t.hasOwnProperty("min")&&e<t.min?!1:t.hasOwnProperty("max")&&e>t.max?!1:void 0!=e},normalize:function(e,t){if(t.hasOwnProperty("min")&&t.hasOwnProperty("max")){if(void 0==e)return t.defaultValue;if(e<t.min)return this.config.min;if(e>t.max)return t.max}return e}});return i}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.zoom",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(t){var i=t.data.element,n=i.find("[role=zoomer]"),a={max:n.data("zoomMax"),min:n.data("zoomMin"),animate:!0,slide:e.bind(this.onSliderSlide,this),change:e.bind(this.onSliderChange,this),value:n.data("zoomValue")};n.slider(a)},onSliderSlide:function(e){t(e.target).slider("option","disabled")&&e.preventDefault()},onSliderChange:function(e,t){var i=this;i.bus.fire("zoom.updated",{value:t.value})},"bus afterRender:last+zoom.provided":function(t){var i=e.values(t)[0].data.element,n=e.values(t)[1].data,a=i.find("[role=zoomer]"),r=a.slider("value");
r!=n.value&&a.slider("value",n.value)}})}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.userFilter",["Underscore","jQuery","tau/ui/extensions/board.editor/ui.extension.board.editor.autocomplete","tau/ui/extensions/board.plus/ui.board.plus.utils","libs/jquery/jquery.placeholder","libs/jquery/jquery.tau.resetableInput","libs/jquery/jquery.toggleFilter"],function(e,t,i){return i.extend({SHORT_PLACEHOLDER:"filter off","bus afterRender":function(e,t){var i=t.element,n=i.find(".i-role-filter-input");this.defaultPlaceholder=n.attr("placeholder"),n.attr("placeholder",this.SHORT_PLACEHOLDER),n.tauResetableInput({showAlways:!0}).placeholder(),i.find(".i-role-filter-control").toggleFilter({additionalClass:"tau-boardsettings__filter_hide-toggle",defaultExpand:!0}),this.fire("$form.ready",i),this.fire("$el.ready",i)},"bus $el.ready":function(e,i){var n=this.$filter=i.find("[name=cells_filter]");this.$filterControl=i.find(".i-role-filter-control"),n.on("focus",function(){this.fire("preloading.execute"),this.expandFilter()}.bind(this)),n.on("_change clear",function(){var e=n.val();this.updateFilterState(e),this.fire("user.filter.changed",e)}.bind(this)),i.on("keydown","[name=cells_filter]",function(e){e.which==t.ui.keyCode.ENTER&&t(e.target).blur(),(e.which==t.ui.keyCode.ENTER||e.which==t.ui.keyCode.TAB)&&this.shrinkFilter()}.bind(this)),this.updateFilterState()},"bus cell.types + afterRender:last + view.dom.ready:last":function(e,i,n){t("[name=cells_filter]",n.element).prop("disabled",0===i.length),t(".i-role-help",n.element).prop("disabled",0===i.length)},expandFilter:function(){this.$filterControl.addClass("active"),this.$filter.attr("placeholder",this.defaultPlaceholder),t(document).off("mousedown.expandFilter").on("mousedown.expandFilter",e.bind(this.onDocumentClick,this))},shrinkFilter:function(){this.$filterControl.removeClass("active"),this.$filter.attr("placeholder",this.SHORT_PLACEHOLDER),t(document).off("mousedown.expandFilter")},onDocumentClick:function(e){t.contains(this.$filterControl[0],e.target)||t(e.target).closest(".filter-help,.tau-bubble-tooltipArticle,.tau-autocomplete__menu").length||this.shrinkFilter()
},updateFilterState:function(e){e=e||this.$filter.val()||"",this.$filter.toggleClass("full tau-extension-board-tooltip",!!e).data("title",e)}})}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.viewMode",["jQuery","Underscore","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus boardSettings.ready:last + configurator.ready:last + afterRender":function(t,i,n,a){var r=i.boardSettings,s=a.element;s.on("click","[role=action-toggle-viewMode]",function(){r.set({set:{viewMode:e(this).val()}})})},"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})}})}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.name",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t,i){return i.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus boardSettings.ready:last + dataBind:last + afterRender":function(t,i,n,a){function r(e){var t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}var s=i.boardSettings,o=a.element,l=o.find("[role=name]"),u=o.find("[role=name_output]");if(this.fire("$nameEl.ready",l),this.fire("$nameOutputEl.ready",u),1===l.size()){l.editableText({enabled:!1,restoreText:!0,className:" ",classNameActive:" ",maxLength:40,onSave:function(t){var i=e.trim(t.slice(0,40));this.$element.editableText("setValue",i),this.$element.prev().text(i),s.set({set:{name:i},callback:function(){}})}}),l.editableText("disable");var c=function(e){var t=e.edit&&n.isEditable;return this._toggleEditorVisibility(l,u,t),t}.bind(this);s.get({fields:["edit","isDraft"],callback:function(e){var t=c(e);t&&setTimeout(function(){l.click(),e.isDraft&&r(l[0])},1e3)}.bind(this)}),s.unbind({listener:this}),s.bind({fields:["edit"],listener:this,callback:function(e){var t=c(e);t&&l.click()}}),s.bind({fields:["name"],listener:this,callback:function(e){l.editableText("setValue",e.name),u.text(e.name)
}})}},"bus $nameEl.ready:last + name.provided":function(e,t,i){t.text(i.value)},"bus $nameOutputEl.ready:last + name.provided":function(e,t,i){t.text(i.value)},_toggleEditorVisibility:function(e,t,i){t.toggle(!i),e.toggle(i),e.editableText(i?"enable":"disable")}})}),define("template!tau/ui/templates/board.toolbar/ui.template.board.toolbar.feedback",["tau/core/templates-factory"],function(e){var t={name:"board.toolbar.feedback",engine:"jqote2",customFunctions:null,markup:'<div class="give-feedback"> <div class="give-feedback__header"> What do you think about <span class="give-feedback__title"><%= this.title %></span>? </div> <textarea class="give-feedback__textarea"><%= this.text %></textarea> <button type="button" class="tau-btn tau-btn-big i-role-actionok give-feedback__btn"> Send feedback </button> </div>'};return e.register(t)}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.feedback",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/utils/utils.serverErrorTranslator","template!tau/ui/templates/board.toolbar/ui.template.board.toolbar.feedback"],function(e,t,i,n,a){return i.extend({TEXT_TEMPLATE:["Like","----------------------","","","Miss","----------------------","","","Improve (your ideas)","----------------------","",""],FEATURE_TITLE:{timeline:"timelines",newlist:"new lists","default":"this feature"},"bus configurator.ready:last + dataBind + afterRender":function(e,t,i,n){var r=n.element.find(".i-role-feedback-btn");if(r.length){var s=this._getFeatureTitle(i.viewMode),o=a.render({title:s,text:this.TEXT_TEMPLATE.join("\n")}).on("click.sendFeedback",".i-role-actionok",function(){var e=o.find("textarea");r.tauBubble("hide"),t.getActionsService().sendFeedback(s,e.val()).then(function(t){return e.val(""),t}).done(this._handleSuccess.bind(this)).fail(this._handleError.bind(this))}.bind(this));r.tauBubble({content:o,zIndex:2,onShow:function(){r.addClass("tau-checked"),o.find("textarea").focus()},onHide:function(){r.removeClass("tau-checked")
}}),this.$content=o}},_handleSuccess:function(){this.fire("notification",{message:"Feedback sent.",delay:500})},_handleError:function(e){var t=JSON.parse(e.responseText)||{Message:"Server is not available"},i=n.translateServerError.call(this,t);this.fire("error",i)},_getFeatureTitle:function(e){return this.FEATURE_TITLE[e]||this.FEATURE_TITLE["default"]},destroy:function(){this.$content&&(this.$content.off(".sendFeedback"),this.$content=null),this._super()}})}),define("tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.hide.empty.lanes",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus boardSettings.ready:last + afterRender":function(e,t,i){var n=i.element.find(".i-role-hide-empty-lanes");if(n.length){var a=t.boardSettings;a.get({fields:["hideEmptyLanes"],callback:function(e){n.toggleClass("tau-checked",!!e.hideEmptyLanes).removeClass("hidden")}}),n.off("click.hideEmptyLanes").on("click.hideEmptyLanes",function(){var e=!n.hasClass("tau-checked");a.set({set:{hideEmptyLanes:e},callback:function(e){n.toggleClass("tau-checked",e.hideEmptyLanes)}})}.bind(this))}}})}),define("tau/ui/templates/board.toolbar/ui.template.board.toolbar",["tau/nls/translator","tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.filter"],function(e,t){var i={name:"board.toolbar",engine:"jqote2",markup:['<% var isBoard = this.viewMode === "board", isTimeline = this.viewMode === "timeline"; %>','<% var isList = this.viewMode === "list", isNewList = this.viewMode === "newlist"; %>','<% var uid = fn.uid("boardHeader"); %>','<div class="tau-board-header" id="<%=uid%>">','<div role="name_output" class="i-role-name_output tau-board-name"><%! this.name %></div>','<div role="name" class="<% if (!this.isEditable) { %>disabled<% } %> i-role-name tau-board-name-editor tau-extension-board-tooltip" data-title="Rename"><%! this.name %></div>','<%= fn.sub("board.editor.filter", this.cells) %>',"<% if (isTimeline) { %>",'<div class="i-role-timeline-period-selector tau-inline-group" />',"<% } %>",'<button role="actions-button" class="tau-btn tau-actions-btn" data-collapsed-selector=".tau-checked" type="button">'+e("Actions")+"</button>",'<span class="tau-inline-group tau-board-view-switch">','<button type="button" role="action-toggle-viewMode" value="board"',' class="tau-btn tau-extension-board-tooltip tau-btn-board-view <% if (isBoard) {%>tau-checked <% } %>" data-title="Board"></button>','<button type="button" role="action-toggle-viewMode" value="list"',' class="tau-btn tau-extension-board-tooltip tau-btn-view-view <% if (isList) {%>tau-checked <% } %>" data-title="One by one"></button>','<button type="button" role="action-toggle-viewMode" value="newlist"',' class="tau-btn tau-extension-board-tooltip tau-btn-list-view tau-board-customize-beta <% if (isNewList) {%>tau-checked <% } %>" data-title="List"></button>','<button type="button" role="action-toggle-viewMode" value="timeline"',' class="tau-btn tau-extension-board-tooltip tau-btn-timeline-view <% if (isTimeline) {%>tau-checked <% } %>" data-title="Timeline"></button>',"</span>","<% if (isNewList || isTimeline) { %>",'<button type="button" class="tau-btn tau-primary tau-extension-board-tooltip tau-feedback-btn i-role-feedback-btn"',' data-collapsed-selector=":not(.tau-checked)" data-title-collapsed="Give feedback about this view mode"',' data-expanded-selector=".tau-checked" data-title-expanded=""',">Give feedback</button>","<% } %>","<% if (isBoard || isTimeline) { %>",'<span class="tau-inline-group tau-focuser">','<button type="button" role="action-focus" class="tau-extension-board-tooltip tau-btn tau-focus-in"',' data-title="'+e("Show&nbsp;only&nbsp;highlighted&nbsp;lanes")+'" disabled="">focus</button>','<button type="button" role="action-unfocus" class="tau-extension-board-tooltip tau-btn tau-close tau-focus-out"',' data-title="'+e("See&nbsp;all&nbsp;lanes")+'" disabled=""></button>',"</span>","<% } %>","<% if (isBoard || isTimeline) { %>",'<button type="button" class="hidden tau-btn tau-extension-board-tooltip tau-btn--collapsed-empty-lanes i-role-hide-empty-lanes" data-collapsed-selector=".tau-checked" data-title-collapsed="Click to see hidden empty lanes"',' data-expanded-selector=":not(.tau-checked)" data-title-expanded="Click to hide empty lanes"',">","</button>","<% } %>","<% if (!isNewList) { %>",'<span role="zoomer" class="tau-zoomer ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"',' data-zoom-value="<%= this.zoom.value %>" ',' data-zoom-min="<%= this.zoom.min || 1 %>" ',' data-zoom-max="<%= this.zoom.max || 6 %>" ',">",'<a href="#" class="ui-slider-handle ui-state-default ui-corner-all tau-extension-board-tooltip" data-title="'+e("Zoom&nbsp;in/out&nbsp;on&nbsp;cards")+'" style="left: 100%;"></a>',"</span>","<% } %>","</div>"]};
return t.register(i)}),define("tau/components/period-selector/models/model.period-selector",["tau/core/class","tau/utils/timeline/utils.timeline.date-range","tau/utils/timeline/utils.timeline.local-period-calculator"],function(e,t,i){return e.extend({init:function(e){this.boardSettings=e,this.localRangeCalculator=new i},lastDateRange:null,save:function(e){var t=e.toISOString();return this.lastDateRange==t?null:(this.lastDateRange=t,this.boardSettings.get({fields:["timelineGlobalDateRange","timelineLocalDateRange"]}).then(function(i){var n={timelineGlobalDateRange:t};if(e&&e.isValid){var a=this.localRangeCalculator.scaleLocalDateRangeProportionally(i.timelineLocalDateRange,i.timelineGlobalDateRange,e);n.timelineLocalDateRange=a.toFullISOString()}this.boardSettings.set({set:n})}.bind(this)))},load:function(){return this.boardSettings.get({fields:["timelineGlobalDateRange"]}).then(function(e){var i=e.timelineGlobalDateRange,n="string"==typeof i;if(!n)throw new Error("The old version of board definition");return t.tryParseWithRoundedDays(i)})}})}),define("tau/components/period-selector/templates/template.period-selector",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"timeline-period-selector",engine:"jqote2",markup:['<span class="tau-inline-group">','<input type="text" class="i-role-timeline-period-choice ui-dateeditor-source tau-in-text" />','<button type="button" class="i-role-timeline-period tau-btn tau-date-range-options"></button>',"</span>"]};return t.register(i)}),define("tau/ui/behaviour/date/ui.behaviour.dateRangeEditor",["Underscore","jQuery","libs/date.js/build/date","tau/utils/utils.date","tau/utils/timeline/utils.timeline.date-range"],function(e,t,i,n,a){t.widget("ui.dateRangeEditor",{options:{onSave:t.noop,onDateRangeUpdated:t.noop,validation:{required:!1},dateFormat:"m/dd/yy",showOnInit:!1,targetStyleName:null,initialDateRange:null,onHide:t.noop,onCancel:t.noop},_create:function(){this.init()},init:function(){var e=this.element.addClass("ui-dateeditor-source");
this.options.showOnInit?this.showEditor():e.click(t.proxy(this.showEditor,this))},activate:function(){this._justActivated=!0,this.showEditor(),this.$editor.focus()},_attachKeyBoardHandling:function(){this.handleKeyDown||(this.handleKeyDown=e.bind(this.mapKeys,this),this.options.keyboardManager.pushHandler(this))},_detachKeyboardHandling:function(){this.handleKeyDown&&(this.options.keyboardManager.popHandler(),delete this.handleKeyDown)},_createEditors:function(){var i=this,n=null,r=null,s=this._createEditor(function(t){n&&n.setMinDate(t),r&&(i.options.onDateRangeUpdated(r.getDateRange().setStartDate(t)),e.defer(function(){r.setSelection(r.getDateRange())}))},function(t){r&&e.defer(function(){r.setSelection(a.createWithRoundedDays(t,r.getDateRange().endDate),s)})},this.startDateSelectedDayCalculator);n=this._createEditor(function(t){s.setMaxDate(t),r&&(i.options.onDateRangeUpdated(r.getDateRange().setEndDate(t)),e.defer(function(){r.setSelection(r.getDateRange())}))},function(t){r&&e.defer(function(){r.setSelection(a.createWithRoundedDays(r.getDateRange().startDate,t),n)})},this.endDateSelectedDayCalculator),r={focus:function(){s.focus()},show:function(){e.each(this.$nodes,function(e){e.show()})},hide:function(){e.each(this.$nodes,function(e){e.hide()})},destroy:function(){s.destroy(),n.destroy()},setSelection:function(e,t){if(!t)return s.selection.set(s,e),void n.selection.set(n,e);var i=t===s?s:n;i.selection.set(i,e)},setDateRange:function(e){s.setMaxDate(null),n.setMinDate(null),s.setDate(e.startDate),n.setDate(e.endDate),s.setMaxDate(e.endDate),n.setMinDate(e.startDate),this.setSelection(e)},getDateRange:function(){return a.createWithRoundedDays(s.getDate(),n.getDate())},appendTo:function(t,i){var a=[s,n,this._createPredefinedDateRangesSelector(),this._createControls()];this.$nodes=a,e.each(a,function(e){e.appendTo(i)})},remove:function(){e.each(this.$nodes,function(e){e.remove()})},_createPredefinedDateRangesSelector:function(){var i="ui-daterangepicker-predefined-range",n=this,r=function(e,t,i,a){e[t]={text:i,go:function(){var e=a();
n.setDateRange(e)}}},s={};r(s,"ui-daterangepicker-predefined-lastweek-range","last week",a.createLastWeek),r(s,"ui-daterangepicker-predefined-thirtydays-range","30 days",a.createLastThirtyDays),r(s,"ui-daterangepicker-predefined-threemonths-range","3 months",a.createLastThreeMonths),r(s,"ui-daterangepicker-predefined-year-range","1 year",a.createLastYear);var o=e.map(s,function(e,n){return t('<li> <span class = "'+n+" "+i+'">'+e.text+"</span> </li>")}),l=t('<ul class = "ui-daterangepicker-predefined-ranges"></ul>');return e.each(o,function(e){l.append(e)}),l.on("click","."+i,function(i){var n=t(i.currentTarget).attr("class").split(" "),a=e.find(n,function(t){return e.has(s,t)});null!=a&&s[a].go()}),t("<div></div>").append(t('<div class="ui-daterangepicker-predefined-ranges-title">Select:</div>')).append(l)},_createControls:function(){var e=t('<button class="tau-btn tau-primary i-role-action-submit" role="action-submit" type="button">Show</button>');return e.on("click",function(){taus.track({action:"click show button for global date range editor",tags:["timeline"]}),i._onSave()}),t('<div class="ui-daterangepicker-controls"></div>').append(e)}};var o=this.options.initialDateRange?this.options.initialDateRange:a.createDefault();return r.setDateRange(o),r.appendTo(this.options,this.element),r},showEditor:function(){this._editorIsVisible||(this.$editor||(this.$editor=this._createEditors()),this._attachKeyBoardHandling(),this._editorIsVisible=!0,this.$editor.show())},hideEditor:function(){this._detachKeyboardHandling(),this._editorIsVisible=!1,this.$editor&&this.$editor.hide()},startDateSelectedDayCalculator:{calculateSelectedDay:function(e,t){return e.getFullYear()<t.getFullYear()?{days:"*"}:e.getFullYear()===t.getFullYear()&&e.getMonth()<t.getMonth()?{days:"*"}:e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()<=t.getDate()?{days:t.getDate().toString()}:{days:null}}},endDateSelectedDayCalculator:{calculateSelectedDay:function(e,t){return e.getFullYear()>t.getFullYear()?{days:"*"}:e.getFullYear()===t.getFullYear()&&e.getMonth()>t.getMonth()?{days:"*"}:e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()>=t.getDate()?{days:t.getDate().toString()}:{days:null}
}},_createEditor:function(n,a,r){var s=this.options.dateFormat,o=t('<span class="ui-dateeditor"></span>');o.datepicker({showButtonPanel:!1,dateFormat:s,onSelect:function(){n(t(this).datepicker("getDate"))},onChangeMonthYear:function(e,t,n){a(new i(n.selectedYear,n.selectedMonth,n.selectedDay))}});var l={selectionCss:"ui-daterange-region",set:function(t,i){this.remove(t);var n=this._findDayNodes(t,i),a=this;e.each(n,function(e){e.addClass(a.selectionCss)})},remove:function(i){var n=this;e.each(this._getDayNodes(i),function(e){t(e).removeClass(n.selectionCss)})},_findDayNodes:function(i,n){var a=r.calculateSelectedDay(i.getDate(),n.startDate),s=r.calculateSelectedDay(i.getDate(),n.endDate);if(a.days&&s.days){for(var o=e.toArray(this._getDayNodes(i)),l=this._findDayNode(o,a.days),u=this._findDayNode(o,s.days),c=o.indexOf(l.dayNode),d=o.indexOf(u.dayNode),p=-1===c?0:c,f=-1===d?o.length-1:d,m=[],h=p;f>=h;++h)m.push(o[h]);return e.map(m,function(e){return t(e)})}},_findDayNode:function(i,n){var a=e.find(i,function(e){return t(e).children().eq(0).html()==n});return{dayNode:a}},_getDayNodes:function(e){return e.$editor.find("td").not(".ui-datepicker-other-month").not(".ui-datepicker-unselectable")}};return{$editor:o,selection:l,setMinDate:function(e){this._setThreshold("minDate",e)},setMaxDate:function(e){this._setThreshold("maxDate",e)},setDate:function(e){this.$editor.datepicker("setDate",e),n(e)},getDate:function(){return this.$editor.datepicker("getDate")},_setThreshold:function(e,t){this.$editor.datepicker("option",e,t)},focus:function(){this.$editor.focus()},show:function(){this.$editor.show()},hide:function(){this.$editor.hide()},destroy:function(){this.$editor.datepicker("destroy")},appendTo:function(e){e.append(this.$editor)},remove:function(){this.$editor.remove()}}},_onSave:function(){this.options.onSave()},_onCancel:function(){this.options.initialDateRange&&this.$editor.setDateRange(this.options.initialDateRange),this.options.onCancel&&this.options.onCancel(this.options.initialDateRange)
},isDateRangeChanged:function(){var e=this.options.initialDateRange,t=this.getDateRange();return null===e&&null===t?!1:null===e||null===t?!0:!this.options.initialDateRange.equals(this.getDateRange())},getDateRange:function(){return this.$editor.getDateRange()},destroy:function(){this.hideEditor();var e=this.$editor;e&&(e.destroy(),e.remove())},mapKeys:function(e){switch(e.which){case 13:e.preventDefault(),this._onSave();break;case 27:e.preventDefault(),this._onCancel()}}})}),define("tau/components/period-selector/views/view.period-selector",["Underscore","tau/core/class","tau/components/period-selector/templates/template.period-selector","tau/utils/timeline/utils.timeline.date-range","tau/ui/behaviour/date/ui.behaviour.dateRangeEditor","tau/utils/utils.date/utils.date.formats"],function(e,t,i,n,a,r){var s=function(e){13===e.which&&(e.stopPropagation(),$(this).trigger("blur"))},o="i-role-timeline-period-host",l="i-role-timeline-period",u="i-role-date-range-loading",c="tau-checked";return t.extend({init:function(t,n,a){this.dateRangeChanged=e.Callbacks();var r=i.get().bind({},{});t.replaceWith(r),this.$choiceTextbox=r.find(".i-role-timeline-period-choice"),this.$choiceTextbox.keypress(s),this.$choiceTextbox.change(this._onChoiceTextChanged.bind(this)),this.$periodButton=r.find("."+l),this.$periodButton.click(this._onPeriodButtonClicked.bind(this,n)),this._bindDateRange(a)},_onChoiceTextChanged:function(e){e.preventDefault(),e.stopPropagation(),this.dateRangeChanged.fire(this._getDateRange())},_onPeriodButtonClicked:function(e,t){if(this.$periodButton.hasClass(c))return void this.$periodButton.removeClass(c);this.$periodButton.addClass(c),t.preventDefault(),t.stopPropagation();var i=this._initBubble(e);i.tauBubble("show")},_bindDateRange:function(e){this.$choiceTextbox.val(e.toString())},_getDateRange:function(){var e=this.$choiceTextbox.val();return n.tryParseWithRoundedDays(e)},_createBubbleContent:function(){return $(['<div class="tau-date-range-selector">',"<div class="+o+"></div>","<div class="+u+">Loading...</div>","</div>"].join(""))
},_createBubbleTemplate:function(){return['<div class="tau-bubble">','<div class="tau-bubble__arrow" role="arrow"></div>','<div class="tau-bubble__inner tau-container" role="content"></div>',"</div>"].join("")},_initBubble:function(t){var i=this.$periodButton.tauBubble({alignTo:this.$periodButton,template:this._createBubbleTemplate(),content:this._createBubbleContent(),onShow:function(n){var a=this._getDateRange();n.find("."+u).hide();var s=n.find("."+o);s.dateRangeEditor({targetStyleName:l,showOnInit:!0,dateFormat:r.date.short,keyboardManager:t,onDateRangeUpdated:this._bindDateRange.bind(this),initialDateRange:a.isValid?e.clone(a):null,onSave:function(){i.tauBubble("hide")},onCancel:function(e){null!==e&&this._bindDateRange(e)}.bind(this)})}.bind(this),onHide:function(e){this.$periodButton.removeClass(c);var t=e.find("."+o);if(t.dateRangeEditor("hideEditor"),t.dateRangeEditor("isDateRangeChanged")){var i=t.dateRangeEditor("getDateRange");this.dateRangeChanged.fire(i)}}.bind(this),zIndex:999});return i}})}),define("tau/components/period-selector/controllers/controller.period-selector",["Underscore","tau/core/class","tau/components/period-selector/models/model.period-selector","tau/components/period-selector/views/view.period-selector"],function(e,t,i,n){return t.extend({init:function(){this.onInvalidDateRange=e.Callbacks()},startLifeCycle:function(e,t,n){0!==n.length&&(this.model=new i(e),this.model.load().done(this._onDateRangeLoaded.bind(this,n,t)))},_onDateRangeChanged:function(e){this.model.save(e),e.isValid||this.onInvalidDateRange.fire(e)},_onDateRangeLoaded:function(e,t,i){this.view=new n(e,t,i),this.view.dateRangeChanged.add(this._onDateRangeChanged.bind(this)),i.isValid||this.onInvalidDateRange.fire(i)}})}),define("tau/ui/extensions/timeline/ui.extension.timeline.period-selector",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/components/period-selector/controllers/controller.period-selector"],function(e,t,i,n){return i.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})
},init:function(){this.controllerPeriodSelector=new n,this.controllerPeriodSelector.onInvalidDateRange.add(function(e){this.fire("error",{message:e.errorMessage()})}.bind(this)),this._super.apply(this,arguments)},"bus boardSettings.ready:last + configurator.ready:last + afterRender":function(e,t,i,n){this.controllerPeriodSelector.startLifeCycle(t.boardSettings,i.getKeyBoardManager(),n.element.find(".i-role-timeline-period-selector"))}})}),define("tau/ui/templates/board.toolbar/ui.template.board.actions.menu",["tau/nls/translator","tau/core/templates-factory"],function(e,t){var i={name:"actions-button-menu",engine:"jqote2",markup:['<div class="actions-menu-items i-role-bubble-holder">','<div class="tau-board-actions-item"><span class="options-button"></span>','<button role="action-toggle-editor" class="tau-btn tau-btn-settings tau-board-settings-toggle" type="button">'+e("Set up View")+"</button>",'<div class="tau-txt">'+e("Go to View settings.")+"</div>","</div>",'<div class="tau-board-actions-item"><span class="clone-board-button"></span><div class="tau-txt">Make a copy of this View.</div></div>',"<% if (this.boardTemplatesEnabled) { %>",'<div class="tau-board-actions-item"><span class="save-template-button"></span><div class="tau-txt">This View will appear in the Templates tab as a new template.</div></div>',"<% } %>",'<div class="tau-board-actions-item"><span class="tau-csv"></span><div class="tau-txt">Export all the cards from this View to a .CSV file</div></div>',"<% if (this.model.isEditable) { %>",'<div class="tau-board-actions-item"><span class="remove-board-button"></span><div class="tau-txt">Only this View as a configurable view will be removed. The data will remain safe.</div></div>',"<% } %>","<% if (this.model.isPrintable) { %>",'<div class="tau-board-actions-item"><span class="print-board-button"></span><div class="tau-txt">Print all visible cards from this View</div></div>',"<% } %>","<% if (this.model.canSetupStates) { %>",'<div class="tau-board-actions-item"><span class="setup-states-button"></span><div class="tau-txt">Configure workflow for selected projects</div></div>',"<% } %>","</div>"]};
return t.register(i)}),define("tau/models/print.cards/model.print.cards.board",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({"bus configurator.ready:last + getCardsData":function(i,n){var a=n.service("currentBoard").$element,r=a.find(".i-role-header"),s=function(i){var n=[];return t.each(r.find(".i-role-cellholder"),function(r){var s=e(r),o=s.data(i),l=".i-role-grid .i-role-cell[data-"+i+"="+o+"] .i-role-card",u=t.chain(a.find(l)).map(function(t){return e(t).data("cardData")}).value();u.length&&n.push({name:s.find(".i-role-name").text(),cards:u})}),n},o=[],l=r.length;switch(l){case 1:var u=r.data("dimension");o=s(u);break;case 2:o=s("x");break;default:var c=t.map(a.find(".i-role-card"),function(t){return e(t).data("cardData")});c.length&&(o=[{name:"",cards:c}])}this.fire("currentCards",o)}})}),define("tau/ui/extensions/board.toolbar/ui.extension.board.actions",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/templates/board.toolbar/ui.template.board.actions.menu","tau/models/print.cards/model.print.cards.board"],function(e,t,i,n,a){return i.extend({"bus boardSettings.ready:last + configurator.ready:last + afterRender":function(e,r,s,o){var l=s.getLoggedUser(),u=l.isAdministrator,c=o.element.find("[role=actions-button]"),d={target:c,cleanupOnHide:!0,className:"tau-board-actions-bubble",stackName:"actionsBoard",showOnCreation:!0,zIndex:42,componentsConfig:{components:[{name:"actions-bubble",layout:"selectable",model:o.data,boardTemplatesEnabled:u,extensions:[i.extend({"bus childComponentCreated":function(e,t){t.fire("boardSettings.ready",r)}})],type:"container",template:n,children:t.compact([o.data.isEditable?{selector:".remove-board-button",type:"board.remove"}:!1,{selector:".clone-board-button",type:"board.clone"},o.data.isPrintable?{selector:".print-board-button",type:"print.cards",extensions:[a,i.extend({init:function(e){this._super(e),c.one("taububblehide",function(){this.fire("clearPrintBlock")
}.bind(this))}})]}:!1,{selector:".tau-csv",type:"board.csv"},u?{selector:".save-template-button",type:"board.templates.editor"}:!1,o.data.canSetupStates?{selector:".setup-states-button",type:"board.workflow"}:!1])}]},onShow:function(e){c.addClass("tau-checked"),e.on("click.settings",".tau-btn-settings",function(){c.tauBubble("hide"),r.boardSettings.set({set:{edit:!0}})})},onHide:function(e){e.off("click.settings",".tau-btn-settings"),c.removeClass("tau-checked")}};c.on("click",function(){this.fire("initBubble",d)}.bind(this))}})}),define("tau/components/component.board.toolbar",["tau/components/component.creator","tau/models/board.toolbar/model.board.toolbar","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.focus","tau/models/board.toolbar/model.board.toolbar.zoom","tau/models/board.editor/model.board.filter.help","tau/models/board.editor/model.board.editor.autocomplete","tau/models/board.editor/model.board.editor.autocomplete.preloading","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.zoom","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.userFilter","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.viewMode","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.name","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.remove","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.feedback","tau/ui/extensions/board.toolbar/ui.extension.board.toolbar.hide.empty.lanes","tau/ui/extensions/board.editor/ui.extension.board.editor.help","tau/components/extensions/error/extension.errorBar","tau/ui/templates/board.toolbar/ui.template.board.toolbar","tau/ui/extensions/timeline/ui.extension.timeline.period-selector","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/board.toolbar/ui.extension.board.actions"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b,y,_){return{create:function(x){var w={template:g,extensions:[t,i,o,n,a,r,s,l,u,c,d,p,f,m,h,v,b,y,_].concat(x.extensions||[])};
return e.create(w,x)}}}),define("tau/ui/extensions/board.tools.container/ui.extension.board.tools.container.view",["Underscore","jQuery","tau/views/view.container"],function(e,t,i){return i.extend({"bus initialize":function(){},"bus initialize + boardSettings.ready":function(e,t,i){this.startLifeCycle(t,i.boardSettings)},"bus refresh":function(){this.startLifeCycle()},startLifeCycle:function(t,i){i=i||this.boardSettings,this.boardSettings=i;var n=this._super;i.get({fields:["viewMode"],callback:e.bind(function(e){this.fire("toggleOverview","board"==e.viewMode),n.call(this,t,i)},this)}),i.unbind({listener:this}),i.bind({fields:["viewMode"],listener:this,callback:e.bind(function(e){this.config&&this.fire("toggleOverview","board"==e.viewMode)},this)})}})}),define("tau/ui/extensions/board.tools.container/ui.extension.board.tools.container.tabs",["Underscore","jQuery","tau/core/extension.base","tau/core/event-dispatcher"],function(e,t,i,n){return i.extend({resetLifecycle:!0,"bus beforeInit":function(e,t){this.config=t.config;var i=t.config.context.configurator;this.fire("configurator.ready",i)},"bus show.completed":function(e,t){this.fire("$el.ready",t)},"bus $el.ready + hide":function(e,i){var n=i.find(".i-role-tabheaders .i-role-tabheader");n.each(function(){t(this).tauBubble("hide")})},"bus $el.ready:last + toggleOverview":function(e,t,i){var n=t.find(".i-role-tabheader-overviews");i?n.removeAttr("disabled"):n.attr("disabled","disabled")},"bus $el.ready + childrenBuses.ready":function(i,a,r){var s=this,o=a.find(".i-role-tabheaders .i-role-tabheader");a.on("click",".i-role-tabheader:not(.tau-disabled)",function(){s.fire("tab.activate",t(this).data("label"))});var l=new n(r);this.on("destroy",function(){l=null}),l.listen("$bubbled.ready",function(){var i={collision:"fit none",my:"right bottom",at:"right top"};o.each(function(){var n=t(this),a=n.data("label");n.bind("taububbleshow",function(){n.toggleClass("tau-checked",!0),s.fire("tab.activate.completed",a)}),n.bind("taububblehide",function(){n.toggleClass("tau-checked",!1)
});var r={className:"tau-tools-popup",onPositionConfig:function(t){return e.extend(t,i)}};"overviews"==a&&(r.className+=" tau-tools-board-map"),n.tauBubble("option",r)})}),o.each(function(){var e=t(this),i=e.data("label");r[i].fire("$trigger.ready",e)})}})}),define("tau/ui/templates/board.tools.container/ui.template.board.tools.container",["tau/core/templates-factory"],function(e){var t={name:"board.tools.container",engine:"jqote2",markup:['<div class="tau-boardtools">','<div class="tau-inline-group tau-boardtools__buttonsholder i-role-tabheaders">','<button class="tau-btn tau-boardtools__switcher i-role-tabheader i-role-tabheader-about" data-label="about">About</button>',"</div>",'<div class="i-role-tab" role="about" data-label="about"></div>','<div class="i-role-tab" role="overviews" data-label="overviews"></div>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.board.tools.container",["Underscore","tau/components/component.container","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.tools.container/ui.extension.board.tools.container.view","tau/ui/extensions/board.tools.container/ui.extension.board.tools.container.tabs","tau/ui/templates/board.tools.container/ui.template.board.tools.container"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[i,a].concat(s.extensions||[]),ViewType:n,template:r};return t.create(e.extend(s,o))}}}),define("tau/ui/extensions/board.workflow/ui.extension.board.workflow",["Underscore","jQuery","tau/ui/extensions/board.workflow/ui.extension.board.workflow.base"],function(e,t,i){return i.extend({"bus afterInit":function(e){e.sender.fire("dataBind",{})},"bus afterRender + configurator.ready:last + boardSettings.ready:last":function(e,t,i,n){this.configure(i,n.boardSettings,t.element)}})}),define("tau/ui/templates/board.workflow/ui.template.board.workflow",["tau/core/templates-factory"],function(e){var t={name:"board.templates.workflow",engine:"jqote2",markup:['<span class="tau-inline-group tau-board-workflow"><input type="button" class="tau-btn tau-workflow i-role-setup-workflow" value="Set up States"/></span>']};
return e.register(t)}),define("tau/components/component.board.workflow",["tau/components/component.creator","tau/ui/extensions/board.workflow/ui.extension.board.workflow","tau/ui/templates/board.workflow/ui.template.board.workflow","tau/core/helpers/extension.configurator"],function(e,t,i,n){return{create:function(a){var r={extensions:[t,n],template:i};return e.create(r,a)}}}),define("tau/models/breadcrumbs/model.breadcrumbs",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(t,i){var n=i.config.context.configurator.getHistory();n.removeAllListeners(this),n.on("changed",e.bind(this.fire,this,"refresh"),this),this.fire("dataBind",{items:n.getFlatStack().slice(-3)})},"bus beforeInit + destroy":function(e,t){var i=t.config.context.configurator.getHistory();i.removeAllListeners(this)}})}),define("tau/ui/templates/breadcrumbs/ui.template.breadcrumbs",["tau/core/templates-factory"],function(e){return e.register({name:"breadcrumbs",engine:"jqote2",markup:["<% if (this.items.length){ %>",'<ul class="ui-breadcrumbs">',"<% _.forEach(this.items, function(item){ %>",'<li class="ui-breadcrumbs__item"><a href="<%= item.url %>"><%! item.title %></a></li>',"<% }); %>","</ul>","<% } %>"]})}),define("tau/components/component.breadcrumbs",["tau/components/component.creator","tau/models/breadcrumbs/model.breadcrumbs","tau/ui/templates/breadcrumbs/ui.template.breadcrumbs"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/ui/extensions/bubble.container/ui.extension.bubble.container",["Underscore","jQuery","tau/core/extension.base.stateful"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){var i=t.element;this.fire("$el.ready",i)},"bus beforeInit + $el.ready + $trigger.ready":function(t,i,n,a){a.data("ui-tauBubble")&&a.tauBubble("destroy");var r={content:n,zIndex:"",onShow:e.bind(function(){this.fire("show")},this),onHide:e.bind(function(){this.fire("hide")},this)};
this.config.autoClose===!1&&(r.stackName="bubble"+e.uniqueId(),r.dontCloseSelectors=["body"]),this.config.stackName&&(r.stackName=this.config.stackName),a.tauBubble(e.defaults(i.config.options||{},r)),this.fire("$bubbled.ready",a)},"bus view.dom.ready + $bubbled.ready":function(t,i,n){n.on("taububbledestroy",e.bind(function(){this.isDestroyed||this.fire("destroy")},this))},"bus $bubbled.ready:last + hide":function(e,t,i){t.tauBubble("hide",i||{})},"bus $bubbled.ready + componentsCreated":function(t,i,n){var a=!1,r=e.bind(function(e){var t=e.data("ui-tauBubble");this.config.visible&&!a&&(!t||t.$popup&&t.$popup.is(":visible")||e.tauBubble("show"),a=!0),e.data("ui-tauBubble")&&e.tauBubble("isVisible")&&e.tauBubble("adjust")},this,i),s=".bubbleComponent"+this.__objectId;e.forEach(n,function(t){var n=t.component;i.on("taububbleshow"+s,e.bind(n.fire,n,"$outerBubbled.shown")),i.on("taububblehide"+s,e.bind(n.fire,n,"$outerBubbled.hidden")),n.on("afterRender",r),n.on("dom.modified",r),n.on("svg.ready",r),n.on("adjustPosition",r)}),r()},"bus $bubbled.ready:last + $el.ready:last + show.completed":function(e,t){t.tauBubble("adjust")},"bus $bubbled.ready:last + destroy":function(e,t){this.isDestroyed=!0,t.data("ui-tauBubble")&&t.tauBubble("destroy");var i=".bubbleComponent"+this.__objectId;t.off(i)}})}),define("tau/components/component.bubble.container",["Underscore","tau/components/component.container","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/bubble.container/ui.extension.bubble.container","tau/views/view.container"],function(e,t,i,n,a){return{create:function(r){var s={extensions:[i,n].concat(r.extensions||[]),ViewType:r.ViewType||a};return t.create(e.extend(r,s))}}}),define("tau/models/model.button",["tau/core/model.editable.base","app.path"],function(e){return e.extend({onInit:function(){this.fire("dataBind",{label:this.config.label,disabled:this.config.disabled})}})}),define("tau/ui/tags/ui.tag.implode",["Underscore"],function(e){return{register:function(t,i){i.$tau=i.$tau||{},i.$tau.text_implode=function(t){if(e.isString(t))return t;
if(e.isArray(t)){var i=e.clone(t),n=i.pop();return e.filter([i.join(", "),n],function(e){return 0!=e}).join(" &amp; ")}return new String(t)}}}}),define("tau/ui/templates/button/ui.template.button",["tau/core/templates-factory","tau/ui/tags/ui.tag.implode"],function(e,t){var i={name:"button",tags:[t],markup:['<div><button class="tau-btn {{if cssClass}} ${cssClass}{{/if}}" type="button" {{if disabled}}disabled="disabled"{{/if}}>${label}</button></div>'],dependencies:[]};return e.register(i)}),define("tau/ui/extensions/button/ui.extension.button",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({init:function(){this._super.apply(this,arguments),this.onButtonClickProxy=e.bind(this.onButtonClick,this)},"bus afterRender":function(e){e.data.element.find(".ui-button").click(this.onButtonClickProxy)},"bus afterRender:last+enable":function(e){e.afterRender.data.element.find("button").prop("disabled",!1)},"bus afterRender:last+disable":function(e){e.afterRender.data.element.find("button").prop("disabled",!0)},onButtonClick:function(){this.fire("view.button.click")},destroy:function(){this._super.apply(this,arguments),delete this.onButtonClickProxy}})}),define("tau/components/component.button",["Underscore","tau/components/component.creator","tau/models/model.button","tau/ui/templates/button/ui.template.button","tau/ui/extensions/button/ui.extension.button"],function(e,t,i,n,a){return{create:function(e){var r={ModelType:i,template:n,extensions:e.extensions||[]};return r.extensions=r.extensions.concat([a]),t.create(r,e)}}}),define("tau/models/model.buttonGroup",["Underscore","jQuery","tau/core/model-base"],function(e,t,i){return i.extend({"bus afterInit":function(){this.items=this.config.items,this.useMultipleSelection="multiple"===this.config.selectionMode,this.fire("dataBind",{items:this.items})},"bus afterRender":function(i,n){var a=n.element,r=this;a.on("click",function(i){i.preventDefault();var n=t(i.target).data();
e.each(r.items,function(e){e.id===n.id&&e.name==n.name?e.isSelected=!0:r.useMultipleSelection||(e.isSelected=!1)}),r.fire("buttonGroup.selectionChanged",{selectedItems:e.select(r.items,function(e){return e.isSelected===!0})}),r.fire("refresh")})}})}),define("tau/ui/templates/ui.template.buttonGroup",["tau/core/templates-factory"],function(e){var t={name:"buttonGroup",engine:"jqote2",markup:["<% for(var i=0; i<this.items.length; i++){%>",'<button data-id="<%= this.items[i].id %>" data-name="<%= this.items[i].name%>"','class="i-role-selector tau-btn tau-<%=this.items[i].name.toLowerCase()%> <%= (this.items[i].isSelected ? "tau-checked" : "")%>">',"<%= this.items[i].label %>","</button>","<%}%>"]};return e.register(t)}),define("tau/components/component.buttonGroup",["Underscore","tau/components/component.creator","tau/models/model.buttonGroup","tau/ui/templates/ui.template.buttonGroup"],function(e,t,i,n){return{create:function(a){var r={ModelType:i,template:n,extensions:e.clone(a.extensions||[])};return t.create(r,a)}}}),define("tau/models/choice/model.choice.entityState",["Underscore","./model.choice.base"],function(e,t){return t.extend({propertyType:"entityState",onInit:function(){this.getAssignable(e.bind(function(t){var i=t[0].data;this.store.get(this.propertyType,this.createGetStateForAssignableCommand(i)).done({success:e.bind(this.onDataRetrieved,this)})},this))},getRequiredFields:function(){return[{entityState:["id"]}]},createGetStateForAssignableCommand:function(e){return{id:e.entityState.id,fields:["id","name","isCommentRequired",{nextStates:["id","name","isCommentRequired","numericPriority"]}]}},processData:function(t){var i=[];t.nextStates=e.sortBy(t.nextStates,function(e){return e.numericPriority}),e.each(t.nextStates,function(e){i.push({id:e.id,name:e.name,isCommentRequired:e.isCommentRequired})}),this.fire("dataBind",{states:i,completed:!0})}})}),define("tau/utils/utils.textsearch",["Underscore","tau/core/class"],function(e,t){var i=t.extend({data:[],load:function(t){var i=this;
e.forEach(t,function(e){e.normalizeData=i._normalize(e.data)}),this.data=t},_createRegex:function(t){var i=e.trim(t);i=i.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),i=i.replace(/[ ]+/g,"([-[\\]{}()*+?.,\\\\^$|#:;! ]+|\\s+|\\s+[ \\S]*?\\s+)");var n=new RegExp(i,"i");return n},_normalize:function(t){return e.trim(t)},search:function(t){var i=[],n=this._createRegex(t);return e.forEach(this.data,function(e){var t=e.normalizeData,a=t.match(n);if(a){var r={_id:e._id,data:e.data,entry:{from:a.index,len:a[0].length}};i.push(r)}}),i},match:function(e,t){var i=null,n=this._normalize(e).match(this._createRegex(t));return n&&(i={from:n.index,len:n[0].length}),i}});return i}),define("tau/ui/behaviour/common/ui.behaviour.listSelectable",["Underscore","jQuery"],function(e,t){t.widget("ui.listSelectable",{_create:function(){},_handler:function(){},enable:function(i){if(i=e.defaults(i||this.options,{saveScroll:!1,onSelect:t.noop}),!this._enabled){this._enabled=!0;var n=this.element.parents(".ui-drop-down:first").find(".filter-field-wrapper :text");n.length&&n.focus();var a=this;this.reset(i),this.$items.on("click",function(){i.onSelect(t(this))});var r=function(e){return e++,e>=a._max?0:e},s=function(e){return e--,0>e?a._max-1:e},o=this.options.className;this.options.keyboardManager.pushHandler({handleKeyDown:function(e){var i=a._index;switch(e.keyCode){case t.ui.keyCode.DOWN:e.preventDefault(),i=r(i);break;case t.ui.keyCode.UP:e.preventDefault(),i=s(i);break;case t.ui.keyCode.ENTER:if(e.preventDefault(),0>i)return;a.$items.eq(i).trigger("click");break;default:return}a._index=i,a.$items.removeClass(o),i>=0&&a.$items.eq(i).addClass(o),a.$list.animate({scrollTop:a._getOffset(i)},{duration:0})}})}},_getOffset:function(e){var t=this.$items.eq(e);if(!t.length)return 0;var i=t.position().top;this.$inner.length&&(i-=this.$inner.position().top);var n=t.parent("i-group");return n.length&&(i+=n.position().top),i-this.$list.height()/2},reset:function(t){t=e.defaults(t||{},{saveScroll:!1}),this.$list=this.element,this.$items=this.$list.find(this.options.items).filter(":visible"),this.$inner=this.$list.find(this.options.inner||".i-inner"),t.saveScroll||this.$list.scrollTop(0),this.step=.5*this.$items.eq(0).height(),this._index=-1,this._max=this.$items.length,t.saveScroll||this.$items.removeClass(this.options.className)
},disable:function(){this._enabled&&(this._enabled=!1,this.options.keyboardManager.popHandler())},destroy:function(){this.disable()}})}),define("tau/ui/extensions/choice/ui.extension.choice.editable",["Underscore","jQuery","tau/utils/utils.textsearch","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(e,t,i,n){return n.extend({"bus dataBind+afterRender":function(i){var n=this.config.context.configurator.getTemplateFactory().getTermProcessor();this.searchIndex=null;var a=this.config,r=this.element=i.afterRender.data.element,s=this.dataToBind=i.dataBind.data,o=0;e.forEach(s.states,function(e){e.items?o+=e.items.length:o++}),this.$list=r.find(".drop-down-list"),this.$options=this.$list.find(".i-role-option"),this.$list.on("click",".i-role-option:not(:has(.tau-loader))",e.bind(this.onItemSelected,this)),a.hasOwnProperty("maxHeight")&&this.$list.css({"max-height":a.maxHeight,"overflow-y":"auto"});var l=t("<div class='drop-down-actions' role='actions' />"),u=!1;if(s.hasOwnProperty("defaultValue")&&!this.config.hideDefaultValue){u=!0;var c=this.config.defaultValueLabel||"default";t("<span class='action-link default'>"+e.escape(n.replaceTermTags(c))+"</span>").click(e.bind(this.defaultValue,this)).appendTo(l)}if(this.config.allowToReset=!!this.config.allowToReset,s.nullableValue&&this.config.allowToReset){u=!0;var d=this.config.clearValueLabel||"reset";t("<span class='action-link clear' role='action-reset'>"+e.escape(n.replaceTermTags(d))+"</span>").click(e.bind(this.clearValue,this)).appendTo(l)}if(u&&l.insertBefore(this.$list),0===s.states.length&&s.completed){var p=a.emptyDataMessage||"None";this.$list.append("<span class='empty-message'>"+e.escape(n.replaceTermTags(p))+"</span>")}if(a.filter&&o>3){this.filterField=t("<input type='text' class='filter-field' />").keyup(e.bind(this._filterDelegate,this)),a.filterPlaceholder&&"string"==typeof a.filterPlaceholder&&this.filterField.attr("placeholder",a.filterPlaceholder);
var f=t("<div class='filter-field-wrapper'></div>").append(this.filterField);f.insertBefore("top"===this.config.filterPosition&&u?l:this.$list)}if(a.expandable&&!s.completed){var m=a.mode||"short";if("full"!==m){var h=t("<div class='drop-down-footer'></div>"),g=this.config.fullModeLabel||"more...";this.$mode=t("<div class='action-link more'>"+g+"</div>").click(e.bind(this._toggleMode,this)).appendTo(h),h.insertAfter(this.$list)}}this.bus.fire("dataRendered",{element:r})},"bus $outerBubbled.ready:last+dataRendered:last":function(){this._createSelectable(),this.bus.fire("focus")},"bus $outerBubbled.show:last":function(){this.bus.fire("focus")},_createSelectable:function(){this.$list.listSelectable({items:".drop-down-option:visible",className:"drop-down-option_hover",keyboardManager:this.config.context.configurator.getKeyBoardManager()}),this.$list.addClass("tau-dropdownlist_selectable_true")},_enableSelectable:function(){this.$list.hasClass("tau-dropdownlist_selectable_true")&&this.$list.data("ui-listSelectable")&&this.$list.listSelectable("enable")},_disableSelectable:function(){this.$list.hasClass("tau-dropdownlist_selectable_true")&&this.$list.data("ui-listSelectable")&&this.$list.listSelectable("disable")},"bus dataRendered:last+focus":function(){this._enableSelectable()},"bus dataRendered:last+refresh":function(){this._enableSelectable()},"bus dataRendered:last+blur":function(){this._disableSelectable()},_toggleMode:function(e){e.stopPropagation();var t="full"===this.config.mode?"short":"full";this.fire("refresh",{mode:t})},clearValue:function(e){e.stopPropagation(),this._updateState(null)},defaultValue:function(e){e.stopPropagation(),this._updateState(this.dataToBind.defaultValue)},onItemSelected:function(e){var i=t(e.currentTarget).data();this._updateState(i.id,i)},_updateState:function(t,i){var n=!0;if(this.config.confirmation&&window.confirm&&(n=window.confirm(this.config.confirmation)),n){var a=i?e.clone(i):{};a.id=t,this.fire("updateState",a)}},_resetList:function(){this.$options.show()
},_noResults:function(e){e='"'+e+'" not found',this.$noResults?this.$noResults.text(e):this.$noResults=t("<div class='not-found' />").text(e).insertBefore(this.$list),this.$noResults.show()},_clearNoResults:function(){this.$noResults&&this.$noResults.hide()},_filterDelegate:function(n){var a=n.keyCode;if(a!=jQuery.ui.keyCode.DOWN&&a!=jQuery.ui.keyCode.UP&&a!=jQuery.ui.keyCode.ENTER&&a!=jQuery.ui.keyCode.ESCAPE){if(!this.searchIndex){var r=[];this.searchIndex=new i,this.$options.each(function(e,i){r.push({_id:e,data:t(i).text()}),t(this).data("text",t(i).text())}),this.searchIndex.load(r)}var s=this.filterField.val(),o=this.searchIndex.search(s);this.$options.hide();var l=this.$options;e.forEach(o,function(e){var t=l.eq(e._id),i=t.data("text")+"";i=i.substr(0,e.entry.from)+"<em>"+i.substr(e.entry.from,e.entry.len)+"</em>"+i.substr(e.entry.from+e.entry.len,i.length);var n=t.find(".i-role-optiontext");n.length?n.html(i):t.html(i),t.show(),t.parent().show()}),l.filter(":hidden").parent().not(l.filter(":visible").parent()).hide(),s.length?o.length?this._clearNoResults():this._noResults(s):(this._clearNoResults(),this._resetList()),this.$list.data("ui-listSelectable")&&this.$list.listSelectable("reset"),this.fire("choice.editable.filter.changed",{filter:s})}}})}),define("tau/ui/extensions/choice/ui.extension.choice.editable.entityState",["Underscore","jQuery","tau/ui/extensions/choice/ui.extension.choice.editable"],function(e,t,i){return i.extend({_updateState:function(e){var t=!0;this.config.confirmation&&window.confirm&&(t=window.confirm(this.config.confirmation)),t&&this.fire("entityState.selected",{id:e})}})}),define("tau/ui/templates/choice.entityState/ui.template.choice.entityState.commentForm",["tau/core/templates-factory"],function(e){return e.register({name:"choice.entityState.commentForm",engine:"jqote2",markup:['<div class="ui-entity-state-comment">','<div class="ui-state-comment-header">Please, provide comment</div>','<div class="ui-state-comment-field-container">','<textarea rows="5" class="ui-state-comment-field"></textarea>',"</div>",'<div class="button-group">','<button type="button" class="save button">Save</button>','<button type="button" class="cancel button">Cancel</button>',"</div>","</div>"]})
}),define("tau/utils/utils.textConverter",["Underscore","tau/core/class"],function(e,t){var i=t.extend({convert:function(e,t){var i=e;if(t===!0){for(var n=$("<span></span>"),a=i.split(/\r\n|\r|\n/),r=0;r<a.length;r++)a[r]=n.text(a[r]).html();i=a.join("\r\n")}return i=i.replace(/([^\r])\n/gi,"$1<br />\n"),i=i.replace(/\r\n/gi,"<br />\r\n"),i=i.replace(/  /gi,"&nbsp;&nbsp;"),i=i.replace(/&nbsp; /gi,"&nbsp;&nbsp;")}});return i}),define("tau/ui/extensions/choice.entityState/ui.extension.choice.entityState.commentByPractice",["Underscore","jQuery","tau/core/extension.base","tau/ui/templates/choice.entityState/ui.template.choice.entityState.commentForm","tau/utils/utils.textConverter","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(e,t,i,n,a){return i.extend({init:function(e,t){this.configurator=t,this.template=n,this.textConverter=new a,this._super(e)},"bus afterRender:last + focus.before":function(e,t){t.element.find(".ui-entity-state-comment").remove()},"bus afterRender:last + dataBind:last + entityState.selected":function(t,i,n,a){var r=i.element,s=e.findWhere(n.states,{id:a.id}),o=s&&s.isCommentRequired;if(!o)return void this.fire("updateState",a);if(r.find(".ui-entity-state-comment").length>0)return void r.find("textarea").focus();var l=r.find(".drop-down-list");l.data("ui-listSelectable")&&(l.find(".i-role-option[data-id="+s.id+"]").addClass(l.listSelectable("option","className")),l.listSelectable("disable"));var u=this.configurator.getTemplateFactory().get(this.template.name).bind();u.appendTo(r);var c=u.find("textarea").focus(),d=u.find(".save");d.click(e.bind(this._save,this,s,r,l,u));var p=u.find(".cancel");p.click(e.bind(this._cancel,this,s,r,l,u));var f=function(){window.setTimeout(function(){var t=c.val()||"",i=0===e.trim(t).length;i?d.attr("disabled","disabled"):d.attr("disabled")&&d.removeAttr("disabled"),d.toggleClass("disable",i)},50)};f(),d.bind("focus",f),c.bind("change keyup click propertychange paste",f)},_save:function(e,t,i,n,a){a.stopPropagation();
var r=this.textConverter.convert(n.find("textarea").val(),!0);this.fire("save",{$set:{entityState:{id:e.id},comments:[{description:r}]},$include:[{comments:["id","description"]}]})},_cancel:function(e,t,i,n,a){a.stopPropagation(),n.remove(),i.data("ui-listSelectable")&&(i.find(".i-role-option[data-id="+e.id+"]").toggleClass(i.listSelectable("option","className"),!1),i.listSelectable("enable"))}})}),define("tau/ui/extensions/bubble/ui.extension.bubble.listResizer",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus afterRender:last + popupResize:last":function(e,t,i){this._resize(t.element,i,{})},_resize:function(i,n,a){a=e.defaults(a||{},{list:"[role=list]",additionalHeight:0});var r=n.data("ui-tauBubble").options,s=i.find(a.list),o=r.within,l=100;o||(o=r.application||t(window)),a.additionalHeight||(s.css("height",1),s.css("maxHeight",1),a.additionalHeight=i.outerHeight(!0)+150),o.length&&(l=.6*o.height()-a.additionalHeight);var u={maxHeight:l,overflowY:"auto",overflowX:"hidden",height:"auto"};s.css(u)}})}),define("tau/ui/templates/choice/ui.template.choice.option",["tau/core/templates-factory"],function(e){var t={name:"state.option",engine:"jqote2",markup:["<% if (this.items) { %>",'<div class="drop-down-group i-group">','<span class="i-group-name"><%! this.name %></span>','<%= fn.sub("state.option", this.items) %>',"</div>","<% } else { %>",'<div role="option" data-id="<%! this.id %>" class="i-role-option drop-down-option" <% if (this.description) { %> title="<%! this.description %>" <% } %> >',"<% if (this.asHtml) { %>","<%= this.name %>","<% } else { %>","<%! this.name %>","<% } %>","<% if (this.isCurrent) { %>",'<label class="drop-down-option__current">(current)</label>',"<% } %>","</div>","<% } %>"]};return e.register(t)}),define("tau/ui/templates/choice/ui.template.choice.list",["tau/core/templates-factory","tau/ui/templates/choice/ui.template.choice.option"],function(e){var t={name:"state.list",engine:"jqote2",markup:['<div class="ui-drop-down">','<div role="list" class="drop-down-list">','<div class="drop-down-list__inner i-inner">','<%= fn.sub(this.templateOption || "state.option", this.states) %>',"</div>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.choice.entityState",["tau/components/component.creator","tau/models/choice/model.choice.entityState","tau/ui/extensions/choice/ui.extension.choice.editable.entityState","tau/ui/extensions/choice.entityState/ui.extension.choice.entityState.commentByPractice","tau/ui/extensions/bubble/ui.extension.bubble.listResizer","tau/ui/templates/choice/ui.template.choice.list"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[t,i,{extType:n,args:[s.context.configurator]},a],template:r};return e.create(o,s)}}}),define("tau/models/choice/model.choice.default",["Underscore","./model.choice.base"],function(e,t){return t.extend({onInit:function(){var t=this.config,i=this.config.context.entity;this.propertyType=t.listType,this.store.get(t.listType,{fields:["id","name"]}).get(i.entityType.name,{id:i.id,fields:["id",t.listType]}).done({success:e.bind(this.onDataRetrieved,this)})},onDataRetrieved:function(t){var i=t[0].data,n=this.config.data,a={states:e.reject(i,function(e){return n&&e.id===n.id}),completed:!0};this.fire("dataBind",a)}})}),define("tau/models/choice/model.choice.static",["Underscore","./model.choice.base"],function(e,t){return t.extend({onInit:function(){var t=this,i=this.config,n=this.config.context.entity;t.store.get(n.entityType.name,{id:n.id,fields:["id",i.data.name]}).done({success:e.bind(t.onDataRetrieved,t)})},onDataRetrieved:function(t){var i=t[0].data,n=i[this.config.data.name],a=this.config.values;e.forEach(a,function(t,i){e.isObject(t)||(a[i]={id:t,name:t})});var r={states:e.reject(a,function(e){return n&&e.id==n}),completed:!0};this.fire("dataBind",r)},"bus updateState":function(e){var t={},i=null;e.data&&e.data.id&&(i=e.data.id),t[this.config.data.name]=i,this.fire("save",t)}})}),define("tau/models/choice/model.choice.priority",["Underscore","./model.choice.base"],function(e,t){return t.extend({name:"priority-list-model",propertyType:"priority",onInit:function(){var t=this,i=function(i){var n=i[0].data;
t.assignable=n,t.store.get(t.propertyType,t.createGetPrioritiesCommand()).done({success:e.bind(t.onDataRetrieved,t)})};this.getAssignable(i)},getRequiredFields:function(){return[{entityType:["id"]}]},createGetPrioritiesCommand:function(){return{fields:["id","name","importance",{entityType:["id"]}]}},processData:function(t){var i=this.getCurrentEntityId(),n=this.assignable.entityType.id,a=[];e.each(t,function(e){e.id!==i&&e.entityType.id===n&&a.push({id:e.id,name:e.name,importance:e.importance||0})}),a.sort(function(e,t){return e.importance-t.importance}),this.fire("dataBind",{states:a,completed:!0})}})}),define("tau/ui/templates/choice/relationType/ui.template.choice.relationType.option",["tau/core/templates-factory"],function(e){var t={name:"state.relationType.option",engine:"jqote2",markup:['<div data-id="<%! this.id %>" role="option" class="drop-down-option i-role-option">','<span class="tau-relation-icon tau-<%! this.name.toLowerCase() %>"></span>','<span class="tau-bubble-txt i-role-relation-type"><%! this.name %></span>',"</div>"]};return e.register(t)}),define("tau/models/choice/model.choice.relationType",["Underscore","./model.choice.base","tau/ui/templates/choice/relationType/ui.template.choice.relationType.option"],function(e,t,i){return t.extend({name:"relationType-list-model",propertyType:"relationType",onInit:function(){var t=this,i=function(i){t.assignable=i[0].data,t.store.get(t.propertyType,t.createGetRelationTypesCommand()).done({success:e.bind(t.onDataRetrieved,t)})};this.getAssignable(i)},getRequiredFields:function(){return[{relationType:["id"]}]},createGetRelationTypesCommand:function(){return{fields:["id","name"]}},processData:function(t){var n=this.assignable.relationType.id;this.fire("dataBind",{states:e.select(t,function(e){return e.id!==n}),completed:!0,templateOption:i.name})}})}),define("tau/models/choice/model.choice.severity",["Underscore","./model.choice.base"],function(e,t){return t.extend({propertyType:"severity",onInit:function(){this.store.get("bug",{id:this.config.context.entity.id,fields:[{severity:["id"]}]}).get(this.propertyType,{fields:["id","name","importance"]}).done({success:e.bind(this.onDataRetrieved,this)})
},processData:function(t,i){var n=this.getCurrentEntityId(),a=[];e.each(i,function(e){e.id!==n&&a.push({id:e.id,name:e.name,importance:e.importance})}),a.sort(function(e,t){return e.importance-t.importance}),this.fire("dataBind",{states:a,completed:!0})}})}),define("tau/models/choice/model.choice.role",["Underscore","./model.choice.base"],function(e,t){return t.extend({onInit:function(){var t=this,i=this.config,n=this.config.context.entity;this.propertyType=i.listType,t.store.get("role",{fields:["id","name"]}).get(n.entityType.name,{id:n.id,fields:["id",{role:["id","name"]}]}).done({success:e.bind(t.onDataRetrieved,t)})},onDataRetrieved:function(t){var i=t[0].data,n=this.config.data,a={states:e.reject(i,function(e){return n&&e.id===n.id}),completed:!0};this.fire("dataBind",a)}})}),define("tau/models/choice/model.choice.release",["Underscore","./model.choice.base","tau/store/types","tau/utils/utils.date"],function(e,t,i,n){return t.extend({name:"release-list",propertyType:"release",onInit:function(){var t=this.config.context.entity,i=this;this.store.get(t.entityType.name,{id:t.id,fields:["id",{project:["id",{releases:["id","name","isCurrent","startDate","endDate"]}]}]}).done({success:function(t){t[0].data.project=t[0].data.project||{};var n=e.defaults(t[0].data.project,{releases:[]});i.processData(n)}})},"bus beforeSave":function(e){var t=e.data.cmd;t.fields=t.fields||[],this.entityContainIteration()&&t.fields.push({iteration:["id","name"]})},entityContainIteration:function(){var e=i.findByKeyword(this.config.context.entity.entityType.name);return e.refs.hasOwnProperty("iteration")},getRequiredFields:function(){return[{entityState:["id"]}]},convertReleaseToDto:function(e){return{id:e.id,name:e.name,description:"From "+n.format.date.short(e.startDate)+" to "+n.format.date.short(e.endDate),isCurrent:e.isCurrent}},isOldRelease:function(e){var t=this.config.context.configurator.getCurrentDate();return e.endDate<t},isCurrentRelease:function(e){return e.isCurrent},isCurrentOrFeatureRelease:function(e){return!this.isOldRelease(e)
},selectOldReleases:function(){return e.select(this.projectReleaseList,this.isOldRelease,this)},selectCurrentAndFeatureReleases:function(){return e.select(this.projectReleaseList,this.isCurrentOrFeatureRelease,this)},getCurrentRelease:function(){return e.detect(this.projectReleaseList,this.isCurrentRelease,this)},initProjectReleaseList:function(t){var i=this.getCurrentEntityId(),a=e.select(t.releases,function(e){return e.id!=i});e.each(a,function(e){e.startDate=n.convertToTimezone(e.startDate),e.endDate=n.convertToTimezone(e.endDate)}),this.projectReleaseList=a},processData:function(t){this.initProjectReleaseList(t);var i=this.config,n=i.mode||"short",a=this.selectCurrentAndFeatureReleases(),r=[],s=this.selectOldReleases(),o=0===s.length;"short"==n&&a.length>0?r=a:(r=r.concat(s,a),o=!0),r=e.map(r,this.convertReleaseToDto,this);var l=this.getCurrentRelease(),u={nullableValue:this.isNullableValue(),states:r,completed:o};l&&(u.defaultValue=l.id),this.fire("dataBind",u)},isNullableValue:function(){return this._super()&&"iteration"!==this.config.context.entity.entityType.name.toLowerCase()}})}),define("tau/models/choice/model.choice.iteration",["Underscore","./model.choice.base","tau/utils/utils.date"],function(e,t,i){return t.extend({name:"iteration-list",propertyType:"iteration",onInit:function(){var t=this.config.context.entity,i=this;this.store.get(t.entityType.name,{id:t.id,fields:["id",{project:["id",{iterations:["id","name","startDate","endDate","isCurrent",{release:["id","name"]}]}]}]}).done({success:function(t){t[0].data.project=t[0].data.project||{};var n=e.defaults(t[0].data.project,{iterations:[]});i.processData.call(i,n)}})},getRequiredFields:function(){return[{entityState:["id"]}]},"bus beforeSave":function(e){var t=e.data.cmd.fields=e.data.cmd.fields||[];t.push({release:["id","name"]})},convertIterationToDto:function(e){var t=i.convertToTimezone(e.startDate),n=i.convertToTimezone(e.endDate);return{id:e.id,name:e.name,description:"From "+i.format.date.short(t)+" to "+i.format.date.short(n),isCurrent:e.isCurrent}
},processData:function(t){var n=this.config,a=this.getCurrentEntityId(),r=[],s=n.mode||"short",o=null,l=null,u=this.config.context.configurator.getCurrentDate(),c=function(e){e.id!==a&&r.push(e)};o="full"===s?c:function(e){var t=i.convertToTimezone(e.startDate),n=i.convertToTimezone(e.endDate);e.id!==a&&(t>=u||n>=u)&&r.push(e)},e.each(t.iterations,o),0===r.length&&(o=c,e.each(t.iterations,o));var d=[],p={};e.each(r,function(e){var t=p[e.release.id]||{id:e.release.id,name:e.release.name};t.items=t.items||[],e.isCurrent&&(l=e),t.items.push(this.convertIterationToDto(e)),p[t.id]||(d.push(t),p[t.id]=t)},this);var f=t.iterations.length,m=a&&f>0?f-1:f,h={nullableValue:this.isNullableValue(),states:d,completed:r.length-m==0};l&&(h.defaultValue=l.id),this.fire("dataBind",h)}})}),define("tau/models/choice/model.choice.teamIteration",["Underscore","./model.choice.base","tau/utils/utils.date"],function(e,t,i){return t.extend({name:"team-iteration-list",propertyType:"teamIteration",onInit:function(){var t=this.config.context.entity,i=this;this.store.get(t.entityType.name,{id:t.id,fields:["id",{team:["id",{teamIterations:["id","name","startDate","endDate","isCurrent"]}]}]}).done({success:function(t){t[0].data.team=t[0].data.team||{};var n=e.defaults(t[0].data.team,{teamIterations:[]});i.processData.call(i,n)}})},convertTeamIterationToDto:function(e){var t=i.convertToTimezone(e.startDate),n=i.convertToTimezone(e.endDate);return{id:e.id,name:e.name,description:"From "+i.format.date.short(t)+" to "+i.format.date.short(n),isCurrent:e.isCurrent}},processData:function(t){var n=this.config,a=this.getCurrentEntityId(),r=[],s=n.mode||"short",o=null,l=null,u=this.config.context.configurator.getCurrentDate(),c=function(e){e.id!==a&&r.push(e)};o="full"===s?c:function(e){var t=i.convertToTimezone(e.startDate),n=i.convertToTimezone(e.endDate);e.id!==a&&(t>=u||n>=u)&&r.push(e)},e.each(t.teamIterations,o),0===r.length&&(o=c,e.each(t.teamIterations,o));var d=[];e(r).each(function(e){!l&&e.isCurrent&&(l=e),d.push(this.convertTeamIterationToDto(e))
},this);var p=t.teamIterations.length,f=a?p-1:p,m={nullableValue:this.isNullableValue(),states:d,completed:0===d.length-f};l&&(m.defaultValue=l.id),this.fire("dataBind",m)}})}),define("tau/models/choice/model.choice.userStory",["Underscore","./model.choice.base"],function(e,t){return t.extend({name:"userStory-list",propertyType:"userStory",onInit:function(){var t=this,i=function(){t.store.get("userStory",{fields:["id","name",{project:["id","name"]}]}).done({success:e.bind(t.onDataRetrieved,t)})};i()},processData:function(t){var i=this.getCurrentEntityId(),n={};e.each(t,function(e){e.project=e.project||{},e.id!=i&&(n.hasOwnProperty(e.project.id)||(n[e.project.id]=e.project,n[e.project.id].items=[]),n[e.project.id].items.push(e))});var a={states:this.sortProjects(e.values(n)),completed:!0};this.fire("dataBind",a)}})}),define("tau/models/choice/model.choice.feature",["Underscore","./model.choice.base"],function(e,t){return t.extend({name:"release-list",propertyType:"feature",onInit:function(){var t=this;t.store.get("project",{fields:["id","name",{process:["id"]},{features:["id","name"]}]},{success:e.bind(t.onProjectRetrieved,t)}).get("feature",{fields:["id","name",{project:["id"]}]},{success:e.bind(t.onFeatureRetrieved,t)}).get("process",{fields:["id",{practices:["name"]}]},{success:e.bind(t.onProcessesRetrieved,t)}).done({success:e.bind(t.onDataRetrieved,t)})},onFeatureRetrieved:function(e){this.featureList=e.data},onProjectRetrieved:function(e){this.projectList=e.data},onProcessesRetrieved:function(e){this.processList=e.data},getFeaturesForProject:function(t){var i=this.getCurrentEntityId(),n=function(e){e.id!==i&&this.push(e)},a=[];return this.projectHasRequirementsPractice(t)&&e.each(t.features,n,a),a},onDataRetrieved:function(){this.processData(this.projectList,this.processList)},projectHasRequirementsPractice:function(t){var i=t.process.id,n=e.detect(this.processList,function(e){return e.id==i}),a=e.detect(n.practices,function(e){return"Requirements"==e.name});return!e.isEmpty(a)
},processData:function(t,i){var n=[];this.processList=i,e.each(this.sortProjects(t),function(t){var i=this.getFeaturesForProject(t);e.isEmpty(i)||n.push({id:t.id,name:t.name,items:i})},this);var a={states:n,completed:!0};this.fire("dataBind",a)}})}),define("tau/models/choice/model.choice.team",["Underscore","./model.choice.base"],function(e,t){return t.extend({propertyType:"team","bus beforeInit":function(t,i){var n=i.config.context.entity,a=i.config.context.configurator,r=a.getStore(),s=e.bind(this.fire,this);r.get("team",{fields:["id","name","icon"]}).done(function(e){s("items.ready",e[0].data)}),r.get(n.entityType.name,{id:n.id,fields:["id",{team:["id"]}]}).done(function(e){s("currentItem.ready",e[0].data.team||{})})},"bus beforeInit:last + items.ready + currentItem.ready":function(t,i,n,a){var r=i.config;n=e.sortBy(n,function(e){return e.name.toLowerCase()});var s={states:e.reject(n,function(e){return a&&e.id===a.id}),completed:!0,nullableValue:this.isNullableValue(),templateOption:r.templateOption};this.fire("dataBind",s)}})}),define("tau/components/component.choice",["tau/components/component.creator","tau/models/choice/model.choice.default","tau/models/choice/model.choice.static","tau/models/choice/model.choice.entityState","tau/models/choice/model.choice.priority","tau/models/choice/model.choice.relationType","tau/models/choice/model.choice.severity","tau/models/choice/model.choice.role","tau/models/choice/model.choice.release","tau/models/choice/model.choice.iteration","tau/models/choice/model.choice.teamIteration","tau/models/choice/model.choice.userStory","tau/models/choice/model.choice.feature","tau/models/choice/model.choice.project","tau/models/choice/model.choice.team","tau/ui/extensions/choice/ui.extension.choice.editable","tau/ui/extensions/bubble/ui.extension.bubble.listResizer","tau/ui/templates/choice/ui.template.choice.list"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v){var b={entityState:n,priority:a,severity:s,relationType:r,role:o,release:l,iteration:u,teamIteration:c,userStory:d,feature:p,project:f,team:m,"static":i};
return{create:function(t){var i=this._getModel(t),n=[i,h,g].concat(t.extensions||[]),a={extensions:n,template:v};return e.create(a,t)},_getModel:function(e){return e.model||b[e.listType]||t}}}),define("tau/views/view.collapsible",["tau/views/view.container"],function(e){var t=e.extend({"bus beforeInit":function(e){var t=e.data.config,i=t.collapsed,n=this.bus.name||"unknown";t.children=[{id:"header",type:"collapsibleHeader",name:n+" header",collapsed:i,children:t.header||[]},{id:"inners",type:"container",name:n+" inner",visible:!i,children:t.items||[]}]},"bus childrenRendered":function(e){var t=e.data.children,i=t[0],n=t[1];i.on("expanded",function(){n.fire("show")}),i.on("collapsed",function(){n.fire("hide")})},"bus expand+childrenRendered:last":function(e){var t=e.childrenRendered.data.children;t[0].fire("expand")},"bus collapse+childrenRendered:last":function(e){var t=e.childrenRendered.data.children;t[0].fire("collapse")}});return t}),define("tau/ui/extensions/collapsible/ui.extension.collapsible",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus afterRender":function(e){this.element=e.data.element,e.data.data.collapsed&&this._collapse()},"bus expand":function(){this._expand()},"bus collapse":function(){this._collapse()},_collapse:function(){this.element.addClass("closed")},_expand:function(){this.element.removeClass("closed")}})}),define("tau/ui/extensions/collapsible/ui.extension.collapsible.state",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus beforeInit":function(e){var t=this.config=e.data.config;if(t.hasOwnProperty("stateName")){var i=t[t.stateName];if(_.isNull(i)||_.isUndefined(i))return;var n="true"==i.toString().toLowerCase();t.collapsed=n,this.collapsed=n}},getStateName:function(){return this.config.stateName},onStateChanged:function(e){var t=e[this.getStateName()];(_.isNull(t)||_.isUndefined(t))&&(t=this.collapsed);var i="true"==t.toString().toLowerCase(),n=i?"collapse":"expand",a=this.config;
a.collapsed=i;var r=a.stateName;r&&(a[r]=i),this.fire(n)},"bus childrenRendered":function(e){var t=e.data.children,i=t[0];i.on("expanded",this.onExpanded,this),i.on("collapsed",this.onCollapsed,this)},onCollapsed:function(){this.saveState(!0)},onExpanded:function(){this.saveState(!1)},saveState:function(e){var t=this.getStateName();if(t&&this.config[t]!=e){var i=this,n=i.config.context.componentSettings;if(n){var a={};a[t]=e,n.set({set:a})}}},destroy:function(){var e=this,t=e.config.context.componentSettings;t&&t.unbind({listener:e}),this._super()},"bus initialize":function(){var e=this,t=e.config.context.componentSettings;t&&t.bind({fields:[this.getStateName()],listener:e,callback:e.onStateChanged})}})}),define("tau/components/component.collapsible",["Underscore","tau/core/component-base","tau/views/view.collapsible","tau/components/extensions/component.creator.extension","tau/ui/extensions/collapsible/ui.extension.collapsible","tau/ui/extensions/collapsible/ui.extension.collapsible.state","tau/ui/extensions/layout/ui.extension.layout","tau/ui/templates/container/ui.template.container.list"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u=e.clone(l)||{};e.defaults(u,{store:u.context.configurator.getStore(),template:o,cssClass:"ui-collapsible",layout:"list",collapsed:!0});var c=new t(u);return e.isArray(u.extensions)&&e.each(u.extensions,function(e){c.attach(e)}),c.attach(n).attach(a).attach(s).attach(r).attach(i).bus}}}),define("tau/ui/extensions/collapsibleHeader/ui.extension.collapsibleHeader",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var i=this;i.element=e.data.element;var n=e.data.data,a=n.collapsed;i.collapsed=a;var r=a?"collapsed":"expanded";i.element.addClass(r),i.element.bind("click",t.proxy(i._onClickHandler,i))},"bus collapse":function(){var e=this;e.collapsed||e._onClickHandler()},"bus expand":function(){var e=this;e.collapsed&&e._onClickHandler()},_onClickHandler:function(){var e=this;
e.collapsed=!e.collapsed;var t=e.collapsed,i=t?"expanded":"collapsed",n=t?"collapsed":"expanded",a=e.element;a.removeClass(i),a.addClass(n),this.fire(n)}})}),define("tau/ui/templates/collapsibleHeader/ui.template.collapsibleHeader",["tau/core/templates-factory"],function(e){var t={name:"collapsibleHeader",markup:['<div class="ui-collapsible-header">','    <div class="ui-children-container"></div>',"</div>"]};return e.register(t)}),define("tau/components/component.collapsibleHeader",["Underscore","tau/core/component-base","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/collapsibleHeader/ui.extension.collapsibleHeader","tau/ui/templates/collapsibleHeader/ui.template.collapsibleHeader"],function(e,t,i,n,a,r,s){return{create:function(o){return o=o||{},e.defaults(o,{template:s,cssClass:"ui-collapsible-header",childrenContainerSelector:".ui-children-container"}),new t(o).attach(n).attach(a).attach(r).attach(i).bus}}}),define("tau/utils/utils.htmlConverter",["tau/configurator","Underscore"],function(e,t){return{fromSourceToHtml:function(i){var n=e.getApplicationPath()+"/",a=i||"",r=/(?:<img(?=\s)(?:[^>"']|"[^"]*"|'[^']*')*?\s)src\s*=\s*("~\/([^"]*)"|'~\/([^']*)')(?:[^>]*>)/gi;a=a.replace(r,function(e,t,i,a){var r=i||a,s=t[0];return e.replace(t,function(){return s+n+r+s})});for(var s,o=/<[^<]+?>/g,l=[];null!=(s=o.exec(a));)l.push({left:s.index,right:s.index+s[0].length});return a.replace(/\w[\xa0]+\w/g,function(e,i){return t.find(l,function(e){return e.left<=i&&e.right>=i})?e:e.replace(/[\xa0]/g," ")})},fromHtmlToSource:function(t){var i=e.getApplicationPath(),n=t||"",a='(?:<img(?=\\s)(?:[^>"\']|"[^"]*"|\'[^\']*\')*?\\s)src\\s*=\\s*("'+i+'/([^"]*)"|\''+i+"/([^']*)')(?:[^>]*>)",r=new RegExp(a,"gi");return n=n.replace(r,function(e,t,i,n){var a=i||n,r=t[0];return e.replace(t,function(){return r+"~/"+a+r})})},replacePlainTextUrlWithHTML:function(e,i){var n=$("<div/>");n.html(e),i=t.isUndefined(i)?!0:i;
var a=[];n.find("a, img").each(function(e,t){var i=$(t),n="_link_"+e;a.push({origin:i,placeholderId:n}),i.replaceWith($('<div id="'+n+'" />'))});var r=n.html();r=r.replace(/\b(((http|ftp)[s]?):\/\/)([0-9a-z-?!(){}\[\]^|$,"*\.@;&:%_\/\\\\+~#=`]+)/gi,function(e){var t=e.split("?")[0],i=arguments[arguments.length-2],n=arguments[arguments.length-1],a=function(e,t){for(var i="",n="";e>1;){var a=t.substring(e-1,e);if(a.search(/\S/)>-1)if(""==n)n=a;else if(""==i){i=a;break}e-=1}return"="==n||"="==i&&'"'==n||"="==i&&"'"==n};return a(i,n)?e:t&&t.search(/\.(jpg|gif|png|jpeg)$/)>-1?"<img style='max-width: 600px' src='"+e+"'>":"<a href='"+e+"' target='_blank'>"+e+"</a>"}),n.html(r),$.each(a,function(e,t){n.find("#"+t.placeholderId).replaceWith(t.origin)});var s=n.html();return i&&(s=s.replace(/&amp;/g,"&")),s}}}),define("tau/models/dataprocessor/model.processor.comment",["Underscore","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(e,t,i){var n=function(e){this.configurator=e};return n.prototype={destroy:function(){this.context=null},convertDTO:function(e){var n=this,a="DELETED"===e.description,r=i.convertToTimezone(e.createDate),s={id:e.id,parentId:e.parentId,owner:e.owner,avatar:[e.owner.avatarUri,"32"].join(""),name:n.getName(e.owner),fullName:n.getFullName(e.owner),description:t.fromSourceToHtml(e.description),age:this.getAge(r),createDate:i.format.datetime.short(r),comments:[],deleted:a,isRequester:e.owner.kind&&"requester"===e.owner.kind.toString().toLowerCase()};return this.configurator&&this.configurator.getLoggedUser().id==e.owner.id&&(s.isOwnerComment=!0),s.actions={edit:!a,reply:a,"delete":a},s},getName:function(t){var i=t.firstName||"",n=t.lastName||"",a="";return(i.length>0||n.length>0)&&(a=[i," ",e.trim(n).substring(0,1),"."].join("")),a},getFullName:function(t){var i=t.firstName||"",n=t.lastName||"";return e.trim([e.trim(i)," ",e.trim(n)].join(""))},getAge:function(e){if(!e)return"Draft";var t=i.getAge(e,this.configurator.getCurrentDate());return t.isZero?"Just added":t.toString()
}},n}),define("tau/models/model.comment.editable",["Underscore","tau/core/model.editable.base","tau/models/dataprocessor/model.processor.comment"],function(e,t,i){var n=t.extend({name:"Editable Comments","bus applyTo":function(e){var t=this.bindedData=e.data.data;this.authorizate(t)},authorizate:function(){var e=this.bindedData.deleted,t={editable:!e,deletable:!0};this.fire("permissionsReady",t)},_convertDTO:function(t){var n=this.config,a=n.parentCommentId,r=new i(n.context.configurator),s=r.convertDTO(e.extend({},t));return s.parentId=a,s},"bus afterInit":function(t,i){this.config=i.config;var n=i.config.context.configurator,a=n.getLoggedUser(),r=n.getStore();r.get("user",{id:a.id,fields:["id","firstName","email","lastName","kind","avatarUri"]}).done(e.bind(function(e){var t={id:null,description:"",owner:e[0].data},i=this._convertDTO(t);this.bindedData=i,this.fire("dataBind",i)},this))},_fireUpdate:function(e,t){e||(t.owner={id:this.config.context.configurator.getLoggedUser().id}),t.general={id:this.config.context.entity.id},this.fire("save",{id:e,typeName:"comment",$set:t,$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName","kind","avatarUri"]}]})},"bus saveComment":function(e){var t=this,i=e.data,n=this.bindedData.id;t._fireUpdate(n,i)},"bus replyToComment":function(e){var t=this,i=e.data;t._fireUpdate(null,i)},"bus deleteComment":function(){var e=this.bindedData,t=e.id;e.comments&&e.comments.length>0?this._fireUpdate(t,{description:"DELETED"}):this.fire("remove",{id:t,typeName:"comment"})}});return n}),define("tau/ui/behaviour/common/ui.behaviour.richeditor",["Underscore","jQuery"],function(e,t){var i={};t.widget("ui.richeditor",{$target:null,$editor:null,$input:null,editor:null,ckConfig:{toolbar:"Basic",toolbarStartupExpanded:!0,toolbarCanCollapse:!1,autoGrow_maxHeight:8e3,startupFocus:!0},options:{executionGroupName:null,settings:{},saveAction:{checkChanges:!0,disableIfEmpty:!1,available:!0,text:"Done"},cancelAction:{available:!1,text:"Cancel"},onCreate:function(){},onSave:function(){},onCancel:function(){},onHide:function(){},onDestroy:t.noop},EXCLUDED_ELEMENTS:["head","base","basefont","meta","link","title","style","script","input","isindex","textarea","button","option","select","frameset","frame","iframe","object","embed","applet","bgsound","marque","blink"],hasText:function(){return this.editor?this.editor.getData().length>0:!1
},getText:function(){return this.editor?this.editor.getData():null},setText:function(e){this.editor&&this.editor.setData(e)},setStatus:function(e){this.$status.text(e)},getStatus:function(){return this.$status.text()},getTools:function(){return this.$tools},toggleSaveButton:function(e){this._getSaveButton().prop("disabled",!e)},disableSaveButton:function(){this.toggleSaveButton(!1)},enableSaveButton:function(){this.toggleSaveButton(!0)},setValidationErrors:function(t){this.element.addClass("ui-validationerror"),e.isString(t)&&this.element.attr("title",t)},resetValidationErrors:function(){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title")},setValue:function(e){this.setText(e)},_getSaveButton:function(){return this.$tools.find(".i-role-actionsave")},_create:function(){var i=t(this.element);i.addClass("editable"),this.$target=i,i.attr("id",e.uniqueId("richeditor_")),this.ckConfig.contentsCss=this.options.ckPath+"/new/custom/content.css";var n={};t.extend(!0,n,this.ckConfig,this.options.settings),this.options.settings=n,this.options.ckConfig=n,i.on("dblclick",e.bind(function(e){t.clearSelection(),"a"!=e.target.tagName.toLowerCase()&&this.show()},this))},show:function(){this._visible||(this._visible=!0,this.createEditor())},createEditor:function(){var n=this.$target,a=this.options,r=a.saveAction,s=a.cancelAction;this.$tools=t(['<div class="ui-richeditor__controls button-group">',r.available?'<button class="i-role-actionsave tau-btn" type="button">'+r.text+"</button>":"",s.available?'<button class="i-role-actioncancel tau-btn" type="button">'+s.text+"</button>":"",'<div class="i-role-statusmessage ui-richeditor__controls__status_message"></div>',"</div>"].join(""));var o=this.$tools;this.$status=o.find(".i-role-statusmessage");var l=this._createFailed.bind(this);t.when(this.loadScripts()).then(function(){var e=t.Deferred();if(n.parents("body").length)e.resolve();else var i=window.setInterval(function(){n.parents("body").length&&(e.resolve(),window.clearInterval(i))
},10);return e},l).then(function(){var e=t.Deferred();try{var i=a.ckInlined?CKEDITOR.inline:CKEDITOR.replace,r=i(n.attr("id"),a.ckConfig);CKFinder.SetupCKEditor(r,a.ckPath+"/new/ckfinder/"),r.on("instanceReady",function(t){t.editor.dataProcessor.writer.lineBreakChars="\r\n",a.text&&t.editor.setData(a.text),e.resolve(t.editor)}),this.editor=r}catch(s){e.reject(s)}return e}.bind(this),l).then(function(n){this._configureHtmlOutput(n);var l=a.executionGroupName;if(l&&i[l]&&(i[l].options.onCancel(),i[l]=null),i[l]=this,n.on("change",e.bind(function(){this._trigger("change")},this)),(r.available||s.available)&&(t(n.container.$).after(o),o.on("click.richeditor",".i-role-actionsave",e.bind(function(){a.onSave(this.getText())},this)),o.on("click.richeditor",".i-role-actioncancel",e.bind(function(){a.onCancel(this.getText())},this))),r.available&&r.disableIfEmpty){var u=o.find(".i-role-actionsave");u.prop("disabled",!this.hasText()),this.element.on("richeditorchange",e.debounce(e.bind(function(){u.prop("disabled",!this.hasText())},this),500))}a.onCreate(this),this._trigger("create")}.bind(this),l)},_createFailed:function(){this._visible=!1},hide:function(e){if(this._visible=!1,this.editor)try{this.editor.focusManager.blur(),this.editor.document&&this.editor.document.getBody().clearCustomData(),this.editor.destroy(!e),this.editor=null}catch(t){console&&console.log&&console.log(t)}this.$tools&&this.$tools.remove();var n=this.options.executionGroupName;n&&i[n]&&i[n]===this&&(i[n]=null),this.options.onHide()},destroy:function(){this._super(),this.hide(),this.options.onDestroy()},loadScripts:function(){var e=t.Deferred();if(window.CKEDITOR)return e.resolve(),e;var i=this.options.ckPath,n=i+"/new/ckeditor/ckeditor.js",a=i+"/new/ckfinder/ckfinder.js";return require([n],function(){window.CKEDITOR&&(window.CKEDITOR.disableAutoInline=!0),require([a],e.resolve)}),e},_configureHtmlOutput:function(t){var i=this.EXCLUDED_ELEMENTS,n={elements:{$:function(t){return e.indexOf(i,t.name)>0?!1:(e.each(["class","id","role"],function(e){t.attributes[e]&&delete t.attributes[e]
}),t)},a:function(t){return e.trim(t.attributes.href).match(/^javascript:/gi)&&(delete t.attributes.href,delete t.attributes["data-cke-saved-href"]),t},style:function(){return!1},script:function(){return!1}},attributeNames:[[/^on/,"no"]]},a=t.dataProcessor;a.htmlFilter.addRules(n),a.dataFilter.addRules(n)}})}),define("tau/ui/extensions/comment/mention.ckeditor.plugin",["require","tau/core/class","jQuery","Underscore","tau/utils/utils.convertUserName"],function(e){var t=e("tau/core/class"),i=e("jQuery"),n=e("Underscore"),a=e("tau/utils/utils.convertUserName"),r=t.extend({init:function(e){this.currentAutoComplete=null;var t=e.editor;this.editor=t,this.configurator=e.configurator,this._registerFeature(t),t.on("contentDom",function(){var a=t.editable();if(e.mentionUser){var r=this._createMention(e.mentionUser);t.setData(r.getOuterHtml(),function(){t.focus();var e=t.widgets.instances[0].element.$.parentNode,i=t.createRange(),n=new CKEDITOR.dom.element(e);i.moveToElementEditablePosition(n,e.textContent.length),i.select()})}i(a.$).on("keydown",function(e){this._navigate(e.which,e)}.bind(this)),t.on("change",function(){var e=this._getCurrentWord()||"";e=e.replace(/\u200b/,""),e.length>1&&0===n.trim(e).indexOf("@")?this._getPeople(n.trim(e)):""!==e&&this._destroyAutocomplete()}.bind(this))}.bind(this)),t.on("destroy",function(){this._destroyAutocomplete()}.bind(this)),t.on("key",function(e){13==e.data.keyCode&&this.autoCompleteIsVisible()&&e.cancel()}.bind(this)),t.on("blur",function(){this._destroyAutocomplete()}.bind(this))},_registerFeature:function(e){var t={span:{attributes:"data-mention"}};e.addFeature({name:"mention",allowedContent:t}),e.widgets.add("mention",{allowedContent:t,draggable:!1,inline:!0,template:'<span data-metion="">Name user</span>',upcast:function(e){return"span"==e.name&&e.attributes["data-mention"]}})},autoCompleteIsVisible:function(){return this.currentAutoComplete&&this.currentAutoComplete.tauUserAutocomplete("widget").is(":visible")},_getCurrentWord:function(){var e=this.editor.getSelection().getRanges()[0],t=e.startContainer;
if(t.type==CKEDITOR.NODE_TEXT&&e.startOffset){var i=t.getText().lastIndexOf(" ",e.startOffset)+1,n=t.getText().indexOf(" ",e.startOffset);return-1==i&&(i=0),-1==n&&(n=t.getText().length),t.getText().substring(i,n)}return null},_destroyAutocomplete:function(){this.currentAutoComplete&&(this.currentAutoComplete.tauUserAutocomplete("destroy"),this.currentAutoComplete=null)},_createMention:function(e){var t=a.getFullName(e),i=this.editor.document.createElement("span");return i.appendText(t),i.setAttribute("data-mention",e.email),i},_getPeople:function(e){var t=this,n=t.editor,a=n.getSelection().getRanges()[0],r=parseInt(a.startOffset-e.length,10)||0,s=a.startContainer.$,o=this.configurator;i(s.parentNode).tauUserAutocomplete({appendTo:"body",minLength:0,store2:o.getStore2(),open:function(){o.getKeyBoardManager().pushHandler({})},close:function(){o.getKeyBoardManager().popHandler()},select:function(e,t){var i=this;i._destroyAutocomplete();var a=t.item;s.textContent=s.textContent.substr(0,r);var o=this._createMention(a);s.nextSibling?s.parentNode.insertBefore(o.$,s.nextSibling):s.parentNode.appendChild(o.$),n.widgets.initOn(o,"mention"),n.focus();var l=n.createRange(),u=new CKEDITOR.dom.element(o.$.parentNode);l.moveToElementEditablePosition(u,o.$.parentNode.textContent.length),l.select()}.bind(this)}),this.currentAutoComplete=i(s.parentNode),this.currentAutoComplete.tauUserAutocomplete("search",e.replace("@",""))},_navigate:function(e,t){var a=[i.ui.keyCode.ENTER,i.ui.keyCode.LEFT,i.ui.keyCode.RIGHT,i.ui.keyCode.DOWN,i.ui.keyCode.UP,i.ui.keyCode.HOME,i.ui.keyCode.END];(i.ui.keyCode.ESCAPE===e||i.ui.keyCode.DELETE===e)&&this._destroyAutocomplete(),n.contains(a,e)&&this.currentAutoComplete&&this.currentAutoComplete.tauUserAutocomplete("widget").trigger(i.Event("keydown",t))}});return{getMentionPlugin:function(e){return function(t){return new r({configurator:e.configurator,mentionUser:e.mentionUser,editor:t})}}}}),define("tau/ui/extensions/comment.add/ui.extension.comment.add",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor","tau/ui/extensions/comment/mention.ckeditor.plugin"],function(e,t,i,n,a){var r=i.extend({category:"edit","bus afterRender":function(e){this.element=e.data.element,this.initializeEditor()
},onSave:function(e){this.fire("editorSave"),this.fire("saveComment",{description:e}),this.closeEditor()},onCancel:function(){this.closeEditor()},closeEditor:function(){this.fire("destroy")},initializeEditor:function(){var i=this.element,n=i,r=n.find(".ui-comment-text"),s="richeditor";if(!r.data("ui-richeditor")){var o=this.config.context.configurator;r=r[s]({ckPath:this.config.context.configurator.getCkPath(),text:"",settings:{toolbar:"Basic",removePlugins:"autogrow,magicline",allowedContent:!0,MentionPlugin:a.getMentionPlugin({configurator:o}),height:200},executionGroupName:"comments",onSave:e.bind(this.onSave,this),onCancel:e.bind(this.onCancel,this),onCreate:e.bind(function(){var e=i.parents(".ui-popup-content:first");0===e.length&&(e=t(window)),e.scrollTo(r.parent(),100),this.fire("$editor.ready",r),this.fire("$editorHolder.ready",n)},this),saveAction:{text:"Add comment",disableIfEmpty:!0},cancelAction:{available:!0}})}r[s]("show")}});return r}),define("tau/ui/templates/comment.add/ui.template.comment.notifications",["tau/core/templates-factory"],function(e){var t={name:"comment.notifications",engine:"jqote2",markup:['<div class="tau-notification-practices-settings">','<span class="prompt">Notify by email: </span>',"<% if (this.owner){ %>",'<label><input type="checkbox" value="Owner" />Owner</label>',"<% } %>","<% if (this.assigned){ %>",'<label><input type="checkbox" value="Assigned" />Assigned people</label>',"<% } %>","<% if (this.requesters){ %>",'<label><input type="checkbox" value="Requesters" />Requester(s)</label>',"<% } %>","<% if (this.team){ %>",'<label><input type="checkbox" value="Team" />Project Team</label>',"<% } %>","</div>"]};return e.register(t)}),define("tau/ui/extensions/comments/ui.extension.comment.practices.notification",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/comment.add/ui.template.comment.notifications"],function(e,t,i,n){var a=i.extend({category:"edit","bus editorSave":function(){if(this.globalSettings.IsEmailNotificationsEnabled){var e=this;
e.config.store.on({eventName:"beforeSave",type:"comment",listener:e},function(t){var i=t.data;e.beforeSaveComment(i)})}},"bus $editorHolder.ready":function(e,t){var i={config:this.config};this.globalSettings=i.config.context.applicationContext.globalSettings||{};var a=i.config.context.configurator,r=i.config.context.entity,s=r.entityType.name.toLowerCase();if(this.globalSettings.IsEmailNotificationsEnabled){var o=a.getTemplateFactory().get(n.name).bind({},{owner:!0,assigned:!0,requesters:"request"==s,team:"request"!==s});o.prependTo(t.find(".ui-richeditor__controls")),this.placeHolder=o}},"bus destroy":function(){this.config.store.unbind(this),this._super.apply(this,arguments)},beforeSaveComment:function(e){var i=this.placeHolder.find('input[type="checkbox"]'),n={};i.each(function(e,i){var a=t(i);a.prop("checked")&&(n[a.val()]=!0)}),e.cmd["comment-practices-notification-opts"]=n}});return a}),define("template!tau/ui/templates/comment.add/ui.template.comment.mention.hint",["tau/core/templates-factory"],function(e){var t={name:"comment.mention.hint",engine:"jqote2",customFunctions:null,markup:'<div class="ui-comment__mention-text">Type @ to mention somebody</div>'};return e.register(t)}),define("tau/ui/templates/comment.add/ui.template.comment.add",["tau/core/templates-factory","template!tau/ui/templates/comment.add/ui.template.comment.mention.hint"],function(e){var t={name:"comment.add",engine:"jqote2",markup:['<div class="ui-comment-new">','<div class="ui-comment-heading">','<img class="ui-comment-avatar" src="<%= this.avatar %>" title="<%! this.fullName %>" />',"</div>",'<div class="ui-comment-editor-placeholder tau-clientinput">','<div class="ui-comment-text"></div>','<%= fn.sub("comment.mention.hint", {}) %>',"</div>","</div>"]};return e.register(t)}),define("tau/components/component.comment.add",["tau/components/component.creator","tau/models/model.comment.editable","tau/ui/extensions/comment.add/ui.extension.comment.add","tau/ui/extensions/comments/ui.extension.comment.practices.notification","tau/components/extensions/component.creator.extension","tau/ui/templates/comment.add/ui.template.comment.add"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[t,i,n,a],template:r};
return e.create(o,s)}}}),define("tau/ui/templates/comments/ui.template.comments.actions",["tau/core/templates-factory","template!tau/ui/templates/comment.add/ui.template.comment.mention.hint"],function(e){var t={name:"comments.actions",engine:"jqote2",markup:['<li class="ui-comment-menu button-group">',"<% if (this.editable){ %>",'<a class="reply button small"><span class="icon"></span>reply</a>','<a class="edit button small"><span class="icon"></span>edit</a>',"<% } %>","<% if (this.deletable){ %>",'<a class="delete button danger small"><span class="icon"></span>delete</a>',"<% } %>","</li>","<% if (this.editable){ %>",'<div class="ui-comment-reply tau-clientinput">','<div class="ui-editor-placeholder" style="display: none;"></div>','<%= fn.sub("comment.mention.hint", {}) %>',"</div>","<% } %>"]};return e.register(t)}),define("tau/ui/extensions/comment/ui.extension.comment.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/comments/ui.template.comments.actions","tau/ui/behaviour/common/ui.behaviour.richeditor","tau/ui/extensions/comment/mention.ckeditor.plugin"],function(e,t,i,n,a,r){return i.extend({category:"edit",destroy:function(){this.destroyDynamicComponents(),this._super()},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){var e=this;e.componentList&&(e.componentList.destroy(),delete e.componentList)},"bus applyTo + permissionsReady":function(e){var t=e.applyTo.data,i=e.permissionsReady.data;this.applyPermissions(t.config,t.data,t.element,i)},"bus applyTo":function(e,t){this.comment=t.data},applyPermissions:function(t,i,a,r){var s=this.config=e.extend({},t,{comment:i}),o=this.element=a,l=o.children(".ui-comment-body"),u=this.config.context.configurator.getTemplateFactory().get(n.name).bind({},r);l.children(".ui-comment-heading").append(u.eq(0)),l.append(u.eq(1)),r.editable&&l.addClass("editable"),r.deletable&&l.addClass("deletable"),u.on("click",".reply",e.bind(this.onReply,this,i.owner)),u.on("click",".edit",e.bind(this.onEdit,this)),u.on("click",".delete",e.bind(this.onDelete,this));
var c=o.children(".ui-comments"),d={components:[{type:"commentList"}],context:s.context};this.componentList||this.createComponents(d,e.bind(function(t){var n=t[0],a={element:c,data:{comments:i.comments||[]},config:e.extend({},n.config,{commentId:this.config.comment.id})};this.componentList=n.component,n.component.fire("applyTo",a)},this))},showEditorForEdit:function(){var t=this.element.find("> .ui-comment-body > .ui-comment-text"),i=this.comment;this.showEditor({element:t,text:i.description,checkChanges:!1,saveHandler:e.bind(function(e){this.fire("saveComment",{description:e})},this)})},showEditorForReply:function(e){var t=this,i=this.element.find("> .ui-comment-body > .ui-comment-reply > .ui-editor-placeholder"),n=this.comment;t.showEditor({element:i,text:"",hideTarget:!1,mentionUser:e,saveText:"Add Reply",saveHandler:function(e){t.fire("replyToComment",{description:e,parentId:n.id})}})},showEditor:function(i){var n=i.element,a="richeditor",s=n.parent(),o=n;if(!o.data("ui-richeditor")){var l=this.config.context.configurator,u={configurator:l,mentionUser:i.mentionUser};o=o[a]({ckPath:l.getCkPath(),text:i.text,settings:{toolbar:"Basic",removePlugins:"autogrow,magicline",allowedContent:!0,MentionPlugin:r.getMentionPlugin(u),height:200},executionGroupName:"comments",onSave:e.bind(function(e){this.fire("editorSave"),o[a]("hide"),i.saveHandler.call(this,e)},this),onCancel:function(){o[a]("hide")},onCreate:e.bind(function(){var e=n.parents(".ui-popup-content:first");0===e.length&&(e=t(window)),e.scrollTo(o.parent(),100),this.fire("$editor.ready",o),this.fire("$editorHolder.ready",s)},this),saveAction:{text:i.saveText||"Save",disableIfEmpty:!0,checkChanges:i.checkChanges},cancelAction:{available:!0}})}o[a]("show")},onReply:function(e,t){t.stopPropagation(),t.preventDefault(),this.showEditorForReply(e)},onEdit:function(e){e.stopPropagation(),e.preventDefault(),this.showEditorForEdit()},onDelete:function(){var t=this.element.find("> .ui-comment-body");t.confirmation({message:"Delete comment?",ok:e.bind(this.onConfirmDelete,this),cancel:e.bind(this.onCancelDelete,this)}),t.confirmation("show")
},onCancelDelete:function(e){e.stopPropagation(),e.preventDefault(),this.element.find("> .ui-comment-body").confirmation("hide")},onConfirmDelete:function(e){e.stopPropagation(),e.preventDefault(),this.fire("deleteComment")}})}),define("tau/ui/templates/comments/ui.template.comments.comment",["tau/core/templates-factory","template!tau/ui/templates/comment.add/ui.template.comment.mention.hint"],function(e){var t={name:"comments.comment",engine:"jqote2",markup:['<div class="ui-comment comment-id-<%= this.id %> i-role-comment" data-id="<%= this.id %>">','<div class="ui-comment-body',"<% if (this.isOwnerComment){ %> ui-commets-comment-owner<% } %>","<% if (this.isRequester){ %> tau-comments-requester<% } %>",'">',"<% if (this.deleted){ %>","DELETED","<% } else { %>",'<div class="ui-comment-heading">','<img class="ui-comment-avatar" src="<%= this.avatar %>" title="<%! this.fullName %>" />','<span class="ui-comment-name"><%! this.fullName %></span>','<span class="ui-comment-ago"><span title="<%= this.createDate %>">(<%! this.age %>)</span></span>',"</div>",'<div class="ui-comment-text tau-clientinput"><%= this.description %></div>','<%= fn.sub("comment.mention.hint", {}) %>',"<% } %>","</div>",'<div class="ui-comments">',"<% if (this.comments){ %>",'<%= fn.sub("comments.comment", this.comments) %>',"<% } %>","</div>","</div>"]};return e.register(t)}),define("tau/components/component.comment",["tau/components/component.creator","tau/models/model.comment.editable","tau/ui/extensions/comment/ui.extension.comment.editable","tau/ui/extensions/comments/ui.extension.comment.practices.notification","tau/components/extensions/component.creator.extension","tau/ui/templates/comments/ui.template.comments.comment"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[t,i,n,a],template:r};return e.create(o,s)}}}),define("tau/ui/extensions/comments/ui.extension.commentList.editable",["tau/components/extensions/component.extension.base"],function(e){var t=e.extend({destroy:function(){this.destroyDynamicComponents(),this._super()
},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){var e=this;if(e.dynamicComponents&&e.dynamicComponents.length)for(var t=null;t=e.dynamicComponents.pop();)t.destroy()},"bus applyTo":function(e){var t=this;t.dynamicComponents=[];var i=e.data,n=i.data.comments;this.element=i.element;var a=i.element.children(".ui-comment");this.config=i.config;var r=i.config.context,s={components:[],context:r};a.each(function(){s.components.push({type:"comment"})}),t.createComponents(s,function(e){for(var i=0,r=e.length;r>i;i++){var s=e[i],o={element:a.eq(i),data:n[i],config:s.config};s.component.fire("applyTo",o),t.dynamicComponents.push(s.component)}})}});return t}),define("tau/components/component.commentList",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/comments/ui.extension.commentList.editable"],function(e,t,i){return{create:function(n){var a={extensions:[t,i]};return n.name="comment.commentList",e.create(a,n)}}}),define("tau/ui/extensions/baseList/ui.extension.baseList",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus beforeInit":function(e){var t=e.data.config;this.options={emptyDataMessage:t.emptyDataMessage||"No data",contentSelector:t.contentSelector||null,emptyElementCssClass:t.emptyElementCssClass||"ui-empty-data-msg"}},"bus dataBind+afterRender":function(e){this.element=e.afterRender.data.element,0===e.dataBind.data.items.length&&this._applyToggleNoData(!0)},"bus hideListContent":function(){this._applyToggleNoData(!0)},"bus showListContent":function(){this._applyToggleNoData(!1)},_applyToggleNoData:function(e){this._toggleNoData(e)},_getVisibilityMethodName:function(e){return e?"show":"hide"},_toggleNoData:function(e){var t=this._getVisibilityMethodName(!e),i=this._getVisibilityMethodName(e),n=this.element,a=this.options;n.find(a.contentSelector)[t](),this._getNoDataMessageElement(n,a)[i]()
},_getNoDataMessageElement:function(e,i){var n=e.find("."+i.emptyElementCssClass);return 0===n.length&&(n=t(['<span class="',i.emptyElementCssClass,'">',i.emptyDataMessage,"</span>"].join("")).appendTo(e)),n}})}),define("tau/components/component.list.creator",["tau/components/component.creator","tau/ui/extensions/baseList/ui.extension.baseList"],function(e,t){return{create:function(i,n){return n.emptyDataMessage=i.message,n.contentSelector=i.template.options.contentSelector,i.showEmptyMessage!==!1&&(i.extensions=i.extensions||[],i.extensions.push(t)),e.create(i,n)}}}),define("tau/models/model.comments",["Underscore","tau/core/model-base","tau/models/dataprocessor/model.processor.comment"],function(e,t,i){return t.extend({name:"Comments",FIELDS:["id",{comments:["id","description","createDate","parentId",{owner:["id","firstName","lastName","kind","avatarUri","email"]}],list:!0}],onInit:function(){this.converter=new i(this.config.context.configurator),this._requestAssignable()},"bus createDTO":function(e){var t=this.converter.convertDTO(e.data);t.comments=[],this.fire("DTOCreated",t)},_requestAssignable:function(){var e=this.config.context.entity,t={id:e.id,fields:this.FIELDS},i={success:this.safeCallback(this._onAssignableRetrieved)};this.store.get(e.entityType.name,t,i).done()},_onAssignableRetrieved:function(t){this.assignable=t.data;var i=t.data.comments,n=e.sortBy(i,function(e){return e.id});this._convertDTO(n);var a=this._convertToTree(null);this.bus.fire("dataBind",{items:a})},_convertDTO:function(t){return this.convertedComments=e.map(t,function(e){return this.converter.convertDTO(e)},this),this},_convertToTree:function(e){for(var t=[],i=this.convertedComments,n=0,a=i.length;a>n;n++){var r=i[n];r.parentId==e&&(t.push(r),r.comments=this._convertToTree(r.id))}return t},destroy:function(){this.converter.destroy(),this.converter=null,this._super()}})}),define("tau/models/model.comments.editable",["Underscore","tau/core/model.editable.base"],function(e,t){var i=t.extend({name:"Editable Comments",_signUpEventsIfRequired:function(){var e=this;
if(!e._signedUp){e._signedUp=!0;var t=function(t){t.data.cmd.guid=+new Date,e.fire("prepareUpdate",t.data)},i=function(t){e.fire("applyUpdate",t.data)},n=function(t){t.data.cmd.guid=+new Date,e.fire("prepareRemove",t.data)},a=function(t){var i=t.data.obj.parentId,n=e.getComment(i);n&&n.deleted&&1===n.comments.length?e.store.remove("comment",{id:i}).done():e.fire("applyRemove",t.data)};e.store.unbind(e),e.store.on({eventName:"beforeSave",type:"comment",listener:e},t).on({eventName:"afterSave",type:"comment",listener:e},i).on({eventName:"beforeRemove",type:"comment",listener:e},n).on({eventName:"afterRemove",type:"comment",listener:e},a)}},"bus dataBind":function(t){var i=t.data.items;this.commentsList=this.getPlainList(i);var n=e(this.commentsList).pluck("id"),a={editable:!0,editableItems:n,deletable:!0,deletableItems:n},r=this;r._signUpEventsIfRequired(),r.fire("permissionsReady",a)},getComment:function(t){var i=t?e(this.commentsList).detect(function(e){return e.id===t}):null;return i},getPlainList:function(e){for(var t=[],i=0,n=e.length;n>i;i++){var a=e[i];t.push(a);var r=arguments.callee.call(this,e[i].comments);t=t.concat(r)}return t}});return i}),define("tau/ui/extensions/comments/ui.extension.comments.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){var n=i.extend({category:"edit",destroy:function(){var e=this;e.destroyDynamicComponents(),e._super()},destroyDynamicComponents:function(){var e=this;e.commentListComponent&&(e.commentListComponent.destroy(),delete e.commentListComponent)},"bus dataBind+afterRender":function(e){var t=this;t.destroyDynamicComponents();var i={comments:e.dataBind.data.items},n=this.element=e.afterRender.data.element,a=".ui-all-comments",r=n.find(a),s={components:{type:"commentList"},context:this.config.context};t.createComponents(s,function(e){t.commentListComponent=e[0].component;var n={element:r,data:i,config:s};t.commentListComponent.fire("applyTo",n)})},getGUIDSelector:function(e){return"guid-comment-"+e
},getCommentIdClass:function(e){return"comment-id-"+e},"bus prepareUpdate":function(e){var i=e.data.cmd,n=null,a=i.config.$set.parentId,r=".ui-all-comments"+(a?" ."+this.getCommentIdClass(a)+" .ui-comments":""),s=this.getGUIDSelector(i.guid);if(i.config.id){var o=this.getCommentIdClass(i.config.id);n=this.element.find(".ui-all-comments ."+o)}else n=t("<div class='ui-comment "+s+"'><div class='ui-comment-body'>Adding new comment. Please wait...</div></div>").appendTo(this.element.find(r));this.fire("markElementToBeUpdated",{element:n})},"bus applyUpdate":function(e){var t=this,i=e.data.cmd,n=i.guid,a=this.getCommentIdClass(e.data.id);if(!i.config.id){var r=this.getGUIDSelector(n),s=this.element.find(".ui-all-comments").find("."+r);s.addClass(a).removeClass(r)}this.on("afterRender",function(e){e.removeListener();var i=e.data.element,n=i.find("."+a+" > .ui-comment-body");t.fire("updateElement",{element:n})}),this.fire("refresh")},"bus prepareRemove":function(e){var t=e.data.cmd,i=this.getCommentIdClass(t.config.id),n=this.element.find(".ui-all-comments ."+i);this.fire("markElementToBeDeleted",{element:n})},"bus applyRemove":function(e){var t=this,i=e.data.cmd,n=this.getCommentIdClass(i.config.id),a=this.element.find(".ui-all-comments ."+n);this.fire("deleteElement",{element:a,callback:function(){t.fire("refresh")}})}});return n}),define("tau/ui/extensions/comments/ui.extension.comments.add",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({category:"edit",destroy:function(){this.destroyDynamicComponents(),this._super()},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){this.commentNewEditorComponent&&(this.commentNewEditorComponent.destroy(),delete this.commentNewEditorComponent)},"bus initialize":function(e){this.config=e.data},"bus afterRender + permissionsReady + dataBind":function(e,t,i,n){this.element=t.element,this.data=n,this.initializeAddCommentLink()
},initializeAddCommentLink:function(){this.$addLink=t("<span class='ui-comments-add-link i-role-actionadd'>Add Comment</span>").click(t.proxy(this.addNewComment,this)).insertAfter(this.element.find(".ui-all-comments"))},onCloseEditor:function(){this.$addLink.show()},addNewComment:function(){this.$addLink.hide();var t={components:[{name:"comment.add",type:"comment.add"}],context:this.config.context};this.createComponents(t,e.bind(function(t){var i=this.commentNewEditorComponent=t[0].component;i.on("afterRender",e.bind(function(e,t){t.element.insertAfter(this.$addLink)},this)),i.on("$editor.ready",e.bind(function(e,t){this.fire("comment.add.$editor.ready",t)},this)),i.on("destroy",e.bind(this.onCloseEditor,this)),i.initialize()},this))}})}),define("tau/ui/extensions/comments/ui.extension.comments.refresher",["tau/components/extensions/component.extension.base"],function(e){return e.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refresh:function(){var e=this.config.context.entity;this.config.store.evictProperties(e.id,e.entityType.name,["comments"]),this.fire("refresh")},onBugWasMarkedAsDuplicate:function(e){var t=this.config.context.entity.id;(t===e.data.bugId||t===e.data.duplicateBugId)&&this.refresh()}})}),define("tau/ui/extensions/comments/ui.extension.comments.notify",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.convertUserName"],function(e,t,i,n){return i.extend({category:"edit","bus afterRender":function(e,t){this.firstRender||(this.$oldDescription=t.element.clone(!0),this.firstRender=!0)},"bus afterRender:last + applyUpdate":function(t,i,n){var a={config:this.config};this.globalSettings=a.config.context.applicationContext.globalSettings||{},this._getUsersNotify(n,this.config,this.$oldDescription).then(this.safeCallback(function(t){if(this.$oldDescription=i.element.clone(!0),t=e.compact(t),t.length>0)if(this.globalSettings.IsEmailNotificationsEnabled){t=e.chain(t).pluck("name").uniq().compact().value();
var n=this._buildMessage(t);this._callErrorBarServiceWithMessage(n,this.config)}else this._callErrorBarServiceWithMessage("No email notification was sent as Email Notifications are disabled in System Settings.",this.config,!0)}.bind(this)))},_getFromNotificationPractices:function(i,n){var a=i["comment-practices-notification-opts"],r=n.context.entity,s={Owner:this._getOwnerName,Assigned:this._getNamesAssignmentUsers,Team:this._getProjectTeam,Requesters:this._getRequesters},o=e.reduce(a,function(e,t,i){return t&&e.push(s[i]),e},[]),l={entity:r},u=e.map(o,function(e){return e.call(this,l)},this);return t.when.all(u).then(function(t){return e.chain(t).flatten().reject(function(e){return e.id==n.context.configurator.getLoggedUser().id}).value()},function(){return[]})},_buildMessage:function(t){var i="Email notification was sent",n=" to ",a=i+n;return t.length>3?a+=t.length+" people":(a+=e.compact(t).join(", "),a==i+n&&(a=i)),a},_getOwnerName:function(e){var t=e.entity,i=t.entityType.name,a=t.id;return this.store.getDef(i,{id:a,fields:["id",{owner:["id","firstName","lastName","email"]}]}).then(function(e){return{id:e.owner.id,name:n.getFullName(e.owner)}})},_getProjectTeam:function(){return{name:null}},_getRequesters:function(t){var i=t.entity,a=i.entityType.name,r=i.id,s={};return s.requesters=["id","firstName","lastName","avatarUri","email"],this.store.getDef(a,{id:r,fields:["id",s]}).then(function(t){return e.map(t.requesters,function(e){return{id:e.id,name:n.getFullName(e)}})})},_getUsersFromMention:function(i,n,a){var r=t(i).find("[data-mention]"),s=n.find('[data-id="'+a+'"]').find("[data-mention]"),o=function(i){return e.map(i,function(e){return t(e).data("mention")})},l=o(s);return e.reduce(r,function(i,n){var a=t(n);return e.contains(l,a.data("mention"))||i.push({name:a.text()}),i},[])},_getNamesAssignmentUsers:function(t){var i=t.entity,a=i.entityType.name,r=i.id,s={},o="project"==a?"projectMembers":"assignments",l="project"==a?{user:["id","firstName","lastName","avatarUri","email"]}:{generalUser:["id","firstName","lastName","avatarUri","email"]};
return s[o]=[l],this.store.getDef(a,{id:r,fields:["id",s]}).then(function(t){return e.map(t.assignments||t.projectMembers,function(e){var t=e.generalUser||e.user;return{id:t.id,name:n.getFullName(t)}})})},_getUsersNotify:function(e,i,n){var a=this._getUsersFromMention(e.cmd.config.$set.description,n,e.id),r=this._getFromNotificationPractices(e.cmd,i);return t.when(a,r).then(function(e,t){return e.concat(t)})},_callErrorBarServiceWithMessage:function(e,t,i){i=i||!1;var n=i?"warning":"success",a=t.context.configurator.service("errorBar");a.fire("notification",{$node:e,delay:1e4,type:n,disableAutoClose:!1})}})}),define("tau/ui/extensions/content/ui.extension.content.shortcutProcessor",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.htmlConverter","tau/core/termProcessor"],function(e,t,i,n,a){return i.extend({FIELDS:["id","name",{entityType:["id","name"]}],"bus beforeInit + afterRender":function(i,n,a){var r=n.config.shortcutProcessorTarget,s=a.element.find(r);t.when(this.processShortcuts(s,n.config.context)).then(e.bind(this.fire,this,"shortcuts.completed",{}))},processShortcuts:function(i,n){var a=e.values(this._replaceEntityIds(i)),r=t.Deferred();return e.any(a)?n.configurator.getStore().find("general",{fields:this.FIELDS,$query:{id:{$in:a}}}).done({success:this.safeCallback(function(e){this._replaceShortcutsWithLink(a,e[0].data,i,n),r.resolve()})}):r.resolve(),r},_replaceEntityIds:function(e){var i=/\b(?:id):(?:\W|&nbsp;){0,5}(\d{1,9})\b/gi,a={};return e.each(function(e,r){var s=t(r),o=!1,l=s.html().replace(i,function(){o=!0;var e=arguments[1];return a[e]=e,'<span class="tau-shortcut tau-shortcut_state_loading" data-entity-id="'+e+'">id:'+e+"</span>"}),u=n.replacePlainTextUrlWithHTML(l,!1);l!=u&&(l=u,o=!0),o&&s.html(l)}),a},_replaceShortcutsWithLink:function(t,i,n,r){this.urlBuilder=r.configurator.getUrlBuilder();var s=r.getTerms?r.getTerms():[];this.processor=new a(s),e.forEach(t,function(t){var a=e.find(i,function(e){return e.id==t
}),r=n.find(".tau-shortcut[data-entity-id="+t+"]");a?this._replaceShortcutWithLink(r,a):this._replaceNotFoundShortcutWithLink(r,{id:t})},this)},_replaceNotFoundShortcutWithLink:function(e,i){e.each(function(){t(this).toggleClass("tau-shortcut_state_loading",!1).toggleClass("tau-shortcut_state_failure",!0).attr("title","Entity with id "+i.id+" is not found")})},_replaceShortcutWithLink:function(e,i){var n=this.urlBuilder.getNewViewUrl(i.id,i.entityType.name,!0),a="#"+i.id+"&nbsp;"+t.jqotenc(i.name),r=this.processor.getTerm(i.entityType.name)+" #"+i.id+" "+i.name;e.each(function(){var e=t('<a class="tau-shortcut"></a>');e.replaceAll(t(this)).attr("href",n).html(a).attr("title",r).toggleClass("tau-shortcut_state_loading",!1).toggleClass("tau-shortcut_state_success",!0)})}})}),define("tau/ui/extensions/content/ui.extension.content.imagePreview",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({category:"edit",onInit:function(){this._isSwitchedOn=!0},"bus beforeInit + afterRender":function(i,n,a){var r=a.element,s=this.config.imagePreviewContentSelector,o=r.find(s+" img");if(o.size()>0)var l=setInterval(e.bind(function(){t.contains(document.body,r[0])&&(clearInterval(l),this.fire("view.dom.ready"))},this),1e3);n.config.context.configurator.getComponentBusRegistry().getByName("imagePreview").done(e.bind(function(e){this.previewBus=e,this.fire("previewBus.ready",e)},this))},"bus afterRender + view.dom.ready + previewBus.ready":function(e,t){this._toggleFullPreviewMode(t.element)},"bus toggle.full.preview.mode + previewBus.ready:last":function(e,t){this._isSwitchedOn=t.on,this._toggleFullPreviewMode(t.element)},_toggleFullPreviewMode:function(e){var i=this.config.imagePreviewContentSelector;if(this._isSwitchedOn){var n=e.find(i+" img"),a=n.filter(function(){return parseInt(this.naturalWidth,10)>this.width||parseInt(this.naturalHeight,10)>this.height});if(a.length>0){var r=t('<div class="tau-lightbox-container" />'),s=t('<a target="_blank" class="i-role-fullview tau-lightbox-full-size">View Full Size</a>');
a.each(function(e){var i=t(this);i.data("id",e),i.wrap(r).after(s.clone().attr("href",i.attr("src")).data("id",e))})}this._bindImageHandler(e,n)}else{var o=e.find(i+" .i-role-fullview");o.length>0&&(o.unwrap(),o.remove())}},_bindImageHandler:function(e,i){e.off("click mousedown",".i-role-fullview");var n=this.previewBus;e.on("click mousedown",".i-role-fullview",function(e){e.preventDefault(),e.stopPropagation(),"click"==e.type&&n.fire("refresh",{items:i.map(function(){var e=t(this),i=e.attr("src");return{id:e.data("id"),uri:i,thumbnailUri:i}}),selectedId:t(this).data("id")})})}})}),define("tau/ui/extensions/list/extension.fire.nodata.event",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus dataBind":function(e,t){0===t.items.length&&this.fire("noData")}})}),define("tau/ui/templates/comments/ui.template.comments",["tau/core/templates-factory","tau/ui/templates/comments/ui.template.comments.comment"],function(e){var t={name:"comments",engine:"jqote2",options:{contentSelector:".ui-comments-content"},markup:['<div class="box ui-comments-control">','<div class="ui-all-comments ui-comments-content">','<%= fn.sub("comments.comment", this.items) %>',"</div>","</div>"]};return e.register(t)}),define("tau/components/component.comments",["Underscore","tau/components/component.list.creator","tau/components/extensions/component.creator.extension","tau/models/model.comments","tau/models/model.comments.editable","tau/ui/extensions/comments/ui.extension.comments.editable","tau/ui/extensions/comments/ui.extension.comments.add","tau/ui/extensions/comments/ui.extension.comments.refresher","tau/ui/extensions/comments/ui.extension.comments.notify","tau/ui/extensions/content/ui.extension.content.shortcutProcessor","tau/ui/extensions/content/ui.extension.content.imagePreview","tau/ui/extensions/list/extension.fire.nodata.event","tau/ui/templates/comments/ui.template.comments"],function(e,t,i,n,a,r,s,o,l,u,c,d,p){return{create:function(f){var m={extensions:e.concat([n,a,r,s,i,o,l,u,c,d,f.extensions||[]]),template:p,showEmptyMessage:!1};
return f.shortcutProcessorTarget=".ui-comment-text",f.imagePreviewContentSelector=".ui-comment-text",t.create(m,f)}}}),define("tau/models/customField/model.customField",["Underscore","tau/core/model-base","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(e,t,i,n){var a=t.extend({_customFieldProcessors:{RichText:function(e){return e.value=i.fromSourceToHtml(e.value),e},Date:function(e){return e.value=n.format.date.short(n.convertToTimezone(e.value)),e.output=e.value,e},DropDown:function(t){return t.options=this._getOptions(t),t.value=e.asString(t.value),t.output=e.asString(t.value),t},Entity:function(t,i){return t.value=t.value||{},t.options=this._getOptions(t),t.value=e.defaults(t.value,{id:null,name:"",kind:null}),t.value.__type=t.value.kind,t.value.url=t.value.__type?i.configurator.getUrlBuilder().getNewViewUrl(t.value.id,t.value.__type,!0):null,t.output=t.value.name+"",t},MultipleSelectionList:function(t){return t.options=this._getOptions(t),t.value?(t.value=e.asString(t.value).split(","),t.output=t.value.join(", ")):(t.value=null,t.output=""),t},Number:function(t,i){return t.value=(t.value||e.isNumber(t.value)?parseFloat(t.value)+"":"").replace(".",i.applicationContext.culture.decimalSeparator),t.output=t.value,t},URL:function(t){return t.value=t.value||{},e.defaults(t.value,{url:"",title:""}),t.options=null,t},TemplatedURL:function(t){t.value=t.value||"",t.isEmpty=""===t.value;var i=e.compact(t.value.split(/\s*,\s*/g)),n=t.options||"";return i=e.map(i,function(e){return{title:e,url:n.replace("{0}",e)}}),t.output=i,t},_getOptions:function(t){return t.options?e.asString(t.options).split("\r\n"):[]}},_process:function(e,t){return e.type in this._customFieldProcessors&&(e=this._customFieldProcessors[e.type](e,t.context)),e},createConfiguration:function(t,i,n,a,r){var s=(t.type||"").toLowerCase(),o=e.find(n,function(e){return e.type.toLowerCase()==s&&e.name==t.name}),l=e.find(a,function(e){return e.type.toLowerCase()==s&&e.name==t.name}),u={};if(o&&l)u={name:l.name,type:l.type,required:o.required,listed:o.listed,value:l.value,options:o.value,actionReset:{enable:l.value&&!o.required},output:l.value};
else{if(!o||l)throw new Error('No valid configuration for field "'+t.name+'"');u={name:o.name,type:o.type,required:o.required,listed:o.listed,value:null,options:o.value,output:null}}return u=this._process(u,r)},"bus configurationProvided":function(t){var i=t.data;e.isEmpty(i)||(this.fire("dataBind",i),e.isEmpty(i.value)&&this.fire("noData")),this.configuration=i},"bus beforeInit":function(e){var t=e.data.config;this.store=t.store||this.store;var i=t.context.entity,n=t.context.getCustomFields(),a=t.customField||t.data,r=this,s={name:a.name,type:a.type};this.store.get(i.entityType.name,{id:i.id,fields:["id","customFields"]}).done({success:function(e){var a=e[0].data.customFields,o=r.createConfiguration(s,i,n,a,t);r.fire("configurationProvided",o)}})}});return a}),define("tau/models/customField/model.customField.editable",["Underscore","tau/core/model.editable.base"],function(e,t){var i=t.extend({category:"edit",name:"Editable custom field","bus dataBind":function(){this.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(e,t){var i=t.cmd.$set.customFields[0].value;t.cmd.$set.customFields[0].value=i?i:null,"URL"==t.cmd.$set.customFields[0].type&&null==i.label&&null==i.url&&(t.cmd.$set.customFields[0].value=null)},"bus beforeInit + configurationProvided":function(t,i,n){var a=i.config.context.entity,r=i.config.context.configurator.getStore();this.configuration=n,r.unbind(this),this.beforeSaveHandler=e.bind(this._beforeSave,this),r.on({eventName:"beforeSave",type:a.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:a.id}},this.beforeSaveHandler),this.afterSaveHandler=e.bind(this._afterSave,this),r.on({eventName:"afterSave",type:a.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:a.id}},this.afterSaveHandler)},"bus beforeInit:last + destroy":function(e,t){var i=t.config.context.configurator.getStore();i.unbind(this)},_beforeSave:function(t){var i=t.data.changes.customFields[0];e.mergeFields(t.data.cmd.config.fields,["customFields"]);
var n=this.configuration;i.name==n.name&&i.type==n.type&&this.fire("preRefreshRow",{data:i})},_afterSave:function(e){for(var t=this.configuration,i=0;i<e.data.changes.customFields.length;i++){var n=e.data.changes.customFields[i];n.name==t.name&&n.type==t.type&&this.fire("refreshRow",{data:n})}}});return i}),define("tau/core/tau-widget",["Underscore","jQuery","tau/core/event"],function(e,t,i){var n=function(n,a){var r=a._create||function(){};a._create=function(){r.apply(this,arguments),this.bus=this.options.bus||this.element.data("bus"),i.subscribeOn(this)},e.extend(a,{_fire:function(){this.bus.fire.apply(this.bus,arguments)}}),t.widget(n,a)};return{widget:n}}),define("tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle",["jQuery","tau/core/tau-widget"],function(e,t){t.widget("ui.checkboxToggle",{options:{onSave:function(){},classNames:{checked:"checked",unchecked:"unchecked"}},_create:function(){this.init()},init:function(){var t=this.element;this.toggleProxy=e.proxy(this.onClick,this),t.click(this.toggleProxy)},activate:function(){var e=this.options.classNames;this._toggle(this.element,e.checked,e.unchecked),this.options.onSave(this.element.hasClass(e.checked))},onClick:function(e){e.stopPropagation(),this.toggle()},toggle:function(){var e=this.element,t=this.options.classNames;this._toggle(e,t.checked,t.unchecked),this.options.onSave(e.hasClass(t.checked))},_toggle:function(e,t,i){var n=e;n.hasClass(t)?(n.removeClass(t),n.addClass(i)):n.hasClass(i)?(n.removeClass(i),n.addClass(t)):n.addClass(t)},destroy:function(){delete this.toggleProxy}})}),define("tau/ui/behaviour/customField/ui.behaviour.customField.row",["Underscore","jQuery"],function(e,t){t.widget("ui.behaviourCustomFieldRow",{options:{onActivate:t.noop},_create:function(){var e=this.element;this.$element=e;var t=this;e.click(function(e){e.preventDefault(),t.options.onActivate.call(this,e)})},setValidationErrors:function(t){var i=this.$element;e.each(t,function(e,t){i.find("[name="+t+"]").addClass("ui-editableText-validationerror").attr("title",e)
})},resetValidationErrors:function(){this.$element.find(":text").removeClass("ui-editableText-validationerror").attr("title",null)},setValue:function(t){var i=this.$element;e.each(t,function(e,t){i.find("[name="+t+"]").val(e)})},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.checkbox.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var i=this,n=e.afterRender.data.data,a=e.permissionsReady.data;if(a.editable){var r=e.afterRender.data.element,s=r.find(".ui-customfield__value");s.checkboxToggle({classNames:{checked:"ui-customfield__value_checked",unchecked:"ui-customfield__value_unchecked"},onSave:function(e){s.removeClass("ui-validationerror"),i.bus.fire("elementUpdated"),i.bus.fire("save",{customFields:[{name:n.name,type:n.type,value:e}]})}}),r.behaviourCustomFieldRow({onActivate:function(e){e.stopPropagation(),0==t(e.target).hasClass("ui-customfield__value")&&s.checkboxToggle("activate")}}),r.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/extensions/customField/ui.extension.customField.required",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){var i=t.extend({category:"view",name:"Required custom field","bus afterRender+beforeInit+dataBind":function(t){var i=t.dataBind.data;if(t.beforeInit.data.config.customField&&t.beforeInit.data.config.customField.required){var n=i.value;n&&(n.hasOwnProperty("url")?n=n.url:n.hasOwnProperty("id")&&(n=n.id)),e.isBoolean(n)||e.isNumber(n)||!e.isEmpty(n)||(t.afterRender.data.element.find(".ui-customfield__value").addClass("ui-validationerror"),t.afterRender.data.element.attr("title","Required field"))}}});return i}),define("tau/ui/templates/customField/ui.template.customField.checkbox",["tau/core/templates-factory"],function(e){var t={name:"customField-checkbox",markup:['<div class="ui-customfield ui-customfield-checkbox">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value ui-customfield__value_{{if value}}checked{{else}}unchecked{{/if}}">&nbsp;</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};
return e.register(t)}),define("tau/ui/extensions/customField/ui.extension.customField.editable",["Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(e,t){var i=t.extend({"bus afterRender":function(e){this.element=e.data.element},_markElementAsUpdate:function(){this.element.tauOverlay(),this.fire("markElementToBeUpdated",{element:this.element})},"bus preRefreshRow":function(){this._markElementAsUpdate()},_refreshElement:function(){this.element.parents(".tmpl-container-list:first").tauOverlay("hide");var e=this;this.on("afterRender",function(t){t.removeListener(),e.fire("updateElement",{element:e.element})}),this.fire("refresh")},"bus refreshRow":function(){this._refreshElement()}});return i}),define("tau/ui/extensions/customField/ui.extension.customField.editable.checkbox",["Underscore","tau/ui/extensions/customField/ui.extension.customField.editable"],function(e,t){var i=t.extend({"bus preRefreshRow":function(){}});return i}),define("tau/components/component.customField.checkbox",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.editable","tau/components/extensions/customField/extension.customField.checkbox.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/ui/templates/customField/ui.template.customField.checkbox","tau/ui/extensions/customField/ui.extension.customField.editable.checkbox"],function(e,t,i,n,a,r,s){return{create:function(o){var l={ModelType:t,template:r,extensions:[i,a,n,s]};return e.create(l,o)}}}),define("libs/schema.js/lib/objecttools",["require","exports","module"],function(e,t,i){"undefined"==typeof global&&"object"==typeof window&&(window.global=window),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)e.hasOwnProperty.call(e,i)&&(t[t.length]=i);return t});{var n=0,a=["$ref","$refs","$$refs"],r={},s=r.find=function(e,t){for(var i,n=e,a=t.length,r=0;a>r&&void 0!==(i=t[r]);r++){if(!((n instanceof Object||n instanceof Array)&&i in n))return;
n=n[i]}return n},o=r.id=function(e){return e instanceof Object?(e.hasOwnProperty("__id")||(e.__id=n++),e.__id):void 0},l=r.resetRefs=function(e){if(!(e instanceof Object))return null;var t=u(e);return t?(t.splice(0),t):(t=[],e instanceof Array?e.push({$$refs:t}):e.$refs=t,t)},u=r.getRefs=function(e){return e instanceof Object?e instanceof Array&&e[e.length-1]&&e[e.length-1].$$refs instanceof Array?e[e.length-1].$$refs:e.hasOwnProperty("$refs")?e.$refs:null:null};r.addRef=function(e,t,i){var n=u(e);if(!n)throw new Error("You need to call resetRefs(object) first!");return n.push(t),n.push(i),n},r.findRefs=function(e){var t={},i=[],n=l(e),r=function(s){if(s instanceof Object){var l=o(s);if(void 0!==t[l])return n.push([].concat(i)),void n.push(t[l]);if(t[l]=["#"].concat(i),e instanceof Array)for(var u=e.length,c=0;u>c;c++)i.push(c),r(s[c]),i.pop();else for(var d,p=Object.keys(s),u=p.length,c=0;d=p[c],u>c;c++)a.indexOf(d)>-1||(i.push(d),r(s[d]),i.pop())}};return r(e),e},r.resolveRefs=function(e,t){var i,n=e instanceof Array;if(n){var a=e[e.length-1];a instanceof Object&&a.$refs instanceof Array&&(i=a.$refs)}else e instanceof Object&&e.$refs instanceof Array&&(i=e.$refs);if(!i)return e;for(var r,o,l,u,c,d=i.length,p=0;d>p;p+=2)r=[].concat(i[p]),l=[].concat(i[p+1]),o=r.pop(),u=l.shift(),void 0!==o&&void 0!==u&&(c=s(e,r),c&&("#"!==u&&l.unshift(u),("#"===u||t)&&(c[o]=s("#"===u?e:global,l),i.splice(p,2),p-=2,d-=2)));return e}}i.exports={},"object"==typeof i&&i.exports&&(i.exports=r)}),define("libs/schema.js/lib/utils",["require","exports","module"],function(e,t){var i=Array.prototype.slice,n=Object.hasOwnProperty;Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new Error("Invalid object");var t=[];for(var i in e)n.call(e,i)&&(t[t.length]=i);return t}),t.extend=function(e){for(var t,n=i.call(arguments,1),a=0,r=n.length;r>a;a++){t=n[a];for(var s in t)e[s]=t[s]}return e},t.locale=function(e,t){if(!(e instanceof Object))return e;if(t=""+t||"en",void 0!==e[t])return e[t];
for(parts=t.split("_");parts.pop();)if(t=parts.join("_"),void 0!==e[t])return e[t];return e.en}}),define("libs/schema.js/lib/schema",["require","exports","module","./utils","./objecttools"],function(e,t,i){var n=e("./utils"),a=e("./objecttools");i.exports=function(){var e=this,t=this.Schema=function(e){return"string"==typeof e&&(e=JSON.parse(e)),e instanceof t?e:(n.extend(this,e),void 0===this.id&&(this.id=""+t._id++),void(t.instances[this.id]=this))};n.extend(t.prototype,{validate:function(t,i){var n=new e.Validation(this,t,i);return n.instance&&delete n.instance.__id,n},setFallbacks:function(t){return this.fallbacks="string"==typeof t?e.Validation[t]:void 0===t?e.fallbacks:n.extend({},e.fallbacks,t),this}}),n.extend(t,{_id:1,create:function(t){if("string"==typeof t)var t=JSON.parse(t);var i=e.schemaSchema.validate(t);if(i.isError())throw console.log(i.getError()),i.getError();return i.instance},createSeveral:function(e){for(var t in e)void 0===e[t].id&&(e[t].id=t),e[t]=this.create(e[t]);return e},instances:{},resolveRefs:function(){for(var e in this.instances)a.resolveRefs(this.instances[e],!0)}})}}),define("libs/schema.js/lib/validation",["require","exports","module","./utils","./objecttools"],function(e,t,i){var n=e("./utils"),a=e("./objecttools"),r=n.locale,s=Array.prototype.slice;i.exports=function(){var t=this,i=this.detectRecursion,o=this.Validation=function(e,a,s){s=s||{},this._flags={},this._errors={},this._wasError=0,this._stack=[],this.path=[],this.id=o._id++,this.schema,this.push(e),this.instance=a,this.locale=t.locale||"en",this.detectRecursion=s.detectRecursion||i,this.errors=[];var l=this,u=this.Error=function(e,t,i){this.schema=l.schema,this.path=l.path?[].concat(l.path):[],this.attribute=e||"",this.description="object"==typeof t?r(t,l.locale)(this):t||"",i&&n.extend(this,i),l._errors[this.id()]||(l._errors[this.id()]=!0,l.errors.push(this)),l._wasError++};u.prototype.toJSON=function(){return{path:this.path,name:this.attribute,description:this.description}
},u.prototype.id=function(){return[this.path,void 0,this.attribute]+""},this.instance=this.start(a),delete this._flags,this._errors,this._wasError,this._stack,this.path,this.id};n.extend(o.prototype,{isError:function(){return this.errors.length>0},getError:function(){if(0===this.errors.length)return null;var e=new Error(r(t.i18n("validation_error"),this.locale)(this));return e.errors=this.errors,e.toJSON=function(){return{message:this.message,errors:this.errors}},e},wasError:function(){var e=this._wasError;return this._wasError=0,e},push:function(e,t){this.schema=e,this._stack.push(e),void 0!==t&&this.path.push(t)},pop:function(e){var t=[this._stack.pop(),e?void 0:this.path.pop()],i=this._stack.length;return this.schema=i?this._stack[i-1]:null,t},getFlag:function(e){return a.id(e)+"_"+this.schema.id},flagObject:function(e){return this._flags[this.getFlag(e)]=!0,e},isObjectFlagged:function(e){return this.getFlag(e)in this._flags},callPlugin:function(e,t){var i=arguments.length>2?s.call(arguments,1):[t];return"function"!=typeof e&&(e=o.plugins[e]||o.plugins.addError),e.apply(this,i)}}),n.extend(o,{_id:1,registerPlugins:function(e){n.extend(o.plugins,e)},plugins:{addError:function(e,i){return new this.Error(i,t.i18n["validation_error_"+i]),e}}}),e("./"+this.v+"/validation").call(this)}}),define("libs/schema.js/lib/environment",["require","exports","module","./objecttools","./utils","./schema","./validation"],function(e,t,i){var n=(e("./objecttools"),e("./utils")),a=Array.prototype.slice,r=n.extend,s=(n.locale,function(t,i){var n;if("object"==typeof t)i=t;else{if(s.instances[t])return s.instances[t];n=this,this.id=t,s.instances[t]=this}i=i||{};var a=i.i18n||["../i18n/default"];a instanceof Array||(a=[a]);for(var o,l=this.i18n=function(e){return l[e]||{en:function(){return""}}},u=0,c=a.length;c>u;u++)o=a[u],"object"==typeof o?r(l,o):r(l,e(o));delete i.i18n,this.locale=i.locale||"en",delete i.locale,this.v="draft-02",delete i.v,this.detectRecursion=void 0===i.detectRecursion?!0:i.detectRecursion,delete i.detectRecursion,e("./schema").call(this);
var d=this.Schema;d.v=this.v,e("./validation").call(this);var p=this.Validation,f=i.fallbacks||"TOLERANT_FALLBACKS";this.fallbacks="object"==typeof f?r(p.STRICT_FALLBACKS,f):p[f],delete i.fallbacks,r(this,i),e("./"+this.v+"/setupSchemaSchema").call(this);var m=this.schemaSchema.validate(this.schemaSchema,{detectRecursion:!0});if(m.isError())throw console.log("The core schema is not valid!"),m.getError()});r(s.prototype,{validateCall:function(e,t){if(!(e.SCHEMA instanceof this.Schema))throw"No SCHEMA defined";var i=e.SCHEMA.validate(a.call(arguments,2)),n=i.instance;if(i.isError())throw i.getError();return e.apply(t,n)},validateCallAsync:function(e,t){if(!(e.SCHEMA instanceof this.Schema))throw"No SCHEMA defined";var i=a.call(arguments,2),n=i.pop(),r=e.SCHEMA.validate(i),i=r.instance;return r.isError()?n(r.getError()):(i.push(n),void e.apply(t,i))},f:function(e,t,i,n){var r=a.call(arguments),n=r.pop();if(0===r.length)return n.IS_ASYNC=!1,n;if(e instanceof Object){var s,o,t=!!r[1],e=this.Schema.create(e),i=!!r[2],l=this;return s=i?function(){return l.validateCallAsync.apply(l,[n,this].concat(a.call(arguments)))}:function(){return l.validateCall.apply(l,[n,this].concat(a.call(arguments)))},n.SCHEMA=e,n.IS_VALIDATING=t,n.IS_ASYNC=i,s.SCHEMA=e,s.IS_VALIDATING=t,s.IS_ASYNC=i,o=t?s:n,t||(o.validate=s),o}return n.IS_ASYNC=!!r[0],n}}),s.instances={};var o=function(e,t){return new s(e,t)};return i.exports={},"object"==typeof i&&i.exports?i.exports=o:window.createEnvironment=o,i.exports}),define("libs/schema.js/i18n/default",["require","exports","module"],function(e,t,i){i.exports={validation_error:{de:function(){return"Diese Instanz ist nicht gltig"},en:function(){return"This instance is not valid"}},validation_error_type:{de:function(){return"Ungltiger Typ"},en:function(){return"Invalid type"}},validation_error_minLength:{de:function(e){return"Der Text muss mindestens "+e.schema.minLength+" Zeichen haben."},en:function(e){return"Text must be longer than "+e.schema.minLength+" symbols"
}},validation_error_maxLength:{en:function(e){return"Text must be shorter than "+e.schema.maxLength+" symbols"}},validation_error_minimum:{en:function(e){return"Number must be greater than "+e.schema.minimum}},validation_error_maximum:{en:function(){return"Please, enter a reasonable number."}},validation_error_pattern:{en:function(){return"Incorrect value"}},validation_error_optional:{en:function(){return"Required field"}}}}),define("libs/schema.js/lib/draft-02/validation",["require","exports","module","Underscore","../utils","../objecttools"],function(e,t,i){var n=e("Underscore"),a=e("../utils"),r=e("../objecttools");i.exports=function(){var e=this,t=this.Schema;a.extend(this.Validation.prototype,{start:function(e){if(this.detectRecursion&&e instanceof Object){if(this.isObjectFlagged(e))return e;this.flagObject(e)}return e=this["extends"](e),this.wasError()?e:(e=this.adapters(e,"pre"),this.wasError()?e:(e=this.optional(e),this.wasError()||void 0===e?e:(e=this.empty(e),this.wasError()||""===e||null===e?e:(e=this.type(e),this.wasError()?e:(e=this.requires(e),this.wasError()?e:e=this.adapters(e,"post"))))))},"extends":function(e){return this.schema["extends"]?(this.push(this.schema["extends"]),e=this.start(e),this.pop(!0),e):e},optional:function(e){return this.schema.optional||void 0!==e?e:this.callPlugin(this.schema.fallbacks.optional,e,"optional")},empty:function(e){return this.schema.empty||void 0!==e&&""!==e&&null!==e?e:this.callPlugin(this.schema.fallbacks.optional,e,"empty")},adapters:function(e,t){if(!this.schema[t])return e;var i=this.schema[t];i instanceof Array||(i=[i]);for(var n,a=this.errors.length,r=i.length,s=0;r>s;s++)if(n=i[s],e=this.callPlugin(n,e),this.errors.length>a)return e;return e},type:function(e,t,i){i=i===!1?!1:!0;var n=t||this.schema.type;if(!(n instanceof Array)){var a=typeof e,r=function(){return"any"===n?!0:"null"===n?null===e:"array"===n?e instanceof Array:"object"===n?e instanceof Object&&!(e instanceof Array):"number"===n?"number"===a:"integer"===n?"number"===a&&Math.round(e)===e:"string"===n?"string"===a:"boolean"===n?"boolean"===a:void 0
}();if(!r&&(e=this.callPlugin(this.schema.fallbacks.type,e,"type"),this.wasError()))return e;var t=typeof e;return"number"===t?(e=this.minimum(e),this.wasError()?e:(e=this.maximum(e),this.wasError()?e:(e=this.maxDecimal(e),this.wasError()?e:(i&&(e=this["enum"](e)),e)))):"string"===t?(e=this.pattern(e),this.wasError()?e:(e=this.minLength(e),this.wasError()?e:(e=this.maxLength(e),this.wasError()?e:(i&&(e=this["enum"](e)),e)))):e instanceof Array?(e=this.minItems(e),this.wasError()?e:(e=this.maxItems(e),this.wasError()?e:(e=this.items(e),this.wasError()?e:(e=this.additionalProperties(e),this.wasError()?e:(i&&(e=this["enum"](e)),e))))):e instanceof Object?(e=this.properties(e),e=this.additionalProperties(e),this.wasError()?e:(i&&(e=this["enum"](e)),e)):e}for(var s,o=this.errors.length,l=n.length,u=0;l>u;u++){if(s=this.type(e,n[u],0===u),this.errors.length===o){e=s;break}l>u+1&&(this.errors.splice(o,1),this.wasError())}return e},"enum":function(e){return"enum"in this.schema?n.indexOf(this.schema["enum"],e)>-1?e:this.callPlugin(this.schema.fallbacks["enum"],e,"enum"):e},requires:function(e){if(void 0!==this.schema.requires&&this.parentInstance){var i;"string"==typeof this.schema.requires?(i={properties:{}},i.properties[this.schema.requires]={type:"any"}):i={properties:this.schema.requires},i=t.create(i);var n=this.pop();this.push(i),this.properties(this.parentInstance),this.pop(!0),this.push.apply(this,n)}return e},properties:function(e){if("properties"in this.schema){var t,i=this.schema.properties;this.parentInstance=e;var n,t;for(var a in i)this.push(i[a],a),n=a in e,"__id"!=a?t=this.start(e[a]):(t=void 0,n=!1),(n||void 0!==t)&&(e[a]=t),this.pop();this.parentInstance=null}return this.wasError(),e},additionalProperties:function(e){if("additionalProperties"in this.schema)if(e instanceof Object&&!(e instanceof Array)){var t=this.schema.properties||{};if(this.schema.additionalProperties){if(this.schema.additionalProperties!==!0)for(var i,n=Object.keys(e),a=n.length,r=0;i=n[r],a>r;r++)i in t||(this.push(this.schema.additionalProperties,i),"__id"!==i&&(e[i]=this.start(e[i])),this.pop())
}else for(var i,n=Object.keys(e),a=n.length,r=0;i=n[r],a>r;r++)if(!(i in t)&&"__id"!=i)return this.callPlugin(this.schema.fallbacks.additionalProperties,e,"additionalProperties")}else if(this.schema.items instanceof Array)if(this.schema.additionalProperties){if(this.schema.additionalProperties!==!0)for(var a=e.length,r=this.schema.items.length;a>r;r++)this.push(this.schema.additionalProperties,r),e[r]=this.start(e[r]),this.pop()}else if(e.length>this.schema.items.length)return this.callPlugin(this.schema.fallbacks.additionalProperties,e,"additionalProperties");return e},items:function(e){if("items"in this.schema)if(this.schema.items instanceof Array)for(var t,i,n=this.schema.items.length,a=0;n>a;a++)this.push(this.schema.items[a],a),t=a in e,"__id"!=a?i=this.start(e[a]):(t=!1,i=void 0),(t||void 0!==i)&&(e[a]=i),this.pop();else for(var n=e.length,a=0;n>a;a++)this.push(this.schema.items,a),"__id"!=a&&(e[a]=this.start(e[a])),this.pop();return e},maxItems:function(e){return this.schema.maxItems&&e.length>this.schema.maxItems?this.callPlugin(this.schema.fallbacks.maxItems,e,"maxItems"):e},minItems:function(e){return this.schema.minItems&&e.length<this.schema.minItems?this.callPlugin(this.schema.fallbacks.minItems,e,"minItems"):e},minimum:function(e){if(!("minimum"in this.schema))return e;var t="minimumCanEqual"in this.schema?this.schema.minimumCanEqual:!0;return(t?e>=this.schema.minimum:e>this.schema.minimum)?e:this.callPlugin(this.schema.fallbacks.minimum,e,"minimum")},maximum:function(e){if(!("maximum"in this.schema))return e;var t="maximumCanEqual"in this.schema?this.schema.maximumCanEqual:!0;return(t?e<=this.schema.maximum:e<this.schema.maximum)?e:this.callPlugin(this.schema.fallbacks.maximum,e,"maximum")},maxDecimal:function(e){if("maxDecimal"in this.schema){var t=Math.pow(10,this.schema.maxDecimal);return Math.round(e*t)/t===e?e:this.callPlugin(this.schema.fallbacks.maxDecimal,e,"maxDecimal")}return e},pattern:function(e){return this.schema.pattern?this.schema.pattern.test(e)?e:this.callPlugin(this.schema.fallbacks.pattern,e,"pattern"):e
},minLength:function(e){return void 0===this.schema.minLength?e:e.length>=this.schema.minLength?e:this.callPlugin(this.schema.fallbacks.minLength,e,"minLength")},maxLength:function(e){return void 0===this.schema.maxLength?e:e.length<=this.schema.maxLength?e:this.callPlugin(this.schema.fallbacks.maxLength,e,"maxLength")}}),a.extend(this.Validation,{TOLERANT_FALLBACKS:{optional:"setDefault",type:"castTolerantlyToType","enum":"setDefault",requires:"addError",additionalProperties:"removeAdditionalProperties",maxItems:"sliceToMaxItems",minItems:"addError",maximum:"setMaximum",minimum:"setMinimum",maxDecimal:"roundToMaxDecimal",pattern:"addError",minLength:"addError",maxLength:"addError"},STRICT_FALLBACKS:{optional:"addError",type:"addError","enum":"addError",requires:"addError",additionalProperties:"addError",maxItems:"addError",minItems:"addError",maximum:"addError",minimum:"addError",maxDecimal:"addError",pattern:"addError",minLength:"addError",maxLength:"addError"}}),this.Validation.registerPlugins({addToRefs:function(e){if(e instanceof Object&&!(e instanceof Array)&&"string"==typeof e.$ref){var t=this.path,i=e.$ref.split(".");r.addRef(this.instance,[].concat(t),"#"===i[0]?[].concat(i):["#","constructor","instances"].concat(i))}return e},instantiateSchema:function(e){if(!(e instanceof Object)||e instanceof Array)return e;var i=e===this.instance;if(e instanceof t||(e=new t(e)),i&&(this.instance=e),e.properties instanceof Object){var n=e.properties||{};for(var a in n)n[a]instanceof Object&&!(n[a]instanceof t)&&(n[a]=new t(n[a]))}if(e.items instanceof Array)for(var s=e.items,o=s.length,l=0;o>l;l++)s[l]instanceof Object&&!(s[l]instanceof t)&&(s[l]=new t(s[l]));else e.items instanceof Object&&(e.items instanceof t||(e.items=new t(e.items)));if(e.requires&&e.requires instanceof Object&&!(e.requires instanceof Array)){var n=e.requires;for(var a in n)n[a]=new t(n[a])}return e.additionalProperties instanceof Object&&!(e.additionalProperties instanceof t)&&(e.additionalProperties=new t(e.additionalProperties)),e["extends"]instanceof Object&&(e["extends"]instanceof t||(e["extends"]=new t(e["extends"]))),e.setFallbacks(e.fallbacks),r.resetRefs(e),e
},castTolerantlyToType:function(t,i){i=i||"type";var n,a=this.schema.type,r=typeof t;if("string"===a)return"object"===r?null!==t&&"function"==typeof t.toString&&t.toString!==Object.prototype.toString&&t.toString!==Array.prototype.toString?""+t:(new this.Error(i,e.i18n["validation_error_"+i]),t):""+t;if("number"===a){if("boolean"!==r)return n=parseFloat(t),isNaN(n)&&0!=t?(new this.Error(i,e.i18n["validation_error_"+i]?e.i18n["validation_error_"+i]:"validation_error_"+i),t):isNaN(n)?t:n;if(t===!1)return 0;if(t===!0)return 1}if("integer"===a){if("boolean"!==r)return n=parseInt(t,10),isNaN(n)?(new this.Error(i,e.i18n["validation_error_"+i]),t):n;if(t===!1)return 0;if(t===!0)return 1}if("boolean"===a)return"string"===r?"false"===t.trim().toLowerCase()?!1:(n=parseFloat(t),isNaN(n)?!0:!!n):!!t;if("object"===a)return t instanceof Array&&0===t.length?{}:(("object"!==r||null===t||t instanceof Array)&&new this.Error(i,e.i18n["validation_error_"+i]),t);if("array"===a){if(!t)return[];if(t instanceof Object){var s,n=[],o=!0;if(0===Object.keys(t).length)return n;for(var l in t){s=parseInt(l,10),""+s===l?n[s]=t[l]:o=!1;break}}return new this.Error(i,e.i18n["validation_error_"+i]),t}return"null"===a?(new this.Error(i,e.i18n["validation_error_"+i]),t):void 0},roundToMaxDecimal:function(t,i){if(void 0===this.schema.maxDecimal)return new this.Error(i,e.i18n["validation_error_"+i]),t;var n=Math.pow(10,this.schema.maxDecimal);return Math[0>t?"ceil":"floor"](t*n)/n},setMinimum:function(t,i){return void 0===this.schema.minimum?(new this.Error(i,e.i18n["validation_error_"+i]),t):this.schema.minimum},setMaximum:function(t,i){return void 0===this.schema.maximum?(new this.Error(i,e.i18n["validation_error_"+i]),t):this.schema.maximum},truncateToMaxLength:function(t,i){return void 0===this.schema.maxLength?(new this.Error(i,e.i18n["validation_error_"+i]),t):t.substr(0,this.schema.maxLength)},setDefault:function(t,i){return"default"in this.schema?this.schema["default"]:void new this.Error(i,e.i18n["validation_error_"+i])
},removeAdditionalProperties:function(e){if("object"===this.schema.type){for(var t,i=this.schema.properties||{},n=Object.keys(e),a=n.length,r=0;t=n[r],a>r;r++)void 0===i[t]&&delete e[t];return e}if(this.schema.items&&this.schema.items instanceof Array)for(var a=e.length,r=this.schema.items.length;a>r;r++)delete e[r];return e},sliceToMaxItems:function(t,i){return void 0!==this.schema.maxItems?t.length>this.schema.maxItems&&t.splice(this.schema.maxItems):new this.Error(i,e.i18n["validation_error_"+i]),t},deleteInstance:function(){return void 0}})}}),define("libs/schema.js/lib/draft-02/setupSchemaSchema",["require","exports","module"],function(e,t,i){i.exports=function(){var e=this.Schema,t=this.Validation,i={id:"jsonSchemaCore",title:"JSON Schema Core Schema",description:"This is the JSON Schema for JSON Schemas.",type:"object",properties:{type:{type:["string","array"],items:{type:"string","enum":{$ref:"#.properties.type.enum"}},uniqueItems:!0,description:"This is a type definition value. This can be a simple type, or a union type","enum":["string","object","array","boolean","number","integer","null","any"],minItems:2,optional:!0,"default":"any",pre:"addToRefs",labels:{de:{string:"Text",object:"Objekt",array:"Liste","boolean":"wahr/falsch",number:"Zahl",integer:"ganze Zahl","null":"undefiniert"},en:{}}},id:{type:"string",optional:!0,minLength:1,pattern:"[^\\.#]",description:"A globally unique ID for this schema. It can be used to reference the schema from another one."},optional:{type:"boolean",description:"This indicates that the instance property in the instance object is not required.",optional:!0,"default":!1,pre:"addToRefs"},empty:{type:"boolean",description:"This indicates that the instance property in the instance object can be empty.",optional:!0,"default":!1,pre:"addToRefs"},"enum":{type:"array",optional:!0,description:"This provides an enumeration of possible values that are valid for the instance property. It goes only for the first type, if type is an array of types.",minItems:1,uniqueItems:!0},description:{type:"string",optional:!0,description:"This provides a description of the purpose the instance property. The value can be a string or it can be an object with properties corresponding to various different instance languages (with an optional default property indicating the default description).",pre:"addToRefs"},title:{type:"string",optional:!0,description:"This provides the title of the property",pre:"addToRefs"},"default":{type:"any",optional:!0,description:"This indicates the default for the instance property.",pre:"addToRefs"},options:{type:"array",optional:!0,items:{type:"object",properties:{label:{type:"string",optional:!0},value:{type:"any"}}},pre:"addToRefs"},"extends":{type:"object",optional:!0,pre:"addToRefs"},requires:{type:["string","object"],additionalProperties:{$ref:"#"},optional:!0,description:"indicates a required property or a schema that must be validated if this property is present",pre:"addToRefs"},nonStandard:{type:"boolean",optional:!0,"default":!1,nonStandard:!0},pre:{type:["string","array","any"],items:{type:["string","any"]},optional:!0,description:"One or several prefix adapters identified by plugin IDs",nonStandard:!0,pre:"addToRefs"},post:{type:["string","array","any"],items:{type:["string","any"]},optional:!0,description:"One or several postfix adapters identified by plugin IDs",nonStandard:!0,pre:"addToRefs"},fallbacks:{type:"object",additionalProperties:{type:["string","object"],description:"Identifier for a adapter function that will be executed if a constraint is violated"},description:"Fallback object, with property names = schema property names",nonStandard:!0,pre:"addToRefs"},properties:{type:"object",additionalProperties:{$ref:"#"},description:"This is a definition for the properties of an object value",optional:!0,"default":{},pre:"addToRefs"},items:{type:["object","array"],properties:{$ref:"#.properties"},items:{$ref:"#"},description:"When the value is an array, this indicates the schema to use to validate each item in an array",optional:!0,pre:["instantiateSchema","addToRefs"]},maxItems:{type:"integer",optional:!0,description:"When the instance value is an array, this indicates maximum number of items.",minimum:0,pre:"addToRefs"},minItems:{type:"integer",optional:!0,description:"When the instance value is an array, this indicates minimum number of items.",minimum:0,pre:"addToRefs"},additionalProperties:{type:["boolean","object"],properties:{$ref:"#.properties"},description:"This provides a default property definition for all properties that are not explicitly defined in an object type definition.",optional:!0,"default":!0,pre:["instantiateSchema","addToRefs"]},minimum:{type:"number",optional:!0,description:"This indicates the minimum value for the instance property when the type of the instance value is a number.",pre:"addToRefs"},minimumCanEqual:{type:"boolean",optional:!0,description:"If the minimum is defined, this indicates whether or not the instance property value can equal the minimum.","default":!0,pre:"addToRefs"},maximum:{type:"number",optional:!0,description:"This indicates the maximum value for the instance property when the type of the instance value is a number.",pre:"addToRefs"},maximumCanEqual:{type:"boolean",optional:!0,description:"If the maximum is defined, this indicates whether or not the instance property value can equal the maximum.","default":!0,pre:"addToRefs"},maxDecimal:{type:"integer",optional:!0,description:"This indicates the maximum number of decimal places in a floating point number.",pre:"addToRefs"},pattern:{type:["string","object"],format:"regex",description:"When the instance value is a string, this provides a regular expression that a instance string value should match in order to be valid.",optional:!0,pre:["addToRefs",function(e){return e instanceof RegExp?e:"string"==typeof e?new RegExp(e):e
}]},maxLength:{type:"number",optional:!0,description:"When the instance value is a string, this indicates maximum length of the string.",pre:"addToRefs"},minLength:{type:"number",optional:!0,description:"When the instance value is a string, this indicates minimum length of the string.",pre:"addToRefs"},format:{type:"string",optional:!0,description:"This indicates what format the data is among some predefined formats which may include:\n\ndate - a string following the ISO format \naddress \nschema - a schema definition object \nperson \npage \nhtml - a string representing HTML",pre:"addToRefs"}},pre:["instantiateSchema","addToRefs"]};(jsonSchemaCore=new e(i)).setFallbacks(t.STRICT_FALLBACKS);for(var n in jsonSchemaCore.properties)(jsonSchemaCore.properties[n]=new e(jsonSchemaCore.properties[n])).setFallbacks(t.STRICT_FALLBACKS);(jsonSchemaCore.properties.type.items=new e(jsonSchemaCore.properties.type.items)).setFallbacks(t.STRICT_FALLBACKS),jsonSchemaCore.properties.type.items["enum"]=jsonSchemaCore.properties.type["enum"],jsonSchemaCore.properties.id.pattern=new RegExp(jsonSchemaCore.properties.id.pattern),(jsonSchemaCore.properties.options.items=new e(jsonSchemaCore.properties.options.items)).setFallbacks(t.STRICT_FALLBACKS),jsonSchemaCore.properties.requires.additionalProperties=jsonSchemaCore,(jsonSchemaCore.properties.pre.items=new e(jsonSchemaCore.properties.pre.items)).setFallbacks(t.STRICT_FALLBACKS),(jsonSchemaCore.properties.post.items=new e(jsonSchemaCore.properties.post.items)).setFallbacks(t.STRICT_FALLBACKS),(jsonSchemaCore.properties.fallbacks.additionalProperties=new e(jsonSchemaCore.properties.fallbacks.additionalProperties)).setFallbacks(t.STRICT_FALLBACKS),jsonSchemaCore.properties.properties.additionalProperties=jsonSchemaCore,jsonSchemaCore.properties.items.properties=jsonSchemaCore.properties,jsonSchemaCore.properties.items.items=jsonSchemaCore,jsonSchemaCore.properties.additionalProperties.properties=jsonSchemaCore.properties,this.schemaSchema=jsonSchemaCore
}}),define("tau/utils/utils.jsonSchema",["Underscore","jQuery","libs/schema.js/lib/environment","libs/schema.js/lib/utils","libs/schema.js/lib/objecttools","libs/schema.js/lib/schema","libs/schema.js/i18n/default","libs/schema.js/lib/draft-02/validation","libs/schema.js/lib/draft-02/setupSchemaSchema"],function(e,t,i){var n=i("prod",{fallbacks:"STRICT_FALLBACKS"});return n.PATTERN_DATE=/^([0-1]{0,1}[0-9]{1})\/([0-3]{0,1}[0-9]{1})\/([0-9]{4})$/,n.PATTERN_URL=/^([a-z]+?)\:\/\/.+?$/,n.Validation.registerPlugins({trim:function(e){return t.trim(e)}}),n.Validation.prototype.optional=function(e){return this.schema.optional||void 0!==e&&null!==e&&""!==e?e:this.callPlugin(this.schema.fallbacks.optional,e,"optional")},n}),define("tau/models/customField/model.customField.date.editable",["tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(e,t,i){var n=e.extend({category:"edit",name:"Editable custom field",schema:t.Schema.create({type:"object",properties:{value:{type:"string",optional:!1,post:function(e){if(0==this.wasError()){var t=i.parse(e);null==t?new this.Error("Date","Incorrect date format"):t<new Date(1900,0,1)?new this.Error("Date","Date must be greater than 01-01-1900"):e=i.format.date.short(t)}return e},additionalProperties:{dateFormat:i.getFormatData().date.short}}}}),"bus validate":function(e){var t=e.data,i=t.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,t.validation=this.schema.validate(i)}});return n}),define("tau/ui/behaviour/date/ui.behaviour.dateEditor",["Underscore","jQuery"],function(e,t){t.widget("ui.dateEditor",{options:{widgetName:"datepicker",onSave:function(){},validation:{required:!1},dateFormat:"m/dd/yy",delayedSave:!0},errors:[],_create:function(){this.init()},init:function(){this.element.addClass("ui-dateeditor-source").click(t.proxy(this.showEditor,this))},setValidationErrors:function(t){this.element.addClass("ui-validationerror"),e.isString(t)&&this.element.attr("title",t)
},resetValidationErrors:function(e){this.element.removeClass("ui-validationerror").removeAttr("title",e)},activate:function(){this.showEditor();var e=this;setTimeout(function(){e.$editor.find(":text").focus()},0)},_attachKeyBoardHandling:function(){this.handleKeyDown||(this.handleKeyDown=e.bind(this.mapKeys,this),this.options.keyboardManager.pushHandler(this))},_detachKeyboardHandling:function(){this.handleKeyDown&&(this.options.keyboardManager.popHandler(),delete this.handleKeyDown)},attachBlurHandler:function(e,i){var n=null,a=!1;this.$editor.find(".ui-datepicker-trigger").mousedown(function(){a=!0}).mouseup(function(){a=!1}),t(".ui-datepicker.ui-widget").mousedown(function(){a=!0}).mouseup(function(){a=!1});var r=this.options.delayedSave;e.blur(function(){return r?void(a||(n=setTimeout(i,100))):void i()}).focus(function(){clearTimeout(n)})},showEditor:function(){if(!this._editorIsVisible){if(this.$editor||(this.$editor=this._createEditor()),this._attachKeyBoardHandling(),!this._attachedSaveHandler){this._attachedSaveHandler=!0;var e=this.$editor.find(".hasDatepicker");this.attachBlurHandler(e,this._onBlur.bind(this))}this.element.hide(),this._editorIsVisible=!0,this.$editor.show().find(":text").val(this.getValue())}},_createEditor:function(){var e=t('<span class="ui-dateeditor"><input type="text" maxlength="20" /></span>'),i=e.find(":text");return i.focus(),i[this.options.widgetName]({showButtonPanel:!1,dateFormat:this.options.dateFormat,buttonText:"choose",showOn:"button",onSelect:function(){i.focus()}}),e.insertAfter(this.element),e},trimString:function(t){return e.trim(t||"")},_getDefaultValue:function(){return this.options.date||this.getValue()},_onSave:function(){var e=this.$editor.find(":text").val(),t={value:e};this.options.beforeChange&&this.options.beforeChange(t),e=t.value||"",this.hideEditor(),this.element.show();var i=this._getDefaultValue();this.trimString(i)!=this.trimString(e)?this.options.onSave(e):this.options.onCancel&&this.options.onCancel(),this.setValue(e)
},_onCancel:function(){this.hideEditor(),this.element.show(),this.options.onCancel&&this.options.onCancel()},hideEditor:function(){this.$editor&&this._editorIsVisible&&(this.$editor.hide(),this._editorIsVisible=!1),this._detachKeyboardHandling()},_onBlur:function(){this._editorIsVisible&&(this._onSave(),this.hideEditor())},destroy:function(){this.hideEditor();var e=this.$editor;if(e){var t=e.find(":text");t[this.options.widgetName]("destroy"),e.remove()}},mapKeys:function(e){switch(e.which){case 13:e.preventDefault(),this._onSave();break;case 27:e.preventDefault(),this._onCancel()}},setValue:function(e){this.element.text(e)},getValue:function(){return this.element.text()}})}),define("tau/components/extensions/customField/extension.customField.date.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i,n){return i.extend({category:"edit","bus permissionsReady+afterRender":function(i){var a=this,r=i.afterRender.data.data,s=i.permissionsReady.data;if(s.editable){var o=i.afterRender.data.element,l=o.find(".ui-customfield__value");l.addClass("editableText"),this.$widget=l,t.datepicker.parseDate=function(e,t){return n.parse(t)},t.datepicker.formatDate=function(e,t){return n.formatAs(t,e)};var u=n.getFormatData().date.short;l.dateEditor({dateFormat:u,delayedSave:e.has(this.config,"delayedDateSave")?this.config.delayedDateSave:!0,keyboardManager:this.config.context.configurator.getKeyBoardManager(),onSave:function(e){a.bus.fire("save",{customFields:[{name:r.name,type:r.type,value:e}]})}}),o.behaviourCustomFieldRow({onActivate:function(){l.dateEditor("activate"),l.focus()}}),o.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.dateEditor("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.dateEditor("setValue",e.data.validation.instance.value)},"bus validationFailed":function(e){this.$widget.dateEditor("setValidationErrors",e.data.validation.errors[0].description)
}})}),define("tau/ui/templates/customField/ui.template.customField.date",["tau/core/templates-factory"],function(e){var t={name:"customField-date",markup:['<div class="ui-customfield {{if !output}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'<td class="ui-customfield__label">${name}</td>','<td class="ui_custom_field_value_container">','<div class="ui-customfield__value">${output}</div>',"</td>","   </tr>","   </tbody>","   </table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.date",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.date.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.date.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.date"],function(e,t,i,n,a,r,s){return{create:function(o){var l={ModelType:t,template:s,extensions:[i,n,a,r]};return e.create(l,o)}}}),define("tau/models/customField/model.customField.dropdown.editable",["Underscore","tau/models/customField/model.customField.editable"],function(e,t){var i=t.extend({"bus beforeInit":function(t){if(this.store=t.data.config.store,this.config.data){var i=this.config.data.value,n=[];e.map(this.config.data.options,function(e){i!==e&&n.push({id:e,name:e})}),this.fire("dataBind",{states:n})}},"bus beforeInit:last + updateState":function(e,t,i){var n=null;i&&i.id&&(n=i.id);var a={customFields:[{name:t.config.customField.name,type:t.config.customField.type,value:n}]};this.fire("save",a)}});return i}),define("tau/components/extensions/customField/extension.customField.url.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var t=(e.afterRender.data.data,e.permissionsReady.data);
if(t.editable){var i=e.afterRender.data.element,n=i.find(".ui-customfield__value");this.$widget=n,i.find(".ui-customfield__label").behaviourCustomFieldRow({}),i.addClass("ui-customfield_editable_true")}}})}),define("tau/models/customField/model.customField.entity.editable",["Underscore","tau/models/customField/model.customField.editable"],function(e,t){return t.extend({"bus beforeInit:last + entitySelected":function(e,t,i){var n={},a={name:t.config.customField.name,type:"Entity",value:null};n.customFields=[a];var r=i.entity;r&&r.id&&(a.value={id:r.id,kind:r.entityType.name,name:r.name}),this.fire("save",{$set:n})}})}),define("tau/models/finder.entity/model.finder.entity.data.customField.entity",["Underscore","tau/models/finder.entity/model.finder.entity.data"],function(e,t){return t.extend({processOptions:function(t,i){var n=$.Deferred(),a=t.customField,r=e.map(e.clone(a.options),function(e){return parseInt(e,10)}),s=e.bind(this._super,this);return i.getStore().get("entityType",{fields:["id","name"]}).done({success:e.bind(function(a){var o=a[0].data,l=e.pluck(e.filter(o,function(t){return e.indexOf(r,t.id)>=0}),"name");t.entityType=l.length?e.map(l,function(e){return e.toLowerCase()}):null,s(t,i).then(function(e){n.resolve(e)})},this)}),n.promise()},processInitDsl:function(t,i){var n=t.customField,a=t.context.entity,r=$.Deferred();return i.getStore().get(a.entityType.name,{id:a.id,fields:["customFields"]}).done(e.bind(function(e){var i=this.getCustomFieldByName(e[0].data.customFields,n.name);t=this.setOptionsInitDslFromCustomFieldValue(t,i.value),r.resolve(t)},this)),r.promise()},setOptionsInitDslFromCustomFieldValue:function(e,t){var i=[];return t&&i.push(t.id),e.filter.init_dsl=this.updateInitDslWithIds(e.filter.init_dsl,i),e},getCustomFieldByName:function(t,i){return e.find(t,function(e){return e.name===i})},updateInitDslWithIds:function(t,i){var n=e.map(i,function(t){return e.sprintf("id != %d",t)});return t&&n.unshift(t),t=n.join(" and ")}})}),define("tau/ui/extensions/customField/ui.extension.customField.editable.dropdown",["Underscore","tau/core/extension.base","tau/models/customField/model.customField.entity.editable","tau/models/finder.entity/model.finder.entity.data.customField.entity"],function(e,t){return t.extend({"bus beforeInit + configurationProvided + afterRender":function(t,i,n,a){var r=i.customField,s=a.element.find("tr"),o=e.deepClone(n),l=a.view,u=this._createFinderConfig(o,r,n);
this._initBubbleWithFinder(s,l,u),s.on("click",".i-role-reset",e.bind(function(){return this.fire("updateState",{}),!1},this))},_createFinderConfig:function(e){return{type:"customField.dropdown.list",customField:e,data:e}},_initBubbleWithFinder:function(e,t,i){e.addClass("tau-bubble-target ui-customfield_editable_true");var n={target:e,alignTo:e.find(".entity-custom-field-link"),onShow:function(){t.config.context.configurator.getKeyBoardManager().pushHandler({})},onHide:function(){t.config.context.configurator.getKeyBoardManager().popHandler()},componentsConfig:{components:[i]}};this.fire("initBubble",n)}})}),define("tau/ui/templates/customField/ui.template.customField.dropdown",["tau/core/templates-factory"],function(e){var t={name:"customField-dropdown",engine:"jqote2",markup:['<% var className = this.value ? "" : "ui-customfield_empty_true"; %>','<div class="ui-customfield ui-customfield-dropdown <%= className %>">',"<table>","<tbody>","<tr>",'<td class="ui-customfield__label"><%= this.name %></td>','<td class="ui_custom_field_value_container">','<div class="ui-customfield__value ui-customfield__value_margin_right"><%! this.value %></div>',"<% if (this.actionReset && this.actionReset.enable) { %>",'<% var title = this.actionReset.label || "reset"; %>','<span class="i-role-reset tau-clear-filter tau-clear-filter_margin_left" title="<%! title %>"></span>',"<% } %>","</td>","</tr>","</tbody>","</table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.dropdown",["Underscore","tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.dropdown.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/components/extensions/customField/extension.customField.url.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/extensions/customField/ui.extension.customField.editable.dropdown","tau/ui/templates/customField/ui.template.customField.dropdown"],function(e,t,i,n,a,r,s,o,l,u,c){return{create:function(e){var d={ModelType:i,extensions:[n,a,o,l,s,r,u],template:c};
return t.create(d,e)}}}),define("tau/ui/templates/choice/ui.template.choice.list.dropdown",["tau/core/templates-factory","tau/ui/templates/choice/ui.template.choice.option"],function(e){var t={name:"state.list.dropdown",engine:"jqote2",markup:['<div class="ui-drop-down">',"<% if (this.states.length) { %>",'<div role="list" class="drop-down-list">','<div class="drop-down-list__inner i-inner">','<%= fn.sub("state.option", this.states) %>',"</div>","</div>","<% } else { %>",'<div class="drop-down-list">','<div role="placeholder-empty">No items found</div>',"</div>","<% } %>","</div>"]};return e.register(t)}),define("tau/components/component.customField.dropdown.list",["tau/components/component.creator","tau/core/model-base","tau/models/customField/model.customField.dropdown.editable","tau/ui/extensions/choice/ui.extension.choice.editable","tau/ui/extensions/bubble/ui.extension.bubble.listResizer","tau/ui/templates/choice/ui.template.choice.list.dropdown"],function(e,t,i,n,a,r){return{create:function(s){var o={ModelType:t,extensions:[i,n,a],template:r};return e.create(o,s)}}}),define("tau/components/extensions/customField/extension.customField.entity.finder",["Underscore","tau/core/extension.base","tau/models/customField/model.customField.entity.editable","tau/models/finder.entity/model.finder.entity.data.customField.entity"],function(e,t,i,n){return t.extend({"bus beforeInit + configurationProvided + afterRender":function(t,i,n,a){var r=i.customField,s=a.element.find("tr"),o=e.deepClone(n),l=a.view,u=this._createFinderConfig(o,r,n);this._initBubbleWithFinder(s,l,u),s.on("click",".i-role-reset",e.bind(function(){return this.fire("entitySelected",{entity:null}),!1},this))},_createFinderConfig:function(e){return{type:"finder.entity",model:n,modelEditable:i,customField:e}},_initBubbleWithFinder:function(e,t,i){e.addClass("tau-bubble-target ui-customfield_editable_true");var n={target:e,alignTo:e.find(".entity-custom-field-link"),onShow:function(){t.config.context.configurator.getKeyBoardManager().pushHandler({})
},onHide:function(){t.config.context.configurator.getKeyBoardManager().popHandler()},componentsConfig:{components:[i]},onPositionConfig:function(e){e.collision="flipfit flipfit",e.at="left middle",e.my="right middle"}};this.fire("initBubble",n)}})}),define("tau/ui/templates/common/ui.template.entityLink.full",["tau/core/templates-factory"],function(e){var t={name:"entity-link-full",markup:['<a href="${url}" class="tau-linkentity tau-linkentity_type_full">','<em class="tau-entity-icon tau-entity-icon--${__type.toLowerCase()} tau-linkentity__icon">${id}</em>','<span class="tau-linkentity__inner">',"{{if text}}${text}{{else}}${name}{{/if}}","</span>","</a>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/customField/ui.template.customField.entity",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.full"],function(e){var t={name:"customField-entity",engine:"jqote2",markup:['<div class="ui-customfield">',"<table>","<tbody>",'<% var className = this.value.id ? "" : "ui-customfield_empty_true"; %>','<tr class="<%= className %>">','<td class="ui-customfield__label"><%= this.name %></td>','<td class="ui_custom_field_value_container">',"<% if (this.value.id) { %>",'<span class="ui-customfield__value ui-customfield__value_margin_right"><%= fn.sub("entity-link-full", this.value) %></span>',"<% } else { %>",'<span class="entity-custom-field-link property-text ui-customfield__value ui-customfield__value_margin_right"><%! this.value.name %></span>',"<% } %>","<% if (this.actionReset && this.actionReset.enable) { %>",'<% var title = this.actionReset.label || "reset"; %>','<span class="i-role-reset tau-clear-filter tau-clear-filter_margin_left" title="<%! title %>"></span>',"<% } %>","</td>","</tr>","</tbody>","</table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.entity",["Underscore","tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.entity.editable","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.entity.finder","tau/ui/templates/customField/ui.template.customField.entity"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(e){var c={template:u,extensions:[i,n,a,r,s,o,l]};
return t.create(c,e)}}}),define("tau/models/finder.entity/model.finder.entity.data.customField.multipleEntities",["Underscore","tau/models/finder.entity/model.finder.entity.data.customField.entity"],function(e,t){return t.extend({"bus afterInit":function(t,i){var n=i.config,a=n.context.configurator.getStore(),r=n.context.entity;a.unbind(this),a.on({eventName:"afterSave",type:r.entityType.name,listener:this,filter:{id:r.id},hasChanges:["customFields"]},e.bind(function(e){var t=this.getCustomFieldByName(e.data.changes.customFields,n.customField.name);if(t){var i=this.getIdsFromCustomFieldValue(t.value);this.fire("updateInitialDsl",{actualIds:i})}},this))},"bus options.ready:last + builder.ready:last + initialDsl.ready:last + updateInitialDsl":function(e,t,i,n,a){t.filter.init_dsl=this.updateInitDslWithIds(n,a.actualIds),this.fire("options.ready",t),i.setParameter("init_dsl",t.filter.init_dsl),this.fire("builder.ready",i),this.fire("search.readyToExecute")},setOptionsInitDslFromCustomFieldValue:function(e,t){var i=e.filter.init_dsl;this.fire("initialDsl.ready",i);var n=this.getIdsFromCustomFieldValue(t);return e.filter.init_dsl=this.updateInitDslWithIds(i,n),e},getIdsFromCustomFieldValue:function(t){var i=[],n=e.compact(e.asString(t).split(","));return i=e.map(n,function(e){return parseInt(e.split(" ")[0],10)})}})}),define("tau/models/finder.entity/model.finder.entity.data.customField.multipleEntities.editable",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterInit:last + entitySelected":function(t,i){var n=i.config.customField,a=i.config.context.entity,r=i.config.context.configurator.getStore();r.get(a.entityType.name,{id:a.id,fields:["customFields"]}).done(e.bind(function(t){var i=e.find(t[0].data.customFields,function(e){return e.name===n.name}),a=null!=i.value?i.value.split(","):[];this.fire("prevValues.ready",a)},this))},"bus afterInit:last + entitySelected + prevValues.ready":function(t,i,n,a){var r=n.entity,s=i.config.customField,o=i.config.context.entity,l=i.config.context.configurator.getStore(),u=r.id+" "+r.entityType.name.toLowerCase(),c=e.uniq(a.concat(u)).join(",");
l.save(o.entityType.name,{id:o.id,$set:{customFields:[{name:s.name,value:c}]},fields:["id","customFields"]}).done()}})}),define("tau/ui/extensions/customField/ui.extension.customField.multipleEntities.add.trigger",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/models/finder.entity/model.finder.entity.data.customField.multipleEntities","tau/models/finder.entity/model.finder.entity.data.customField.multipleEntities.editable"],function(e,t,i,n,a){return i.extend({"bus afterInit":function(){this.fire("dataBind")},"bus beforeInit + afterRender":function(e,t,i){this.customField=t.config.customField,this.fire("customField.ready",this.customField),this._initFinder(i.element,this.customField)},_initFinder:function(t,i){i.options=(i.value||"").split("\n");var r={actionOnBlur:"destroy",target:t,className:"tau-bubble-lookup",componentsConfig:{components:[{type:"finder.entity",model:n,modelEditable:a,customField:i}]}};i.value&&(r.componentsConfig.components[0].$query={entityType:{id:{$in:e.asString(i.value).split("\r\n").join(",")}}}),this.fire("initBubble",r)}})}),define("tau/components/component.customField.multipleEntities.container",["Underscore","tau/components/component.container","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator","tau/ui/extensions/customField/ui.extension.customField.multipleEntities.add.trigger","tau/ui/extensions/list/extension.bubble.nodata.event"],function(e,t,i,n,a,r){return{create:function(s){var o={template:{name:"customField.multipleEntities.container",markup:['<div class="tau-container tau-list tau-list__group_flat_true">','<div class="ui-quick-add i-role-add-holder">',"</div>",'<div class="i-role-list-holder">',"</div>","</div>"]},layout:"selectable",extensions:[r],children:[{type:"creator",selector:".i-role-add-holder",template:{name:"customField.multipleEntities.add.trigger",markup:['<span class="ui-link ui-quick-add-link i-role-add">Add Item</span>']},extensions:[i,n,a],customField:s.customField},{type:"customField.multipleEntities",selector:".i-role-list-holder",customField:s.customField}]};
return t.create(e.extend(s,o))}}}),define("tau/ui/extensions/list/extension.list.prioritize",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({name:"extension.list.prioritize",category:"edit","bus afterRender":function(e){var i=e.data.element,n=this;this.$el=i,i.addClass("tau-list__sortable__true");var a=i.find("[role=group]");a.addClass("tau-list__group_sortable_true");var r={sensitivity:7,speed:12};this.config.context.configurator.getConfig("isPopup",!1)&&(r={sensitivity:20,speed:30}),a.addClass("tau-list__group_available_true"),a.sortable({scroll:!0,scrollSensitivity:r.sensitivity,scrollSpeed:r.speed,cursor:"move",connectWith:".tau-list__group_available_true[role=group]",items:".tau-list__list [role=item]",dropOnEmpty:!0,handle:"[role=sortable-handler]",forcePlaceholderSize:!0,placeholder:{element:function(){var e=t('<li class="tau-list__list__item tau-list__sortable-placeholder ui-sortable-placeholder"></li>');return e.height(50),e},update:function(){}},helper:function(e,t){var i=t;return i}});var s=function(){t(this).data("ui-sortable").refreshPositions()};i.mousedown(function(){a.bind("mousemove",s)}),i.mouseup(function(){a.unbind("mousemove",s)}),a.bind("sortstart",function(e,i){n.started=!0;var a=i.item,r=a.data("tmplItem").data||{},s=t(e.currentTarget);s.addClass("tau-list__group_sortover_true"),n.$group=s;var o=s.data("tmplItem")?s.data("tmplItem").data:{};n.fire("prioritize.start",{item:r,group:o})}),a.bind("sortstop",function(){a.addClass("tau-list__group_available_true"),a.removeClass("tau-list__group_available_false"),a.removeClass("tau-list__group_sortover_true")}),a.bind("sortupdate",function(e,i){if(n.started){n.started=!1;var a=i.item,r=a.prev("[role=item]"),s=a.next("[role=item]"),o=a.data("tmplItem").data||{},l=r.length?r.data("tmplItem").data:{},u=s.length?s.data("tmplItem").data:{},c=a.parents("[role=group]:first"),d=c.data("tmplItem")||null;d=d?d.data:null;var p=c.hasClass("tau-list__group_collapsed_true");
c.addClass("i-target");var f=t(this),m=f.data("tmplItem")||null;m=m?m.data:null,n.fire("prioritize.checkAvailability",{$item:a,$prevGroup:f,$targetGroup:c,item:o,prev:l,next:u,group:d,prevGroup:m,isCollapsed:p})}}),a.bind("sortchange",function(){var e=a.find(".tau-list__sortable-placeholder").parents("[role=group]:first");1==e.length&&0==e.hasClass("tau-list__group_sortover_true")&&(a.removeClass("tau-list__group_sortover_true"),e.addClass("tau-list__group_sortover_true"))});var o=function(e,i,n,a){n?t(n[0]).find(".tau-list__list").append(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this,s=this.counter;window.setTimeout(function(){s==r.counter&&r.refreshPositions(!a)},0)};a.each(function(){var e=t(this);e.data("ui-sortable")._rearrange=o})},"bus prioritize.checkAvailability":function(){this.bus.fire("prioritize.isAvailable.default",{})},"bus prioritize.checkAvailability+prioritize.isNotAvailable":function(){this.bus.fire("refresh")},"bus prioritize.checkAvailability+prioritize.isAvailable.default+prioritize.isAvailable.comment":function(e){var t=e["prioritize.checkAvailability"].data;this.fire("positionUpdated",t)},"bus prioritize.updateGroupsAvailability":function(i){var n=i.data,a=n.groups,r=this.$el.find("[role=group]");if(r.length<=1||r.length==a.length)return r.addClass("tau-list__group_available_true").removeClass("tau-list__group_available_false"),void this.$group.sortable("refresh");var s=e.filter(r.toArray(),function(i){var n=t(i).data("tmplItem").data;return e.any(a,function(e){return n===e})}),o=t(s);r.addClass("tau-list__group_available_false").removeClass("tau-list__group_available_true"),o.removeClass("tau-list__group_available_false").addClass("tau-list__group_available_true"),this.$group.sortable("refresh")},"bus beforeUpdate":function(){this.$el.find(".i-target [role=counter]").css("backgroundColor","#ffefd5")},"bus afterUpdate":function(i){this.$el.find("[role=group]").each(function(){t(this).find("[role=counter]").text(t(this).find("[role=item]").length)
}),this.$el.find(".i-target [role=counter]").animate({backgroundColor:"#ffffff"},200),this.$el.find(".i-target").removeClass("i-target");var n=i.data.changedItem,a=this.$el.find(".i-item-"+n.id),r=a.parents("[role=item]:first"),s=r.data("tmplItem").data;if(e.extend(s,n),this.$el.find("[role=group]").length>1){var o="tau-list__table__row_isfinalstate_true";s.entityState&&a.toggleClass(o,!!s.entityState.isFinal)}}})}),define("tau/ui/extensions/list/extension.list.prioritize.comment",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.textConverter"],function(e,t,i,n){return i.extend({name:"extension.list.prioritize.comment","bus afterRender":function(e){this.$root=e.data.element,this.$el=e.data.element.find("[role=comment-form]")},"bus prioritize.updateGroupsCommentRequirements":function(t){var i=t.data.groups,n=this.$root.find("[role=group]");n.data("isCommentRequired",!1),e.forEach(i,function(e,t){n.eq(t).data("isCommentRequired",e.isCommentRequired)})},"bus prioritize.checkAvailability":function(t){var i=t.data.$targetGroup,n=t.data.$prevGroup;if(!i.data("isCommentRequired")||i[0]===n[0])return void this.fire("prioritize.isAvailable.comment");var a=t.data.$item;this.$item=a,this.item=t.data.item;var r=this.$el;r.removeClass("updating");var s=t.data.isCollapsed,o=!1;o=0==s?a.find("[role=sortable-handler]"):i.find("[role=title]"),a.tauBubble({showOnCreation:!0,alignTo:o}),r.detach(),a.tauBubble("widget").find("[role=content]").append(r),r.show(),a.tauBubble("show");var l=r.find("textarea");l.val("").focus();var u=r.find(":button"),c=u.eq(0);c.bind("click",e.bind(this._save,this));var d=u.eq(1);d.bind("click",e.bind(this._cancel,this)),a.bind("externalClose",e.bind(this._cancel,this));var p=function(){window.setTimeout(function(){var t=l.val()||"",i=0===e.trim(t).length;i?c.attr("disabled","disabled"):c.attr("disabled")&&c.removeAttr("disabled"),i?c.addClass("disable"):c.removeClass("disable")},50)};p(),c.bind("focus",p),l.bind("change keyup click propertychange paste",p)
},_save:function(e){e.stopPropagation();var t=this,i=this.$el,a=new n,r=a.convert(i.find("textarea").val(),!0),s=t.config.store,o=t.item;i.addClass("updating"),s.save("comment",{$set:{description:r,general:{id:o.id}},$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName"]}]}).done({success:function(){i.removeClass("updating"),t.fire("prioritize.isAvailable.comment"),t.$item.tauBubble("destroy")},failure:function(){t.fire("prioritize.isNotAvailable")}})},_cancel:function(){var e=this;this.$el.addClass("updating");var i=function(){e.fire("prioritize.isNotAvailable",{$item:e.$item}),e.$item.data("ui-tauBubble")&&e.$item.tauBubble("destroy")};t.fx.off===!0?i():setTimeout(i,50)}})}),define("tau/ui/templates/list_/ui.template.list",["tau/core/templates-factory"],function(e){var t={name:"list",markup:['<div class="tau-list">',"</div>"]};return e.register(t)}),define("tau/ui/extensions/list/extension.list.groups",["jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/list_/ui.template.list"],function(e,t){return t.extend({name:"extension.list.groups","bus afterRender":function(t){var i=this,n=t.data.element;n.delegate("[role=expander]","click",function(t){var n=e(t.target);if(!n.is("a")&&!n.parent("a").length){var a=n.parents("[role=group]:first");a.toggleClass("tau-list__group_collapsed_true"),i.bus.fire("toggled")}})}})}),define("tau/ui/extensions/list/extension.list.overlay",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(e){return e.extend({name:"extension.list.overlay",showOverlay:function(){if(this.element&&this.element.length){var e=this.element.tauOverlay("instance"),t=e?e.overlayCount||1:0;1>t&&(t=0,this.element.tauOverlay(),e=this.element.tauOverlay("instance")),e.overlayCount=++t}},hideOverlay:function(){if(this.element&&this.element.length){var e=this.element.tauOverlay("instance").overlayCount||1;1>=e?this.element.tauOverlay("hide"):this.element.tauOverlay("instance").overlayCount=--e
}},"bus dataBind + afterRender":function(e,t,i){this.element=i.element.parent()},"bus beforeInit":function(){this.showOverlay()},"bus afterRender":function(){this.hideOverlay()}})}),define("tau/ui/extensions/list/extension.list.state",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({name:"extension.list.state",initialState:{},"bus beforeInit":function(){},"bus preDataBind":function(t){var i=t.data,n=this.stateManager=this.config.context.componentSettings||this.config.context.configurator.getStateManager(),a={};n.get({id:"list",fields:["state"],callback:function(e){a=e.state||{}}});var r=this;e.forEach(i.groups,function(t){var i=e.asString(t.key);r.initialState[i]=t.collapsed,e.isUndefined(a[i])||(t.collapsed=a[i])})},"bus afterInit+afterRender":function(e){this.$el=e.afterRender.data.element},"bus toggled":function(){var i=this.$el.find("[role=group]"),n={},a=this;i.each(function(){var i=t(this),r=i.hasClass("tau-list__group_collapsed_true"),s=i.data("tmplItem").data,o=e.asString(s.key);e.isUndefined(a.initialState[o])||a.initialState[o]===r||(n[o]=r)});{var r=this.stateManager;this.config.context.configurator}r.set({id:"list",set:{state:n},callback:function(){}})}})}),define("tau/ui/extensions/list/extension.list.handleAction",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({name:"extension.list.handleAction",getRowElement:function(e,t){var i=e.find(".i-item-"+t);return i},"bus afterItemsProvided+afterRender+handleGlobalAction":function(t){var i=t.afterItemsProvided.data.data,n=t.handleGlobalAction.data.id,a=e(i).detect(function(e){return e.id==n});if(a){var r=t.afterRender.data.element,s=this.getRowElement(r,n);this.fire("markElementToBeUpdated",{element:s}),this.fire("updateElement",{element:s}),this.fire("refreshMainEntity")}},"bus afterRender+beforeDeleteRow":function(e){var t=e.afterRender.data.element,i=e.beforeDeleteRow.data.id,n=this.getRowElement(t,i);
this.fire("markElementToBeDeleted",{element:n}),this.fire("deleteElement",{element:n,callback:$.noop})},"bus afterRender+afterDeleteRow":function(e){var t=this,i=e.afterRender.data.element,n=e.afterDeleteRow.data.id,a=this.getRowElement(i,n);this.fire("deleteElement",{element:a,callback:function(){t.fire("refresh")}})}})}),define("tau/ui/extensions/list/extension.list.handleAction.generator",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){var i=function(t,i){var n=i.split(":"),a=t;return e(n).each(function(e){a=a[e]}),a};return function(e,n){return t.extend({name:"extension.list.handleAction.generator/"+e,init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on(e,this.onGlobalAction,this)},destroy:function(){this.bus.getGlobalBus().removeListener(e,this.onGlobalAction,this),this._super.apply(this,arguments)},onGlobalAction:function(e){var t=i(e.data,n);this.fire("handleGlobalAction",{id:t})}})}}),define("tau/models/dataProviders/model.provider.groups.default",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(e,t){return t.extend({fetch:function(t,i,n){var a=[];return t?(e.forEach(i,function(i){var n=e.complexKey(i,t),r=e(a).any(function(e){return e.key===n});r||a.push({key:n,items:[]})}),void n(a)):void n(!1)}})}),define("tau/models/model.list",["Underscore","tau/core/model-base","tau/models/dataProviders/model.provider.groups.default"],function(e,t,i){var n=t.extend({name:"model.list",onInit:function(){var e=this;e.store.unbind(this);var t=new this.config.itemsDataProvider(this.config);t.fetch(function(t){e.fire("afterItemsProvided",{data:t})})},"bus afterItemsProvided":function(t){var n=this,a=null;a=this.config.groupsDataProvider?this.config.groupsDataProvider:i;var r=t.data.data,s=e.isArray(this.config.groupBy)?this.config.groupBy[0]:this.config.groupBy,o=new a(this.config);o.fetch(s,r,function(e){n.fireAfterGroupsProvided(e)})},fireAfterGroupsProvided:function(e){this.fire("afterGroupsProvided",{data:e})
},createSubscription:function(e,t){var i=this;i.store.on({eventName:"beforeRemove",type:e,listener:i},function(e){var n=e.data.id;t(n)&&i.fire("beforeDeleteRow",{id:n})}),i.store.on({eventName:"afterRemove",type:e,listener:i},function(e){var n=e.data.id;t(n)&&i.fire("afterDeleteRow",{id:n})})},"bus afterItemsProvided+afterGroupsProvided":function(t){var i=this,n=t.afterItemsProvided.data.data,a=t.afterGroupsProvided.data.data;if(n&&n.length){var r=function(t){return e(n).detect(function(e){return e.id==t})};e(n).chain().map(function(e){return e.__type}).unique().each(function(e){i.createSubscription(e,r)})}var s={items:[],groups:[],isEmpty:n.length?!1:!0};a!==!1?s.groups=this.innerGroupBy(n,a):s.items=n,this.data=s,i.fire("afterDataProvided",{data:s}),s.isEmpty&&i.fire("noData")},"bus afterDataProvided":function(e){var t=this.preProcess(e.data.data);this.fire("preDataBind",t),this.fire("dataBind",t)},preProcess:function(t){var i=this.config.views[0];return e.forEach(t.groups,function(t){t.title||(t.title=e.isObject(t.key)?e.complexKey(t.key,i.group.dataIndex):t.key)}),t.config={views:this.config.views,currentView:i},t},innerGroupBy:function(t,i){var n=this.config.groupBy;return n=e.isArray(n)?n[0]:n,e.forEach(i,function(i){e.forEach(t,function(t){var a=e.complexKey(t,n);e.isArray(i.key)&&e.indexOf(i.key,a)>-1?i.items.push(t):e.isEqual(i.key,a)&&i.items.push(t)})}),i},"bus prioritize.start":function(t){var n=t.data.item,a=t.data.group,r=null;r=this.config.groupsDataProvider?this.config.groupsDataProvider:i;var s=new r(this.config),o=e.filter(this.data.groups,function(e){return s.isAvailableForItem(n,e,a)});this.fire("prioritize.updateGroupsAvailability",{groups:o});var l=s.getCommentRequirements(n,this.data.groups,a);this.fire("prioritize.updateGroupsCommentRequirements",{groups:l})}});return n}),define("tau/models/model.list.editable",["Underscore","tau/core/model.editable.base"],function(e,t){var i=t.extend({name:"model.list.editable",category:"edit","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})
},"bus positionUpdated":function(t){var i=t.data,n=this,a=[];0==i.isCollapsed&&a.push(function(e){var t=new n.config.itemsDataProvider(n.config);t.changePriority(i.item,i.prev,i.next,function(t){e(null,t)})}),i.group&&a.push(function(e){var t=new n.config.groupsDataProvider(n.config);t.moveToGroup(i.item,i.group,i.prevGroup,function(t){e(null,t)})}),n.fire("beforeUpdate"),1==i.isCollapsed?e.parallel(a,function(){n.fire("refresh")}):e.parallel(a,function(t,i){var a={};e.forEach(i,function(t){t&&e.extend(a,t.changed||{})}),n.fire("afterUpdate",{changedItem:a})})}});return i}),define("tau/views/view.list",["tau/core/view-base"],function(e){return e.extend({name:"view.list","bus initialize":function(e){var t=this.config.views[0];t.type=t.type||"grid";var i=["tau/ui/templates/list_/",t.type,"/ui.template.list.",t.type].join(""),n=this;requireSync([i],function(t){n.config.template=t,n.startLifeCycle(e)})}})}),define("tau/components/component.list",["Underscore","tau/components/component.creator","tau/ui/extensions/list/extension.list.prioritize","tau/ui/extensions/list/extension.list.prioritize.comment","tau/ui/extensions/list/extension.list.groups","tau/ui/extensions/list/extension.list.overlay","tau/ui/extensions/list/extension.list.state","tau/ui/extensions/ui.extension.tooltip","tau/ui/extensions/list/extension.list.handleAction","tau/ui/extensions/list/extension.list.handleAction.generator","tau/models/model.list","tau/models/model.list.editable","tau/views/view.list","tau/ui/extensions/list/external.refresh.extension"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return{create:function(m){m=m||{},m.views=m.views||[{}],e(m.views).each(function(e){e.emptyMessage=e.emptyMessage||"No items found",e.rowTemplateName=e.rowTemplateName||"list-grid-entity__row"});var h=m.views[0];h.type=h.type||"grid",m.multiprojects&&(h.multiprojects=m.multiprojects),h.timeTrackingPolicies=m.context.getTimeTrackingPolicies();var g=[d,a,r,s,o,f,l,u("bugWasMarkedAsDuplicate","duplicateBugId"),u("entityWasMovedToProject","entity:id"),u("entityWasCopiedToProject","entity:id")];
m.sortable!==!1&&(g.push(i),g.push(n));var v={extensions:g.concat(m.extensions||[]),ModelType:c,ViewType:m.ViewType||p};return m.template&&(v.template=m.template),t.create(v,m)}}}),define("tau/models/dataProviders/customField/customField.multipleEntities.model.provider.entities.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(e,t){return t.extend({fetch:function(t){var i=this.config.context.entity.id,n=this.config.context.entity.entityType.name.toLowerCase(),a=this.config.customField,r=this.config.store,s=this;r.get(n,{id:i,fields:["customFields"]}).done(function(i){var n=e.find(i[0].data.customFields,function(e){return e.name==a.name});if(null==n.value)return void t([]);var o=n.value.split(","),l=e.map(o,function(e){var t=e.split(" ");return{id:t[0],type:t[1]}}),u=e.uniq(e.map(l,function(e){return e.type})),c=e.uniq(e.map(l,function(e){return e.id})),d=e.map(u,function(e){return function(t){r.find(e,{fields:s._getFieldsForEntity(e),$query:{id:{$in:c}}}).done({success:function(e){t(!1,e[0].data)}})}});e.parallel(d,function(i,n){var a=[];e.reduce(n,function(e,t){return t.length>0&&e.push({type:t[0].__type,items:t}),e},a),a=e.sortBy(a,function(e){return e.items.length>0&&e.items[0].entityType.id}),t(s.transform(a))})})},_getFieldsForEntity:function(e){var t=["id","name",{entityType:["name"]},{project:["abbreviation"]}];switch(e.toLowerCase()){case"userstory":case"bug":case"feature":case"task":case"testplanrun":case"testcaserun":case"request":return t.concat([{entityState:["name","isFinal"]},{release:["name"]},{iteration:["name"]}]);case"project":case"release":case"program":return t.concat(["startDate","endDate"]);case"iteration":return t.concat(["startDate","endDate",{release:["name"]}]);case"build":return t.concat(["buildDate",{release:["name"]},{iteration:["name"]}]);case"impediment":return t.concat([{entityState:["name","isFinal"]}]);case"testcase":return t.concat(["lastStatus"]);default:return t}},transform:function(t){var i=[],n=0;
e.reduce(t,function(t,i){return e.forEach(i.items,function(e){t.push(e),e.entityType.id>n&&(n=e.entityType.id)},this),t},i,this);var a=this;return i=e.map(i,function(e){return e.url=a.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.entityType.name,!0),e}),e.sortBy(i,function(e){return e.entityState&&e.entityState.isFinal?n+e.entityType.id:e.entityType.id})}})}),define("tau/ui/extensions/list.customField.multipleEntities/ui.extension.list.customField.multipleEntities",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterInit":function(e,t){this.store=t.config.context.configurator.getStore(),this.entity=t.config.context.entity,this._registerRefreshHandler(this.store,this.entity)},"bus afterInit + afterRender":function(e,t){this.customField=t.config.customField,this.fire("customField.ready",this.customField)},"bus afterInit:last + customField.ready + afterRender":function(e,t,i,n){var a=this;this._retrieveIdsForField(this.store,this.entity.id,this.entity.entityType.name,this.customField.name,function(e){var t=n.element.find(".i-role-remove");t.on("click",function(t){a._doDetach(t,e,a.store,a.customField,a.entity)})})},_doDetach:function(t,i,n,a,r){var s=$(t.currentTarget).attr("data-entity-id"),o=$(t.currentTarget).attr("data-entity-type").toLowerCase(),i=i;i=e.reject(i,function(e){return e==s+" "+o}).join(","),this._saveIds(n,r.id,r.entityType.name,a.name,i,function(){})},_saveIds:function(e,t,i,n,a,r){e.save(i,{id:t,$set:{customFields:[{name:n,value:a}]},fields:["id","customFields"]}).done(function(e){r&&r(e)})},_registerRefreshHandler:function(t,i){var n=this;t.unbind(this),t.on({eventName:"afterSave",type:i.entityType.name,listener:this,filter:{id:i.id},hasChanges:["customFields"]},function(t){var i=e.find(t.data.changes.customFields,function(e){return e.name==n.customField.name});i&&n.fire("refresh")})},_retrieveIdsForField:function(t,i,n,a,r){t.get(n,{id:i,fields:["customFields"]}).done(function(t){var i=e.find(t[0].data.customFields,function(e){return e.name==a
}),n=null!=i.value?i.value.split(","):[];r(n)})}})}),define("tau/ui/templates/list_/customField.multipleEntities/ui.template.list.customField.multipleEntities",["tau/core/templates-factory","tau/utils/utils.date"],function(e,t){var i={name:"list.customField.multipleEntities",engine:"jqote2",customFunctions:{dateToString:function(e){return t.format.date.short(t.convertToTimezone(e))}},markup:["<% if (this.items.length == 0) { %>",'<div class="tau-list__empty-message">No items.</div>',"<% } else { %>",'<table class="tau-list__table tau-list__list" role="list">',"<tbody>","<% _.forEach(this.items, function(item) { %>",'<tr class="i-item-<%= item.id %> tau-list__table__row<% if (item.entityState && item.entityState.isFinal) { %> tau-list__table__row_isfinalstate_true<% }; %>" role="item">','<td class="tau-list__table__cell tau-list__table__cell-id tau-list__list__item" >','<a href="<%= item.url %>"><em class="tau-entity-icon tau-entity-icon--<%= item.__type.toLowerCase() %>"><%= item.id %></em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name tau-list__table__cell-padding  tau-list__list__item" width="30%"><%= item.name %></td>','<td class="tau-list__table__cell tau-list__list__item"><%= item.project ? item.project.abbreviation : "" %></td>','<td class="tau-list__table__cell tau-list__list__item">',"<% if (item.entityState) { %>",'<div runas="property.entityState" data-context:general:id="<%= item.id %>" data-context:general:entity-type:name="<%=item.__type %>"><%= item.entityState.name %></div>','<% } else if (item.hasOwnProperty("lastStatus")) { %>','<div runas="property.lastStatus" data-context:general:id="<%= item.id%>" data-context:general:entity-type:name="<%= item.__type %>"><%= item.lastStatus %></div>',"<% }; %>","</td>",'<td class="tau-list__table__cell tau-list__list__item"><%= item.release ? item.release.name : "" %></td>','<td class="tau-list__table__cell tau-list__list__item"><%= item.iteration ? item.iteration.name : "" %></td>','<td class="tau-list__table__cell tau-list__list__item"><%= item.buildDate ? fn.dateToString(item.buildDate) : fn.dateToString(item.startDate) %></td>','<td class="tau-list__table__cell tau-list__list__item"><%= fn.dateToString(item.endDate) %></td>','<td class="tau-list__table__cell tau-list__list__item">',"<% if (item.assignments && item.assignments.length) { _.forEach(item.assignments, function(assignment){ %>",'<span class="ui-assignment__group__users">','<span class="ui-assignment__user user tau-avatar_<%= assignment.generalUser.id %> tau-bubble-target" userid="<%= assignment.generalUser.id %>">','<img class="user-name ui-link" title="<%= assignment.generalUser.firstName %> <%= assignment.generalUser.lastName %>" alt="<%= assignment.generalUser.firstName %> <%= assignment.generalUser.lastName %>" style="width:24px; height:24px;" src="<%= assignment.generalUser.avatarUri %>32">',"</span>","</span>","<% }); } %>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-remove tau-list__list__item">','<button type="button" class="tau-btn tau-attention i-role-remove" data-entity-type="<%= item.__type.toLowerCase() %>" data-entity-id="<%= item.id %>">Remove</button>',"</td>",'<td width="1"></td>',"</tr>","<% }); %>","</tbody>","</table>","<% } %>"]};
return e.register(i)}),define("tau/components/component.customField.multipleEntities",["Underscore","tau/components/component.list","tau/views/view.compositeControl","tau/models/dataProviders/customField/customField.multipleEntities.model.provider.entities.items","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list.customField.multipleEntities/ui.extension.list.customField.multipleEntities","tau/ui/templates/list_/customField.multipleEntities/ui.template.list.customField.multipleEntities"],function(e,t,i,n,a,r,s){return{create:function(o){return o=e.extend(o,{itemsDataProvider:n,extensions:[a,r],template:s,ViewType:i,dependencies:["property.lastStatus","property.entityState"]}),t.create(o)}}}),define("tau/models/customField/model.customField.multiselect.editable",["Underscore","tau/models/customField/model.customField.editable"],function(e,t){var i=t.extend({onInit:function(){if(this.config.data){var t=this.config.data.value,i=[];e.map(this.config.data.options,function(n){i.push({id:n,name:n,selected:e.include(t,n)})}),this.fire("dataBind",{states:i})}},"bus beforeInit:last + updateState":function(t,i,n){var a=null;n&&n.id&&(a=n.id);var r={customFields:[{name:i.config.customField.name,type:i.config.customField.type,value:e.toArray(a).join(",")}]};this.fire("save",r)}});return i}),define("tau/components/extensions/customField/extension.customField.multiselect.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var t=(e.afterRender.data.data,e.permissionsReady.data);if(t.editable){var i=e.afterRender.data.element,n=i.find(".ui-customfield__value");this.$widget=n,i.find(".ui-customfield__label").behaviourCustomFieldRow({}),i.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/extensions/customField/ui.extension.customField.editable.multiselect",["Underscore","tau/core/extension.base","tau/models/customField/model.customField.entity.editable","tau/models/finder.entity/model.finder.entity.data.customField.entity"],function(e,t){return t.extend({"bus beforeInit + configurationProvided + afterRender":function(t,i,n,a){var r=i.customField,s=a.element.find("tr"),o=e.deepClone(n),l=a.view,u=this._createFinderConfig(o,r,n);
this._initBubbleWithFinder(s,l,u),s.on("click",".i-role-reset",e.bind(function(){return this.fire("updateState",{}),!1},this))},_createFinderConfig:function(e){return{type:"customField.multiselect.list",customField:e,data:e}},_initBubbleWithFinder:function(e,t,i){e.addClass("tau-bubble-target ui-customfield_editable_true");var n={target:e,alignTo:e.find(".ui-customfield__valuelink"),onShow:function(){t.config.context.configurator.getKeyBoardManager().pushHandler({})},onHide:function(){t.config.context.configurator.getKeyBoardManager().popHandler()},componentsConfig:{components:[i]}};this.fire("initBubble",n)}})}),define("tau/ui/templates/customField/ui.template.customField.multiselect",["tau/core/templates-factory"],function(e){var t={name:"customField-multiselect",engine:"jqote2",markup:['<% var className = this.output ? "" : "ui-customfield_empty_true"; %>','<div class="ui-customfield ui-customfield-multiselect <%= className %>">',"<table>","<tbody>","<tr>",'<td class="ui-customfield__label"><%= this.name %></td>','<td class="ui_custom_field_value_container">','<div class="ui-customfield__value ui-customfield__value_margin_right"><%! this.output %></div>',"<% if (this.actionReset && this.actionReset.enable) { %>",'<% var title = this.actionReset.label || "reset"; %>','<span class="i-role-reset tau-clear-filter tau-clear-filter_margin_left" title="<%! title %>"></span>',"<% } %>","</td>","</tr>","</tbody>","</table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.multiselect",["Underscore","tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.editable","tau/models/customField/model.customField.multiselect.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/components/extensions/customField/extension.customField.multiselect.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/extensions/customField/ui.extension.customField.editable.multiselect","tau/ui/templates/customField/ui.template.customField.multiselect"],function(e,t,i,n,a,r,s,o,l,u,c,d){return{create:function(e){var n={ModelType:i,extensions:[a,r,l,u,o,s,c],template:d};
return t.create(n,e)}}}),define("tau/ui/extensions/choice/ui.extension.choice.editable.multiselect",["Underscore","jQuery","tau/ui/extensions/choice/ui.extension.choice.editable"],function(e,t,i){return i.extend({"bus dataBind+afterRender":function(i){this._super(i);var n=i.afterRender.data.element;this.$el=n,this.field=this.config.data,this._updateSave();var a=n.find("[role=action-save]"),r=this;a.click(function(){var i=n.find("[role=option].tau-option_selected_true"),a=[];e.forEach(i,function(e){a.push(t(e).tmplItem().data.id)}),r._updateState(a)});var s=n.find("[role=action-cancel]");s.click(function(){r.fire("close")})},"bus blur":function(){this.bus.fire("close")},onItemSelected:function(e){var i=t(e.target);i.toggleClass("tau-option_selected_true"),this._updateSave()},_updateSave:function(){if(1==this.field.required){this.enabled=this.enabled||null;var e=this.$el.find("[role=option].tau-option_selected_true"),t=this.$el.find("[role=action-save]");e.length?(t.removeClass("disable"),t.removeAttr("disabled")):(t.addClass("disable"),t.attr("disabled","disabled"))}}})}),define("tau/ui/templates/choice/ui.template.choice.option.multiselect",["tau/core/templates-factory"],function(e){var t={name:"state.option.multiselect",markup:["{{if items}}",'<div class="drop-down-group i-group">','<span class="i-group-name">${name}</span>','{{tmpl(items) "state.option.multiselect"}}',"</div>","{{else}}",'<div role="option" data-id="${id}" class="i-role-option drop-down-option tau-option{{if selected}} tau-option_selected_true{{/if}}" {{if description}}title="${description}"{{/if}}>',"${name}","</div>","{{/if}}"]};return e.register(t)}),define("tau/ui/templates/choice/ui.template.choice.list.multiselect",["tau/core/templates-factory","tau/ui/templates/choice/ui.template.choice.option.multiselect"],function(e){var t={name:"state.list.multiselect",markup:['<div class="ui-drop-down">',"{{if states.length}}",'<div role="list" class="drop-down-list drop-down-list_type_multiselect">','<div class="drop-down-list__inner i-inner">','{{tmpl(states) "state.option.multiselect"}}',"</div>","</div>",'<div class="ui-drop-down__actions ui-form__row ui-form__row-controls button-group">','<input type="button" role="action-save" class="button" value="Save" />','<input type="button" role="action-cancel" class="button" value="Cancel" />',"</div>","{{else}}",'<div class="drop-down-list drop-down-list_type_multiselect">','<div role="placeholder-empty">No items found</div>',"</div>","{{/if}}","</div>"]};
return e.register(t)}),define("tau/components/component.customField.multiselect.list",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.multiselect.editable","tau/ui/extensions/choice/ui.extension.choice.editable.multiselect","tau/ui/extensions/bubble/ui.extension.bubble.listResizer","tau/ui/templates/choice/ui.template.choice.list.multiselect"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[t,i,n,a],template:r};return e.create(o,s)}}}),define("tau/models/customField/model.customField.number.editable",["Underscore","tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema"],function(e,t,i){var n=t.extend({category:"edit",name:"Editable custom field",schema:i.Schema.create({type:"object",properties:{value:{type:"number",optional:!1,minimum:0,maximum:e.MAX_INT,minimumCanEqual:!0,pre:["trim","castTolerantlyToType"],"default":0,fallbacks:{type:"setDefault"}}}}),"bus validate":function(e){{var t=e.data,i=t.cmd.$set.customFields[0];i.value+"",this.config.context.applicationContext.culture.decimalSeparator}i.value=i.value.toString().replace(",","."),this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.empty,t.validation=this.schema.validate(i)},"bus beforeSave":function(t){var i=t.data.cmd.$set.customFields[0].value;t.data.cmd.$set.customFields[0].value=e.isNumber(i)?i:null}});return n}),define("tau/components/extensions/customField/extension.customField.number.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit",$widget:null,fieldData:null,"bus permissionsReady+afterRender":function(e){var t=this.config.context.applicationContext.culture.decimalSeparator,i=this,n=e.afterRender.data.data,a=e.permissionsReady.data;
if(a.editable){var r=e.afterRender.data.element,s=r.find(".ui-customfield__value");i.$widget=s;var o="^[0-9]*(["+t+"][0-9]{0,2})?$";s.editableText({mask:o,restoreText:!1,onSave:function(e){i.bus.fire("save",{customFields:[{name:n.name,type:n.type,value:e.replace(",",".")}]})}}),r.behaviourCustomFieldRow({onActivate:function(){s.editableText("activate"),s.focus()}}),r.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.editableText("setValue",e.data.validation.instance.value)},"bus validationFailed":function(e){this.$widget.editableText("setValidationErrors",e.data.validation.errors[0].description)}})}),define("tau/ui/templates/customField/ui.template.customField.text",["tau/core/templates-factory"],function(e){var t={name:"customField-text",markup:['<div class="ui-customfield  {{if !value}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value">${value}</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.number",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.number.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.number.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.text"],function(e,t,i,n,a,r,s){return{create:function(o){var l={ModelType:t,template:s,extensions:[i,a,n,r]};return e.create(l,o)}}}),define("tau/models/customField/model.customField.richtext.editable",["tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.htmlConverter"],function(e,t,i){var n=e.extend({category:"edit",name:"Editable custom field",schema:t.Schema.create({type:"object",properties:{value:{optional:!0,empty:!0,maxLength:4e3,type:"string",pre:["trim"]}}}),"bus save":function(e){var t=this,n=t.config.context?t.config.context.entity:{},a=e.data||{},r=a.$set||a,s=a.$include,o=a.hasOwnProperty("id")?a.id:n.id,l=a.typeName||n.entityType.name,u={$set:r,fields:s};
o&&(u.id=o);var c={type:l,cmd:u,validation:{isValid:!0,isError:function(){return!1}}},d=c.cmd.$set.customFields[0];if(c.validation=this.schema.validate(d),t.fire("afterValidate",c),c.validation.isValid===!1||c.validation.isError&&1==c.validation.isError())return void this.fire("validationFailed",c);t.fire("beforeSave",c);var p=c.cmd.$set,f=p.customFields[0];f.value=i.fromHtmlToSource(f.value),t.store.save(l,u,{success:function(e){t.fire("afterSave",{type:e.command.type,cmd:u})},failure:function(e){t.fire("saveFailed",{data:e,type:e.command.type,cmd:u})}}).done()}});return n}),define("tau/components/extensions/customField/extension.customField.richtext.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(e,t,i){return i.extend({category:"edit",resetLifecycle:!0,"bus beforeInit:last + dataBind:last + submitted":function(e,t,i,n){var a=t.config.context.entity;t.config.context.configurator.getStore().evictProperties(a.id,a.entityType.name,["customFields"]);var r={customFields:[{name:i.name,type:i.type,value:n}]};this.fire("save",r),this.fire("allow.close.editor")},"bus beforeInit + permissionsReady + dataBind + afterRender":function(t,i,n,a,r){if(n.editable){var s=i.config.context.configurator,o=r.element,l=o.find(".i-role-property");l.attr("data-placeholder","Double-click to add content..."),this.$widget=l;var u=e.bind(this.fire,this),c="richeditor";l[c]({ckPath:s.getCkPath(),text:a.value,settings:{toolbar:"Full",extraPlugins:"charcount",charcount_limit:4e3,height:"auto",maxHeight:8e3},onCreate:function(){this.active=!0,u("$editor.ready",l)},onHide:function(){this.active=!1},onCancel:function(){l[c]("hide"),u("allow.close.editor")},onSave:function(e){u("submitted",e)}})}}})}),define("tau/ui/extensions/customField/ui.extension.customField.richText.editable",["./ui.extension.customField.editable"],function(e){var t=e.extend({"bus preRefreshRow + allow.close.editor":function(){this._markElementAsUpdate()
},"bus preRefreshRow":function(){},"bus allow.close.editor > afterSave":function(){this._refreshElement()},"bus refreshRow":function(){this.element.find(".i-role-property").richeditor("option","active")||this._refreshElement()}});return t}),define("tau/components/extensions/property/extension.property.richtext.autosave",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){var n="Saving...";return i.extend({category:"edit",resetLifecycle:!0,autoSaveDelay:5e3,"bus beforeInit":function(e,t){this.fire("options.ready",this._extractOptions(t.config.options,{richeditor:"richeditor"}))},"bus options.ready:last + $editor.ready":function(t,i,a){var r=i.richeditor;a[r]("setStatus",""),a[r]("enableSaveButton"),a.on(r.toLowerCase()+"change.autosave",function(){a[r]("getStatus")!=n&&a[r]("setStatus","")}),a.on(r.toLowerCase()+"change.autosave",e.debounce(e.bind(function(){if(a.data("ui-"+r)){var e=a[r]("getText");"string"==typeof e&&(a[r]("setStatus",n),a[r]("disableSaveButton"),this.fire("submitted.auto",e))}},this),this.autoSaveDelay))},"bus beforeInit:last + submitted.auto":function(e,t,i){var n={};if(t.config.fieldName)n[t.config.fieldName]=i;else{var a=t.config.customField;n={customFields:[{name:a.name,type:a.type,value:i}]}}this.fire("save",n)},"bus submitted.auto > afterSave":function(){this.fire("autosave.completed")},"bus submitted.auto > validationFailed":function(e,t,i){this.fire("autosave.failed",i.validation.errors[0].description)},"bus options.ready:last + $editor.ready:last + autosave.completed":function(e,t,i){var n=t.richeditor;i[n]("setStatus","All changes saved"),i[n]("enableSaveButton")},"bus options.ready:last + $editor.ready:last + autosave.failed":function(e,t,i,n){var a=t.richeditor;i[a]("setStatus",n),i[a]("disableSaveButton")}})}),define("tau/ui/templates/property/ui.template.property.richtext",["tau/core/templates-factory"],function(e){var t={name:"property.richtext",engine:"jqote2",markup:['<div class="ui-description tau-clientinput <% if (!this.value){ %>ui-field_empty_true<% } %>">','<div class="ui-description__inner i-role-property" data-placeholder="<%= this.placeholder %>">',"<%= fn.sanitize(this.value) %>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.customField.richtext",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.richtext.editable","tau/components/extensions/customField/extension.customField.richtext.editable","tau/ui/extensions/customField/ui.extension.customField.richText.editable","tau/components/extensions/property/extension.property.richtext.autosave","tau/ui/extensions/content/ui.extension.content.shortcutProcessor","tau/ui/extensions/content/ui.extension.content.imagePreview","tau/ui/templates/property/ui.template.property.richtext"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){u=u||{},u.queuedBus=!0;var c={queuedBus:!0,extensions:[t,i,n,a,r,s,o],template:l};return u.shortcutProcessorTarget=".i-role-property",u.imagePreviewContentSelector=".i-role-property",e.create(c,u)}}}),define("tau/models/customField/model.customField.templatedurl.editable",["tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",name:"Editable custom field",schema:t.Schema.create({type:"object",properties:{value:{type:"string",optional:!0,maxLength:4e3,minLength:0,pre:["trim"]}}}),"bus validate":function(e){var t=e.data,i=t.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,t.validation=this.schema.validate(i)}});return i}),define("tau/components/extensions/customField/extension.customField.templatedurl.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var t=this,i=e.afterRender.data.data,n=e.permissionsReady.data;if(n.editable){var a=e.afterRender.data.element,r=a.find(".ui-customfield__value");
t.$widget=r;var s;r.editableText({onEditStart:function(){s=r.children().detach(),r.text(""),r.hasClass("ui-validationerror")||r.text(r.data("textEdit"))},onEditEnd:function(){r.hasClass("ui-validationerror")||r.html(s)},restoreText:!1,onSave:function(e){t.bus.fire("save",{customFields:[{name:i.name,type:i.type,value:e}]})}}),r.on("click","a",function(e){e.stopImmediatePropagation()}),a.behaviourCustomFieldRow({onActivate:function(){r.editableText("activate"),r.focus()}}),a.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.editableText("setValue",e.data.validation.instance.value)},"bus validationFailed":function(e){this.$widget.editableText("setValidationErrors",e.data.validation.errors[0].description)}})}),define("tau/ui/templates/customField/ui.template.customField.templatedurl",["tau/core/templates-factory"],function(e){var t={name:"customField-templatedUrl",engine:"jqote2",markup:['<div class="ui-customfield ui-customfield-templatedUrl <% if (this.isEmpty){ %>ui-customfield_empty_true<% } %>">',"<table>","<tbody>","<tr>",'<td class="ui-customfield__label"><%! this.name %></td>','<td class="ui_custom_field_value_container">','<div class="ui-customfield__value" data-text-edit="<%= this.value %>">',"<% _.forEach(this.output, function(v, i){ %>",'<a class="tau-linkentity tau-linkentity_type_full" title="<%! v.title %>" href="<%= v.url %>" target="_blank">','<span class="tau-linkentity__inner"><%! v.title %></span>','<span class="external-view"></span>',"</a>","<% }); %>","</div>","</td>","</tr>","</tbody>","</table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.templatedurl",["Underscore","tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.templatedurl.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.templatedurl.editable","tau/ui/templates/customField/ui.template.customField.templatedurl"],function(e,t,i,n,a,r,s,o){return{create:function(e){var l={extensions:[i,n,a,r,s],template:o};
return t.create(l,e)}}}),define("tau/models/customField/model.customField.text.editable",["tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",name:"Editable custom field",schema:t.Schema.create({type:"object",properties:{value:{type:"string",optional:!0,maxLength:4e3,minLength:0,pre:["trim"]}}}),"bus validate":function(e){var t=e.data,i=t.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,t.validation=this.schema.validate(i)}});return i}),define("tau/components/extensions/customField/extension.customField.text.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var t=this,i=e.afterRender.data.data,n=e.permissionsReady.data;if(n.editable){var a=e.afterRender.data.element,r=a.find(".ui-customfield__value");t.$widget=r,r.editableText({restoreText:!1,onSave:function(e){t.bus.fire("save",{customFields:[{name:i.name,type:i.type,value:e}]})}}),a.behaviourCustomFieldRow({onActivate:function(){r.editableText("activate"),r.focus()}}),a.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.editableText("setValue",e.data.validation.instance.value)},"bus validationFailed":function(e){this.$widget.editableText("setValidationErrors",e.data.validation.errors[0].description)}})}),define("tau/components/component.customField.text",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.text.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.text.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.text"],function(e,t,i,n,a,r,s){return{create:function(o){var l={ModelType:t,template:s,extensions:[i,n,a,r]};
return e.create(l,o)}}}),define("tau/models/customField/model.customField.url.editable",["tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",name:"Editable custom field",schema:t.Schema.create({type:"object",properties:{value:{type:"object",optional:!1,pre:function(e){var t=!!_.trim(e.label)||!!_.trim(e.url);return this.schema.properties.label.optional=this.schema.properties.label.optional&&!t,this.schema.properties.label.empty=this.schema.properties.label.empty&&!t,this.schema.properties.url.optional=this.schema.properties.url.optional&&!t,this.schema.properties.url.empty=this.schema.properties.url.empty&&!t,e},properties:{label:{type:"string",optional:!0,maxLength:30,pre:["trim"]},url:{type:"string",optional:!0,pattern:t.PATTERN_URL,pre:["trim",function(e){return 0==e.length&&this.schema.optional&&(this._wasError=1),e}]}},post:function(e){return e.label||e.url||(e={label:null,url:null}),e}}}}),"bus validate":function(e){var t=e.data,i=t.cmd.$set.customFields[0],n=this.config.customField||this.config.data;this.schema.properties.value.properties.label.optional=!n.required,this.schema.properties.value.properties.label.empty=!n.required,this.schema.properties.value.properties.url.optional=!n.required,this.schema.properties.value.properties.url.empty=!n.required,t.validation=this.schema.validate(i),delete t.validation.instance.value.__id}});return i}),define("tau/models/customField/model.customField.url.editable.editor",["tau/models/customField/model.customField.url.editable"],function(e){var t=e.extend({onInit:function(){this.beforeSaveHandler=!0,this.afterSaveHandler=!0,this.config.data&&this.fire("dataBind",this.config.data)}});return t}),define("tau/ui/behaviour/customField/ui.behaviour.customField.url.editor",["Underscore","jQuery"],function(e,t){t.widget("ui.behaviourUrlEditor",{options:{onSave:t.noop},_create:function(){var t=this.element;this.$element=t;var i=this;t.find(":button:first").click(function(t){t.preventDefault(),e.bind(i._save,i)()
}),t.find(":input").keyup(function(t){t.keyCode==jQuery.ui.keyCode.ENTER&&(t.preventDefault(),e.bind(i._save,i)())})},_save:function(){var e=this.element;this.options.onSave({url:e.find("[name=url]").val(),label:e.find("[name=label]").val()})},setValidationErrors:function(t){var i=this.$element;e.each(t,function(e,t){i.find("[name="+t+"]").addClass("ui-validationerror").attr("title",e)})},resetValidationErrors:function(){this.$element.find(":text").removeClass("ui-validationerror").attr("title",null)},setValue:function(t){var i=this.$element;e.each(t,function(e,t){i.find("[name="+t+"]").val(e)})},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.url.editor",["Underscore","jQuery","tau/core/extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.url.editor"],function(e,t,i){return i.extend({category:"edit","bus dataBind+afterRender":function(e){var t=this,i=e.dataBind.data,n=e.afterRender.data.element;this.$widget=n,n.find("[name=url]").val(i.value.url),n.find("[name=label]").val(i.value.label),n.behaviourUrlEditor({onSave:function(e){t.bus.fire("save",{customFields:[{name:i.name,type:"URL",value:e}]})}}),n.find(":button:eq(1)").click(function(){t.bus.fire("close")})},"bus validate":function(){this.$widget.behaviourUrlEditor("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.behaviourUrlEditor("setValue",e.data.validation.instance.value)},"bus validationFailed":function(t){var i={};e.each(t.data.validation.errors,function(t){e.each(["url","label"],function(n){-1!==e.indexOf(t.path,n)&&(i[n]=t.description)})}),this.$widget.behaviourUrlEditor("setValidationErrors",i)}})}),define("tau/ui/templates/customField/ui.template.customField.url.editor",["tau/core/templates-factory"],function(e){var t={name:"customField-url-editor",markup:['<div class="ui-form">','   <div class="ui-form__row"><label for="url">Url</label><input type="text" name="url" /></div>','   <div class="ui-form__row"><label for="label">Description</label><input type="text" name="label" /></div>','   <div class="ui-form__row ui-form__row-controls button-group"><input type="button" value="save" class="button" /><input type="button" value="cancel" class="button" /></div>',"</div>"]};
return e.register(t)}),define("tau/components/component.customField.url.editor",["tau/components/component.creator","tau/models/customField/model.customField","tau/models/customField/model.customField.url.editable.editor","tau/components/extensions/customField/extension.customField.url.editor","tau/ui/templates/customField/ui.template.customField.url.editor"],function(e,t,i,n,a){return{create:function(r){var s={extensions:[t,i,n],template:a};return e.create(s,r)}}}),define("tau/models/customField/model.customField.url.editable.row",["tau/models/customField/model.customField.url.editable"],function(e){var t=e.extend({onInit:function(){{var e=this.config.context;e.entity.entityType.name}},"bus afterSaveToStore":function(){this.bus.fire("refreshRow",{})}});return t}),define("tau/ui/templates/customField/ui.template.customField.url",["tau/core/templates-factory"],function(e){var t={name:"customField-url",markup:['<div class="ui-customfield ui-customfield-url {{if !value.url}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container">',"       {{if value.label}}",'           <a class="tau-linkentity tau-linkentity_type_full" href="${value.url}" title="${value.label}" target="_blank">','               <span class="tau-linkentity__inner">${value.label}</span>','               <span class="external-view"></span>',"           </a>","      {{/if}}","       </td>","   </tr>","   </tbody>","   </table>","</div>"]};return e.register(t)}),define("tau/components/component.customField.url",["Underscore","tau/components/component.creator","tau/models/customField/model.customField","tau/ui/extensions/customField/ui.extension.customField.required","tau/models/customField/model.customField.url.editable.row","tau/components/extensions/customField/extension.customField.url.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/components/extensions/bubble/extension.bubble.creator.direct","tau/components/extensions/component.creator.extension","tau/ui/templates/customField/ui.template.customField.url"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(e){var c={extensions:[i,n,a,r,s,l,{type:o,config:{popupEditorContainer:[{target:"tr",alignTo:".ui-customfield__value",componentsConfig:{components:[{type:"customField.url.editor"}]}}]}}],template:u};
return t.create(c,e)}}}),define("tau/models/model.property.simple",["Underscore","tau/core/model-base"],function(e,t){return t.extend({init:function(t){if(this._super(t),!t.propertyName)throw new Error("Property name was not configured");this.propertyName=t.propertyName,this.placeholderText=e.asString(t.placeholderText),this.listenedEntities={}},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},listenOfPropertyChanged:function(){var e=this.config.context.entity.id;this.listenedEntities[e]||(this.listenedEntities[e]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onInit:function(){this.listenOfPropertyChanged(),this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.propertyName]}).done({success:this.safeCallback(this.onEntityRetrieved)})},onEntityRetrieved:function(e){var t=this.config?e[0].data[this.propertyName]||this.config.defaultText:"";this.fire("dataBind",{name:this.propertyName,text:t,output:t,placeholderText:this.placeholderText})}})}),define("tau/models/model.property.date",["require","tau/models/model.property.simple","tau/utils/utils.date"],function(e){var t=e("tau/models/model.property.simple"),i=e("tau/utils/utils.date");return t.extend({onEntityRetrieved:function(e){if(this.config){var t=e[0].data;this.property=t[this.propertyName];var n=i.convertToTimezone(this.property),a=this.config.format?this.config.format:"date",r=i.format[a].short(n),s={text:r,actionReset:{enable:this.config.allowReset}};this.fire("extendData",{dataToBind:s,entity:t,date:n}),this.fire("dataBind",s)}}})}),define("tau/models/model.property.date.validation",["Underscore","tau/core/model-base","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(e,t,i,n){var a=t.extend({category:"edit",name:"Model date validation","bus afterInit":function(){this.schema=i.Schema.create({type:"string",optional:this.config.allowReset,empty:this.config.allowReset,pre:function(t){return this.optional&&this.empty?e.isUndefined(t)?null:null!==t&&""===t?null:t:t
},post:function(e){if(0==this.wasError()){var t=n.parse(e),i=n.parse(this.schema.additionalProperties.max),a=n.parse(this.schema.additionalProperties.min);null==t?new this.Error("Date","Incorrect date format"):t<new Date(1900,0,1)?new this.Error("Date","Date must be greater than 1-Jan-1900"):i&&t>i?new this.Error("Date","Date must be less than "+n.format.date.short(i)):a&&a>t?new this.Error("Date","Date must be greater than "+n.format.date.short(i)):e=n.formatAs(t,this.schema.additionalProperties.dateFormat)}return e},additionalProperties:{dateFormat:n.getFormatData().date.short,max:null,min:null}}),"datetime"==this.config.format&&(this.schema.additionalProperties.dateFormat=n.getFormatData().datetime.short)},"bus afterRender":function(e){this.element=e.data.element},"bus validateDate":function(e){var t=this.schema.validate(e.data.value);e.data.value=t.instance},"bus validate":function(e){this._getProperty().dateEditor("resetValidationErrors");var t=e.data,i=t.cmd.$set[this.config.propertyName];t.validation&&1==t.validation.isError()||(t.validation=this.schema.validate(i),t.cmd.$set[this.config.propertyName]=t.validation.instance)},"bus resetValidationErrors":function(){this._getProperty().dateEditor("resetValidationErrors")},"bus afterValidate":function(e){var t=e.data.validation;this._getProperty().dateEditor("setValue",t.instance)},"bus validationFailed":function(e){var t=e.data.validation;this._getProperty().dateEditor("setValidationErrors",t.errors[0].description)},_getProperty:function(){return this.element.find(".property")}});return a}),define("tau/models/model.property.editable",["Underscore","tau/core/model.editable.base"],function(e,t){return t.extend({isEditable:function(){return 0!=this.config.editable},"bus beforeInit+dataBind":function(){this.fire("permissionsReady",{editable:this.isEditable()})},"bus beforeInit:last + reset.apply":function(t,i){var n=i.config.context.configurator,a=i.config.context.entity,r=i.config.propertyName,s={};s[r]=null;var o=e.bind(this.fire,this),l=i.config.additionalFields||[];
n.getStore().save(a.entityType.name,{id:a.id,fields:l,$set:s}).done(function(){o("refresh")})}})}),define("tau/models/model.property.date.editable",["require","tau/models/model.property.editable","tau/utils/utils.date"],function(e){var t=e("tau/models/model.property.editable"),i=e("tau/utils/utils.date");return t.extend({isEditable:function(){return this.config.editable},"bus afterValidate":function(e){var t=e.data.cmd.$set[this.config.propertyName];t&&(t=i.parse(t),t=i.format.datetime.short(t),e.data.cmd.$set[this.config.propertyName]=t)}})}),define("tau/models/model.date.editable",["require","tau/models/model.property.date.editable"],function(e){var t=e("tau/models/model.property.date.editable");return t.extend({isEditable:function(){return this.config.editable===!0||void 0===this.config.editable}})}),define("tau/components/extensions/property/extension.property.date.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(e,t,i,n){return i.extend({category:"edit",init:function(){this._super.apply(this,arguments),this.onClickProxy=t.proxy(this.onClickHandler,this)},"bus permissionsReady + afterRender + dataBind":function(i){var a=this;if(this.element=i.afterRender.data.element,this.permissions=i.permissionsReady.data,this.date=i.dataBind.data,this.permissions.editable){this.element.bind("click",this.onClickProxy),this.$widget=this.element.find(".property"),t.datepicker.parseDate=function(e,t){return n.parse(t)},t.datepicker.formatDate=function(e,t){return n.formatAs(t,e)};var r="datetime"==this.config.format?"datetimepicker":"datepicker";this.$widget.dateEditor({delayedSave:e.has(this.config,"delayedDateSave")?this.config.delayedDateSave:!0,keyboardManager:this.config.context.configurator.getKeyBoardManager(),dateFormat:n.getFormatData().date.short,widgetName:r,beforeChange:function(e){a.fire("validateDate",e)},onCancel:function(){a.onCancelEdit()},onSave:function(e){if(a.trimString(e)==a.trimString(a.date.text))a.fire("resetValidationErrors");
else{var t=a.config.propertyName,i={};i[t]=e;var n={$set:i,$include:[t]};a.bus.fire("save",n)}}})}},trimString:function(t){return e.trim(t||"")},showEditor:function(){this.$widget.dateEditor("activate"),this.$widget.focus()},"bus edit":function(){this.permissions.editable&&this.showEditor()},onClickHandler:function(){this.showEditor()},onCancelEdit:function(){},removeHandlers:function(){this.element&&this.element.unbind("click",this.onClickProxy)},removeWidget:function(){this.$widget&&this.$widget.data("ui-dateEditor")&&this.$widget.dateEditor("destroy")},destroy:function(){this.removeHandlers(),this.removeWidget(),this._super.apply(this,arguments)}})}),define("tau/ui/extensions/date/extension.date.editable",["require","Underscore","jQuery","tau/components/extensions/property/extension.property.date.editable"],function(e){var t=(e("Underscore"),e("jQuery"),e("tau/components/extensions/property/extension.property.date.editable"));return t.extend({"bus permissionsReady + afterRender + dataBind":function(){this._super.apply(this,arguments),this.showEditor()},onCancelEdit:function(){this.fire("afterSave")}})}),define("tau/components/extensions/property/extension.property.resettable",["require","Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e){var t=e("Underscore"),i=(e("jQuery"),e("tau/components/extensions/component.extension.base"));return i.extend({"bus permissionsReady + afterRender + dataBind":function(e){var i=e.permissionsReady.data;if(i.editable){var n=e.afterRender.data.element;n.on("click",".i-role-reset",t.bind(function(){return this.fire("reset.apply"),!1},this))}}})}),define("tau/components/extensions/property/extension.property.refresher",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"refresher","bus propertyChanged":function(){this.fire("refresh")},"bus avatarChanged":function(){this.fire("refresh")}})}),define("tau/ui/templates/date/ui.template.date",["require","tau/core/templates-factory"],function(e){var t=e("tau/core/templates-factory"),i={name:"date.simple",engine:"jqote2",markup:['<div class="ui-date__editable ui-title ui-title_type_simple">','<div class="property" style="display:inline">','<span class="property-text"><%!this.text%></span>',"</div>","</div>"],dependencies:[]};
return t.register(i)}),define("tau/components/component.date",["require","Underscore","tau/components/component.creator","tau/models/model.property.date","tau/models/model.property.date.validation","tau/models/model.date.editable","tau/ui/extensions/date/extension.date.editable","tau/components/extensions/property/extension.property.resettable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/date/ui.template.date"],function(e){var t=e("Underscore"),i=e("tau/components/component.creator"),n=e("tau/models/model.property.date"),a=e("tau/models/model.property.date.validation"),r=e("tau/models/model.date.editable"),s=e("tau/ui/extensions/date/extension.date.editable"),o=e("tau/components/extensions/property/extension.property.resettable"),l=e("tau/components/extensions/property/extension.property.refresher"),u=e("tau/ui/templates/date/ui.template.date");return{create:function(e){e=t.extend(t.clone(e)),e.validationExtension=e.validationExtension||a,e.propertyName="date",e.allowReset=!0;var c={ModelType:n,template:e.template||u,extensions:t.concat([e.extensions,l,r,s,o,e.validationExtension])};return i.create(c,e)}}}),define("tau/models/model.property.richtext",["Underscore","tau/core/extension.base.stateful","tau/utils/utils.htmlConverter"],function(e,t,i){var n=t.extend({onInit:function(t){var n=this,a=t.context.entity,r=this.store,s=t.fieldName,o=a.entityType.name,l=a.id;r.unbind(n);var u=function(e,t){if(t.data.id==l){var i=t.data.changes;i.hasOwnProperty(s)&&n.fire(e,i)}};r.on({eventName:"beforeSave",type:o,listener:this},e.bind(u,this,"prepareChanges")).on({eventName:"afterSave",type:o,listener:this},e.bind(u,this,"applyChanges")),r.get(o,{id:l,fields:["id",s]}).done(function(e){var a=e[0].data;n.fire("dataBind",{value:i.fromSourceToHtml(a[s]),placeholder:t.placeholder})})}});return n}),define("tau/models/model.property.richtext.editable",["tau/core/model.editable.base","tau/utils/utils.htmlConverter","tau/utils/utils.jsonSchema"],function(e,t,i){var n=e.extend({category:"edit",name:"model.property.richtext.editable",schema:null,init:function(e){this._super.apply(this,arguments);
var t={type:"object",properties:{}};this.fieldName=e.fieldName,t.properties[this.fieldName]={optional:!0,empty:!0,type:"string"},this.schema=i.Schema.create(t)},"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable===!0||void 0===this.config.editable,deletable:!0})},"bus beforeSave":function(e){var i=e.data.cmd.$set;i[this.fieldName]=t.fromHtmlToSource(i[this.fieldName])},"bus validate":function(e){var t=e.data,i=t.cmd.$set;t.validation=this.schema.validate(i)}});return n}),define("tau/components/extensions/property/extension.property.richtext.editable",["Underscore","jQuery","tau/core/extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(e,t,i){return i.extend({category:"edit",resetLifecycle:!0,editorIsActive:!1,"bus applyChanges":function(){this.editorIsActive||this.fire("refresh")},"bus beforeInit:last + submitted":function(e,t,i){var n=t.config.context.entity;t.config.context.configurator.getStore().evictProperties(n.id,n.entityType.name,[t.config.fieldName]);var a={};a[t.config.fieldName]=i,this.fire("save",a)},"bus beforeInit + dataBind + permissionsReady + afterRender":function(t,i,n,a,r){var s=r.element;if(a.editable)var o=s.find(".i-role-property"),l=i.config.context.configurator,u=e.bind(this.fire,this),c=i.config.richediitor?i.config.richediitor:"richeditor",d=o[c]({ckPath:l.getCkPath(),text:n.value,settings:{toolbar:"Full",height:"auto",getMentionConfig:function(){return l}},onCreate:e.bind(function(){this.editorIsActive=!0,u("$editor.ready",d)},this),onHide:e.bind(function(){this.editorIsActive=!1},this),onSave:function(e){o[c]("hide"),u("submitted",e)},onCancel:function(){o[c]("hide")}})}})}),define("tau/components/component.property.richtext",["tau/components/component.creator","tau/models/model.property.richtext","tau/models/model.property.richtext.editable","tau/components/extensions/property/extension.property.richtext.editable","tau/components/extensions/property/extension.property.richtext.autosave","tau/ui/extensions/content/ui.extension.content.shortcutProcessor","tau/ui/extensions/content/ui.extension.content.imagePreview","tau/ui/templates/property/ui.template.property.richtext"],function(e,t,i,n,a,r,s,o){return{create:function(l){l.queuedBus=!0;
var u={queuedBus:!0,extensions:_.compact([t,i,n,l.disableAutoSave?null:a,r,s]),template:o};return l.shortcutProcessorTarget=".i-role-property",l.imagePreviewContentSelector=".i-role-property",e.create(u,l)}}}),define("tau/components/component.description",["tau/components/component.property.richtext"],function(e){return{create:function(t){return t=t||{},t.fieldName="description",t.placeholder=t.placeholder||"Double-click to add description...",e.create(t)}}}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners.details",["tau/core/templates-factory"],function(e){var t={name:"diagnostics.globalListeners.details",markup:['<span class="tau-global-listener ui-link" data-details="${item.fn.toString()}">${name}</span><br/>']};return e.register(t)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners",["tau/core/templates-factory","tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners.details"],function(e){var t={name:"diagnostics.globalListeners",dependencies:["diagnostics.globalListeners.details"],markup:['<div class="tau-diagnostics-globalListeners">',"<table>","{{each data}}",'<tr class="tau-diagnostics-row">','<td>${count}</td><td>${name}</td><td>{{tmpl(listeners) "diagnostics.globalListeners.details"}}</td>',"</tr>","{{/each}}","</table>","</div>"]};return e.register(t)}),define("tau/components/extensions/diagnostics/extension.diagnostics.base",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/extensions/component.extension.base"],function(e,t,i,n,a){var r=a.extend({init:function(e){this._super(e)},_getData:function(){var e=0,a=t.values(i.getProxy().__subscriptions);return t.each(a,function(i){if(t.isObject(i)){var n=t.values(i);t.each(n,function(i){t.isObject(i)&&(e+=t(i).values().length)})}}),{countOfBuses:n.count(),globalBusListeners:i.getGlobalBus().getListenersCount(),storeListeners:e}},"bus beforeInit":function(){this.fire("dataBind",this._getData())},signUp:function(){var e=["create","destroy"],a=["initialize","refresh","afterStoreOn","afterStoreUnbind","afterRender"],r=t.throttle(this.refreshStats.bind(this),100);
t.each(e,function(e){n.on(e,r,this)},this);var s=i.getGlobalBus();t.each(a,function(e){s.on(e,r,this,null,1e3)},this)},startMonitoringWithOutRefresh:function(){this.monitoringStarted||(this.monitoringStarted=!0,this.signUp())},startMonitoring:function(){this.startMonitoringWithOutRefresh(),this.refreshStats()},"bus afterRender":function(){var e=this,n=this.config.startMonitoringConfig||{name:/(application|entity component)/,events:["afterRender"]},a=i.getGlobalBus(),r=function(i){i.caller.name.match(n.name)&&(t.each(n.events,function(){a.removeAllListeners(e)}),e.startMonitoring())};t.each(n.events,function(t){a.on(t,r,e)})},refreshStats:function(){this.fire("refreshData",this._getData())},"bus destroy":function(){i.getGlobalBus().removeAllListeners(this),n.removeAllListeners(this)}});return r}),define("tau/components/component.diagnostics.globalListeners",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(e,t,i,n,a,r,s){return{create:function(t){var n=s.extend({_getData:function(){return this.startMonitoringWithOutRefresh(),{data:i.getGlobalBus().getListeners()}},_onDetailsClick:function(t){var i=e(t.target);console.log(i.data("details"))},_signUpOnClick:function(t){var i=e(t.data.element);i.data("tau-global-listener")||i.on("click.tau-global-listener",".tau-global-listener",this._onDetailsClick).data("tau-global-listener",!0)},"bus elementRefreshedWithData":function(e){this._signUpOnClick(e)},"bus afterRender":function(e){this._signUpOnClick(e)}}),o={extensions:[n],template:r};return a.create(o,t)}}}),define("tau/ui/templates/diagnostics/ui.template.diagnostics",["tau/core/templates-factory"],function(e){var t={name:"diagnostics",markup:['<div class="tau-diagnostics-box">','<span class="ui-diag-label">Buses</span><span class="ui-diag-quantity">${countOfBuses}</span>','<span class="ui-diag-label">GB</span><span class="ui-diag-quantity">${globalBusListeners}</span>','<span class="ui-diag-label">Store</span><span class="ui-diag-quantity">${storeListeners}</span>',"</div>"]};
return e.register(t)}),define("tau/components/component.diagnostics",["tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(e,t,i){return{create:function(n){var a={extensions:[i],template:t};return e.create(a,n)}}}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.storeListeners.details",["tau/core/templates-factory"],function(e){var t={name:"diagnostics.storeListeners.details",markup:['<span class="tau-store-listener ui-link" data-details="${sub.callback.toString()}">${name}</span><br/>']};return e.register(t)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.store",["tau/core/templates-factory","tau/ui/templates/diagnostics/ui.template.diagnostics.storeListeners.details"],function(e){var t={name:"diagnostics.storeListeners",dependencies:["diagnostics.storeListeners.details"],markup:['<div class="tau-diagnostics-storeListeners">',"<table>","{{each data}}",'<tr class="tau-diagnostics-row">','<td>${items.length}</td><td>${name}</td><td>{{tmpl(items) "diagnostics.storeListeners.details"}}</td>',"</tr>","{{/each}}","</table>","</div>"]};return e.register(t)}),define("tau/components/component.diagnostics.store",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics.store","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(e,t,i,n,a,r,s){return{create:function(n){var o=s.extend({_getData:function(){this.startMonitoringWithOutRefresh(),this.listeners={},t.each(t.values(i.getProxy().__subscriptions),function(e){t.isObject(e)&&t.each(e,function(e){t.isObject(e)&&t.each(e,this._addListener,this)},this)},this);var e=t.values(this.listeners);return this.listeners=null,{data:e}},_addListener:function(e){var i=e.config.eventName+"["+e.config.type+"]";t.has(this.listeners,i)||(this.listeners[i]={name:i,items:[]}),this.listeners[i].items.push({name:this._getListenerName(e.config.listener),sub:e})
},_getListenerName:function(e){return e&&e.bus&&e.bus.name?e.bus.name:e&&e.name?e.name:"unknown"},_onDetailsClick:function(t){var i=e(t.target);console.log(i.data("details"))},_signUpOnClick:function(t){var i=e(t.data.element);i.data("tau-store-listener")||i.on("click.tau-store-listener",".tau-store-listener",this._onDetailsClick).data("tau-store-listener",!0)},"bus elementRefreshedWithData":function(e){this._signUpOnClick(e)},"bus afterRender":function(e){this._signUpOnClick(e)}}),l={extensions:[o],template:r};return a.create(l,n)}}}),define("tau/models/baseInfoList/extension.model.entityIdRetriever",["tau/models/extension.model.base"],function(e){var t=e.extend({"bus registerStoreRequest":function(e){var t=this.config.context.entity||e.data.entity||{entityType:{}},i={};i[this.config.propertyName]=["id"];var n=[i];this.fire("get",{type:t.entityType.name,query:{id:t.id,fields:n},callback:{success:this.onEntityRetrieved,scope:this}})},onEntityRetrieved:function(e){if(this.config){var t=e.data[this.config.propertyName];this.fire("entityIdsRetrieved",t)}}});return t}),define("tau/models/baseInfoList/extension.model.additionalInfoEntityRetriever",["Underscore","tau/models/extension.model.base"],function(e,t){var i=t.extend({"bus entityIdsRetrieved":function(e){for(var t=e.data,i=t.length,n=0;i>n;n++){var a={id:t[n].id,fields:["id","name",{entityState:["name"]}]};this.fire("extendGetEntityQuery",a),this.fire("get",{type:this.config.typeName,query:a})}this.fire("commitTransaction",{scope:this,success:this.onEntitiesRetrieved})},convertServerDataModelData:function(e){e=e;var t=this.config.context.configurator.getUrlBuilder();return{__type:e.__type,id:e.id,name:e.name,state:{name:e.entityState.name},url:t.getNewViewUrl(e.id,e.__type,!0)}},onEntitiesRetrieved:function(t){var i={entities:e.pluck(t,"data")};this.fire("filterEntities",i),t=i.entities;var n=e.map(t,this.convertServerDataModelData,this);n=e.compact(n),this.fire("entitiesRetrieved",n)}});return i}),define("tau/models/model.list.baseInfo",["tau/core/model-base","tau/models/baseInfoList/extension.model.entityIdRetriever","tau/models/baseInfoList/extension.model.additionalInfoEntityRetriever"],function(e,t,i){var n=e.extend({init:function(e){this._super.apply(this,arguments),this.propertyName=e.propertyName,this.typeName=e.typeName,new t(e),new i(e)
},onInit:function(){this.config.disableModel||(this.fire("registerStoreRequest",{entity:this.config.context.entity}),this.fire("commitTransaction",{entity:this.config.context.entity}))},"bus entitiesRetrieved":function(e){var t={items:e.data};this.bus.fire("dataBind",t)},"bus evictProperty":function(){var e=this.config.context.entity;this.store.evictProperties(e.id,e.entityType.name,[this.propertyName])}});return n}),define("tau/ui/templates/common/ui.template.entityLink.icon",["tau/core/templates-factory"],function(e){var t={name:"entity-link-icon",markup:['<a href="${url}" class="tau-linkentity tau-linkentity_type_icon">','<em class="tau-entity-icon tau-entity-icon--${__type.toLowerCase()} ui-link-entity__icon">${id}</em>',"</a>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/common/ui.template.entityLink.text",["tau/core/templates-factory"],function(e){var t={name:"entity-link-text",markup:['<a href="${url}" class="tau-linkentity tau-linkentity_type_text">','<span class="tau-linkentity__inner">',"{{if text}}","${text}","{{else}}","${name}","{{/if}}","</span>","</a>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/list/ui.template.list.baseInfo.item",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.icon","tau/ui/templates/common/ui.template.entityLink.text"],function(e){var t={name:"list-base-info-item",markup:['<tr class="{{if $item.index %2 != 0}}alternative-row{{/if}}">','<td class="entity-type tau-list__table__cell-id">{{tmpl($data) "entity-link-icon"}}</td>','<td class="name">{{tmpl($data) "entity-link-text"}}</td>','<td class="state">${state.name}</td>',"</tr>"].join(""),dependencies:["entity-link-icon","entity-link-text"]};return e.register(t)}),define("tau/ui/templates/list/ui.template.list.baseInfo",["tau/core/templates-factory","tau/ui/templates/list/ui.template.list.baseInfo.item"],function(e){var t={name:"request-list",options:{contentSelector:".request-list"},markup:['<div class="ui-base-info-list-content">','<table class="ui-table base-info-list" cellpadding="4" cellspacing="0" {{if items.length === 0}}style="display:none"{{/if}}>',"<tbody>","{{each items}}",'    {{tmpl($value, {index:$index}) "list-base-info-item"}}',"{{/each}}","</tbody>","</table>","</div>"].join(""),dependencies:["list-base-info-item"]};
return e.register(t)}),define("tau/components/component.list.baseInfo",["Underscore","tau/components/component.list.creator","tau/models/model.list.baseInfo","tau/models/assignmentsList/extension.model.store.operations","tau/ui/templates/list/ui.template.list.baseInfo","tau/core/termProcessor"],function(e,t,i,n,a,r){return{create:function(s,o){var l=new r(s.context.getTerms());return o=o||{},o.extensions=e.compact(e.union(o.extensions,[n])),e.extend(o,{message:"No "+l.getTerms(s.typeName).names.toLowerCase()+" found",ModelType:s.ModelType||i,template:a}),t.create(o,s)}}}),define("tau/components/component.duplicateBugList",["Underscore","tau/components/component.list.baseInfo","tau/models/model.duplicateBugList","tau/models/model.duplicateBugRetriever"],function(e,t,i,n){return{create:function(e){return e.ModelType=i,e.typeName="bug",t.create(e,{extensions:[n]})}}}),define("tau/ui/extensions/ui.extensions.onMarkAsDuplicate",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus beforeInit":function(e){this.config=e.data.config,this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},onBugWasMarkedAsDuplicate:function(e){var t=this.config?this.config.context.entity.id:null;(t==e.data.duplicateBugId||t==e.data.bugId)&&(this.fire("evict"),this.fire("refresh"))}})}),define("tau/components/component.duplicateBugListPanel",["Underscore","tau/components/component.collapsible","tau/components/extensions/duplicateBugList/extension.duplicateBugList.visibilityController","tau/models/model.duplicateBugCountCalculator","tau/models/model.duplicateBugRetriever","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/core/termProcessor"],function(e,t,i,n,a,r,s,o,l){return{create:function(i){var n=new l(i.context.getTerms());
return i=i||{},e.extend(i,{collapsed:!0,header:[{type:"label",text:n.getTerms("Bug").name+" Duplicates",quantityCssClass:i.quantityCssClass||"ui-gray-quantity"}],items:[{type:"duplicateBugList"}],extensions:[a,s,o]}),t.create(i)}}}),define("libs/amanda/amanda",[],function(){return function(){var e=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t=function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=function(i){if(t(i)||"string"==typeof i)return 0===i.length;if(e(i))for(var n in i)if(i.hasOwnProperty(n))return!1;return!0},n=function(e,t){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e},a=function(n,a,r){var s=function(n,a){if(t(n)&&!i(n))for(var r=0,s=n.length;s>r;r++)a.apply(n,[r,n[r]]);if(e(n)&&!i(n))for(var o in n)n.hasOwnProperty(o)&&a.apply(n,[o,n[o]])},o=function(n,a,r){var s=[],o=function(e,t){var i=s.length+1;s.push(function(){var n=function(e){var t=s[i];return!e&&t?t():e||t?r(e):r()};return a(e,t,n)})};if(t(n)&&!i(n))for(var l=0,u=n.length;u>l;l++)o(l,n[l]);else{if(!e(n)||i(n))return r();for(var c in n)n.hasOwnProperty(c)&&o(c,n[c])}return s[0]()};return"undefined"==typeof r?s.apply(this,arguments):o.apply(this,arguments)},r=function(e,t){for(var i=[],n=0,a=e.length;a>n;n++){var r=e[n][t];-1===i.indexOf(r)&&i.push(r)}return i},s=function(){this.length=0};s.prototype.addError=function(e){this[this.length]=e,this.length++},a({getProperties:"property",getMessages:"message"},function(e,t){s.prototype[e]=function(){return r(this,t)}});var o={required:"The {{property}} property is required.",minLength:"The {{property}} property must be at least {{validator}} characters.",maxLength:"The {{property}} property must not exceed {{validator}} characters.",length:"The {{property}} property must be exactly {{validator}} characters.",format:"The {{property}} property must be a/an {{validator}}.",type:"The {{property}} property must be a/an {{validator}}.",except:"The {{property}} property must not be {{propertyValue}}",minimum:"The minimum value of the {{property}} must be {{validator}}",maximum:"The maximum value of the {{property}} must be {{validator}}",pattern:"The `{{property}}` does not match the {{validator}} pattern.",maxItems:"The `{{property}}` property must not contain more than {{validator}} items.",minItems:"The `{{property}}` property must contain at least {{validator}} items.",divisibleBy:"The {{property}} property is not divisible by {{validator}}.",uniqueItems:"All items in the {{property}} property must be unique.","enum":function(e,t,i){return"Value of the "+e+" must be "+i.join(" or ")+"."
}},l=function(e){this.singleError=e.hasOwnProperty("singleError")?e.singleError:!0,this.validators=u,this.messages=e.messages?n(e.messages,o):o,this.Errors=new s};l.prototype.renderErrorMessage=function(e,t){var i=this.messages[e];return"function"==typeof i?i(t.property,t.propertyValue,t.validator):"string"==typeof i?(a(t,function(e,t){i=i.replace(new RegExp("{{"+e+"}}","g"),t)}),i.replace(/\s+/g," ")):""},l.prototype.validateProperty=function(e,t,i,n){var r=this,s=function(n,a,s){var o=function(a){if(!a)return s();var o=r.renderErrorMessage(n,{property:e,propertyValue:t,validator:i[n]});return r.Errors.addError({property:e,propertyValue:t,validator:n,validatorValue:i[n],message:o}),s(r.singleError?!0:null)};return i[n]?a(e,t,i[n],i,o):s()};return i.required!==!0&&"undefined"==typeof t?n():a(r.validators,s,n)},l.prototype.validate=function(e,t,i){var n=this;return this.Errors=new s,this.validateSchema(e,t,"",function(){return i(n.Errors.length>0?n.Errors:void 0)})},l.prototype.validateProperties=function(e,t,i,n){var r=this;return a(t.properties,function(n,a,s){var o="object"===a.type&&a.properties,l="array"===a.type,u=r.getProperty(e,n),c=-1!==n.indexOf(" ")?"['"+n+"']":"."+n,d=0===i.length?n:i+c;return o||l?r.validateSchema(u,t.properties[n],d,s):r.validateProperty(d,u,a,s)},n)},l.prototype.validateItems=function(e,t,n,r){var s=this;return e&&!i(e)?-1!==["object","array"].indexOf(t.items.type)?a(e,function(e,i,a){var r=n+"["+e+"]";return s.validateSchema(i,t.items,r,a)},r):a(e,function(e,i,a){var r=n+"["+e+"]";return s.validateProperty(r,i,t.items,a)},r):r()},l.prototype.validateSchema=function(e,t,i,n){var a=this;return-1!==["object","array"].indexOf(t.type)?a.validateProperty(i,e,t,function(){return t.properties?a.validateProperties(e,t,i,n):t.items?a.validateItems(e,t,i,n):n()}):a.validateProperty(i,e,t,n)},l.prototype.getProperty=function(e,t){return e?e[t]:void 0};var u={required:function(e,t,i,n,a){return i&&void 0===t?a(!0):a()},type:function(){for(var e={object:function(e){return"[object Object]"===Object.prototype.toString.call(e)
},array:function(e){return"[object Array]"===Object.prototype.toString.call(e)},integer:function(e){return"number"==typeof e&&e%1===0}},t=["string","number","function","boolean"],i=0,n=t.length;n>i;i++)e[t[i]]=function(e){return function(){return typeof arguments[0]===e}}(t[i]);return function(t,i,n,a,r){if("[object Array]"===Object.prototype.toString.call(n)){var s=n.some(function(t){return e[t](i)});return s?r():r(!0)}return e[n](i)?r():r(!0)}}(),format:function(){var e={alpha:function(e){return"string"==typeof e&&e.match(/^[a-zA-Z]+$/)},alphanumeric:function(e){return"string"==typeof e&&/^[a-zA-Z0-9]+$/.test(e)||"number"==typeof e},ipv4:function(e){return"string"==typeof e&&e.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)},ipv6:function(e){return"string"==typeof e&&e.match(/(?:(?:[a-f\d]{1,4}:)*(?:[a-f\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:(?:[a-f\d]{1,4}:)*[a-f\d]{1,4})?::(?:(?:[a-f\d]{1,4}:)*(?:[a-f\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?)/)},ip:function(t){return e.ipv4(t)||e.ipv6},email:function(e){return"string"==typeof e&&e.match(/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/)},url:function(e){return"string"==typeof e&&e.match(/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|cat|coop|int|pro|tel|xxx|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2})?)|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/)
},date:function(e){return"[object Date]"===Object.prototype.toString.call(e)},decimal:function(e){return/^[0-9]+(\.[0-9]{1,2})?$/.test(e)},"int":function(e){return/^-?[0-9]+$/.test(e)},percentage:function(e){return"string"==typeof e&&e.match(/^-?[0-9]{0,2}(\.[0-9]{1,2})?$|^-?(100)(\.[0]{1,2})?$/)||e>=-100&&100>=e},port:function(e){return/\:\d+/.test(e)},regexp:function(e){return e&&e.test&&e.exec},unsignedInt:function(e){return/^[0-9]+$/.test(e)}};return function(t,i,n,a,r){return e[n](i)?r():r(!0)}}(),minLength:function(e,t,i,n,a){return"string"==typeof t&&t.length>=i?a():a(!0)},maxLength:function(e,t,i,n,a){return"string"==typeof t&&t.length<=i?a():a(!0)},length:function(e,t,i,n,a){return"string"==typeof t&&t.length===i?a():a(!0)},"enum":function(e,t,i,n,a){return-1===i.indexOf(t)?a(!0):a()},except:function(e,t,i,n,a){return-1!==i.indexOf(t)?a(!0):a()},minimum:function(e,t,i,n,a){if("number"==typeof t){var r=n.exclusiveMinimum?t>i:t>=i;return r?a():a(!0)}return a(!0)},maximum:function(e,t,i,n,a){if("number"==typeof t){var r=n.exclusiveMaximum?i>t:i>=t;return r?a():a(!0)}return a(!0)},pattern:function(e,t,i,n,a){return"string"!=typeof t||t.match(i)?a():a(!0)},minItems:function(e,i,n,a,r){return t(i)&&i.length>=n?r():r(!0)},maxItems:function(e,i,n,a,r){return t(i)&&i.length<=n?r():r(!0)},uniqueItems:function(e,t,i,n,r){return a(t,function(e,i,n){return t.indexOf(i)<e?n(!0):n()},r)},divisibleBy:function(e,t,i,n,a){var r="number"==typeof t,s=t%i===0;return r&&s?a():a(!0)}};return l}()}),define("tau/models/editor.requester/model.editor.requester",["Underscore","tau/core/model-base","libs/amanda/amanda"],function(e,t,i){var n=t.extend({"bus afterInit":function(){this.fire("dataBind",{}),this.validation=new i({singleError:!1});var t=this.config.store,n=function(e,i,n,a,r){return n&&i?void t.find("requester",{$query:{email:i,deleteDate:null}}).done({success:function(e){1==e[0].data.length?r("uniqueEmail"):r()}}):r()};this.validation.validators.uniqueEmail=n,e.extend(this.validation.messages,{required:function(e){var t={firstName:"First Name",lastName:"Last Name",email:"email"};
return"Please enter "+t[e]},uniqueEmail:"Requester with the same email already exists",format:"Please enter valid {{validator}}"})},"bus form.parametersBound":function(e){var t=e.data,i=(this.config.store,{type:"object",properties:{firstName:{required:!0,type:"string"},lastName:{required:!0,type:"string"},email:{required:!0,type:"string",format:"email",uniqueEmail:!0}}}),n=this;this.validation.validate(t.parameters,i,function(e){e?n.fire("form.validationFailed",{errors:e}):n.fire("form.validationPassed",{data:t.parameters})})},"bus form.validationPassed":function(e){var t=e.data.data,i=this.config.store,n=this.config.context.entity;i.save("Requester",{$set:{email:t.email,login:t.email,firstName:t.firstName,lastName:t.lastName},fields:["id"]}).done({success:function(e){var t=e[0].data;i.save(n.entityType.name,{id:n.id,$set:{requesters:[{id:t.id}]},fields:["id"]}).done({success:function(){}})}})}});return n}),define("tau/ui/extensions/editor.requester/ui.extension.editor.requester.form",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(i){var n=i.data.element;this.$element=n;var a=n.find("[role=form]"),r=a.find(":input"),s=a.find(":button");s.eq(0).prop("disabled","disabled"),s.eq(0).addClass("disable");var o=this;s.eq(0).click(function(){var i={};r.each(function(){var n=t(this),a=e.trim(n.val());""!=a&&(i[n.attr("name")]=a)}),i.action="search",o.bus.fire("form.parametersBound",{parameters:i})}),r.bind("keyup",function(){r.filter(function(){return t(this).val().length>0}).length==r.length?(s.eq(0).prop("disabled",!1),s.eq(0).removeClass("disable")):(s.eq(0).prop("disabled","disabled"),s.eq(0).addClass("disable"))})},"bus form.validationFailed":function(t){this.$element.find(".ui-validationerror").removeClass("ui-validationerror");var i=e.uniq(t.data.errors,!1,function(e){return e.property}),n=this.$element.find(":input");e.forEach(i,function(e){n.filter("[name="+e.property+"]").toggleClass("ui-validationerror",!0).attr("title",e.message)
})},"bus form.validationPassed":function(){this.$element.find(".ui-validationerror").removeClass("ui-validationerror")}})}),define("tau/ui/templates/editor.requester/ui.template.editor.requester",["tau/core/templates-factory"],function(e){var t={name:"editor-requester",markup:["<div>",'<div class="ui-form" role="form">','<div class="ui-form__row">','<label for="url">First Name</label><input type="text" data-autofocus class="user-search-box" name="firstName" />',"</div>",'<div class="ui-form__row">','<label for="label">Last Name</label><input type="text" class="user-search-box" name="lastName" />',"</div>",'<div class="ui-form__row">','<label for="label">Email</label><input type="text" class="user-search-box" name="email" />',"</div>",'<div class="ui-form__row ui-form__row-controls button-group">','<input type="button" name="action" value="Add requester" class="button" />','<input type="button" name="cancel" value="Cancel" role="action-cancel" class="button" />',"</div>","</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.editor.requester",["tau/components/component.creator","tau/models/editor.requester/model.editor.requester","tau/ui/extensions/editor.requester/ui.extension.editor.requester.form","tau/ui/templates/editor.requester/ui.template.editor.requester"],function(e,t,i,n){return{create:function(a){var r={name:"finder",extensions:[t,i],template:n};return e.create(r,a)}}}),define("tau/models/editor.team-member/model.editor.team-member",["Underscore","tau/core/model-base","libs/amanda/amanda"],function(e,t,i){var n=t.extend({"bus afterInit":function(){this.fire("dataBind",{}),this.validation=new i({singleError:!1});var t=this.config.store,n=function(e,i,n,a,r){return n&&i?void t.find("user",{$query:{email:i,deleteDate:null}}).done({success:function(e){1==e[0].data.length?r("uniqueEmail"):r()}}):r()};this.validation.validators.uniqueEmail=n,e.extend(this.validation.messages,{required:function(e){var t={firstName:"First Name",lastName:"Last Name",email:"email"};
return"Please enter "+t[e]},uniqueEmail:"User with the same email already exists",format:"Please enter valid {{validator}}"})},"bus form.parametersBound":function(e){var t=e.data,i=(this.config.store,{type:"object",properties:{firstName:{required:!0,type:"string"},lastName:{required:!0,type:"string"},email:{required:!0,type:"string",format:"email",uniqueEmail:!0}}}),n=this;this.validation.validate(t.parameters,i,function(e){e?n.fire("form.validationFailed",{errors:e}):n.fire("form.validationPassed",{data:t.parameters})})},"bus form.validationPassed":function(e){var t=e.data.data,i=this.config.store,n=this.config.context.entity;i.save("user",{$set:{email:t.email,login:t.email,firstName:t.firstName,lastName:t.lastName},fields:["id"]}).done({success:function(e){var t=e[0].data;i.save(n.entityType.name,{id:n.id,$set:{teamMembers:[{user:{id:t.id}}]},fields:["id"]}).done({success:function(){}})}})}});return n}),define("tau/components/component.editor.team-member",["tau/components/component.creator","tau/models/editor.team-member/model.editor.team-member","tau/ui/extensions/editor.requester/ui.extension.editor.requester.form","tau/ui/templates/editor.requester/ui.template.editor.requester"],function(e,t,i,n){return{create:function(a){var r={name:"finder",extensions:[t,i],template:n};return e.create(r,a)}}}),define("tau/ui/extensions/effort/ui.extension.effort",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(e,t,i,n){return this.model=n,this.configurator=t,this.entity=i,this._super(e)},"bus beforeInit":function(){t.when(this.model.load()).then(e.bind(function(e){this.fire("dataBind",{groups:e.groups,effort:e.effort,points:e.points})},this))},"bus afterRender":function(i,n){var a=n.element;a.on("keydown","input",function(e){var t=e.charCode||e.keyCode||0;return 8==t||9==t||13==t||27==t||46==t||110==t||190==t||t>=35&&40>=t||t>=48&&57>=t||t>=96&&105>=t}),a.on("focusin focusout","input",e.bind(function(e){var i=t(e.currentTarget).parents(".tau-effort__group");
i.toggleClass("tau-effort__group_state_edit","focusin"===e.type)},this)),a.on("focusout",e.bind(function(e){e.relatedTarget&&!t(e.relatedTarget).is("input")&&this.fire("effort.editor.finished")},this)),a.on("change","input",e.bind(function(e){var i=t(e.currentTarget).parents(".tau-effort");this._saveRoleEfforts(i),this._updateTotalEffort(i)},this)),a.on("click",".i-role-edittrigger",e.bind(function(e){var i=t(e.currentTarget);i.parent().find(":text").focus(1)},this)),a.on("click","form",e.bind(function(e){e.stopPropagation()},this)),a.on("submit","form",e.bind(function(e){var i=t(e.currentTarget).find("input");i.blur(),this.fire("effort.editor.finished"),e.preventDefault()},this)),a.on("close.event",e.bind(function(){this.fire("effort.editor.finished")},this)),this._updateTotalEffort(a),a.find(":text").first().focus(1)},_updateTotalEffort:function(e){var t=this._getTotalEffort(e);e.find(".tau-effort__total span").text(t)},_saveRoleEfforts:function(e){var i=this._getRoleEfforts(e);this.fire("effort.editor.saving"),t.when(this.model.saveEfforts(i)).done(this.fire.bind(this,"effort.editor.saved")).fail(this.fire.bind(this,"effort.editor.saveFailed"))},_getRoleEfforts:function(i){return e.map(i.find(":text"),function(e){var i=t(e);return{id:i.attr("data-role-effort-id"),role:{id:i.attr("data-role-id")},effort:i.val()||0}},this)},_getTotalEffort:function(t){var i=this._getRoleEfforts(t);return e.reduce(i,function(e,t){return e+parseFloat(t.effort)},0)}})}),define("tau/ui/extensions/effort/model",["Underscore","jQuery","tau/core/class","tau/core/event","tau/utils/utils.translation","tau/models/dataprocessor/model.processor.context"],function(e,t,i,n,a,r){return n.extend(i.extend({init:function(e,t,i){this.store=e,this.contextService=t,this.groups=[],this.entity=i},load:function(){return t.when(this.loadPoints()).then(this.loadEfforts.bind(this))},loadPoints:function(){return t.when(this.contextService.findByEntity(this.entity)).then(function(e){this.points=this._getEffortPoints(e)
}.bind(this))},loadEfforts:function(){var e=t.Deferred();return this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:["effort","effortCompleted","effortToDo",{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]}]}).done(function(t){this.effort=t[0].data.effort,this.roleEfforts=t[0].data.roleEfforts,this.groups=this.processEfforts(this.roleEfforts),e.resolve(this)}.bind(this)),e},createGroupFromRole:function(e){return{id:e.id,name:a.shorten(e.name),role:e,users:[]}},processEfforts:function(t){return e.forEach(t,function(t){if(t.role.hasEffort){var i=e.find(this.groups,function(e){return e.role.id==t.role.id});if(!i){var n=this.createGroupFromRole(t.role);this.groups.push(n),i=n}i.effort=t.effort,i.roleEffortId=t.id}},this),this.groups},saveEfforts:function(e){return this.store.saveDef(this.entity.entityType.name,{$set:{id:this.entity.id,roleEfforts:e}})},_getEffortPoints:function(e){var t={entity:this.entity,applicationContext:e},i=r(t);return i.getEffortPoint()}}))}),define("tau/ui/templates/effort/ui.template.effort",["tau/core/templates-factory"],function(e){return e.register({name:"effort",engine:"jqote2",markup:['<div class="tau-effort">',"<% _.each(this.groups, function(group) { %>",'<div class="i-role-group tau-effort__group" data-id="<%= group.id %>">','<span class="tau-effort__grouptitle i-role-edittrigger"><%! group.name %></span>','<form><input type="text" data-role-effort-id="<%= group.roleEffortId %>" data-role-id="<%= group.id %>" value="<%= group.effort %>"></form>',"</div>","<% }); %>",'<div class="tau-effort__divider"></div>','<div class="tau-effort__total">',"<span><%= this.effort %></span>","<label><%= this.points.shortName %></label>","</div>","</div>"]})}),define("tau/components/component.effort",["tau/components/component.creator","tau/ui/extensions/effort/ui.extension.effort","tau/ui/extensions/effort/model","tau/ui/templates/effort/ui.template.effort"],function(e,t,i,n){return{create:function(a){var r=a.context.configurator,s=a.context.entity,o={extensions:[{extType:t,args:[r,s,new i(r.getStore(),r.getApplicationContextService(),s)]}],template:n};
return e.create(o,a)}}}),define("tau/ui/extensions/ui.extension.entity.delete",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({init:function(e,t,i){return this.configurator=t,this.entity=i,this._super(e)},"bus beforeInit":function(){this.fire("dataBind",{})},"bus afterRender":function(t,i){var n=i.element;n.tauConfirm({showArrow:!1,showEvent:null,content:"<h3>Are you sure?</h3>",className:"context-menu-do-not-hide",callbacks:{success:this._deleteEntity.bind(this,this.entity),cancel:this._fireDestroy.bind(this)}}),e.delay(e.bind(n.tauConfirm,n),100,"show")},_deleteEntity:function(e){this.configurator.getStore().remove(e.type,{id:e.id}).done({success:this._fireDestroy.bind(this)})},_fireDestroy:function(){this.fire("destroy")}})}),define("tau/ui/templates/ui.template.empty",["tau/core/templates-factory"],function(e){var t={name:"empty",engine:"jqote2",markup:["<div></div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.entity.delete",["tau/components/component.creator","tau/ui/extensions/ui.extension.entity.delete","tau/ui/templates/ui.template.empty"],function(e,t,i){return{create:function(n){var a=n.context.configurator,r=n.context.entity,s={extensions:[{extType:t,args:[a,r]}],template:i};return e.create(s,n)}}}),define("tau/ui/extensions/entity.menuTrigger/ui.extension.entity.menuTrigger",["jQuery","Underscore","tau/core/extension.base","tau/configurations/converters/converter.context","tau/configurations/factory.container.config"],function(e,t,i,n,a){return i.extend({"bus beforeInit":function(e,i){var r=i.config.options||{};r=t.defaults(r,{external:!1,type:"menu.actions",items:[]}),r.external&&(r.items=a.getEntityConfigObject(i.config).getActions(),r.items=t.filter(r.items,function(e){return!t.contains(e.editions,"~innerList")}));var s=i.config.context;r.items=n.convert(r.items,t.pluck(s.getPractices(),"name"),s.getEdition()),this.fire("options.ready",r),this.fire("dataBind",{isEmpty:!r.items.length})},"bus beforeInit + options.ready + afterRender":function(e,t,i,n){var a=t.config.context.configurator,r=n.element.find(".i-role-trigger");
if(r.length){var s,o;i.external||(s=['<div class="tau-bubble">','<div class="tau-bubble__inner" role="content" style="margin:0"></div>',"</div>"].join(""),o=function(e){e.my="right top+2",e.at="right bottom"});var l={target:r,appendMethod:"appendTo",cleanupOnHide:!1,stackName:"quickAddGeneral",showOnCreation:!1,zIndex:1e4,className:"ui-menu-actions__bubble",hideOnScroll:!1,onShow:function(){a.getKeyBoardManager().pushHandler({})},onHide:function(){a.getKeyBoardManager().popHandler()},template:s,onPositionConfig:o,dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:{components:[{name:"entity menu",type:i.type,options:i,items:i.items}]}};this.fire("initBubble",l)}},"bus afterRender:last + destroy":function(e,t){var i=t.element;i.length&&i.data("ui-tauBubble")&&i.tauBubble("hide")}})}),define("tau/ui/templates/entity.menuTrigger/ui.template.entity.menuTrigger",["tau/core/templates-factory"],function(e){var t={name:"entity.menuTrigger",engine:"jqote2",markup:["<% if (!this.isEmpty){ %>",'<div class="ui-menu-actions">','<span class="ui-menu__trigger i-role-trigger">',"Actions",'<span class="ui-menu__indicator"></span>',"</span>","</div>","<% } %>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/entity.menuTrigger/ui.template.entity.menuTrigger.short",["tau/core/templates-factory"],function(e){var t={name:"entity.menuTrigger.short",engine:"jqote2",markup:["<% if (!this.isEmpty){ %>",'<div class="tau-entity-actions">','<span class="tau-entity-actions-target i-role-trigger"></span>',"</div>","<% } %>"],dependencies:[]};return e.register(t)}),define("tau/components/component.entity.menuTrigger",["Underscore","tau/components/component.creator","tau/ui/extensions/entity.menuTrigger/ui.extension.entity.menuTrigger","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/entity.menuTrigger/ui.template.entity.menuTrigger","tau/ui/templates/entity.menuTrigger/ui.template.entity.menuTrigger.short"],function(e,t,i,n,a,r,s){return{create:function(e){var o={extensions:[i,n,a],template:e.allData&&e.allData.options.external?s:r};
return t.create(o,e)}}}),define("tau/slice/api.entity.new.list",["jQuery","Underscore","tau/slice/api.new.list"],function(e,t,i){return i.extend({treeViewByLevel:function(e){return this.currentOrderingConfig=e.$set.orderingConfig,this.resolveDeferred("sort",e)},_prepareCommand:function(t){return t.config=e.extend(!0,t.config,{$set:{entityId:this._newListSliceOptions.entityId,orderingConfig:this.currentOrderingConfig}}),t},getCometParameters:function(e){var i=this._super();return t.extend(i,{entityId:this._newListSliceOptions.entityId,expansionState:e||[]}),i}})}),define("tau/slice/entity.new.list.factory",["tau/slice/new.list.factory","tau/slice/api.entity.new.list"],function(e,t){var i=e.extend({_createSlice:function(e,i){return new t(e,i,this._newListSliceOptions)}});return i}),define("tau/components/entity.new.list/extension.entity.new.list",["Underscore","jQuery","tau/components/board.new.list/extension.base.new.list","tau/slice/entity.new.list.factory","tau/components/board.new.list/new.list.quickAdd.component.builder"],function(e,t,i,n,a){return i.extend({_defaultOnPage:20,_quickAddOptions:{positionConfig:{collision:"fit flip"}},init:function(e,t,i,n){var r=new a(e.bus,e.context.configurator,n,this._quickAddOptions);this._super(e,t,i,n,r),n.expansionStateChanged.add(this.fire.bind(this,"expansion.state.changed"))},"bus start.lifecycle":function(){this._skeletonView.treeViewCreated.add(function(e){this.fire("newListTreeView.ready",{skeletonView:this._skeletonView,treeView:e})}.bind(this))},"bus afterInit + start.lifecycle":function(e,t){this._initViewNewListSettings(t.config),this._initSliceFactory(t.config)},"bus afterRender":function(){this.fire("view.dom.ready",{})},_initViewNewListSettings:function(e){var t=this._createViewNewListSettings(e);this.fire("boardSettings.ready",{boardSettings:t})},_initSliceFactory:function(e){var t={prefix:"EntityTreeView",entityId:e.context.entity.id},i=new n(this._configurator.getSliceFactoryOptions(),t);this.fire("sliceFactory.ready",i)
},_createViewNewListSettings:function(t){var i=t.context.entity,n=i.entityType.name.toLowerCase(),a=[n,i.id.toString(),t.name.toLowerCase()].join(""),r=e.extend(t.definition,{id:a,viewMode:"newlist",x:{types:[n]},cellPaging:{onPage:this._defaultOnPage}});return this._configurator.getBoardSettingsFactory().createStaticSettings(r)},_getAppStateStore:function(){return this._configurator.getBoardSettingsFactory().createStaticSettings({acid:null})}})}),define("tau/components/entity.new.list/const.entity.new.list.selectors",{APP_PAGE_ENTITY:".tau-app.tau-page-entity",POPUP_PAGE_ENTITY:".ui-popup.tau-page-entity",POPUP_CLOSE_BUTTON:".close",POPUP_SYSTEM_VIEW:".tau-system-message",CARD_DETAILS_TRIGGER:".i-role-details-trigger",CARD_DETAILS_TRIGGER_ICON:".i-role-details-trigger.tau-icon",LIST_ENTITY_DETAILS:".tau-list-entity-details",PAGE_ENTITY:".tau-page-entity",CK_EDITOR:".cke",CK_EDITOR_DIALOG:".cke_dialog_body",CK_EDITOR_BKG_COVER:".cke_dialog_background_cover"}),define("tau/ui/templates/entity.new.list/template.entity.new.list.card.viewer",["tau/core/templates-factory"],function(e){var t={name:"template.entity.new.list.card.viewer",engine:"jqote2",markup:['<div class="tau-list-entity-details i-role-bubble-holder">','<div class="tau-page-entity"></div>',"</div>"]};return e.register(t)}),define("tau/components/entity.new.list/entity.new.list.card.viewer",["require","Underscore","jQuery","tau/core/class","tau/components/entity.new.list/const.entity.new.list.selectors","tau/ui/templates/entity.new.list/template.entity.new.list.card.viewer"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class"),a=e("tau/components/entity.new.list/const.entity.new.list.selectors"),r=e("tau/ui/templates/entity.new.list/template.entity.new.list.card.viewer");return n.extend({CURRENT_NULL:{$trigger:i(),$card:i(),cardData:{},component:{destroy:i.noop}},classMap:{ICON_DETAILS_CLOSE:"tau-icon_name_newwindow-close",CARD_DETAILS_TRIGGER:"i-role-details-trigger",EDITABLE_CELL:"tau-elems-cell_unit-editable"},WIDGET_DATA_ID:"ui-tauCoverView",init:function(e,i){this._componentFactory=e,this._keyBoardManager=i,this._current=this.CURRENT_NULL,this.opened=t.Callbacks(),this.closed=t.Callbacks()
},isShown:function(e){return this._current.cardData.id===e.id&&e.entityType===e.entityType},show:function(e){var t=this._$getWidget(e.$list),i=this._createComponent(e.cardData,t);e.scrollToCard&&this._scrollToCard(e.$list,e.$card,t),this._setCurrent(e,i),t.show(this._current.$trigger)},hide:function(){this._$widget&&this._$widget.hide()},destroy:function(){this._$widget&&(this._$widget.widget().remove(),this._$widget.destroy(),this._$widget=null),this.opened.removeAll(),this.closed.removeAll()},_scrollToCard:function(e,t){e.scrollParent().scrollTo(t,500,{offset:{top:-Math.round(i(window).height()/2-t.height())}})},_$getWidget:function(e){if(!this._$widget){var t=e.closest(a.APP_PAGE_ENTITY);this._$widget=this._$createWidget(t)}return this._$widget},_$createWidget:function(e){var t=r.render();return t.tauCoverView({contentHolderSelector:a.PAGE_ENTITY,arrow:{$appendTo:e,positionConfig:{my:"left center",at:"right-12 center"}},autoHide:{onEscape:!0,onOutsideAction:!0,doNotHideSelectors:[a.CARD_DETAILS_TRIGGER,a.POPUP_SYSTEM_VIEW,a.CK_EDITOR,a.CK_EDITOR_DIALOG,a.CK_EDITOR_BKG_COVER]},show:this.opened.fire.bind(this.opened),hide:this._onWidgetHide.bind(this),keyBoardManager:this._keyBoardManager}),t.insertAfter(e),t.data(this.WIDGET_DATA_ID)},_onWidgetHide:function(){this.closed.fire(),this._releaseCurrent()},_createComponent:function(e,t){var i=this._componentFactory.create(e);return i.on("afterRender",function(e,i){t.setContent(i.element)},this),i},_setCurrent:function(e,t){this._releaseCurrent();var i=e.$card.find(a.CARD_DETAILS_TRIGGER_ICON);this._current={cardData:e.cardData,$card:e.$card,$trigger:i,component:t},this._current.originalTriggerTitle=this._current.$trigger.attr("title"),this._current.$trigger.attr("title","Click to close"),this._current.$card.addClass(this.classMap.ICON_DETAILS_CLOSE)},_releaseCurrent:function(){this._current.$trigger.attr("title",this._current.originalTriggerTitle),this._current.$card.removeClass(this.classMap.ICON_DETAILS_CLOSE),this._current.component.destroy(),this._current=this.CURRENT_NULL
}})}),define("tau/ui/extensions/page/ui.extension.page.configConvertor",["Underscore","tau/core/extension.base","tau/configurations/converters/converter.context"],function(e,t,i){return t.extend({"bus before_onConfigContainerCreated":function(t){var n=[],a=[];if(t.data.context){var r=t.data.context;e.each(r.getPractices(),function(e){n.push(e.name)}),a=r.getEdition()}var s=t.data;s=i.convert(s,n,a)}})}),define("tau/ui/extensions/page/ui.extension.page.storeError",["Underscore","tau/core/extension.base","tau/utils/utils.serverErrorTranslator"],function(e,t,i){return t.extend({"bus beforeInit":function(t,i){var n=i.config.context,a=n.entity,r=n.configurator.getStore();r.unbind(this),r.on({eventName:"failure",listener:this},e.bind(function(e){e.data.cmd.config.failureGlobal!==!1&&(a&&r.evictPersistedObject(a.id,a.type),this.onFailure(e))},this))},"bus beforeInit + destroy":function(e,t){var i=t.config.context.configurator.getStore();i.unbind(this)},onFailure:function(t){var n={};if(t.data&&t.data.data)if(t.data.data.Message)n=i.translateServerError.call(this,t.data.data);else{var a=t.data.data.response;if(a)if(e.isArray(a)){var r=[a[1]];e.isArray(a[4])&&a[4].length>0&&a[4][0]!=r[0]&&r.push(a[4][0]),n={message:r.join(":&nbsp;")}}else a.Message&&(n=i.translateServerError.call(this,a))}var s=0;t.data&&t.data.data&&(s=t.data.data.status||0),this.fire("error",n),(s>=400||0===s)&&this.fire("globalFailure"),t.data&&t.data.cmd&&0===s&&this.fire("destroy")}})}),define("tau/ui/extensions/ui.extension.loading",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({init:function(e){this._super(e)},"bus beforeInit":function(){var e=t(this.config.progressTargetSelector||"body");e.tauProgressIndicator(),this.fire("$progressIndicator.ready",e),this.fire("showLoading","reaction on beforeInit")},"bus $progressIndicator.ready:last + showLoading":function(e,t){t.tauProgressIndicator("show")},"bus $progressIndicator.ready:last + hideLoading":function(e,t){t.tauProgressIndicator("hide")
},"bus beforeInit+afterRender+showLoading":function(){this.fire("hideLoading","hide on after render")},"bus globalFailure":function(){this.fire("hideLoading","hide on global failure")},"bus afterRender+globalFailure":function(e){var t=e.afterRender.data.element;t.show()},"bus $progressIndicator.ready:last + destroy":function(e,t){(!this.config.progressTargetSelector||t.data("ui-tauProgressIndicator"))&&t.tauProgressIndicator("hide")}})}),define("tau/ui/extensions/board.tooltip/ui.extension.board.tooltipArticle",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){t.widget("ui.tauBubbleArticle",t.ui.tauBubble,{});var n="http://guide.targetprocess.com/teams-and-projects.html#visibility",a=e.map([{id:"project.formAdd.selectProcess",html:"<p>You can use our default process or create your own with custom workflows and practices.</p>",url:n},{id:"project.formAdd.selectProgram",html:"<p>You can group related projects under the same program to manage your portfolio.</p>",url:!1},{id:"project.formAdd.assignPeople",html:"<p>People can be included into both teams and projects so that you can vary work visibility.</p>",url:n},{id:"project.formAdd.assignTeams",html:"<p>You can have one team that works on several projects or one large project with several teams. Any mix of teams and projects, no matter how crazy, is supported.</p>",url:n},{id:"team.formAdd.assignPeople",html:"<p>People can be included into both teams and projects so that you can vary work visibility.</p>",url:n},{id:"team.formAdd.assignProjects",html:"<p>You can have one team that works on several projects or one large project with several teams. Any mix of teams and projects, no matter how crazy, is supported.</p>",url:n},{id:"board.templates",html:"<p>Easily create Views from predefined templates.</p>",url:"http://guide.targetprocess.com/boards/templates.html"},{id:"board.editor",html:"<p>On a View you can see different data as cards, organize your selected cards by common properties, and apply filters to cards and lanes.</p>",url:"http://guide.targetprocess.com/boards/boards-how-to.html",linkText:"See how to setup a View"},{id:"board.editor.access",html:"<p>Anyone can create Views that are private or shared with their team/project, but only administrators can create public Views.</p>",url:"http://guide.targetprocess.com/boards/access.html"},{id:"board.editor.prioritization",html:"<p>By default you should hold the Shift key to prioritize cards. While holding Shift, simply drag a card and move it into the desired position.</p><p>Remember that you can always change the prioritization mode for the View.</p>",url:"http://guide.targetprocess.com/boards/sort.html"},{id:"board.editor.selectCards",html:"<p>You can display various entities on Views. Entities with common properties can be displayed at the same time.</p>",url:"http://guide.targetprocess.com/boards/cards.html"},{id:"board.editor.selectLanes",html:"<p>Organize your selected items by common properties. You can use different properties (even custom fields) as your horizontal and vertical lanes.</p>",url:"http://guide.targetprocess.com/boards/lanes.html",linkText:"View the full list"},{id:"board.editor.selectListLevels",html:"<p>Organize your selected items by common properties. You can use different properties (even custom fields) as your 1st and 2nd levels.</p>",url:"http://guide.targetprocess.com/boards/lists.html"},{id:"board.editor.selectListCards",html:"<p>You can display various entities on Views. Entities with common properties can be displayed at the same time.</p>",url:"http://guide.targetprocess.com/boards/lists.html"},{id:"timeline.options.plannedInPast",html:"<p>This checkbox shows/hides planned dates for Done cards.</p>",url:"https://guide.targetprocess.com/boards/getting-started-with-the-timeline-view.html#planned-time"},{id:"timeline.options.showForecast",html:"<p>This checkbox shows/hides Forecast for cards.</p>",url:"https://guide.targetprocess.com/boards/getting-started-with-the-timeline-view.html#forecast-time"},{id:"board.editor.filter",html:["<p>","<strong>Basic mode.</strong> Just type keywords and filter cards by name. You can filter lanes (columns and rows) this way, as well.","</p>","<p>",'<strong>Advanced mode.</strong> These filters are much more powerful. Start off with "?" and from there you can create a complex query to use as a filter.',"</p>"].join(""),url:"http://guide.targetprocess.com/filters.html"},{id:"board.editor.saveContext",html:'<p>Specify a Projects-Teams context for&nbsp;this&nbsp;View, or go with "not specified" context.</p>',url:"https://guide.targetprocess.com/boards/context.html"},{id:"board.context.noProject.warning",html:"<p>All work will belong to some project in the future. All work without project will be moved to some artificial project.</p>",url:"http://tp3.uservoice.com/forums/174654-we-will-rock-you/suggestions/6326570-don-t-remove-no-project-option-across-the-system",linkText:"Share your opinion"}],function(t){return e.defaults(t,{url:"http://guide.targetprocess.com",linkText:"Read more&hellip;"})
});return i.extend({destroy:function(){this._super()},"bus afterRender":function(){var i=e.bind(function(e){var i=t(e.currentTarget);i.data("ui-tauBubbleArticle")||this._initTooltip(i)},this);t(document).on("mouseenter.tooltipArticle",".i-role-tooltipArticle",i),this.on("destroy",function(){t(document).off("mouseenter.tooltipArticle",".i-role-tooltipArticle",i)})},_initTooltip:function(t){var i=t.data("articleId"),n=e.findWhere(a,{id:i});n&&t.tauBubbleArticle({content:this._getContent(n),zIndex:99999,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),className:"tau-bubble-tooltipArticle",showEvent:"click",hideEvent:"click",stackName:"tooltipArticle",delay:100,showOnCreation:!1,onShow:function(){this.$target.toggleClass("tau-help_state_active",!0)},onHide:function(){this.$target.toggleClass("tau-help_state_active",!1)},onPositionConfig:this._tooltipPositionConfigTop,onArrowPositionConfig:this._tooltipArrowPositionConfigTop})},_getContent:function(e){var t=e.html;if(e.url){var i=this._applyStatisticQuery(e.url,e.id);t+='<a target="_blank" href="'+i+'">'+e.linkText+"</a>"}return t},_tooltipPositionConfigTop:function(e){e.at="left-8 top",e.my="left-50 bottom"},_tooltipArrowPositionConfigTop:function(e){return"center top"==e.at?e.at="left+10 top":"center bottom"==e.at&&(e.at="left+10 bottom"),e},_tooltipPositionConfigRight:function(e){e.at="right center",e.my="left center"},_applyStatisticQuery:function(e,i){var n,a,r=taus&&taus.adaptersScope&&taus.adaptersScope.cntx;return r?(n="?"+t.param({host:r.host&&r.host.id,userId:(r.user&&r.user.id).match(/(\d+)(?!.*\d)/).pop(),sid:taus.sid,origin:"Tooltip bubble "+i}),e.indexOf("#")>0?(a=e.split("#"),a[0]+n+"#"+a[1]):e+n):e}})}),define("tau/ui/templates/page/ui.template.page.error",["tau/core/templates-factory"],function(e){var t={name:"page.error",engine:"jqote2",markup:["<div class=\"tau-stop-message <%= this.className || '' %>\">",'<div class="tau-stop-message__content">','<h2 class="tau-stop-message__header"><%= _.asString(this.err.message) %></h2>',"<% if (this.err.description){ %>",'<p class="tau-stop-message__body"><%= _.asString(this.err.description) %></p>',"<% } %>","<% if (this.backLink){ %>",'<a href="<%= this.backLink %>" class="tau-stop-message__return-link">Back to previous page</a>',"<% } %>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.page.base",["Underscore","tau/components/component.creator","tau/ui/extensions/page/ui.extension.page.configConvertor","tau/ui/extensions/page/ui.extension.page.storeError","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/ui.extension.loading","tau/ui/extensions/board.tooltip/ui.extension.board.tooltip","tau/ui/extensions/board.tooltip/ui.extension.board.tooltipArticle","tau/ui/templates/page/ui.template.page.error"],function(e,t,i,n,a,r,s,o){return{create:function(l,u){var c=[i,a,s,o];l.turnOffLoadingIndicator!==!0&&c.push(r),l.turnOffErrorEmiter!==!0&&c.push(n),c=e.union(c,l.extensions);var d={name:l.name,ModelType:l.ModelType,ViewType:l.ViewType,extensions:c,queuedBus:l.queuedBus};return u.queuedBus=d.queuedBus,t.create(d,u)}}}),define("tau/views/view.page.entity",["require","Underscore","tau/core/view-base","tau/components/component.container","tau/configurations/factory.container.config","tau/configurations/const.page.entity.modes","tau/configurations/const.page.entity.actions"],function(e){var t=e("Underscore"),i=e("tau/core/view-base"),n=e("tau/components/component.container"),a=e("tau/configurations/factory.container.config"),r=e("tau/configurations/const.page.entity.modes"),s=e("tau/configurations/const.page.entity.actions");return i.extend({init:function(e){this.tausInitialLoad=taus.start("statistics_view",{"@":["--add-last-view-entity-context"],tags:["initial load"]}),this._super(e),this.config.placeholder&&this.config.placeholder.addClass("ui-entity-view")},"container afterInit":function(){this.fireAfterInit()},initialize:function(){},"container afterRender":function(e,t){this.tausInitialLoad&&this.tausInitialLoad.stop(),this.render(t.element)},"bus configurator.ready:last + loadingError.ready":function(e,t,i){t.getTitleManager().set(i.message);var n=t.getHistory().pop(),a=t.getTemplateFactory().get("page.error").bind({},{err:i,backLink:n?n.url:null});this.render(a)},render:function(e){this.fireBeforeRender(),this.element=e,this.config.placeholder&&(this.config.placeholder.append(e),this.config.placeholder.addClass("tau-entity-loaded")),this.fireAfterRender()
},initializeContainer:function(e){this.container&&this.container.initialize(e)},getStateFields:function(e){var i={};e.hasOwnProperty("stateName")&&(i[e.stateName]=e);var n=this,a=[];if(t.isArray(e.children))a=e.children;else if(t.isArray(e.tabs)){var r=t.pluck(e.tabs,"items");a=t.flatten(r)}return t.each(a,function(e){t.extend(i,n.getStateFields(e))}),i},"bus contextRetrieved":function(e,i){var r=this,s=this._createConfig(i);t.extend(s,r.config.containerConfig||a.getConfig(s)),this.container=n.create({name:"entity container",store:this.config.store,context:r.config.context,cssClass:r.config.cssClass,extensions:s.extensions||[]}),this.bus.on("afterRender",function(e,t){this.container.on("afterRenderAll",function(){this.fire("afterRenderAll",t)},this)},this),this.container.on("afterInit",this["container afterInit"],this),this.container.on("afterRender",this["container afterRender"],this);var o=function(e){r.fire("onConfigContainerCreated",e),r.fire("initializeContainer",e)};r.fire("configReadyForIntegration",s),s.integrationReadyPromise?s.integrationReadyPromise.always(function(e){o(e)}):o(s)},_createConfig:function(e){return t.extend(e,{action:this.config.action||s.SHOW,mode:this.config.mode||r.FULL,registry:this.config.registry||{}})},"bus onConfigContainerCreated+initializeContainer":function(e,i){var n=this,a=n.getStateFields(i),r=n.config.context.configurator;if(t.isEmpty(a))i.context.configurator=r,n.initializeContainer(i);else{var s=t.pluck(a,"stateName");i.context.componentSettings.get({fields:s,callback:function(e){t.each(a,function(t,i){e.hasOwnProperty(i)&&(a[i][i]=e[i])}),i.context.configurator=r,n.initializeContainer(i)}})}},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.destroyContainer(),this.container=null,this._super()}})}),define("tau/models/page.entity/model.page.entity.context",["Underscore","tau/core/extension.base","tau/models/page.entity/entity.context.factory"],function(e,t,i){return t.extend({name:"Entity","bus initialize":function(e,t){t&&t.context.configurator.getStore().evictData()
},"bus beforeInit":function(t,n){var a=e.isObject(n.config.entity)?n.config.entity:{id:n.config.id,type:n.config.entity},r=n.config.context.configurator,s=r.getStore().getTypes().findByKeyword(a.type);if(!s){var o=new Error(e.sprintf('Entity type "%s" does not exist',a.type));return void this.fire("loadingError.ready",o)}var l={id:a.id,entityType:{name:s.name}},u=r.getBoardCacheService(),c=u.getData()||{};a.id==c.id&&c.name&&(r.getStore().registerWithEvents({id:c.id,name:c.name,__type:a.type}),u.evict()),a.id==c.id&&(c.projectId||c.teamId)&&(l.projectId=c.projectId||null,l.teamId=c.teamId||null,u.evict()),this.fire("configurator.ready",r),i.create(l,r).done(e.bind(function(e){this.fire("entity.ready",e.entity),this.fire("contextRetrieved",{context:e})},this)).fail(e.bind(function(e){this.fire("loadingError.ready",e)},this))},"bus entity.ready + afterRender":function(e,t){this.fire("application.entity.loaded",{id:t.id,entity:t.entityType.name})}})}),define("tau/models/page.entity/model.page.entity.entityRefresher.change",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus entity.ready + configurator.ready":function(t,i,n){var a=i.entityType.name,r=n.getStore(),s=e.bind(this.fire,this);r.unbind(this);var o=!1,l=r.getEvictedPropertiesByType(a);e.forEach(l,function(t){r.on({eventName:"afterSave",type:a,listener:this,filter:{id:i.id},hasChanges:[t]},function(t){if(!o){if(o=!0,r.unbind(this),s("entity.toEvict",i),"project"!==a){var n=t.data,l=e.extend({},n.obj,n.changes,{__type:n.obj.type});r.register(l)}s("refresh")}})},this)},"bus configurator.ready > destroy":function(e,t){t.getStore().unbind(this)}})}),define("tau/models/page.entity/model.page.entity.entityRefresher.remove",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus entity.ready + configurator.ready":function(t,i,n){var a=n.getStore(),r=e.bind(this.fire,this);a.unbind(this),a.on({eventName:"beforeRemove",type:i.entityType.name,listener:this},function(e){var t=e.data,n=t.cmd.config.id;
i.id==n&&r("entity.beforeDelete",t)}),a.on({eventName:"afterRemove",type:i.entityType.name,listener:this},function(e){var t=e.data,n=t.cmd?t.cmd.config.id:t.obj?t.obj.id:t.id;i.id==n&&r("entity.deleted",t)})},"bus configurator.ready > destroy":function(e,t){t.getStore().unbind(this)}})}),define("tau/models/page.entity/model.page.entity.globalRefresher",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus entity.ready + configurator.ready":function(t,i,n){var a=n.getGlobalBus();a.removeAllListeners(this),a.on("entityWasMovedToProject",e.bind(this.onEntityWasMovedToProject,this,i),this),a.on("refreshMainEntity",e.bind(this.refresh,this,i),this)},"bus configurator.ready > destroy":function(e,t){var i=t.getGlobalBus();i.removeAllListeners(this)},onEntityWasMovedToProject:function(e,t){e.id==t.data.entity.id&&this.refresh(e)},refresh:function(e){this.fire("entity.toEvict",e),this.fire("refresh")},"bus configurator.ready > entity.toEvict":function(e,t,i){var n=t.getStore();n.evictPersistedObject(i.id,"context"),n.evictPersistedObject(i.id,i.entityType.name)}})}),define("tau/models/page.entity/model.page.entity.comet",["Underscore","tau/core/extension.base"],function(e,t){var i=function(e,t){window.appIsInDebugMode&&window.console&&console.log("model.page.entity.comet: "+e,t)};return t.extend({"bus configurator.ready:last + entity.ready":function(t,i,n){i.getAppStateStore().get({fields:["acid"],callback:e.bind(function(e){this.startCometLoop(i,n,e.acid)},this)})},"bus destroy":function(){this.lastChanges=null,this._stopSubscription(),this._super()},startCometLoop:function(t,n,a){var r=[{resourceType:n.entityType.name,filter:"? Id is "+n.id},{acid:a,resourceType:"assignment",filter:"? assignable.Id is "+n.id},{acid:a,resourceType:"roleEffort",filter:"? assignable.Id is "+n.id}];this._stopSubscription(),this.lastChanges={},this.subscription=t.getComet().listen("resource",e.map(r,function(e){return{parameters:e}})).on({callback:this.safeCallback(function(e){i("resource comet: ",e),this.handle(e,t)
})}).aborted(e.bind(function(){this._stopSubscription(),e.defer(e.bind(this.startCometLoop,this),t,n,a)},this)).start()},_stopSubscription:function(){this.subscription&&this.subscription.stop()},handle:function(t,n){var a=this.processResponse(t),r=a.modification.toLowerCase(),s=a.data,o=a.reason;switch(i("type: ",r),r){case"updated":s.__type=a.type,o.push("id"),o.push("__type"),s.assignable&&o.push("assignable"),s=e.pick(s,o),i("changes: ",o),n.getStore().registerWithEvents(s);break;case"removed":s.__type=a.type,n.getStore().removeWithEvents(s,o);break;case"added":s.__type=a.type,n.getStore().registerWithEvents(s)}},processResponse:function(t){var i=t.data,n=t.timestamp,a=i.type+i.id,r=e.map(i.reason,e.toCamelCase);e.has(this.lastChanges,a)||(this.lastChanges[a]={});var s=this.lastChanges[a];return i.reason=e.filter(r,function(e){var t=n>(s[e]||0);return t&&(s[e]=n),t}),i}})}),define("tau/models/page.entity/model.page.entity.history",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({fields:["name"],"bus entity.ready + configurator.ready":function(t,i,n){"user"==i.entityType.name&&(this.fields=["firstName","lastName"]);var a=n.getStore();a.unbind(this),a.on({eventName:"afterSave",type:i.entityType.name,id:i.id,fields:this.fields,listener:this},e.bind(this.update,this,i,n)),n.getHistory().setCurrent({url:n.getUrlBuilder().getNewViewUrl(i.id,i.entityType.name,!0),id:i.id})},"bus entity.ready + configurator.ready + storeFreeze.ready":function(e,t,i){this.update(t,i)},update:function(t,i){var n=i.getStore();n.get(t.entityType.name,{id:t.id,fields:["id"].concat(this.fields)}).done(e.bind(function(e){var t=e[0].data;i.getHistory().updateCurrent({title:this.createTitle(t,i.getTemplateFactory().getTermProcessor())})},this))},createTitle:function(t,i){return e.sprintf("%s #%d %s",i.getTerm(t.__type,"name"),t.id,e.values(e.pick(t,this.fields)).join(" "))},"bus configurator.ready + destroy":function(e,t){t.getStore().unbind(this)}})}),define("tau/models/page.entity/model.page.entity.storeFreeze",["tau/core/extension.base"],function(e){return e.extend({"bus configurator.ready + contextRetrieved":function(e,t){t.getStore().freeze(!0).done(_.bind(function(e){this.fire("storeFreeze.ready",e)
},this))},"bus storeFreeze.ready + afterInit":function(e,t){t.unfreeze()},"bus storeFreeze.ready + refresh":function(e,t){t.unfreeze()},"bus storeFreeze.ready + destroy":function(e,t){t.unfreeze()}})}),define("tau/services/service.entity-navigation",["tau/core/class"],function(e){return e.extend({navigateToEntityView:function(e,t,i){e.to("#"+i+"/"+t)}})}),define("tau/models/page.entity/model.page.entity.entityViewer",["tau/core/extension.base","tau/core/bus","tau/services/service.entity-navigation"],function(e,t,i){return e.extend({init:function(e){this._super.apply(this,arguments);var t=e.context.configurator,i=this._createViewerBus(t);this._registerViewerBus(t,i),this._initViewer(t,i)},_createViewerBus:function(e){var i=new t({name:"entityViewer",globalBus:e.getGlobalBus(),"queue.bus":!0});return this.on("destroy",this._destroyViewerBus.bind(this,i),this),i},_destroyViewerBus:function(e){e.removeAllListeners(this),e.destroy()},_registerViewerBus:function(e,t){e.getComponentBusRegistry().register(t),t.on("destroy",function(){e.getComponentBusRegistry().unregister(this)})},_initViewer:function(e,t){t.on("cardDataToShow.ready",function(t,n){var a=e.service("navigator");(new i).navigateToEntityView(a,n.entityId,n.entityType)},this)}})}),function(){var e=["tp/mashups","tau/core/global.bus","Underscore","tau/core/bus.reg","tau/core/event"];window.tauFeatures&&!window.tauFeatures["mashups.loader"]&&e.push("user/mashups"),define("tp/ui/mashupsForViews",e,function(e,t,i,n,a){var r=new e,s=!1,o={element:{addClass:function(){}},view:{config:{context:{entity:{id:null,entityType:{name:null}}}}}},l=function(e){for(var t=0,i=e.dependencies.length;i>t;t++){var n=e.dependencies[t],a=n.toLowerCase();if(a.indexOf("/view")>0||a.indexOf("iew")>0)return!0}return!1},u={init:function(){x()},onInit:function(e){r.onMashupsLoaded(l).done(e)}},c=function(e){return{header:[{name:e.id,type:"label",text:e.name}],items:[{name:e.id,type:"container"}]}},d=function(e,t){var n={label:e.name,name:"parent:"+e.id};
t.tabs.push(i.extend(n,c(e)))},p=function(e,t){var n={type:"collapsible",name:"parent:"+e.id,collapsed:!0,stateName:e.name.toLowerCase().replace(" ","")},a=i.extend(n,c(e));e.options&&e.options.positionToInsert&&t.children.length&&t.children[0].children&&t.children[0].children.length>=e.options.positionToInsert?t.children[0].children.splice(e.options.positionToInsert,0,a):t.children.push(a)},f=function(e){var t=i.jsonSelect(e.children,':has(:root>.type:val("tabs"))');return 0===t.length&&(t=[{tabs:[]}]),t=t[0]},m=function(e){var t=i.jsonSelect(e.children,':has(:root>.name:val("additional info column container"))');return 0===t.length&&(t=[{children:[]}]),t=t[0]},h=function(e,t){var i=t&&t.getViewIsSuitablePromiseCallback;return i?i({entity:e}):null},g=function(t,n){var a=r.subscriptions.view,s=n.type.toLowerCase(),o=(a[s]||[]).concat(a[e.viewTypes.GENERAL]||[]),l=[],u=[];i.forEach(o,function(e){var t=h(n,e.options);t?(u.push(t),t.done(i.bind(function(e,t){t&&l.push(e)},this,e))):l.push(e)});var c=i.bind(function(e,t){i.forEach(l,function(i){i.callback(e,{entity:t})})},this,t,n);u.length>0?$.when.apply(this,u).then(function(){c()}):c()},v=function(e,t,n){var a=b(e,t),r=i.bind(n,this,e);a.length>0?$.whenList(a).done(r):r()},b=function(t,n){for(var a=i.values(n),r=[],s=a.length,o=new Array(s),l=0;s>l;l++){var u=a[l],c=t.context.entity;if(u.type.toLowerCase()===c.entityType.name.toLowerCase()||u.type.toLowerCase()===e.viewTypes.GENERAL.toLowerCase()){var d=h(c,u.options);if(d){var p=$.Deferred();r.push(p.promise()),d.done(i.bind(function(e,t,i){i&&(o[e]=t)},this,l,u)).always(p.resolve)}else o[l]=u}}return $.whenList(r).done(i.bind(function(){y(t,i.compact(o))},this)),r},y=function(e,t){var n=null,a=null;i.forEach(t,function(t){"tab"===t.control&&(n||(n=f(e)),d(t,n)),"block"===t.control&&(a||(a=m(e)),p(t,a))})},_=function(e,t){var n=t.view.config.context.entity,a={entity:i.extend(n,{type:n.entityType.name})},r="label"===t.view.config.type,s=r?"onCreateHeader":"onCreateContent";
r||t.element.addClass("ui-custom-control-content"),e[s](t.element,a)},x=function(){if(!s){s=!0,n.getByName("entity component",function(e){var t={bus:e,"bus before_contextRetrieved":function(e){e.suspendMain(),u.onInit(function(){e.resumeMain()})}};a.subscribeOn(t)});var e=t.get();e.on("afterRenderAll",function(e){var t=e.caller.name,n=e.data||o;if("entity component"===t){var a=n.element,r=n.view.config.entity,s=i.extend(r,{entityType:{name:r.type}});g(a,s)}}),e.on("afterRender",function(e){var t=r.controls.view,i=e.caller.name,n=e.data||o;t.hasOwnProperty(i)&&_(t[i],n)}),e.on("configReadyForIntegration",function(e){var t=r.controls.view,i=$.Deferred();e.data.integrationReadyPromise=i.promise(),v(e.data,t,function(e){i.resolve(e)})})}};return u})}(),define("tau/components/component.page.entity",["Underscore","tau/components/component.page.base","tau/views/view.page.entity","tau/models/page.entity/model.page.entity.context","tau/models/page.entity/model.page.entity.entityRefresher.change","tau/models/page.entity/model.page.entity.entityRefresher.remove","tau/models/page.entity/model.page.entity.globalRefresher","tau/models/page.entity/model.page.entity.comet","tau/models/page.entity/model.page.entity.history","tau/models/page.entity/model.page.entity.storeFreeze","tau/models/page.entity/model.page.entity.entityViewer","tp/ui/mashupsForViews"],function(e,t,i,n,a,r,s,o,l,u,c,d){return{create:function(p){d.init();var f=p.context.configurator.getFeaturesService(),m={turnOffLoadingIndicator:p.turnOffLoadingIndicator,queuedBus:!0,ViewType:i,extensions:e.compact([n,a,r,s,l,u,c].concat(p.extensions||[]))};return f.isEnabled("comet.notifications")&&p.comet&&p.comet.enabled&&m.extensions.push(o),t.create(m,p)}}}),define("tau/components/entity.new.list/entity.new.list.card.viewer.component.factory",["require","tau/core/class","tau/components/component.page.entity","tau/configurations/const.page.entity.modes","tau/store/factory","tau/components/entity.new.list/const.entity.new.list.selectors"],function(e){var t=e("tau/core/class"),i=e("tau/components/component.page.entity"),n=e("tau/configurations/const.page.entity.modes"),a=e("tau/store/factory"),r=e("tau/components/entity.new.list/const.entity.new.list.selectors");
return t.extend({init:function(e){this._configurator=e.context.configurator},create:function(e){var t=this._configurator.createChild();t.setStoreFactory(new a),t.registerService("navigator",this._configurator.service("navigator")),t.registerService("errorBar",this._configurator.service("errorBar")),t.getKeyBoardManager=this._configurator.getKeyBoardManager.bind(this._configurator);var n=this._createConfig(t,e),r=i.create(n);return r.initialize(n),r},_createConfig:function(e,t){return{context:{configurator:e},id:t.entityId,entity:t.entityType,mode:n.LIST_ENTITY_DETAILS,progressTargetSelector:r.LIST_ENTITY_DETAILS,comet:{enabled:!0}}}})}),define("tau/components/entity.new.list/testPlanRun.new.list.card.viewer.component.factory",["require","tau/components/entity.new.list/entity.new.list.card.viewer.component.factory"],function(e){var t=e("tau/components/entity.new.list/entity.new.list.card.viewer.component.factory");return t.extend({init:function(e){this._super(e),e.context.registry&&(this._runnerModel=e.context.registry.runnerModel)},_createConfig:function(e,t){var i=this._super(e,t);return"testcaserun"===t.entityType.toLowerCase()&&(i.registry={runnerModel:this._runnerModel}),i}})}),define("tau/components/entity.new.list/extension.entity.new.list.card.cover.viewer",["require","tau/core/extension.base","tau/components/entity.new.list/entity.new.list.card.viewer","tau/components/entity.new.list/entity.new.list.card.viewer.component.factory","tau/components/entity.new.list/testPlanRun.new.list.card.viewer.component.factory"],function(e){var t=e("tau/core/extension.base"),i=e("tau/components/entity.new.list/entity.new.list.card.viewer"),n=e("tau/components/entity.new.list/entity.new.list.card.viewer.component.factory"),a=e("tau/components/entity.new.list/testPlanRun.new.list.card.viewer.component.factory");return t.extend({"bus beforeInit":function(e,t){if(!this._cardViewer){var n=t.config,a=this._getComponentFactory(n.context.entity.entityType),r=n.context.configurator.getKeyBoardManager();
this._cardViewer=new i(new a(n),r),this._cardViewer.opened.add(this.fire.bind(this,"details.view.toggled",{viewerOpened:!0})),this._cardViewer.closed.add(this.fire.bind(this,"details.view.toggled",{viewerOpened:!1}))}},"bus afterRender:last + new.list.open.card.details.view":function(e,t,i){var n=t.element,a=i.cardData;this._cardViewer.isShown(a)?this._cardViewer.hide():this._cardViewer.show({$list:n,$card:i.$card,cardData:a,scrollToCard:i.scrollToCard})},"bus afterRender:last + details.view.toggled":function(e,t,i){this._toggleViewingForList(t.element,i.viewerOpened)},"bus details.view.toggled:last > view.cell.skeleton.built":function(e,t,i){t.viewerOpened&&this._toggleViewingForCards(i,t.viewerOpened)},"bus new.list.close.card.details.view":function(){this._cardViewer.hide()},"bus destroy":function(){this._cardViewer.destroy()},_toggleViewingForList:function(e,t){e.toggleClass("tau-details-view-opened"),this._toggleViewingForCards(e,t)},_toggleViewingForCards:function(e,t){var i=e.find(".i-role-details-trigger").closest(".tau-elems-cell");i.filter(".tau-elems-cell_unit-editable").toggleClass("disabled",t),i.toggleClass("i-role-details-trigger",t)},_getComponentFactory:function(e){return"testplanrun"===e.name.toLowerCase()?a:n}})}),define("tau/components/entity.new.list/extension.entity.new.list.comet",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus configurator.ready:last + slice.ready:last + expansion.state.changed":function(e,t,i,n){t.getFeaturesService().isEnabled("entity.new.list.comet")&&this.fire("comet.parameters",i.slice.getCometParameters(n))}})}),define("tau/components/component.entity.new.list",["Underscore","tau/components/component.creator","tau/components/component.base.new.list","tau/components/entity.new.list/extension.entity.new.list","tau/components/entity.new.list/extension.entity.new.list.card.cover.viewer","tau/configurations/const.page.entity.modes","tau/components/entity.new.list/extension.entity.new.list.comet"],function(e,t,i,n,a,r,s){return{create:function(o){var l=i.createNewListConfig(e.extend(o,{notificationsHubName:"slice-entitynewlist"}));
return o.behaviors=o.behaviors||i.getDefaultBehaviors(),o.newList=l.newList,o.behaviorsSettings=e.defaults({dndOptions:{tolerance:"pointer"}},o.behaviorsSettings||{}),l.extensions=o.context.registry.componentConfigHelper.collection([{extType:n,args:[l.newList.model,l.newList.view,l.newList.busEventAggregator]},{enabledIf:{modeIn:[r.FULL]},extType:a,args:[]},s].concat(l.extensions)),t.create(l,o)}}}),define("tau/components/entity.new.list/entity.new.list.integration.facade",["require","jQuery","tau/core/class"],function(e){var t=e("jQuery"),i=e("tau/core/class");return i.extend({init:function(e,i){this.newListModel=e,this.viewSkeleton=i,this._treeModelReady=t.Deferred(),this._treeViewReady=t.Deferred(),this.newListModel.treeModelCreated.add(this._treeModelCreated,this)},_treeModelCreated:function(e){this._startActualTreeViewWaiting(),this._startActualTreeModelWaiting(),this._treeModel&&(this._treeModel.loadingStatusChanged.remove(this),this._treeModel.nodeCollectionCreated.remove(this)),this._treeModel=e,e.loadingStatusChanged.add(this._loadingStatusChanged,this),e.nodeCollectionCreated.add(this._nodeCollectionCreated.bind(this,e),this)},_startActualTreeViewWaiting:function(){"pending"!==this._treeViewReady.state()&&(this._treeViewReady=t.Deferred()),this.viewSkeleton.treeViewCreated.remove(this._treeViewCreated,this),this.viewSkeleton.eventAggregator.treeRendered.remove(this._treeRendered,this)},_startActualTreeModelWaiting:function(){"pending"!==this._treeModelReady.state()&&(this._treeModelReady=t.Deferred())},_loadingStatusChanged:function(e){e.isLoading&&(this._startActualTreeViewWaiting(),this._startActualTreeModelWaiting())},_nodeCollectionCreated:function(e){this._startActualTreeViewWaiting(),this._treeModelReady.resolve(e),this.viewSkeleton.treeViewCreated.add(this._treeViewCreated,this)},_treeViewCreated:function(e){this._startActualTreeViewWaiting(),this._treeView=e,this.viewSkeleton.eventAggregator.treeRendered.add(this._treeRendered,this)},_treeRendered:function(e){this._treeView.$treeContainer===e&&this._treeViewReady.resolve(this._treeView)
},getTreeModel:function(){return this._treeModelReady.promise()},getTreeView:function(){return this._treeViewReady.promise()},destroy:function(){this.newListModel.treeModelCreated.remove(this),this.viewSkeleton.treeViewCreated.remove(this),this.viewSkeleton.eventAggregator.treeRendered.remove(this),"pending"===this._treeModelReady.state()&&this._treeModelReady.reject(),"pending"===this._treeViewReady.state()&&this._treeViewReady.reject()}})}),define("tau/components/entity.new.list/model.entity.new.list.testPlanRun.runner",["require","Underscore","tau/core/class"],function(e){var t=e("Underscore"),i=e("tau/core/class");return i.extend({init:function(e,i){this._newListFacade=e,this._testPlanRun=i,this.nextRun=t.Callbacks()},runNext:function(e){this._goToNextToRun(e).then(this._runNext.bind(this,e))},_goToNextToRun:function(e){return this._withTreeModel(function(t){var i=Math.floor(e[0].index/t.pagingModel.pageSize);t.pagingModel.getCurrentPage()!==i&&t.goToPage(i)}.bind(this))},_withTreeModel:function(e){return this._newListFacade.getTreeModel().done(e)},_runNext:function(e){this._withTreeModel(function(i){var n=e[0].id,a=t.find(i.nodes.items,function(e){return e.card&&e.card.getId()===n});this.nextRun.fire(a)}.bind(this))},destroy:function(){this.nextRun.empty()}})}),define("tau/components/entity.new.list/view.entity.new.list.testPlanRun.runner",["require","Underscore","jQuery","tau/core/class"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class");return n.extend({init:function(e){this._newListFacade=e,this.nextViewed=t.Callbacks()},runNext:function(e){this._buildCardViewerModel(e).done(this.nextViewed.fire.bind(this.nextViewed))},_buildCardViewerModel:function(e){var t=i.Deferred();return this._newListFacade.getTreeView().done(function(i){var n=i.findChildCardById(e.card.id);n.length>0&&t.resolve({$card:n,cardData:n.data()})}.bind(this)),t.promise()},destroy:function(){this.nextViewed.empty()}})}),define("tau/components/entity.new.list/extension.entity.new.list.testPlanRun.runner",["require","Underscore","jQuery","tau/core/extension.base","tau/components/entity.new.list/entity.new.list.integration.facade","./model.entity.new.list.testPlanRun.runner","./view.entity.new.list.testPlanRun.runner"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/extension.base"),a=e("tau/components/entity.new.list/entity.new.list.integration.facade"),r=e("./model.entity.new.list.testPlanRun.runner"),s=e("./view.entity.new.list.testPlanRun.runner");
return n.extend({init:function(e){this._super(e),this._config=e,this._uiReady=i.Deferred(),this._sliceApi={},this._runnerModel=this._config.context.registry.runnerModel,this._newListFacade=new a(this._config.newList.model,this._config.newList.view),this._newListRunnerModel=new r(this._newListFacade,this._config.context.entity),this._newListRunnerView=new s(this._newListFacade),this._initSubscriptions()},_initSubscriptions:function(){this._runnerModel.nextRun.add(this._runNext,this),this._runnerModel.nextRun.add(this._newListRunnerModel.runNext,this._newListRunnerModel),this._newListRunnerModel.nextRun.add(this._newListRunnerView.runNext,this._newListRunnerView),this._newListRunnerView.nextViewed.add(this._viewNext,this),this._runnerModel.finished.add(this._runFinished,this)},_runNext:function(){this._shouldBeRefreshed()&&this.fire("refresh")},_viewNext:function(e){this._uiReady.done(this.fire.bind(this,"new.list.open.card.details.view",t.extend(e,{scrollToCard:!0})))},_runFinished:function(){this.fire("new.list.close.card.details.view")},_shouldBeRefreshed:function(){var e=this._sliceApi.currentOrderingConfig;return e&&e.ordering},"bus slice.ready":function(e,t){this._sliceApi=t.slice},"bus overview.board.ready:last + container.show.completed":function(){this._uiReady.resolve()},"bus container.hide.completed":function(){this._uiReady=i.Deferred()},"bus destroy":function(){this._runnerModel.nextRun.remove(this._runNext,this),this._runnerModel.nextRun.remove(this._newListRunnerModel.runNext,this._newListRunnerModel),this._newListRunnerModel.nextRun.remove(this._newListRunnerView.runNext,this._newListRunnerView),this._newListRunnerView.nextViewed.remove(this._viewNext,this),this._runnerModel.finished.remove(this._runFinished,this),this._newListRunnerView.destroy(),this._newListRunnerModel.destroy(),this._newListFacade.destroy()}})}),define("tau/components/component.entity.new.list.testPlanRun.testCaseRuns",["require","Underscore","tau/components/component.entity.new.list","tau/components/entity.new.list/extension.entity.new.list.testPlanRun.runner"],function(e){var t=e("Underscore"),i=e("tau/components/component.entity.new.list"),n=e("tau/components/entity.new.list/extension.entity.new.list.testPlanRun.runner");
return{create:function(e){return e=t.extend(e,{definition:{cells:{types:["testcaserun"]},cardSettings:{list_testcaserun:{list:[[{id:"tcr_name",order:0},{id:"tcr_id",order:1},{id:"tcr_run_result",order:2},{id:"tcr_run_date",order:3}]]}}}}),e.extensions=(e.extensions||[]).concat([n]),i.create(e)}}}),define("tau/models/quick.add/model.entity.quickAdd.add",["Underscore","jQuery","tau/models/quick.add/model.quick.add.base","tau/core/termProcessor","tau/configurations/converters/converter.context","tau/services/service.entity-navigation"],function(e,t,i,n,a,r){return i.extend({doAdd:function(t,i,n){var a=t.config.context.configurator,r=t.config.context.entity,s=t.config.options,o=i[n.type];"release"==r.entityType.name&&"iteration"==o.entityType.name.toLowerCase()&&n.fields.push({id:"release",value:r.id});var l=e.extend({entityType:n.type,values:n.fields},o.coordinates);o.slice[o.saveAction]({$set:l}).done(e.bind(function(t){var i=t.data,l=e.find(s.items,function(e){return e.entityType.toLowerCase()==i.type.toLowerCase()}),u=a.getStore().typeMetaInfo(l.relationName).resource;if(u){var c={id:r.id,__type:r.entityType.name};c[u]=[e.extend(e.omit(i,"entityType","type"),{__type:i.type})],a.getStore().registerWithEvents(c);var d=i.type,p=d.charAt(0).toLowerCase()+d.substring(1);a.getGlobalBus().fire(p+".items.added",{entity:{id:i.id},"evict-data":{entityId:r.id,entityType:r.entityType.name,evictProperties:[u]}})}var f={message:{dataItem:i},nameType:o.entityType};f.message.dataItem.data={cardData:f.message.dataItem},f.openAfter=n.openAfter,this.fire("model.data.item.did.add",f)},this)).fail(e.bind(function(e){return this.fire("model.data.item.did.fail.add",e.data.responseText),!1},this))},"bus beforeInit:last + dataBind:last + model.add.item":function(e,t,i,n){this.preProcessFields(n.fields).done(this.doAdd.bind(this,t,i.types,n))},onInit:function(t){this._super(t);var i=t.options||{},n=t.context.entity,r=t.context.applicationContext.acid,s=t.context,o=this.config.context.configurator;
t.useGlobalEntityViewer||this.fire("viewerBus.ready",this.bus);var l=t.context.applicationContext.culture;this.fire("culture.ready",l),i=e.defaults(i,{items:[]}),i.items=a.convert(i.items,e.pluck(s.getPractices(),"name"),s.getEdition()),0===i.items.length?this.fire("dataBind",{isEmpty:!0,types:[],entityTypes:[]}):this.getTemplates(o,n,r,i).done(this.initTemplates.bind(this,t,n))},initTemplates:function(t,i,a){var r=new n(t.context.getTerms()),s={};e.each(a,function(t,n){t.entityType={name:t.entityType,title:r.resolve(t.entityType,t.entityTypeTitle)},0===n&&(t.entityType.active=!0),"release"==i.entityType.name&&"iteration"==t.entityType.name.toLowerCase()&&(t.template.items=e.reject(t.template.items,function(e){return"release"==e.id.toLowerCase()})),s[t.entityType.name]=t});var o=e.pluck(s,"entityType");this.fire("model.dataItems.template.ready",{types:s}),this.fire("dataBind",{types:s,entityTypes:o,mainEntity:i,constants:this.getTemplateConstants()})},"bus cardDataToShow.ready":function(e,t){var i=this.config.context.configurator,n=i.service("navigator");(new r).navigateToEntityView(n,t.entityId,t.entityType)},getTemplates:function(t,i,n,a){var r=e.map(a.items,function(e){return e.entityType}),s={global:{acid:n},entityType:i.entityType.name,entityId:i.id,templateTypesFilter:r},o=t.getSliceFactory().create({definition:s});return o.viewDataTemplates().then(function(t){return e.map(t.data.items,function(e){return{templateAction:"viewDataTemplate",saveAction:"viewAddData",entityType:e.availableResource.name,entityTypeTitle:e.availableResource.title,slice:o,template:e.fieldTemplates}})})}})}),define("tau/components/component.entity.quickAdd",["tau/components/component.creator","tau/models/quick.add/model.entity.quickAdd.add","tau/ui/extensions/board.cell.quick.add/ui.extension.board.cell.quick.add","tau/ui/extensions/finder.entity/ui.extension.finder.entity.embedder","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/container/ui.extension.container.childrenEvents","tau/components/extensions/error/extension.errorBar","tau/views/view.compositeControl","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){var d=[t,i,n,a,r,s,o],p={ViewType:l,name:"entity.quickAdd",extensions:d,template:u};
return c["queue.bus"]=!0,c.dependencies=["finder.entity"],e.create(p,c)}}}),define("tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.base.quickAddTrigger",["require","tau/core/extension.base"],function(e){var t=e("tau/core/extension.base");return t.extend({"bus beforeInit":function(e,t){this.keyBoardManager=t.config.context.configurator.getKeyBoardManager(),this.options=t.config.options||{}},"bus afterRender:last + destroy":function(e,t){var i=t.element;i.length&&i.data("ui-tauBubble")&&i.tauBubble("hide")},_createQuickAddConfig:function(e,t,i,n){return{target:e,appendMethod:"appendTo",cleanupOnHide:!0,stackName:t,showOnCreation:!1,zIndex:1e4,className:"tau-quick-add-dialog-general "+i,hideOnScroll:!1,dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:{components:n},onShow:function(){this.keyBoardManager.pushHandler({})}.bind(this),onHide:function(){this.keyBoardManager.popHandler()}.bind(this),onPositionConfig:function(){return{my:"right top",at:"right+20 bottom",of:e,collision:"fit none",within:this.appendTo}}}}})}),define("tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.quickAddTrigger",["require","Underscore","tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.base.quickAddTrigger","tau/configurations/converters/converter.context","tau/configurations/factory.container.config"],function(e){var t=e("Underscore"),i=e("tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.base.quickAddTrigger"),n=e("tau/configurations/converters/converter.context"),a=e("tau/configurations/factory.container.config");return i.extend({"bus beforeInit":function(e,i){this._super(e,i),this.options=t.defaults(this.options,{external:!1,items:[]}),this.options.external&&(this.options.items=a.getEntityConfigObject(i.config).getEntityQuickAddOptions().items);var r=i.config.context;this.options.items=n.convert(this.options.items,t.pluck(r.getPractices(),"name"),r.getEdition()),this.fire("dataBind",{isEmpty:0==this.options.items.length})},"bus afterRender":function(e,t){var i=t.element;
if(i.length){var n=this._createQuickAddConfig(i,"quickAddGeneral","tau-quick-add-dialog-entity",[{name:"entity quick add",type:"entity.quickAdd",options:this.options}]);this.fire("initBubble",n)}}})}),define("tau/ui/templates/entity.quickAddTrigger/ui.template.entity.quickAddTrigger",["tau/core/templates-factory"],function(e){var t={name:"entity.quickAddTrigger",engine:"jqote2",markup:["<% if (!this.isEmpty){ %>",'<span class="tau-view-quick-add i-role-trigger"></span>',"<% } %>"]};return e.register(t)}),define("tau/components/component.entity.quickAddTrigger",["Underscore","tau/components/component.creator","tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.quickAddTrigger","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/entity.quickAddTrigger/ui.template.entity.quickAddTrigger"],function(e,t,i,n,a,r){return{create:function(e){var s={extensions:[i,n,a],template:r};return t.create(s,e)}}}),define("tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(e){var t={name:"feature-assignments-user-list",markup:['<div class="group" roleId="${role.id}">','<table class="role-header">',"   <tr>",'   <td class="role-title">','   {{tmpl "assignments-add-btn"}}',"&nbsp;${role.name}","   </td>","</tr>","</table>",'{{tmpl(users) "user"}}',"</div>"].join(""),dependencies:["user","assignments-add-btn"]};return e.register(t)}),define("tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList.userList","tau/ui/templates/common/ui.template.user"],function(e){var t={name:"feature-assignments-list",markup:['<table class="box assignments-table-readonly assignments-table">','   <tr class="title-row">','      <td class="user-list">','      {{tmpl(assignments.groups, {effortPoints: effortPoints}) "feature-assignments-user-list"}}',"      </td>","   </tr>","</table>"].join(""),dependencies:["feature-assignments-user-list","user"]};
return e.register(t)}),define("tau/components/component.feature.assignmentList",["tau/components/component.assignmentsList","tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList"],function(e,t){return{create:function(i){return i.template=t,e.create(i)}}}),define("tau/models/finder.project/model.finder.project.byEntity.abstract",["Underscore","tau/core/extension.base","tau/configurations/project.colors"],function(e,t,i){return t.extend({resetLifecycle:!0,"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i),this.fire("entity.ready",t.config.context.entity)},"bus configurator.ready + entity.ready":function(e,t){var i=t.getStore(),n=this.fire.bind(this,"refresh");i.unbind(this),i.on(this._getStoreOnRefreshConfig(),n)},"bus configurator.ready:last + entity.ready":function(e,t,i){this._getAssignedEntities(t.getStore(),i)},"bus configurator.ready:last + destroy":function(e,t){var i=t.getStore();i.unbind(this)},_getAvailableEntities:function(t,n){var a=this.fire.bind(this,"dataBind");e.parallel(t,function(e,t){var r=t[0],s=t[1],o=t[2];a({projects:r,processes:s,programs:o,activeTab:n,canAddProjects:!0,teams:[],canAddTeams:!1,submitLabel:"Assign",showEmpty:!0,showSearch:r.length>20,colors:i})})},_getList:function(t,i,n,a,r){t.get(i,{fields:n}).done({success:function(t){var i=t[0].data;i=e.filter(i,function(t){return-1==e.indexOf(a,t.id)}),i=e.sortBy(i,function(e){return e.name.toUpperCase()}),r(!1,i)}})}})}),define("tau/models/finder.project/model.finder.project.byProgram",["Underscore","tau/models/finder.project/model.finder.project.byEntity.abstract","tau/components/context.selector/models/model.context.program"],function(e,t,i){return t.extend({"bus configurator.ready:last + programProjects.ready:last + activeTab.ready:last + beforeInit":function(e,t,i,n){var a=t.getStore(),r=[this._getProjects.bind(this,a),this._getList.bind(this,a,"process",["id","name","isDefault"],[])];this._getAvailableEntities(r,n)},_getProjects:function(t,n){var a=["id","name","color",{program:["id","name"]}];
new i(t).getAvailableProjects(a).then(function(t){t=e.sortBy(t,function(e){return e.name.toUpperCase()}),n(!1,t)})},_getStoreOnRefreshConfig:function(){return{eventName:"afterSave",type:"program",listener:this,hasChanges:["projects"]}},_getAssignedEntities:function(e,t){var i=this;e.get("program",{id:t.id,fields:[{projects:[{project:["id","name"]}]}]}).done({success:function(e){i.fire("programProjects.ready",e[0].data.projects)}})}})}),define("tau/models/board.context.filter/model.board.context.filter.add.project",["Underscore","tau/core/extension.base","tau/libs/inviter/inviter"],function(e,t,i){return t.extend({"bus configurator.ready:last + project.add.ready":function(t,n,a){var r=this,s=n.getStore(),o={name:e.trim(a.name),color:e.trim(e.asString(a.color))||null,process:{id:a.process}};a.program&&"-1"!=a.program&&(o.program={id:a.program}),s.save("project",{failureGlobal:!1,$set:o},{success:function(e){r.fire("project.saved",e.data)},failure:function(e){r.fire("project.add.failure",e.data.response.Message)}}).done();var l=new i(n);l.invite(a.members).done(function(e){r.fire("projectMembers.saved",e)})},"bus configurator.ready:last + project.add.ready + project.saved + projectMembers.saved":function(t,i,n,a,r){var s=this,o=i.getStore(),l=e.compact(e.pluck(r,"success")),u=e.compact(e.pluck(r,"failure"));if(u.length){var c="Can't assign users.";this.fire("project.add.nonFatalFailure",c)}l=e.filter(l,function(e){return e!=i.getLoggedUser().id});var d={projectMembers:e.map(l,function(e){return{user:{id:e}}})};o.save("project",{id:a.id,$set:d,fields:["id","name","color",{projectMembers:[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}]}]}).done(function(e){s.fire("projectMembers.connected",e[0].data)})},"bus project.saved + projectMembers.saved + projectMembers.connected":function(e,t,i,n){this.fire("project.add.success",n)}})}),define("tau/models/finder.project/model.finder.project.byEntity.assign",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(e,t){this._super(e),this._commandFactory=t
},"bus configurator.ready:last + entity.ready:last + form.submitted":function(e,t,i,n){var a=n.projectIds;this._assign(t,i,a).done(this.fire.bind(this,"projects.connected",a))},"bus configurator.ready:last + entity.ready:last + project.add.success":function(e,t,i,n){var a=[n.id];this._assign(t,i,a).done(this.fire.bind(this,"projects.connected",a))},_assign:function(t,i,n){var a=this._commandFactory.create(i,n),r=t.getStore(),s=e.Deferred();return r.evictProperties.apply(r,a.evictProperties),r.save(a.type,a.data).done({success:function(e){s.resolve(e[0].data)}}),s}})}),define("tau/models/finder.project/providers/program.projects.command.factory",["Underscore"],function(e){return{create:function(t,i){var n=e.map(i,function(e){return{id:e}});return{evictProperties:[t.id,t.entityType.name,["projects"]],type:"program",data:{id:t.id,fields:["id","projects"],$set:{projects:n}}}}}}),define("tau/ui/extensions/tabs/ui.extension.tabs.modern",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus initialize":function(){this.fire("activeTab.ready",null)},"bus activeTab.ready > refresh":function(e,t){this.fire("activeTab.ready",t)},"bus $el.ready":function(e,i){var n=this,a=i.find(".i-role-tabheader.tau-active");a.length&&this._switchTab(i,a,!0),i.on("click",".i-role-tabheader",function(){n._switchTab(i,t(this));n.fire("activeTab.ready",n._getActiveName(i))})},_switchTab:function(e,i,n){var a=e.find(".i-role-tabheader"),r=i.data("tab");a.not(i).each(function(){e.find(".i-role-tab-"+t(this).data("tab")).removeClass("tau-active")}).removeClass("tau-active");var s=e.find(".i-role-tab-"+r);return s.toggleClass("tau-active",n),s.hasClass("tau-active")&&this._applyFocus(s),i.toggleClass("tau-active",n),i},_applyFocus:function(e){e.find("form :submit:first:visible").focus(),e.find("form :text:first:visible").focus()},_getActiveName:function(e){return e.find(".i-role-tabheader.tau-active").data("tab")||null}})}),define("tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){var i=t.element;
this.fire("$el.ready",i)},"bus $list.ready":function(e,t){this.fire("view.component.rendered",{element:t})}})}),define("tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $teamSection.ready + $projectSection.ready + $list.ready":function(e,i,n,a){var r=this,s=a;s.delegate("[role=action-submit]","click",function(){var e={},a=i.find(".i-role-list :checked");e.teamIds=a.map(function(){return t(this).val()}),a=n.find(" .i-role-list :checked"),e.projectIds=a.map(function(){return t(this).val()}),r.fire("form.submitted",e)})}})}),define("tau/ui/extensions/finder.project/ui.extension.finder.project.bubble",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus configurator.ready + $el.ready":function(e,i,n){var a=n,r=n;this.fire("$list.ready",r),this.fire("$bubbled.ready",a),this.fire("$popup.ready",r),this.fire("$teamSection.ready",t()),this.fire("$projectSection.ready",n),this.fire("$sections.ready",n)}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.abstract",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({_selectText:function(e){e[0].setSelectionRange(0,e.val().length)},_initForm:function(e){var t=e.find(".i-role-form");setTimeout(function(){t.find(":submit:first").focus(),t.find(":text:first").focus()},10),e.find(".i-role-formtrigger").toggleClass("tau-active"),e.toggleClass("tau-managed-category_formactive_true"),t.on("reset",function(){t.find(":input").removeClass("tau-error"),t.find(":submit:first").focus(),t.find(":text:first").focus()}),t.on("click","[type=reset]",function(){e.removeClass("tau-managed-category_formactive_true"),e.find(".i-role-formtrigger").removeClass("tau-active")});var i=function(){t.find(":not(.disabled)").prop("disabled",!1),t.tauProgressIndicator("hide")};return t.on("entity.add.completed",i),t.on("entity.add.failed",i),t.tauProgressIndicator(),t
},_addSubmitDataListener:function(e,i){e.on("submit",function(n){n.preventDefault();var a={};e.find(":input").each(function(){a[this.name]=this.value}),a.members=e.find("[name=users]").tauInviter("getValue",!0),a.connected=[];var r=e.find(".i-role-list :checked");r.each(function(){a.connected.push(t(this).val())}),e.find(":not(.disabled)").prop("disabled",!0),e.tauProgressIndicator("show"),i(a)})},_initRichSelect:function(e,i){var n=e.find(".i-role-currenticon");return i.on("change",function(){var e=i.val();n.trigger("change",e),n.attr("data-value",e||"default")}),e.delegate(".i-role-richselect .i-role-option","click",function(){var t=this.getAttribute("data-value");i.val(t),i.trigger("change"),e.find(":text:first").focus()}),n.parent().on("click",function(){t(this).toggleClass("tau-active"),e.find(".i-role-richselect").toggle()}),e.on("reset",function(){i.val(""),i.trigger("change")}),n},_addToList:function(t,i,n){n.selected=!0,n.isSupportView=!0;var a=i.bind({},n),r=(t.find(".i-role-form"),t.find(".i-role-list")),s=r.find(".i-role-item:first");s.length?s.after(a):r.append(a),r.parent().scrollTo(0,{duration:500}),a.addClass("tau-added"),e.delay(function(){a.removeClass("tau-added")},1500)},_resetProgressIndicator:function(e){e.tauProgressIndicator("hide"),e.find(":not(.disabled)").prop("disabled",!1)}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.project",["Underscore","jQuery","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.abstract"],function(e,t,i){return i.extend({"bus $projectSection.ready":function(e,i){var n=this,a=this._initForm(i);this._addSubmitDataListener(a,function(e){n.fire("project.add.ready",e)});var r=a.find("select[name=color]"),s=this._initRichSelect(a,r);s.on("change",function(e,t){s.css("background-color",t)}),i.on("click",".i-role-tab-add [type=reset]",function(){t("[data-tab=add]",i).click()})},"bus configurator.ready:last + $projectSection.ready:last + project.add.success":function(e,t,i,n){this._addToList(i,t.getTemplateFactory().get("board.context.filter.projects.list"),n),i.find("form").trigger("reset"),i.removeClass("tau-managed-category_isempty_true"),this.fire("project.add.completed")
},"bus $projectSection.ready:last + project.add.failure":function(e,t,i){t.find(".i-role-form :text:first").focus().select().addClass("tau-error"),this.fire("error",i)},"bus $projectSection.ready:last + project.add.nonFatalFailure":function(e,t,i){this.fire("error",i)}})}),define("tau/ui/extensions/inviter/ui.extension.inviter.widget.abstract",["Underscore","jQuery","tau/core/extension.base","./jquery.tauInviter"],function(e,t,i){return i.extend({_initTemplates:function(){},_initWidget:function(e,t,i){var n=t.find("[name=users]");n.tauInviter({configurator:e,allowEmails:!0,entityRestriction:i}),t.on("reset",function(){n.tauInviter("reset")})}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.members-widget",["Underscore","jQuery","tau/ui/extensions/inviter/ui.extension.inviter.widget.abstract"],function(e,t,i){return i.extend({"bus configurator.ready":function(e,t){this._initTemplates(t)},"bus configurator.ready + $teamSection.ready":function(e,t,i){i.length&&this._initWidget(t,i)},"bus configurator.ready + $projectSection.ready":function(e,t,i){i.length&&this._initWidget(t,i)}})}),define("tau/ui/templates/finder.project/ui.template.finder.project.abstract",["tau/core/templates-factory","tau/ui/templates/board.context.filter/ui.template.board.context.filter.projects.list","tau/ui/templates/finder.project/ui.template.finder.project.add.form"],function(e){var t={name:"finder.project.abstract",engine:"jqote2",markup:['<div class="tau-team-control">','<div class="tau-actions i-role-tabheaders">','<div class="tau-assign-btn i-role-tabheader <% if (this.activeTab == "assign"){ %> tau-active <% } %>" data-tab="assign">','<span></span><%= (this.assignLabel || "Assign to Project") %>',"</div>","<i>or</i>",'<div class="tau-new-project i-role-tabheader <% if (this.activeTab == "add"){ %> tau-active <% } %>" data-tab="add">',"<span></span>New project","</div>","</div>",'<div class="tau-tab-content">','<div class="tau-tab-pane tau-teams-list <% if (this.showSearch) { %>tau-teams-list_use_filter<% } %> i-role-tab-assign <% if (this.activeTab == "assign"){ %> tau-active <% } %> ">',"<% if (this.showSearch) { %>",'<div class="tau-search-team">','<span class="tau-inline-group tau-search">','<input name="filter" type="text" class="tau-in-text" placeholder="Search Projects" />','<button type="button" class="tau-btn tau-search"></button>',"</span>",'<i class="tau-pointer"></i>',"</div>","<% } %>",'<div class="tau-existing-team-holder">','<div class="tau-existing-team tau-existing-program i-role-section-projects <% if (!this.projects.length) { %>tau-empty<% } %>">','<div class="tau-button-wrap">','<button class="tau-btn tau-primary" role="action-submit" type="button">Assign</button>',"</div>",'<ul class="tau-project-list tau-existing-team-list_cols_3 i-role-list">','<%= fn.sub("board.context.filter.projects.list", this.projects) %>',"</ul>",'<div class="tau-existing-program__message" data-text-nofound="No such project found" data-text-noitems="No available projects"></div>',"</div>","</div>","</div>",'<div class="tau-tab-pane tau-new-entity-holder  i-role-tab-add  <% if (this.activeTab == "add"){ %> tau-active <% } %> ">','<%= fn.sub("finder.project.add.form", this) %>',"</div>","</div>","</div>"]};
return e.register(t)}),define("tau/ui/templates/finder.project/ui.template.finder.project.byProgram",["tau/core/templates-factory","Underscore","tau/ui/templates/finder.project/ui.template.finder.project.abstract"],function(e){var t={name:"finder.project.byProgram",engine:"jqote2",markup:["<% fn.applyOptions(this); %>",'<%= fn.sub("finder.project.abstract", this) %>'],customFunctions:{applyOptions:function(e){var t={assignLabel:"Include Projects"};_.extend(e,t)}}};return e.register(t)}),define("tau/components/component.finder.project.byProgram",["require","tau/components/component.creator","tau/models/finder.project/model.finder.project.byProgram","tau/models/board.context.filter/model.board.context.filter.add.project","tau/models/finder.project/model.finder.project.byEntity.assign","tau/models/finder.project/providers/program.projects.command.factory","tau/ui/extensions/tabs/ui.extension.tabs.modern","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach","tau/ui/extensions/finder.project/ui.extension.finder.project.bubble","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.project","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.members-widget","tau/components/extensions/error/extension.errorBar","tau/ui/templates/finder.project/ui.template.finder.project.byProgram"],function(e){var t=e("tau/components/component.creator"),i=e("tau/models/finder.project/model.finder.project.byProgram"),n=e("tau/models/board.context.filter/model.board.context.filter.add.project"),a=e("tau/models/finder.project/model.finder.project.byEntity.assign"),r=e("tau/models/finder.project/providers/program.projects.command.factory"),s=e("tau/ui/extensions/tabs/ui.extension.tabs.modern"),o=e("tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main"),l=e("tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach"),u=e("tau/ui/extensions/finder.project/ui.extension.finder.project.bubble"),c=e("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter"),d=e("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection"),p=e("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.project"),f=e("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.members-widget"),m=e("tau/components/extensions/error/extension.errorBar"),h=e("tau/ui/templates/finder.project/ui.template.finder.project.byProgram");
return{create:function(e){e["queue.bus"]=!0;var g={"queue.bus":!0,extensions:[i,n,{extType:a,args:[r]},s,o,l,u,c,d,p,f,m],template:h};return t.create(g,e)}}}),define("tau/models/finder.project/model.finder.project.byTeam",["Underscore","tau/core/templates-factory","tau/models/finder.project/model.finder.project.byEntity.abstract"],function(e,t,i){var n=function(e){return e.name.toUpperCase()};return i.extend({resetLifecycle:!0,"bus configurator.ready:last + teamProjects.ready:last + activeTab.ready:last + beforeInit":function(t,i,n,a){var r=i.getStore(),s=e.chain(n).pluck("project").compact().pluck("id").value(),o=[this._getList.bind(this,r,"project",["id","name","color"],s),this._getList.bind(this,r,"process",["id","name","isDefault"],[]),this._getPrograms.bind(this,r)];this._getAvailableEntities(o,a)},_getStoreOnRefreshConfig:function(){return{eventName:"afterSave",type:"team",listener:this,hasChanges:["teamProjects"]}},_getAssignedEntities:function(e,t){var i=this;e.get("team",{id:t.id,fields:[{teamProjects:[{project:["id","name"]}]}]}).done({success:function(e){i.fire("teamProjects.ready",e[0].data.teamProjects)}})},_getDefaultProgram:function(){var e=t.termProcessor.getTerm("Program","name");return{id:-1,name:"No "+e}},_getPrograms:function(t,i){t.get("program",{fields:["id","name"]}).done(function(t){var a=e.sortBy(t[0].data,n);a.length&&a.unshift(this._getDefaultProgram()),i(!1,a)}.bind(this))}})}),define("tau/models/finder.project/providers/team.projects.command.factory",{create:function(e,t){var i=_.map(t,function(e){return{project:{id:e}}});return{evictProperties:[e.id,e.entityType.name,["teamProjects"]],type:"team",data:{id:e.id,fields:["id","teamProjects"],$set:{teamProjects:i}}}}}),define("tau/ui/templates/finder.project/ui.template.finder.project.byTeam",["tau/core/templates-factory","tau/ui/templates/finder.project/ui.template.finder.project.abstract"],function(e){var t={name:"finder.project.byTeam",engine:"jqote2",markup:['<%= fn.sub("finder.project.abstract", this) %>']};
return e.register(t)}),define("tau/components/component.finder.project.byTeam",["tau/components/component.creator","tau/models/finder.project/model.finder.project.byTeam","tau/models/board.context.filter/model.board.context.filter.add.project","tau/models/finder.project/model.finder.project.byEntity.assign","tau/models/finder.project/providers/team.projects.command.factory","tau/ui/extensions/tabs/ui.extension.tabs.modern","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach","tau/ui/extensions/finder.project/ui.extension.finder.project.bubble","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.project","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.members-widget","tau/components/extensions/error/extension.errorBar","tau/ui/templates/finder.project/ui.template.finder.project.byTeam"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m){return{create:function(h){h["queue.bus"]=!0;var g={"queue.bus":!0,extensions:[t,i,{extType:n,args:[a]},r,s,o,l,u,c,d,p,f],template:m};return e.create(g,h)}}}),define("tau/models/finder.project/model.finder.project.byUser",["Underscore","tau/core/extension.base","tau/configurations/project.colors"],function(e,t,i){return t.extend({resetLifecycle:!0,"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i),t.config.context.entity.type=t.config.context.entity.entityType.name.toLowerCase(),this.fire("entity.ready",t.config.context.entity)},"bus configurator.ready + entity.ready":function(t,i,n){var a=i.getStore(),r=e.bind(function(e){"removeFromList"==e.data.cmd.name&&this.fire("refresh")},this);i.getGlobalBus().on("teamsAndUsers.connected",function(){a.evictProperties(n.id,n.entityType.name,["projectMembers"]),this.fire("refresh")
},this),a.unbind(this),a.on({eventName:"afterSave",type:"project",listener:this},r)},"bus configurator.ready:last + projectMembers.ready:last + activeTab.ready:last + beforeInit":function(t,n,a,r){var s=this,o=n.getStore(),l=[];l.push(e.bind(this._getList,this,o,"project",["id","name","color"],e.pluck(e.compact(e.pluck(a,"project")),"id"))),e.parallel(l,function(e,t){var n=t[0];s.fire("dataBind",{activeTab:r,teams:[],showProjects:!1,canAddProjects:!1,projects:n,canAddprojects:!0,submitLabel:"Assign",showEmpty:!0,showSearch:n.length>20,colors:i})})},_getList:function(t,i,n,a,r){t.get(i,{fields:n}).done({success:function(t){var i=t[0].data;i=e.filter(i,function(t){return-1==e.indexOf(a,t.id)}),i=e.sortBy(i,function(e){return e.name.toUpperCase()}),r(!1,i)}})},"bus configurator.ready:last + entity.ready":function(e,t,i){var n=this;t.getStore().get(i.type,{id:i.id,fields:[{projectMembers:[{project:["id","name"]}]}]}).done({success:function(e){n.fire("projectMembers.ready",e[0].data.projectMembers)}})},"bus configurator.ready:last + entity.ready:last + form.submitted":function(t,i,n,a){var r=this,s=i.getStore(),o=[];e.forEach(a.projectIds,function(e){o.push({id:e,type:"project",fields:["id","projectMembers"],data:{projectMembers:[{user:{id:n.id}}]}})});var l=[];e.forEach(o,function(e){l.push(function(t){s.save(e.type,{id:e.id,fields:e.fields,$set:e.data}).done({success:function(e){t(!1,e[0].data)}})})}),e.parallel(l,function(e,t){t.length&&i.getGlobalBus().fire("projectsAndUsers.connected",t),r.fire("refresh")})},"bus configurator.ready:last + destroy":function(e,t){t.getGlobalBus().unbind(this),t.getStore().unbind(this)}})}),define("tau/ui/templates/finder.project/ui.template.finder.project.byUser",["tau/core/templates-factory","tau/ui/templates/board.context.filter/ui.template.board.context.filter.projects.list"],function(e){var t={name:"finder.project.byUser",engine:"jqote2",markup:["<div>",'<div class="tau-actions i-role-tabheaders">','<div class="tau-assign-btn i-role-tabheader <% if (this.activeTab == "assign"){ %> tau-active <% } %>" data-tab="assign">',"<span></span>Assign to Project","</div>","</div>",'<div class="tau-tab-content">','<div class="tau-tab-pane  tau-projects-list <% if (this.showSearch) { %>tau-teams-list_use_filter<% } %> i-role-tab-assign <% if (this.activeTab == "assign"){ %> tau-active <% } %> ">',"<% if (this.showSearch) { %>",'<div class="tau-search-team">','<span class="tau-inline-group tau-search">','<input name="filter" type="text" class="tau-in-text" placeholder="Search Projects" tabindex="-1" />','<button type="button" class="tau-btn tau-search"></button>',"</span>",'<i class="tau-pointer"></i>',"</div>","<% } %>",'<div class="tau-existing-project-holder">','<div class="tau-existing-project i-role-section-projects <% if (!this.projects.length) { %>tau-empty<% } %>">','<div class="tau-button-wrap">','<button class="tau-btn tau-primary" role="action-submit" type="button">Assign</button>',"</div>",'<ul class="tau-project-list i-role-list">','<%= fn.sub("board.context.filter.projects.list", this.projects) %>',"</ul>",'<div class="tau-existing-project__message" data-text-nofound="No such project found" data-text-noitems="No available projects"></div>',"</div>","</div>","</div>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.finder.project.byUser",["tau/components/component.creator","tau/models/finder.project/model.finder.project.byUser","tau/ui/extensions/tabs/ui.extension.tabs.modern","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach","tau/ui/extensions/finder.project/ui.extension.finder.project.bubble","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/components/extensions/error/extension.errorBar","tau/ui/templates/finder.project/ui.template.finder.project.byUser"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){c["queue.bus"]=!0;var d={"queue.bus":!0,extensions:[t,i,n,a,r,s,o,l],template:u};return e.create(d,c)}}}),define("tau/models/finder.requesters/model.finder.requesters.search",["Underscore","tau/core/class","tau/core/model-base"],function(e,t,i){var n=t.extend({init:function(){this._collection=null,this._parameters=[],this._values={},this._fields=[],this._page=1,this._onPage=10,this._orderBy=null,this._orderDir="asc"},setFields:function(e){this._fields=e},setCollection:function(e){this._collection=e},registerParameters:function(t){this._parameters=e.toArray(t)},setParameter:function(t,i){if(-1==e.indexOf(this._parameters,t))throw new Error('No "'+t+'" parameter for query');this._values[t]=i},setOnPage:function(e){this._onPage=e},setPage:function(e){this._page=e||1},setOrderBy:function(e){this._orderBy=e},setOrderDir:function(e){this._orderDir=e},create:function(){var e={};e.collection=this.createCollection();var t={};t.fields=this._fields,t.$query=this.createWhere();var i=this.createPaging();t.$skip=i.skip,t.$limit=i.limit;var n="asc"==this._orderDir?"$orderBy":"$orderByDesc";return t[n]=this.createOrderBy(),e.request=t,e},createCollection:function(){return this._collection
},createWhere:function(){var t={};return e.forEach(this._values,function(e,i){t[i]=e}),t},createOrderBy:function(){return this._orderBy||"id"},createPaging:function(){var e={limit:this._onPage,skip:0};return e.skip=(this._page-1)*this._onPage,e}}),a=n.extend({init:function(){this._super(),this.registerParameters(["name","email","type","projectId","companyId","action"])},createCollection:function(){var e=this._super();if(this._values.type){var t=this._values.type;"User"==t?e="User":"Requester"==t&&(e="Requester")}return this._values.companyId&&(e="Requester"),e},createWhere:function(){var e={};return this._values.type||(e.kind={$in:["User","Requester"]}),e.isActive=1,e.deleteDate={$isNull:!0},"reset"==this._values.action?e:(void 0!==this._values.name&&(e.lastName={$contains:this._values.name}),void 0!==this._values.email&&(e.email={$contains:this._values.email}),this._values.companyId&&"Requester"==this.createCollection()&&(e["company.id"]=this._values.companyId),e)}}),r=t.extend({init:function(e){this.items=e.data;var t=e.command,i=e.data.length;this.paging={start:t.config.$skip,end:t.config.$skip+i,count:i,hasNext:e.data.isNextPageAvailable()}}}),s=i.extend({"bus beforeInit":function(e){this.config=e.data.config;var t=this.config.store,i=this,n=this.config.actions||[];this.config.emptyDataMessage=this.config.emptyDataMessage||"No data found",t.get("company",{fields:["id","name"]}).done({success:function(e){i.fire("dataBind",{actions:n,result:null,filter:{companies:e[0].data}})}});var r=new a;r.setCollection("generalUser"),r.setOnPage(15),r.setFields(["id","firstName","lastName","email","login"]),r.setOrderBy("id"),r.setOrderDir("desc"),this.builder=r,i.fire("search.parametersBound",{parameters:{}})},"bus search.readyToExecute":function(){var e=this.builder.create(),t=this;this.config.store.find(e.collection,e.request).done({success:function(e){var i=new r(e[0]);t.fire("search.completed",{result:i})}})},"bus search.completed":function(e){this.fire("result.ready",{data:{result:e.data.result}})
},"bus search.parametersBound":function(t){var i=t.data.parameters,n=this.builder;e.forEach(i,function(e,t){e?n.setParameter(t,e):n.setParameter(t,void 0)}),n.setPage(0),this.fire("search.readyToExecute")},"bus search.pagingBound":function(){var e=this.builder;e.setPage(e._page+1),this.fire("search.readyToExecute")},"bus search.orderBound":function(e){var t=this.builder;t.setOrderBy(e.data.value),t.setOrderDir(e.data.dir),t.setPage(1),this.fire("search.readyToExecute")}});return s}),define("tau/models/finder.requesters/model.finder.requesters.add",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterInit:last + entitySelected":function(e,t,i){var n=i.entity,a=t.config.context.configurator.getStore(),r=t.config.context.entity;a.save(r.entityType.name,{id:r.id,$set:{requesters:[{id:n.id}]},fields:["id"]}).done({success:function(){}})}})}),define("tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.list",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(e,t,i){return i.extend({"bus afterRender":function(e){var t=e.data.element;this.$list=t.find("[role=list]");var i=t.find("[role=list-placeholder]");this.$listPlaceholder=i,this.first=!0,this.$listPlaceholder.listSelectable({items:"[role=option]",className:"tau-result-list-row_hover",inner:"table",keyboardManager:this.config.context.configurator.getKeyBoardManager()}),this.attachScrollingEvents(i),this.attachSortingEvents(t.find("[role=list-sorting]")),this.setScrollAvailable(!1),this._signUpOnActionsAndSelection(t)},"bus result.ready":function(e){var t=this.$listPlaceholder,i=t.data("ui-listSelectable")._index;t.listSelectable("disable");var n=e.data.data.result,a=this.config.templateList,r=a.get().bind(this.config,n);0==n.paging.start&&(this.$list.empty(),i=-1,0==n.paging.count&&t.toggleClass("tau-finder__result_state_empty",!0)),this.setScrollAvailable(n.paging.hasNext),r.find("[role=option]").appendTo(this.$list),t.toggleClass("tau-finder__result_state_loading",!1),n.paging.count>0&&t.toggleClass("tau-finder__result_state_empty",!1),t.listSelectable("enable",{saveScroll:!0}),t.data("ui-listSelectable")._index=i,this.first&&(setTimeout(function(){t.scrollTop(0)
},100),this.first=!1)},"bus scroll.reachEnd":function(){this.scrollAvailable&&this.bus.fire("search.pagingBound")},setScrollAvailable:function(e){this.scrollAvailable=e},attachScrollingEvents:function(e){var t=this;e.scroll(function(){e.scrollTop()+e.innerHeight()>=e[0].scrollHeight&&t.bus.fire("scroll.reachEnd")})},attachSortingEvents:function(e){var i=e.find("[role=sorting]"),n=this;e.delegate("[role=sorting]","click",function(){var e="tau-finder__sorttrigger_dir_",a=t(this),r=a.hasClass(e+"desc")?"asc":"desc";i.toggleClass(e+"desc",!1),i.toggleClass(e+"asc",!1),i.toggleClass("tau-finder__sorttrigger_state_active",!1),a.toggleClass(e+r,!0),a.toggleClass("tau-finder__sorttrigger_state_active",!0);var s=a.val();n.bus.fire("search.orderBound",{value:s,dir:r})})},_signUpOnActionsAndSelection:function(e){var i=this;e.delegate("[role=option]","click",function(){var e=t(this),n=e.data("tmplItem");if(n){var a=n.data;a&&i.bus.fire("entitySelected",{entity:a})}})}})}),define("tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.filter",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(i){var n=i.data.element,a=n.find("[role=filter]"),r=a.find(":input"),s=a.find(":button"),o=this;this.state="clear",s.prop("disabled","disabled"),s.addClass("disable"),r.bind("change keyup",function(){o.state="dirty",s.prop("disabled",!1),s.removeClass("disable")});var l=function(i){var n={};r.each(function(){var i=t(this),a=e.trim(i.val());n[i.attr("name")]=a}),n.action=i,o.bus.fire("search.parametersBound",{parameters:n})};r.bind("keydown",function(e){switch(e.keyCode){case t.ui.keyCode.ENTER:l("search"),e.stopPropagation(),e.preventDefault();break;case t.ui.keyCode.DOWN:t(this).is("input")?t(this).blur():(e.stopPropagation(),e.preventDefault())}}),s.eq(0).click(function(){l(t(this).val())}),s.eq(1).click(function(){var i={};r.each(function(){var n=t(this);n.val(null);var a=e.trim(n.val());i[n.attr("name")]=a
}),i.action=t(this).val(),o.bus.fire("search.parametersBound",{parameters:i}),s.prop("disabled","disabled"),s.addClass("disable"),r.filter("[data-autofocus]").focus()});var u=r.filter("[name=companyId]"),c=r.filter("[name=type]"),d=function(){"User"==c.val()?(u.val(null),u.prop("disabled","disabled")):u.prop("disabled",!1)};d(),c.on("change",d)}})}),define("tau/ui/templates/finder.requesters/ui.template.finder.resultList.row",["tau/core/templates-factory"],function(e){var t={name:"finder-requesters-resultList-row",markup:['<tr class="tau-result-list-row" role="option">','<td class="tau-finder__cell tau-finder__cell-name">',"{{if firstName || lastName}}","${firstName} ${lastName}","{{else}}","${email}","{{/if}}","</td>",'<td class="tau-finder__cell tau-finder__cell-email">${email}</td>','<td class="tau-finder__cell tau-finder__cell-login">${login}</td>',"</tr>"]};return e.register(t)}),define("tau/ui/templates/finder.requesters/ui.template.finder.resultList",["tau/core/templates-factory","tau/ui/templates/finder.requesters/ui.template.finder.resultList.row"],function(e){var t={name:"finder-requesters-resultList",markup:['<table class="tau-finder__table">',"<thead>",'<tr role="list-sorting">','<th class="tau-finder__cell tau-finder__cell-name">','<button type="button" class="tau-finder__sorttrigger" role="sorting" value="firstName">Name</button>',"</th>",'<th class="tau-finder__cell tau-finder__cell-email">','<button type="button" class="tau-finder__sorttrigger" role="sorting" value="email">Email</button>',"</th>",'<th class="tau-finder__cell tau-finder__cell-login">','<button type="button" class="tau-finder__sorttrigger" role="sorting" value="login">Login</button>',"</th>","</tr>","</tbody>","</table>",'<div class="ui-resultList tau-finder__result tau-finder__result_state_loading" role="list-placeholder">','<div class="tau-no-results  tau-finder__result__empty">No requesters found.</div>','<table class="tau-finder__table">','<tbody role="list">',"{{if items}}",'{{tmpl(items) "finder-requesters-resultList-row"}}',"{{/if}}","</tbody>","</table>",'<div class="tau-resultList-load-more tau-finder__result__loader">loading users...</div>',"</div>"],dependencies:["finder-requesters-resultList-row"]};
return e.register(t)}),define("tau/ui/templates/finder.requesters/ui.template.finder.action",["tau/core/templates-factory"],function(e){var t={name:"finder-requesters-action",markup:["<span id='${id}' class='action-link tau-finder-action'>${name}</span>"]};return e.register(t)}),define("tau/ui/templates/finder.requesters/ui.template.finder.filter",["tau/core/templates-factory"],function(e){var t={name:"finder-requesters-filter",markup:['<div class="ui-form">','<div class="ui-form__group">','<div class="ui-form__cols">','<label for="name">Last Name</label>','<input type="text" name="name" />',"</div>",'<div class="ui-form__cols">','<label for="email">Email</label>','<input data-autofocus type="text" name="email" />',"</div>","</div>",'<div class="ui-form__group">','<div class="ui-form__cols">','<label for="type">User Type</label>','<select name="type">','<option value="">All</option>','<option value="Requester">Requesters</option>','<option value="User">Users</option>',"</select>","</div>",'<div class="ui-form__cols">','<label for="type">Company</label>','<select name="companyId">','<option value="">All</option>',"{{each(i, company) filter.companies}}",'<option value="${company.id}">${company.name}</option>',"{{/each}}","</select>","</div>","</div>",'<div class="ui-form__group">','<div class="ui-form__row ui-form__row-controls button-group">','<button type="button" name="action" value="search" class="button" >Filter</button>','<button type="button" name="action" value="reset" class="button" >Clear</button>',"</div>","</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/finder.requesters/ui.template.finder",["tau/core/templates-factory","tau/ui/templates/finder.requesters/ui.template.finder.resultList","tau/ui/templates/finder.requesters/ui.template.finder.action","tau/ui/templates/finder.requesters/ui.template.finder.filter"],function(e){var t={name:"finder-requesters",markup:['<div class="ui-finder-placeHolder">','<div class="ui-finder-header">','<div class="visual-search ui-drop-down" role="filter">','{{tmpl() "finder-requesters-filter"}}',"</div>","</div>",'{{tmpl(result) "finder-requesters-resultList"}}',"</div>"],dependencies:["finder-requesters-resultList","finder-requesters-action","finder-requesters-filter"]};
return e.register(t)}),define("tau/components/component.finder.requesters",["tau/components/component.creator","tau/models/finder.requesters/model.finder.requesters.search","tau/models/finder.requesters/model.finder.requesters.add","tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.list","tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.filter","tau/ui/templates/finder.requesters/ui.template.finder","tau/ui/templates/finder.requesters/ui.template.finder.resultList"],function(e,t,i,n,a,r,s){return{create:function(o){var l={name:"finder",extensions:[t,i,n,a],template:r};return o.templateList=s,e.create(l,o)}}}),define("tau/models/finder.team/model.finder.team.byProject",["Underscore","tau/core/extension.base","tau/configurations/team.icons"],function(e,t,i){return t.extend({resetLifecycle:!0,"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i),t.config.context.entity.type=t.config.context.entity.entityType.name.toLowerCase(),this.fire("entity.ready",t.config.context.entity)},"bus configurator.ready + entity.ready":function(t,i,n){var a=i.getStore(),r=e.bind(this.fire,this,"refresh");a.unbind(this),a.on({eventName:"afterSave",type:n.type,listener:this,hasChanges:["teamProjects"]},r)},"bus configurator.ready:last + teamProjects.ready:last + activeTab.ready:last + beforeInit":function(t,n,a,r){var s=this,o=n.getStore(),l=[];l.push(e.bind(this._getList,this,o,"team",["id","name","icon"],e.pluck(e.compact(e.pluck(a,"team")),"id"))),e.parallel(l,function(e,t){var n=t[0];s.fire("dataBind",{activeTab:r,projects:[],showProjects:!1,canAddProjects:!1,teams:n,canAddTeams:!0,submitLabel:"Assign",showEmpty:!0,showSearch:n.length>20,icons:i})})},_getList:function(t,i,n,a,r){t.get(i,{fields:n}).done({success:function(t){var i=t[0].data;i=e.filter(i,function(t){return-1==e.indexOf(a,t.id)}),i=e.sortBy(i,function(e){return e.name.toUpperCase()}),r(!1,i)}})},"bus configurator.ready:last + entity.ready":function(e,t,i){var n=this;
t.getStore().get(i.type,{id:i.id,fields:[{teamProjects:[{team:["id","name"]}]}]}).done({success:function(e){n.fire("teamProjects.ready",e[0].data.teamProjects)}})},"bus configurator.ready:last + destroy":function(e,t){var i=t.getStore();i.unbind(this)}})}),define("tau/models/board.context.filter/model.board.context.filter.add.team",["Underscore","tau/core/extension.base","tau/libs/inviter/inviter"],function(e,t,i){return t.extend({"bus configurator.ready:last + team.add.ready":function(t,n,a){var r=this,s=n.getStore();s.save("team",{failureGlobal:!1,$set:{name:e.trim(a.name),icon:e.trim(e.asString(a.icon))||null}},{success:function(e){r.fire("team.saved",e.data)},failure:function(e){r.fire("team.add.failure",e.data.response.Message)}}).done();var o=new i(n);o.invite(a.members).done(function(e){r.fire("teamMembers.saved",e)})},"bus configurator.ready:last + team.add.ready + team.saved + teamMembers.saved":function(t,i,n,a,r){var s=this,o=i.getStore(),l=e.compact(e.pluck(r,"success")),u=e.compact(e.pluck(r,"failure"));if(u.length){var c="Can't assign users.";this.fire("team.add.nonFatalFailure",c)}l=e.filter(l,function(e){return e!=i.getLoggedUser().id});var d={teamMembers:e.map(l,function(e){return{user:{id:e}}})};o.save("team",{id:a.id,$set:d,fields:["id","name","icon",{teamMembers:[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}]}]}).done(function(e){s.fire("teamMembers.connected",e[0].data)})},"bus team.saved + teamMembers.saved + teamMembers.connected":function(e,t,i,n){this.fire("team.add.success",n)}})}),define("tau/models/finder.team/model.finder.team.byProject.connect",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready:last + entity.ready:last + form.submitted":function(t,i,n,a){var r=this,s=i.getStore(),o=[],l=[];e.forEach(a.teamIds,function(e){l.push({team:{id:e}})}),o.push({id:n.id,type:n.type,fields:["id","teamProjects"],data:{teamProjects:l}});var u=[function(e){s.evictProperties(n.id,n.type,["teamProjects"]),e()
}];e.forEach(o,function(e){u.push(function(t){s.save(e.type,{id:e.id,fields:e.fields,$set:e.data}).done({success:function(e){t(!1,e[0].data)}})})}),e.parallel(u,function(){r.fire("refresh")})},"bus configurator.ready:last + entity.ready:last + team.add.success":function(t,i,n,a){var r=this,s=i.getStore(),o=[];o.push({id:n.id,type:n.type,fields:["id","teamProjects"],data:{teamProjects:[{team:{id:a.id}}]}});var l=[function(e){s.evictProperties(n.id,n.type,["teamProjects"]),e()}];e.forEach(o,function(e){l.push(function(t){s.save(e.type,{id:e.id,fields:e.fields,$set:e.data}).done({success:function(e){t(!1,e[0].data)}})})}),e.parallel(l,function(){r.fire("refresh")})}})}),define("tau/ui/extensions/finder.team/ui.extension.finder.team.bubble",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus configurator.ready + $el.ready":function(e,i,n){var a=n,r=n;this.fire("$list.ready",r),this.fire("$bubbled.ready",a),this.fire("$popup.ready",r),this.fire("$teamSection.ready",n),this.fire("$projectSection.ready",t()),this.fire("$sections.ready",n)}})}),define("tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.team",["Underscore","jQuery","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.abstract"],function(e,t,i){return i.extend({"bus $teamSection.ready":function(e,t){var i=this,n=this._initForm(t);this._addSubmitDataListener(n,function(e){i.fire("team.add.ready",e)});var a=n.find("select"),r=this._initRichSelect(n,a);r.on("change",function(e,t){var i=r.attr("data-value");r.removeClass("tau-icon_name_"+i),r.addClass("tau-icon_name_"+(t||"default"))})},"bus configurator.ready:last + $teamSection.ready:last + team.add.success":function(e,t,i,n){this._addToList(i,t.getTemplateFactory().get("board.context.filter.teams.list"),n),i.find("form").trigger("reset"),i.removeClass("tau-managed-category_isempty_true"),this.fire("team.add.completed")},"bus $teamSection.ready:last + team.add.failure":function(e,t,i){t.find(".i-role-form :text:first").focus().select().addClass("tau-error"),this.fire("error",i)
},"bus $teamSection.ready:last + team.add.nonFatalFailure":function(e,t,i){this.fire("error",i)}})}),define("tau/ui/templates/finder.team/ui.template.finder.team",["tau/core/templates-factory","tau/ui/templates/board.context.filter/ui.template.board.context.filter.teams.list","tau/ui/templates/finder.team/ui.template.finder.team.add.form"],function(e){var t={name:"finder.team",engine:"jqote2",markup:['<div class="tau-team-control">','<div class="tau-actions i-role-tabheaders">','<div class="tau-assign-btn i-role-tabheader <% if (this.activeTab == "assign"){ %> tau-active <% } %>" data-tab="assign">',"<span></span>Assign to Team","</div>","<i>or</i>",'<div class="tau-new-team i-role-tabheader <% if (this.activeTab == "add"){ %> tau-active <% } %>" data-tab="add">',"<span></span>New team","</div>","</div>",'<div class="tau-tab-content">','<div class="tau-tab-pane tau-teams-list <% if (this.showSearch) { %>tau-teams-list_use_filter<% } %> i-role-tab-assign <% if (this.activeTab == "assign"){ %> tau-active <% } %> ">',"<% if (this.showSearch) { %>",'<div class="tau-search-team">','<span class="tau-inline-group tau-search">','<input name="filter" type="text" class="tau-in-text" placeholder="Search Teams" />','<button type="button" class="tau-btn tau-search"></button>',"</span>",'<i class="tau-pointer"></i>',"</div>","<% } %>",'<div class="tau-existing-team-holder">','<i class="tau-pointer"></i>','<div class="tau-existing-team i-role-section-teams <% if (!this.teams.length) { %>tau-empty<% } %>">','<div class="tau-button-wrap">','<button class="tau-btn tau-primary" role="action-submit" type="button">Assign</button>',"</div>",'<ul class="tau-existing-team-list tau-existing-team-list_cols_3 i-role-list">','<%= fn.sub("board.context.filter.teams.list", this.teams) %>',"</ul>",'<div class="tau-existing-team__message" data-text-nofound="No such team found" data-text-noitems="No available teams"></div>',"</div>","</div>","</div>",'<div class="tau-tab-pane tau-new-entity-holder  i-role-tab-add  <% if (this.activeTab == "add"){ %> tau-active <% } %> ">','<%= fn.sub("finder.team.add.form", this) %>',"</div>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.finder.team.byProject",["tau/components/component.creator","tau/models/finder.team/model.finder.team.byProject","tau/models/board.context.filter/model.board.context.filter.add.team","tau/models/finder.team/model.finder.team.byProject.connect","tau/ui/extensions/tabs/ui.extension.tabs.modern","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach","tau/ui/extensions/finder.team/ui.extension.finder.team.bubble","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.team","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.members-widget","tau/components/extensions/error/extension.errorBar","tau/ui/templates/finder.team/ui.template.finder.team"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return{create:function(m){m["queue.bus"]=!0;var h={"queue.bus":!0,extensions:[t,i,n,a,r,s,o,l,u,c,d,p],template:f};return e.create(h,m)}}}),define("tau/models/finder.team/model.finder.team.byUser",["Underscore","tau/core/extension.base","tau/configurations/team.icons"],function(e,t,i){return t.extend({resetLifecycle:!0,"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i),t.config.context.entity.type=t.config.context.entity.entityType.name.toLowerCase(),this.fire("entity.ready",t.config.context.entity)},"bus configurator.ready + entity.ready":function(t,i){var n=i.getStore(),a=e.bind(function(e){"removeFromList"==e.data.cmd.name&&this.fire("refresh")},this);n.unbind(this),n.on({eventName:"afterSave",type:"team",listener:this},a)},"bus configurator.ready:last + teamMembers.ready:last + activeTab.ready:last + beforeInit":function(t,n,a,r){var s=this,o=n.getStore(),l=[];
l.push(e.bind(this._getList,this,o,"team",["id","name","icon"],e.pluck(e.compact(e.pluck(a,"team")),"id"))),e.parallel(l,function(e,t){var n=t[0];s.fire("dataBind",{activeTab:r,projects:[],showProjects:!1,canAddProjects:!1,teams:n,canAddTeams:!0,submitLabel:"Assign",showEmpty:!0,showSearch:n.length>20,icons:i})})},_getList:function(t,i,n,a,r){t.get(i,{fields:n}).done({success:function(t){var i=t[0].data;i=e.filter(i,function(t){return-1==e.indexOf(a,t.id)}),i=e.sortBy(i,function(e){return e.name.toUpperCase()}),r(!1,i)}})},"bus configurator.ready:last + entity.ready":function(e,t,i){var n=this;t.getStore().get(i.type,{id:i.id,fields:[{teamMembers:[{team:["id","name"]}]}]}).done({success:function(e){n.fire("teamMembers.ready",e[0].data.teamMembers)}})},"bus configurator.ready:last + entity.ready:last + form.submitted":function(t,i,n,a){var r=this,s=i.getStore(),o={id:n.id,fields:["id",{teamMembers:[{user:["id"]}]}],$set:{teamMembers:[]}};e.forEach(a.teamIds,function(e){o.$set.teamMembers.push({team:{id:e}})}),s.save(n.entityType.name,o).done({success:function(e){e.length&&e[0].data.teamMembers.length&&i.getGlobalBus().fire("teamsAndUsers.connected",e[0].data.teamMembers),r.fire("refresh")}})},"bus configurator.ready:last + destroy":function(e,t){var i=t.getStore();i.unbind(this)}})}),define("tau/ui/templates/finder.team.byUser/ui.template.finder.team.byUser",["tau/core/templates-factory","tau/ui/templates/board.context.filter/ui.template.board.context.filter.teams.list"],function(e){var t={name:"finder.team.byUser",engine:"jqote2",markup:["<div>",'<div class="tau-actions i-role-tabheaders">','<div class="tau-assign-btn i-role-tabheader <% if (this.activeTab == "assign"){ %> tau-active <% } %>" data-tab="assign">',"<span></span>Assign to Team","</div>","</div>",'<div class="tau-tab-content">','<div class="tau-tab-pane tau-teams-list <% if (this.showSearch) { %>tau-teams-list_use_filter<% } %> i-role-tab-assign <% if (this.activeTab == "assign"){ %> tau-active <% } %> ">',"<% if (this.showSearch) { %>",'<div class="tau-search-team">','<span class="tau-inline-group tau-search">','<input name="filter" type="text" class="tau-in-text" placeholder="Search Teams" />','<button type="button" class="tau-btn tau-search"></button>',"</span>",'<i class="tau-pointer"></i>',"</div>","<% } %>",'<div class="tau-existing-team-holder">','<div class="tau-existing-team i-role-section-teams <% if (!this.teams.length) { %>tau-empty<% } %>">','<div class="tau-button-wrap">','<button class="tau-btn tau-primary" role="action-submit" type="button">Assign</button>',"</div>",'<ul class="tau-existing-team-list i-role-list">','<%= fn.sub("board.context.filter.teams.list", this.teams) %>',"</ul>",'<div class="tau-existing-team__message" data-text-nofound="No such team found" data-text-noitems="No available teams"></div>',"</div>","</div>","</div>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.finder.team.byUser",["tau/components/component.creator","tau/models/finder.team/model.finder.team.byUser","tau/ui/extensions/tabs/ui.extension.tabs.modern","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.main","tau/ui/extensions/finder.projectAndTeam/ui.extension.finder.projectAndTeam.attach","tau/ui/extensions/finder.team/ui.extension.finder.team.bubble","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.filter","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.selection","tau/components/extensions/error/extension.errorBar","tau/ui/templates/finder.team.byUser/ui.template.finder.team.byUser"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){c["queue.bus"]=!0;var d={"queue.bus":!0,extensions:[t,i,n,a,r,s,o,l],template:u};return e.create(d,c)}}}),define("tau/models/model.finish-iteration",["jQuery","Underscore","tau/core/model-base","tau/utils/utils.date","tau/core/termProcessor","tau/models/dataprocessor/model.processor.context"],function(e,t,i,n,a,r){return i.extend({init:function(){this.name="Finish Iteration",this._super.apply(this,arguments)},onInit:function(){var e=this.config.context.entity,i={iteration:"project",teamiteration:"team"},n=i[e.type];if(!n)throw"It's only possible to use only iterations and team iterations here. Actual "+e.type;var a={};a[n]=["id"],this._getContext(this.config.context.configurator,e).done(function(i){this.store.get(e.type,{id:e.id,fields:["id","name","startDate","endDate",a]},{scope:this,success:t.bind(this.onIterationRetrieved,this,n,i)}).done()}.bind(this))},_getContext:function(t,i){var n=e.Deferred();return t.getApplicationContextService().getApplicationContext({ids:[i.id]},{success:function(e){var t=r({applicationContext:e}),i=new a(t.getTerms());n.resolve(i)}}),n},"bus beforeInit:last + finishIteration":function(e,i,n){var a=i.config.context.configurator,r=a.getActionsService();this.fire("beforeFinishIteration");
var s={iteration:"finishIteration",teamIteration:"finishTeamIteration"},o=s[n.type];if(!o)throw"It's only possible to use only iterations and team iterations here. Actual "+n.type;r[o](n.from,n.to,n.useMoveInsteadSplit,t.bind(this._finishIsSuccessful,this),t.bind(this._finishIsFailed,this))},_finishIsSuccessful:function(){this.fire("iterationIsFinished",{successful:!0})},_finishIsFailed:function(t){var i=e.parseJSON(t.responseText).Message;this.fire("iterationIsFinished",{successful:!1,reason:i})},_convertIterationDates:function(e){return e.startDate=n.convertToTimezone(e.startDate),e.endDate=n.convertToTimezone(e.endDate),e},onIterationsRetrieved:function(e,i,n){var a=t(n.data).chain().map(this._convertIterationDates).sortBy(function(e){return+e.startDate}).value();this.fire("dataBind",{iteration:this._convertIterationDates(e),iterations:a,termProcessor:i})},onIterationRetrieved:function(e,i,n){var a=n.data,r={};r[e+".id"]={$eq:a[e].id},r.id={$ne:a.id},this.store.find(a.__type,{fields:["id","name","startDate","endDate"],$query:r,$orderBy:"startDate"},{scope:this,success:t.bind(this.onIterationsRetrieved,this,a,i)}).done()}})}),define("tau/components/extensions/finishIteration/extension.finish-iteration",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus dataBind":function(e,t){t.iterations.length<1&&(this.config.context.configurator.service("errorBar").fire("error",{message:"There're no other iterations, so you can't move the work that is not finished"}),this._close(t))},"bus afterRender + dataBind":function(t,i,n){var a=i.element,r=a.find("#tau-submit-finish-iteration");r.on("click",e.bind(function(e){e.preventDefault(),this._finishIteration(n.iteration,a),r.prop("disabled",!0),a.find(".tau-loader").show()},this))},"bus afterRender + dataBind + iterationIsFinished":function(e,t,i,n){t.element.find("#tau-submit-finish-iteration").prop("disabled",!1),t.element.find(".tau-loader").hide();var a=this.config.context.configurator.service("errorBar");
if(n.successful){var r=i.iteration.name+" is finished";a.fire("notification",{message:r})}else a.fire("error",{message:n.reason});this._close(i.iteration)},_close:function(e){var t=e.id,i=this.config.context.configurator,n=i.getHistory();i.service("navigator").back(!1),n.exclude(t)},_finishIteration:function(e,t){var i={};i.type=e.__type,i.from=e.id,i.to=parseInt(t.find("#to-iteration").val(),10),i.useMoveInsteadSplit="true"===t.find("[name=tau-finish-by-move]:checked").val(),this.fire("finishIteration",i)}})}),define("tau/ui/templates/board.actions/ui.template.board.actions.finish-iteration.fn",["tau/utils/utils.date","tau/ui/ui.templateFactory"],function(e){return{iterationName:function(e){return e.name+" ("+this.processDates(e.startDate,e.endDate)+")"},processDates:function(t,i){var n=t.getYear()==i.getYear()?"d-MMM":e.getFormatData().date.short;return e.formatAs(t,n)+" &mdash; "+e.formatAs(i,n)}}}),define("template!tau/ui/templates/board.actions/ui.template.board.actions.finish-iteration",["tau/core/templates-factory","./ui.template.board.actions.finish-iteration.fn"],function(e,t){var i={name:"ui.template.board.actions.finish-iteration",engine:"jqote2",customFunctions:t,markup:'<div class="tau-finish-message"> <% var userStory = this.termProcessor.getTerm(\'UserStory\', \'name\'); var userStories = this.termProcessor.getTerm(\'UserStory\', \'names\'); var iteration = this.termProcessor.getTerm(\'Iteration\', \'name\'); var bug = this.termProcessor.getTerm(\'Bug\', \'name\'); var bugs = this.termProcessor.getTerm(\'Bug\', \'names\'); %> <h2>Finish <%= iteration %></h2> <div> <div class="tau-message tau-error"> This action may affect <%! userStories %> and <%! bugs %> assigned to <%! iteration %>. Use Finish <%! iteration %> with care. </div> </div> <div class="tau-iterations"> <div class="tau-item tau-finish-iteration"> <span class="tau-txt">Finish <%! iteration.toLowerCase() %>:</span> <div class="tau-iteration-name"><strong><%=this.iteration.name %></strong></div> </div> <div class="tau-item"> <span class="tau-txt tau-next-iteration">Next <%! iteration.toLowerCase() %>:</span> <div class="tau-iteration-name"> <select id="to-iteration" class="tau-select"> <% var alreadyPreSelected = false; for (var i = 0; i < this.iterations.length; i++) { var iter = this.iterations[i], selectedAttr = false; if (!alreadyPreSelected) { selectedAttr = alreadyPreSelected = iter.startDate > this.iteration.startDate; } %> <option value="<%= iter.id %>" <%= fn.cond(selectedAttr, "selected") %>><%= fn.iterationName(iter) %></option> <% } %> </select> </div> </div> </div> <div class="tau-actions"> <div class="tau-item"> <div class="tau-action-name"> <input name="tau-finish-by-move" id="tau-finish-by-slit" checked="checked" type="radio" value="false"><label for="tau-finish-by-slit">Split <%! userStories %></label> </div> <ul class="tau-action-list"> <li>Move the <span class="tau-entity-icon tau-entity-icon--userstory"><%! userStories %></span> that haven&apos;t been started to the next <%! iteration %> </li> <li>Split started but not finished <span class="tau-entity-icon tau-entity-icon--userstory"><%! userStories %></span>. The Completed tasks will remain in the old <%! userStory %>, all the rest will be moved to the next <%! iteration %> as a part of the new <%! userStory %> </li> <li>Move all the incomplete <span class="tau-entity-icon tau-entity-icon--bug"><%! bugs %></span> and <span class="tau-entity-icon tau-entity-icon--testplanrun">Test Plan Runs</span> to the next <%! iteration %> </li> <li>Set the correct <%! iteration %> velocity</li> </ul> </div> <div class="tau-item"> <div class="tau-action-name"> <input name="tau-finish-by-move" id="tau-finish-by-move" type="radio" value="true"><label for="tau-finish-by-move">Move <%! userStories %></label> </div> <ul class="tau-action-list"> <li>Move all the incomplete <span class="tau-entity-icon tau-entity-icon--userstory"><%! userStories %></span>, <span class="tau-entity-icon tau-entity-icon--bug"><%! bugs %></span> and <span class="tau-entity-icon tau-entity-icon--userstory">Test Plan Runs</span> to the next <%! iteration %> </li> <li>Set the correct <%! iteration %> velocity</li> </ul> </div> </div> <div class="tau-btn-wrap"> <button id="tau-submit-finish-iteration" class="tau-btn tau-primary tau-btn-big">Finish</button> <div class="tau-loader" style="display: none;"></div> </div> </div>'};
return e.register(i)}),define("tau/components/component.finish-iteration",["tau/components/component.creator","tau/models/model.finish-iteration","tau/components/extensions/finishIteration/extension.finish-iteration","template!tau/ui/templates/board.actions/ui.template.board.actions.finish-iteration"],function(e,t,i,n){return{create:function(a){var r=a||{},s={extensions:[t,i],template:n};return e.create(s,r)}}}),define("template!tau/components/followButton/templates/followButton.template",["tau/core/templates-factory"],function(e){var t={name:"followButton",engine:"jqote2",customFunctions:null,markup:'<div class="i-role-views-followButton tau-follow-link hidden"><i class="tau-icon-general tau-icon-follow"></i></div> <i class="tau-icon-general tau-icon-warning"></i>'};return e.register(t)}),define("tau/components/followButton/extensions/followButton.extension",["require","tau/core/extension.base"],function(e){var t=e("tau/core/extension.base"),i="Follow this entity and receive email notifications with all important updates",n="Stop following this entity and receiving email notifications of its updates";return t.extend({"bus afterInit":function(){this.fire("dataBind"),this.isEmailNotificationsDisabled=!1},"bus afterRender + followButton.config.ready":function(e,t,i){var n=t.element.filter(".i-role-views-followButton"),a=n.next().tauBubble({content:"<span>Email Notifications are disabled in System Settings</span>",zIndex:999,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),className:"tau-bubble-tooltip",showEvent:"mouseenter",hideEvent:"mouseleave mousedown",mode:"tooltip",stackName:"tooltip",delay:500}),r=i.model;i.configurator.getGlobalSettingsService().getGlobalSettings().then(function(e){e.IsEmailNotificationsEnabled||(this.isEmailNotificationsDisabled=!0,this._setWarningButton(n)),this._activateButton(r,n,a)}.bind(this))
},_setWarningButton:function(e){e.removeClass("hidden").addClass("disabled")},_activateButton:function(e,t,i){e.isFollowing().done(function(n){var a=n;this._toggleFollow(t,i,a),t.toggleClass("active",a).removeClass("hidden"),t.on("click",function(){this._toggleFollow(t,i,!a,!0),e.toggleFollow().then(function(){a=!a}).fail(function(){t.toggleClass("active",a),t.removeClass("cancel-hover-style")})}.bind(this))}.bind(this))},_toggleFollow:function(e,t,a,r){a?(e.addClass("active"),e.attr("title",n),r&&(e.addClass("cancel-hover-style"),e.one("mouseleave",function(){e.removeClass("cancel-hover-style")}),this.isEmailNotificationsDisabled&&e.next().tauBubble("show"))):(e.attr("title",i),e.removeClass("active cancel-hover-style"))}})}),define("tau/components/followButton/models/followButton.model",["require","tau/core/class","Underscore","jQuery"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n=e("jQuery");return t.extend({init:function(e,t,i){this.store=e.getStore(),this.followId=null,this.entity=i,this.userId=t},_getSettings:function(){return{general:{id:this.entity.id},user:{id:this.userId}}},toggleFollow:function(){return this.isFollowing().then(function(e){return e?this.unFollow():this.follow()}.bind(this))},follow:function(){return this.store.saveDef("generalFollower",{$set:this._getSettings()}).then(function(e){return this._track("follow"),this.followId=e.data.id,e}.bind(this))},unFollow:function(){var e=n.Deferred();return this.store.remove("generalFollower",{id:this.followId}).done({success:function(){this._track("unfollow"),e.resolve()}.bind(this),failure:function(){e.reject()}}),e.promise()},isFollowing:function(){return this.store.getDef("generalFollower",{$query:this._getSettings()}).then(function(e){var t=i.first(e);return t?(this.followId=t.id,!0):!1}.bind(this))},_track:function(e){taus.track({name:e,entityType:this.entity.entityType.name})}})}),define("tau/components/followButton/extensions/followButton.config.extension",["require","tau/core/extension.base","./../models/followButton.model"],function(e){var t=e("tau/core/extension.base"),i=e("./../models/followButton.model");
return t.extend({"bus afterInit":function(e,t){var n=t.config.context,a=n.configurator,r=a.getLoggedUser().id,s=n.entity,o=new i(a,r,s),l={model:o,configurator:a};this.fire("followButton.config.ready",l)}})}),define("tau/components/component.followButton",["require","./component.creator","template!./followButton/templates/followButton.template","./followButton/extensions/followButton.extension","./followButton/extensions/followButton.config.extension"],function(e){var t=e("./component.creator"),i=e("template!./followButton/templates/followButton.template"),n=e("./followButton/extensions/followButton.extension"),a=e("./followButton/extensions/followButton.config.extension");return{create:function(e){e=e||{};var r={extensions:[n,a],template:i};return t.create(r,e)}}}),define("tau/ui/extensions/board.context.container/ui.extension.board.context.container.top",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({init:function(e){this._super(e),this.globalBus=e.context.configurator.getGlobalBus(),this.globalBus.on("general.quick.add.empty",this.processEmptyGeneralQuickAdd,this),this.globalBus.on("select.context.link.click",this.onSelectContextLinkClick,this)},processEmptyGeneralQuickAdd:function(){this.$element.animateWithCss({cssClassName:"tau-teams-projects-submit_highlighted_true"})},onSelectContextLinkClick:function(){this.$element.click()},"bus afterRender":function(e,t){this.$element=t.element},"bus afterRender + childrenBuses.ready":function(e,t,i){i[1].fire("$trigger.ready",t.element),i[0].on("refresh",function(){i[1].fire("hide",{silent:!0})})},"bus destroy":function(){this._super(),this.globalBus.removeAllListeners(this)}})}),define("tau/components/component.global.context.control",["require","Underscore","tau/components/component.container","tau/ui/extensions/board.container/ui.extension.board.container.events","tau/ui/extensions/board.context.container/ui.extension.board.context.container.top","tau/ui/extensions/board.context.container/ui.extension.board.context.container.tabs","tau/ui/extensions/board.context.container/ui.extension.board.context.container.bubble","tau/components/component.board.context.output","tau/components/component.bubble.container"],function(e){var t=e("Underscore"),i=e("tau/components/component.container"),n=e("tau/ui/extensions/board.container/ui.extension.board.container.events"),a=e("tau/ui/extensions/board.context.container/ui.extension.board.context.container.top"),r=e("tau/ui/extensions/board.context.container/ui.extension.board.context.container.tabs"),s=e("tau/ui/extensions/board.context.container/ui.extension.board.context.container.bubble");
return e("tau/components/component.board.context.output"),e("tau/components/component.bubble.container"),{create:function(e){var o={type:"global.context.control",name:"global.context.control",useAnimation:!1,cssClass:"tau-context-filter",extensions:[n,a],children:[{type:"board.context.output",name:"board.context.filter"},{type:"bubble.container",cssClass:"tau-teams-projects-manager-holder",visible:!1,useAnimation:!1,extensions:[{extType:r,args:["board_context_selector"]},s],children:[{type:"container",label:"team.formAdd",visible:!1,useAnimation:!1,cssClass:"tau-teams-projects-manager",children:[{name:"team_form_add",type:"team.formAdd"}]},{type:"container",label:"project.formAdd",cssClass:"tau-teams-projects-manager",visible:!1,useAnimation:!1,children:[{name:"project_form_add",type:"project.formAdd"}]},{type:"container",label:"selector",visible:!0,useAnimation:!1,children:[{name:"board_context_selector",type:"board.context.selector"}]},{type:"container",label:"program.formAdd",cssClass:"tau-teams-projects-manager",visible:!1,useAnimation:!1,children:[{name:"board_selector_add-program",type:"board.selector.add-program"}]}]}]};return e["queue.bus"]=!0,i.create(t.extend(e,o))}}}),define("tau/models/model.leadCycleTime",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(e,t,i){var n=i.Date,a=6e4,r=60*a,s=24*r,o=t.extend({name:"Lead Cycle Time Model",onInit:function(){var e=this,t=e.config.context,i=t.entity.entityType.name,n=t.entity.id,a={id:n,fields:["leadTime","cycleTime","createDate","startDate","endDate"]};e.store.unbind(e),e.store.on({eventName:"afterSave",type:i,fields:["entityState"],listener:e},function(){e.fire("refresh")}),e.store.get(i,a,{scope:e,success:e.onEntityRetrieved}).done()},getTime:function(e){var t="d",i="min",n="h";return this.getTimeWithAbbreviation(e,t,n,i)},getTimeWithAbbreviation:function(e,t,i,n){if(e*=s,r>e)return(e/a).toFixed(0)+n;if(s>e)return(e/r).toFixed(0)+i;var o=parseInt(e/s);e%=s;var l=(e/r).toFixed(0);return o+t+" "+(l>0?l+i:"")
},convertDayToMinutes:function(e){return 24*e*60},getLongTime:function(e){return this.getTimeWithAbbreviation(e," days"," hours"," minutes")},onEntityRetrieved:function(t){var a=t.data,r=i.parse(a.startDate),s=i.parse(a.createDate),o=i.parse(a.endDate),l="dd MMM yy",u=o?"End Date":"Today";o=o||new n;var c=a.leadTime,d={leadTime:this.getTime(c),leadTimeTooltip:this.getLongTime(c),createDate:s.toString(l),endDateLabel:u,endDate:(o||new n).toString(l),id:e.uniqueId()};if(e.isNumber(a.cycleTime)){var p=a.cycleTime;d.cyclePercentage=p/c,d.cycleTime=this.getTime(p),d.cycleTimeTooltip=this.getLongTime(p),d.startDate=(r||"").toString(l),d.startDate==d.createDate&&(d.startDate="")}else d.cycleTime="",d.cyclePercentage=null;this.fire("dataBind",d)}});return o}),define("tau/models/dataprocessor/model.processor.implementationHistory",["Underscore","tau/core/termProcessor","tau/utils/utils.date/utils.date.wrapper"],function(e,t,i){var n=function(t,i,n){return e.each(n,function(e){e in i&&(t[e]=i[e])}),t},a=function(e){this._historyItems=e};a.enhance=function(e){return new this(e).enhance()},a.prototype={constructor:a,enhance:function(){var e=this._historyItems;return e=this._addDateSpan(e)},_addDateSpan:function(t){var i=this._createItemStateGroups(t);return e.each(i,function(t){var i=e.first(t).state;i.dateSpan=t.length}),t},_createItemStateGroups:function(t){var i=[],n=null,a=null;return e.each(t,function(e){n!=e.state.name&&(n=e.state.name,a&&i.push(a),a=[]),a.push(e)}),i.push(a),i}};var r=function(e){this._historyItems=e};r.compress=function(e){return new this(e).compress()},r.prototype={constructor:r,compress:function(){var e=this._historyItems;return e=this._compressAssignments(e),e=this._compressStates(e)},_compressStates:function(t){var i=e.select(t,function(e,i){var n=!0;return this._isItemStateNeedsCompression(e.state)&&this._isItemNeedsCompression(e,i,t)&&(n=!1),n},this);return i},_isItemStateNeedsCompression:function(e){return e.isInitial||e.isFinal||e.isPlanned},_isItemNeedsCompression:function(e,t,i){var n=!1,a=i[t-1],r=!a;
if(!r){var s=a.state.name!=e.state.name,o=e.transitions>1,l=e.assignments,u=e.relatedEntities,c=e.spentTime>0;s||o||l||u||c||(n=!0)}return n},_compressAssignments:function(e){return this._clearDublicatedAssignmentsForState(e),this._mergeIdenticalAssignmentsForItem(e),e},_clearDublicatedAssignmentsForState:function(t){var i=e.select(t,function(e,i){var n=!1;if(e.assignments){var a=t[i-1];a&&a.state.name==e.state.name&&this._areAssignmentsTheSame(a.assignments,e.assignments)&&(n=!0)}return n},this);e.each(i,function(e){delete e.assignments})},_mergeIdenticalAssignmentsForItem:function(t){e.each(t,function(t){if(t.assignments){var i=[],n={};e.each(t.assignments,function(e){e.id in n?n[e.id].roles.push(e.role):(n[e.id]=e,e.roles=[e.role],delete e.role,i.push(e))}),t.assignments=i}})},_areAssignmentsTheSame:function(t,i){var n=e.pluck(t,"id").join(""),a=e.pluck(i,"id").join("");return n==a}};var s=function(e){this._inputData=e,this._termProcessor=new t(e.terms)};return s.transform=function(e){return new this(e).transform()},s.prototype={constructor:s,transform:function(){var e={entityStates:this._getEntityStateNames(),historyItems:this._getHistoryItems(),leadTime:this._getLeadTime(),cycleTime:this._getCycleTime()};return e},_getLeadTime:function(){return this._inputData.leadTime},_getCycleTime:function(){return this._inputData.cycleTime},_getHistoryEntries:function(){return this._inputData.response[0].data.statistics.entries},_getAllEntityStatesForProcess:function(){return this._inputData.response[1].data.entityStates},_getAllUsers:function(){return this._inputData.response[2].data},_getAllRoles:function(){return this._inputData.response[3].data},_getEntityStateNames:function(){var t=this._getEntityStates(),i=this._sortEntityStates(t),n=e.map(i,function(e){return e.name});return n},_getEntityStates:function(){var t=this._inputData.entityTypeName.toLowerCase(),i=e.select(this._getAllEntityStatesForProcess(),function(e){return t.toLowerCase()==e.entityType.name.toLowerCase()
});return i},_sortEntityStates:function(t){var i=e.sortBy(t,function(e){var t=e.numericPriority;return e.isInitial?t=Number.NEGATIVE_INFINITY:e.isFinal&&(t=Number.POSITIVE_INFINITY),t}).reverse();return i},_getHistoryItems:function(){var t=[];return e.each(this._getHistoryEntries(),function(e){t.push(this._createHistoryItem(e))},this),t=this._sortHistoryItems(t),t=this._enhanceHistoryItems(t),t=this._compressHistoryItems(t)},_createHistoryItem:function(t){var n={date:new i(i.parse(t.date)),spentTime:parseFloat(t.time),transitions:parseFloat(t.transitions),state:this._getHistoryEntryState(t)},a=this._getHistoryEntryRelatedEntities(t);return e.isEmpty(a)||(n.relatedEntities=a),t.assignments&&(n.assignments=this._getHistoryEntryAssignments(t)),n},_getHistoryEntryState:function(e){var t=this._getEntityStateInfo(e.stateId),i=n({},t,["name","isInitial","isFinal","isPlanned"]);return t.role&&(i.roleId=t.role.id),i},_getEntityStateInfo:function(t){var i=e.detect(this._getAllEntityStatesForProcess(),function(e){return t==e.id});return i},_getHistoryEntryRelatedEntities:function(e){var t=n({},e,["opened","closed"]);return this._setEntityAlias(t.opened),this._setEntityAlias(t.closed),t},_setEntityAlias:function(t){e.each(t,function(e){var t=this._getEntityAlias(e.type);t&&(e.alias=t)},this)},_getEntityAlias:function(e){var t=this._termProcessor.getTerms(e);return t?t.name:null},_getHistoryEntryAssignments:function(t){var i=[];return e.each(t.assignments,function(e){var t=this._getUserInfo(e.userId);t&&i.push({id:e.userId,firstName:t.firstName,lastName:t.lastName,role:{id:parseInt(e.roleId),name:this._roleIdToName(e.roleId)}})},this),i},_getUserInfo:function(t){var i=null,a=e.detect(this._getAllUsers(),function(e){return t==e.id});return a&&(i=n({},a,["firstName","lastName"])),i},_roleIdToName:function(t){var i=e.detect(this._getAllRoles(),function(e){return t==e.id});return i.name},_sortHistoryItems:function(t){return e.sortBy(t,function(e){return new i(i.parse(e.date))})},_enhanceHistoryItems:function(e){return a.enhance(e)
},_compressHistoryItems:function(e){return r.compress(e)}},s}),define("tau/models/model.implementationHistory",["Underscore","tau/models/model.leadCycleTime","tau/models/dataprocessor/model.processor.implementationHistory"],function(e,t,i){return t.extend({onInit:function(){var e=this.config.context,t="implementationHistory",i=this.config.context.entity.id;this.store.evictProperties(i,"implementationHistory",["statistics"]),this.store.get(t,{id:e.entity.id,fields:["id","statistics"]}).get("process",{id:e.getProcessId(),nested:!0,fields:[{entityStates:["id","name","isInitial","isFinal","isPlanned","numericPriority",{entityType:["id","name"]},{role:["id"]}]}]}).get("user",{fields:["id","firstName","lastName"]}).get("roles",{fields:["id","name"]}).get(this.config.context.entity.entityType.name,{id:i,fields:["leadTime","cycleTime"]}).done({scope:this,success:this.onDone}),this.store.unbind(this),this._bindToStoreChanges()},_bindToStoreChanges:function(){this._bindToStoreAfterSafe(),this._bindToStoreAfterRemove()},_bindToStoreAfterSafe:function(){this.store.on({eventName:"afterSave",type:this.config.context.entity.entityType.name,listener:this,filter:{id:this.config.context.entity.id},hasChanges:["entityState"]},this._getOnStoreChangesProxy()),e.each(this._getStoreObservableEntityTypes(),function(e){this.store.on({eventName:"afterSave",type:e,listener:this},this._getOnStoreChangesProxy())},this)},_bindToStoreAfterRemove:function(){e.each(this._getStoreObservableEntityTypes(),function(e){this.store.on({eventName:"afterRemove",type:e,listener:this},this._getOnStoreChangesProxy())},this)},_getStoreObservableEntityTypes:function(){if(!this._storeObservableEntityTypes){var e=["assignment","impediment"];switch(this.config.context.entity.entityType.name){case"userstory":e.push("task","bug");break;case"feature":e.push("userstory");break;case"request":e.push("feature","userstory","task","bug")}this._storeObservableEntityTypes=e}return this._storeObservableEntityTypes},_onStoreChanges:function(){this.store.evictProperties(this.config.context.entity.id,"implementationHistory",["statistics"]),this.fire("afterUpdate")
},_getOnStoreChangesProxy:function(){return this._onStoreChangesProxy||(this._onStoreChangesProxy=e.bind(this._onStoreChanges,this)),this._onStoreChangesProxy},shouldShowLeadCycleTimes:function(){var e=this.config.context.entity.entityType.name;return-1!=["userstory","bug","feature"].indexOf(e.toLowerCase())},onDone:function(t){if(this.config){var n=t[4].data.cycleTime,a=this.convertDayToMinutes(n).toFixed(0),r={};this.shouldShowLeadCycleTimes()&&(r={leadTime:this.getLongTime(t[4].data.leadTime),cycleTime:a>0?this.getLongTime(n):null});var s=i.transform(e.extend({response:t,entityTypeName:this.config.context.entity.entityType.name,terms:this.config.context.getTerms()},r));this.fire("dataBind",s)}}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.dateRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date"],function(e,t,i,n){return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render()},_render:function(){var i=this._$element.find(".tau-historyGrid td.tau-historyItem");e.each(this._data.historyItems,function(e,a){var r=i.eq(a),s=r.find(".tau-date"),o=t("<span/>").addClass("tau-day"),l=t("<span/>").addClass("tau-month");o.text(n.formatAs(e.date,"dd")),l.text(n.formatAs(e.date,"MMM")),s.attr("title",n.format.date.short(e.date)).append(o,l)})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.stateProgressRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render()},_render:function(){this._createFlowIndicators(),this._connectMarkers(),this.fire("stateProgressRendered")},_createFlowIndicators:function(){var t=this._$element.find(".tau-historyGrid .tau-historyItem");e.each(this._data.historyItems,function(e,i){this._markProgressStep(t.eq(i),e)
},this)},_getHistoryItemStateIndex:function(t){return e.indexOf(this._data.entityStates,t)},_getFlowType:function(e){var t="NORMAL";return e.state.isFinal?t="DONE":this._isUnderImpediment(e)?t="IMPEDIMENT":e.transitions>1&&(t="MULTITRANS"),t},_isUnderImpediment:function(t){var i=e.any(this._getImpedimentRangeList(),function(e){return this._isInImpedimentRange(t,e)},this);return i},_getImpedimentRangeList:function(){if(!this._impedimentRangeList){this._impedimentRangeList=[];var t=this._getAllImpediments();e.each(t.opened,function(e,i){this._impedimentRangeList.push({start:e,end:t.closed[i]||Number.POSITIVE_INFINITY})},this),this._impedimentRangeList.sort(function(e,t){return t.end-t.start-(e.end-e.start)})}return this._impedimentRangeList},_getAllImpediments:function(){var t={opened:{},closed:{}};return e.each(this._data.historyItems,function(i){i.relatedEntities&&(e.each(i.relatedEntities.opened,function(e){this._isImpediment(e)&&(t.opened[e.id]=i.date)},this),e.each(i.relatedEntities.closed,function(e){this._isImpediment(e)&&(t.closed[e.id]=i.date)},this))},this),t},_isImpediment:function(e){return"impediment"==e.type.toLowerCase()},_isInImpedimentRange:function(e,t){return e.date>=t.start&&e.date<=t.end},_markProgressStep:function(e,i){var n=this._getHistoryItemStateIndex(i.state.name),a=this._getFlowType(i),r=this._createFlowIndicator(a),s=i.state.dateSpan;s&&!i.state.isFinal&&t("<span/>").addClass("datespan").text(s).attr("title",s+" days in this state").appendTo(r),e.find(".tau-progressSteps .tau-step:nth-child("+(n+1)+") .tau-marker").append(r)},_createFlowIndicator:function(e){var i=t("<div/>").addClass("tau-flow");switch(e){case"NORMAL":i.addClass("tau-normal");break;case"MULTITRANS":i.addClass("tau-transitions");break;case"IMPEDIMENT":i.addClass("tau-impediment");break;case"DONE":i.addClass("tau-done")}return i},_connectMarkers:function(){e.each(this._data.historyItems,function(e,t){var i=this._getHistoryItemStateIndex(e.state.name);this._connect(t,i,t-1,"in"),this._connect(t,i,t+1,"out")
},this)},_connect:function(e,t,i,n){var a=this._data.historyItems[i];if(a){var r=this._getHistoryItemStateIndex(a.state.name),s=t-r;s>0&&this._$element.find(".tau-historyGrid .tau-historyItem").eq(e).find(".tau-progressSteps .tau-step").filter(function(e){return e>=r+1&&t>=e}).find(".tau-marker").addClass("tau-"+n)}}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.stateHistogramRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render()},_render:function(){var e=this._createStateDateItemsHash();this._$element.find(".tau-historyGridInterpretation .stateName").each(function(i,n){var a=t(n),r=e[a.text()],s=a.attr("title")+" ("+r.absolute+" days)";a.attr("title",s).addClass("tau-dateItems-"+r.relative)})},_createStateDateItemsHash:function(){var t={};return e.each(this._data.entityStates,function(e){t[e]={absolute:0,relative:0}}),this._calculateAbsoluteHashValues(t),this._calculateRelativeHashValues(t),t},_calculateAbsoluteHashValues:function(t){e.each(this._data.historyItems,function(e){var i=e.state.dateSpan;i&&(t[e.state.name].absolute+=i)})},_calculateRelativeHashValues:function(t){var i=e.max(t,function(e){return e.absolute}).absolute;e.each(t,function(e,n){var a=100*e.absolute/i;t[n].relative=10*Math.round(a/10)})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.timeLoadRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render()},_render:function(){if(this._timeLoadWasReported()){var t=this._calculateMaxSpentTime(),i=this._$element.find(".tau-historyGrid td.tau-historyItem");e.each(this._data.historyItems,function(e,n){var a=e.spentTime,r=i.eq(n).find(".tau-date"),s=this._calculateRelatedRoundedSpentTime(t,a);
if(!isNaN(s)){var o=r.attr("title");r.addClass("tau-timeLoad-"+s).attr("title",o+" ("+a+" hours)")}},this)}},_timeLoadWasReported:function(){return e.any(this._data.historyItems,function(e){return e.spentTime>0})},_calculateMaxSpentTime:function(){return e.max(this._data.historyItems,function(e){return e.spentTime}).spentTime},_calculateRelatedRoundedSpentTime:function(e,t){var i=100*t/e,n=10*Math.round(i/10);return n}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){var n={create:function(e,i){return t("<a></a>").addClass(this._createClassName(e,i)).attr("href","#"+e.type+"/"+e.id).attr("title",this._createTitle(e,i)).data("entityInfo",{id:e.id,type:e.type,alias:e.alias||e.type})},_createTitle:function(e,t){var i=["["+(e.alias||e.type)+"]"," #"+e.id,e.name,t?"(closed)":"(added)"].join(" ");return i},_createClassName:function(e,t){var i=["i-role-entity ","tau-entity-icon ","tau-entity-icon--"+e.type.toLowerCase(),t?"tau-closed":""].join(" ");return i}};return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render()},_render:function(){var t=this._$element.find(".tau-historyGrid .tau-historyItem");e.each(this._data.historyItems,function(i,a){var r=t.eq(a).find(".i-role-relatedEntities-container");i.relatedEntities&&(e.each(i.relatedEntities.opened,function(e){r.append(n.create(e))}),e.each(i.relatedEntities.closed,function(e){r.append(n.create(e,!0))}))})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.assignmentsRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender+stateProgressRendered":function(e){this._$element=e.afterRender.data.element,this._data=e.afterRender.data.data,this._render()},_render:function(){var i=this._$element.find(".tau-historyGrid .tau-historyItem");
e.each(this._data.historyItems,function(e,n){e.assignments&&!e.state.isFinal&&t('<div class="tau-assignments"/>').insertAfter(i.eq(n).find(".tau-flow")).append(this._getAssignments(e))},this)},_getAssignments:function(t){var i=[];return e.each(t.assignments,function(e){var n=[e.firstName,e.lastName,"("+this._getAssignmentRoles(e)+")"].join(" "),a=this.config.context.configurator.getApplicationPath()+"/Avatar.ashx?UserId="+e.id+"&size=50",r=this._isActiveAssignment(e,t)?' class="active"':"";i.push("<img"+r+' alt="avatar" title="'+n+'" src="'+a+'"/>')},this),i.join("")},_getAssignmentRoles:function(t){return e.map(t.roles,function(e){return e.name}).join(", ")},_isActiveAssignment:function(t,i){return e.any(t.roles,function(e){return e.id==i.state.roleId})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.statsRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render()},_render:function(){var e=t('<div class="tau-historyStats"/>'),i=t(["<table>","<tbody>",'<tr style="display: ',this._calculateCycleTime()?"":"none",'" >',"<td>Cycle Time:</td>","<td>"+this._calculateCycleTime()+"</td>","</tr>",'<tr style="display: ',this._calculateLeadTime()?"":"none",'">',"<td>Lead Time:</td>","<td>"+this._calculateLeadTime()+"</td>","</tr>","</tbody>","</table>"].join(""));(this._calculateCycleTime()||this._calculateLeadTime())&&e.append(i).appendTo(this._$element)},_calculateLeadTime:function(){return this._data.leadTime},_calculateCycleTime:function(){return this._data.cycleTime}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.legendRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/utils/utils.storage","tau/utils/utils.date/utils.date.wrapper"],function(e,t,i,n,a,r){return i.extend({"bus afterRender":function(e){this._$element=e.data.element,this._data=e.data.data,this._render(),this._bindEvents()
},_render:function(){var e=t('<div class="tau-legend"></div>'),i=t('<h3><span class="tau-legendToggler">Legend</span></h3>');e.append(i,this._createGroups()),this._setProps(e),e.appendTo(this._$element)},_createGroups:function(){var e=t('<div class="tau-groups"></div>');this._createGroupElement("Progress Flow",this._getProgressFlowTypes()).appendTo(e);var i=this._getRelatedEntitiesTypes();return i&&this._createGroupElement("Related Entities",i).appendTo(e),this._createGroupElement("Histograms",this._getHistogramTypes()).appendTo(e),e},_createGroupElement:function(i,n){var a=t("<dl/>"),r=t("<dt/>").text(i);return a.append(r),e.each(n,function(e){var i=t("<dd/>"),n=t(e.element).addClass("glyph");i.text(e.description),i.prepend(n),a.append(i)}),a},_getProgressFlowTypes:function(){var i=this._$element.find(".tau-historyGrid .tau-historyItem .tau-flow"),n={};e.each(i,function(e){var i=t.trim(e.className.replace("tau-flow",""));i in n||(n[i]=t(e).clone().empty().removeAttr("title"))});var a=e.map(n,function(e,t){var i={element:e};switch(t){case"tau-normal":i.description="normal flow";break;case"tau-transitions":i.description="multiple state transitions";break;case"tau-impediment":i.description="impediment";break;case"tau-done":i.description="final state"}return i});return a},_getRelatedEntitiesTypes:function(){var i=null,n=this._$element.find(".tau-historyGrid .tau-historyItem .tau-entity");if(n.size()>0){var a={};e.each(n,function(e){var i=t.trim(e.className.replace(/tau-entity|tau-closed/g,""));i in a||(a[i]=t(e).clone(!0).unbind().removeAttr("title"))});var r=e.map(a,function(e){return{element:e,description:e.data("entityInfo").alias}});i=[{element:t('<div class="tau-entity"></div>'),description:"entity (added)"},{element:'<div class="tau-entity tau-closed"></div>',description:"entity (closed)"}].concat(r)}return i},_getHistogramTypes:function(){var e=[];return e.push({element:this._getElementForStateHistogram(),description:"total days in entity state"}),this._timeLoadWasReported()&&e.push({element:this._getElementForTimeLoadHistogram(),description:"daily total spent time"}),e
},_getElementForStateHistogram:function(){var e=t(['<div class="tau-historyGridInterpretation">','<div class="stateName tau-dateItems-50">',"<span>State name</span>","</div>","</div>"].join(""));return e},_timeLoadWasReported:function(){return e.any(this._data.historyItems,function(e){return e.spentTime>0})},_getElementForTimeLoadHistogram:function(){var e=new r(0),i=t(['<div class="tau-date tau-timeLoad-50">','<span class="tau-day">'+n.formatAs(e,"dd")+"</span>",'<span class="tau-month">'+n.formatAs(e,"MMM")+"</span>","</div>"].join(""));return i},_setProps:function(e){this._isCollapsed()&&this._collapse(e)},_bindEvents:function(){this._$element.find(".tau-legend .tau-legendToggler").click(t.proxy(this,"_toggleState"))},_toggleState:function(e){var i=t(e.currentTarget).parents(".tau-legend");this._isCollapsed()?this._uncollapse(i):this._collapse(i)},_isCollapsed:function(){return"collapsed"==a.get("implementationHistoryLegendState")},_uncollapse:function(e){a.remove("implementationHistoryLegendState"),e.removeClass("tau-collapsed")},_collapse:function(e){a.set("implementationHistoryLegendState","collapsed"),e.addClass("tau-collapsed")}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.historyGridScroller",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){e.data.element.find(".tau-historyGrid").mousewheel(t.proxy(this,"_onMouseWheel"))},_onMouseWheel:function(e,i){var n=e.currentTarget;if(this._isScrollActive(n)){e.preventDefault();var a=t(n),r=a.scrollLeft(),s=r+100*-i;a.scrollLeft(s)}},_isScrollActive:function(e){return e.scrollWidth>e.offsetWidth}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesHighlighter",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){this._$relatedEntities=e.data.element.find(".i-role-relatedEntities-container .i-role-entity"),this._$relatedEntities.hover(t.proxy(this,"_onHoverIn"),t.proxy(this,"_onHoverOut"))
},_getRelatedEntities:function(e){var i=t(e).data("entityInfo").id;return this._$relatedEntities.filter(function(){return i==t(this).data("entityInfo").id})},_onHoverIn:function(e){this._getRelatedEntities(e.currentTarget).addClass("tau-highlight")},_onHoverOut:function(e){this._getRelatedEntities(e.currentTarget).removeClass("tau-highlight")}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.updateOverlay",["jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(e,t){return t.extend({"bus afterRender":function(t){var i=this._$element=t.data.element;setTimeout(function(){var t=i.find(".tau-historyGrid"),n=t.find(".tau-historyItem:last");e(t).scrollTo(n,1e3,{axis:"x",easing:"easeOutQuart"})},500)},"bus afterUpdate":function(){this._$element.tauOverlay(),this.fire("refresh")}})}),define("tau/ui/templates/implementationHistory/ui.template.implementationHistoryItem",["tau/core/templates-factory"],function(e){var t={name:"implementationHistoryItem",options:{},dependencies:[],markup:['<td class="tau-historyItem">','<div class="tau-progressSteps">',"{{each(index, step) $item.parent.data.entityStates}}",'<div class="tau-step">','<div class="tau-marker"/>',"</div>","{{/each}}","</div>",'<div class="tau-date"></div>','<div class="tau-relatedEntities i-role-relatedEntities-container"></div>',"</td>"].join("")};return e.register(t)}),define("tau/ui/templates/implementationHistory/ui.template.implementationHistory",["tau/core/templates-factory","tau/ui/templates/implementationHistory/ui.template.implementationHistoryItem"],function(e){var t={name:"implementationHistory",options:{},dependencies:["implementationHistoryItem"],markup:['<div class="tau-implementationHistory">','<div class="tau-historyGridInterpretation">',"{{each(index, stateName) entityStates}}",'<div class="stateName" title="${stateName}">',"<span>${stateName}</span>","</div>","{{/each}}","<div>Date</div>","<div>Related Entities</div>","</div>",'<div class="tau-historyGrid">',"<table>","<tbody>","<tr>",'{{tmpl(historyItems) "implementationHistoryItem"}}',"</tr>","</tbody>","</table>","</div>","</div>"].join("")};
return e.register(t)}),define("tau/components/component.implementationHistory",["tau/components/component.creator","tau/models/model.implementationHistory","tau/components/extensions/implementationHistory/component.implementationHistory.dateRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.stateProgressRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.stateHistogramRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.timeLoadRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.assignmentsRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.statsRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.legendRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.historyGridScroller","tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesHighlighter","tau/components/extensions/implementationHistory/component.implementationHistory.updateOverlay","tau/ui/templates/implementationHistory/ui.template.implementationHistory"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return{create:function(m){var h=m||{},g={extensions:[t,i,n,a,r,s,o,l,u,c,d,p],template:f};return e.create(g,h)}}}),define("tau/models/common/model.common.events",["Underscore","tau/core/extension.base"],function(e,t){var i=t.extend({"bus beforeInit":function(e,t){var i=t.config.context;this.fire("configurator.ready",i.configurator),this.fire("entity.ready",i.entity)},"bus afterRender":function(e,t){this.fire("$el.ready",t.element)}});return i}),define("tau/models/inviter/model.inviter",["Underscore","tau/core/extension.base"],function(e,t){var i=t.extend({"bus beforeInit + activeTab.ready":function(e,t,i){this.fire("dataBind",{activeTab:i})
}});return i}),define("tau/models/inviter/model.inviter.add",["Underscore","tau/core/extension.base","tau/libs/inviter/inviter"],function(e,t,i){return t.extend({"bus configurator.ready:last + form.submitted":function(e,t,n){var a=this,r=new i(t);r.invite(n.members).done(function(e){a.fire("members.saved",e)})},"bus configurator.ready:last + entity.ready:last + members.saved":function(t,i,n,a){var r=this,s=i.getStore(),o=n.entityType.name,l=o+"Members",u=e.compact(e.pluck(a,"failure"));u.length&&this.fire("team.add.nonFatalFailure","Can't assign users.");var c=e.compact(e.pluck(a,"success")),d={};d[l]=e.map(c,function(e){return{user:{id:e}}});var p=["id","name"];p.push("team"===o?"icon":"color");var f={};f[l]=[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}],p.push(f),s.save(o,{id:n.id,$set:d,fields:p}).done(function(e){r.fire("members.connected",e[0].data)})},"bus entity.ready:last + members.saved + members.connected":function(e,t,i,n){this.fire("invitation.success",n)}})}),define("tau/ui/extensions/inviter/ui.extension.inviter.form",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready":function(e,t){this.fire("$form.ready",t.find(".i-role-form"))},"bus $form.ready":function(e,t){var i=this;t.on("submit",function(e){e.preventDefault();var n={};n.members=t.find("[name=users]").tauInviter("getValue",!0),i.fire("form.submitted",n)})},"bus configurator.ready:last + $form.ready:last + invitation.success":function(e,t,i){i.trigger("reset")}})}),define("tau/ui/extensions/inviter/ui.extension.inviter.widget",["Underscore","jQuery","tau/ui/extensions/inviter/ui.extension.inviter.widget.abstract"],function(e,t,i){return i.extend({"bus configurator.ready":function(e,t){this._initTemplates(t)},"bus configurator.ready + $el.ready + entity.ready":function(e,t,i,n){var a=n.entityType.name,r=a+"Members",s=" AND "+r+".count("+a+".id="+n.id+")==0 ";this._initWidget(t,i,s)}})}),define("tau/ui/templates/inviter/ui.template.inviter",["tau/core/templates-factory"],function(e){var t={name:"inviter",engine:"jqote2",markup:['<div class="tau-team-control">','<div class="tau-actions i-role-tabheaders">','<div class="tau-new-team i-role-tabheader <% if (this.activeTab == "add"){ %> tau-active <% } %>" data-tab="add">',"<span></span>Assign people","</div>","</div>",'<div class="tau-tab-content">','<div class="tau-tab-pane tau-new-entity-holder i-role-tab-add <% if (this.activeTab == "add"){ %> tau-active <% } %> ">','<form class="tau-new-item_active_false i-role-form">','<div class="tau-new-entity-form">','<div class="tau-invite-widget">','<textarea name="users" />','<div class="tau-invite-footer">','<button class="tau-btn tau-success" type="submit">Invite people</button>',"</div>","</div>","</div>","</form>","</div>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.inviter",["tau/components/component.creator","tau/models/common/model.common.events","tau/models/inviter/model.inviter","tau/models/inviter/model.inviter.add","tau/ui/extensions/tabs/ui.extension.tabs.modern","tau/ui/extensions/inviter/ui.extension.inviter.form","tau/ui/extensions/inviter/ui.extension.inviter.widget","tau/components/extensions/error/extension.errorBar","tau/ui/templates/inviter/ui.template.inviter"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){u["queue.bus"]=!0;var c={"queue.bus":!0,extensions:[t,i,n,a,r,s,o],template:l};return e.create(c,u)}}}),define("tau/models/model.iteration.canBeFinished",["Underscore","tau/core/model-base"],function(e,t){return t.extend({name:"Can Be finished",onInit:function(){var e=this.config.context,t=e.entity.entityType.name,i=e.entity.id;this.store.get(t,{id:i,fields:["canBeFinished"]},{success:this.onEntityRetrieved,scope:this}).done({success:this.done,scope:this})},onEntityRetrieved:function(e){var t=e.data;this.canBeFinished=t.canBeFinished},done:function(){this.fire("dataBind",{canBeFinished:this.canBeFinished})}})}),define("tau/components/component.iteration.canBeFinished",["tau/components/component.creator","tau/models/model.iteration.canBeFinished","tau/ui/templates/ui.template.empty"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/ui/templates/common/ui.template.attributeValue",["tau/core/templates-factory"],function(e){var t={name:"common-attributeValue",markup:['<span class="attr-item popup-target"><span class="attr-name">${name}</span></span>'],dependencies:[]};return e.register(t)}),define("tau/ui/templates/progressBar/ui.template.iteration.progressBar",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(e,t){var i={name:"iteration-progress-bar",tags:[t],markup:['<div class="entity-progress-box">','   <div class="ui-progressbar__data">','      <span class="ui-label-completed">Completed&nbsp;<b class="value">${effortCompleted}${point}</b></span>','      <span class="ui-label-todo">ToDo&nbsp;<b class="value">${effortToDo}${point}</b></span>',"   </div>",'   <div class="ui-progress-bar-progress ui-progressbar__progress">',"{{if percentCompleted !== 0 }}",'      <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${ Math.round(percentCompleted) < 15 ? 15 : Math.round(percentCompleted) }%;">','         <span class="ui-label ui-progressbar__progress__label"><b class="value">${ Math.round(percentCompleted) }%</b></span>',"      </span>","{{/if}}","   </div>","</div>"],dependencies:["common-attributeValue"]};
return e.register(i)}),define("tau/components/component.iteration.progressBar",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/progressBar/ui.template.iteration.progressBar"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/models/model.label",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({onInit:function(){this.store.unbind(this);var t={text:this.config.text};this.config.cssClass&&(t.cssClass=this.config.cssClass),this.bus.fire("dataBind",t);var i=this.getCollectionFields();if(e.isArray(i)&&i.length>0){var n=this.config.context.entity.id,a=this.config.context.entity.entityType.name||"general",r=i.join("|");this.config.store.on({type:a,eventName:"afterSave",hasChanges:[r],filter:{id:n},listener:this},e.bind(this.entityChanged,this)),this._updateBadge()}},"bus entity.changed":function(){this.entityChanged()},_createCountFieldName:function(e){return e+"-count"},entityChanged:function(){var t=this.config.context.entity,i=t.entityType.name||"general";this.config.store.evictProperties(t.id,i,e.map(this.getCollectionFields(),this._createCountFieldName)),this._updateBadge()},_updateBadge:function(){var t=this.config.context.entity,i=t.entityType.name,n=e.map(this.config.countFieldNames,this._createCountFieldName),a={id:t.id,fields:n};this.store.freeze(!0).done(this.safeCallback(function(e){this.store.get(i,a,this.safeCallback(this.badgeDataRetrieved)).done(),e.unfreeze()}))},badgeDataRetrieved:function(e){for(var t=e.data,i=this.getCollectionFields(),n=0,a=0;a<i.length;a++)n+=t[this._createCountFieldName(i[a])];this.fire("setBadgeData",n.toString())},getCollectionFields:function(){return e.reject(this.config.countFieldNames,function(e){return"id"==e})}});return i}),define("tau/ui/templates/label/ui.template.label",["tau/core/templates-factory","tau/ui/tags/ui.tag.implode"],function(e,t){var i={name:"label",tags:[t],markup:['<div><span class="ui-label{{if cssClass}} ${cssClass}{{/if}}">${$item.$tau.text_implode(text)}</span></div>'],dependencies:[]};
return e.register(i)}),define("tau/ui/extensions/label/ui.extension.label",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus afterRender:last+setBadgeData":function(e){var t=this.getBadgeElement(e.afterRender.data.element);this.updateBadgeElement(t,e.setBadgeData.data)},getBadgeElement:function(t){var i=t.find(".ui-quantity");return 0==i.length&&(i=e('<span class="ui-quantity"></span>').appendTo(t)),i},updateBadgeElement:function(e,t){e.text(t),this.config.quantityCssClass&&e.addClass(this.config.quantityCssClass)}})}),define("tau/components/component.label",["Underscore","tau/components/component.creator","tau/models/model.label","tau/ui/templates/label/ui.template.label","tau/ui/extensions/label/ui.extension.label"],function(e,t,i,n,a){return{create:function(r){var s={ModelType:r.modelType||i,template:r.template||n,extensions:e.clone(r.extensions||[])};return r.hideCounter||s.extensions.push(r.labelExtension||a),t.create(s,r)}}}),define("tau/models/model.label.baseAssignable.timecount",["Underscore","tau/models/model.label"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i={definition:{cells:{items:[{id:"time"}],filter:"?Assignable.Id == "+t.config.context.entity.id}}};this.fire("comet.parameters.ready",i)}})}),define("tau/components/component.label.baseAssignable.timecount",["Underscore","tau/components/component.label","tau/models/model.label.baseAssignable.timecount","tau/ui/extensions/label/ui.extension.label.refresher.comet"],function(e,t,i,n){return{create:function(a){return a=e.extend({modelType:i},a),a.extensions=[n].concat(a.extensions||[]),t.create(a)}}}),define("tau/components/extensions/duplicateBugList/extension.duplicateBugList.count.label.setter",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus afterRender+duplicateBugCountRetrieved":function(e){var t=e.duplicateBugCountRetrieved.data.count;t>0&&this.fire("setBadgeData",t.toString())
}})}),define("tau/components/component.label.duplicateBugCount",["Underscore","tau/components/component.label","tau/components/extensions/duplicateBugList/extension.duplicateBugList.count.label.setter","tau/models/model.duplicateBugCountCalculator","tau/models/model.duplicateBugRetriever","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(e,t,i,n,a,r,s,o){return{create:function(r){var l=r.context.applicationContext.processes[0].terms,u=new o(l);return r=r||{},e.extend(r,{text:"Duplicate "+u.getTerms("Bug").names,quantityCssClass:r.quantityCssClass||"ui-gray-quantity",extensions:[i,n,s,a]}),t.create(r)}}}),define("tau/models/model.label.relationCount",["Underscore","tau/models/model.label","tau/libs/store2/store2"],function(e,t,i){var n=t.extend({_updateBadge:function(e){this.fire("updateBadge",{badgeConfig:e})},"bus updateBadge":function(e,t){var i=t.badgeConfig||{};this._badgeDataRetrieve(i)},_badgeDataRetrieve:function(t){this._getStore2().findAll("general?select={masterRelations.Count()%20%2B%20slaveRelations.Count()%20as%20totalRelationCount,%20masterRelations.ActiveMasterRelationsCount().openBlockers%20as%20blockerRelationCount,%20masterRelations.Select({id,master.id%20as%20masterId})%20as%20masterRelations}&where=(id=="+this.config.context.entity.id+")").done(e.bind(function(e){0!==e.length&&this.fire("badgeDataRetrieved",{badgeConfig:t,badgeData:e[0]})},this))},_getStore2:function(){return this.store2||(this.store2=new i(this.config.context.configurator)),this.store2},"bus badgeDataRetrieved":function(e){var t=e.data.badgeConfig,i=e.data.badgeData;this._setBadgeData(t,i)},_setBadgeData:function(e,t){var i={totalRelationCount:t.totalRelationCount,blockerRelationCount:t.blockerRelationCount};this.fire("setBadgeData",i)}});return n}),define("tau/ui/extensions/label/ui.extension.label.relationCount",["tau/ui/extensions/label/ui.extension.label"],function(e){return e.extend({updateBadgeElement:function(e,t){e.text(t.totalRelationCount.toString()),this.config.quantityCssClass&&e.addClass(this.config.quantityCssClass),e.toggleClass("ui-red-quantity",t.blockerRelationCount>0)
}})}),define("tau/ui/extensions/label/ui.extension.label.relationCount.refresher",["Underscore","tau/core/class","tau/components/extensions/component.extension.base"],function(e,t,i){var n=i.extend({"bus relations.changed":function(){this.fire("updateBadge",{})}});return n}),define("tau/ui/extensions/relations/ui.extension.relations.observer",["Underscore","tau/core/class","tau/components/extensions/component.extension.base"],function(e,t,i){var n=t.extend({init:function(e){this.config=e},startListening:function(e){this.started&&this._stop(),this.started=this._start(e)},_start:function(){return!0},stopListening:function(){this.started&&(this._stop(),this.started=!1)},_stop:function(){this.config.store.unbind(this)}}),a=n.extend({_start:function(){return this.config.store.on({type:"relation",eventName:"afterSave",listener:this},this.config.callback),this.config.store.on({type:"relation",eventName:"afterRemove",listener:this},this.config.callback),this.config.globalBus.on("relation.items.added",this.config.callback,this),!0},_stop:function(){this.config.globalBus.removeAllListeners(this),this._super()}}),r=n.extend({_start:function(e){var t=e.entity.id,i=e.entity.entityType.name||"general";return this.config.store.on({type:i,eventName:"afterSave",hasChanges:["impediments"],filter:{id:t},listener:this},this.config.callback),this.config.store.on({type:"impediment",eventName:"afterSave",hasChanges:["assignable"],filter:{assignable:{id:t}},listener:this},this.config.callback),!0}}),s=i.extend({"bus beforeInit":function(t,i){this._fireChanged=e.debounce(function(){this.fire("relations.changed")},100),this.entity=i.config.context.entity,this.notifyDependencyType=i.config.dependencyType?this._getDependencyType(i.config.dependencyType):null,this._relationCreateListener=new a(this._createConfig({globalBus:i.config.context.configurator.getGlobalBus()})),this._impedimentCreateListener=new r(this._createConfig()),this._relationCreateListener.startListening({entity:this.entity}),this._impedimentCreateListener.startListening({entity:this.entity})
},_createConfig:function(t){return e.defaults(t||{},{store:this.config.store,callback:this._entityChanged.bind(this)})},_getDependencyType:function(e){return"master"==e?"slave":"master"},_entityChanged:function(e){this._isRequireNotification(e)&&this._fireChanged()},_isRequireNotification:function(e){var t=e.data?e.data.changes||e.data.obj||e.data:null;return!this.notifyDependencyType||t&&(this._notifyQuickAdd(t)||this._notifyImpedimentCreated(t)||this._notifyRelationCreated(t))},_notifyQuickAdd:function(e){return e.dependencyType&&this.notifyDependencyType==this._getDependencyType(e.dependencyType)},_notifyImpedimentCreated:function(e){return"slave"==this.notifyDependencyType&&e.assignable&&e.assignable.id==this.entity.id},_notifyRelationCreated:function(e){return e&&e[this.notifyDependencyType]&&e[this.notifyDependencyType].id==this.entity.id},"bus afterInit > destroy":function(){this._relationCreateListener.stopListening(),this._impedimentCreateListener.stopListening()}});return s.Listener=n,s}),define("tau/ui/extensions/label/ui.extension.label.relationCount.observer",["Underscore","tau/core/class","tau/ui/extensions/relations/ui.extension.relations.observer"],function(e,t,i){var n=i.Listener.extend({_start:function(t){return 0===t.entityIds.length?!1:(this.config.store.on({type:this.config.type,eventName:"afterSave",hasChanges:this.config.hasChanges,listener:this},function(i){e.contains(t.entityIds,i.data.id)&&this.config.callback(i)}.bind(this)),!0)}}),a=i.extend({"bus beforeInit":function(){this._super.apply(this,arguments),this._relationTypesChangeListener=new n(this._createConfig({type:"relation",hasChanges:["relationType"]})),this._entityStatesChangeListener=new n(this._createConfig({type:"general",hasChanges:["entityState"]})),this.fire("updateBadge",{})},"bus afterInit:last + updateBadge":function(){this._trackRelationsChangesStop()},_trackRelationsChangesStop:function(){this._relationTypesChangeListener.stopListening(),this._entityStatesChangeListener.stopListening()
},"bus afterInit:last + badgeDataRetrieved":function(e,t,i){var n=i.badgeData;this._trackRelationsChangesStart(n)},_trackRelationsChangesStart:function(t){this._relationTypesChangeListener.startListening({entityIds:e.pluck(t.masterRelations,"id")}),this._entityStatesChangeListener.startListening({entityIds:e.pluck(t.masterRelations,"masterId")})},"bus afterInit > badgeDataRetrieved > destroy":function(){this._trackRelationsChangesStop()}});return a}),define("tau/components/component.label.relationCount",["Underscore","tau/components/component.label","tau/models/model.label.relationCount","tau/ui/extensions/label/ui.extension.label.relationCount","tau/ui/extensions/label/ui.extension.label.relationCount.refresher","tau/ui/extensions/label/ui.extension.label.relationCount.observer"],function(e,t,i,n,a,r){return{create:function(s){return s=e.extend(s,{modelType:i,labelExtension:n,extensions:(s.extensions||[]).concat(a,r)}),t.create(s)}}}),define("tau/models/model.label.testplan.testcasecount",["Underscore","tau/models/model.label"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i={definition:{cells:{items:[{id:"testcase"}],filter:"?TestPlans.Where(Id == "+t.config.context.entity.id+")"}}};this.fire("comet.parameters.ready",i)}})}),define("tau/components/component.label.testplan.testcasecount",["Underscore","tau/components/component.label","tau/models/model.label.testplan.testcasecount","tau/ui/extensions/label/ui.extension.label.refresher.comet"],function(e,t,i,n){return{create:function(a){return a=e.extend(a,{modelType:i,countFieldNames:["testCases"],extensions:(a.extensions||[]).concat(n)}),t.create(a)}}}),define("tau/components/extensions/leadCycleTime/extension.ui.leadCycleTime",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){var i=function(e){var t=null,i=e.target,n=e.value;i.click(function(e){t={x:e.pageX,y:e.pageY}}),i.addClass("ui-link").tauBubble({onShow:function(){var t=this.$popup.find(".tau-bubble__inner");t.find(".tau-time-interval-header").size()>0||t.append(['<div class="tau-time-interval-container">',"<table>","<tr>","   <td>",'       <div class="tau-time-interval-header">',e.caption,":</div>","   </td>","   <td>",'       <div class="tau-time-interval-value">',n,"</div>","   </td>","</tr>","<tr>","   <td>",'       <div class="tau-time-interval-header">',e.startCaption,":</div>","   </td>","   <td>",'       <div class="tau-time-interval-value">',e.startDate,"</div>","   </td>","</tr>","<tr>","   <td>",'       <div class="tau-time-interval-header">',e.endCaption,":</div>","   </td>","   <td>",'       <div class="tau-time-interval-value">',e.endDate,"</div>","   </td>","</tr>","</table>","</div>"].join(""))
},target:i,alignTo:i,onArrowPositionConfig:function(e){var i=t.x-this.target.offset().left;e.offset=i+" 0"},onPositionConfig:function(e){var i=t.x-this.target.offset().left-70;e.offset=i+" 0"}})};return t.extend({"bus afterRender + dataBind":function(t,n,a){var r=e(n.element);a=a||{},i({target:r.find("svg.main-plot rect").eq(4),caption:"Cycle Time",value:a.cycleTimeTooltip,startCaption:"Start Date",startDate:(a.startDate||"").length>0?a.startDate:a.createDate,endCaption:a.endDateLabel,endDate:a.endDate}),i({target:r.find("svg.main-plot rect").eq(0),caption:"Lead Time",value:a.leadTimeTooltip,startCaption:"Create Date",startDate:a.createDate,endCaption:a.endDateLabel,endDate:a.endDate})}})}),define("tau/ui/templates/leadCycleTime/ui.template.leadCycleTime",["tau/core/templates-factory"],function(e){var t={name:"lead-cycle-time",options:{contentSelector:".request-list"},markup:['<div class="ui-lead-cycle-time" style="position: relative;">','<div style="position: absolute; top:0px;left: 6.5%;">','   <svg width="30" height="65" style="position: relative;left: -15px;">','       <text x="10" y="55" fill="rgb(174,174,174)" style="font-size: 10px;font-weight: bold;" transform="rotate(-90 10 55)">${createDate}</text>',"   </svg>","</div>","{{if (startDate)}}",'<div style="position: absolute; top:0px;left:{{if (cyclePercentage < 0.9)}} ${83-cyclePercentage*80}{{/if}}{{if (!(cyclePercentage<0.9))}}${86-cyclePercentage*80}{{/if}}%;">','   <svg width="30" height="57">','       <text x="10" y="55" fill="rgb(174,174,174)" style="font-size: 10px;font-weight: bold;" transform="rotate(-90 10 55)">${startDate}</text>',"   </svg>","</div>",'<div style="position:absolute;left:6.5%;top:65px;width:80%; height:4px;">&nbsp;</div>',"{{/if}}",'<div style="position: absolute; ',"{{if (cyclePercentage != null && cyclePercentage < 0.2)}}","top:-5px;left: 91","{{/if}}","{{if (cyclePercentage == null || cyclePercentage > 0.2)}}","top:-5px;left: 87","{{/if}}",'%;">','   <svg width="30" height="60" style="position: relative;left: -15px;">','       <text x="10" y="55" fill="rgb(174,174,174)" style="font-size: 10px;font-weight: bold;" transform="rotate(-90 10 55)">${endDateLabel}<tspan  x="10" dy="1.4em">${endDate}</tspan></text>',"   </svg>","</div>",'<div style="position: absolute;left:87.5%;top:51px;">','   <svg width="50" height="50">','    <text x="0" y="11" fill="rgb(70,155,219)" width="50" style="font-size: 10px;font-weight: bold;">${cycleTime}</text>','    <text x="0" y="23" fill="rgb(95,95,95)" style="font-size: 10px;font-weight: bold;">${leadTime}</text>',"   </svg>","</div>",'<svg width="100%" height="80" class="main-plot">',"   <defs>",'   <linearGradient id="cycleTime_${id}" x1="0%" y1="0%" x2="0%" y2="100%">','            <stop offset="0%" style="stop-color:rgb(186,210,239);stop-opacity:1"/>','            <stop offset="100%" style="stop-color:rgb(98,143,198);stop-opacity:1"/>',"        </linearGradient>",'        <linearGradient id="leadTime_${id}" x1="0%" y1="0%" x2="0%" y2="100%">','            <stop offset="0%" style="stop-color:rgb(178,184,194);stop-opacity:1"/>','            <stop offset="100%" style="stop-color:rgb(141,144,152);stop-opacity:1"/>',"        </linearGradient>","    </defs>",'    <rect x="6.5%" y="67" rx="3" ry="3" width="80%" height="5"','          fill="url(#leadTime_${id})" style="cursor: pointer;"/>','    <rect x="6%" y="5" width="1" height="70"','       style="fill:rgb(226,226,227);"/>','    <rect x="86.8%" y="5" width="1" height="70"','          style="fill:rgb(226,226,227);"/>',"{{if (cyclePercentage)}}",'    <rect class="lead-time-rect" x="${86-cyclePercentage*80}%" y="5" width="1" height="60"','       style="fill:rgb(226,226,227);"/>','    <rect x="${86.5-cyclePercentage*80}%" y="58" rx="3" ry="3" width="${cyclePercentage*80}%" height="5" style="cursor: pointer;"','          fill="url(#cycleTime_${id})"/>',"{{/if}}","</svg>","</div>"].join("")};
return e.register(t)}),define("tau/components/component.leadCycleTime",["Underscore","tau/components/component.creator","tau/models/model.leadCycleTime","tau/components/extensions/leadCycleTime/extension.ui.leadCycleTime","tau/ui/templates/leadCycleTime/ui.template.leadCycleTime"],function(e,t,i,n,a){return{create:function(r){var s={ModelType:i,template:a,extensions:e.union(r.extensions||[],[n])};return t.create(s,r)}}}),define("tau/ui/templates/list_/grid.entity/relation/ui.template.list.grid.entity.row.relation",["tau/core/templates-factory"],function(e){var t={name:"list.grid.entity.row.relation",markup:['<tr class="i-item-${id}{{if entityState && entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}" data-relation-id="${relation.id}">','<td class="tau-relation-type">','<span runas="property.relationType" data-context:general:id="${relation.id}" data-context:general:entity-type:name="${relation.__type}">${relation.relationType.name}</span>',"</td>",'<td class="tau-entity-id">','<a href="${url}">${id}</a>',"</td>",'<td class="tau-entity-type">','<i class="tau-entity-icon tau-entity-icon--${entityType.name.toLowerCase()}">',"${entityType.term}","</i>","</td>",'<td class="tau-entity-name">${name}</td>','<td class="tau-entity-field tau-entity-project">',"{{if project}}",'<span class="tau-icon_type_color" style="background-color: ${project.color || "transparent"}">${project.abbreviation}</span>',"{{/if}}","</td>",'<td class="tau-entity-field tau-entity-state">',"{{if entityState}}",'<div runas="property.entityState" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${entityState.name}</div>',"{{else}}","{{if hasLastStatus}}",'<div runas="property.lastStatus" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${lastStatus}</div>',"{{/if}}","{{/if}}","</td>",'<td class="tau-entity-field"><span>${release || ""}</span></td>','<td class="tau-entity-field"><span>${iteration || ""}</span></td>','<td class="tau-action">','<button class="tau-btn tau-attention i-role-remove" type="button" data-relation-id="${relation.id}">Remove</button>',"</td>","</tr>"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/request/ui.template.list.grid.entity.row.requester",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__row_requester",markup:["",'<li class="tau-list__list__item tau-list__list__item_requester" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row  ">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-avatar">','{{if avatar}}<img src="${avatar}" class="owner-avatar" />{{/if}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">',"{{if url}}",'<a href="${url}">',"{{/if}}","{{if firstName || lastName}}","${firstName} ${lastName}","{{else}}","${email}","{{/if}}","{{if url}}","</a>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-email">','<span class="tau-extension-tooltip" title="Email: ${email}">',"${email}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-login">','<span class="tau-extension-tooltip" title="Login: ${login}">',"${login}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-requesteractions">','<button class="action-detach button small" role="action-detach" type="button">Detach</button>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return e.register(t)}),define("tau/ui/templates/list_/grid.entity/testcase/ui.template.list.grid.entity.row.testcaserun",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__rowtestcaserun_testcase",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun tau-list__list__item-testcaserun-testcase" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','<a class="tau-entitylink" href="${testplanrun.url}" title="${testplanrun.name}">','<em class="tau-entity-icon tau-entity-icon--testplanrun">${testplanrun.id}</em>',"</a>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">',"${testplanrun.name}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-date">','<span class="tau-extension-tooltip" title="Run Date: ${runDate}">',"${runDate}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-release">',"{{if release}}",'<span class="tau-extension-tooltip" title="Release: ${release.name}">',"${release.name}","</span>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-iteration">',"{{if iteration}}",'<span class="tau-extension-tooltip" title="Iteration: ${iteration.name}">',"${iteration.name}","</span>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-build">',"{{if build}}",'<span class="tau-extension-tooltip" title="Build: ${build.name}">',"${build.name}","</span>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-laststatus">','<div class="ui-status ',"{{if passed === true}}","ui-status_type_passed green ","{{/if}}","{{if passed === false}}","ui-status_type_failed red ","{{if comment}}tau-extension-tooltip{{/if}}  ","{{/if}}",'{{if passed === null}}ui-status_type_na grey{{/if}}" ',"{{if comment}}",'title="Comment: \n ${comment}"',"{{/if}}",">","{{if runDate !== null}}","{{if passed === true}}","Passed","{{/if}}","{{if passed === false}}","Failed","{{/if}}","{{if passed === null}}","Skipped","{{/if}}","{{/if}}","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/user/ui.template.list.grid.entity.row.team",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__rowteam_user",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun tau-list__list__item-testcaserun-testcase" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-name" style=" white-space: nowrap;">',"${team.name}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-role">','<div runas="property.role" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${role.name}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-entityactions">','<button class="action-detach button small" role="action-detach" type="button" data-confirm-message="Removing person from team  \'${team.name}\' will unassign that person from ALL tasks, stories, bugs, etc. (except for completed). Are you sure you want to proceed?">Remove from team</button>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return e.register(t)}),define("tau/ui/templates/list_/grid.entity/user/ui.template.list.grid.entity.row.project",["tau/core/templates-factory"],function(e){var t={name:"list-grid-entity__rowproject_user",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun tau-list__list__item-testcaserun-testcase" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-name" style="white-space: nowrap;">',"${project.name}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-role">','<div runas="property.role" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${role.name}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-entityactions">','<button class="action-detach button small" role="action-detach" type="button" data-confirm-message="Removing person from project  \'${project.name}\' will unassign that person from ALL tasks, stories, bugs, etc. (except for completed). Are you sure you want to proceed?">Remove from project</button>',"</td>","</tr>","</tbody>","</table>","</li>"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/project/ui.template.list.grid.entity.row.team",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__rowteam_project",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun tau-list__list__item-testcaserun-testcase" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-name"  style=" white-space: nowrap;">',"${team.name}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-entityactions">','<button class="action-detach button small" role="action-detach" type="button" ',"data-confirm-message=\"Detach project from team  '${team.name}' blablabla. Are you sure you want to proceed?\">Remove from team</button>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return e.register(t)}),define("tau/ui/templates/list_/grid.entity/team/ui.template.list.grid.entity.row.project",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__rowproject_team",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun tau-list__list__item-testcaserun-testcase" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-name">',"${project.name}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-entityactions">','<button class="action-detach button small" role="action-detach" type="button" ',"data-confirm-message=\"Detach team from team  '${project.name}' blablabla. Are you sure you want to proceed?\">Remove from team</button>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/team/ui.template.list.grid.entity.row.member",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"list-grid-entity__rowmember_team",engine:"jqote2",markup:["",'<li class="tau-list__list__item tau-list__list__item_requester" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row  ">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-name">','<a href="${url}">',"${user.name}","</a>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-avatar">',"{{if user.avatarUri}}",'<img src="${user.avatarUri}24" class="owner-avatar" />',"{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-login">','<div runas="property.role" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${role.name}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','<span class="tau-extension-tooltip" title="Email: ${user.email}">',"${user.email}","</span>","</td>",'<td class="tau-list__table__cell" style="width:20px;">','<span class="property" title="is admin"><div class="ui-checkbox {{if user.isAdmin}}checked{{else}}unchecked{{/if}}">&nbsp;</div></span>',"</td>",'<td class="tau-list__table__cell" style="width:20px;">','<span class="property" title="is active"><div class="ui-checkbox {{if user.isActive}}checked{{else}}unchecked{{/if}}">&nbsp;</div></span>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-requesteractions">','<button class="action-detach button small" role="action-detach" type="button">Detach</button>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};
return e.register(t)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun","tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun","tau/ui/templates/list_/grid.entity/userstory/ui.template.list.grid.entity.row.testcase","tau/ui/templates/list_/grid.entity/relation/ui.template.list.grid.entity.row.relation","tau/ui/templates/list_/grid.entity/request/ui.template.list.grid.entity.row.requester","tau/ui/templates/list_/grid.entity/testcase/ui.template.list.grid.entity.row.testcaserun","tau/ui/templates/list_/grid.entity/user/ui.template.list.grid.entity.row.team","tau/ui/templates/list_/grid.entity/user/ui.template.list.grid.entity.row.project","tau/ui/templates/list_/grid.entity/project/ui.template.list.grid.entity.row.team","tau/ui/templates/list_/grid.entity/team/ui.template.list.grid.entity.row.project","tau/ui/templates/list_/grid.entity/team/ui.template.list.grid.entity.row.member","tau/ui/templates/list_/grid.entity/relation/ui.template.list.grid.entity.row.relation","tau/ui/templates/list_/ui.template.list.comment"],function(e){var t={name:"list-grid-entity",markup:['<div class="tau-list">',"   {{if isEmpty === true}}",'       <div class="tau-list__empty-message">${config.currentView.emptyMessage}</div>',"   {{else}}",'       <div class="tau-list__content">',"           {{if groups && groups.length}}",'               {{tmpl(groups) "list-grid-entity__group"}}',"           {{/if}}","           {{if items && items.length}}",'               <div class="tau-list__group tau-list__group_flat_true" role="group">','                   <ul class="tau-list__list" role="list">',"                       {{tmpl(items) $item.data.config.currentView.rowTemplateName}}","                   </ul>","               </div>","           {{/if}}","       </div>","   {{/if}}",'   <div class="tau-list__comment-holder">','       {{tmpl({}) "list-grid__comment"}}',"   </div>","</div>"],dependencies:["list-grid-entity__group","list-grid-entity__row","list-grid-entity__rowtestplanrun","list-grid-entity__rowtestcaserun","list-grid-entity__rowtestcase","list.grid.entity.row.relation","list-grid-entity__row_requester","list-grid-entity__rowtestcaserun_testcase","list-grid-entity__rowteam_user","list-grid-entity__rowproject_user","list-grid-entity__rowteam_project","list-grid-entity__rowproject_team","list-grid-entity__rowmember_team","list-grid__comment"]};
return e.register(t)}),define("tau/ui/extensions/list/extension.list.editable.progress",["tau/components/extensions/component.extension.base"],function(e){return e.extend({name:"extension.list.editable.progress",category:"edit","bus afterRender":function(e){var t=e.data.element;t.addClass("tau-list-editable")}})}),define("tau/components/component.list.editable",["Underscore","tau/components/component.list","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity","tau/ui/extensions/list/extension.list.editable.progress","tau/views/view.compositeControl"],function(e,t,i,n,a){return{create:function(r){return r=e(r).defaults({ViewType:a,template:r.template||i,extensions:[],dependencies:["title","property.severity","property.priority","property.relationType","property.entityState","assignmentsList","property.effort","progressBar.small","property.release","property.responsible","property.iteration","property.build","property.build.testPlanRun","property.lastStatus","property.lastRunDate.list","property.status.testCaseRun","property.completeDate","property.endDate.list","property.role","property.role.modern","property.startDate.projectMember","property.endDate.projectMember","menu.testPlanRun","entity.quickAddTrigger","entity.menuTrigger","description","testStepList","testStepRunList"]}),r.extensions.push(n),t.create(r)}}}),define("tau/ui/templates/board.page/ui.template.board.page.container",["tau/core/templates-factory"],function(e){var t={name:"container.boardPlus",engine:"jqote2",markup:['<div role="app-body" class="tau-app-body">','    <header role="header" class="tau-app-header">',"    </header>",'    <div role="main" class="tau-app-main-pane tau-layout tau-layout-board"></div>','    <aside role="aside" class="tau-app-secondary-pane"></aside>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/board.plus/ui.template.boardplus.container",["Underscore","tau/core/templates-factory"],function(e,t){var i={name:"boardplus.container",engine:"jqote2",markup:['<div class="tau-board tau-board_animate_false">',"</div>"],dependencies:[]};
return t.register(i)}),define("tau/ui/extensions/board.page/ui.extension.board.page.collapser",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({configFieldName:"collapser_aside_collapsed","bus beforeInit + afterRender":function(t,i,n){var a=i.config.context.configurator,r=a.getSettingsManager(),s=n.element,o=this.configFieldName,l=s.filter("[role=app-body]:first");this.fire("$appBody.ready",l),this.fire("configurator.ready",a),r.get({fields:[o],callback:e.bind(function(e){this.fire("isCollapsed.ready",!!e[o])},this)}),r.unbind({listener:this}),r.bind({fields:[o],listener:this,callback:e.bind(function(e){this.fire("isCollapsed.ready",!!e[o])},this)})},"bus $appBody.ready:last + configurator.ready:last + isCollapsed.ready":function(e,i,n,a){var r=i.hasClass("tau-sp-collapsed");r!=a&&(i.toggleClass("tau-sp-collapsed",a),t(n.getWindow()).trigger("resize"))},"bus configurator.ready+destroy":function(e,t){var i=t.getSettingsManager();i.unbind({listener:this})}})}),define("tau/ui/extensions/board.container/ui.extension.board.container.editMode",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus childrenBuses.ready + afterRender:last + boardSettings.ready:last":function(e,t,i,n){var a=this,r=t.board_editor_container;r&&(r.on("boardSettings.cardSetIsEmpty",function(){a._showEmptyCardsSetNotification(i.element.find(".tau-board-settings-cards h4"),r)}),n.boardSettings.bind({fields:["emptyCardsSet"],listener:this,callback:function(){a._showEmptyCardsSetNotification(i.element.find(".tau-board-settings-cards h4"),r)}}))},"bus beforeInit:last + boardSettings.ready:last + afterRender":function(e,t,i,n){var a=i.boardSettings,r=n.element,s=t.config.context.configurator.getLoggedUser(),o=t.config.context.configurator.getBoardAccessService(),l=t.config.context.configurator.getRouting();a.get({fields:["ownerIds","edit","isDraft"],callback:function(e){var t=!!e.edit;
e.cells.types&&0===e.cells.types.length&&(t=!0,a.set({set:{edit:!0}})),e.isDraft&&!o.isEditable(e,s)&&(t=!1,a.set({set:{edit:!1}}));var i=l.getUrl().url;if(i.indexOf("&openSetup=")>-1){t=!0,a.set({set:{edit:!0}});var n=i.replace("&openSetup=","");l.setUrl(n)}r.toggleClass("tau-settings-active",t)}}),a.unbind({listener:this}),a.bind({fields:["edit","editMore"],listener:this,callback:function(e){r.toggleClass("tau-settings-active",e.edit||!1)}})},_showEmptyCardsSetNotification:function(e,t){t.fire("tab.activate","setup"),e.addClass("tau-attention"),e.animateWithCss({cssClassName:"tau-attention-shake"})}})}),define("tau/ui/extensions/board.container/ui.extension.board.container.viewMode",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterInit + boardSettings.ready":function(e,t,i){var n=i.boardSettings,a=this;n.unbind({listener:this}),n.bind({fields:["viewMode"],listener:this,callback:function(){a.fire("refresh")}})}})}),define("tau/ui/extensions/board.container/ui.extension.board.container.clearSelection",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender":function(e,t){t.element.on("mousedown",'[role="aside"],.i-role-board-body-holder,[role="clipboard-body"]',function(){$.clearSelection()})}})}),define("tau/components/board.changelog/extensions/ui.extension.board.changelog.base",["jQuery","Underscore","tau/core/extension.base","tau/components/board.changelog/controllers/controller.board.changelog","tau/components/board.changelog/models/model.board.changelog"],function(e,t,i){return i.extend({init:function(e){this._super(e)},_afterInitialize:function(){},"bus initialize":function(e,t){this._controller=t.context.configurator.getChangelogController(),this._afterInitialize()}})}),define("tau/components/board.changelog/extensions/ui.extension.board.changelog.checker",["jQuery","Underscore","tau/components/board.changelog/extensions/ui.extension.board.changelog.base"],function(e,t,i){return i.extend({_afterInitialize:function(){this._controller.checkNewVersion(),this._super()
}})}),define("tau/ui/extensions/ui.extension.board.listeners",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({init:function(e){this._super(e),this.configurator=e.context.configurator,this.configurator.registerService("currentBoard",{$element:null})},"bus childComponentCreated":function(e,t){"board.plus.container"===t.name&&(t.on("childComponentCreated",function(e){e.data.on("model.sliceInfo.retrieved",function(e,t){this.configurator.service("currentBoard").sliceInfo=t},this)},this),t.on("afterRender",function(e){this.configurator.service("currentBoard").$element=e.data.element},this))}})}),define("tau/components/side.menu.switcher/extensions/side.menu.switcher.extension",["require","Underscore","tau/core/extension.base"],function(e){var t=e("Underscore"),i=e("tau/core/extension.base");return i.extend({init:function(e){this._super(e);var t=e.context.configurator;this._routing=t.getRouting(),this._showProcessSetup=null,this._onRouteChanged(this._routing.getCurrentRoute()),this._routing.routeChanged.add(this._onRouteChanged,this)},_processSetupRouteNames:["process-setup-terms","process-setup-general","process-setup-workflow"],_onRouteChanged:function(e){this.fire(t.contains(this._processSetupRouteNames,e.route.name)?"process.setup.start":"process.setup.close")},"bus componentsCreated:last + boardSettings.ready":function(e,t,i){this._fireOnChildren(t,"boardSettings.ready",i)},"bus componentsCreated:last + view.dom.ready":function(e,t,i){this._fireOnChildren(t,"view.dom.ready",i)},"bus configurator.ready:last + componentsCreated:last + afterRender":function(e,t,i,n){this._subscribe(t,n.element,i)},"bus configurator.ready:last + componentsCreated:last + afterRender:last + process.setup.start":function(e,t,i,n){this._toggleProcessSetup(t,n.element,i,!0)},"bus configurator.ready:last + componentsCreated:last + afterRender:last + process.setup.close":function(e,t,i,n){this._toggleProcessSetup(t,n.element,i,!1)},"bus configurator.ready:last + toggle.collapser":function(e,t,i){var n=t.getComponentBusRegistry();
n.getByName("board.collapser.aside").then(function(e){e.fire(i)})},_subscribe:function(e,t,i){var n=this._toggleProcessSetup.bind(this,e,t,i,!0),a=this._toggleProcessSetup.bind(this,e,t,i,!1);this.bus.getGlobalBus().on("process.setup.start",n),this._onChildEvent(i,"process.setup.close",a)},_toggleProcessSetup:function(e,t,i,n){if(this._showProcessSetup===n)return void this._fireOnChildren(i,"_process.changed");this._showProcessSetup=n,t.find("[role=process-setup]").toggle(n),t.find("[role=board-menu]").toggle(!n);var a=n?"_process.setup.start":"_process.setup.close";this._fireOnChildren(i,a),this.fire("toggle.collapser",n?"disable":"enable")},_fireOnChildren:function(e,i,n){t.each(e,function(e){e.component.fire(i,n)})},_onChildEvent:function(e,i,n){t.each(e,function(e){e.component.on(i,n)})},destroy:function(){this._routing.routeChanged.remove(this),this._super()}})}),define("template!tau/components/side.menu.switcher/templates/side.menu.switcher.template",["tau/core/templates-factory"],function(e){var t={name:"side.menu.container",engine:"jqote2",customFunctions:null,markup:'<div class="i-role-side-menu-container"> <div role="board-menu"></div> <div role="process-setup"></div> </div>'};return e.register(t)}),define("tau/components/process.menu/services/process.service",["require","Underscore","jQuery","tau/utils/utils.serverErrorTranslator","tau/core/class","tau/libs/store2/store2"],function(e){"use strict";var t=e("Underscore"),i=e("jQuery"),n=e("tau/utils/utils.serverErrorTranslator"),a=e("tau/core/class"),r=e("tau/libs/store2/store2");return a.extend({MAX_PROCESS_COUNT:1e3,init:function(e){this._configurator=e,this._store2=new r(e)},_requiredFields:["Id","Name","IsDefault","Projects.Select(Name) as Projects","Practices.Select(Name) as Practices","Terms.Select({WordKey,Value}) as Terms"].join(","),getProcesses:function(){return this._store2.findAll("process?select={"+this._requiredFields+"}&take="+this.MAX_PROCESS_COUNT)},updateProcess:function(e,i){return this._getStore().saveDef("process",{$set:t.extend(i,{id:e})}).then(function(e){return e.data
},function(e){this._handleXhrErrorRequest(e.data)}.bind(this))},deleteProcess:function(e){return this._getStore().removeDef("process",{id:e}).then(function(){return e},function(e){this._handleXhrErrorRequest(e.data)}.bind(this))},cloneProcess:function(e){return i.ajax({type:"POST",contentType:"application/json",dataType:"json",data:"{}",url:[this._configurator.getApplicationPath(),"/api/v1/Processes/",e,"/clone"].join("")}).fail(this._handleXhrErrorRequest.bind(this))},_getStore:function(){return this._configurator.getStore()},_handleXhrErrorRequest:function(e){this._configurator.service("errorBar").fire("error",n.translateXhrError(e))}})}),define("tau/components/setup.process/process.optionGroups",["require","tau/core/class","Underscore"],function(e){"use strict";var t=e("tau/core/class"),i=e("Underscore"),n={Practices:"practices",CustomFields:"custom-fields",Terms:"terms",ProcessAdmins:"process-admins",Workflows:"workflows"},a=t.extend({init:function(e,t,i){this._urlBuilder=e,this._processId=i},getTp3Url:function(){return this._urlBuilder.getProcessSetupPage(this._processId,this.getId())}}),r=a.extend({getTp2Url:function(){return this._urlBuilder.getAdminWorkflowEdit(this._processId)},getTp3Url:function(e){return this._urlBuilder.getWorkflowSetupPage(this._processId,e)},getTitle:function(){return"Workflows"},getId:function(){return n.Workflows}}),s=a.extend({getTp2Url:function(){return this._urlBuilder.getAdminAdminDelegateEdit(this._processId)},getTitle:function(){return"Process Admins"},getId:function(){return n.ProcessAdmins}}),o=a.extend({getTp2Url:function(){return this._urlBuilder.getAdminCustomFieldsEdit(this._processId)},getTitle:function(){return"Custom Fields"},getId:function(){return n.CustomFields}}),l=a.extend({getTp2Url:function(){return this._urlBuilder.getAdminPracticesEdit(this._processId)},getTitle:function(){return"Practices"},getId:function(){return n.Practices}}),u=a.extend({getTp2Url:function(){throw new Error("tp2 version is not supported")},getTitle:function(){return"Terms"
},getId:function(){return n.Terms}}),c=i.object([[n.Practices,l],[n.Workflows,r],[n.CustomFields,o],[n.Terms,u],[n.ProcessAdmins,s]]);return{create:function(e,t,i){var n=c[t];return new n(e,t,i)},groups:n}}),define("tau/components/setup.workflow/models/workflow.entitytypes",[],function(){return[{id:"epic",practice:"Requirements"},{id:"feature",practice:"Requirements"},{id:"userstory",practice:"Planning"},{id:"request",practice:"Help Desk"},{id:"bug",practice:"Bug Tracking"},{id:"task",practice:"Planning"},{id:"testplan",practice:"Test Cases"},{id:"testplanrun",practice:"Test Cases"}]}),define("tau/components/process.menu/models/process.menu.model",["require","tau/core/class","tau/components/setup.process/process.optionGroups","tau/components/setup.workflow/models/workflow.entitytypes","jQuery","Underscore","tau/core/termProcessor"],function(e){"use strict";var t=e("tau/core/class"),i=e("tau/components/setup.process/process.optionGroups"),n=e("tau/components/setup.workflow/models/workflow.entitytypes"),a=e("jQuery"),r=e("Underscore"),s=e("tau/core/termProcessor");return t.extend({init:function(e,t,i){this.processesChanged=r.Callbacks(),this.activePageChanged=r.Callbacks(),this._processService=e,this._routing=t,this._urlBuilder=i,this._processes=null,this.processesChanged.add(this._initializeActiveProcess,this)},getActivePage:function(){return r.pick(this._routing.getCurrentRoute().args,"processId","optionGroupId","entityType")},setActivePage:function(e){e=r.defaults(e||{},this.getActivePage(),{optionGroupId:i.groups.Workflows});var t=r.find(this._processes,function(t){return t.id===e.processId});if(t){var n=r.pluck(t.entityTypes,"entityType");r.contains(n,e.entityType)||(e.entityType=r.first(n))}this.activePageChanged.fire(e);var a=i.create(this._urlBuilder,e.optionGroupId,e.processId);this._routing.redirect(a.getTp3Url(e.entityType))},_initializeActiveProcess:function(e){var t=r.pluck(e,"id"),i=r.contains(t,this.getActivePage().processId);r.size(e)&&!i&&this.setActivePage({processId:r.first(t)})
},refresh:function(){return this._processService.getProcesses().then(function(e){this._processes=r.map(e,function(e){var t=new s(e.terms),i=r.chain(n).filter(function(t){return r.contains(e.practices,t.practice)}).pluck("id").map(function(e){return{entityType:e,terms:r.pick(t.getTerms(e),"name","iconSmall")}}).value();return r.extend(r.pick(e,["id","name","projects","isDefault"]),{entityTypes:i})},this),this.processesChanged.fire(this._processes)}.bind(this))},renameProcess:function(e,t){this._processes=r.map(this._processes,function(i){return i.id===e&&(i.name=t),i}),this.processesChanged.fire(this._processes),this._processService.updateProcess(e,{name:t}).fail(function(){this.refresh()}.bind(this))},cloneProcess:function(e){return this._processService.cloneProcess(e.id).then(function(e){return a.when(e.Id,this.refresh())}.bind(this))},deleteProcess:function(e){this._processService.deleteProcess(e.id).then(function(e){e&&(this._processes=r.filter(this._processes,function(t){return t.id!==e}),this.processesChanged.fire(this._processes))}.bind(this),this.refresh.bind(this))},destroy:function(){this.processesChanged.removeAll(),this.activePageChanged.removeAll()}})}),define("jsx!tau/components/process.menu/views/process.menu.view",["require","libs/react/react-ex","Underscore"],function(e){var t=e("libs/react/react-ex"),i=e("Underscore");return t.defineClass(["item.view","process.context.menu.service"],function(e,n){return{_renameProcessStart:function(e){this.setState({renamingId:e.id})},_renameProcessFinish:function(){this.setState({renamingId:null})},getDefaultProps:function(){return{actions:{renameProcessStart:i.identity,renameProcess:i.identity,renameProcessFinish:i.identity,cloneProcess:i.identity,deleteProcess:i.identity}}},getInitialState:function(){return{processes:null}},render:function(){if(!this.state.processes)return t.DOM.div({className:"t3-views-navigator t3-processes-navigator"},t.DOM.div({className:"tau-loader"}));var a=new n;a.renameProcessTriggered.add(this._renameProcessStart),a.cloneProcessTriggered.add(this.props.actions.cloneProcess),a.deleteProcessTriggered.add(this.props.actions.deleteProcess);
var r=i.map(this.state.processes,function(t){var i=t.id===this.props.activePage.processId,n=t.id===this.state.renamingId;return new e({key:t.id,process:t,active:i,isInDom:this.state.isInDom,activePage:this.props.activePage,urlBuilder:this.props.urlBuilder,showContextMenu:this._showContextMenu,setActivePage:this.props.setActivePage,isBeingRenamed:n,processContextMenuService:a,renameProcessAction:this.props.actions.renameProcess,cloneProcessAction:this.props.actions.cloneProcess,renameProcessFinish:this._renameProcessFinish})},this);return t.DOM.div({className:"t3-views-navigator t3-processes-navigator"},t.DOM.div({className:"t3-process__title-navigation t3-processes__title"},"Processes",t.DOM.button({type:"button",className:"tau-btn tau-settings-close t3-processes__close i-role-close"},"Finish")),t.DOM.div({className:"t3-process__catalog"},r))}}})}),define("tau/components/process.menu/controllers/process.menu.controller",["require","tau/core/class","libs/react/react-ex","../services/process.service","../models/process.menu.model","jQuery","jsx!../views/process.menu.view"],function(e){"use strict";var t=e("tau/core/class"),i=e("libs/react/react-ex"),n=e("../services/process.service"),a=e("../models/process.menu.model"),r=e("jQuery"),s=e("jsx!../views/process.menu.view");return t.extend({init:function(e,t,o){this._container=o;var l=new n(e),u=e.getRouting(),c=e.getUrlBuilder();this._model=new a(l,u,c),this._viewIsInDom=r.Deferred();var d=i.resolveClass(t,s,{urlBuilder:e.getUrlBuilder(),activePage:this._model.getActivePage(),setActivePage:this._model.setActivePage.bind(this._model),actions:{renameProcess:this._model.renameProcess.bind(this._model),cloneProcess:this._cloneProcess.bind(this),deleteProcess:this._model.deleteProcess.bind(this._model)}});this._view=i.renderComponent(d,this._container),this._model.processesChanged.add(this._onProcessesChanges,this),this._model.activePageChanged.add(function(e){this._view.setProps({activePage:e})},this),r.when(this._model.refresh(),this._viewIsInDom).then(function(){this._view.setState({isInDom:!0})
}.bind(this)),r.contains(document.documentElement,this._container)&&this.markAsInDom()},_cloneProcess:function(e){this._model.cloneProcess(e).then(function(e){this._model.setActivePage({processId:e})}.bind(this))},updateActivePage:function(){this._model.setActivePage()},markAsInDom:function(){this._viewIsInDom.resolve()},destroy:function(){i.unmountComponentAtNode(this._container),this._model.destroy(),this._model=null,this._view=null},_onProcessesChanges:function(e){this._view.setState({processes:e})}})}),define("tau/components/process.menu/extensions/process.menu.extension",["require","tau/core/extension.base","../controllers/process.menu.controller"],function(e){var t=e("tau/core/extension.base"),i=e("../controllers/process.menu.controller");return t.extend({"bus afterInit":function(){this.fire("dataBind")},"bus afterRender":function(e,t){t.element.on("click",".i-role-close",this.fire.bind(this,"process.setup.close"))},"bus afterInit:last + afterRender:last + processes.config.ready:last + _process.setup.start":function(e,t,n,a){this._controller=new i(t.config.context.configurator,a.serviceScope,n.element[0])},"bus view.dom.ready":function(){this._controller&&this._controller.markAsInDom()},"bus _process.changed":function(){this._controller&&this._controller.updateActivePage()},"bus _process.setup.close":function(){this._controller&&(this._controller.destroy(),this._controller=null)}})}),define("template!tau/components/tauBubble/templates/board.bubble",["tau/core/templates-factory"],function(e){var t={name:"board.bubble",engine:"jqote2",customFunctions:null,markup:'<div class="tau-bubble-board"> <div class="tau-bubble-board__arrow" role="arrow"></div> <div class="tau-bubble-board__inner tau-container" role="content"></div> </div>'};return e.register(t)}),define("template!tau/components/process.menu/templates/affected.projects.template",["tau/core/templates-factory"],function(e){var t={name:"affected.projects",engine:"jqote2",customFunctions:null,markup:'<ul class="t3-processes-navigator--affected-projects"> <% _.each(this.projects, function(projectName) { %> <li class="t3-processes-navigator--affected-projects--item"><%= projectName %></li> <% }); %> </ul>'};
return e.register(t)}),define("jsx!tau/components/process.menu/views/process.menu.item.view",["require","jQuery","libs/react/react-ex","tau/components/setup.process/process.optionGroups","tau/services/rename.service","template!tau/components/tauBubble/templates/board.bubble","template!tau/components/process.menu/templates/affected.projects.template"],function(e){var t=e("jQuery"),i=e("libs/react/react-ex"),n=e("tau/components/setup.process/process.optionGroups"),a=e("tau/services/rename.service"),r=e("template!tau/components/tauBubble/templates/board.bubble"),s=e("template!tau/components/process.menu/templates/affected.projects.template"),o=i.createClass({displayName:"ProcessUsageSummary",_getProjectsCount:function(){return this.props.process.projects.length},_getAffectedProjectsSummary:function(){var e=this._getProjectsCount();if(e>0)return"Changes affect "+e+" project(s)";var t="The process is not used.";return this.props.process.isDefault||(t+=" You can delete it."),t},_toggleProjectsBubble:function(){this._getProjectsCount()&&t(this.getDOMNode()).tauBubble({className:"tau-bubble-tooltipArticle",template:r.render(),onPositionConfig:function(e){e.collision="fit",e.my="left",e.at="right center"},hideOnScroll:!0,hideOnScrollContainer:".t3-process__catalog",content:s.render({projects:this.props.process.projects}),zIndex:999,onHide:function(){this.destroy()},onResize:function(e){var t=e.find("[role=content]"),i=e.outerHeight()-t.height();t.css({maxHeight:window.document.body.offsetHeight-i,overflowY:"auto"})}}).tauBubble("toggle")},render:function(){var e=this.props.process.projects.length>0,t=i.addons.classSet({"t3-process__text":!0,"t3-process__link":e});return i.DOM.div({className:t,onClick:this._toggleProjectsBubble},this._getAffectedProjectsSummary())}});return i.defineClass(["item.optionGroup.view","item.optionGroup.workflows.view"],function(e,r){return{_activate:function(){this.props.setActivePage({processId:this.props.process.id})},_selectProcess:function(){this._activate()
},_showContextMenu:function(e){var i=t(this.refs.title.getDOMNode());this.props.processContextMenuService.showMenuForProcess(i,this.props.process),e.preventDefault(),e.stopPropagation()},getInitialState:function(){return{bodyHeight:"auto"}},componentDidUpdate:function(){if(this.props.isBeingRenamed){var e=this.refs.header.getDOMNode();a.startRenamingActivity(e).done(function(e){this.props.renameProcessAction(this.props.process.id,e)}.bind(this)).always(function(){this.props.renameProcessFinish()}.bind(this))}},componentWillReceiveProps:function(e){var i=!this.props.isInDom&&e.isInDom;i&&this.setState({bodyHeight:t(this.getDOMNode()).find(".t3-process__body").height()})},render:function(){var t=this.props.active||!this.props.isInDom,a=null;t&&(a=_.map(n.groups,function(t){var i=n.create(this.props.urlBuilder,t,this.props.process.id),a=this.props.activePage.optionGroupId==i.getId(),s={key:t,optionGroup:i,active:a,activePage:this.props.activePage,setActivePage:this.props.setActivePage};return n.groups.Workflows==i.getId()?(_.extend(s,{entityTypes:this.props.process.entityTypes}),new r(s)):new e(s)},this));var s=i.addons.classSet({"t3-process__item t3-process__item--outer":!0,"t3-active":t}),l=this.props.isBeingRenamed?null:this._selectProcess;return i.DOM.div({className:s,role:"process"},i.DOM.div({className:"t3-process__item__title",role:"title",ref:"title",onClick:l},i.DOM.div({className:"t3-actions-trigger",onClick:this._showContextMenu}),i.DOM.div({className:"t3-process__counter"},this.props.process.projects.length),i.DOM.div({className:"t3-header",ref:"header"},this.props.process.name),o({process:this.props.process})),i.DOM.div({className:"t3-process__body",style:{height:t?this.state.bodyHeight:0}},a))}}})}),define("jsx!tau/components/process.menu/views/process.menu.item.optionGroup.view",["require","libs/react/react-ex","Underscore"],function(e){{var t=e("libs/react/react-ex");e("Underscore")}return t.defineClass([],function(){return{_activate:function(){this.props.setActivePage({optionGroupId:this.props.optionGroup.getId()})
},render:function(){var e=t.addons.classSet({"t3-process__item":!0,"t3-active":this.props.active});return t.DOM.div({className:e,role:"process-option-group"},t.DOM.a({href:"#",onClick:this._activate,role:"process-option-group-title",className:"t3-process__item__title"},t.DOM.div({className:"t3-name"},this.props.optionGroup.getTitle())))}}})}),define("jsx!tau/components/process.menu/views/process.menu.item.optionGroup.workflows.view",["require","libs/react/react-ex","Underscore"],function(e){var t=e("libs/react/react-ex"),i=e("Underscore");return t.defineClass([],function(){return{_onSelectEntityType:function(e){this.props.setActivePage({entityType:e,optionGroupId:this.props.optionGroup.getId()})},render:function(){var e=i.map(this.props.entityTypes,function(e){var i=e.entityType,n=i===this.props.activePage.entityType&&this.props.active,a=t.addons.classSet({"t3-active":n,"t3-process__list__item":!0});return t.DOM.li({className:a,key:i,onClick:this._onSelectEntityType.bind(this,i)},t.DOM.i({className:"tau-entity-icon tau-entity-icon--"+i},e.terms.iconSmall),e.terms.name)},this);return t.DOM.div({className:"t3-process__item t3-process__item-submenu",role:"process-option-group"},t.DOM.div({role:"process-option-group-title",className:"t3-process__item__title"},t.DOM.div({className:"t3-name"},t.DOM.strong(null,this.props.optionGroup.getTitle()))),t.DOM.ul({className:"t3-process__list"},e))}}})}),define("tau/components/process.menu/services/context.menu.items/process.rename",["require","tau/core/class","Underscore"],function(e){var t=e("tau/core/class"),i=e("Underscore");return t.extend({init:function(){this.onTrigger=i.Callbacks()},getMenuItemClassName:i.constant("i-role-menu-action-rename"),getContent:i.constant("Rename"),getTooltipText:i.constant("Rename this Process"),actionHandler:function(e){taus.track({action:"rename process from menu",tags:["processMenu"]}),this.onTrigger.fire(e.process),e.destroyBubble()}})}),define("tau/components/process.menu/services/context.menu.items/process.clone",["require","tau/core/class","Underscore"],function(e){var t=e("tau/core/class"),i=e("Underscore");
return t.extend({init:function(){this.onTrigger=i.Callbacks()},getMenuItemClassName:i.constant("i-role-menu-action-clone"),getContent:i.constant("Clone"),getTooltipText:i.constant("Clone this Process"),actionHandler:function(e){taus.track({action:"clone process from menu",tags:["processMenu"]}),this.onTrigger.fire(e.process),e.destroyBubble()}})}),define("tau/components/process.menu/services/context.menu.items/process.delete",["require","tau/core/class","Underscore"],function(e){var t=e("tau/core/class"),i=e("Underscore");return t.extend({init:function(){this.onTrigger=i.Callbacks()},shouldRender:function(e){var t=e.process;return 0===t.projects.length&&!t.isDefault},getMenuItemClassName:i.constant("i-role-menu-action-delete drop-down-option-danger"),getContent:i.constant("Delete"),getTooltipText:i.constant("Delete this Process"),whenRendered:function(e,t){t.tauConfirm({content:"<h3>Do you really want to delete this Process?</h3>",callbacks:{success:function(){taus.track({action:"delete process from menu",tags:["processMenu"]}),this.onTrigger.fire(e.process),e.destroyBubble()}.bind(this)},zIndex:1e3})}})}),define("tau/components/process.menu/services/process.menu.context.menu.service",["require","Underscore","tau/services/context.menu/context.menu.service","./context.menu.items/process.rename","./context.menu.items/process.clone","./context.menu.items/process.delete"],function(e){var t=e("Underscore"),i=e("tau/services/context.menu/context.menu.service"),n=e("./context.menu.items/process.rename"),a=e("./context.menu.items/process.clone"),r=e("./context.menu.items/process.delete");return i.extend({init:function(){this.renameProcessTriggered=t.Callbacks(),this.cloneProcessTriggered=t.Callbacks(),this.deleteProcessTriggered=t.Callbacks();var e=new n,i=new a,s=new r;e.onTrigger.add(this.renameProcessTriggered.fire,this.renameProcessTriggered),i.onTrigger.add(this.cloneProcessTriggered.fire,this.cloneProcessTriggered),s.onTrigger.add(this.deleteProcessTriggered.fire,this.deleteProcessTriggered),this._processMenuItems=[e,i,this._createSeparator(),s]
},_isElementVisible:t.constant(!0),_getContainerSelector:t.constant(".t3-processes-navigator"),_getScrollContainerSelector:t.constant(".t3-processes-navigator"),showMenuForProcess:function(e,t){var i={process:t,$target:e,options:{className:"t3-processes-navigator-bubble"}};this._showMenu(this._processMenuItems,i)}})}),define("tau/components/process.menu/extensions/process.menu.config.extension",["require","tau/core/extension.base","tau/core/injector","jsx!../views/process.menu.item.view","jsx!../views/process.menu.item.optionGroup.view","jsx!./../views/process.menu.item.optionGroup.workflows.view","../services/process.menu.context.menu.service"],function(e){var t=e("tau/core/extension.base"),i=e("tau/core/injector"),n=e("jsx!../views/process.menu.item.view"),a=e("jsx!../views/process.menu.item.optionGroup.view"),r=e("jsx!./../views/process.menu.item.optionGroup.workflows.view"),s=e("../services/process.menu.context.menu.service");return t.extend({"bus afterInit":function(){var e=new i;e.register("process.context.menu.service",s),e.register("item.optionGroup.view",e.createModule(a)),e.register("item.optionGroup.workflows.view",e.createModule(r)),e.register("item.view",e.createModule(n));var t={serviceScope:e};this.fire("processes.config.ready",t)}})}),define("tau/components/component.process.menu",["require","tau/components/process.menu/extensions/process.menu.extension","tau/components/process.menu/extensions/process.menu.config.extension","tau/components/component.creator"],function(e){var t=e("tau/components/process.menu/extensions/process.menu.extension"),i=e("tau/components/process.menu/extensions/process.menu.config.extension"),n=e("tau/components/component.creator");return{create:function(e){e=e||{};var a={extensions:[t,i],template:{engine:"jqote2",markup:['<div class="i-role-placeholder"></div>']}};return n.create(a,e)}}}),define("tau/components/component.side.menu.switcher",["require","Underscore","./side.menu.switcher/extensions/side.menu.switcher.extension","./component.container","tau/core/helpers/extension.configurator","template!./side.menu.switcher/templates/side.menu.switcher.template","./component.board.menu","./component.process.menu"],function(e){var t=e("Underscore"),i=e("./side.menu.switcher/extensions/side.menu.switcher.extension"),n=e("./component.container"),a=e("tau/core/helpers/extension.configurator"),r=e("template!./side.menu.switcher/templates/side.menu.switcher.template");
return e("./component.board.menu"),e("./component.process.menu"),{create:function(e){var s={layout:"selectable",extensions:[i,a].concat(e.extensions||[]),children:[{name:"board_menu",type:"board.menu",selector:"[role=board-menu]",layout:"replaceable"},{name:"process_menu",type:"process.menu",selector:"[role=process-setup]",layout:"replaceable"}],template:r};return n.create(t.extend(e,s))}}}),define("tau/configurations/board.container.config",["require","tau/core/class","tau/ui/templates/board.page/ui.template.board.page.container","tau/ui/templates/board.plus/ui.template.boardplus.container","tau/ui/extensions/board.page/ui.extension.board.page.collapser","tau/ui/extensions/board.container/ui.extension.board.container.editMode","tau/ui/extensions/board.container/ui.extension.board.container.viewMode","tau/ui/extensions/board.container/ui.extension.board.container.clearSelection","tau/components/board.changelog/extensions/ui.extension.board.changelog.checker","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/ui.extension.board.listeners","tau/components/component.board.main.menu","tau/components/component.container","tau/components/component.global.context.control","tau/components/component.board.clear.sample.data","tau/components/component.board.collapser.aside","tau/components/component.board.general.quick.add","tau/components/component.board.clipboard","tau/components/component.board.entityViewer","tau/components/component.board.toolbar","tau/components/component.board.editor.container","tau/components/component.board.plus.container","tau/components/component.board.plus","tau/components/component.board.plus.list","tau/components/component.board.new.list","tau/components/component.board.plus.timeline","tau/components/component.side.menu.switcher","tau/components/component.board.menu"],function(e){var t=e("tau/core/class"),i=e("tau/ui/templates/board.page/ui.template.board.page.container"),n=e("tau/ui/templates/board.plus/ui.template.boardplus.container"),a=e("tau/ui/extensions/board.page/ui.extension.board.page.collapser"),r=e("tau/ui/extensions/board.container/ui.extension.board.container.editMode"),s=e("tau/ui/extensions/board.container/ui.extension.board.container.viewMode"),o=e("tau/ui/extensions/board.container/ui.extension.board.container.clearSelection"),l=e("tau/components/board.changelog/extensions/ui.extension.board.changelog.checker"),u=e("tau/components/extensions/error/extension.errorBar"),c=e("tau/ui/extensions/ui.extension.board.listeners");
return e("tau/components/component.board.main.menu"),e("tau/components/component.container"),e("tau/components/component.global.context.control"),e("tau/components/component.board.clear.sample.data"),e("tau/components/component.board.collapser.aside"),e("tau/components/component.board.general.quick.add"),e("tau/components/component.board.clipboard"),e("tau/components/component.board.entityViewer"),e("tau/components/component.board.toolbar"),e("tau/components/component.board.editor.container"),e("tau/components/component.board.plus.container"),e("tau/components/component.board.plus"),e("tau/components/component.board.plus.list"),e("tau/components/component.board.new.list"),e("tau/components/component.board.plus.timeline"),e("tau/components/component.side.menu.switcher"),e("tau/components/component.board.menu"),t.extend({init:function(e){this.configurator=e},getMasterConfig:function(){var e={layout:"selectable",template:i,extensions:[a,o],children:[{name:"board main menu",type:"board.main.menu",selector:"[role=header]"},{type:"container",selector:"[role=header]",useAnimation:!1,extensions:[l,u]},{type:"global.context.control",selector:"[role=header]"},{type:"board.clear.sample.data",name:"board.clear.sample.data",selector:"[role=header]"},{type:"board.collapser.aside",name:"board.collapser.aside",selector:"[role=aside]"},{name:"board general quick add",type:"board.general.quick.add",selector:"[role=aside]"},{type:"board.clipboard",selector:"[role=main]",options:{refreshTimeout:300}},{type:"board.entityViewer",name:"entityViewer",selector:"[role=main]"}]};return e.children=e.children.concat(this._getAsideMenuComponents()),e},getPageBoardConfig:function(){return{type:"board.container",selector:"[role=main]",layout:"list",template:n,extensions:[r,c],children:[{type:"board.toolbar",label:"board_toolbar",min:1,max:6,defaultValue:3,extensions:[s]},{type:"board.editor.container",layout:"selectable",label:"board_editor_container",visible:!1,spinner:!1,useAnimation:!1},{type:"board.plus.container",spinner:!1,children:[{name:"board_plus",viewMode:"board",type:"board.plus",options:{dragndrop:{containmentRefreshTimeout:400}}},{name:"board_plus",viewMode:"list",type:"board.plus.list",options:{dragndrop:{containmentRefreshTimeout:400}}},{name:"newlist",viewMode:"newlist",type:"board.new.list",options:{dragndrop:{containmentRefreshTimeout:400}}},{name:"board_plus",viewMode:"timeline",type:"board.plus.timeline",options:{dragndrop:{containmentRefreshTimeout:400}}}]}]}
},_getAsideMenuComponents:function(){var e,t=this.configurator.getFeaturesService();return e=t.isEnabled("process.setup")&&this.configurator.getLoggedUser().isAdministrator?"side.menu.switcher":"board.menu",{type:e,selector:"[role=aside]"}}})}),define("tau/views/view.master.board",["Underscore","tau/core/view-base","tau/components/component.board.container","tau/configurations/board.container.config"],function(e,t,i,n){return t.extend({init:function(e){this._super(e)},initialize:function(){},"bus view.dom.ready":function(e){this.container.fire("view.dom.ready",e.data)},"bus beforeInit + boardSettings.ready":function(t,a,r){var s=this,o=a.config,l=r,u=a.config.context.configurator,c=new n(u),d=e.extend(o,c.getMasterConfig()),p=s.container=i.create({name:"board page container",layout:d.layout,template:d.template,store:o.store,extensions:e.union([],d.extensions||[]),context:o.context});p.on("afterInit",s["container afterInit"],s),p.on("afterRender",s["container afterRender"],s),p.on("componentsCreated",s["container componentsCreated"],s),p.fire("boardSettings.ready",l),s.fire("component.ready",p),p.initialize(d)},"bus component.ready:last > boardSettings.ready":function(e){var t=e["component.ready"].data,i=e["boardSettings.ready"].data;t.fire("boardSettings.ready",i)},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.destroyContainer(),this._super()}})}),define("tau/components/component.master.board",["tau/components/component.page.base","tau/views/view.master.board"],function(e,t){return{create:function(i){var n={name:"board page component",turnOffErrorEmiter:!0,extensions:[],ViewType:t};return e.create(n,i)
}}}),define("tau/ui/templates/ui.template.empty.container",["tau/core/templates-factory"],function(e){var t={name:"container.empty.master",engine:"jqote2",markup:["<div>",'<div role="main"></div>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/configurations/empty.container.config",["Underscore","tau/core/class","tau/ui/templates/ui.template.empty.container"],function(e,t,i){var n=t.extend({getMasterConfig:function(){return{layout:"selectable",template:i,children:[]}}});return new n}),define("tau/views/view.master.empty",["Underscore","tau/core/view-base","tau/components/component.container","tau/configurations/empty.container.config"],function(e,t,i,n){return t.extend({init:function(e){this._super(e)},initialize:function(){},"bus view.dom.ready":function(e){this.container.fire("view.dom.ready",e.data)},"bus beforeInit":function(t,a){var r=this,s=a.config,o=e.extend(s,n.getMasterConfig(s)),l=r.container=i.create({name:"empty page container",layout:o.layout,template:o.template,store:s.store,extensions:e.union([],o.extensions||[]),context:s.context});l.on("afterInit",r["container afterInit"],r),l.on("afterRender",r["container afterRender"],r),l.on("componentsCreated",r["container componentsCreated"],r),r.fire("component.ready",l),l.initialize(o)},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.destroyContainer(),this._super()}})}),define("tau/components/component.master.empty",["tau/components/component.page.base","tau/views/view.master.empty"],function(e,t){return{create:function(i){var n={name:"empty page component",turnOffErrorEmiter:!0,turnOffLoadingIndicator:!0,extensions:[],ViewType:t};
return e.create(n,i)}}}),define("tau/models/model.menu.actions",["Underscore","tau/core/extension.base","tau/core/termProcessor"],function(e,t,i){var n=45,a=t.extend({"bus beforeInit":function(t,i){var n=i.config,a=i.config.context.configurator,r=i.config.context.entity;this.fire("configurator.ready",a),this.fire("entity.ready",r);var s=n.items,o=n.eventNamesCommon||{};e.defaults(o,{dataBind:"dataBind"});var l=o.dataBind,u=[],c=0;e.forEach(s,function(e){if("-----"===e){if(0===c)return;c=0}else++c;u.push(e)}),this.fire(l,{items:u})},"bus configurator.ready:last + beforeInit:last + entity.ready:last + menu.show.first":function(t,a,r,s,o){var l=new i(r.config.context.getTerms()),u=function(e){var t=l.getTerms(e.name);return{id:e.id,label:t.name,name:e.name,icon:t.iconSmall}},c=function(t){return e.chain(t).filter(function(e){return e.id!=n}).map(u).value()},d=r.config.items;e.findWhere(d,{roleAction:"convert"})&&a.getActionsService().getEntityTypesToConvert(s.id).done(e.bind(function(t){var i=c(t),a=e.find(t,function(e){return e.id==n});if(a){var r=u(a);r.label+="&hellip;",r.alias="convertToTask",i.push(r)}this.fire("convert.submenuData.ready",{items:i})},this));var p=s.entityType.name.toLowerCase();"request"===p&&a.getActionsService().getEntityTypesToCreateFromRequest(s.id).done(e.bind(function(t){var i=c(t),a=e.find(t,function(e){return e.id==n});if(a){var r=u(a);r.label+="&hellip;",r.alias="createTask",i.push(r)}this.fire("create.submenuData.ready",{items:i})},this)),("iteration"===p||"teamiteration"===p)&&a.getStore().get(p,{id:s.id,fields:["canBeFinished"]}).done({success:e.bind(function(e){var t=e[0].data.canBeFinished;t&&o.find(".tau-action-finish_iteration").show()},this)})}});return a}),define("tau/ui/extensions/editable-base",["tau/components/extensions/component.extension.base"],function(e){return e.extend({category:"edit","bus permissionsReady + afterRender":function(e){var t=e.permissionsReady.data;t.editable&&this.onEditActivated({element:e.afterRender.data.element})
},onEditActivated:function(){}})}),define("tau/ui/behaviour/menu/ui.behaviour.menu.actions",["Underscore","jQuery","tau/core/tau-widget"],function(e,t,i){i.widget("ui.behaviourMenuActions",{_create:function(){this.init()},init:function(){var e=this,i=this.options.onClick||function(){e.show()},n=t(this.element);this.$element=n,this.$popup=n.find(".ui-menu__popup"),this.$items=this.$element.find(".ui-menu__item-action .drop-down-option"),this.currentIndex=-1,this.options.classActive="drop-down-option_hover",e.isOpened=!1,this.$element.find(".ui-menu__trigger").click(function(e){i(e)}),this._bindEvents()},show:function(){var e=this;e.isOpened=!e.isOpened,e.isOpened?e._mapKeyboard():e._unmapKeyboard()},_bindEvents:function(){var e=this;e.$items.hover(function(){e.$items.not(this).removeClass(e.options.classActive),t(this).addClass(e.options.classActive),e.currentIndex=e.$items.index(this)},function(){t(this).removeClass(e.options.classActive)}),t("body"+this.eventNamespace).click(function(i){t(i.target).closest(".ui-menu__item").hasClass("ui-menu__item-dont-close")||(e.isOpened&&!t(i.target).parents(".tau-bubble").length&&e.close(),t(i.target).parents(".ui-menu:first").length)})},_mapKeyboard:function(){var e=this;this.options.keyboardManager.pushHandler({handleKeyDown:function(i){switch(i.keyCode){case t.ui.keyCode.ESCAPE:i.preventDefault(),e.close();break;case t.ui.keyCode.DOWN:i.preventDefault(),e.currentIndex++,e.currentIndex=e.currentIndex>=e.$items.length?0:e.currentIndex,e.$items.removeClass(e.options.classActive),e.$items.eq(e.currentIndex).addClass(e.options.classActive);break;case t.ui.keyCode.UP:i.preventDefault(),e.currentIndex--,e.currentIndex=e.currentIndex<0?e.$items.length-1:e.currentIndex,e.$items.removeClass(e.options.classActive),e.$items.eq(e.currentIndex).addClass(e.options.classActive);break;case t.ui.keyCode.ENTER:i.preventDefault();var n=e.$items.filter("."+e.options.classActive);n&&n.parent().trigger("click")}}})},_unmapKeyboard:function(){this.options.keyboardManager.popHandler()
},close:function(){var e=this;e.isOpened=!1,e._unmapKeyboard()},destroy:function(){t("body"+this.eventNamespace).off(),self.isOpened&&this._unmapKeyboard()}})}),define("tau/components/extensions/menu/extension.menu.actions",["Underscore","jQuery","tau/ui/extensions/editable-base","tau/ui/behaviour/menu/ui.behaviour.menu.actions","libs/jquery/jquery.ui.tauConfirm"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){var i=this.$el=t.element,n=i.find(".drop-down-list");this.fire("$el.ready",i),this.fire("$menu.ready",n),this.fire("menu.show.first",i)},"bus configurator.ready + dataBind + $el.ready + $menu.ready":function(t,i,n,a,r){var s=this;this.bindData=n,this.redirect=i.getRedirect(),a.behaviourMenuActions({keyboardManager:i.getKeyBoardManager(),onClick:function(){s.wasShownBefore||(s.fire("menu.show.first",a),s.wasShownBefore=!0),s.fire("menu.show",a)}}),r.find(".ui-menu__item-action").click(e.bind(this.executeCommand,this))},"bus select":function(){this.$el.behaviourMenuActions("show")},removeEntity:function(){var e=this.config.context.entity,t=this.config.context.configurator.getStore();t.remove(e.entityType.name,{id:e.id}).done(),this.config.context.configurator.getHistory().exclude(e.id)},redirectTo:function(e,t){this.redirect.redirect(e,t)},split:function(){var e=this.config.context.entity.id,t={generalID:e};this.fire("split",t)},markAsDuplicate:function(){var e=this.config.context.entity.id,t={generalID:e};this.fire("markAsDuplicate",t)},attachToRequest:function(){var e=this.config.context.entity.id;this.fire("attachToRequest",{generalID:e})},moveOrCopy:function(){var e=this.config.context.entity.id;this.fire("moveOrCopy",{generalID:e})},copyToProject:function(e){this.fire("board.plus.copy.to.project",{entity:this.config.context.entity,$popupTarget:e.$target})},executeCommand:function(i){if(!t(i.target).is("a")&&!t(i.target).is("i")){var n=this,a=t(i.currentTarget),r=a.data("alias"),s=e.find(this.bindData.items,function(e){return e.alias==r});if(s){var o=s.command,l=s.confirmation||!1,u=e.bind(function(){if(e.isFunction(o)){var t={$target:a};
o.call(n,n,t)}else if("object"==typeof o){var i={components:o,context:n.config.context};n.createComponents(i,function(e){var t=e[0].component;t.initialize()})}else s.url&&n.redirectTo(s.url);this.fire("action.started",{})},this);l?a.tauConfirm({showOnCreation:!0,content:["<h3>"+l+"</h3>"].join(""),callbacks:{success:u}}):u()}}}})}),define("tau/ui/templates/actions/ui.template.moveOrCopy",["tau/core/templates-factory"],function(e){var t={name:"move-or-copy",markup:['<div style="display: none;">','	<div id="copyActionPopup" style="padding: 10px">','				<table cellpadding="6" cellspacing="0">',"					<tr>","						<td>",'                           <select id="projectSelector">','                               <option value="0" >- Select Project -</option>','                               {{each projects}}<option value="${ID}" >${Name}</option>{{/each}}',"                           </select>","						</td>","						<td>",'                           <input type="button" value="Copy" class="copy" disabled></button> ',"						</td>","						<td>",'                           <input type="button" value="Move" class="move" disabled></button> ',"						</td>","					</tr>","				</table>",'					<div style="font-size: 90%">',"						Custom fields will be saved only when the entity is copied or moved to a project with the same process","					</div>","	</div>","</div>"]};return e.register(t)}),define("tau/components/extensions/menu/extensions.menu.moveOrCopy",["tau/components/extensions/component.extension.base","tau/core/templates-factory","tau/ui/templates/actions/ui.template.moveOrCopy"],function(e,t){var i=0;return e.extend({"bus moveOrCopy":function(e){var t=e.data.generalID;this.moveOrCopy(t)},moveOrCopy:function(e){var n=this;Ext.WindowMgr.zseed=99999;var a=this.config.context.configurator.getActionsService(),r=function(r){function s(t,i){var r=$("#"+l+" #projectSelector").val();0!=r&&a[t](n.config.context.entity.id,r,function(){c.close(),i&&i(e,r)},function(e){c.close();var t;try{t=$.parseJSON(e.responseText).Message
}catch(i){t=e.statusText}n.fire("error",{message:t})})}i++;var o=t.get("move-or-copy").bind(n.config,{projects:r.d}).appendTo("body"),l="copyActionPopup"+i;o.find("#copyActionPopup").prop("id",l);var u=o.find(".copy,.move");o.find("#projectSelector").change(function(){var e="disabled";"0"!=$(this).val()?u.removeAttr(e):u.attr(e,e)}),o.find(".copy").click(function(){var e=function(e,t){n.fire("entityWasCopiedToProject",{entity:{id:e},project:{id:t}})};s("copyGeneralToProject",e)}),o.find(".move").click(function(){var e=function(e,t){n.fire("entityWasMovedToProject",{entity:{id:e},project:{id:t}})};s("moveGeneralToProject",e)});var c=showModalPopup(l,{title:"Move or Copy",width:440,height:126})};a.getActiveProjectForEntity(e,r)}})}),define("tau/components/extensions/menu/extensions.menu.board.plus.copy-to-project",["Underscore","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/card-context-menu/menu-bubbleCreator","tau/models/page.entity/entity.context.factory","tau/models/choice/model.choice.copy.to.project","tau/utils/utils.serverErrorTranslator","tau/ui/templates/choice/project/ui.template.choice.project.option","tau/services/service.entity-navigation","tau/core/termProcessor","tau/services/entities/service.entities.copy-to-project"],function(e,t,i,n,a,r,s,o,l,u){return t.extend({"bus configurator.ready:last + board.plus.copy.to.project":function(e,t,i){this._copyToProject(i.entity,t,i.$popupTarget)},_copyToProject:function(e,t,i){n.create(e,t).done(this._createBubble.bind(this,t,i))},_createBubble:function(e,t,i){var n=new u,a=n.createCopyToProjectBubbleConfig({applicationContext:i,navigateToEntityDetails:function(t){var i=e.service("navigator");(new o).navigateToEntityView(i,t.entityId,t.entityType)},eventBus:this});a.target=t,this.fire("initBubble",a),t.tauBubble("show")}})}),define("tau/components/extensions/menu/extensions.menu.attachToRequest",["Underscore","tau/core/extension.base","tau/components/component.finder.entity","tau/models/finder.entity/model.finder.entity.data.relation"],function(e,t,i,n){return t.extend({"bus beforeInit:last + entity.ready:last + configurator.ready:last + $menu.ready + menu.show.first":function(t,a,r,s,o){var l=o.find(".ui-menu__item").filter(function(){return"Attach to Request"==$(this).data("alias")
});if(l.length){{var u=i.createAsChild(this,{entityType:"request",model:n,dependencyType:"master"});l.data("name"),l.data("id")}u.once("afterRender",e.bind(function(e,t){var i=t.element,n=i,a=l.tauBubble({content:n,onPositionConfig:function(e){return e.my="center top",e.at="center bottom",e.collision="flip flip",e},zIndex:10002});this.fire("$requestBubbled.ready",a),u.fire("$outerBubbled.ready",a)},this)),u.on("entitySelected",e.bind(function(e,t){this.fire("request.selected",t.entity)},this)),u.initialize({context:a.config.context}),s.getStore().unbind(this),s.getStore().on({type:"relation",eventName:"afterSave",listener:this,hasChanges:["slave"]},e.bind(function(e){var t=e.data.changes;t.slave.id==r.id&&u.fire("refresh")},this)),s.getStore().on({type:"relation",eventName:"afterRemove",listener:this},e.bind(function(){u.fire("refresh")},this))}},"bus configurator.ready:last + entity.ready:last + request.selected":function(t,i,n,a){i.getStore().save("relation",{fields:["id",{master:["id","name",{entityType:["id","name"]}]}],$set:{master:{id:a.id},slave:{id:n.id},relationType:{id:3}}}).done(e.bind(function(){i.getStore().evictProperties(n.id,n.entityType.name,["masterRelations","slaveRelations"]),this.fire("requestWasAttachedToEntity",{entity:n})},this))},"bus $bubbled.ready:last + $requestBubbled.ready:last + requestWasAttachedToEntity":function(e,t,i){i.tauBubble("hide"),t.tauBubble("hide")},"bus configurator.ready:last + destroy":function(e,t){t.getStore().unbind(this)}})}),define("tau/components/extensions/menu/extensions.menu.markAsDuplicate",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus markAsDuplicate":function(e){var t=e.data.generalID;this.markAsDuplicate(t)},markAsDuplicate:function(e){var t=this.config.context.configurator;Ext.WindowMgr.zseed=99999;for(var i=[],n=0;n<_projectContext.length;n++)i.push(_projectContext[n].id);var a=this,r=function(){var e=$.Deferred();if(Tp&&Tp.controls&&Tp.controls.Duplicate)e.resolve();
else{var i=t.getApplicationPath();require([i+"/JavaScript/ExtJs/Controls/Duplicate/MarkAsDuplicatePopup.js",i+"/JavaScript/ExtJs/Controls/Duplicate/BugView.js",i+"/JavaScript/ExtJs/Controls/Duplicate/ToolbarFilter.js"],function(){e.resolve()})}return e};r().done(function(){var n=Tp.controls.Duplicate.CreatePopup(i,e,void 0,{onMarkDelegate:function(e){var t=a.config.context.configurator.getStore(),i=t.freeze();a.fire("bugWasMarkedAsDuplicate",e),i.unfreeze()}});n.show(i,e),t.getKeyBoardManager().pushHandler({handleKeyDown:function(e){27==e.which&&(t.getKeyBoardManager().popHandler(),n.hide(),n.destroy())}})})}})}),define("tau/components/extensions/menu/extensions.menu.split",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus split":function(e){var t=e.data.generalID;this.split(t)},split:function(t){var i=this,n=this.config.context.configurator,a=n.getActionsService();a.splitUserStory(t,_.bind(this._success,this,t,n),function(t){var n={Message:"Split operation is failed due to server error"};try{n=e.parseJSON(t.responseText)}catch(a){}i.fire("error",{message:n.Message})})},_success:function(e,t,i){var n=i.d,a=t.getUrlBuilder().getSplitForUserStoryUrl(e,n);t.getRedirect().redirect(a)}})}),define("tau/components/extensions/menu/extensions.menu.generalAction.base",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({init:function(e){this.actionName=e.actionName;var t=this;this["bus configurator.ready:last + entity.ready:last + "+this.actionName]=function(e,i,n,a){t.fire("showProgress",{text:t.config.progressText});var r=n.id,s=function(e){t.fire("hideProgress");var n=e.d,a=n.EntityTypeName.split("."),s=a[a.length-1],o={entity:{id:n.GeneralID},entityType:{name:s}};t.navigateTo(i,r,s,n.GeneralID),window._criticalTauChanges=!0,t.fire(t.actionName+".executed",o)},o=function(e){t.fire("hideProgress");var i=jQuery.parseJSON(e.responseText)||{Message:"Server is not available"},n=i.Message;
t.fire("error",{message:n})},l=this.getDeferredAction(i,r,a);l.done(s).fail(o)},this._super.call(this,e)},getDeferredAction:function(){throw"should be overridden"},navigateTo:function(e,t,i,n){this.config.excludeCurrentFromHistory&&e.getHistory().exclude(t,!1),e.service("navigator").to(i.toLowerCase()+"/"+n)}})}),define("tau/components/extensions/menu/extensions.menu.converter",["jQuery","Underscore","tau/components/extensions/menu/extensions.menu.generalAction.base"],function(e,t,i){return i.extend({init:function(e){this._super.call(this,t.extend(e,{actionName:"convert",progressText:"Converting...",excludeCurrentFromHistory:!0}))},getDeferredAction:function(e,t,i){var n=e.getActionsService();return"task"==i.entityType.name.toLowerCase()?n.convertGeneralToTask(t,i.userStory.id):n.convertGeneralToType(t,i.entityType.id)}})}),define("tau/components/extensions/menu/extensions.menu.generalAction.menu.base",["Underscore","tau/components/extensions/component.extension.base","tau/core/termProcessor","tau/ui/behaviour/menu/ui.behaviour.menu.actions"],function(e,t,i){return t.extend({setClickHandler:function(){throw"should be overridden"},init:function(e){var t=this,n="bus configurator.ready:last + $menu.ready:last + "+e.actionName+".submenuData.ready + menu.show.first";this[n]=function(i,n,a,r){var s=a.find(".i-role-action-"+e.actionName);if(r.items.length>0){var o=n.getTemplateFactory().get("menu.actions.submenu").bind({},r);s.append(o),t.fire("$"+t.config.actionName+".submenu.ready",o)}else s.hide()},this["bus $"+e.actionName+".submenu.ready"]=function(e,n){var a=this.config.context.entity,r=new i(this.config.context.getTerms()),s=r.getTerms(a.entityType.name).name;t.setClickHandler(n,".ui-menu__item",a,r,s)},this["bus $"+e.actionName+".submenu.ready:last + menu.show"]=function(e,t,i){i.behaviourMenuActions("show")},this._super.call(this,e)}})}),define("tau/components/extensions/menu/extensions.menu.converter.menu",["Underscore","tau/components/extensions/menu/extensions.menu.generalAction.menu.base","tau/ui/behaviour/menu/ui.behaviour.menu.actions","libs/jquery/jquery.ui.tauConfirm"],function(e,t){return t.extend({init:function(t){this._super.call(this,e.extend(t,{actionName:"convert"}))
},setClickHandler:function(e,t,i,n,a){var r=this,s=e.find(t);s.each(function(){var t=$(this);if("convertToTask"!=t.data("alias")){var i=t.data("name"),s=t.data("id"),o={id:s,name:i},l=n.getTerms(i).name;t.tauConfirm({content:["<h3>Do you really want to convert "+a+" to "+l+"?</h3>"].join(""),onPositionConfig:function(e){e.my="left center",e.at="right center+20",e.collision="flip flip"},onArrowPositionConfig:function(e){e.offset="0 +6"},onHide:function(){e.toggleClass("sub-ui-menu_dont-hide",!1),t.find(".drop-down-option").toggleClass("drop-down-option_hover",!1)},onShow:function(){e.toggleClass("sub-ui-menu_dont-hide",!0),t.find(".drop-down-option").toggleClass("drop-down-option_hover",!0)},callbacks:{success:function(){r.fire(r.config.actionName,{entityType:o})}},zIndex:10002})}})}})}),define("tau/components/extensions/menu/extensions.menu.converterToTask",["Underscore","tau/components/extensions/component.extension.base","tau/core/termProcessor","tau/components/component.finder.entity"],function(e,t,i,n){return t.extend({"bus beforeInit:last + configurator.ready:last + $convert.submenu.ready":function(e,t,a,r){var s=this,o=this.config.context.entity,l=new i(this.config.context.getTerms()),u=r.find(".ui-menu__item"),c=l.getTerms(o.entityType.name).name,d=u.filter("[data-alias=convertToTask]");if(d.length){var p=n.createAsChild(this,{entityType:"userstory"}),f=d.data("name"),m=d.data("id"),h={id:m,name:f};p.on("afterRender",function(e,t){var i=$("<div/>").append(t.element),n=l.getTerms(f).name,o=i.append(['<div class="i-role-confirmation-content" style="display: none">',"<h3>Do you really want to convert "+c+" to "+n+"?</h3>",'<div class="tau-buttons">','<button type="button" class="tau-btn tau-primary i-role-actionok">Yes, I\'m sure</button>','<button type="button" class="tau-btn i-role-actioncancel">No</button>',"</div>","</div>"].join("")),u=d.tauBubble({template:['<div class="tau-bubble">','<div class="tau-bubble__arrow" role="arrow"></div>','<div class="tau-bubble__inner tau-container" role="content"></div>',"</div>"].join(""),content:o,onPositionConfig:function(e){e.my="center top",e.at="center bottom",e.collision="flipfit flipfit"
},onHide:function(){a.getKeyBoardManager().popHandler(),r.toggleClass("sub-ui-menu_dont-hide",!1),d.find(".drop-down-option").toggleClass("drop-down-option_hover",!1)},onShow:function(){a.getKeyBoardManager().pushHandler({}),r.toggleClass("sub-ui-menu_dont-hide",!0),d.find(".drop-down-option").toggleClass("drop-down-option_hover",!0);var e=u.tauBubble("widget");e.find(".tau-lookup-block").show(),e.find(".i-role-confirmation-content").hide(),e.removeClass("tau-warning-bubble"),e.find(".filter-field").focus(),e.unbind("click"),p.fire("popupResize",u),d.tauBubble("adjustPosition"),e.one("click",".i-role-actioncancel",function(){u.tauBubble("hide")}),e.one("click",".i-role-actionok",function(){u.tauBubble("hide"),s.fire("convertToTask",h)})},zIndex:10002});s.fire("$taskBubble.ready",u),p.fire("$outerBubbled.ready",u)}),p.on("entitySelected",function(e,t){var i=d.tauBubble("widget");i.find(".tau-lookup-block").hide(),i.find(".i-role-confirmation-content").show(),i.addClass("tau-warning-bubble"),d.tauBubble("adjustPosition"),s.fire("entitySelected",t)}),this.reFire(p),p.initialize({context:t.config.context})}},reFire:function(t){var i=t,n=this.bus,a=i.fire,r=i.name;i.fire=function(t,s){var o=e.toArray(arguments);a.apply(i,o),n.fire(r+"."+t,s)}},"bus entitySelected + convertToTask":function(e,t,i){this.fire("convert",{entityType:i,userStory:t.entity})}})}),define("tau/components/extensions/menu/extensions.menu.create",["jQuery","Underscore","tau/components/extensions/menu/extensions.menu.generalAction.base"],function(e,t,i){return i.extend({init:function(e){this._super.call(this,t.extend(e,{actionName:"create",progressText:"Creating...",excludeCurrentFromHistory:!1}))},getDeferredAction:function(e,t,i){var n=e.getActionsService();return"task"==i.entityType.name.toLowerCase()?n.createTaskFromRequest(t,i.userStory.id):n.createFromRequest(t,i.entityType.id)}})}),define("tau/components/extensions/menu/extensions.menu.create.menu",["Underscore","tau/components/extensions/menu/extensions.menu.generalAction.menu.base","tau/ui/behaviour/menu/ui.behaviour.menu.actions","libs/jquery/jquery.ui.tauConfirm"],function(e,t){return t.extend({init:function(t){this._super.call(this,e.extend(t,{actionName:"create"}))
},setClickHandler:function(e,t){var i=this;e.on("click",t,function(){var e=$(this),t=e.data("name"),n=e.data("id"),a={id:n,name:t};i.fire(i.config.actionName,{entityType:a})})}})}),define("tau/components/extensions/menu/extensions.menu.createTask",["Underscore","tau/components/extensions/component.extension.base","tau/components/component.finder.entity"],function(e,t,i){return t.extend({"bus beforeInit:last + configurator.ready:last + $create.submenu.ready":function(e,t,n,a){var r=this,s=a.find(".ui-menu__item"),o=s.filter("[data-alias=createTask]");if(o.length){var l=i.createAsChild(this,{entityType:"userstory"}),u={id:o.data("id"),name:o.data("name")};l.on("afterRender",function(e,t){var i=$("<div/>").append(t.element),s=o.tauBubble({template:['<div class="tau-bubble">','<div class="tau-bubble__arrow" role="arrow"></div>','<div class="tau-bubble__inner tau-container" role="content"></div>',"</div>"].join(""),content:i,onPositionConfig:function(e){e.my="center top",e.at="center bottom",e.collision="flipfit flipfit"},onHide:function(){n.getKeyBoardManager().popHandler(),a.toggleClass("sub-ui-menu_dont-hide",!1),o.find(".drop-down-option").toggleClass("drop-down-option_hover",!1)},onShow:function(){n.getKeyBoardManager().pushHandler({}),a.toggleClass("sub-ui-menu_dont-hide",!0),o.find(".drop-down-option").toggleClass("drop-down-option_hover",!0);var e=s.tauBubble("widget");e.find(".tau-lookup-block").show(),e.find(".filter-field").focus(),e.unbind("click"),l.fire("popupResize",s),o.tauBubble("adjustPosition")},zIndex:10002});r.fire("$taskBubble.ready",s),l.fire("$outerBubbled.ready",s)}),l.on("entitySelected",function(e,t){var i=o.tauBubble("widget");i.find(".tau-lookup-block").hide(),o.tauBubble("hide"),r.fire("entitySelected",t),r.fire("createTask",u)}),this.reFire(l),l.initialize({context:t.config.context})}},reFire:function(t){var i=t,n=this.bus,a=i.fire,r=i.name;i.fire=function(t,s){var o=e.toArray(arguments);a.apply(i,o),n.fire(r+"."+t,s)}},"bus entitySelected + createTask":function(e,t,i){this.fire("create",{entityType:i,userStory:t.entity})
}})}),define("tau/components/extensions/menu/extension.menu.bubble",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready":function(e,t){var i=t.find(".ui-menu__trigger"),n=t.find(".ui-menu__popup");i.length&&(i.tauBubble({stackName:"entityMenu",className:"ui-menu-actions__bubble",content:n.detach(),dontCloseSelectors:[".tau-bubble"],template:['<div class="tau-bubble">','<div class="tau-bubble__inner" role="content"></div>',"</div>"].join(""),onPositionConfig:function(e){e.my="right top+2",e.at="right bottom"}}),this.fire("$bubbled.ready",i))}})}),define("tau/ui/templates/menu/ui.template.menu.actions.item",["tau/core/templates-factory"],function(e){var t={name:"menu.actions.item",engine:"jqote2",markup:["<% if (this.url) { %>",'<div taustype="view-entity" tauspref="action tab item" class="i-taus ui-menu__item ui-menu__item-action ui-menu__item-action-link <%= this.className %>">','<a class="drop-down-option" href="<%= this.url %>">',"<%= this.label %>","</a>","</div>","<% } else if (this.label) { %>",'<div taustype="view-entity" tauspref="action tab item" class="i-taus ui-menu__item ui-menu__item-action <%= this.className || \'\' %> <%= this.alias? "i-role-action-"+this.alias.toLowerCase():"" %> " data-id="<%= this.id||"" %>" data-name="<%= this.name||"" %>" data-alias="<%= this.alias %>">',"<% if (this.icon){ %>",'<span class="drop-down-option">','<i class="tau-entity-icon tau-entity-icon--<%= this.name.toLowerCase() %>"><%= this.icon %></i>',"<%= this.label %>","</span>","<% } else { %>",'<span class="drop-down-option">',"<%= this.label %>","</span>","<% } %>","</div>","<% } else { %>",'<div class="ui-menu__item-separator">-----</div>',"<% } %>"]};return e.register(t)}),define("tau/ui/templates/menu/ui.template.menu.actions.submenu",["tau/core/templates-factory","tau/ui/templates/menu/ui.template.menu.actions.item"],function(e){var t={name:"menu.actions.submenu",engine:"jqote2",markup:['<div class="sub-ui-menu">','<div class="sub-ui-menu-cont">','<%= fn.sub("menu.actions.item", this.items) %>',"</div>","</div>"]};
return e.register(t)}),define("tau/ui/templates/menu/ui.template.menu.actions",["tau/core/templates-factory","tau/ui/templates/menu/ui.template.menu.actions.submenu","tau/ui/templates/menu/ui.template.menu.actions.item"],function(e){var t={name:"menu.actions.list",engine:"jqote2",markup:['<div class="ui-menu-actions">','<div class="ui-drop-down drop-down-list">','<%= fn.sub("menu.actions.item", this.items) %>',"</div>","</div>"]};return e.register(t)}),define("tau/components/component.menu.actions",["tau/components/component.creator","tau/models/model.menu.actions","tau/components/extensions/menu/extension.menu.actions","tau/components/extensions/menu/extensions.menu.moveOrCopy","tau/components/extensions/menu/extensions.menu.board.plus.copy-to-project","tau/components/extensions/menu/extensions.menu.attachToRequest","tau/components/extensions/menu/extensions.menu.markAsDuplicate","tau/components/extensions/menu/extensions.menu.split","tau/components/extensions/menu/extensions.menu.converter","tau/components/extensions/menu/extensions.menu.converter.menu","tau/components/extensions/menu/extensions.menu.converterToTask","tau/components/extensions/menu/extensions.menu.create","tau/components/extensions/menu/extensions.menu.create.menu","tau/components/extensions/menu/extensions.menu.createTask","tau/components/extensions/menu/extension.menu.bubble","tau/components/extensions/error/extension.errorBar","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/menu/ui.template.menu.actions"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m,h,g,v,b){return{create:function(y){var _={extensions:[t,i,n,a,r,s,o,l,u,c,d,p,f,m,g,v,h],template:y.template||b};return e.create(_,y)}}}),define("tau/models/model.menu.testPlanRun.union",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({"bus dataBind.special+dataBind.common":function(t){var i=t["dataBind.special"].data.additionalActions,n=[];e.forEach(i,function(e){1==e.show&&n.push(e)
}),n=n.concat(t["dataBind.common"].data.items),this.fire("dataBind",{items:n})}});return i}),define("tau/components/component.menu.actions.testplanrun",["tau/components/component.creator","tau/models/model.menu.actions","tau/models/model.menu.testPlanRun.union","tau/components/extensions/menu/extension.menu.actions","tau/components/extensions/menu/extensions.menu.converter","tau/components/extensions/menu/extensions.menu.converter.menu","tau/components/extensions/menu/extension.menu.bubble","tau/components/extensions/error/extension.errorBar","tau/ui/templates/menu/ui.template.menu.actions"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){u.eventNamesCommon={dataBind:"dataBind.common"},u.eventNamesSpecial={dataBind:"dataBind.special"};var c={extensions:[t,u.options.Model,i,n,a,r,s,o],template:u.template||l};return e.create(c,u)}}}),define("tau/ui/extensions/menu.testPlanRun/ui.extension.menu.testPlanRun",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender":function(t,i){var n=i.element;this.fire("$el.ready",n),n.on("click",".tau-action",_.bind(function(t){t.preventDefault();var i=e(t.currentTarget);this.fire("url.process",i.attr("href")+"&rmnav=1&tp3=1")},this))}})}),define("tau/ui/templates/menu.testPlanRun/ui.template.menu.testPlanRun",["tau/core/templates-factory"],function(e){var t={name:"menu-testPlanRun",markup:['<div class="tau-menu-testplanrun">',"{{if additionalActions.run.show == true}}",'<a class="tau-action tau-action-run" href="${additionalActions.run.url}">','<span class="tau-action__icon"></span>',"Run","</a>","{{/if}}","{{if additionalActions.newRun && additionalActions.newRun.show == true}}",'<a class="tau-action tau-action-newrun" href="${additionalActions.newRun.url}">','<span class="tau-action__icon"></span>',"New Run","</a>","{{/if}}","{{if additionalActions.completeRun.show == true}}",'<a class="tau-action" href="${additionalActions.completeRun.url}">Complete Run</a>',"{{/if}}","{{if additionalActions.changeRun.show == true}}",'<a class="tau-action" href="${additionalActions.changeRun.url}">Change Run</a>',"{{/if}}","</div>"],dependencies:[]};
return e.register(t)}),define("tau/components/component.menu.testPlanRun",["tau/components/component.creator","tau/models/model.menu.testPlanRun","tau/models/model.menu.testPlanRun.runner","tau/ui/extensions/menu.testPlanRun/ui.extension.menu.testPlanRun","tau/ui/templates/menu.testPlanRun/ui.template.menu.testPlanRun"],function(e,t,i,n,a){return{create:function(r){var s=r.context.configurator,o=s&&s.isBoardEdition?[i]:[t,n],l={extensions:o,template:r.template||a};return e.create(l,r)}}}),define("tau/models/model.property.note",["Underscore","tau/core/extension.base.stateful","tau/utils/utils.htmlConverter"],function(e,t,i){var n=t.extend({onInit:function(e){var t=e.context.entity,n=t.entityType.name,a=e.fieldName;this.store.get(n,{id:t.id,fields:["id",a]}).done({success:function(e){var t=e[0].data;this.fire("dataBind",{value:i.fromSourceToHtml(t.comment),id:t.id})},scope:this})}});return n}),define("tau/models/model.property.note.editable",["tau/core/model.editable.base"],function(e){var t=e.extend({name:"Editable Notes","bus saveNote":function(e,t){this.fire("save",{$set:t})},"bus model.note.changed":function(e,t){this.cachedChange=t},"bus afterSave":function(){this.cachedChange=null},"bus destroy":function(){if(this.cachedChange){var e=this.config.context?this.config.context.entity:{};this.handleSave({$set:this.cachedChange},e)}}});return t}),define("tau/components/extensions/property/extension.lightweight.richeditor.base",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(e,t,i){var n="lightweight-editor",a=i.extend({_onCKEditorBlur:t.noop,rolePropertyClass:"i-role-property",init:function(){this._super.apply(this,arguments),this._debounceShowToolbar=e.debounce(this._debounceShowToolbar,400).bind(this)},"bus afterRender":function(e,t){var i=t.element;this._unbindHandlers(i),this._bindEditorAnchorHandlers(i)},"bus afterRender > destroy":function(){this._unbindHandlers(this.$element)
},_bindEditorAnchorHandlers:function(e){e.on("click."+n+" mousedown."+n,this._getComponentSelector()+":not(.cke_focus) a:not(.i-role-fullview)",function(e){e.preventDefault(),e.stopPropagation(),"click"==e.type&&window.open(this.href)})},_initializeEditor:function(e){var t=this._getEditor(e),i=this._getCkEditor(t);return i||this._createCkEditor(t),t},_onCreate:function(e){var t=this._getCkEditor(e);t.on("blur",function(t){this._onCKEditorBlur(e,t)}.bind(this));var i=this._getToolbar(e);e.scrollParent().on("scroll."+n,this._onScroll.bind(this,e,i)),this.fire("lightweightRicheditor.initialized",e)},_onScroll:function(e,t){t.is(":visible")&&(this._hideToolbar(t),this._debounceShowToolbar(e,t))},_hideToolbar:function(e){e.css({opacity:0})},_showToolbar:function(e,t){this._fixToolbarPosition(e,t),t.css({opacity:1})},_debounceShowToolbar:function(e,t){this._showToolbar(e,t)},_onDestroy:function(e){this._unbindEditorHandlers(e)},_fixToolbarPosition:function(e,t){var i=e.parent();t.css({left:0,top:0}),t.position({of:i,my:"left bottom",at:"left top"})},_getEditor:function(e){return e.hasClass(this.rolePropertyClass)?e:e.find("."+this.rolePropertyClass)},_getToolbar:function(e){var i=e.attr("id"),n="#cke_"+i,a=t(n);return a},_getCkEditor:function(e){return window.CKEDITOR&&e?window.CKEDITOR.instances[e.attr("id")]:null},_createCkEditor:function(e){e.data("ui-richeditor")||e.richeditor({ckPath:this.config.context.configurator.getCkPath(),ckInlined:!0,text:null,settings:{toolbar:[{name:"paragraph",items:["NumberedList","BulletedList"]},{name:"colors",items:["TextColor","BGColor"]},{name:"insert",items:["Image"]},{name:"links",items:["Link","Unlink"]}],baseFloatZIndex:1e5,removePlugins:"autogrow,magicline",allowedContent:!0,startupFocus:!1},saveAction:{available:!1},executionGroupName:"notes",onCreate:this._onCreate.bind(this,e),onDestroy:this._onDestroy.bind(this,e)}),e.richeditor("createEditor")},_unbindEditorHandlers:function(e){e.scrollParent().off("scroll."+n)},_unbindHandlers:function(e){e.off(n)
},_toggleFullPreviewMode:function(e,t){this.fire("toggle.full.preview.mode",{element:e,on:t})}});return a}),define("tau/components/extensions/property/note.hint.definitions",[],function(){return{DEFAULT_HINT:{name:"default",className:"tau-note-property-empty"},DETAILS_HINT:{name:"details",className:"tau-note-property-details"}}}),define("tau/components/extensions/property/extension.property.note.editable",["Underscore","jQuery","tau/components/extensions/property/extension.lightweight.richeditor.base","tau/components/extensions/property/note.hint.definitions","tau/utils/utils.htmlConverter"],function(e,t,i,n,a){var r="note-editor",s=i.extend({currentHintDefinition:n.DEFAULT_HINT,noteRoleSelector:".i-role-property","bus afterRender":function(e,t){this._super(e,t),this.$element=t.element,this.$editor=this._initializeEditor(this.$element),this.initialNote=e.data.data.value,this.initialNote||this._toggleNoteHint(this.$editor,!0)},"bus afterSave":function(e,t){var i=this._getCkEditor(this.$editor),n=t.data.comment;0==n.length&&this._toggleNoteHint(this.$editor,!0),i.resetDirty()},"bus note.hint.changed":function(e,t){var i=t.newHintDefinition;i!=this.currentHintDefinition&&this._validateNoteHint(i)&&this._changeNoteHint(this.$editor,i)},_initializeEditor:function(e){var t=this._getEditor(e);return this._bindHandlers(e,t),this._super(e)},_getComponentSelector:function(){return this.noteRoleSelector},_bindHandlers:function(e,t){t.on("blur."+r,this._onFocusOut.bind(this,t)),t.on("focus."+r,this._onFocusIn.bind(this,t)),t.on("richeditorchange."+r,this._onChange.bind(this))},_unbindHandlers:function(e){this._super(e);var t=this._getEditor(e);t.off(r)},_validateNoteHint:function(t){return e.contains(e.values(n),t)},_save:function(e){var t=this._getCkEditor(e),i=this._getNote();t.checkDirty()?this.fire("saveNote",{comment:i}):0==i.length&&this._toggleNoteHint(e,!0),this._toggleFullPreviewMode(this.$element,!0)},_onFocusIn:function(e){this._toggleNoteHint(e,!1),this._toggleFullPreviewMode(this.$element,!1)
},_onFocusOut:function(e){var t=this._getCkEditor(e);t.checkDirty()&&this.fire("model.note.changed",{comment:this._getNote(!0)})},_onCKEditorBlur:function(e){this._save(e)},_onChange:function(){var e=this._getNote();this.fire("public.note.changed",e)},_getNote:function(e){var t=this._getCkEditor(this.$editor);if(t){var i=t.getData(e)||"";return a.fromHtmlToSource(i.trim())}return this.initialNote},_changeNoteHint:function(e,t){this._toggleNoteHint(e,!1),this.currentHintDefinition=t;var i=this._getNote();0==i.length&&this._toggleNoteHint(e,!0)},_toggleNoteHint:function(e,t){e.toggleClass(this.currentHintDefinition.className,t)}});return s}),define("tau/components/extensions/property/extension.property.note.hint.manager",["tau/components/extensions/component.extension.base","tau/components/extensions/property/note.hint.definitions"],function(e,t){return e.extend({"bus afterRender":function(){var e=this.store,i=this.config.context.entity,n=i.entityType.name;e.get(n,{id:i.id,fields:["passed"]}).done({success:function(e){var i=e[0].data;i.passed===!1&&this.bus.fire("note.hint.changed",{newHintDefinition:t.DETAILS_HINT})},scope:this}),e.unbind(this),e.on({eventName:"afterSave",type:n,listener:this,filter:{id:i.id},hasChanges:["passed"]},function(e){var i=e.data.changes;this.bus.fire("note.hint.changed",{newHintDefinition:i.passed===!1?t.DETAILS_HINT:t.DEFAULT_HINT})}.bind(this))}})}),define("template!tau/ui/templates/property/ui.template.property.note",["tau/core/templates-factory"],function(e){var t={name:"property.note",engine:"jqote2",customFunctions:null,markup:'<div class="tau-testcaserun-results__middle"> <div class="tau-note-property i-role-property tau-cke-chrome" contenteditable="true"> <%= fn.sanitize(this.value) %> </div> </div>'};return e.register(t)}),define("tau/components/component.note",["tau/components/component.creator","tau/models/model.property.note","tau/models/model.property.note.editable","tau/components/extensions/property/extension.property.note.editable","tau/components/extensions/property/extension.property.note.hint.manager","tau/ui/extensions/content/ui.extension.content.imagePreview","template!tau/ui/templates/property/ui.template.property.note"],function(e,t,i,n,a,r,s){return{create:function(o){var l={extensions:[t,i,n,a,r],template:s};
return o.imagePreviewContentSelector=".i-role-property",o.fieldName="comment",o.queuedBus=!0,e.create(l,o)}}}),define("tau/views/view.page.board",["Underscore","tau/core/view-base","tau/components/component.board.container","tau/configurations/board.container.config"],function(e,t,i,n){return t.extend({init:function(e){this._super(e)},initialize:function(){},"bus view.dom.ready":function(e){this.container.fire("view.dom.ready",e.data)},"bus beforeInit+boardSettings.ready":function(t,a,r){var s=this,o=a.config,l=r.boardSettings,u=a.config.context.configurator;u.registeredServices&&delete u.registeredServices.boardSettings,u.registerService("boardSettings",l),l.unbind({listener:s}),l.bind({fields:["name"],listener:s,callback:function(t){u.getTitleManager().setTitle(e.asString(t.name)),u.getHistory().updateCurrent({title:e.asString(t.name)})}}),l.get({fields:["id","name"],callback:function(t){u.getTitleManager().setTitle(e.asString(t.name)),u.getHistory().setCurrent({url:u.getUrlBuilder().getRelativeBoardUrl(t.id),title:e.asString(t.name),id:t.id}),u.getRouting().setReferer({id:t.id})}});var c=new n(u),d=e.extend(o,c.getPageBoardConfig()),p=s.container=i.create({name:"board page container",layout:d.layout,template:d.template,store:o.store,extensions:e.union([],d.extensions||[]),context:o.context});p.on("afterInit",s["container afterInit"],s),p.on("afterRender",s["container afterRender"],s),p.on("componentsCreated",s["container componentsCreated"],s),u.getConfig("tmpBoardIsJustAdded",!1)||l.set({set:{edit:!1}}),p.fire("boardSettings.ready",{boardSettings:l}),p.initialize(d)},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.destroyContainer(),this._super()
}})}),define("tau/components/component.page.board",["tau/components/component.page.base","tau/views/view.page.board"],function(e,t){return{create:function(i){var n={name:"board page component",turnOffErrorEmiter:!0,turnOffLoadingIndicator:!0,extensions:[],ViewType:t};return e.create(n,i)}}}),define("tau/models/page.error/model.page.error",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.request[0]||{message:"You were redirected to the error page but no error was caught"};t.config.context.configurator.getTitleManager().set(i.message),this.fire("dataBind",{err:i})}})}),define("tau/components/component.page.error",["Underscore","tau/components/component.creator","tau/models/page.error/model.page.error","tau/ui/templates/page/ui.template.page.error"],function(e,t,i,n){return{create:function(a){var r={queuedBus:!0,extensions:e.compact([i].concat(a.extensions||[])),template:n};return t.create(r,a)}}}),define("tau/configurations/finish-iteration.container.config",["Underscore","tau/core/class"],function(e,t){var i=t.extend({getConfig:function(){return{children:[{type:"container",name:"finish iteration results container",layout:"selectable",template:{name:"finish-iteration-container",markup:['<div class="tau-container i-role-container-target tau-page-entity"></div>']},children:[{type:"breadcrumbs",disableStoreSubscriptions:!0,selector:".i-role-container-target"},{type:"finish-iteration",disableStoreSubscriptions:!0,selector:".i-role-container-target"}],extensions:[]}]}}});return i}),define("tau/views/view.page.finish-iteration",["Underscore","jQuery","tau/core/view-base","tau/components/component.container","tau/configurations/finish-iteration.container.config"],function(e,t,i,n,a){return i.extend({init:function(e){this._super(e)},initialize:function(){},"bus beforeInit":function(){var t=this,i=t.config.context.configurator,r=i.getTemplateFactory().getTermProcessor(),s="Finish "+r.getTerm("Iteration","name");
i.getTitleManager().setTitle(s);var o=i.getHistory();o.setCurrent({id:0,url:"#"+t.config.entity,title:s});var l=t.config,u=e.extend(l,new a(l).getConfig(l));u.context.entity=u.entity;var c=t.container=n.create({name:"board page container",layout:u.layout,template:u.template,extensions:e.union([],u.extensions||[]),context:l.context});c.on("afterInit",t["container afterInit"],t),c.on("afterRender",t["container afterRender"],t),c.on("componentsCreated",t["container componentsCreated"],t),c.initialize(u)},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.destroyContainer(),this._super()}})}),define("tau/components/component.page.finish-iteration",["tau/components/component.page.base","tau/views/view.page.finish-iteration"],function(e,t){return{create:function(i){var n={name:"finish iteration page component",turnOffErrorEmiter:!0,extensions:[],ViewType:t,entity:i.entity};return i["queue.bus"]=!0,e.create(n,i)}}}),define("tau/configurations/reports.container.config",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e){this.tabs=[this.getProcessControlChartTabConfig(e),this.getBurnDownTabConfig(e),this.getCycleTimeDistributionChartTabConfig(e),this.getRelationsNetworkChartTabConfig(e)]},getProcessControlChartTabConfig:function(){return{selected:!0,label:"processControl",header:[{type:"label",text:"Process Control"}],items:[{path:"tp/reports/processControl/component.report"}]}},getBurnDownTabConfig:function(){return{label:"burnDown",header:[{type:"label",text:"Burn Down"}],items:[{path:"tp/reports/burndown/component.report"}]}},getCycleTimeDistributionChartTabConfig:function(){return{label:"timeDistribution",header:[{type:"label",text:"Cycle Time Distribution"}],items:[{path:"tp/reports/cycleTimeDistribution/component.report"}]}
},getRelationsNetworkChartTabConfig:function(){return{label:"relationsNetwork",header:[{type:"label",text:"Relations Network"}],items:[{path:"tp/reports/relationsNetwork/component.report"}]}},getConfig:function(){return{type:"container",layout:"list",name:"reports container",children:[{type:"shareLinkReport"},{type:"tabs",cssClass:"tau-tabs",tabs:this.tabs,stateName:"reports"}]}},getReportNameByKey:function(e){var t=this.tabs.filter(function(t){return t.label==e});return t.length?t[0].header[0].text:"Reports"},getReportConfigByKey:function(e){var t=this.tabs.filter(function(t){return t.label==e});return t.length?t[0].items[0]:this.tabs[0].items[0]}});return i}),define("tp/reports/burndown/filterStorage",["tau/core/class","tau/storage/api","Underscore"],function(e,t,i){return e.extend({init:function(e){this.api=new t,this.groupName=e.groupName,this.key="setting"},scopeData:"userData",savePlannableFilter:function(e){var t={scope:"Public"};t[this.scopeData]=e,this.api.data(this.groupName,this.key,t)},fields:["includeWeekends","showBugs","isInPoints","burnDownType","plannableId"],findPlannableFilter:function(e){this.api.select(this.groupName,{$where:{key:this.key},$fields:i.map(this.fields,function(e){return this.scopeData+"."+e},this)}).done(function(t){var i=null;t.data.length>0&&t.data[0].burnDownType&&(i=t.data[0],i.burnDownType=i.burnDownType.toLowerCase()),e(i)})}})}),define("tp/reports/burndown/filterStorageShare",["tp/reports/burndown/filterStorage","tau/storage/api"],function(e,t){return e.extend({init:function(e){this.api=new t,this.groupName=e.groupName,this.key=e.key},scopeData:"publicData"})}),define("tau/views/view.page.report",["Underscore","jQuery","tau/core/view-base","tau/components/component.container","tau/configurations/reports.container.config","tp/reports/burndown/filterStorageShare","tau/core/tau"],function(e,t,i,n,a,r,s){return i.extend({initialize:function(){},configCollapseFieldName:"collapser_aside_collapsed","bus beforeInit":function(){var i=this.config.context.configurator,n=i.getRestStorage(),a=i.getSettingsManager(),r={};
r[this.configCollapseFieldName]=!0,a.set({set:r}),this.fire("configurator.ready",i);var o=e.bind(n.data,n,"reports",this.config.id);o().then(function(e){return e.value?e:t.Deferred().reject(e.config.$key)}.bind(this)).done(this.initPageComponent.bind(this,this.config,i,o)).fail(function(t){var i=new s.Error(e.sprintf("Report with Id %s not found or access is forbidden",t));this.fire("loadingError.ready",i)}.bind(this))},"bus configurator.ready:last + loadingError.ready":function(e,t,i){t.getTitleManager().set(i.message);var n=t.getHistory().pop(),a=t.getTemplateFactory().get("page.error").bind({},{err:i,backLink:n?n.url:null});this["container afterRender"]({data:{element:a}})},initPageComponent:function(t,i,o,l){var u=new a(t),c=i.getLoggedUser(),d=c.isAdministrator||e.contains(l.data.ownerIds,c.id),p=l.value.reportType,f=u.getReportConfigByKey(p),m=i.getHistory();if(m.updateCurrent({url:"#report/"+l.data.key,title:u.getReportNameByKey(p)}),i.getTitleManager().setTitle(u.getReportNameByKey(p)),"burnDown"===p){var h=r;d||(h=r.extend({savePlannableFilter:s.empty})),f.storage=new h({groupName:"reports",key:this.config.id})}else f.modelOverride={getStorage:function(){return o},initialSettings:function(t){return t.data&&t.data.publicData?e.defaults(t.data.publicData,this.defaultData):this.defaultData},saveToStorage:function(e,t){d&&e({scope:"Public",publicData:t}).done()}};var g=e.extend(t,{type:"container",layout:"list",name:"reports container",cssClass:"tau-app tau-page-single tau-page-entity",children:[f]});this.container=n.create({name:"board page container",layout:g.layout,template:g.template,extensions:e.union([],g.extensions||[]),context:t.context});var v=i.getAppStateStore();this.acidStore=v,v.unbind({listener:this}),v.bind({fields:["acid"],listener:this,callback:function(){this.container.fire("refresh")}}),this.container.on("afterInit",this["container afterInit"],this),this.container.on("afterRender",this["container afterRender"],this),this.container.on("componentsCreated",this["container componentsCreated"],this),this.container.initialize(g)
},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.acidStore&&this.acidStore.unbind({listener:this}),this.destroyContainer(),this._super()}})}),define("tau/components/component.page.report",["tau/components/component.page.base","tau/views/view.page.report"],function(e,t){return{create:function(i){var n={name:"report page component",turnOffErrorEmiter:!0,extensions:[],ViewType:t};return i.queuedBus=!0,e.create(n,i)}}}),define("tau/views/view.page.reports",["Underscore","jQuery","tau/core/view-base","tau/components/component.container","tau/configurations/reports.container.config"],function(e,t,i,n,a){return i.extend({init:function(e){this._super(e)},initialize:function(){},"bus beforeInit":function(){var t=this,i=t.config,r=new a(i),s=t.config.context.configurator;s.getTitleManager().setTitle("Report");var o=s.getHistory();setTimeout(e.bind(function(){o.reset(),o.setCurrent({id:0,url:"#reports/"+this.config.reportType,title:r.getReportNameByKey(this.config.reportType)})},this),1);var l=s.getBoardSettingsFactory().createComponentSettings({id:"reports"});t.config.context.componentSettings=l;var u=e.extend(i,r.getConfig()),c=t.container=n.create({name:"board page container",layout:u.layout,template:u.template,extensions:e.union([],u.extensions||[]),context:i.context}),d=function(e){s.setConfig("states",e),c.on("afterInit",t["container afterInit"],t),c.on("afterRender",t["container afterRender"],t),c.on("componentsCreated",t["container componentsCreated"],t),c.initialize(u)};this.processStates().done(function(e){d(e)}),l.unbind({listener:t,callback:t.onStateChanged}),l.bind({fields:["reports"],listener:t,callback:function(e){o.updateCurrent({url:"#reports/"+e.reports,title:r.getReportNameByKey(e.reports)})
}})},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,e.data.element.addClass("tau-page-entity"),this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},processStates:function(){var e=this.config.reportType,i=this.config.context.componentSettings,n=t.Deferred();return e?i.set({set:{reports:e},callback:function(e){n.resolve(e)}}):i.get({fields:["reports"],callback:function(e){n.resolve(e)}}),n},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.config.context.componentSettings.unbind({listener:this}),this.destroyContainer(),this._super()}})}),define("tau/components/component.page.reports",["tau/components/component.page.base","tau/views/view.page.reports"],function(e,t){return{create:function(i){var n={name:"reports page component",turnOffErrorEmiter:!0,extensions:[],ViewType:t};return e.create(n,i)}}}),define("tau/services/search/service.search.resultHandler",["Underscore","tau/core/class","tau/utils/utils.date","tau/ui/ui.templateFactory"],function(e,t,i,n){var a=t.extend({init:function(){this.preProcessingStrategies={comment:function(e){e.entityType={name:"comment"};var t=n.getTermProcessor();return e.general.entityType.term=t.getTerm(e.general.entityType.name),e}}},handle:function(t,i,n){t.fail(function(e){i.reject({data:{error:!0,response:e}})}).done(e.bind(function(t){var a=e.trim(n).replace(/(\d+)/g," $1 "),r=e.without(a?a.split(/\s|\?|\*|\+|-|:|'|"/g):[],"");r=e(r).chain().filter(function(e){return e&&(/^\d+$/.test(e)||e.length>1)}).uniq().value(),i.resolve({data:{keywords:r,info:t.info,items:e.map(t.items,e.bind(this._adaptItem,this))}})},this))},_adaptItem:function(t){var a=t.__type.toLowerCase(),r=this.preProcessingStrategies[a]||e.identity;t=r(t);var s=n.getTermProcessor();return t.entityType.term=s.getTerm(t.entityType.name),t.nameExt=t.nameExt||t.name,t.descExt=t.descExt||t.description||"",t.tags=t.tags?t.tags.split(", "):[],t.createDate=i.parse(t.createDate),t
}});return a}),define("tau/services/search/service.search.command",["jQuery","Underscore","tau/core/class","tau/services/search/service.search.resultHandler"],function(e,t,i,n){var a=i.extend({init:function(e,t,i){this.configurator=e,this.params=t,this.$resultDeferred=i,this.searchResultHandler=new n},_fetchDetailsByIDs:function(i){var n=t.defaults(i.IndexProgressData||{},{CompleteInPercents:100}),a={info:{pageNo:this.params.pageNo,pageSize:this.params.pageSize,total:i.Total,indexProgress:n.CompleteInPercents},items:[]},r=e.Deferred();if(a.info.total>0){var s=i.AssignableIds,o=i.TestCaseIds,l=i.GeneralIds,u=i.ImpedimentIds,c=i.CommentIds,d=this.configurator.getStore();if(s.length){var p={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{entityState:["id","name","isFinal"]},{project:["id","name"]},{team:["id","name"]}],$query:{id:{$in:s}}};d=d.find("assignable",p)}if(o.length){var f={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{project:["id","name"]}],$query:{id:{$in:o}}};d=d.find("testcase",f)}if(l.length){var m={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{project:["id","name"]}],$query:{id:{$in:l}}};d=d.find("general",m)}if(u.length){var h={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{entityState:["id","name","isFinal"]},{project:["id","name"]}],$query:{id:{$in:u}}};d=d.find("impediment",h)}if(c.length){var g={fields:["id","description","createDate",{general:["id","name",{entityType:["id","name"]}]}],$query:{id:{$in:c}}};d=d.find("comment",g)}d.done({success:function(e){var i=[];t.each(e,function(e){i=i.concat(e.data)}),a.items=t.sortBy(i,function(e){return-1*e.id}),r.resolve(a)},failure:function(e){r.reject(e)}})}else r.resolve(a);return r},_done:function(e){this.searchResultHandler.handle(e,this.$resultDeferred,this.params.searchString)}});return a.allowsToBeFiltered=!1,a}),define("tau/services/search/service.search.command.multiIds",["jQuery","Underscore","tau/core/class","tau/services/search/service.search.command"],function(e,t,i,n){var a=n.extend({init:function(e,t,i){this._super(e,t,i),this.currentPageFromIndex=t.pageNo*t.pageSize,this.currentPageToIndex=this.currentPageFromIndex+t.pageSize,this.searchParameters=this._parseSearchString()
},execute:function(){this._searchItemsPromise().done(t.bind(this._done,this))},_parseSearchString:function(){var e=this.params.searchString.split(","),i=[];return t.forEach(e,function(e){var n=t.trim(e),a=/^\d+$/.test(n);a&&i.push(parseInt(n))}),{Ids:i}},_searchItemsPromise:function(){var t=this.configurator.getStore(),i=e.Deferred();return t.get("general",{fields:["id",{entityType:["name"]}],$query:{id:{$in:this.searchParameters.Ids}},$orderBy:"id"}).done(function(e){i.resolve(e[0].data)}),i.promise()},_done:function(e){var i=this._createResultAdapter(e,t.bind(this._resultFilter,this));this._super(t.bind(this._fetchDetailsByIDs,this)(i))},_createResultAdapter:function(e,i){var n=this.configurator.getStore(),a=t(e).chain().filter(i).reduce(t.bind(function(e,i){var a=i.entityType.name,r=a+"Ids";if(!e.hasOwnProperty(r)){var s=n.typeMetaInfo(a);r=t.titleize(s.parent)+"Ids"}return e.hasOwnProperty(r)&&(this._shouldBeShownInCurrentPage(e.Total)&&e[r].push(i.id),++e.Total),e},this),{AssignableIds:[],CommentIds:[],GeneralIds:[],TestCaseIds:[],ImpedimentIds:[],Total:0}).value();return a},_shouldBeShownInCurrentPage:function(e){return e>=this.currentPageFromIndex&&e<this.currentPageToIndex},_resultFilter:function(e){return t.contains(this.searchParameters.Ids,e.id)&&e.hasOwnProperty("entityType")}});return a.isSuitableCommand=function(e){var i=e.split(",");return i.length>1?t.every(i,function(e){var i=t.trim(e),n=/^\d+$/.test(i);return n}):!1},a}),define("tau/services/search/service.search.command.multiIdsParts",["Underscore","tau/core/class","tau/services/search/service.search.command.multiIds","tau/libs/store2/store2"],function(e,t,i,n){var a=i.extend({_parseSearchString:function(){var t=this.params.searchString.split(",");if(t.length>0){var i=[];e.forEach(t,function(t){var n=e.trim(t);/^\*\d+\*$/.test(n)?i.push({value:n.replace(/\*/g,""),apiMethod:"contains"}):/^\*\d+$/.test(n)?i.push({value:n.replace(/^\*/,""),apiMethod:"endsWith"}):/^\d+\*$/.test(n)&&i.push({value:n.replace(/\*$/,""),apiMethod:"startsWith"})
})}return{idParts:i}},_searchItemsPromise:function(){var t=new n(this.configurator),i=e.reduce(this.searchParameters.idParts,function(e,t){return e&&(e+=" or "),e+="convert.toString(Id.Value)."+t.apiMethod+'("'+t.value+'")'},"");return t.findAll("general?&select={id, {entityType.id, entityType.name} as entityType}&where=("+i+")&orderBy=id&take=1000&skip=0")},_resultFilter:function(e){return e.hasOwnProperty("entityType")}});return a.isSuitableCommand=function(t){var i=t.split(",");return i.length>0?e.every(i,function(t){var i=e.trim(t),n=/^(?:\*\d+\*|\*\d+|\d+\*)$/.test(i);return n}):!1},a}),define("tau/services/search/service.search.command.text.contextBuilder",["jQuery","Underscore","tau/core/class"],function(e,t,i){var n=i.extend({init:function(e,t){this.configurator=e,this.params=t},getContextPromise:function(){var i=e.Deferred();return this._getInitialContextPromise().done(t.bind(function(n){var a=e.Deferred(),r=e.Deferred(),s=this.configurator.getStore(),o=t.difference(n.selectedProjectIds,n.selectedProjectIdsAvailable),l=t.difference(n.selectedTeamIds,n.selectedTeamIdsAvailable),u=n.isAllProjects?n.selectedTeamIds:l;u=t.without(u,"null");var c=n.isAllTeams?n.selectedProjectIds:o;c=t.without(c,"null");var d=0!==u.length,p=0!==c.length;d?s=this._handleTeams(s,u,a):a.resolve({}),p?s=this._handleProjects(s,c,r):r.resolve({}),(d||p)&&s.done(),e.when(a,r).then(function(e,a){var r={},s=function(e,i){var n=t.union(r[i]||[],e);n.length&&(r[i]=n)};t.each(e,s),t.each(a,s),n.teamProjectRelations=t(r).chain().keys().reduce(function(e,i){i=parseInt(i,10);var a=e[i];return(n.isAllProjects||n.isAllTeams)&&t.contains(n.selectedTeamIdsAvailable,i)?a=t.difference(a,n.selectedProjectIdsAvailable):n.isAllTeams&&!t.contains(n.selectedTeamIdsAvailable,i)||(t.contains(l,i)?a=t.intersection(a,n.selectedProjectIds):t.contains(n.selectedTeamIdsAvailable,i)?a=t.intersection(a,o):(a=[],delete e[i])),a.length?e[i]=a:delete e[i],e},r).value(),i.resolve(n)})},this)),i.promise()},_getInitialContextPromise:function(){var i=this.configurator.getApplicationContextService(),n=this.configurator.getLoggedUser(),a=e.Deferred(),r=e.Deferred(),s=e.Deferred(),o=e.Deferred(),l=this.params.isAllProjects,u=this.params.isAllTeams;
if(l?e.when(o).done(function(e){var i=t(e.projects).pluck("id");a.resolve({isAllProjects:!0,includeNoProject:!0,selectedProjectIds:i,selectedProjectIdsAvailable:i})}):e.when(s).done(function(e){a.resolve({includeNoProject:e.appContext.projectContext.no,selectedProjectIds:e.selectedProjectIds,selectedProjectIdsAvailable:e.selectedProjectIdsAvailable})}),u?e.when(o).done(function(e){var i=t(e.teams).pluck("id");r.resolve({isAllTeams:!0,includeNoTeam:!0,selectedTeamIds:i,selectedTeamIdsAvailable:i})}):e.when(s).done(function(e){r.resolve({includeNoTeam:e.appContext.teamContext.no,selectedTeamIds:e.selectedTeamIds,selectedTeamIdsAvailable:e.selectedTeamIdsAvailable})}),(l||u)&&i.getTeamsProjectsAvailable(n.id).done(o.resolve),!l||!u){var c=this.configurator.getAppStateStore();c.get({fields:["acid"]}).then(function(e){return i.getApplicationContext({acid:e.acid})}).done(s.resolve)}return e.when(a,r).then(function(e,i){return t.extend(e,i)})},_handleTeams:function(e,i,n){return e=e.find("teams",{fields:["id",{teamProjects:["id",{project:["id"]}]}],$query:{id:{$in:i}},list:!0},{success:function(e){var i=e.data,a=t(i).reduce(function(e,i){var n=t(i.teamProjects).map(function(e){return e.project.id});return n.length&&(e[i.id]=n),e},{});n.resolve(a)}})},_handleProjects:function(e,i,n){return e=e.find("projects",{fields:["id",{teamProjects:["id",{team:["id"]}]}],$query:{id:{$in:i}},list:!0},{success:function(e){var i=e.data,a=t(i).reduce(function(e,i){var n=t(i.teamProjects).map(function(e){return e.team.id});return e=t(n).reduce(function(e,t){return e[t]=e[t]||[],e[t].push(i.id),e},e)},{});n.resolve(a)}})}});return n}),define("tau/services/search/service.search.command.text",["jQuery","Underscore","tau/core/class","tau/services/search/service.search.command","tau/services/search/service.search.command.text.contextBuilder"],function(e,t,i,n,a){var r=n.extend({init:function(e,t,i){this._super(e,t,i),this.searchContextBuilder=new a(this.configurator,t)},execute:function(){this._done(this.searchContextBuilder.getContextPromise().then(t.bind(this._searchTextPromise,this)).then(t.bind(this._fetchDetailsByIDs,this)))
},_searchTextPromise:function(i){var n="{AppPath}/api/v1/Plugins.asmx/Search/Profiles/Now%20running/Commands/Search".replace(/{AppPath}/g,this.configurator.getApplicationPath()),a=this.configurator.getLoggedUser(),r=JSON.stringify({Command:"Search",Plugin:"Search",LoggedUserId:null!=a?a.id:null,TeamIds:t.without(i.selectedTeamIdsAvailable,"null"),IncludeNoTeam:i.includeNoTeam,ProjectIds:t.without(i.selectedProjectIdsAvailable,"null"),IncludeNoProject:i.includeNoProject,TeamProjectRelations:t(i.teamProjectRelations).map(function(e,t){return{TeamId:parseInt(t),ProjectIds:e}}),Query:this.params.searchString,EntityTypeId:this.params.entityTypeId,EntityStateIds:t.isArray(this.params.entityStateIds)?this.params.entityStateIds:t((this.params.entityStateIds||"").split(",")).chain().without("").map(function(e){return parseInt(e)}).value(),Page:{Number:this.params.pageNo,Size:this.params.pageSize}});return e.ajax({url:n,type:"POST",data:r,dataType:"json"})}});return r.isSuitableCommand=function(){return!0},r.allowsToBeFiltered=!0,r}),define("tau/services/search/service.search.commandFacttory",["tau/services/search/service.search.command.multiIds","tau/services/search/service.search.command.multiIdsParts","tau/services/search/service.search.command.text"],function(e,t,i){var n={getSuitableCommand:function(n){return e.isSuitableCommand(n)?e:t.isSuitableCommand(n)?t:i}};return n}),define("tau/services/service.search",["jQuery","Underscore","tau/ui/ui.templateFactory","tau/core/class","tau/services/search/service.search.commandFacttory","tau/services/search/service.search.command.multiIdsParts","tau/services/search/service.search.command.text"],function(e,t,i,n,a){var r=n.extend({init:function(t){var i=this;i.defaultParams={searchString:"",entityTypeId:null,entityStateIds:null,pageSize:10,pageNo:0},i.storage=t.storage,i._params=t.storage,i.configurator=t.configurator,i.$paramsChangedCallbacks=e.Callbacks(),i.$dParamsChanged=e.Deferred(),i.$dParamsChanged.progress(i.$paramsChangedCallbacks.fire),i.$clearCallbacks=e.Callbacks(),i.$dClear=e.Deferred(),i.$dClear.progress(i.$clearCallbacks.fire),i.$submitCallbacks=e.Callbacks(),i.$dSubmit=e.Deferred(),i.$dSubmit.progress(i.$submitCallbacks.fire),i.$searchCallbacks=e.Callbacks(),i.$dSearch=e.Deferred(),i.$dSearch.progress(i.$searchCallbacks.fire)
},asDisposable:function(e,i){var n=this,a={};return a.dispose=t.bind(function(e,t,i){e[i](t)},a,n,e,i),a},onParamsChanged:function(e){var t=this;return t.$paramsChangedCallbacks.add(e),t.asDisposable(e,"offParamsChanged")},offParamsChanged:function(e){this.$paramsChangedCallbacks.remove(e)},onClear:function(e){return this.$clearCallbacks.add(e),this.asDisposable(e,"offClear")},offClear:function(e){this.$clearCallbacks.remove(e)},onSubmit:function(e){return this.$submitCallbacks.add(e),this.asDisposable(e,"offSubmit")},offSubmit:function(e){this.$submitCallbacks.remove(e)},onSearch:function(e){return this.$searchCallbacks.add(e),this.asDisposable(e,"offSearch")},offSearch:function(e){this.$searchCallbacks.remove(e)},params:function(){var e=this;return{get:function(t){return arguments.length?e._params[t]:e._params},set:function(i,n){var a=[],r={};if(t.isString(i))a=[i],r[i]=n;else{if(!t.isObject(i))throw new Error("Unsupported argument [key]");a=t.keys(i),r=i}var s=1===a.length&&"pageNo"===a[0];s||(r.pageNo=0);var o=t.keys(r),l={};return t.each(o,function(t){r[t]!==e._params[t]&&(l[t]=r[t])}),e._params=t.extend(e._params,r),e.$dParamsChanged.notify(l),this},submit:function(){var t=e._params;e.$dSubmit.notify(t)},clear:function(){e._params=t.clone(e.defaultParams),e.$dClear.notify(e._params)}}},__adaptEntityTypes:function(e){var n=i.getTermProcessor();return t(e).chain().filter(function(e){var t=e.name.toLowerCase();return"solution"!==t}).map(function(e){return e.term=n.getTerm(e.name),e}).reject(function(e){return!e.term}).value()},__adaptEntityStates:function(e,i){return t(e).chain().reduce(function(e,n){return e[n.name]=e[n.name]||{contextStateIds:[],availableStateIds:[]},t.contains(i,n.process.id)&&e[n.name].contextStateIds.push(n.id),e[n.name].availableStateIds.push(n.id),e},{}).pairs().reject(function(e){return 0===e[1].contextStateIds.length}).map(function(e){var t=e[0],i=e[1];return{id:i.contextStateIds.join(","),availableId:i.availableStateIds.join(","),name:t}
}).sortBy(function(e){return e.name}).value()},getSearchDomain:function(i){var n=this;i=i||n.params().get();var a=this.configurator,r=e.Deferred(),s=a.getStore(),o=a.getAppStateStore(),l=a.getApplicationContextService();return o.get({fields:["acid"],callback:function(e){l.getApplicationContext({acid:e.acid},{success:function(e){var a=t.pluck(e.availableProcesses,"id"),o=t.pluck(e.processes,"id"),l={process:{id:{$in:a}}};s.find("entityType",{list:!0,fields:["id","name"],$query:{isSearchable:1}}).find("entityState",{list:!0,fields:["id","name",{entityType:["id","name"]},{process:["id"]}],$query:l}).done(function(e){var s=n.__adaptEntityTypes(e[0].data),l=i.entityTypeId?function(e){return e.entityType.id==i.entityTypeId}:function(){return!0},u=t(e[1].data).filter(l),c=n.__adaptEntityStates(u,i.isAllProjects?a:o);r.resolve({entityTypes:s,entityStates:c,params:i})})}})}}),r},search:function(i){return t.defaults(i,this.defaultParams),{done:t.bind(function(n){var a;t.isFunction(n)?(a=e.Deferred(),a.always(n)):a=n,a.always(this.$dSearch.notify);var r=this.getSuitableCommand(i.searchString);new r(this.configurator,i,a).execute()},this)}},getSuitableCommand:function(e){return a.getSuitableCommand(e)}});return r}),define("tau/ui/extensions/search.filter.hider/ui.extension.search.filter.hider",["jQuery","Underscore","tau/core/extension.base","tau/services/service.search"],function(e,t,i){return i.extend({"bus afterRenderAll":function(e,i){var n=i.data.context.configurator,a=n.service("search"),r=i.element,s=t.bind(this._hideFilterIfNeeded,this,a,r),o=function(e){var t;return function(){t&&(clearTimeout(t),t=null),t=setTimeout(function(){e()},200)}};r.on("keyup",".i-role-search-string",o(s)),r.on("change",".i-role-search-string",s),s()},_hideFilterIfNeeded:function(e,i){var n=t.trim(i.find(".i-role-search-string").val()),a=!e.getSuitableCommand(n).allowsToBeFiltered;i.toggleClass("tau-search-no-filter",a)}})}),define("tau/configurations/search.container.config",["Underscore","tau/core/class","tau/ui/extensions/search.filter.hider/ui.extension.search.filter.hider"],function(e,t,i){var n=t.extend({getConfig:function(){return{children:[{type:"container",name:"search results container",layout:"selectable",template:{name:"search-results-container",markup:['<div class="tau-container i-role-container-target"></div>']},children:[{type:"search.filter",selector:".i-role-container-target"},{type:"search",selector:".i-role-container-target"}],extensions:[i]}]}
}});return n}),define("tau/views/view.page.search",["Underscore","jQuery","tau/core/view-base","tau/components/component.container","tau/configurations/search.container.config"],function(e,t,i,n,a){return i.extend({init:function(e){this._super(e)},initialize:function(){},"bus beforeInit":function(){var t=this,i=t.config.context.configurator;i.getTitleManager().setTitle("Search");var r=i.getHistory();r.reset(),r.setCurrent({id:0,url:"#"+t.config.entity,title:"Back to search results"});var s=t.config,o=e.extend(s,new a(s).getConfig(s)),l=t.container=n.create({name:"board page container",layout:o.layout,template:o.template,extensions:e.union([],o.extensions||[]),context:s.context});l.on("afterInit",t["container afterInit"],t),l.on("afterRender",t["container afterRender"],t),l.on("componentsCreated",t["container componentsCreated"],t),l.initialize(o)},"container afterInit":function(){this.fireAfterInit()},"container componentsCreated":function(e){this.fire(e.name,e.data)},"container afterRender":function(e){this.fireBeforeRender(),this.element=e.data.element,this.fireAfterRender()},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),this.container=null)},destroy:function(){this.destroyContainer(),this._super()}})}),define("tau/components/component.page.search",["tau/components/component.page.base","tau/views/view.page.search"],function(e,t){return{create:function(i){var n={name:"search page component",turnOffErrorEmiter:!0,extensions:[],ViewType:t};return i["queue.bus"]=!0,e.create(n,i)}}}),define("tau/models/model.pluginsList",["Underscore","jQuery","tau/core/model-base"],function(e,t,i){var n=i.extend({onInit:function(){this.config.context.pluginRepository.getPlugins(t.proxy(this.onPluginsRetrieved,this))},onPluginsRetrieved:function(e){this.augmentData(e),this.fire("dataBind",{items:e})},augmentData:function(t){var i=this.config.context.configurator;e(t).each(function(t){e(t.plugins).each(function(e){e.iconSrc=[i.getApplicationPath(),"/PluginIcon.ashx?pluginName=",e.name].join(""),e.profilesShort=e.profiles.slice(0,3),e.profilesMore=e.profiles.slice(3)
},this)},this)}});return n}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.profile",["tau/core/templates-factory"],function(e){var t={name:"pluginsList-profile",markup:["<ul>",'   <li class="name tau-profileName"><a href="${editUrl}">${name}</a></li>','   <li class="delete"><a class="tau-profile-actions button danger" href=""><span class="delete-icon"></span></a></li>',"</ul>"]};return e.register(t)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.plugin",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.profile"],function(e){var t={name:"pluginsList-plugin",markup:['<div class="plugin-block">','   <img src="${iconSrc}" />','   <h4 class="_pluginName">${name}</h4>','   <p class="note-p">${description}</p>','   <div class="separator"></div>','   <div class="profiles-list">','       <div class="tau-profiles-short">','           {{tmpl(profilesShort) "pluginsList-profile"}}',"       </div>",'       <div class="tau-profiles-more" style="display:none">','           {{tmpl(profilesMore) "pluginsList-profile"}}',"       </div>","   </div>",'   <div class="pb-5 tau-profiles-moreLink" style="display:none">','       <a class="more-link">Show more (${profilesMore.length})</a>',"   </div>",'   <div class="pt-5">','       <button type="button" class="button bold" onClick="window.location.href = \'${newProfileUrl}\';">Add Profile</button>',"   </div>","</div>"],dependencies:["pluginsList-profile"]};return e.register(t)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.category",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.plugin"],function(e){var t={name:"pluginsList-category",markup:['<div class="plugins-category">','<div class="expanded tau-pluginCategory">','<span class="label">${category}</span>',"</div>",'{{tmpl(plugins) "pluginsList-plugin"}}',"</div>"],dependencies:["pluginsList-plugin"]};return e.register(t)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.category"],function(e){var t={name:"pluginsList",options:{contentSelector:".ui-pluginsList-table"},markup:['<div class="plugins">','   <div class="list">','       <h2 class="h2 icon">Plugins</h2>','       {{tmpl(items) "pluginsList-category"}}',"   </div>","</div>"],dependencies:["pluginsList-category"]};
return e.register(t)}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){var n=i.extend({"bus dataBind+afterRender":function(i){this.element=i.afterRender.data.element,this.dataToBind=i.dataBind.data;var n=this.element.find(".plugin-block");e(n).each(function(e){t(e).find(".tau-profile-actions").click(t.proxy(this.onDeleteProfile,{pluginBlock:t(e),parentExtension:this}))},this)},onDeleteProfile:function(e){e.preventDefault();var i=this.parentExtension,n=t(e.target).tmplItem().data,a=this.pluginBlock,r=function(){a.confirmation("hide"),a.tauOverlay("hide"),i.fire("refresh")};a.confirmation({message:"Do you really want to delete profile?",okLabel:"OK",cancelLabel:"Cancel",ok:function(){a.tauOverlay({showOnCreation:!1}),a.tauOverlay("showLarge"),a.confirmation("hideConfirmationMessage"),i.config.context.pluginRepository.deleteProfile(n.pluginName,n.name,r)},cancel:function(){a.confirmation("hide")}}),this.pluginBlock.confirmation("show")}});return n}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){var n=i.extend({"bus dataBind+afterRender":function(i){this.element=i.afterRender.data.element,this.dataToBind=i.dataBind.data,e(this.element.find(".plugin-block")).each(function(e){var i=t(e).tmplItem().data.name;this.config.context.pluginRepository.getProfilesErrors(i,t.proxy(this.onProfilesErrorsRetrieved,{element:t(e),data:t(e).tmplItem().data}))},this)},onProfilesErrorsRetrieved:function(i){e(this.element.find(".tau-profileName")).each(function(n){e(i).each(function(e){if(e.ProfileName==t(n).tmplItem().data.name&&e.ErrorsExist){var i=t(n);i.fadeOut("slow"),i.children("a").addClass("error-indicator"),t(n).fadeIn("slow")}})},this)}});return n}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){var n=i.extend({"bus dataBind+afterRender":function(i){e(i.afterRender.data.element.find(".plugins-category")).each(function(e){var i=t(e);
i.find(".tau-pluginCategory").click(function(e){e.preventDefault();var n=t(this),a=n.hasClass("collapsed"),r=a?"collapsed":"expanded",s=a?"expanded":"collapsed";n.removeClass(r),n.addClass(s),a?(i.find(".plugin-block").show(),i.find(".create-me").show()):(i.find(".plugin-block").hide(),i.find(".create-me").hide())})})}});return n}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){var n=i.extend({"bus dataBind+afterRender":function(i){this.element=i.afterRender.data.element,this.dataToBind=i.dataBind.data,e(this.element.find(".plugin-block")).each(function(e){var i=t(e),n=i.tmplItem().data.profilesMore.length;if(n>0){var a=i.find(".tau-profiles-more"),r=i.find(".tau-profiles-moreLink");r.show(),r.click([r,a],t.proxy(this.onShowMoreClick,{profilesMoreCount:n}))}},this)},onShowMoreClick:function(e){e.preventDefault();var t=e.data[0].find(".more-link"),i=e.data[1];t.text(i.is(":visible")?["Show more (",this.profilesMoreCount,")"].join(""):"Show less"),i.animate({opacity:"toggle",height:"toggle"},"slow")}});return n}),define("tau/components/component.pluginsList",["require","tau/models/model.pluginsList","tau/ui/templates/pluginsList/ui.template.pluginsList","tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable","tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay","tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible","tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore","tau/ui/extensions/ui.extension.loading","tau/components/component.list.creator"],function(e){var t=e("tau/models/model.pluginsList"),i=e("tau/ui/templates/pluginsList/ui.template.pluginsList"),n=e("tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable"),a=e("tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay"),r=e("tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible"),s=e("tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore"),o=e("tau/ui/extensions/ui.extension.loading"),l=e("tau/components/component.list.creator");
return{create:function(e){var u={ModelType:t,template:i,message:"No plugins found",extensions:[n,a,r,s,o]};return l.create(u,e)}}}),define("tau/ui/templates/common/ui.template.buttonAction",["tau/core/templates-factory"],function(e){var t={name:"button-action",markup:['<a class="button-box ${id}-button user-action button small ${className}"',' role="button">','   <span class="">${title}</span>',"</a>"].join("")};return e.register(t)}),define("tau/ui/templates/print/ui.template.print",["tau/core/templates-factory","tau/ui/templates/common/ui.template.buttonAction"],function(e){var t={name:"print",markup:['<div class="ui-print">','   <div class="ui-print__controls">','       {{tmpl([{id: "x", className: "ui-print__controls__print", title: "Print"}]) "button-action"}}',"   </div>","</div>"],dependencies:["button-action"]};return e.register(t)}),define("tau/ui/extensions/print/ui.extension.print",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus beforeInit":function(e){this.options=e.data.config,this.options.window=this.options.window||window},"bus afterRender":function(t){this.element=t.data.element,this.entity=t.data.data.context.entity;var i=this.element;this._printHandler||(this._printHandler=e.bind(this._print,this),i.find(".ui-print__controls__print").bind("click",this._printHandler));i.find(".ui-print__controls__close");this._closeHandler||(this._closeHandler=e.bind(this._close,this),i.find(".ui-print__controls__close").bind("click",this._closeHandler))},_print:function(){this.options.window.print()},_close:function(e){e.preventDefault(),this.options.window.opener?this.options.window.close():this.config.context.configurator.getRedirect().redirect("tp2/entity/${entity.id}",null,this.options.context)}})}),define("tau/components/component.print",["Underscore","tau/core/component-base","tau/views/view.container","tau/ui/templates/print/ui.template.print","tau/ui/extensions/print/ui.extension.print"],function(e,t,i,n,a){return{create:function(r){return r=r||{},e.defaults(r,{template:n}),new t(r).attach(a).attach(i).bus
}}}),define("tau/models/model.program.progressBar",["Underscore","tau/core/model-base","tau/libs/store2/store2","tau/core/termProcessor","tau/core/templates-factory"],function(e,t,i,n,a){return t.extend({name:"Program Progress Bar",onInit:function(){var t=this.config.context.configurator.getStore2(),i=this.config.context.entity,n=i.id;t.findAll(e.sprintf("Program?select=({userStoriesCount() as totalStoriesCount, openUserStoriesCount() as openStoriesCount})&where=(Id=%d)",n)).then(function(t){var i=t[0],n=i.totalStoriesCount-i.openStoriesCount;this.fire("dataBind",{percentCompleted:this.calculatePercentCompleted(i),title:e.sprintf("%d of %d %s completed",n,i.totalStoriesCount,a.termProcessor.getTerms("userStory").names)})}.bind(this))},calculatePercentCompleted:function(e){return 0===e.totalStoriesCount?0:Math.round((e.totalStoriesCount-e.openStoriesCount)/e.totalStoriesCount*100)}})}),define("template!tau/ui/templates/progressBar/ui.template.portfolioItem.progressBar",["tau/core/templates-factory"],function(e){var t={name:"portfolioItem-progress-bar",engine:"jqote2",customFunctions:null,markup:'<div class="entity-progress-box"> <div class="ui-progress-bar-progress ui-progressbar__progress" title="<%! this.title %>"> <% var percentCompletedRounded = Math.round(this.percentCompleted); %> <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:<%= percentCompletedRounded < 15 ? 15 : percentCompletedRounded %>%;"> <span class="ui-label ui-progressbar__progress__label"><b class="value"><%= percentCompletedRounded %>%</b></span> </span> </div> </div>'};return e.register(t)}),define("tau/components/component.program.progressBar",["tau/components/component.creator","tau/models/model.program.progressBar","template!tau/ui/templates/progressBar/ui.template.portfolioItem.progressBar"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/views/view.composer",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher"],function(e,t,i,n){return i.extend({init:function(e){this._loaded=!1,this._super(e)
},initialize:function(){var t=this,i=t.config.children,n=e.isArray(i)&&e.size(i)>0&&t.config.visible;if(n){var a=t.config.children,r=t.config.context||{};this.fire("createComponents",{components:a,context:r})}else t._super.apply(t,arguments),t._fireChildrenRendered({children:[],childrenEvtArgs:[]})},"bus componentCreated":function(e){var t=e.data.component;this.fire("childComponentCreated",t)},"bus componentsCreated":function(e){this.fire("beforeComponentsInitialize",e.data),this.initializeChildrenComponents(e),this.fire("afterComponentsInitialize",e.data)},initializeChildrenComponents:function(t){var i=this,a=e(t.data).pluck("component"),r=e(t.data).pluck("config");i.dispatcher=new n(a),i.dispatcher.listen("afterInit",function(){i.fireAfterInit()}),i.dispatcher.listen("afterRender",function(e){var t=e.argsArr,n={children:a,childrenEvtArgs:t};i._fireChildrenRendered(n)}),e(a).each(function(e,t){var i=r[t];i.disableSubscriptions=!0,e.fire("initialize",i)})},_fireChildrenRendered:function(e){this.fire("internalChildrenRendered",e)},"bus afterInit+dataBind":function(){},"bus afterInit+dataBind+internalChildrenRendered":function(i){this.destroyChildComponents();var n=this,a=i.afterInit.data,r=i.dataBind.data,s=i.internalChildrenRendered.data;if(n.children=s.children,n.config.visible&&(n._loaded=!0),0===s.children.length)n.render(r,a);else{n.fireBeforeRender({data:r});var o=n.bindTemplate(r);o.find("[runas]").each(function(){var i=t(this),n=i.attr("runas"),a=i.attr("componentId"),r=e(s.childrenEvtArgs).detect(function(e){var t=e.view.config;return t.type===n&&t.id.toString()===a});if(!r)throw'Component "'+a+'" type of ['+n+"] not found";var o=r.element;i.replaceWith(o)}),n.fire("childrenRendered",s.children),n.updateElement(o,a.refreshSelector),n.config.visible||n.hide(),n.fireAfterRender({data:r})}},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},lifeCycleCleanUp:function(){this._super()},destroyChildComponents:function(){delete this.dispatcher,e.each(this.children,function(e){e.destroy()
}),delete this.children},destroy:function(){this.destroyChildComponents(),this._super()}})}),define("tau/models/model.progressBar",["tau/core/model-base"],function(e){var t=function(e){this.model=e};t.prototype={setEntity:function(e){this.entity=e.data},done:function(){if(this.model.config){var e=this.model.entity=this.entity;if(e){var t={id:e.id,entityType:{name:e.__type},entityState:{id:e.entityState.id,name:e.entityState.name,isFinal:e.entityState.isFinal},effortCompleted:e.effortCompleted,effortToDo:e.effortToDo,timeSpent:e.timeSpent,timeRemain:e.timeRemain},i=Math.round(100*parseFloat(t.effortToDo)+100*parseFloat(t.effortCompleted))/100;t.percentCompleted=Math.round(1e4*(t.effortCompleted/i))/100,t.percentCompleted=isNaN(t.percentCompleted)?0:t.percentCompleted,t.percentCompleted=t.percentCompleted>100?100:t.percentCompleted,e.entityState.isFinal&&(t.percentCompleted=100),t.disableSpentRemain=this.model.config.context.getTimeTrackingPolicies().disableSpentRemain;var n=this.model.config.maxWidthPercents;t.maxWidthPercents=_.isUndefined(n)===!1?n:100,t.textMode=this.model.config.textMode,this.model.bus.fire("dataBind",t)}}}};var i=e.extend({name:"Progress Bar",beforeSaveRoleEffort:function(e){var t=e.data.cmd.config;t.fields=t.fields||[],t.fields.push({assignable:["id","effortCompleted","effortToDo","timeSpent","timeRemain"]})},afterSaveEntity:function(e){var t=e.data;t.changes.hasOwnProperty("timeRemain")&&t.id===this.config.context.entity.id&&this.fire("remainTimeChanged")},afterSaveRoleEffort:function(){var e=this;e.fire("roleEffortChanged")},onDataUpdated:function(){var e=this;e.fire("refresh")},onInit:function(){var e=this,i=new t(this),n=this.config.context,a=n.entity.entityType.name,r=n.entity.id,s={entityState:["id","name","isFinal"]},o=["effortCompleted","effortToDo","timeSpent","timeRemain",s],l=function(t){var i=t.data.cmd.config.fields;t.data.cmd.config.fields=i.concat(o),e.fire("beforeChanges",t.data.changes)},u=function(t){var i=t.data?t.data.cmd:null;
null!=i&&e.isInTransaction(t)||e.fire("applyChanges",t.data.changes)};e.store.unbind(this),e.store.on({eventName:"beforeSave",type:a,filter:{id:n.entity.id},hasChanges:["entityState"],listener:this},l),e.store.on({eventName:"afterSave",type:a,filter:{id:n.entity.id},hasChanges:["entityState"],listener:this},u),e.store.on({eventName:"afterSave",type:a,filter:{id:n.entity.id},hasChanges:["effort|effortCompleted|effortToDo|timeSpent|timeRemain"],listener:e},_.bind(e.onDataUpdated,e)),e.store.on({eventName:"beforeSave",type:"roleEffort",listener:this},function(){e.beforeSaveRoleEffort.apply(e,arguments)}),e.store.on({eventName:"afterSave",type:"roleEffort",filter:{assignable:{id:n.entity.id}},listener:this},function(t){var i=t.data.changes||{},n=0===_.keys(i).length;n||e.isInTransaction(t)||e.afterSaveRoleEffort.apply(e,arguments)}),this.store.get(a,{id:r,fields:o},{success:i.setEntity,scope:i}).done({success:i.done,scope:i})},isInTransaction:function(e){var t=this,i=e.data?e.data.cmd:{};return i===t.lastCmd?!0:(t.lastCmd=i,!1)},"bus evict":function(){var e=this.config.context.entity;this.store.evictProperties(e.id,e.entityType.name,["effortCompleted","effortToDo","timeSpent","timeRemain","entityState"])}});return i}),define("tau/models/model.state.editable",["tau/core/model.editable.base"],function(e){return e.extend({category:"edit",name:"Editable State","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})},"bus beforeSave":function(e){var t=e.data.cmd,i=t.fields||[];i=i.concat(["effortCompleted","effortToDo","timeSpent","timeRemain"]),t.fields=i}})}),define("tau/ui/extensions/progressBar/ui.extension.progressBar.updater",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(e){return e.extend({"bus afterRender":function(e){this.$el=e.data.element,this.config.context.getTimeTrackingPolicies().disableSpentRemain&&this.$el.find(".ui-progressbar__data").hide()},"bus roleEffortChanged":function(){this.refresh()
},"bus remainTimeChanged":function(){this.refresh()},"bus beforeChanges":function(){this.$el.tauOverlay()},"bus applyChanges":function(){this.$el.data("ui-tauOverlay")&&this.$el.tauOverlay("hide"),this.refresh()},refresh:function(){this.fire("refresh")}})}),define("tau/ui/templates/progressBar/ui.template.progressBar",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(e,t){var i={name:"progress-bar",tags:[t],markup:['<div class="entity-progress-box">','   <div class="state-select">{{term(entityType.name) "name"}} state is','      <div componentId="ctrlEntityState" runas="property.entityState"></div>',"   </div>",'   <div class="ui-progressbar__data">','      <span class="ui-label-spent ui-progressbar__data__spent">Spent&nbsp;<b class="value">${timeSpent}h</b></span>','      <span class="ui-label-remain  ui-progressbar__data__remain">Remain&nbsp;<b class="value">${timeRemain}h</b></span>',"   </div>",'   <div class="ui-progress-bar-progress ui-progressbar__progress">',"{{if percentCompleted !== 0 }}",'      <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${ Math.round(percentCompleted) < 15 ? 15 : Math.round(percentCompleted) }%;">','         <span class="ui-label ui-progressbar__progress__label"><b class="value">${ Math.round(percentCompleted) }%</b></span>',"      </span>","{{/if}}","   </div>","</div>"],dependencies:["common-attributeValue"]};return e.register(i)}),define("tau/components/component.progressBar",["tau/components/component.creator","tau/views/view.composer","tau/components/extensions/component.creator.extension","tau/models/model.progressBar","tau/models/model.state.editable","tau/ui/extensions/progressBar/ui.extension.progressBar.updater","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/ui/templates/progressBar/ui.template.progressBar"],function(e,t,i,n,a,r,s,o){return{create:function(l,u){u=u||{};for(var c={ViewType:t,extensions:[u.model||n,a,i,r,s],template:u.template||o},d=l.extensions||[],p=0;p<d.length;p++)c.extensions.push(d[p]);
return l.children=[{id:"ctrlEntityState",type:"property.entityState",disabledExtensionCategories:l.disabledExtensionCategories}],e.create(c,l)}}}),define("tau/ui/templates/progressBar/ui.template.progressBar.small",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(e,t){var i=["{{if disableSpentRemain === false}}","Time spent: ${timeSpent}{{if timeSpent}}h{{/if}}  ","Time remain: {{if !timeRemain && timeRemain !== 0}}N/A{{else}}${timeRemain}{{if timeRemain}}h{{/if}}{{/if}}  ","{{/if}}","Percent complete: ${Math.round(percentCompleted)}%"].join(""),n={name:"progress-bar-small",tags:[t],markup:["<div>","{{if textMode}}",'<div class="tau-extension-tooltip" title="'+i+'">',"${Math.round(percentCompleted)}%","</div>","{{else}}","{{if maxWidthPercents > 0}}",'    <div class="ui-progress-bar-progress ui-progressbar__progress tau-extension-tooltip" style="width:${maxWidthPercents}%;" title="'+i+'">','        <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${percentCompleted}%;{{if percentCompleted == 0}}display:none;{{/if}}"></span>',"    </div>","{{else}}",'   <div{{if maxWidthPercents == 0}} class="tau-extension-tooltip" title="'+i+'"{{/if}}>',"   </div>","{{/if}}","{{/if}}","</div>"]};return e.register(n)}),define("tau/components/component.progressBar.small",["Underscore","tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.progressBar","tau/ui/extensions/progressBar/ui.extension.progressBar.updater","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/progressBar/ui.template.progressBar.small"],function(e,t,i,n,a,r,s){return{create:function(e,i){i=i||{};var o={extensions:[n,a,r],template:s};return t.create(o,e)}}}),define("tau/models/project.formAdd/model.project.formAdd.data",["Underscore","jQuery","tau/core/extension.base","tau/configurations/project.colors","tau/core/templates-factory"],function(e,t,i,n,a){var r=function(e){return e.name.toUpperCase()
};return i.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i)},"bus configurator.ready:last + beforeInit":function(t,i){var n=i.getStore(),a=e.bind(this.fire,this);this._getRequiredData(n).then(function(e){a("dataBind",e)}),n.unbind(this),n.on({type:"team",eventName:"afterSave",listener:this},function(t){e.isEmpty(t.data.changes)||a("refresh")})},_getRequiredData:function(i){var a=t.Deferred(),r={colors:n},s=[this._getTeams.bind(this,i),this._getProcesses.bind(this,i),this._getPrograms.bind(this,i)];return e.parallel(s,function(e,t){var i=t[0],n=t[1],s=t[2];r.teams=i,r.processes=n,r.programs=s,a.resolve(r)}),a},_getTeams:function(t,i){t.get("teams",{fields:["id","name","icon"]}).done(function(t){var n=e.sortBy(t[0].data,r);e.each(n,function(e){e.tooltip=""}),i(!1,n)})},_getProcesses:function(t,i){t.get("process",{fields:["id","name","isDefault"]}).done(function(t){var n=e.sortBy(t[0].data,r);i(!1,n)})},_getPrograms:function(t,i){var n=a.termProcessor.getTerm("Program","name"),s={id:-1,name:"No "+n};t.get("program",{fields:["id","name"]}).done(function(t){var n=e.sortBy(t[0].data,r);n.unshift(s),i(!1,n)}.bind(this))}})}),define("tau/models/project.formAdd/model.project.formAdd.add",["Underscore","tau/core/extension.base","tau/libs/inviter/inviter"],function(e,t,i){return t.extend({"bus configurator.ready:last + form.submitted":function(t,n,a){var r=this,s=n.getStore(),o={name:e.trim(a.name),color:e.trim(e.asString(a.color))||null,process:{id:a.process},teamProjects:[]};a.program&&"-1"!=a.program&&(o.program={id:a.program}),e.forEach(a.connected,function(e){o.teamProjects.push({team:{id:e}})}),s.save("project",{failureGlobal:!1,fields:["id","name","color","teamProjects"],$set:o},{success:function(e){r.fire("entity.saved",e.data)},failure:function(e){r.fire("entity.add.failure",e.data.response.Message)}}).done();var l=new i(n);l.invite(a.members).done(function(e){r.fire("members.saved",e)})},"bus configurator.ready:last + entity.saved + members.saved":function(t,i,n,a){var r=this,s=i.getStore(),o=e.compact(e.pluck(a,"success")),l=e.compact(e.pluck(a,"failure"));
if(l.length){var u="Can't assign users.";this.fire("entity.add.nonFatalFailure",u)}o=e.filter(o,function(e){return e!=i.getLoggedUser().id});var c={projectMembers:e.map(o,function(e){return{user:{id:e}}})};s.save("project",{id:n.id,$set:c,fields:["id","name","color",{projectMembers:[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}]}]}).done(function(e){r.fire("members.connected",e[0].data)})},"bus entity.saved + members.saved + members.connected":function(e,t,i,n){this.fire("entity.add.success",n)}})}),define("tau/ui/extensions/project.formAdd/ui.extension.project.formAdd",["Underscore","jQuery","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.abstract"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){var i=t.element;this.fire("$el.ready",i)},"bus $el.ready":function(e,t){var i=this,n=this._initForm(t);this._addSubmitDataListener(n,function(e){i.fire("form.submitted",e)});var a=n.find("[name=color]"),r=this._initRichSelect(n,a);r.on("change",function(e,t){r.css("background-color",t)})},"bus configurator.ready:last + $el.ready:last + entity.add.success":function(e,t,i){i.find("form").trigger("entity.add.completed").trigger("reset"),this.fire("entity.add.completed")},"bus $el.ready:last + entity.add.failure":function(e,t,i){t.find("form").trigger("entity.add.failed"),t.find(".i-role-form :text:first").focus().select().addClass("tau-error"),this.fire("error",i)},"bus $el.ready:last + entity.add.nonFatalFailure":function(e,t,i){this.fire("error",i)},"bus $el.ready:last + show.completed":function(e,t){var i=t.find("form");i.trigger("reset"),setTimeout(function(){i.find(":submit:first").focus(),i.find(":text:first").focus()},10)}})}),define("tau/ui/extensions/project.formAdd/ui.extension.project.formAdd.inviter",["Underscore","jQuery","tau/ui/extensions/inviter/ui.extension.inviter.widget.abstract"],function(e,t,i){return i.extend({"bus configurator.ready":function(e,t){this._initTemplates(t)},"bus configurator.ready + $el.ready":function(e,t,i){this._initWidget(t,i)
}})}),define("tau/ui/templates/project.formAdd/ui.template.project.formAdd",["tau/core/templates-factory","tau/ui/templates/board.context.selector/ui.template.board.context.selector.teams.list"],function(e){var t={name:"project.addForm",engine:"jqote2",markup:['<div class="tau-managed-category tau-teams">','<form class="i-role-form">','<div class="tau-new-entity-form">','<div class="tau-new-entity-form__row">','<div class="tau-note"><b>New project</b></div>','<div class="tau-new-entity-info">','<span class="tau-select-team-icon tau-extension-board-tooltip" data-title="Select a project color">','<i class="tau-icon tau-icon_type_color tau-icon_name_default i-role-currenticon" data-value="default"></i>',"</span>",'<input name="name" type="text" placeholder="Enter project name here"  class="tau-in-text tau-new-entity-name">','<select name="color" style="display:none;">','<option value=""></option>',"<% _.each(this.colors, function(item){ %>",'<option value="<%= item %>"><%= item %></option>',"<% }); %>","</select>","</div>",'<ul class="tau-teams-icon-list i-role-richselect">','<li><i class="tau-icon tau-i-close i-role-option" data-value=""></i></li>',"<% _.each(this.colors, function(item){ %>",'<li><i class="tau-icon tau-icon_type_color i-role-option" style="background-color:<%= item %>;" data-value="<%= item %>"></i></li>',"<% }); %>","</ul>","</div>",'<div class="tau-new-entity-form__row tau-new-entity-process">','<div class="tau-note">',"Select process",'<span class="tau-help i-role-tooltipArticle" data-article-id="project.formAdd.selectProcess"></span>',"</div>",'<select class="tau-select" name="process">',"<% _.each(this.processes, function(item) { %>",'<option <% if (item.isDefault){ %>selected<% } %> value="<%= item.id %>"><%! item.name %></option>',"<% }); %>","</select>","</div>",'<div class="tau-new-entity-form__row tau-new-entity-program">','<div class="tau-note">',"Select program",'<span class="tau-help i-role-tooltipArticle" data-article-id="project.formAdd.selectProgram"></span>',"</div>",'<select class="tau-select" name="program">',"<% _.each(this.programs, function(program) { %>",'<option <% if (program.isDefault) { %>selected<% } %> value="<%= program.id %>"><%! program.name %></option>',"<% }); %>","</select>","</div>",'<div class="tau-new-entity-form__row tau-invite-widget">','<div class="tau-note">Assign people','<span class="tau-help i-role-tooltipArticle" data-article-id="project.formAdd.assignPeople"></span>',"</div>",'<textarea name="users" placeholder="Start typing name(s) or email(s) to assign people to a project" />',"</div>","<% if (this.teams.length) { %>",'<div class="tau-new-entity-form__row">','<div class="tau-note">Assign teams','<span class="tau-help i-role-tooltipArticle" data-article-id="project.formAdd.assignTeams"></span>',"</div>",'<ul class="tau-category-items-selector i-role-list">','<%= fn.sub("board.context.selector.teams.list", this.teams) %>',"</ul>","</div>","<% } %>",'<div class="tau-new-entity-form__row">','<button class="tau-btn tau-success" type="submit">Create project</button>','<button class="tau-btn" type="reset">Cancel</button>',"</div>","</div>","</form>","</div>"]};
return e.register(t)}),define("tau/components/component.project.formAdd",["tau/components/component.creator","tau/models/project.formAdd/model.project.formAdd.data","tau/models/project.formAdd/model.project.formAdd.add","tau/ui/extensions/project.formAdd/ui.extension.project.formAdd","tau/ui/extensions/project.formAdd/ui.extension.project.formAdd.inviter","tau/components/extensions/error/extension.errorBar","tau/ui/templates/project.formAdd/ui.template.project.formAdd"],function(e,t,i,n,a,r,s){return{create:function(o){var l={extensions:[t,i,n,a,r],template:s};return e.create(l,o)}}}),define("tau/models/model.project.progressBar",["Underscore","tau/core/model-base"],function(e,t){return t.extend({name:"Project Progress Bar",onInit:function(){var e=this.config.context.entity,t=e.entityType.name,i=e.id,n=["progress"];this.store.unbind(this);var a={id:i,fields:n};this.store.get(t,a).done({success:function(e){this.fire("dataBind",{percentCompleted:Math.round(100*e[0].data.progress)})}.bind(this)})}})}),define("tau/components/component.project.progressBar",["tau/components/component.creator","tau/models/model.project.progressBar","template!tau/ui/templates/progressBar/ui.template.portfolioItem.progressBar"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/models/model.property.text",["tau/models/model.property.simple"],function(e){return e.extend({})}),define("tau/models/model.property.text.editable",["tau/core/model.editable.base"],function(e){return e.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable})}})}),define("tau/models/model.property.text.validation",["tau/core/model-base","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",name:"Model text validation",schema:t.Schema.create({type:"string",optional:!1,empty:!1,maxLength:50,minLength:0,pre:["trim"]}),"bus afterRender":function(e){this.$element=e.data.element},"bus validate":function(e){this._getProperty().editableText("resetValidationErrors");
var t=e.data,i=t.cmd.$set[this.config.propertyName];t.validation=this.schema.validate(i),t.validation&&1==t.validation.isError()||(t.validation=this.schema.validate(i),t.cmd.$set[this.config.propertyName]=t.validation.instance)},"bus afterValidate":function(e){var t=e.data.validation;this._getProperty().editableText("setValue",t.instance)},"bus validationFailed":function(e){var t=e.data.validation;this._getProperty().editableText("setValidationErrors",t.errors[0].description)},_getProperty:function(){return this.$element.find(".property-text")}});return i}),define("tau/models/model.property.abbreviation.validation",["tau/models/model.property.text.validation","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",schema:t.Schema.create({type:"string",optional:!0,empty:!0,maxLength:3,pre:["trim"],post:[function(e){return(e+"").toUpperCase()},function(e){var t=/^[\d-a-z]{1,3}$/i;return e.match(t)||new this.Error("Abbr","Should contain letters or digits"),e}]}),"bus beforeInit":function(e,t){t.config.required?(this.schema.empty=!1,this.schema.optional=!1):(this.schema.empty=!0,this.schema.optional=!0)}});return i}),define("tau/components/extensions/property/extension.property.text.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var t=this,i=this.permissions=e.permissionsReady.data;if(i.editable){var n=this.config,a=this.$el=e.afterRender.data.element,r=a.hasClass("property-text")?a:a.find(".property-text");t.$widget=r,r.editableText({restoreText:n.restoreText?!0:!1,mask:(n||{}).mask,onSave:function(e){var i={};i[t.config.propertyName]=e;var n={$set:i};n.$include=[t.config.propertyName],t.bus.fire("save",n)}})}},"bus edit":function(){this.permissions.editable&&this.$el.find(".property-text").editableText("activate")}})}),define("tau/ui/templates/property/ui.template.property.resetable",["tau/core/templates-factory"],function(e){var t={name:"property-resetable",engine:"jqote2",markup:['<% var title = this.target.actionReset.label || "reset"; %>','<% var offsetStyle = this.suppressOffsetCrossbar ? "" : "tau-clear-filter_margin_left";%>','<span class="i-role-reset tau-clear-filter <%! offsetStyle %>" title="<%! title %>"></span>']};
return e.register(t)}),define("tau/ui/templates/property/ui.template.property",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.full","tau/ui/templates/property/ui.template.property.resetable"],function(e){var t={name:"property",engine:"jqote2",markup:["<div>",'<% var className = (this.name ? ("tau-property-" + this.name) : "") + " " + (this.text ? "" : "tau-property_empty_true"); %>','<span class="property tau-property <%= className %>">','<span class="property-text tau-property__value tau-property__value_margin_right" data-placeholder="<%! this.placeholderText %>">',"<% if (this.hasUrl) { %>",'<%= fn.sub("entity-link-full", this) %>',"<% } else { %>","<%! this.text %>","<% } %>","</span>","<% if (this.actionReset && this.actionReset.enable) { %>",'<%= fn.sub("property-resetable", {target: this}) %>',"<% } %>","</span>","<% if (this.subtext) { %>",'<div class="tau-property__subtext"><%! this.subtext %></div>',"<% } %>","</div>"]};return e.register(t)}),define("tau/components/component.property.abbreviation",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.abbreviation.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(e,t,i,n,a,r,s,o){return{create:function(e){e.propertyName="abbreviation";var l={ModelType:i,extensions:[n,a,r,s],template:o};return t.create(l,e)}}}),define("tau/models/model.property",["Underscore","tau/core/model.editable.base"],function(e,t){return t.extend({init:function(e){if(this._super(e),!e.propertyName)throw new Error("PropertyName was not configured");this.propertyName=e.propertyName,this.displayField=e.displayField||"name",this.valueField=e.valueField||"id",this.listenedEntities={}},isPropertyChanged:function(t,i){var n=i.changes,a=i.cmd&&i.cmd.config.$set||{},r=i.cmd&&i.cmd.config.id;
return e.any(t,function(e){return n&&n.hasOwnProperty(e)||r&&a.hasOwnProperty(e)})},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},buildRequest:function(e){return this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",e]})},getPropertyData:function(e){this.buildRequest(e).done(this.safeCallback(this.onEntityRetrieved))},getPropertyFields:function(){return[this.displayField,this.valueField]},onInit:function(){this._super.apply(this,arguments);var e={};e[this.propertyName]=this.getPropertyFields(),this.listenOfPropertyChanged(),this.getPropertyData(e)},listenOfPropertyChanged:function(){var e=this.config.context.entity.id;this.listenedEntities[e]||(this.listenedEntities[e]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onProcessProperty:function(e){if(!this.config)return null;var t={id:e[this.valueField],name:this.propertyName.toLowerCase(),text:e[this.displayField],isEditable:this.config.editable};return t.actionReset={enable:null!==t.id&&void 0!==t.id&&this.config.allowReset,label:this.config.editorComponentConfig&&this.config.editorComponentConfig.clearValueLabel},this.config.showUrl&&e.id&&(t.hasUrl=!0,t.__type=e.__type,t.id=e.id,t.url=this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0)),t.placeholderText=this.config.placeholderText,t.value=t.text,t},processProperty:function(e){var t=this.onProcessProperty(e);this.fire("dataBind",t)},onEntityRetrieved:function(e){this.config&&(this.property=e[0].data[this.propertyName]||{},this.processProperty(this.property))},entityBelongCurrentContext:function(e){return e.changes.hasOwnProperty(this.config.propertyName)&&e.cmd.config.id==this.config.context.entity.id},onEntityAfterSave:function(e){var t=e.data;this.entityBelongCurrentContext(t)&&this.fire("changed",t)},onEntityBeforeSave:function(e){var t=e.data;this.entityBelongCurrentContext(t)&&this.fire("beforeChanged",t)
}})}),define("tau/components/extensions/property/extension.property.editable",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(t){var i=this,n=this.element=t.afterRender.data.element;t.afterRender.data.element.find(".external-view").click(function(e){e.stopPropagation()});var a=this.permissions=t.permissionsReady.data;if(a.editable!==!1){n.find(".tau-property").addClass("tau-property_editable_true"),n.addClass("tau-editable");var r=t.dataBind.data;if(r.text&&r.text.length||n.find(".property").addClass("editable"),a.editable){this.config.targetElementSelector=this.config.targetElementSelector||".property-text";var s=this.config.targetElementSelector||"",o=this.config.alignElementSelector||"",l={components:[e.extend({data:r},this.config.editorComponentConfig)],context:i.config.context},u={target:n.is(s)?n:n.find(s),alignTo:n.is(o)?n:n.find(o),componentsConfig:l,applyBubbleClasses:this.config.applyBubbleClasses,onPositionConfig:this.config.onPositionConfig||$.noop,className:this.config.bubbleClassName,onShow:e.bind(function(){this.config.context.configurator.getKeyBoardManager().pushHandler({})},this),onHide:e.bind(function(){this.config.context.configurator.getKeyBoardManager().popHandler()},this)};this.fire("initBubble",u),n.on("click",".i-role-reset",e.bind(function(){return this.fire("reset.apply"),!1},this))}}},"bus edit":function(){this.permissions.editable&&this.fire("toggleBubble")}})}),define("tau/components/component.property",["Underscore","tau/components/component.creator","tau/core/termProcessor","tau/models/model.property","tau/models/model.property.editable","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){var d,p=function(){return d||(d=new i(c.context.getTerms()))
},f=c.editorComponentConfig||{};f.resetDisabled=c.resetDisabled,f.showEmptyDataMessage&&(f.emptyDataMessage="No "+p().getTerms(c.propertyName).names.toLowerCase()+" found"),f.showClearValue&&(c.clearValueLabel="reset "+p().getTerms(c.propertyName).name.toLowerCase()),c.placeholderText=c.placeholderText||"click to edit";var m={ModelType:c.Model||n,template:c.template||u,extensions:e.concat([c.extensions,o,l,a,s,r])};return t.create(m,c)}}}),define("tau/models/model.property.assignable",["Underscore","tau/models/model.property"],function(e,t){return t.extend({onInit:function(e){this._super(e),this.store.unbind(this),this.store.on({type:this.getEntityTypeName(),eventName:"beforeSave",listener:this,filter:{id:this.getEntityId()},hasChanges:[this.propertyName]},function(e){this.store.evictProperties(this.getEntityId(),this.getEntityTypeName(),[this.config.refField]),this.fire("beforeChanged",e.data)}.bind(this)),this.store.on({type:this.getEntityTypeName(),eventName:"afterSave",listener:this,filter:{id:this.getEntityId()},hasChanges:[this.propertyName]},function(e){this.fire("propertyChanged",e.data)}.bind(this))},getPropertyData:function(){this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.config.refField]},{success:this.safeCallback(this._processRefField)}).done()},_processRefField:function(t){var i=t.data[this.config.refField];return i&&0!==i.length?void this.store.get("assignable",{id:i[0],fields:[this.displayField,this.valueField]},{success:this.safeCallback(e.compose(this.processProperty,e.property("data")))}).done():void this.processProperty({})}})}),define("tau/components/component.property.assignable",["tau/components/component.property","tau/models/model.property.assignable"],function(e,t){return{create:function(i){return i.propertyName="assignable",i.refField="$ref:assignable[id]",i.showUrl=!0,i.Model=t,i.alignElementSelector=".property-text",i.showEmptyDataMessage=!0,i.applyBubbleClasses=!1,i.editorComponentConfig={type:"finder.entity",propertyName:"assignable"},i.onPositionConfig=function(e){return e.collision="flipfit flipfit",e.at="left middle",e.my="right middle",e
},i.allowReset=!0,e.create(i)}}}),define("tau/models/model.property.bool",["tau/core/model-base"],function(e){return e.extend({init:function(e){if(this._super.apply(this,arguments),!e.propertyName)throw"PropertyName was not configured";this.propertyName=e.propertyName},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},onInit:function(){this.store.unbind(this),this.attachToChangePropertiesOfCurrentEntity(this.propertyName),this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.propertyName]}).done({success:this.onEntityRetrieved,scope:this})},onEntityRetrieved:function(e){if(this.config){var t=e[0].data,i={value:t[this.propertyName]},n=this.config.label;n&&(i.label=n),this.fire("dataBind",i)}}})}),define("tau/components/extensions/property/extension.property.bool.editable",["Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle"],function(e,t){return t.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(e){{var t=this,i=this.element=e.afterRender.data.element,n=this.permissions=e.permissionsReady.data;e.dataBind.data}if(n.editable){var a=i.find(".property .ui-checkbox");a.checkboxToggle({classNames:{checked:"checked",unchecked:"unchecked"},onSave:function(e){t.fire("elementUpdated");var i={};i[t.config.propertyName]=e,t.fire("save",i)}})}},"bus edit":function(){this.permissions.editable&&this.element.find(".property .ui-checkbox").checkboxToggle("toggle")}})}),define("tau/ui/templates/property/ui.template.property.bool",["tau/core/templates-factory"],function(e){var t={name:"property-bool",markup:["<div>",'<span class="property"><div class="ui-checkbox {{if value}}checked{{/if}}{{if !value}}unchecked{{/if}}">&nbsp;</div></span>','{{if label}}<span class="tau-label">${label}</span>{{/if}}',"</div>"].join("")};return e.register(t)}),define("tau/components/component.property.bool",["Underscore","tau/components/component.creator","tau/models/model.property.bool","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/property/extension.property.bool.editable","tau/ui/templates/property/ui.template.property.bool"],function(e,t,i,n,a,r,s){return{create:function(o){var l=e.concat([o.extensions,a]);
o.editable===!0&&(l=e.concat([l,r,n]));var u={ModelType:i,template:o.template||s,extensions:l};return t.create(u,o)}}}),define("tau/components/component.property.build",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="build",t.showUrl=!0,t.alignElementSelector=".property-text",t.showEmptyDataMessage=!0,t.applyBubbleClasses=!1,t.allowReset=!0,t.editorComponentConfig={type:"finder.entity",propertyName:"build"},t.onPositionConfig=function(e){return e.collision="flipfit flipfit",e.at="left middle",e.my="right middle",e},e.create(t)}}}),define("tau/components/extensions/property/extension.property.build.refresher",["Underscore","tau/core/model-base"],function(e,t){return t.extend({category:"refresher","bus afterInit":function(){var e=this.store,t=this.config.context.entity,i=this;this.store.unbind(this),e.on({eventName:"afterSave",type:"testplanrun",listener:this,filter:{id:t.id}},function(e){var t=e.data.changes;(t.hasOwnProperty("release")||t.hasOwnProperty("iteration"))&&i.bus.fire("refresh")})}})}),define("tau/models/finder.entity/model.finder.entity.data.build.testPlanRun",["Underscore","tau/models/finder.entity/model.finder.entity.data"],function(e,t){return t.extend({buildInitialParameters:function(t,i){var n=$.Deferred(),a=t.context.entity,r=e.bind(this._super,this);return i.getStore().get("testPlanRun",{id:a.id,fields:["id",{project:["id",{process:["id",{practices:["id","name"]}]}]},{release:["id"]},{iteration:["id"]}]}).done({success:e.bind(function(a){var s=a[0].data||{};e.defaults(s.project,{process:{practices:[]}});var o=s.project.process.practices,l=e.any(o,function(e){return"iterations"==e.name.toLowerCase()}),u=[];s.project&&u.push("project.id == "+s.project.id),s.release&&u.push("release.id == "+s.release.id),s.iteration&&1==l&&u.push("iteration.id == "+s.iteration.id),u="("+u.join(" and ")+")",t.filter.init_dsl=t.filter.init_dsl?t.filter.init_dsl+" and "+u:u,r(t,i).then(function(e){n.resolve(e)})},this)}),n
}})}),define("tau/components/component.property.build.testPlanRun",["tau/components/component.property","tau/components/extensions/property/extension.property.build.refresher","tau/models/finder.entity/model.finder.entity.data.build.testPlanRun"],function(e,t,i){return{create:function(n){return n.propertyName="build",n.showUrl=!0,n.alignElementSelector=".property-text",n.showEmptyDataMessage=!0,n.extensions=[t],n.allowReset=!0,n.editorComponentConfig={type:"finder.entity",propertyName:"build",model:i},e.create(n)}}}),define("tau/ui/templates/property/ui.template.property.date",["tau/core/templates-factory","tau/ui/templates/property/ui.template.property.resetable"],function(e){var t={name:"property-date",engine:"jqote2",markup:["<div>",'<div class="property" style="display:inline">','<span class="property-text"><%!this.text%></span>',"</div>","<% if (this.actionReset && this.actionReset.enable && this.text && this.text.length !== 0) { %>",'<%= fn.sub("property-resetable", {target: this, suppressOffsetCrossbar: true}) %>',"<% } %>","</div>"]};return e.register(t)}),define("tau/components/component.property.date",["require","Underscore","tau/components/component.creator","tau/models/model.property.date","tau/models/model.property.date.validation","tau/models/model.property.date.editable","tau/components/extensions/property/extension.property.date.editable","tau/components/extensions/property/extension.property.resettable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property.date"],function(e){var t=e("Underscore"),i=e("tau/components/component.creator"),n=e("tau/models/model.property.date"),a=e("tau/models/model.property.date.validation"),r=e("tau/models/model.property.date.editable"),s=e("tau/components/extensions/property/extension.property.date.editable"),o=e("tau/components/extensions/property/extension.property.resettable"),l=e("tau/components/extensions/property/extension.property.refresher"),u=e("tau/ui/templates/property/ui.template.property.date");
return{create:function(e){e=t.extend(t.clone(e)),e.validationExtension=e.validationExtension||a;var c={ModelType:n,template:e.template||u,extensions:t.concat([e.extensions,l,r,s,o,e.validationExtension])};return i.create(c,e)}}}),define("tau/components/component.property.buildDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.propertyName="buildDate",t.format="datetime",e.create(t)}}}),define("tau/models/property.simple/model.property.simple",["tau/core/model-base"],function(e){return e.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator,n=t.config.context.entity,a=t.config.editorComponentConfig.name;this.attachToChangePropertiesOfCurrentEntity(a);var r=this;i.getStore().get(n.entityType.name,{id:n.id,fields:[a]}).done({success:function(e){var t=e[0].data;r.fire("dataBind",{name:a,value:t[a],output:t[a]})}})}})}),define("tau/ui/templates/property/ui.template.property.color",[],function(){return{name:"property.color",engine:"jqote2",markup:["<div>",'<span class="property tau-property tau-property-<%! this.name %> <% if (!this.value) { %> tau-property_empty_true<% } %>">','<span class="property-text tau-property__value i-role-output" data-placeholder="<%! this.placeholderText || "click to edit" %>">',"<% if (this.value) { %>",'<i class="tau-icon tau-icon_type_color" style="background-color: <%= this.value %>;"></i>',"<% } %>","</span>","</span>","</div>"]}}),define("tau/components/component.property.color",["tau/components/component.creator","tau/models/property.simple/model.property.simple","tau/models/model.property.editable","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property.color"],function(e,t,i,n,a,r,s,o){return{create:function(l){l=l||{},l.editable=!0,l.bubbleClassName="tau-bubble-color",l.applyBubbleClasses=!1,l.editorComponentConfig={type:"choice",listType:"static",name:"color",showClearValue:!0,clearValueLabel:"reset",showReset:!1,values:[{id:null,name:'<i  class="tau-icon tau-i-close"></i>',asHtml:!0}].concat(_.map(l.values,function(e){return{id:e,name:e?'<i class="tau-icon tau-icon_type_color" style="background-color:'+e+';"></i>':"",asHtml:!0}
})||[])};var u={extensions:[t,i,n,a,r,s].concat(l.extensions||[]),template:o};return e.create(u,l)}}}),define("tau/components/component.property.company",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="company",t.showUrl=!1,t.alignElementSelector=".property-text",t.editorComponentConfig={type:"choice",listType:"company",maxHeight:200,filter:!1,expandable:!1,showEmptyDataMessage:!1,clearValueLabel:"no company",defaultValueLabel:"current",fullModeLabel:"show old",emptyDataMessage:"No company found",showReset:!0},t.allowReset=!0,e.create(t)}}}),define("tau/components/component.property.completeDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=_.clone(t||{}),t.propertyName="endDate",e.create(t)}}}),define("tau/components/component.property.createDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.propertyName="createDate",e.create(t)}}}),define("tau/models/model.property.effort",["tau/core/model-base"],function(e){var t=e.extend({onInit:function(){var e=this,t=e.config.context,i=t.entity.entityType.name,n=t.entity.id;e.store.unbind(e),e.store.on(e.getSubscriptionConfig("afterSave"),_.bind(e.onEntityAfterSave,e)),e.store.on(e.getSubscriptionConfig("beforeSave"),_.bind(e.onEntityBeforeSave,e)),e.store.get(i,{id:n,fields:["id","effort",{roleEfforts:["id",{role:["id","hasEffort"]}]}]}).done({scope:e,success:e.done})},done:function(e){var t=this,i=e[0].data,n=t.config.context,a=n.entity.entityType.name,r={id:i.id,effort:Math.round(100*i.effort)/100,unit:n.getEffortPoint(a),roleEfforts:i.roleEfforts};t.fire("dataBind",r)},getSubscriptionConfig:function(e){var t=this,i=t.config.context.entity;return{eventName:e,type:"roleEffort",listener:t,filter:{assignable:{id:i.id}},hasChanges:["effort"]}},onEntityAfterSave:function(){this.fire("propertyChanged")},onEntityBeforeSave:function(){this.fire("beforeChangeProperty")}});return t}),define("tau/models/model.property.effort.editable",["tau/core/model.editable.base","Underscore"],function(e){var t=e.extend({name:"Effort Editable","bus beforeInit+dataBind":function(){var e={editable:!0};
this.fire("permissionsReady",e)}});return t}),define("tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly.effortsList",["tau/core/templates-factory"],function(e){var t={name:"ui.template.assignments.effortsOnly.effortsList",markup:["{{if roleEffort}}",'<tr class="tau-row group" roleId="${role.id}">',"   <td><span>${role.name}</span></td>",'   <td class="tau-cell-role-effort-value role-effort"><div class="effort">${roleEffort.effort}<span class="point">${$item.effortPoints}</span></div></td>',"</tr>","{{/if}}"].join(""),dependencies:[]};return e.register(t)}),define("tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly.effortsList"],function(e){var t={name:"ui.template.assignments.effortsOnly",markup:['<table class="assignments-table-readonly tau-assignments-effort-only">','   <tr class="tau-header-row tau-row-delimiter">','       <td class="tau-header-cell-title"></td>','       <td class="tau-header-cell-value">Effort</td>',"    </tr>",'   {{tmpl(assignments.groups, {effortPoints: effortPoints}) "ui.template.assignments.effortsOnly.effortsList"}}',"{{if tasksEffort}}",'   <tr class="tau-footer-row tau-row-delimiter">',"       <td>Tasks</td>","       <td>${tasksEffort.effort} h</td>","   </tr>","{{/if}}",'   <tr class="tau-footer-row tau-footer-row-total">',"       <td>Total</td>","       <td><span>${totalEffort.effort} ${effortPoints}</span></td>","   </tr>","</table>"].join(""),dependencies:["ui.template.assignments.effortsOnly.effortsList"]};return e.register(t)}),define("tau/ui/extensions/effort/extension.effort.editable",["tau/components/extensions/component.extension.base","tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t){return e.extend({category:"edit",normalizeEffort:function(e){return Math.abs(Math.round(100*parseFloat(e))/100)||0},"bus afterRender+beforeChangeProperty":function(e){var t=e.afterRender.data.element;
this.fire("markElementToBeUpdated",{element:t})},"bus propertyChanged":function(){this.fire("refresh")},"bus refresh+afterRender":function(e){var t=e.afterRender.data.element;this.fire("updateElement",{element:t})},hasEffortIterator:function(e){return e.role.hasEffort},"bus permissionsReady+dataBind+afterRender":function(e){var i=this,n=e.permissionsReady.data,a=e.dataBind.data;if(n.editable){var r=_(a.roleEfforts).chain().select(i.hasEffortIterator).size().value();n.editMode="disabled",r&&(n.editMode=1===r&&0==i.config.entitiesCount?"inline":"roleEfforts");var s=e.afterRender.data.element,o=s.find(".entity-effort");if("inline"===n.editMode)o.editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(e){var t=i.normalizeEffort(e),n=_(a.roleEfforts).detect(i.hasEffortIterator),r={typeName:"roleEffort",id:n.id,$set:{effort:t}};i.bus.fire("save",r)},onEditStart:function(){i._$additionalInfo=o.find(".entity-effort-info").detach()},onEditEnd:function(){i._$additionalInfo.appendTo(o)}});else if("roleEfforts"===n.editMode){var l={components:[{type:"assignmentsList",template:t}],context:i.config.context},u={target:o,componentsConfig:l};i.fire("initBubble",u)}}}})}),define("tau/ui/templates/property.effort/ui.template.property.effort",["tau/core/templates-factory","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(e){var t={name:"ui.template.property.effort",markup:['<div class="tau-property">{{tmpl($item.data) "ui.template.property.effort.content"}}</div>'],dependencies:["ui.template.property.effort.content"]};return e.register(t)}),define("tau/components/component.property.effort",["tau/components/component.creator","tau/models/model.property.effort","tau/models/model.property.effort.editable","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/effort/extension.effort.editable","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property.effort/ui.template.property.effort"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={extensions:[t,i,r,n,a,s],template:o};
return e.create(u,l)}}}),define("tau/models/model.property.email.validation",["tau/models/model.property.text.validation","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",schema:t.Schema.create({type:"string",optional:!0,empty:!0,pre:["trim"],post:[function(e){var t=/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/;return e.match(t)||new this.Error("Email","Provide a valid email address"),e}]})});return i}),define("tau/components/component.property.email",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.email.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(e,t,i,n,a,r,s,o){return{create:function(e){e.propertyName="mailReplyAddress";var l={ModelType:i,extensions:[n,a,r,s],template:o};return t.create(l,e)}}}),define("tau/ui/templates/property/ui.template.property.endDate.list",["tau/core/templates-factory"],function(e){var t={name:"property-endDate-list",markup:['<span><span class="tau-extension-tooltip" title="Completion date: ${text}">',"${text}","</span>","</span>"].join("")};return e.register(t)}),define("tau/components/component.property.endDate.list",["tau/components/component.property.date","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property/ui.template.property.endDate.list"],function(e,t,i){return{create:function(n){return n=n||{},n.propertyName="endDate",n.template=i,n.extensions=[t],e.create(n)}}}),define("tau/models/model.property.date.validation.portfolio",["Underscore","tau/core/model-base","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(e,t,i,n){var a=t.extend({category:"edit",name:"Model date validation","bus afterInit":function(){this.schema=i.Schema.create({type:"string",optional:!0,empty:!0,pre:["trim"],post:function(e){if(this.wasError())return e;
var t=function(e,t){return new this.Error(e,t)}.bind(this),i=n.parse(e),a=n.parse(this.schema.additionalProperties.max),r=n.parse(this.schema.additionalProperties.min);return null==i?t("Date","Incorrect date format"):i<new Date(1900,0,1)?t("Date","Date must be greater than 1-Jan-1900"):a&&i>a?t("Date","Start Date should be earlier than End Date"):r&&r>i?t("Date","End Date should be later than Start Date"):e=n.format.date.short(i),e},additionalProperties:{dateFormat:n.getFormatData().date.short,max:null,min:null}});var e=this.config.context.entity;this.store.get(this.config.context.entity.entityType.name,{id:e.id,fields:["startDate","endDate"]}).done({success:this.safeCallback(this._processDateFromStore)}),"startDate"==this.config.propertyName?this.store.on({eventName:"afterSave",type:this.config.context.entity.entityType.name,listener:this,filter:{id:e.id},hasChanges:["endDate"]},function(e){this._setMaxDate(e.data.changes.endDate)}.bind(this)):"endDate"==this.config.propertyName&&this.store.on({eventName:"afterSave",type:this.config.context.entity.entityType.name,listener:this,filter:{id:e.id},hasChanges:["startDate"]},function(e){this._setMinDate(e.data.changes.startDate)}.bind(this))},_processDateFromStore:function(e){var t=e[0].data;"startDate"==this.config.propertyName?this._setMaxDate(t.endDate):"endDate"==this.config.propertyName&&this._setMinDate(t.startDate)},_setMinDate:function(e){this._setDateRestriction("min",e)},_setMaxDate:function(e){this._setDateRestriction("max",e)},_setDateRestriction:function(e,t){this.schema.additionalProperties[e]=n.parse(t)},"bus afterRender":function(e){this.element=e.data.element},"bus validateDate":function(e){var t=this.schema.validate(e.data.value||"");e.data.value=t.instance},"bus validate":function(e){var t=this.element.find(".property");t.dateEditor("resetValidationErrors");var i=e.data;if(!i.validation||!i.validation.isError()){var n=i.cmd.$set[this.config.propertyName];i.validation=this.schema.validate(n),i.cmd.$set[this.config.propertyName]=i.validation.instance||null
}},"bus resetValidationErrors":function(){this._getProperty().dateEditor("resetValidationErrors")},"bus afterValidate":function(e){var t=e.data.validation;this._getProperty().dateEditor("setValue",t.instance)},"bus validationFailed":function(e){var t=e.data.validation;this._getProperty().dateEditor("setValidationErrors",t.errors[0].description)},_getProperty:function(){return this.element.find(".property")}});return a}),define("tau/components/component.property.endDate.portfolio",["tau/components/component.property.date","tau/models/model.property.date.validation.portfolio"],function(e,t){return{create:function(i){return i=i||{},i.propertyName="endDate",i.validationExtension=t,i.allowReset=!0,e.create(i)}}}),define("tau/components/component.property.endDate.projectMember",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.editable=!0,t.allowReset=!0,t.propertyName="membershipEndDate",e.create(t)}}}),define("tau/models/model.property.entityState",["tau/core/model-base","Underscore"],function(e,t){var i=function(e){this.model=e};i.prototype={done:function(e){var t=e[0].data.entityState;this.model.fire("dataBind",t)}};var n=e.extend({onInit:function(){var e=this,n=new i(this),a=this.config.context,r=a.entity.entityType.name,s=a.entity.id,o=[{entityState:["id","name","isFinal","isCommentRequired",{nextStates:["id"]}]}];if(!e.config.disableSubscriptions){var l=function(i){var n=i.data.changes,a=i.data.cmd.config.fields;i.data.cmd.config.fields=t.union(a,o),e.fire("beforeChanges",n),e.fire("beforeChangeProperty")},u=function(t){e.fire("applyChanges",t.data.changes),e.fire("propertyChanged")};e.store.unbind(e),e.store.on({eventName:"beforeSave",type:r,hasChanges:["entityState"],listener:this},l),e.store.on({eventName:"afterSave",type:r,hasChanges:["entityState"],listener:this},u)}e.store.get(r,{id:s,fields:o},{success:n.setEntity,scope:n}).done({success:n.done,scope:n})}});return n}),define("tau/models/model.property.entityState.editable",["tau/core/model.editable.base"],function(e){return e.extend({name:"Entity state editable","bus dataBind":function(){this.fire("permissionsReady",{editable:!0})
}})}),define("tau/components/extensions/entityState/extension.entityState.editable",["tau/components/extensions/component.extension.base"],function(e){return e.extend({category:"edit","bus prepareChanges":function(){this.bus.fire("markElementToBeUpdated",{element:this.element})},"bus applyChanges":function(){var e=this;this.bus.on("afterRender",function(t){t.removeListener(),e.bus.fire("updateElement",{element:e.element})}),this.bus.fire("refresh")},"bus ownerChanged":function(){this.fire("refresh")},"bus beforeChangeOwner":function(){this.fire("markElementToBeUpdated",{element:this.element})},"bus permissionsReady+afterRender+dataBind":function(e){var t=this,i=this.element=e.afterRender.data.element,n=e.permissionsReady.data,a=e.dataBind.data;if(a.nextStates.length>0&&n.editable){var r={components:[{type:"choice.entityState",data:a}],context:t.config.context},s={target:i,componentsConfig:r,alignTo:i.find(".attr-name")};this.fire("initBubble",s)}this.bus.on("edit",function(){this.fire("toggleBubble")},this)}})}),define("tau/components/component.property.entityState",["tau/components/component.creator","tau/models/model.property.entityState","tau/models/model.property.entityState.editable","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.attributeValue","tau/components/extensions/entityState/extension.entityState.editable"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={ModelType:t,template:s,extensions:[i,n,a,r,o]};return e.create(u,l)}}}),define("tau/components/component.property.epic",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="epic",t.showUrl=!0,t.alignElementSelector=".property-text",t.showEmptyDataMessage=!0,t.applyBubbleClasses=!1,t.editorComponentConfig={type:"finder.entity",propertyName:"epic"},t.allowReset=!t.resetDisabled,t.onPositionConfig=function(e){return e.collision="flipfit flipfit",e.at="left middle",e.my="right middle",e
},e.create(t)}}}),define("tau/components/extensions/property/extension.property.password.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({category:"edit",init:function(){this._super.apply(this,arguments),this.onBlurProxy=e.bind(this.onBlur,this),this.onKeyDownProxy=e.bind(this.onKeyDown,this)},findPasswordElements:function(e){return e.find(".tau-password,.tau-password-verify")},"bus permissionsReady+afterRender":function(e){if(e.permissionsReady.data.editable){var t=e.afterRender.data.element;this.findPasswordElements(t).blur(this.onBlurProxy),t.find(".tau-password,tau-password-verify").keydown(this.onBlurProxy)}},"bus view.password.ready:last+view.password.confirmation.ready:last":function(e){var t=e["view.password.ready"].data,i=e["view.password.confirmation.ready"].data,n=t.length>0;if(n&&t===i){var a={};a[this.config.propertyName]=t,this.fire("save",a)}},"bus after_save":function(){this.fire("view.clear.passwords")},"bus afterRender:last+view.clear.passwords":function(e){this.findPasswordElements(t(e.afterRender.data.element)).val("")},getEventNameFromTarget:function(e){var i=t(e).hasClass("tau-password-verify");return i?"view.password.confirmation.ready":"view.password.ready"},firePasswordReadyEventDependOnTarget:function(e){var i=t(e).val();this.fire(this.getEventNameFromTarget(e),i)},onBlur:function(e){var t=e.target;this.firePasswordReadyEventDependOnTarget(t)},onKeyDown:function(e){var t=e.target;13==e.keyCode&&this.firePasswordReadyEventDependOnTarget(t)}})}),define("tau/ui/templates/property/ui.template.property.password",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.full"],function(e){var t={name:"property.password",markup:["<div>",'<span class="property tau-property{{if name}} tau-property-${name}{{/if}}{{if !text}} tau-property_empty_true{{/if}}">',"<div>",'<span class="">Password</span>&nbsp;','{{if (passwordHint)}}<span class="">${passwordHint}</span>{{/if}}','<div class="tau-property__value"><input type="password" value="${text}" class="tau-password tau-in-text"/></div>',"</div>","<div>",'<span class="">Confirm Password</span>','<div class="tau-property__value"><input type="password" value="${text}" class="tau-password-verify tau-in-text"/></div>',"</div>","</span>","</div>"].join(""),dependencies:["entity-link-full"]};
return e.register(t)}),define("tau/components/component.property.text",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.text.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.password.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property","tau/ui/templates/property/ui.template.property.password"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(c){var d="password"===c.editorType,p=d?u:l,f=d?s:r,m={ModelType:i,extensions:e.concat([c.extensions,n,a,f,o]),template:c.template||p};return t.create(m,c)}}}),define("tau/components/component.property.failureComment",["Underscore","tau/components/component.property.text"],function(e,t){return{create:function(i){return i=e.clone(i||{}),i.propertyName="comment",i.defaultText="N/A",t.create(i)}}}),define("tau/components/component.property.feature",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="feature",t.showUrl=!0,t.alignElementSelector=".property-text",t.showEmptyDataMessage=!0,t.applyBubbleClasses=!1,t.editorComponentConfig={type:"finder.entity",propertyName:"feature"},t.allowReset=!t.resetDisabled,t.onPositionConfig=function(e){return e.collision="flipfit flipfit",e.at="left middle",e.my="right middle",e},e.create(t)}}}),define("tau/ui/templates/property/ui.template.property.icon",[],function(){return{name:"property.icon",engine:"jqote2",markup:["<div>",'<span class="property tau-property tau-property-<%! this.name %> <% if (!this.value) { %> tau-property_empty_true<% } %>">','<span class="property-text tau-property__value i-role-output" data-placeholder="<%! this.placeholderText || "click to edit" %>">','<% if (this.value) { %><i class="tau-icon tau-icon_type_svg tau-icon_name_<%= this.value %>"></i><% } %>',"</span>","</span>","</div>"]}
}),define("tau/components/component.property.icon",["tau/components/component.creator","tau/models/property.simple/model.property.simple","tau/models/model.property.editable","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property.icon"],function(e,t,i,n,a,r,s,o){return{create:function(l){l=l||{},l.editable=!0,l.bubbleClassName="tau-bubble-icon",l.applyBubbleClasses=!1,l.editorComponentConfig={type:"choice",listType:"static",name:"icon",showClearValue:!0,clearValueLabel:"reset",showReset:!1,values:[{id:null,name:'<i class="tau-icon tau-i-close"></i>',asHtml:!0}].concat(_.map(l.values,function(e){return{id:e,name:'<i class="tau-icon tau-icon_type_svg tau-icon_name_'+e+'"></i>',asHtml:!0}})||[])};var u={extensions:[t,i,n,a,r,s].concat(l.extensions||[]),template:o};return e.create(u,l)}}}),define("tau/components/extensions/impedimentDate/extensions.model.impedimentDate.daysPassedCalculator",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){function i(e,t){var i=e.getTime(),a=t.getTime(),r=Math.abs(i-a);return Math.round(r/n)}var n=864e5,a=t.extend({"bus extendData":function(e){var t=e.data.dataToBind||{},n=e.data.date;t.daysPassed=n?i(this.config.context.configurator.getCurrentDate(),n):null}});return a}),define("tau/components/extensions/impedimentDate/extension.ui.impedimentDate.daysPassed",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({extractDataFromEvent:function(e,t){return(e[t]||{}).data||{}},"bus afterRender+dataBind":function(t){var i=this.extractDataFromEvent(t,"dataBind"),n=e(this.extractDataFromEvent(t,"afterRender").element),a=e(['<span class="ui-days-passed">(<span class="days-count">',i.daysPassed,"</span> days passed)</span>"].join(""));n.find(".property").parent().append(a)
}})}),define("tau/components/component.property.impedimentDate",["Underscore","tau/components/component.property.createDate","tau/components/extensions/impedimentDate/extensions.model.impedimentDate.daysPassedCalculator","tau/components/extensions/impedimentDate/extension.ui.impedimentDate.daysPassed"],function(e,t,i,n){return{create:function(a){return a=a||{},a.extensions=e.concat([a.extensions,i,n]),t.create(a)}}}),define("tau/models/model.property.time",["tau/models/model.property.simple"],function(e){return e.extend({floatToString:function(e){return e.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onEntityRetrieved:function(e){var t=e[0].data[this.propertyName];t||(t=0);var i={text:this.floatToString(t),point:this._getEffortPoints()};this.fire("dataBind",i)}})}),define("tau/models/model.property.time.editable",["tau/core/model.editable.base"],function(e){return e.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/property/extension.property.time.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(e,t,i){return i.extend({category:"edit",normalizeEffort:function(e){return Math.abs(Math.round(100*parseFloat(e))/100)||0},"bus permissionsReady+afterRender+dataBind":function(e){var t=this,i=this.permissions=e.permissionsReady.data;i.editable&&(t.$el=e.afterRender.data.element,t.$el.find(".property-text").editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(i){var n=e.dataBind.data,a=t.normalizeEffort(n.text),r=t.normalizeEffort(i);if(a===r)return this.restoreInitialText(),!1;var s={};s[t.config.propertyName]=r;var o={$include:["id"],id:t.config.context.entity.id,$set:s};t.bus.fire("save",o)},onEditStart:function(){this.$element.data("points",this.$element.find("span").detach())},onEditEnd:function(){this.$element.append(this.$element.data("points"))
}}))},showEditor:function(){this.$el.find(".property-text").editableText("activate")},"bus edit":function(){this.permissions.editable&&this.showEditor()},onClickHandler:function(){},removeHandlers:function(){},removeWidget:function(){this.$widget&&this.$widget.editableText("destroy")},destroy:function(){this.removeHandlers(),this.removeWidget(),this._super.apply(this,arguments)}})}),define("tau/ui/templates/property/ui.template.property.time",["tau/core/templates-factory"],function(e){var t={name:"property-time",markup:["<div>",'   <div class="property"><div class="property-text">${text}<span class="point">${point}</span></div></div>',"</div>"].join("")};return e.register(t)}),define("tau/components/component.property.time",["Underscore","tau/components/component.creator","tau/models/model.property.time","tau/models/model.property.time.editable","tau/components/extensions/property/extension.property.time.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property.time","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t,i,n,a,r,s){return{create:function(e){var o={ModelType:i,template:s,extensions:[a,n,r]};return t.create(o,e)}}}),define("tau/components/component.property.initialEstimate",["Underscore","tau/components/component.property.time"],function(e,t){return{create:function(i){return i=e.clone(i||{}),i.propertyName="initialEstimate",t.create(i)}}}),define("tau/components/component.property.isActive",["tau/components/component.property.bool"],function(e){return{create:function(t){return t=t||{},t.propertyName="isActive",e.create(t)}}}),define("tau/components/component.property.isPrivate",["Underscore","tau/components/component.property.bool"],function(e,t){return{create:function(i){return i=e.clone(i||{}),i.propertyName="isPrivate",i.editable=!0,t.create(i)}}}),define("tau/components/component.property.isProduct",["tau/components/component.property.bool"],function(e){return{create:function(t){return t=t||{},t.propertyName="isProduct",e.create(t)
}}}),define("tau/components/component.property.iteration",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="iteration",t.showUrl=!0,t.alignElementSelector=".property-text",t.allowReset=!0,t.applyBubbleClasses=!1,t.editorComponentConfig={type:"choice",listType:"iteration",maxHeight:200,filter:!0,expandable:!0,showEmptyDataMessage:!0,clearValueLabel:"backlog",defaultValueLabel:"current",fullModeLabel:"show old"},e.create(t)}}}),define("tau/components/component.property.lastFailureComment",["Underscore","tau/components/component.property.text"],function(e,t){return{create:function(i){return i=e.clone(i||{}),i.propertyName="lastFailureComment",i.defaultText="N/A",t.create(i)}}}),define("tau/components/component.property.lastRunDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=_.clone(t||{}),t.propertyName="lastRunDate",t.editable=!1,t.format="datetime",e.create(t)}}}),define("tau/ui/templates/property/ui.template.property.lastRunDate.list",["tau/core/templates-factory"],function(e){var t={name:"property-lastRunDate-list",markup:'<div><div class="property tau-extension-tooltip" title="Run Date: ${text}"><div class="property-text">${text}</div></div>'};return e.register(t)}),define("tau/components/component.property.lastRunDate.list",["tau/components/component.property.date","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property/ui.template.property.lastRunDate.list"],function(e,t,i){return{create:function(n){return n=_.clone(n||{}),n.propertyName="lastRunDate",n.editable=!1,n.format="datetime",n.extensions=[t],n.template=i,e.create(n)}}}),define("tau/ui/templates/property/ui.template.property.status",["tau/core/templates-factory"],function(e){var t={name:"property-last-status",markup:["<div>",'   <div class="ui-status {{if value === true}}ui-status_type_passed green{{/if}}{{if value === false}}ui-status_type_failed red{{/if}}{{if value === null}}ui-status_type_na grey{{/if}}">',"   {{if value === true}}","       Passed","   {{/if}}","   {{if value === false}}","       Failed","   {{/if}}","</div>","</div>"].join("")};
return e.register(t)}),define("tau/components/component.property.lastStatus",["tau/components/component.property.bool","tau/ui/templates/property/ui.template.property.status"],function(e,t){return{create:function(i){return i=i||{},i.propertyName="lastStatus",i.template=t,e.create(i)}}}),define("tau/models/model.property.user",["tau/models/model.property"],function(e){return e.extend({onInit:function(){this.listenOfPropertyChanged();var e=this.config.context.entity,t=e.entityType.name,i={};i[this.config.propertyName]=["id","firstName","lastName","email","avatarUri"],this.store.get(t,{id:e.id,fields:["id",i]}).done({scope:this,success:this.initialDataProcessor}),this.bindStoreListeners()},initialDataProcessor:function(e){var t=this.config;if(t){var i=e[0].data,n=i[t.propertyName];if(n){var a=n.email;(n.firstName||n.lastName)&&(a=_.trim([n.firstName,n.lastName].join(" ")));var r=a;t.hidename&&(a="");var s={id:n.id,avatar:n.avatarUri+"24",name:a,visibleName:r};this.fire("dataBind",s)}}},bindStoreListeners:_.once(function(){this.store.on({eventName:"afterSave",type:"user",hasChanges:["avatarUri"],listener:this},function(e){this.afterUserSaved(e)}.bind(this))}),afterUserSaved:function(e){this.fire("userAvatarChanged",e.data)},"bus dataBind:last + userAvatarChanged":function(e,t,i){t.id===i.id&&this.fire("avatarChanged",i)}})}),define("tau/ui/templates/common/ui.template.owner",["tau/core/templates-factory","tau/ui/templates/common/ui.template.userName"],function(e){return e.register({name:"owner",markup:["<table class='owner' userId='${id}'><tr>","<td class='owner-avatar-container tau-avatar_${id}'>","{{if avatar}}<img  role='avatar' src='${avatar}' alt='${visibleName}' title='${visibleName}' class='owner-avatar {{if !name}} user-name{{/if}}'/>{{/if}}","</td>","<td class='owner-info'>","   {{tmpl 'user-name'}}","</td>","</tr></table>"].join(""),dependencies:["user-name"]})}),define("tau/components/extensions/user/extension.user.editable",["tau/components/extensions/component.extension.base"],function(e){return e.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(e){var t=this,i=this.element=e.afterRender.data.element,n=e.permissionsReady.data,a=e.dataBind.data;
if(n.editable){var r={type:"userList",data:a,extensions:this.getExtensions(),v2:!0};this.extendEditorConfig(r);var s={components:[r],context:t.config.context},o={target:i,componentsConfig:s,alignTo:i.find(".user-name"),onShow:_.bind(function(){this.config.context.configurator.getKeyBoardManager().pushHandler({})},this),onHide:_.bind(function(){this.config.context.configurator.getKeyBoardManager().popHandler()},this)};this.fire("initBubble",o)}this._toggle&&this.bus.removeListener("edit",this._toggle,this),this._toggle=function(){t.fire("toggleBubble")},this.bus.on("edit",this._toggle,this)},extendEditorConfig:function(){},getExtensions:function(){return[]}})}),define("tau/models/assignment/model.property.owner.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(e,t){return t.extend({assignTo:function(e){var t={type:this.config.context.entity.entityType.name,$set:{owner:{id:e}},$include:[{owner:["id","firstName","lastName","email"]}]};this.fire("save",t)}})}),define("tau/models/userList/extension.model.user.Excluder",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}},t=["id","firstName","lastName"],i={};i[this.getUserPropertyName()]=t,this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:[i]},callback:{scope:this,success:this.onEntityRetrieved}})},getUserPropertyName:function(){throw"Use Excluder getUserPropertyName should be ovveriden"},onEntityRetrieved:function(e){var t=e.data||{},i=[t[this.getUserPropertyName()]];this.fire("excludedUserReady",i)}})}),define("tau/models/userList/extension.model.owner.Excluder",["Underscore","tau/models/userList/extension.model.user.Excluder"],function(e,t){return t.extend({getUserPropertyName:function(){return"owner"}})}),define("tau/components/extensions/user/extension.owner.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder"],function(e,t,i){return e.extend({category:"edit",extendEditorConfig:function(e){e.UserExcluder=i
},getExtensions:function(){return[t]}})}),define("tau/components/component.property.owner",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.editable"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={ModelType:t,template:s,extensions:[i,a,r,n,o]};return l=l||{},l.propertyName="owner",e.create(u,l)}}}),define("tau/models/extensions/team/extension.model.allUserRetriever",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus registerStoreRequest":function(){var t=this;this.store.get("user",{fields:["id","firstName","lastName","email","isActive","deleteDate",{role:["id","name"]}]}).done({success:function(i){var n=i[0].data,a={},r=[];n=e.filter(n,function(e){return null===e.deleteDate}),e.forEach(n,function(t){var i=t.role;i&&(a[i.id]=i),t.name=e.trim([t.firstName,t.lastName].join(" "))||t.email,r.push({user:t,role:i})}),t.fire("projectMembersReady",r),t.fire("projectRolesReady",e.values(a))}})}})}),define("tau/components/extensions/user/extension.owner.project.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder","tau/models/extensions/team/extension.model.allUserRetriever"],function(e,t,i,n){return e.extend({category:"edit",extendEditorConfig:function(e){e.UserExcluder=i,e.Retriever=n},getExtensions:function(){return[t]}})}),define("tau/components/component.property.owner.project",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.project.editable"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={ModelType:t,template:s,extensions:[i,a,r,n,o]};
return l=l||{},l.propertyName="owner",e.create(u,l)}}}),define("tau/models/extensions/team/extension.model.requestOwners.retriever",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus registerStoreRequest":function(){var t=this.config.context.entity,i=this.config.store,n=this;i.get(t.entityType.name,{id:t.id,fields:[{project:["id",{projectMembers:[{user:["id","firstName","lastName","email","isActive","deleteDate"]},{role:["id","name"]}]}]},{team:["id",{teamMembers:[{user:["id","firstName","lastName","email","isActive","deleteDate"]},{role:["id","name"]}]}]}]}).done({success:function(t){t[0].data.project=t[0].data.project||{},e.defaults(t[0].data.project,{projectMembers:[]}),t[0].data.team=t[0].data.team||{},e.defaults(t[0].data.team,{teamMembers:[]});var i=t[0].data.project.projectMembers.concat(t[0].data.team.teamMembers||[]);i=e.uniq(i,!1,function(e){return e.user.id}),n.fire("members.provided",i)}}),i.get(t.entityType.name,{id:t.id,fields:[{requesters:["id","firstName","lastName","email","isActive","deleteDate","kind"]}]}).done({success:function(e){var t=e[0].data.requesters;n.fire("requesters.provided",t)}})},"bus members.provided+requesters.provided":function(t){var i=t["members.provided"].data,n=t["requesters.provided"].data,a=e.pluck(n,"id");i=e.reject(i,function(t){return e.indexOf(a,t.user.id)>-1}),e.forEach(n,function(e){i.unshift({role:{id:0,name:"Requesters"},user:e})}),i=e.filter(i,function(e){return null===e.user.deleteDate});var r=[];e.forEach(i,function(t){var i=t.role;i&&r.push(i),t.username=e.trim([t.firstName,t.lastName].join(" "))||t.email}),r=e.uniq(r,!1,function(e){return e.id}),this.fire("projectMembersReady",i),this.fire("projectRolesReady",r)}})}),define("tau/components/extensions/user/extension.owner.request.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder","tau/models/extensions/team/extension.model.requestOwners.retriever"],function(e,t,i,n){return e.extend({category:"edit",extendEditorConfig:function(e){e.UserExcluder=i,e.Retriever=n
},getExtensions:function(){return[t]},"bus initBubble":function(e){var t=e.data.target,i=function(){t.tauBubble("empty")};t.on("close externalClose",i)}})}),define("tau/components/component.property.owner.request",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.request.editable"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={ModelType:t,template:s,extensions:[i,a,r,n,o]};return l=l||{},l.propertyName="owner",e.create(u,l)}}}),define("tau/models/model.property.password",["tau/core/model-base"],function(e){return e.extend({init:function(e){if(this._super.apply(this,arguments),!e.propertyName)throw"PropertyName was not configured";this.propertyName=e.propertyName,this.listenedEntities={}},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},listenOfPropertyChanged:function(){var e=this.config.context.entity.id;this.listenedEntities[e]||(this.listenedEntities[e]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onInit:function(){this.fire("dataBind",{name:this.propertyName,text:this.config.defaultText||"",passwordHint:this.config.passwordHint})}})}),define("tau/components/component.property.password",["Underscore","tau/components/component.creator","tau/models/model.property.password","tau/models/model.property.text.editable","tau/models/model.property.text.validation","tau/components/extensions/property/extension.property.password.editable","tau/ui/templates/property/ui.template.property.password"],function(e,t,i,n,a,r,s){return{create:function(o){var l={ModelType:i,extensions:e.concat([o.extensions,n,a,r]),template:s};return t.create(l,o)
}}}),define("tau/components/component.property.plannedEndDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.propertyName="plannedEndDate",t.allowReset=!0,e.create(t)}}}),define("tau/components/component.property.plannedStartDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.propertyName="plannedStartDate",t.allowReset=!0,e.create(t)}}}),define("tau/components/component.property.priority",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="priority",t.editorType="",t.alignElementSelector=".property-text",t.showEmptyDataMessage=!0,t.editorComponentConfig={type:"choice",listType:"priority",maxHeight:200},e.create(t)}}}),define("tau/models/model.property.process",["Underscore","tau/models/model.property"],function(e,t){return t.extend({getPropertyData:function(){this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",{process:["id","name",{practices:["id","name"]}]}]}).done({success:this.onEntityRetrieved,scope:this})},processProperty:function(t){var i={id:t[this.valueField],text:t[this.displayField],subtext:e.pluck(t.practices,"name").join(", ")};this.fire("dataBind",i)}})}),define("tau/components/component.property.process",["Underscore","tau/components/component.creator","tau/core/termProcessor","tau/models/model.property.process","tau/models/model.property.editable","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property"],function(e,t,i,n,a,r,s,o,l,u){return{create:function(s){s.propertyName="process",s.showUrl=!1,s.alignElementSelector=".property-text",s.editorComponentConfig={type:"choice",listType:"process",maxHeight:200,filter:!1,expandable:!1,showEmptyDataMessage:!1,showClearValue:!1,allowToReset:!1,defaultValueLabel:"current",fullModeLabel:"show old",confirmation:"It is strongly recommended to NOT change Process for Projects in progress as some data will be lost (esp. the Custom fields data). Are you sure you want to change process?"};
var c=new i(s.context.getTerms()),d=s.editorComponentConfig;d.resetDisabled=s.resetDisabled,d.showEmptyDataMessage&&(d.emptyDataMessage="No "+c.getTerms(s.propertyName).names.toLowerCase()+" found"),d.showClearValue&&(s.clearValueLabel="reset "+c.getTerms(s.propertyName).name.toLowerCase());var p={ModelType:s.Model||n,template:u,extensions:e.concat([s.extensions,o,l,a,r])};return t.create(p,s)}}}),define("tau/components/component.property.program",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="program",t.showUrl=!1,t.alignElementSelector=".property-text",t.editorComponentConfig={type:"choice",listType:"program",expandable:!0,filter:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show old",clearValueLabel:"reset",showReset:!0},t.allowReset=!0,e.create(t)}}}),define("tau/models/model.property.project",["Underscore","tau/models/model.property"],function(e,t){return t.extend({getPropertyData:function(){this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",{project:["id","name","color"]}]}).done({success:this.onEntityRetrieved,scope:this})},processProperty:function(e){var t={id:e[this.valueField],type:"project",name:e[this.displayField]||"No Project",color:e.color,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e[this.valueField],"project",!0),isEditable:this.config.editable};this.fire("dataBind",t)}})}),define("tau/ui/templates/property/ui.template.property.project",["tau/core/templates-factory"],function(e){var t={name:"property.project",engine:"jqote2",markup:["<div>",'<span class="property tau-property tau-property-<%= this.type %><% if (!this.name) { %> tau-property_empty_true<% } %>">','<span class="property-text tau-property__value">',"<% if (this.id) { %>",'<a href="<%= this.url %>" class="tau-linkentity tau-linkentity_type_full">',"<% if (this.color) { %>",'<i style="background-color: <%! this.color %>;" class="tau-icon tau-icon_type_color"></i>',"<% } else { %>",'<i class="tau-icon tau-icon_type_color tau-icon_name_empty"></i>',"<% } %>",'<span class="tau-linkentity__inner"><%! this.name %></span>',"</a>","<% } else { %>",'<span <% if (this.isEditable){ %>class="ui-link"<% } %>><%! this.name %></span>',"<% } %>","</span>","</span>","</div>"]};
return e.register(t)}),define("tau/components/component.property.project",["Underscore","tau/components/component.property","tau/models/model.property.project","tau/ui/templates/property/ui.template.property.project","tau/ui/templates/choice/project/ui.template.choice.project.option"],function(e,t,i,n,a){return{create:function(r){var s=r.context.entity.entityType.name.toLowerCase(),o=r.context.hasEdition("hasTeams");return e.extend(r,{propertyName:"project",Model:i,template:n,editable:e.contains(["epic","feature","userstory","bug","request","testcase","testplan"],s),showUrl:!0,alignElementSelector:".property-text",applyBubbleClasses:!1,editorComponentConfig:{type:"choice",listType:"project",allowToReset:o,filter:!0,clearValueLabel:"No Project",emptyDataMessage:"No projects found",templateOption:a.name}}),t.create(r)}}}),define("tau/ui/templates/property/ui.template.property.relationType",["tau/core/templates-factory"],function(e){var t={name:"property-relationType",markup:["<div>",'   <span class="tau-relation-icon tau-${value.toLowerCase()}"/>','   <span class="ui-link property-text i-role-relation-type" >${text}</span>',"</div>"]};return e.register(t)}),define("tau/components/component.property.relationType",["tau/components/component.property","tau/ui/templates/property/ui.template.property.relationType"],function(e,t){return{create:function(i){return i.propertyName="relationType",i.editorType="",i.template=t,i.alignElementSelector=".i-role-relation-type",i.editorComponentConfig={type:"choice",listType:"relationType",maxHeight:200},e.create(i)}}}),define("tau/components/component.property.release",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="release",t.showUrl=!0,t.alignElementSelector=".property-text",t.allowReset=!t.resetDisabled,t.additionalFields=[{iteration:["id","name"]}],t.applyBubbleClasses=!1,t.editorComponentConfig={type:"choice",listType:"release",expandable:!0,filter:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show old",clearValueLabel:"backlog"},e.create(t)
}}}),define("tau/components/component.property.requestSource",["tau/components/component.property","tau/models/model.property.simple"],function(e,t){return{create:function(i){return i.propertyName="sourceType",i.Model=t,i.showUrl=!1,i.alignElementSelector=".property-text",i.editorComponentConfig={type:"choice",listType:"static",values:["None","Email","Phone","Internal","External"],expandable:!0,filter:!1,showEmptyDataMessage:!1},e.create(i)}}}),define("tau/components/component.property.requestType",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="requestType",t.editorType="",t.alignElementSelector=".property-text",t.showEmptyDataMessage=!0,t.editorComponentConfig={type:"choice",listType:"requestType",maxHeight:200,showReset:!1},e.create(t)}}}),define("tau/models/assignment/model.property.responsible.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(e,t){return t.extend({assignTo:function(e){var t={type:this.config.context.entity.entityType.name,$set:{responsible:{id:e}},$include:[{responsible:["id","firstName","lastName"]}]};this.fire("save",t)}})}),define("tau/models/userList/extension.model.responsible.Excluder",["Underscore","tau/models/userList/extension.model.user.Excluder"],function(e,t){return t.extend({getUserPropertyName:function(){return"responsible"}})}),define("tau/components/extensions/user/extension.responsible.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.responsible.editable","tau/models/userList/extension.model.responsible.Excluder"],function(e,t,i){return e.extend({category:"edit",extendEditorConfig:function(e){e.UserExcluder=i},getExtensions:function(){return[t]}})}),define("tau/components/component.property.responsible",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.responsible.editable"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={ModelType:t,template:s,extensions:[i,a,r,n,o].concat(l.extensions||[])};
return l=l||{},l.propertyName="responsible",e.create(u,l)}}}),define("tau/components/component.property.role",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="role",t.editable=t.context.getLoggedUser().isAdministrator,t.displayField="name",t.valueField="id",t.alignElementSelector=".property-text",t.showUrl=!1,t.stackName="role",t.editorComponentConfig={type:"choice",listType:"role",expandable:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show all"},e.create(t)}}}),define("tau/ui/templates/property/ui.template.property.modern",["tau/core/templates-factory"],function(e){var t={name:"property.modern",engine:"jqote2",markup:['<span class="tau-dropdown-toggle i-role-property " data-value="<%! this.value %>">',"<i><%! this.value %></i>","</span>"]};return e.register(t)}),define("tau/components/component.property.role.modern",["tau/components/component.property","tau/ui/templates/property/ui.template.property.modern"],function(e,t){return{create:function(i){return i.propertyName="role",i.editable=!0,i.displayField="name",i.valueField="id",i.alignElementSelector=".i-role-property",i.showUrl=!1,i.targetElementSelector=".i-role-property",i.stackName="role",i.applyBubbleClasses=!1,i.editorComponentConfig={type:"choice",listType:"role",expandable:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show all"},i.template=t,e.create(i)}}}),define("tau/components/component.property.runDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=_.clone(t||{}),t.propertyName="runDate",t.editable=!1,t.format="datetime",e.create(t)}}}),define("tau/models/model.property.severity",["Underscore","tau/models/model.property","tau/models/dataprocessor/model.processor.importance"],function(e,t,i){return t.extend({getPropertyFields:function(){var t=this._super(),i=e.union(t,["importance"]);return i},buildRequest:function(e){var t=this._super(e);return t=t.get("severity",{fields:["id","importance"]})
},onProcessProperty:function(e){if(this.config){var t=this._super(e);return t.kind=this.importanceProcessor.getKind(e.importance),t}},onEntityRetrieved:function(t){var n=this.property=t[0].data[this.propertyName]||{},a=e(t[1].data).pluck("importance"),r=e.min(a),s=e.max(a);this.importanceProcessor=new i(r,s),this.processProperty(n)}})}),define("tau/ui/templates/property/ui.template.property.severity",["tau/core/templates-factory"],function(e){var t={name:"property-severity",markup:["<div>",'   <span class="property tau-list-severity-${kind}">','       <span class="property-text">${text}</span>',"   </span>","</div>"].join("")};return e.register(t)}),define("tau/components/component.property.severity",["tau/components/component.property","tau/models/model.property.severity","tau/ui/templates/property/ui.template.property.severity"],function(e,t,i){return{create:function(n){return n.propertyName="severity",n.editorType="",n.showUrl=!1,n.alignElementSelector=".property-text",n.showEmptyDataMessage=!0,n.editorComponentConfig={type:"choice",listType:"severity",maxHeight:200},n.Model=t,n.template=i,e.create(n)}}}),define("tau/components/component.property.startDate",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.propertyName="startDate",e.create(t)}}}),define("tau/components/component.property.startDate.portfolio",["tau/components/component.property.date","tau/models/model.property.date.validation.portfolio"],function(e,t){return{create:function(i){return i=i||{},i.propertyName="startDate",i.validationExtension=t,i.allowReset=!0,e.create(i)}}}),define("tau/components/component.property.startDate.projectMember",["tau/components/component.property.date"],function(e){return{create:function(t){return t=t||{},t.editable=!0,t.allowReset=!0,t.propertyName="membershipStartDate",e.create(t)}}}),define("tau/ui/templates/property/ui.template.property.status.testCaseRun",["tau/core/templates-factory"],function(e){var t={name:"property-last-status-testcaserun",markup:["<div>",'<div class="ui-status {{if value === true}}ui-status_type_passed green{{/if}}{{if value === false}}ui-status_type_failed red{{/if}}{{if value === null}}ui-status_type_na grey{{/if}}">',"{{if value === true}}","Passed","{{/if}}","{{if value === false}}","Failed","{{/if}}","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.property.status.testCaseRun",["tau/components/component.property.bool","tau/ui/templates/property/ui.template.property.status.testCaseRun"],function(e,t){return{create:function(i){return i=i||{},i.propertyName="passed",i.template=t,e.create(i)}}}),define("tau/models/model.property.team",["Underscore","tau/models/model.property"],function(e,t){return t.extend({getPropertyData:function(){this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",{team:["id","name","icon"]}]}).done({success:this.onEntityRetrieved,scope:this})},processProperty:function(e){var t={id:e[this.valueField],type:e.__type,name:e[this.displayField]||"No Team",icon:e.icon,url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e[this.valueField],"team",!0),isEditable:this.config.editable};this.fire("dataBind",t)}})}),define("tau/ui/templates/property/ui.template.property.team",["tau/core/templates-factory"],function(e){var t={name:"property.team",engine:"jqote2",markup:["<div>",'<span class="property tau-property tau-property-<%= this.type %><% if (!this.name) { %> tau-property_empty_true<% } %>">','<span class="property-text tau-property__value">',"<% if (this.id) { %>",'<a href="<%= this.url %>" class="tau-linkentity tau-linkentity_type_full">','<i class="tau-icon tau-icon_type_svg tau-icon_name_<%! this.icon || "trihead" %>"></i>','<span class="tau-linkentity__inner">',"<%! this.name %>","</span>","</a>","<% } else { %>",'<span <% if (this.isEditable){ %>class="ui-link"<% } %>><%! this.name %></span>',"<% } %>","</span>","</span>","</div>"]};return e.register(t)}),define("tau/ui/templates/choice/team/ui.template.choice.team.option",["tau/core/templates-factory"],function(e){var t={name:"state.team.option",engine:"jqote2",markup:['<div role="option" data-id="<%! this.id %>" class="drop-down-option drop-down-option-team i-role-option " <% if (this.description) { %> title=<%! this.description %> <% } %> >','<span class="drop-down-option__prefix">','<i class="tau-icon tau-icon_type_svg tau-icon_name_<%! this.icon || "trihead" %>"></i>',"</span>",'<span class="i-role-optiontext drop-down-option__text"><%! this.name %></span>',"</div>"]};
return e.register(t)}),define("tau/components/component.property.team",["Underscore","tau/components/component.property","tau/models/model.property.team","tau/ui/templates/property/ui.template.property.team","tau/ui/templates/choice/team/ui.template.choice.team.option"],function(e,t,i,n,a){return{create:function(r){var s=r.context.entity.entityType.name.toLowerCase(),o=r.context.hasEdition("hasTeams");return e.extend(r,{propertyName:"team",Model:i,template:n,editable:o&&e.contains(["epic","feature","userstory","bug","request","testcase","testplanrun","testplan"],s),showUrl:!0,alignElementSelector:".property-text",applyBubbleClasses:!1,editorComponentConfig:{type:"choice",listType:"team",allowToReset:!0,filter:!0,clearValueLabel:"No Team",emptyDataMessage:"No teams found",templateOption:a.name}}),t.create(r)}}}),define("tau/components/component.property.teamIteration",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="teamIteration",t.showUrl=!0,t.alignElementSelector=".property-text",t.allowReset=!0,t.applyBubbleClasses=!1,t.editorComponentConfig={type:"choice",listType:"teamIteration",maxHeight:200,filter:!0,expandable:!0,showEmptyDataMessage:!0,clearValueLabel:"reset",defaultValueLabel:"current",fullModeLabel:"show old"},e.create(t)}}}),define("tau/components/component.property.testCase",["tau/components/component.property"],function(e){return{create:function(t){return t=t||{},t.propertyName="testCase",t.showUrl=!0,t.editable=!1,e.create(t)}}}),define("tau/components/component.property.testPlan",["tau/components/component.property"],function(e){return{create:function(t){return t=t||{},t.propertyName="testPlan",t.showUrl=!0,t.editable=!1,e.create(t)}}}),define("tau/components/component.property.testPlanRun",["tau/components/component.property"],function(e){return{create:function(t){return t=t||{},t.propertyName="testPlanRun",t.showUrl=!0,t.editable=!1,e.create(t)}}}),define("tau/components/component.property.user",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.editable"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={ModelType:t,template:s,extensions:[i,a,r,n,o]};
return l=l||{},l.propertyName="user",e.create(u,l)}}}),define("tau/components/component.property.userStory",["tau/components/component.property"],function(e){return{create:function(t){return t.propertyName="userStory",t.showUrl=!0,t.alignElementSelector=".property-text",t.showEmptyDataMessage=!0,t.allowReset=!t.resetDisabled,t.applyBubbleClasses=!1,t.editorComponentConfig={type:"finder.entity",propertyName:"userStory"},t.onPositionConfig=function(e){e.collision="flipfit flipfit",e.at="left middle",e.my="right middle"},e.create(t)}}}),define("tau/components/component.property.velocity",["tau/components/component.property.time"],function(e){return{create:function(t){return t.propertyName="velocity",e.create(t)}}}),define("tau/ui/templates/quick.add/ui.template.quick.add.content",["tau/core/templates-factory"],function(e){var t={name:"quick.add.content",markup:['<div class="ui-quick-add-stats"></div>','<div class="ui-quick-add-content">','<div class="quick-add-lines">',"</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/templates/quick.add/ui.template.quick.add.line",["tau/core/templates-factory"],function(e){var t={name:"quick.add.line",markup:['<div class="ui-quick-add-line">',' <div class="quick-add-input ui-quick-add-new-item"></div>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/ui/extensions/quick.add/ui.extension.quick.add",["jQuery","Underscore","tau/core/extension.base.stateful","tau/ui/templates/quick.add/ui.template.quick.add.content","tau/ui/templates/quick.add/ui.template.quick.add.line","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t,i,n,a){return i.extend({"bus beforeInit":function(e,t){var i=t.config;this.fire("dataBind",{label:i.label,entityType:i.entityType})},"bus afterRender":function(e,i){var n=i.element,a=n.find(".ui-quick-add-link").tauBubble({onPositionConfig:function(e){e.offset="-20 0"}});a.bind("show",t.bind(function(e,t){this.fire("displayQuickAdd",t)},this)),a.bind("close",t.bind(function(e,t){t.event&&t.event.preventDefault&&(t.event.preventDefault(),t.event.stopPropagation()),this.fire("close",t)
},this))},"bus displayQuickAdd":function(t){var i=t.data;this.itemsAdded=e.Deferred();var a=i.popup.find(".tau-bubble__inner");a.find(".ui-quick-add-content").length||a.append(n.render({})),i.api.adjustPosition(),a.find(".quick-add-lines").html(""),a.find(".ui-quick-add-stats").text(""),a.find(".button-box").click(function(){i.api.hide()}),this._appendAddLine(a),this._attachKeyBoardHandling()},"bus close":function(){this.config.context.configurator.getKeyBoardManager().popHandler(),this.itemsAdded["is-async-operation-started"]&&t.defer(this.safeCallback(this._addItems))},_addItems:function(){var e=this.config.context;e["evict-data"]={entityId:this._getEntityId(),entityType:this._getEntityType(),evictProperties:this.config.evictProperties,$defer:this.itemsAdded},this.fire(this.config.entityType+".items.added",e)},_attachKeyBoardHandling:function(){var t={handleKeyDown:e.noop};this.config.context.configurator.getKeyBoardManager().pushHandler(t)},_getEntityId:function(){return this.config.context.entity.id},_getEntityType:function(){return this.config.context.entity.entityType.name},_prepareCmd:function(e,i){e=e.replace(/\s+/gi," "),e.length>255&&(e=e.substring(0,254));var n=this.config,a={name:e};n.additionalFieldsSet&&t.extend(a,n.additionalFieldsSet),a[n.property]={id:this._getEntityId()};var r={};r[n.property]=["id"];var s={$set:a,fields:["id","name",r]};return i.data("item-id")&&(s.id=i.data("item-id")),s},_appendAddLine:function(i){var n=this,r=e(".ui-quick-add-new-item",i);if(r.length>0)return void setTimeout(function(){r.click()},1);var s=a.render({entityType:n.config.entityType});i.find(".quick-add-lines").append(s);var o=e(".quick-add-input",s);o.editableText({restoreText:!0,preventDefaultBlur:!0,onSave:function(a){if(a&&t.trim(a)&&!o.hasClass("ui-quick-add-saving")){o.removeClass("ui-quick-add-new-item").addClass("ui-quick-add-saving");var r=n.config.store,l=n._prepareCmd(a,s),u=t.partial(function(t,n){s.data("item-id",n.data.id).addClass("ui-quick-add-item-saved"),o.removeClass("ui-quick-add-saving").text(n.data.name),t.resolve();
var a=e(".ui-quick-add-item-saved",i).length+" item(s) saved";e(".ui-quick-add-stats",i).text(a)},n.itemsAdded),c=function(e,t){var i=r.config.proxy.types[n.config.entityType].refs;e&&i.project&&(l.$set.project={id:e.id}),t&&i.team&&(l.$set.team={id:t.id}),n.config.onBeforeAdd&&n.config.onBeforeAdd(l),r.save(n.config.entityType,l,{success:function(e){u(e)}}).done()};e(".ui-quick-add-stats",i).text("saving...");var d=r.config.proxy.types[n._getEntityType()].refs,p=[{project:["id"]}];d.team&&p.push({team:["id"]}),n.itemsAdded["is-async-operation-started"]=!0,r.get(n._getEntityType(),{id:n._getEntityId(),fields:p},{success:function(e){c(e.data.project,e.data.team)}}).done(),n._appendAddLine(i)}}}),o.data("textEditor").onEscape=function(e){e.preventDefault(),this._cancelEdit(),this.$element.blur()},setTimeout(function(){o.click()},1)}})}),define("tau/ui/templates/quick.add/ui.template.quick.add",["tau/core/templates-factory"],function(e){var t={name:"quick.add",markup:['<div class="ui-quick-add">','<span class="ui-link ui-quick-add-link">${label}</span>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.quick.add",["tau/components/component.creator","tau/ui/extensions/quick.add/ui.extension.quick.add","tau/ui/templates/quick.add/ui.template.quick.add"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/components/extensions/redirect/extension.redirect",["tau/components/extensions/component.extension.base"],function(e){return e.extend({_redirect:function(e){this.redirect.redirect(e)},"bus afterInit":function(e){this.redirect=this.config.context.configurator.getRedirect(),this._redirect(e.data.config.to)},"bus redirect":function(e){this._redirect(e.data.to)}})}),define("tau/components/component.redirect",["tau/components/component.creator","tau/models/model.menu.actions","tau/components/extensions/redirect/extension.redirect","tau/ui/templates/menu/ui.template.menu.actions"],function(e,t,i){return{create:function(t){var n={extensions:[i]};
return e.create(n,t)}}}),define("tau/models/relations/model.relations.add",["tau/core/extension.base"],function(e){return e.extend({"bus beforeInit":function(e,t){t.config.context.configurator.getStore().get("relationTypes",{relationType:["id","name"]}).done({success:_.bind(function(e){this.fire("dataBind",{mainEntity:t.config.context.entity,dependencyType:t.config.dependencyType,relationTypes:e[0].data,relationTypeId:e[0].data[0].id})},this)})}})}),define("tau/ui/extensions/relations/ui.extension.relations.add",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus entityFinder.afterInit":function(){this.fire("multiple.changed",{entityIds:[]})},"bus entityFinder.$el.ready:last + entityFinder.item.selected":function(e,t,i){this._toggleSelection(t,[i])},"bus entityFinder.$el.ready:last + multiple.changed:last + entityFinder.result.rendered":function(t,i,n,a){var r=e.intersection(n.entityIds,e.pluck(a.items,"id"));this._toggleSelection(i,r,!0)},"bus entityFinder.$el.ready:last + multiple.changed:last + multiple.reset":function(e,t,i){this._toggleSelection(t,i.entityIds,!1),this.fire("multiple.changed",{entityIds:[]})},"bus multiple.changed > entityFinder.item.selected":function(t,i,n){var a=i.entityIds;e.contains(a,n)?a=e.without(a,n):a.push(n),this.fire("multiple.changed",{entityIds:a})},"bus afterRender:last + entityFinder.result.rendered":function(e,t){var i=t.element,n=i.find("form");i.find(".i-role-selection-counter").click(function(){return!1}),"hidden"===n[0].style.visibility&&(n.css({visibility:"visible"}),n.find(".i-role-filter-input").focus())},"bus afterRender:last + multiple.changed":function(e,t,i){var n=i.entityIds.length,a=0===n,r=t.element.find(".i-role-selection-counter"),s=t.element.find(".i-role-relation-type"),o=t.element.find(".i-role-selection-counter-clear");r.text(n).toggleClass("tau-selected",!a),o.toggleClass("hidden",a),s.prop("disabled",a)},"bus afterInit:last + multiple.changed:last + relations.add":function(t,i,n,a){var r=i.config.context.configurator.getStore(),s=i.config.context.entity,o=i.config.dependencyType,l=a.relationTypeId,u="slave"===o?"master":"slave",c="slave"===o?"slave":"master",d=e.map(n.entityIds,function(e){var t={relationType:{id:l}};
return t[u]={id:s.id},t[c]={id:e},t});r.save("relation",{$set:d,fields:[{master:["id",{entityType:["id","name"]}]},{slave:["id",{entityType:["id","name"]}]}]}).done(e.bind(function(){this.fire("close")},this))},"bus afterRender":function(i,n){var a=n.element,r=a.find(".cf-input");this._entityBehavior(r),a.on("click",".i-role-relation-type",e.bind(function(e){var i=t(e.target);this.fire("relations.add",{relationTypeId:i.data("id")})},this)),a.on("click",".i-role-selection-counter-clear",e.bind(function(e){e.preventDefault(),e.stopPropagation(),this.fire("multiple.reset")},this))},_entityBehavior:function(e){this.fire("applyFinder",e)},_toggleSelection:function(t,i,n){e.each(i,function(e){t.find(".i-role-option[data-id="+e+"]").toggleClass("tau-selected",n)})}})}),define("tau/ui/templates/relations/ui.template.relations.add",["tau/core/templates-factory"],function(e){var t={name:"relations-add-popup",engine:"jqote2",markup:['<div class="tau-add-relations-dialog">','<form style="visibility: hidden;">','<div class="tau-entity-fields">','<div class="tau-fieldset tau-active" style="padding-top: 0;">','<div class="i-role-entity-selector tau-field_entity tau-field" style="font-size: 16px; margin: 0; padding: 0;">','<div class="tau-userStorySelector hidden">','<input type="hidden" data-entityuniquename="entityFinder" name="entity" class="cf-input">',"</div>",'<div tabindex="0" class="tau-userStorySelector__control" data-name="entityFinder">',"<span ",'runas="finder.entity" ','data-name="entityFinder" ','data-model="relation" ','data-dependency-type="<%= this.dependencyType %>" ','data-context:general:id="<%= this.mainEntity.id %>" ','data-context:general:entity-type:name="<%= this.mainEntity.entityType.name %>"',">","</span>","</div>","</div>","</div>","</div>",'<div class="tau-entity-selector">','<div class="quick-add__entity-items i-role-relations-panel">','<span class="quick-add__entity-txt">Add','<div class="tau-inline-group tau-selection-group i-role-counter-block">','<button class="tau-btn tau-btn-small tau-selected tau-selection-counter i-role-selection-counter">0</button>','<button class="tau-btn tau-btn-small tau-clear-selection i-role-selection-counter-clear"></button>',"</div>",'<%= this.dependencyType=="master"?"inbound":"outbound" %> relations as</span>',"<% for(var i=0; i<this.relationTypes.length; i++){%>",'<button type="button" disabled data-id="<%= this.relationTypes[i].id %>" data-name="<%= this.relationTypes[i].name%>"','class="tau-btn tau-<%=this.relationTypes[i].name.toLowerCase()%> i-role-relation-type">',"<%= this.relationTypes[i].name %>","</button>","<%}%>","</div>","</div>","</form>","</div>"]};
return e.register(t)}),define("tau/components/component.relations.add",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator","tau/models/relations/model.relations.add","tau/views/view.compositeControl","tau/ui/extensions/relations/ui.extension.relations.add","tau/ui/extensions/finder.entity/ui.extension.finder.entity.embedder","tau/ui/extensions/container/ui.extension.container.childrenEvents","tau/ui/templates/relations/ui.template.relations.add"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){var c={ViewType:a,extensions:[t,i,n,r,s,o],template:l};return u.dependencies=["finder.entity"],e.create(c,u)}}}),define("tau/models/quick.add/model.relations.quick.add",["Underscore","jQuery","tau/models/quick.add/model.board.general.quick.add","tau/core/termProcessor"],function(e,t,i,n){return i.extend({getProcessedTypes:function(t,i){var a=new n(t.context.getTerms());return e.map(i,function(e){return{name:e.name,title:a.resolve(e.name,e.title)}}.bind(this))},getTypes:function(){return e.without(this._super(),"user","project","team")},getViewMode:function(){return"board"},getDefinition:function(t){var i=e.extend(this._super(t),this._getXAxisDefinition());return i.global.acid=null,i.global.entityId=this.config.context.entity.id,i},getSingleCellSliceDefinition:function(t,i){return e.extend(this._super(t,i),this._getXAxisDefinition())},_getXAxisDefinition:function(){return{x:{types:[this._getAxisNameForDependencyType()]}}},_getAxisNameForDependencyType:function(){return"slave"==this.config.dependencyType?"inboundrelations":"outboundrelations"},doAdd:function(e,t,i){i.action.x=this.config.context.entity.id,i.viewMode=this.getViewMode(),this._super(e,t,i)},buildReadyToAddSlice:function(e,t){var i=this._super(e,t);return i.config.base64="false",i}})}),define("tau/ui/extensions/relations/ui.extension.relations.add.trigger",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/models/quick.add/model.relations.quick.add"],function(e,t,i,n){return i.extend({"bus afterInit":function(){this.fire("dataBind")
},"bus afterRender":function(e,t){this._initRelationLookupBubble(this._getButtonWithDefaultPrevented(t.element,".i-role-add-lookup")),this._initRelationQuickAddBubble(this._getButtonWithDefaultPrevented(t.element,".i-role-quick-add"))},"bus afterInit:last + relations-quick-add-general.model.data.item.did.add":function(e,t){var i=t.config;this.store.evictProperties(i.context.entity.id,i.context.entity.entityType.name,[i.dependencyType+"Relations"]);var n=this.config.context.configurator.getGlobalBus();n.fire("relation.items.added",{dependencyType:t.config.dependencyType})},_getButtonWithDefaultPrevented:function(e,t){var i=e.find(t);return i.on("click",function(e){e.preventDefault()}),i},_initRelationLookupBubble:function(e){var t=this.config.dependencyType,i=function(){e.toggleClass("tau-checked")},n={target:e,className:"tau-bubble__inner_without_scroll tau-bubble-lookup",applyBubbleClasses:!1,cleanupOnHide:!0,onShow:i,onHide:i,onPositionConfig:function(i){return i.of=e,i.collision="flipfit fit",i.within=this._$getPage(e),"slave"===t&&(i.my="right center+30",i.at="left center+30"),i}.bind(this),onArrowPositionConfig:function(i){return"slave"===t?{of:e,my:"right center",at:"left center",collision:"flipfit fit"}:i}.bind(this),componentsConfig:{components:[{type:"relations.add",dependencyType:t}]}};this.fire("initBubble",n)},_initRelationQuickAddBubble:function(e){var t=this.config.dependencyType,i={target:e,applyBubbleClasses:!1,cleanupOnHide:!0,stackName:"quickAddGeneral",showOnCreation:!1,zIndex:1e4,onShow:function(){e.removeClass("tau-quick-add-collapse"),e.toggleClass("tau-checked")},onHide:function(){e.addClass("tau-quick-add-collapse"),e.toggleClass("tau-checked")},className:"tau-quick-add-dialog-general",onPositionConfig:function(){return{of:e,my:"left top",at:"left-12 bottom+1",collision:"flipfit fit",within:this._$getPage(e)}}.bind(this),dontCloseSelectors:["#ui-datepicker-div"],componentsConfig:{components:[{name:"relations-quick-add-general",type:"board.cell.quick.add",QuickAddModel:n,dependencyType:t}]}};
this.fire("initBubble",i)},_$getPage:function(e){return this._$pageWrapper||(this._$pageWrapper=e.closest(".tau-page-entity")),this._$pageWrapper}})}),define("tau/ui/templates/relations/ui.template.relations.add.trigger",["tau/core/templates-factory"],function(e){var t={name:"relations.add.trigger",engine:"jqote2",markup:['<div class="tau-btn-wrap">','<span class="tau-inline-group">','<button class="tau-btn tau-search i-role-add-lookup"></button>','<button class="tau-btn tau-add i-role-quick-add tau-success"></button>',"</span>","</div>"]};return e.register(t)}),define("tau/components/component.relations.add.trigger",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator","tau/ui/extensions/relations/ui.extension.relations.add.trigger","tau/ui/templates/relations/ui.template.relations.add.trigger","tau/ui/extensions/container/ui.extension.container.childrenEvents"],function(e,t,i,n,a,r){return{create:function(s){var o={extensions:[t,i,n,r],template:a};return e.create(o,s)}}}),define("tau/ui/templates/relations/ui.template.relations.connection",["tau/core/templates-factory"],function(e){var t={name:"relations.connection",engine:"jqote2",markup:['<div class="tau-relations-connection">','<span class="tau-in-bg">','<span class="tau-out-bg">',"<b><%= this.masterRelationsCount %></b>",'<b class="tau-icon"></b>',"<b><%= this.slaveRelationsCount %></b>","</span>","</span>","</div>"]};return e.register(t)}),define("tau/models/relations/model.relations.connection",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=["masterRelations-count","slaveRelations-count"],n=t.config.context.entity;this.store.evictProperties(n.id,n.entityType.name,i);var a={id:n.id,fields:i};this.store.get(n.entityType.name,a).done({success:function(e){this.fire("dataBind",{masterRelationsCount:e[0].data["masterRelations-count"],slaveRelationsCount:e[0].data["slaveRelations-count"]})
},scope:this})},"bus relations.changed":function(){this.fire("refresh")}})}),define("tau/components/component.relations.connection",["Underscore","tau/components/component.creator","tau/ui/templates/relations/ui.template.relations.connection","tau/models/relations/model.relations.connection","tau/ui/extensions/relations/ui.extension.relations.observer"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[n,a],template:i};return t.create(r,e)}}}),define("tau/models/dataProviders/model.provider.items.relations",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(t){this.dataDeferred=$.Deferred();var i=e.bind(function(e,n){t.bus.removeListener("public.relationsReady",i,t.bus),this.dataDeferred.resolve(n[t.dependencyType])},this);t.bus.on("public.relationsReady",i)},fetch:function(e){this.dataDeferred.done(e)}})}),define("tau/models/relations/model.relations.data.fetcher",["Underscore","jQuery","tau/core/class","tau/core/termProcessor","tau/store/types"],function(e,t,i,n,a){return i.extend({init:function(e,t){this.config=this._createConfig(e,t)},fetchRelatedEntities:function(){var e=t.Deferred();return this.config.store.get(this.config.entityTypeName,this._buildRelationsCommand(!0)).done({success:function(t){this._fetchRelatedEntitiesInfo(t[0].data[this.config.relationsFieldName],function(t){e.resolve(t)}.bind(this))},scope:this}),e.promise()},fetchRelations:function(){return this._fetchData(this._buildRelationsCommand())},fetchRelationCounts:function(){return this._fetchData(this._buildRelationCountCommand())},_fetchData:function(e){this._evictRelationCounts();var i=t.Deferred();return this.config.store.get(this.config.entityTypeName,e).done({success:function(e){i.resolve(e)},scope:this}),i.promise()},_evictRelationCounts:function(){this.config.store.evictProperties(this.config.entityId,this.config.entityTypeName,["masterRelations","slaveRelations"])},_createConfig:function(e,t){var i={configurator:e.context.configurator,context:e.context,entityId:e.context.entity.id,entityTypeName:e.context.entity.entityType.name,store:e.store,relatedEntityFieldName:t,relationsFieldName:t+"Relations"};
return i},_buildRelationsCommand:function(e){return{id:this.config.entityId,fields:[this._buildRelationsField(e)]}},_buildRelationCountCommand:function(){return{id:this.config.entityId,fields:["slaveRelations-count","masterRelations-count"]}},_buildRelationsField:function(e){var t={};if(t[this.config.relationsFieldName]=[{relationType:["name"]}],e){var i={};i[this.config.relatedEntityFieldName]=["id",{entityType:["name"]}],t[this.config.relationsFieldName].push(i)}return t},_fetchRelatedEntitiesInfo:function(t,i){var n=e.groupBy(t,e.bind(function(e){return e[this.config.relatedEntityFieldName].entityType.name},this)),a=this._buildRelatedEntitiesInfoRequests(n);e.parallel(a,e.bind(function(e,t){n=this._fillRelatedEntitiesInfo(n,t),i(this.transform(n))},this))},_buildRelatedEntitiesInfoRequests:function(t){return e.map(e.keys(t),function(i){return e.bind(function(n){this.config.store.find(i,{fields:this._getFieldsForRelatedEntityInfo(i),$query:{id:{$in:e.map(t[i],function(e){return e[this.config.relatedEntityFieldName].id},this)}}}).done({success:function(e){n(!1,e[0].data)}})},this)},this)},_fillRelatedEntitiesInfo:function(t,i){return t=e.reduce(i,function(t,i){return i.length>0&&(t[i[0].entityType.name]=e.reduce(i,function(t,i){var n=e.find(t,e.bind(function(e){return e[this.config.relatedEntityFieldName].id==i.id},this)),a=n[this.config.relatedEntityFieldName];return e.extend(a,i,{relatedEntityInfoIsFilled:!0}),t},t[i[0].entityType.name],this)),t},t,this)},_getFieldsForRelatedEntityInfo:function(t){t=t.toLowerCase();var i=a.findByKeyword(t),n=["id","name",{entityType:["name"]},{project:["abbreviation","color","name"]}];e.contains(i.simpleFields,"lastStatus")&&n.push("lastStatus");var r=function(e,t){if(i.refs.hasOwnProperty(e)){var a={};a[e]=t,n.push(a)}};return r("entityState",["name","isFinal"]),r("release",["name"]),r("iteration",["name"]),r("team",["name","icon"]),n},transform:function(t){var i=[],a=0,r=this.config.configurator.getUrlBuilder(),s=new n(this.config.context.getTerms());
return e.reduce(e.values(t),function(t,i){return e.forEach(i,function(i){var n=i[this.config.relatedEntityFieldName];if(n.relatedEntityInfoIsFilled){var o=e.extend(n.entityType,{term:s.getTerms(n.entityType.name).iconSmall});t.push({id:n.id,__type:n.__type,entityType:o,name:n.name,project:n.project,team:n.team,entityState:n.entityState,hasLastStatus:n.hasOwnProperty("lastStatus"),lastStatus:n.lastStatus,release:n.release?n.release.name:null,iteration:n.iteration?n.iteration.name:null,url:r.getNewViewUrl(n.id,n.entityType.name,!0),relation:{id:i.id,__type:i.__type,relationType:i.relationType}}),n.entityType.id>a&&(a=n.entityType.id)}},this),t},i,this),e.sortBy(i,function(e){return e.entityState&&e.entityState.isFinal?a+e.entityType.id:e.entityType.id})}})}),define("tau/models/relations/model.relations.data",["Underscore","jQuery","tau/core/model-base","tau/models/relations/model.relations.data.fetcher"],function(e,t,i,n){return i.extend({"bus beforeInit":function(e,t){var i=t.config;this.entityId=i.context.entity.id,this.store=i.store,this.entityTypeName=i.context.entity.entityType.name,this.masterFetcher=new n(i,"master"),this.slaveFetcher=new n(i,"slave"),this._fetch()},_fetch:function(){this.store.evictProperties(this.entityId,this.entityTypeName,["masterRelations","slaveRelations"]),t.when(this.masterFetcher.fetchRelatedEntities(),this.slaveFetcher.fetchRelatedEntities()).then(e.bind(function(e,t){var i={master:e,slave:t};this.fire("public.relationsReady",i)},this))},"bus relations.changed":function(){this._fetch()},"bus public.relationsReady:last + public.relation.filter.changed:last":function(e,t,i){this.fire("public.relationsReady.filtered",{master:this._filter(t.master,i),slave:this._filter(t.slave,i)})},_filter:function(t,i){return t=e.chain(t),i.relationType&&(t=t.filter(function(e){return e.relation.relationType.id===i.relationType.id})),i.entityType&&(t=t.filter(function(e){return e.entityType.id===i.entityType.id})),i.project&&(t=t.filter(function(e){return e.project?e.project.id===i.project.id:-1===i.project.id
})),i.team&&(t=t.filter(function(e){return e.team?e.team.id===i.team.id:-1===i.team.id})),t.value()}})}),define("tau/ui/extensions/list/relations/ui.extension.list.relations.refresher",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus afterInit:last + afterRender:last + public.relationsReady.filtered":function(i,n,a,r){var s=e.map(r[n.config.dependencyType],function(e){return e.relation.id});a.element.find("tr").each(function(){var i=t(this),n=parseInt(i.data("relation-id")),a=e.contains(s,n);a?i.show():i.hide()})},"bus public.relationsReady":function(){this.fire("refresh")}})}),define("tau/ui/templates/relations/ui.template.relations.denied",["tau/core/templates-factory"],function(e){var t={name:"relations.denied",engine:"jqote2",markup:['<div class="tau-denied-relations">','This entity has <b><%= this.count %></b>&nbsp;<%= this.relationType %> <%= this.count>1?"relations" : "relation" %> that you can&#39t see, as you do not have sufficient permissions. ',"<% if (this.blockersCount > 0) { %>",'<b class="tau-relations-blockers-count"><%= this.blockersCount %></b> of them <%= this.blockersCount>1?"are blockers" : "is a blocker" %>',"<% } %>","</div>"]};return e.register(t)}),define("tau/ui/extensions/relations/ui.extension.relations.denied",["Underscore","tau/core/class","tau/components/extensions/component.extension.base","tau/models/relations/model.relations.data.fetcher","tau/ui/templates/relations/ui.template.relations.denied"],function(e,t,i,n,a){var r=i.extend({blockerRelationTypeId:2,"bus initialize + beforeInit":function(e,t,i){var a=i.config;this.dependencyType=a.dependencyType,this.dataFetcher=new n(a,this.dependencyType),this.dataFetcher.fetchRelationCounts().done(function(e){this.fire("relation.counts.fetched",e[0].data)}.bind(this))},"bus public.relationsReady + relation.counts.fetched":function(e,t,i){i[this.dependencyType+"Relations-count"]!=t[this.dependencyType].length&&this.dataFetcher.fetchRelations().done(function(e){this.fire("relations.fetched",e[0].data)
}.bind(this))},"bus afterRender:last + difference.ready":function(e,t,i){var n=a.get().bind(null,this._getDataForTemplate(i));t.element.after(n),n.slideDown("fast")},"bus public.relationsReady + relations.fetched":function(t,i,n){var a=n[this._getDependencyTypePropertyName()],r=e.map(i[this.dependencyType],function(e){return e.relation.id}),s=e.chain(a).filter(function(t){return!e.contains(r,t.id)}).map(function(e){return{id:e.id,relationType:e.relationType.id}}).value();this.fire("difference.ready",s)},_getDependencyTypePropertyName:function(){return this.dependencyType.concat("Relations")},_getRelationTypeName:function(){return"master"==this.dependencyType?"inbound":"outbound"},_getDataForTemplate:function(t){return{relationType:this._getRelationTypeName(),count:t.length,blockersCount:e.filter(t,function(e){return e.relationType==this.blockerRelationTypeId}.bind(this)).length}}});return r}),define("tau/ui/extensions/list/relations/ui.extension.list.relations.remove",["tau/components/extensions/component.extension.base"],function(e){return e.extend({"bus afterRender":function(e){var t=e.data.element,i=this.config.store;t.on("click",".i-role-remove",function(e){var t=$(e.target).data("relationId");i.remove("relation",{id:t}).done()})}})}),define("tau/ui/extensions/ui.extension.help",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({name:"ui.extension.help",category:"view","bus afterRender":function(t){var i=t.data.view;t.data.element.find(".i-role-help").each(function(){var t=e(this),n=t.next(".i-role-help-content").detach().show();t.tauBubble({content:n,className:"tau-bubble-tooltip",zIndex:999,onShow:function(){i.config.context.configurator.getKeyBoardManager().pushHandler({})},onHide:function(){i.config.context.configurator.getKeyBoardManager().popHandler()}})})}})}),define("tau/ui/templates/list_/grid.entity.relations/ui.template.list.grid.entity.relations",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/relation/ui.template.list.grid.entity.row.relation"],function(e){var t={name:"list.grid.entity.relations",markup:["<div>",'<table class="tau-table">',"<tbody>","{{tmpl(items) $item.data.config.currentView.rowTemplateName}}","</tbody>","</table>","</div>"],dependencies:["list.grid.entity.row.relation"]};
return e.register(t)}),define("tau/components/component.relations.container",["Underscore","tau/components/component.container.with-shared-events","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator","tau/models/dataProviders/model.provider.items.relations","tau/models/relations/model.relations.data","tau/ui/extensions/list/relations/ui.extension.list.relations.refresher","tau/ui/extensions/relations/ui.extension.relations.observer","tau/ui/extensions/relations/ui.extension.relations.denied","tau/ui/extensions/list/relations/ui.extension.list.relations.remove","tau/ui/extensions/ui.extension.help","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/templates/list_/grid.entity.relations/ui.template.list.grid.entity.relations"],function(e,t,i,n,a,r,s,o,l,u,c,d,p){var f=function(e,t,i,n){var r=e+".relations.container";return{type:"container.with-shared-events",name:r,layout:"selectable",template:{name:r,markup:['<div class="tau-relations-item i-role-list-'+e+'">','<div class="tau-entity-caption">',"<h2>"+i+"</h2>",'<button type="button" tabindex="-1" class="tau-help i-role-help"></button>','<div class="tau-help-content i-role-help-content">'+n+"</div>",'<div class="tau-btn-wrap i-role-add-holder">','<span class="tau-txt">Add relation:</span>',"</div>","</div>",'<div class="tau-relations-cont i-role-list-holder" />',"</div>"]},extensions:[c],children:[{type:"relations.add.trigger",dependencyType:e,selector:".i-role-add-holder"},{name:e+" relations list",type:"list.editable",selector:".i-role-list-holder",itemsDataProvider:a,dependencyType:e,extensions:[l,s,u,d],views:[{rowTemplateName:"list.grid.entity.row.relation"}],template:p}]}};return{create:function(i){var n={template:{name:"relations.container",markup:['<div class="tau-relations"></div>']},extensions:[r,o],children:[{type:"relations.filter"},f("master","inbound","Inbound","The current entity depends on the inbound entities, so they should be completed <b>BEFORE</b> the current entity is started."),{type:"relations.connection",context:{entity:i.context.entity}},f("slave","outbound","Outbound","The outbound entities depend on the current entity, so they should be started <b>AFTER</b> the current entity is completed.")]};
return t.create(e.extend(i,n))}}}),define("tau/models/relations/model.relations.filter",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus public.relationsReady":function(e,t){this.fire("dataBind",{isInitiallyHidden:t.master.length+t.slave.length<2})},"bus public.relationsReady.filtered":function(t,i){var n=e.flatten([i.master,i.slave]);this._buildRelationTypes(n),this._buildEntityTypes(n),this._buildProjects(n),this._buildTeams(n)},_buildRelationTypes:function(e){var t=this._buildFilter(e,function(e){return e.relation.relationType});this.fire("relationTypes.ready",t)},_buildEntityTypes:function(e){var t=this._buildFilter(e,function(e){return e.entityType});this.fire("entityTypes.ready",t)},_buildProjects:function(t){var i=this._buildFilter(t,function(e){return e.project});i=e.chain(i).map(function(e){return e?e:{id:-1,color:"",abbreviation:"No Project",name:"No Project"}}).sortBy(function(e){return e.id}).value(),this.fire("projects.ready",i)},_buildTeams:function(t){var i=this._buildFilter(t,function(e){return e.team});i=e.chain(i).map(function(e){return e?e:{id:-1,name:"No Team"}}).sortBy(function(e){return e.id}).value(),this.fire("teams.ready",i)},_buildFilter:function(t,i){return e.chain(t).map(i).uniq(!1,function(e){return e?e.id:null}).value()}})}),define("tau/ui/templates/relations/ui.template.relations.filter",["tau/core/templates-factory"],function(e){var t={name:"relations-filter",engine:"jqote2",markup:['<div class="tau-filter-block" <% if (this.isInitiallyHidden) { %>style="display: none;"<% } %>>','<div class="tau-filter-row">','<div class="tau-filter"><span class="tau-filter-txt">Filter by</span></div>',"</div>",'<div class="tau-filter-row">','<div class="tau-filter"><div class="tau-filter-txt i-role-filter-relationType"></div></div>',"</div>",'<div class="tau-filter-row">','<div class="tau-filter"><div class="tau-filter-txt i-role-filter-entityType"></div></div>',"</div>",'<div class="tau-filter-row">','<div class="tau-filter"><div class="tau-filter-txt i-role-filter-project"></div></div>',"</div>",'<div class="tau-filter-row">','<div class="tau-filter"><div class="tau-filter-txt i-role-filter-team"></div></div>',"</div>","</div>"]};
return e.register(t)}),define("tau/ui/extensions/relations/relations.filter",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(e){this.configurator=e.configurator,this.$el=e.$el,this.outputTemplate=e.outputTemplate.get(),this.optionTemplate=e.optionTemplate.get(),this.callback=e.callback,this.placeholderText=e.placeholderText,this.selectedFilter=null,this.bubbleClass=e.bubbleClass},setFilterOptions:function(t){this.filterOptions=t,this.selectedFilter&&!e.findWhere(this.filterOptions,{id:this.selectedFilter.id})&&this._setSelectedFilter(null),this._renderSelectedFilter()},_renderOptionsList:function(){var i=this.optionTemplate;return e.reduce(this.filterOptions,e.bind(function(e,t){return e.append(i.bind({},this._getTemplateData(t,!0)))},this),t('<div class="drop-down-list tau-filter-drop-down-list"></div>'))},_getTemplateData:function(e,t){return{context:{isOption:t},value:e}},_renderBubble:function(){var e=this._renderOptionsList();this.$bubbled.tauBubble("option","content",e),this._attachList(e)},_attachList:function(t){var i={items:".drop-down-option",className:"drop-down-option_hover",keyboardManager:this.configurator.getKeyBoardManager(),onSelect:e.bind(this._applySelectedOption,this)};t.listSelectable(i).listSelectable("enable")},_attachBubble:function(t){t.tauBubble({className:this.bubbleClass,onPositionConfig:function(e){return e.my="center top",e.at="center bottom",e},onShow:e.bind(this._renderBubble,this)}),this.$bubbled=t},_renderSelectedFilter:function(){if(this.$el.empty(),this.selectedFilter){this.$el.append(this.outputTemplate.bind({},this._getTemplateData(this.selectedFilter,!1)));var i=t('<span class="tau-clear-filter i-role-reset" />');i.click(e.bind(function(){this._setSelectedFilter(null),this._renderSelectedFilter()},this)),this.$el.children().append(i)}else{var n=t('<span class="tau-filter-placeholder i-role-trigger"></span>');n.text(this.placeholderText),this.$el.append(n)}this._attachBubble(this.$el.find(".i-role-trigger"))
},_applySelectedOption:function(t){var i=t.data("option-id");this._setSelectedFilter(e.findWhere(this.filterOptions,{id:i})),this._renderSelectedFilter()},_setSelectedFilter:function(t){this.selectedFilter=t,e.defer(this.callback,t)}})}),define("tau/ui/templates/relations/filters/ui.template.relations.filter.relationType.option",["tau/core/templates-factory"],function(e){return e.register({name:"relations.filter.relationType.output",engine:"jqote2",markup:['<div class="drop-down-option i-role-option" data-option-id="<%! this.value.id %>">','<span class="tau-relation-icon tau-<%! this.value.name.toLowerCase() %>"/>','<span class="<% if (this.context.isOption) { %>tau-bubble-txt<% } else { %>property-text<% } %>">',"<%! this.value.name %>","</span>","</div>"]})}),define("tau/ui/templates/relations/filters/ui.template.relations.filter.entityType.option",["tau/core/templates-factory"],function(e){return e.register({name:"relations.filter.entityType.output",engine:"jqote2",markup:['<div class="drop-down-option i-role-option" data-option-id="<%! this.value.id %>">','<i class="tau-entity-icon tau-entity-icon--<%! this.value.name.toLowerCase() %>">','<%! fn.term(this.value.name, "iconSmall") %>',"</i>",'<span class="<% if (this.context.isOption) { %>tau-bubble-txt<% } else { %>property-text<% } %>">','<%! fn.term(this.value.name, "name") %>',"</span>","</div>"]})}),define("tau/ui/templates/relations/filters/ui.template.relations.filter.project.option",["tau/core/templates-factory"],function(e){return e.register({name:"relations.filter.project.option",engine:"jqote2",markup:['<div class="drop-down-option i-role-option" data-option-id="<%! this.value.id %>">','<i class="tau-icon tau-icon_type_color" style="background-color: <%! this.value.color || "transparent" %>"></i>','<span class="tau-bubble-txt"><%! this.value.name %></span>',"</div>"]})}),define("tau/ui/templates/relations/filters/ui.template.relations.filter.project.output",["tau/core/templates-factory"],function(e){return e.register({name:"relations.filter.project.output",engine:"jqote2",markup:["<div>",'<span class="tau-project-name" style="background-color: <%! this.value.color || "transparent" %>;"><%! this.value.abbreviation %></span>',"</div>"]})
}),define("tau/ui/templates/relations/filters/ui.template.relations.filter.team.option",["tau/core/templates-factory"],function(e){return e.register({name:"relations.filter.team.option",engine:"jqote2",markup:['<% var iconClass = ""; %>','<% if (this.value.id !== -1) { iconClass = "tau-icon_name_" + (this.value.icon || "trihead"); } %>','<div class="drop-down-option i-role-option" data-option-id="<%! this.value.id %>">','<i class="tau-icon tau-icon_type_svg <%= iconClass %>"></i>','<span class="tau-bubble-txt"><%! this.value.name %></span>',"</div>"]})}),define("tau/ui/templates/relations/filters/ui.template.relations.filter.team.output",["tau/core/templates-factory"],function(e){return e.register({name:"relations.filter.team.output",engine:"jqote2",markup:['<div class="drop-down-option i-role-option" data-option-id="<%! this.value.id %>">',"<% if (this.value.id !== -1) { %>",'<i class="tau-icon tau-icon_type_svg tau-icon_name_<%! this.value.icon || "trihead" %>"></i>',"<% } %>",'<span class="property-text"><%! this.value.name %></span>',"</div>"]})}),define("tau/ui/extensions/relations/ui.extension.relations.filter",["Underscore","jQuery","tau/components/extensions/component.extension.base","./relations.filter","tau/ui/templates/relations/filters/ui.template.relations.filter.relationType.option","tau/ui/templates/relations/filters/ui.template.relations.filter.entityType.option","tau/ui/templates/relations/filters/ui.template.relations.filter.project.option","tau/ui/templates/relations/filters/ui.template.relations.filter.project.output","tau/ui/templates/relations/filters/ui.template.relations.filter.team.option","tau/ui/templates/relations/filters/ui.template.relations.filter.team.output"],function(e,t,i,n,a,r,s,o,l,u){return i.extend({"bus beforeInit + afterRender":function(t,i,c){var d=e.bind(function(t,a,r,s,o){var l="i-role-filter-"+t;return new n({$el:c.element.find("."+l),outputTemplate:s||r,optionTemplate:r,configurator:i.config.context.configurator,callback:e.partial(e.bind(this.filterChanged,this),t),placeholderText:a,bubbleClass:(o||"")+" "+l})
},this),p={relationType:d("relationType","Relation Type",a),entityType:d("entityType","Entity Type",r),project:d("project","Project",s,o,"tau-bubble-project"),team:d("team","Team",l,u,"tau-bubble-team")};this.fire("filters.ready",p),this.filterDefinition={},this.fire("public.relation.filter.changed",this.filterDefinition)},"bus filters.ready:last + entityTypes.ready":function(e,t,i){t.entityType.setFilterOptions(i)},"bus filters.ready:last + projects.ready":function(e,t,i){t.project.setFilterOptions(i)},"bus filters.ready:last + relationTypes.ready":function(e,t,i){t.relationType.setFilterOptions(i)},"bus filters.ready:last + teams.ready":function(e,t,i){t.team.setFilterOptions(i)},"bus afterRender:last + public.relationsReady":function(e,t,i){var n=t.element;i.master.length+i.slave.length>=2?"none"===n.css("display").toLowerCase()&&n.slideDown():n.slideUp()},filterChanged:function(e,t){this.filterDefinition[e]=t,this.fire("public.relation.filter.changed",this.filterDefinition)}})}),define("tau/components/component.relations.filter",["Underscore","tau/components/component.creator","tau/models/relations/model.relations.filter","tau/ui/templates/relations/ui.template.relations.filter","tau/ui/extensions/relations/ui.extension.relations.filter"],function(e,t,i,n,a){return{create:function(e){var r={extensions:[i,a],template:n};return t.create(r,e)}}}),define("tau/models/model.release.progressBar",["Underscore","tau/models/model.iteration.progressBar"],function(e,t){var i=t.extend({name:"Iteration Progress Bar",_getDefaultFields:function(){return["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum",{features:["effortToDo","effortCompleted","userStories-count"]}]},onEntityRetrieved:function(t){var i=t.data,n=e.filter(i.features,function(e){return 0===e["userStories-count"]}),a=e.pluck(n,"effortToDo"),r=e.pluck(n,"effortCompleted"),s=i["bugs-effortToDo-sum"]+i["userStories-effortToDo-sum"]+e.sum(a),o=i["bugs-effortCompleted-sum"]+i["userStories-effortCompleted-sum"]+e.sum(r);
this.effortToDo=s,this.effortCompleted=o,this.calculatePercentCompleted()}});return i}),define("tau/components/component.release.assignedEffort",["tau/components/component.creator","tau/models/model.release.progressBar","tau/ui/templates/label/ui.template.assignmentEffort.label"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/components/component.release.progressBar",["tau/components/component.creator","tau/models/model.release.progressBar","tau/ui/templates/progressBar/ui.template.iteration.progressBar"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/models/model.releaseNotes",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(e,t,i){var n=t.extend({onInit:function(){var t=this.config.context.entity,n=this.config.store,a=this;n.unbind(this),n.on({eventName:"afterSave",type:"assignable",listener:this},function(t){var i=["entityState","name"],n=["feature","userstory","bug"];e.include(n,t.data.cmd.type.toLowerCase())&&e.intersection(e.keys(t.data.changes),i).length&&a.bus.fire("refresh")});var r=["feature","userstory","bug"];e.forEach(r,function(e){n.on({eventName:"afterRemove",type:e,listener:a},function(){a.bus.fire("refresh")})}),n.get("release",{id:t.id,fields:["id","name","startDate","endDate"]}).find("bugs",{fields:["id","name"],$query:{"Release.Id":t.id,"EntityState.isFinal":1},$orderBy:"id"}).find("features",{fields:["id","name",{release:["id"]},{entityState:["id","isFinal"]},{userStories:["id","name",{release:["id"]},{entityState:["id","isFinal"]}]}],$query:{"Release.Id":t.id},$orderBy:"id"}).find("userStories",{fields:["id","name",{release:["id"]},{feature:["id"]},{entityState:["id","isFinal"]}],$query:{"Release.Id":t.id,"EntityState.isFinal":1},$orderBy:"id"}).done({success:function(t){var n=t[2].data,r=[],s=e.pluck(n,"id");e.forEach(n,function(t){var i=[],n=[];e.forEach(t.userStories,function(e){e.release&&e.release.id===t.release.id&&(1==e.entityState.isFinal?i.push(e):n.push(e))
}),i.length>0?(t.userStories=i,r.push(t)):1==t.entityState.isFinal&&n.length>0&&n.length==t.userStories.length&&(t.userStories=[],r.push(t))});var o=t[0].data;o.endDate=i.format.date.short(o.endDate);var l=t[1].data,u=t[3].data;u=e.filter(u,function(t){return!t.feature||!t.feature.id||-1==e.indexOf(s,t.feature.id)}),a.bus.fire("dataBind",{item:o,features:r,bugs:l,userStories:u})}})}});return n}),define("tau/ui/templates/releaseNotes/ui.template.releaseNotes",["tau/core/templates-factory"],function(e){var t={name:"releaseNotes",markup:['<div class="tau-releaseNotes">','<div class="tau-releaseNotes__inner">','<span class="tau-releaseNotes__title">${item.name} / ${item.endDate}</span><br />',"----------------------------------------------------------<br /><br />","{{if features.length || userStories.length}}",'<div class="tau-releaseNotes__subtitle">Added features</div><br /><br />',"{{each features}}",'<div class="tau-releaseNotes__feature" data-name="${name}">',"- ${name}<br />","{{each userStories}}",'<div class="tau-releaseNotes__userstory" data-name="${name}">',"&nbsp;&nbsp;&nbsp;&nbsp;- ${name}<br />","</div>","{{/each}}","</div>","{{/each}}","{{each userStories}}",'<div class="tau-releaseNotes__userstory tau-releaseNotes__userstory_separate_true" data-name="${name}">',"- ${name}<br />","</div>","{{/each}}","<br /><br />","{{/if}}","{{if bugs.length}}",'<div class="tau-releaseNotes__subtitle">Fixed Bugs</div><br /><br />',"{{each bugs}}",'<div class="tau-releaseNotes__bug" data-name="${name}">',"#${id} ${name}<br />","</div>","{{/each}}","{{/if}}","</div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.releaseNotes",["tau/components/component.creator","tau/models/model.releaseNotes","tau/ui/templates/releaseNotes/ui.template.releaseNotes"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("tau/components/extensions/requestsList/extension.requestList.refresher",["tau/components/extensions/component.extension.base"],function(e){return e.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("requestWasAttachedToEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().on("requestIsDetachedFromEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)
},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().removeListener("requestIsDetachedFromEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refreshComponentIfEntityFromCurrentContext:function(e){this.isEntityInContext(e)&&this.refresh()},onRequestsUpdates:function(e){this.refreshComponentIfEntityFromCurrentContext(e)},onBugWasMarkedAsDuplicate:function(e){var t=this.config.context.entity.id;t===e.data.bugId&&this.refresh()},refresh:function(){this.fire("evictProperty"),this.fire("refresh")}})}),define("tau/components/extensions/requestsList/extension.requestList.actions.detach",["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit","bus dataBind+afterRender":function(t){var i=this,n=t.dataBind.data,a=t.afterRender.data.element;if(n.items&&n.items.length){var r=e('<td class="action"></td>'),s=e('<span class="action-detach button small">Detach</span>');s.click(e.proxy(i.onActionDetach,i)),r.append(s);var o=a.find("table.base-info-list tbody > tr");o.append(r)}},onActionDetach:function(t){var i=this,n=i.config.context.entity.id,a=e(t.target).parent().parent().data().tmplItem.data.id,r=i.config.context.configurator.getActionsService();r.detachRequest({generalId:n,requestId:a,success:e.proxy(i.onRequestDetachedSuccess,i)})},onRequestDetachedSuccess:function(){var e=this;e.fire("evictProperty");var t=e.config.context.entity.id;e.fire("requestIsDetachedFromEntity",{entity:{id:t}})}})}),define("tau/components/component.requestList",["tau/components/component.list.baseInfo","tau/components/extensions/requestsList/extension.requestList.refresher","tau/components/extensions/requestsList/extension.requestList.actions.detach"],function(e,t,i){return{create:function(n){var a={extensions:[t,i]};return n.typeName="request",n.propertyName="requests",e.create(n,a)
}}}),define("tau/models/model.revisionList",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(e,t,i){return t.extend({retrieveRevisions:function(e){for(var t=this.store,i=["id","sourceControlId","description","commitDate",{author:["firstName","lastName"]},{revisionFiles:["id","fileName","fileAction"]}],n=0;n<e.length;n++)t=t.get(e[n].type,{id:e[n].id,nested:!0,fields:["id",{revisions:i}]});t.done({success:this.onRevisionsRetrieved,scope:this})},onInit:function(){var e=this,t=e.config.context.entity,i=t.entityType.name,n=t.id,a=[{type:i,id:n}],r=this.store;"userstory"==i.toLowerCase()?r.get(i,{id:n,fields:[{tasks:["id"]}]}).done({success:this.onTasksIdRetrieved,scope:this}):this.retrieveRevisions(a)},onTasksIdRetrieved:function(t){var i=t[0].data,n=[{type:i.__type,id:i.id}];n=n.concat(e.map(i.tasks,function(e){return{id:e.id,type:e.__type}})),this.retrieveRevisions(n)},onRevisionsRetrieved:function(t){var i=e.pluck(t,"data");i=e.pluck(i,"revisions"),i=e.flatten(i),this.bindRevisions(i)},bindRevisions:function(t){var n={Add:"Added",Delete:"Deleted",Modify:"Modified"};t=e.sortBy(t,function(e){return-e.id}),this.fire("dataBind",{items:e.map(t,function(t){var a=t.author||{firstName:"unknown",lastName:""},r=e.trim([a.firstName,a.lastName].join(" ")),s={commitDate:i.format.datetime.short(i.convertToTimezone(t.commitDate)),author:r,revisionFiles:e.map(t.revisionFiles,function(t){return e.extend(e.clone(t),{fileAction:n[t.fileAction]||t.fileAction})})};return e.extend(e.clone(t),s)})})},onEntityRetrieved:function(e){var t=e.data.revisions;this.bindRevisions(t)},"bus evictTestCases":function(){var e=this.config.context.entity;this.store.evictProperties(e.id,e.entityType.name,["testCases","testCases-count"])}})}),define("tau/ui/extensions/testCaseList/ui.extension.testCaseList",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender":function(e){var t=this;t.element=e.data.element,t.element.find("tbody .extra-info").click(function(){t._onButtonClick.call(t,this)
}),t.element.find("thead .extra-info.expand").click(function(){t.expandAll()}),t.element.find("thead .extra-info.collapse").click(function(){t.collapseAll()})},"bus expandTestCase":function(e){var i=e.data.testCaseId;this.element.find("tbody.collapsed").each(function(){t(this).tmplItem().data.id==i&&t(this).removeClass("collapsed").find(".extra-info").removeClass("expand").addClass("collapse")})},expandAll:function(){this.element.find("tbody.collapsed").removeClass("collapsed"),this._changeButtonsState("expand","collapse","-")},collapseAll:function(){this.element.find("tbody:not(.collapsed)").addClass("collapsed"),this._changeButtonsState("collapse","expand","+")},_changeButtonsState:function(e,i,n){var a="tbody .extra-info."+e,r=function(){t(this).addClass(i).removeClass(e).children("div").text(n)};this.element.find(a).each(r)},_onButtonClick:function(e){t(e).toggleClass("collapse").toggleClass("expand").parents("tbody").toggleClass("collapsed");var i=t(e).children("div"),n=i.text();n="+"==n?"-":"+",i.text(n)}})}),define("tau/ui/templates/common/ui.template.entityLink",["tau/core/templates-factory","tau/ui/tags/ui.tag.term"],function(e,t){var i={tags:[t],name:"entity-link",markup:['<a href="${url}" class="ui-link-entity">','<em class="tau-entity-icon tau-entity-icon--${__type.toLowerCase()}">${id}</em>',"</a>&nbsp;&nbsp;"],dependencies:[]};return e.register(i)}),define("tau/ui/templates/revisionList/ui.template.revisionList.files",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(e){var t={name:"revision-list-files",markup:["<tr>",'   <td class="actions"><span>${fileAction}</span></td>','   <td class="diff"></td>','   <td class="files"><a target="_blank" class="vcsViewDisabled" disabled="disabled">${fileName}</a></td>',"</tr>"].join(""),dependencies:["entity-link"]};return e.register(t)}),define("tau/ui/templates/revisionList/ui.template.revisionList.revision",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink","tau/ui/templates/revisionList/ui.template.revisionList.files"],function(e){var t={name:"revision-list-revision",markup:['<tbody class="collapsed">','   <tr class="first-row">','       <td class="toggler"><button class="extra-info expand" type="button"><div>+</div></button></td>','       <td class="revision-id">#&nbsp;${sourceControlId}</td>','       <td class="revision">${commitDate}&nbsp;by&nbsp;<span class="author">${author}</span></td>','       <td class="revision-comment">${description}</td>',"   </tr>",'   <tr class="revision-files second-row">',"       <td></td>",'       <td colspan="3">',"           <table>",'           {{tmpl(revisionFiles) "revision-list-files"}}',"           </table>","       </td>","   </tr>","</tbody>"].join(""),dependencies:["entity-link"]};
return e.register(t)}),define("tau/ui/templates/revisionList/ui.template.revisionList",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/revisionList/ui.template.revisionList.revision"],function(e,t){var i={name:"revision-list",options:{contentSelector:".ui-revisionList-content"},tags:[t],markup:['<div class="ui-revisionList">','   <div class="ui-revisionList-content"{{if items.length === 0}} style="display:none"{{/if}}>','       <table class="ui-revisionList">',"           <colgroup>",'               <col class="toggler">','               <col class="revision-id">','               <col class="revision">','               <col class="comment">',"           </colgroup>","           <thead>","               <tr>",'                   <th class="toggler"></th>','                   <th class="revision-id"></th>','                   <th class="revision"></th>','                   <th class="comment"></th>',"               </tr>","           </thead>",'           {{tmpl(items) "revision-list-revision"}}',"       </table>","   </div>","</div>"].join(""),dependencies:["revision-list-revision"]};return e.register(i)}),define("tp/plugins/pluginsRepository",["app.path","tp/gateway","jQuery"],function(e,t,i){function n(){this._ctor()}var a=e.get();return n.prototype={_requestUrlBase:"/api/v1/Plugins.asmx",_registeredPlugins:null,_waitingForPluginsCallbacks:null,_ctor:function(){this.gateway=t},_getUrl:function(){var e=a+this._requestUrlBase;return e},pluginsRetrieved:function(e){this._registeredPlugins=e;for(var t=0;t<this._waitingForPluginsCallbacks.length;t++)this._waitingForPluginsCallbacks[t](this._registeredPlugins)},getStartedPlugins:function(e){this._registeredPlugins||this._waitingForPluginsCallbacks?!this._registeredPlugins&&this._waitingForPluginsCallbacks?this._waitingForPluginsCallbacks.push(e):this._registeredPlugins&&e(this._registeredPlugins):(this._waitingForPluginsCallbacks=[e],this.gateway.postJSON(this._getUrl(),{},i.proxy(this.pluginsRetrieved,this)))
},pluginStartedAndHasAtLeastOneProfile:function(e,t,n){this.getStartedPlugins(i.proxy(function(a){var r=i.grep(a,function(t){var n=i.grep(t.plugins,function(t){return t.name==e});if(0===n.length)return!1;var a=!1;return i(n).each(function(e,t){t.profiles.length>0&&(a=!0)}),a});r.length>0?t():n&&n()},this))}},new n}),define("tp/bus",["jQuery"],function(){var e=function(){var e={},t=function(t,i,n){var a=t||!1,r=i||[];if(a)for(var s in e)if("function"==typeof e[s]["on"+a])try{var o=n||e[s];e[s]["on"+a].apply(o,r)}catch(l){}},i=function(t,i,a){if(t in e){if(!a)throw new Error("Mediator name conflict: "+t);n(t)}e[t]=i},n=function(t){t in e&&delete e[t]};return{name:"Bus",publish:t,subscribe:i,unsubscribe:n}};return e()}),define("tp/plugins/profileNameSource",["tp/bus","app.path","jQuery","tp/mashups"],function(e,t){function i(e){this._create(e)}return i.prototype={_create:function(){this.bus=e,this.bus.subscribe("ProfileNameSource",{onProfileSaveSucceed:$.proxy(function(e){this.setProfileName(e.Name)},this)},!0)},getPluginName:function(){return new t.tp.URL(location.href).getArgumentValue("PluginName")},getProfileNameKey:function(){return"ProfileName"},getProfileName:function(){var e=new t.tp.URL(location.href),i=e.getArgumentValue(this.getProfileNameKey());if(!i){var n=e.getReference();n&&(i=n.substr(1))}return i},setProfileName:function(e){this.getProfileName()||(window.location=window.location+"#"+e)}},new i}),define("tp/plugins/commandGateway",["jQuery","tp/plugins/profileNameSource","tp/gateway","app.path"],function(e,t,i,n){function a(e){this._create(e)}return a.prototype={_requestUrlBase:"/api/v1/Plugins.asmx/{PluginName}/Commands/{CommandName}",_requestForProfileUrlBase:"/api/v1/Plugins.asmx/{PluginName}/Profiles/{ProfileName}/Commands/{CommandName}",_pluginName:null,_create:function(e){this.profileNameSource=t,this.gateway=i,this._pluginName=e&&e.pluginName?e.pluginName:this.profileNameSource.getPluginName()},_getUrl:function(e){var t=this._requestUrlBase.replace(/{PluginName}/g,this._pluginName).replace(/{CommandName}/g,e);
return new n.tp.WebServiceURL(t).url},_getUrlForProfile:function(e,t){var i=this._requestForProfileUrlBase.replace(/{PluginName}/g,this._pluginName).replace(/{ProfileName}/g,t||this.profileNameSource.getProfileName()).replace(/{CommandName}/g,e);return new n.tp.WebServiceURL(i).url},_post:function(e,t,i,n,a){this.gateway.postJSON(e,t,function(e){i&&i(e)},function(e){n&&n(e.responseText)},function(e){a&&a(e.responseText)})},execute:function(e,t,i,n,a){this._post(this._getUrl(e),t,i,n,a)},executeForProfile:function(e,t,i,n,a){this._post(this._getUrlForProfile(e),t,i,n,a)},executeForSpecificProfile:function(e,t,i,n,a,r){this._post(this._getUrlForProfile(t,e),i,n,a,r)}},a}),define("tp/popup",["jQuery"],function(e){e.widget("ui.popup",e.ui.dialog,{options:{modal:!0,position:"center",draggable:!1,resizable:!1,fitToWindow:!0,horizontalPadding:20,verticalPadding:20},_create:function(){this._super();var t=e.proxy(this._resize,this),i=e.proxy(this.close,this);this.element.off("popupopen popupclose popupresize"),this.element.bind("popupopen",function(){e(window).bind("resize",t),e(".ui-widget-overlay").click(i)}),this.element.bind("popupclose",function(){e(window).unbind("resize",t),e("ui-widget-overlay").unbind("click",i)});var n=this;this.element.bind("popupresize",function(){n.uiDialog.width()<n.options.minWidth&&n.uiDialog.width(n.options.minWidth),n.element.width()!=n.uiDialog.width()&&n.element.width(n.uiDialog.width())})},_init:function(){this._super();var e=this.element.parent();e.addClass("tau-dialog-container"),this.options.parentClassName&&e.addClass(this.options.parentClassName),this._resize()},open:function(){this._super(),this._resize()},_title:function(e){e.html(this.options.title||"&#160;")},_resize:function(){if(this.options.fitToWindow){var t=e(window).width(),i=Math.max(this.options.minWidth,t-2*this.options.horizontalPadding);this.uiDialog.width(i),this.element.width(i);var n=e(window).height(),a=Math.max(this.options.minHeight,n-2*this.options.verticalPadding);
this.uiDialog.height(a),this.element.height(a-this.uiDialog.find(".ui-dialog-titlebar").outerHeight(!1))}this._setOption("position",this._getOffset()),this._trigger("resize")},_getOffset:function(){var t=e("body"),i=t.width(),n=t.height(),a=(i-this.element.width())/2,r=Math.max((n-this.element.height())/2,50);return{top:r,left:a}}})}),define("tp/codemirror/mode/diff/diff",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("diff",function(){return{token:function(e){var t=e.next();return e.skipToEnd(),"+"==t?"plus":"-"==t?"minus":"@"==t?"rangeinfo":void 0}}}),e.defineMIME("text/x-diff","diff")}),define("tp/codemirror/mode/clike/clike",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("clike",function(e,t){function i(e,t){var i=e.next();if(f[i]){var r=f[i](e,t);if(r!==!1)return r}if('"'==i||"'"==i)return t.tokenize=n(i),t.tokenize(e,t);if(/[\[\]{}\(\),;\:\.]/.test(i))return l=i,null;if(/\d/.test(i))return e.eatWhile(/[\w\.]/),"number";if("/"==i){if(e.eat("*"))return t.tokenize=a,a(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(h.test(i))return e.eatWhile(h),"operator";e.eatWhile(/[\w\$_]/);var s=e.current();return c.propertyIsEnumerable(s)?(d.propertyIsEnumerable(s)&&(l="newstatement"),"keyword"):p.propertyIsEnumerable(s)?"atom":"word"}function n(e){return function(t,n){for(var a,r=!1,s=!1;null!=(a=t.next());){if(a==e&&!r){s=!0;break}r=!r&&"\\"==a}return(s||!r&&!m)&&(n.tokenize=i),"string"}}function a(e,t){for(var n,a=!1;n=e.next();){if("/"==n&&a){t.tokenize=i;break}a="*"==n}return"comment"}function r(e,t,i,n,a){this.indented=e,this.column=t,this.type=i,this.align=n,this.prev=a}function s(e,t,i){return e.context=new r(e.indented,t,i,null,e.context)}function o(e){var t=e.context.type;return(")"==t||"]"==t||"}"==t)&&(e.indented=e.context.indented),e.context=e.context.prev}var l,u=e.indentUnit,c=t.keywords||{},d=t.blockKeywords||{},p=t.atoms||{},f=t.hooks||{},m=t.multiLineStrings,h=/[+\-*&%=<>!?|\/]/;return{startState:function(e){return{tokenize:null,context:new r((e||0)-u,0,"top",!1),indented:0,startOfLine:!0}
},token:function(e,t){var n=t.context;if(e.sol()&&(null==n.align&&(n.align=!1),t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return null;l=null;var a=(t.tokenize||i)(e,t);if("comment"==a||"meta"==a)return a;if(null==n.align&&(n.align=!0),";"!=l&&":"!=l||"statement"!=n.type)if("{"==l)s(t,e.column(),"}");else if("["==l)s(t,e.column(),"]");else if("("==l)s(t,e.column(),")");else if("}"==l){for(;"statement"==n.type;)n=o(t);for("}"==n.type&&(n=o(t));"statement"==n.type;)n=o(t)}else l==n.type?o(t):("}"==n.type||"top"==n.type||"statement"==n.type&&"newstatement"==l)&&s(t,e.column(),"statement");else o(t);return t.startOfLine=!1,a},indent:function(e,t){if(e.tokenize!=i&&null!=e.tokenize)return 0;var n=t&&t.charAt(0),a=e.context,r=n==a.type;return"statement"==a.type?a.indented+("{"==n?0:u):a.align?a.column+(r?0:1):a.indented+(r?0:u)},electricChars:"{}"}}),function(){function t(e){for(var t={},i=e.split(" "),n=0;n<i.length;++n)t[i[n]]=!0;return t}function i(e,t){return t.startOfLine?(e.skipToEnd(),"meta"):!1}function n(e,t){for(var i;null!=(i=e.next());)if('"'==i&&!e.eat('"')){t.tokenize=null;break}return"string"}var a="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";e.defineMIME("text/x-csrc",{name:"clike",keywords:t(a),blockKeywords:t("case do else for if switch while struct"),atoms:t("null"),hooks:{"#":i}}),e.defineMIME("text/x-c++src",{name:"clike",keywords:t(a+" asm dynamic_cast namespace reinterpret_cast try bool explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected wchar_t"),blockKeywords:t("catch class do else finally for if struct switch try while"),atoms:t("true false null"),hooks:{"#":i}}),e.defineMIME("text/x-java",{name:"clike",keywords:t("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:t("catch class do else finally for if switch try while"),atoms:t("true false null"),hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"
}}}),e.defineMIME("text/x-csharp",{name:"clike",keywords:t("abstract as base bool break byte case catch char checked class const continue decimal default delegate do double else enum event explicit extern finally fixed float for foreach goto if implicit in int interface internal is lock long namespace new object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw try typeof uint ulong unchecked unsafe ushort using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:t("catch class do else finally for foreach if struct switch try while"),atoms:t("true false null"),hooks:{"@":function(e,t){return e.eat('"')?(t.tokenize=n,n(e,t)):(e.eatWhile(/[\w\$_]/),"meta")}}}),e.defineMIME("text/x-groovy",{name:"clike",keywords:t("abstract as assert boolean break byte case catch char class const continue def default do double else enum extends final finally float for goto if implements import in instanceof int interface long native new package property private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),atoms:t("true false null"),hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"}}})}()}),define("tp/codemirror/mode/css/css",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("css",function(e){function t(e,t){return s=t,e}function i(e,i){var s=e.next();return"@"==s?(e.eatWhile(/[\w\\\-]/),t("meta",e.current())):"/"==s&&e.eat("*")?(i.tokenize=n,n(e,i)):"<"==s&&e.eat("!")?(i.tokenize=a,a(e,i)):"="!=s?"~"!=s&&"|"!=s||!e.eat("=")?'"'==s||"'"==s?(i.tokenize=r(s),i.tokenize(e,i)):"#"==s?(e.eatWhile(/[\w\\\-]/),t("atom","hash")):"!"==s?(e.match(/^\s*\w*/),t("keyword","important")):/\d/.test(s)?(e.eatWhile(/[\w.%]/),t("number","unit")):/[,.+>*\/]/.test(s)?t(null,"select-op"):/[;{}:\[\]]/.test(s)?t(null,s):(e.eatWhile(/[\w\\\-]/),t("variable","variable")):t(null,"compare"):void t(null,"compare")
}function n(e,n){for(var a,r=!1;null!=(a=e.next());){if(r&&"/"==a){n.tokenize=i;break}r="*"==a}return t("comment","comment")}function a(e,n){for(var a,r=0;null!=(a=e.next());){if(r>=2&&">"==a){n.tokenize=i;break}r="-"==a?r+1:0}return t("comment","comment")}function r(e){return function(n,a){for(var r,s=!1;null!=(r=n.next())&&(r!=e||s);)s=!s&&"\\"==r;return s||(a.tokenize=i),t("string","string")}}var s,o=e.indentUnit;return{startState:function(e){return{tokenize:i,baseIndent:e||0,stack:[]}},token:function(e,t){if(e.eatSpace())return null;var i=t.tokenize(e,t),n=t.stack[t.stack.length-1];return"hash"==s&&"rule"==n?i="atom":"variable"==i&&("rule"==n?i="number":n&&"@media{"!=n||(i="tag")),"rule"==n&&/^[\{\};]$/.test(s)&&t.stack.pop(),"{"==s?"@media"==n?t.stack[t.stack.length-1]="@media{":t.stack.push("{"):"}"==s?t.stack.pop():"@media"==s?t.stack.push("@media"):"{"==n&&"comment"!=s&&t.stack.push("rule"),i},indent:function(e,t){var i=e.stack.length;return/^\}/.test(t)&&(i-="rule"==e.stack[e.stack.length-1]?2:1),e.baseIndent+i*o},electricChars:"}"}}),e.defineMIME("text/css","css")}),define("tp/codemirror/mode/htmlmixed/htmlmixed",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("htmlmixed",function(t){function i(e,t){var i=s.token(e,t.htmlState);return"tag"==i&&">"==e.current()&&t.htmlState.context&&(/^script$/i.test(t.htmlState.context.tagName)?(t.token=a,t.localState=o.startState(s.indent(t.htmlState,"")),t.mode="javascript"):/^style$/i.test(t.htmlState.context.tagName)&&(t.token=r,t.localState=l.startState(s.indent(t.htmlState,"")),t.mode="css")),i}function n(e,t,i){var n=e.current(),a=n.search(t);return a>-1&&e.backUp(n.length-a),i}function a(e,t){return e.match(/^<\/\s*script\s*>/i,!1)?(t.token=i,t.curState=null,t.mode="html",i(e,t)):n(e,/<\/\s*script\s*>/,o.token(e,t.localState))}function r(e,t){return e.match(/^<\/\s*style\s*>/i,!1)?(t.token=i,t.localState=null,t.mode="html",i(e,t)):n(e,/<\/\s*style\s*>/,l.token(e,t.localState))}var s=e.getMode(t,{name:"xml",htmlMode:!0}),o=e.getMode(t,"javascript"),l=e.getMode(t,"css");
return{startState:function(){var e=s.startState();return{token:i,localState:null,mode:"html",htmlState:e}},copyState:function(t){if(t.localState)var i=e.copyState(t.token==r?l:o,t.localState);return{token:t.token,localState:i,mode:t.mode,htmlState:e.copyState(s,t.htmlState)}},token:function(e,t){return t.token(e,t)},indent:function(e,t){return e.token==i||/^\s*<\//.test(t)?s.indent(e.htmlState,t):e.token==a?o.indent(e.localState,t):l.indent(e.localState,t)},compareStates:function(e,t){return s.compareStates(e.htmlState,t.htmlState)},electricChars:"/{}:"}}),e.defineMIME("text/html","htmlmixed")}),define("tp/codemirror/mode/javascript/javascript",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("javascript",function(e,t){function i(e,t,i){return t.tokenize=i,i(e,t)}function n(e,t){for(var i,n=!1;null!=(i=e.next());){if(i==t&&!n)return!1;n=!n&&"\\"==i}return n}function a(e,t,i){return j=e,L=i,t}function r(e,t){var r=e.next();if('"'==r||"'"==r)return i(e,t,s(r));if(/[\[\]{}\(\),;\:\.]/.test(r))return a(r);if("0"==r&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),a("number","number");if(/\d/.test(r))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),a("number","number");if("/"==r)return e.eat("*")?i(e,t,o):e.eat("/")?(e.skipToEnd(),a("comment","comment")):t.reAllowed?(n(e,"/"),e.eatWhile(/[gimy]/),a("regexp","string")):(e.eatWhile($),a("operator",null,e.current()));if("#"==r)return e.skipToEnd(),a("error","error");if($.test(r))return e.eatWhile($),a("operator",null,e.current());e.eatWhile(/[\w\$_]/);var l=e.current(),u=O.propertyIsEnumerable(l)&&O[l];return u?a(u.type,u.style,l):a("variable","variable",l)}function s(e){return function(t,i){return n(t,e)||(i.tokenize=r),a("string","string")}}function o(e,t){for(var i,n=!1;i=e.next();){if("/"==i&&n){t.tokenize=r;break}n="*"==i}return a("comment","comment")}function l(e,t,i,n,a,r){this.indented=e,this.column=t,this.type=i,this.prev=a,this.info=r,null!=n&&(this.align=n)}function u(e,t){for(var i=e.localVars;i;i=i.next)if(i.name==t)return!0
}function c(e,t,i,n,a){var r=e.cc;for(q.state=e,q.stream=a,q.marked=null,q.cc=r,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);;){var s=r.length?r.pop():B?_:y;if(s(i,n)){for(;r.length&&r[r.length-1].lex;)r.pop()();return q.marked?q.marked:"variable"==i&&u(e,n)?"variable-2":t}}}function d(){for(var e=arguments.length-1;e>=0;e--)q.cc.push(arguments[e])}function p(){return d.apply(null,arguments),!0}function f(e){var t=q.state;if(t.context){q.marked="def";for(var i=t.localVars;i;i=i.next)if(i.name==e)return;t.localVars={name:e,next:t.localVars}}}function m(){q.state.context||(q.state.localVars=H),q.state.context={prev:q.state.context,vars:q.state.localVars}}function h(){q.state.localVars=q.state.context.vars,q.state.context=q.state.context.prev}function g(e,t){var i=function(){var i=q.state;i.lexical=new l(i.indented,q.stream.column(),e,null,i.lexical,t)};return i.lex=!0,i}function v(){var e=q.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function b(e){return function(t){return t==e?p():";"==e?d():p(arguments.callee)}}function y(e){return"var"==e?p(g("vardef"),D,b(";"),v):"keyword a"==e?p(g("form"),_,y,v):"keyword b"==e?p(g("form"),y,v):"{"==e?p(g("}"),I,v):";"==e?p():"function"==e?p(M):"for"==e?p(g("form"),b("("),g(")"),E,b(")"),v,y,v):"variable"==e?p(g("stat"),C):"switch"==e?p(g("form"),_,g("}","switch"),b("{"),I,v,v):"case"==e?p(_,b(":")):"default"==e?p(b(":")):"catch"==e?p(g("form"),m,b("("),N,b(")"),y,v,h):d(g("stat"),_,b(";"),v)}function _(e){return z.hasOwnProperty(e)?p(w):"function"==e?p(M):"keyword c"==e?p(x):"("==e?p(g(")"),_,b(")"),v,w):"operator"==e?p(_):"["==e?p(g("]"),k(_,"]"),v,w):"{"==e?p(g("}"),k(T,"}"),v,w):p()}function x(e){return e.match(/[;\}\)\],]/)?d():d(_)}function w(e,t){if("operator"==e&&/\+\+|--/.test(t))return p(w);if("operator"==e)return p(_);if(";"!=e)return"("==e?p(g(")"),k(_,")"),v,w):"."==e?p(S,w):"["==e?p(g("]"),_,b("]"),v,w):void 0}function C(e){return":"==e?p(v,y):d(w,b(";"),v)
}function S(e){return"variable"==e?(q.marked="property",p()):void 0}function T(e){return"variable"==e&&(q.marked="property"),z.hasOwnProperty(e)?p(b(":"),_):void 0}function k(e,t){function i(n){return","==n?p(e,i):n==t?p():p(b(t))}return function(n){return n==t?p():d(e,i)}}function I(e){return"}"==e?p():d(y,I)}function D(e,t){return"variable"==e?(f(t),p(P)):p()}function P(e,t){return"="==t?p(_,P):","==e?p(D):void 0}function E(e){return"var"==e?p(D,A):";"==e?d(A):"variable"==e?p(R):d(A)}function R(e,t){return"in"==t?p(_):p(w,A)}function A(e,t){return";"==e?p(F):"in"==t?p(_):p(_,b(";"),F)}function F(e){")"!=e&&p(_)}function M(e,t){return"variable"==e?(f(t),p(M)):"("==e?p(g(")"),m,k(N,")"),v,y,h):void 0}function N(e,t){return"variable"==e?(f(t),p()):void 0}var j,L,U=e.indentUnit,B=t.json,O=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),i=e("keyword b"),n=e("keyword c"),a=e("operator"),r={type:"atom",style:"atom"};return{"if":t,"while":t,"with":t,"else":i,"do":i,"try":i,"finally":i,"return":n,"break":n,"continue":n,"new":n,"delete":n,"throw":n,"var":e("var"),"const":e("var"),let:e("var"),"function":e("function"),"catch":e("catch"),"for":e("for"),"switch":e("switch"),"case":e("case"),"default":e("default"),"in":a,"typeof":a,"instanceof":a,"true":r,"false":r,"null":r,undefined:r,NaN:r,Infinity:r}}(),$=/[+\-*&%=<>!?|]/,z={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},q={state:null,column:null,marked:null,cc:null},H={name:"this",next:{name:"arguments"}};return v.lex=!0,{startState:function(e){return{tokenize:r,reAllowed:!0,cc:[],lexical:new l((e||0)-U,0,"block",!1),localVars:null,context:null,indented:0}},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation()),e.eatSpace())return null;var i=t.tokenize(e,t);return"comment"==j?i:(t.reAllowed="operator"==j||"keyword c"==j||j.match(/^[\[{}\(,;:]$/),c(t,i,j,L,e))},indent:function(e,t){if(e.tokenize!=r)return 0;var i=t&&t.charAt(0),n=e.lexical,a=n.type,s=i==a;
return"vardef"==a?n.indented+4:"form"==a&&"{"==i?n.indented:"stat"==a||"form"==a?n.indented+U:"switch"!=n.info||s?n.align?n.column+(s?0:1):n.indented+(s?0:U):n.indented+(/^(?:case|default)\b/.test(t)?U:2*U)},electricChars:":{}"}}),e.defineMIME("text/javascript","javascript"),e.defineMIME("application/json",{name:"javascript",json:!0})}),define("tp/codemirror/mode/perl/perl",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("perl",function(){function e(e,t,n,a,r){return t.chain=null,t.style=null,t.tail=null,t.tokenize=function(e,t){for(var s,o=!1,l=0;s=e.next();){if(s===n[l]&&!o)return void 0!==n[++l]?(t.chain=n[l],t.style=a,t.tail=r):r&&e.eatWhile(r),t.tokenize=i,a;o=!o&&"\\"==s}return a},t.tokenize(e,t)}function t(e,t,n){return t.tokenize=function(e,t){return e.string==n&&(t.tokenize=i),e.skipToEnd(),"string"},t.tokenize(e,t)}function i(i,s){if(i.eatSpace())return null;if(s.chain)return e(i,s,s.chain,s.style,s.tail);if(i.match(/^\-?[\d\.]/,!1)&&i.match(/^(\-?(\d*\.\d+(e[+-]?\d+)?|\d+\.\d*)|0x[\da-fA-F]+|0b[01]+|\d+(e[+-]?\d+)?)/))return"number";if(i.match(/^<<(?=\w)/))return i.eatWhile(/\w/),t(i,s,i.current().substr(2));if(i.sol()&&i.match(/^\=item(?!\w)/))return t(i,s,"=cut");var o=i.next();if('"'==o||"'"==o){if(i.prefix(3)=="<<"+o){var l=i.pos;i.eatWhile(/\w/);var u=i.current().substr(1);if(u&&i.eat(o))return t(i,s,u);i.pos=l}return e(i,s,[o],"string")}if("q"==o){var c=i.look(-2);if(!c||!/\w/.test(c))if(c=i.look(0),"x"==c){if(c=i.look(1),"("==c)return i.eatSuffix(2),e(i,s,[")"],a,r);if("["==c)return i.eatSuffix(2),e(i,s,["]"],a,r);if("{"==c)return i.eatSuffix(2),e(i,s,["}"],a,r);if("<"==c)return i.eatSuffix(2),e(i,s,[">"],a,r);if(/[\^'"!~\/]/.test(c))return i.eatSuffix(1),e(i,s,[i.eat(c)],a,r)}else if("q"==c){if(c=i.look(1),"("==c)return i.eatSuffix(2),e(i,s,[")"],"string");if("["==c)return i.eatSuffix(2),e(i,s,["]"],"string");if("{"==c)return i.eatSuffix(2),e(i,s,["}"],"string");if("<"==c)return i.eatSuffix(2),e(i,s,[">"],"string");if(/[\^'"!~\/]/.test(c))return i.eatSuffix(1),e(i,s,[i.eat(c)],"string")
}else if("w"==c){if(c=i.look(1),"("==c)return i.eatSuffix(2),e(i,s,[")"],"bracket");if("["==c)return i.eatSuffix(2),e(i,s,["]"],"bracket");if("{"==c)return i.eatSuffix(2),e(i,s,["}"],"bracket");if("<"==c)return i.eatSuffix(2),e(i,s,[">"],"bracket");if(/[\^'"!~\/]/.test(c))return i.eatSuffix(1),e(i,s,[i.eat(c)],"bracket")}else if("r"==c){if(c=i.look(1),"("==c)return i.eatSuffix(2),e(i,s,[")"],a,r);if("["==c)return i.eatSuffix(2),e(i,s,["]"],a,r);if("{"==c)return i.eatSuffix(2),e(i,s,["}"],a,r);if("<"==c)return i.eatSuffix(2),e(i,s,[">"],a,r);if(/[\^'"!~\/]/.test(c))return i.eatSuffix(1),e(i,s,[i.eat(c)],a,r)}else if(/[\^'"!~\/(\[{<]/.test(c)){if("("==c)return i.eatSuffix(1),e(i,s,[")"],"string");if("["==c)return i.eatSuffix(1),e(i,s,["]"],"string");if("{"==c)return i.eatSuffix(1),e(i,s,["}"],"string");if("<"==c)return i.eatSuffix(1),e(i,s,[">"],"string");if(/[\^'"!~\/]/.test(c))return e(i,s,[i.eat(c)],"string")}}if("m"==o){var c=i.look(-2);if((!c||!/\w/.test(c))&&(c=i.eat(/[(\[{<\^'"!~\/]/))){if(/[\^'"!~\/]/.test(c))return e(i,s,[c],a,r);if("("==c)return e(i,s,[")"],a,r);if("["==c)return e(i,s,["]"],a,r);if("{"==c)return e(i,s,["}"],a,r);if("<"==c)return e(i,s,[">"],a,r)}}if("s"==o){var c=/[\/>\]})\w]/.test(i.look(-2));if(!c&&(c=i.eat(/[(\[{<\^'"!~\/]/)))return"["==c?e(i,s,["]","]"],a,r):"{"==c?e(i,s,["}","}"],a,r):"<"==c?e(i,s,[">",">"],a,r):"("==c?e(i,s,[")",")"],a,r):e(i,s,[c,c],a,r)}if("y"==o){var c=/[\/>\]})\w]/.test(i.look(-2));if(!c&&(c=i.eat(/[(\[{<\^'"!~\/]/)))return"["==c?e(i,s,["]","]"],a,r):"{"==c?e(i,s,["}","}"],a,r):"<"==c?e(i,s,[">",">"],a,r):"("==c?e(i,s,[")",")"],a,r):e(i,s,[c,c],a,r)}if("t"==o){var c=/[\/>\]})\w]/.test(i.look(-2));if(!c&&(c=i.eat("r"),c&&(c=i.eat(/[(\[{<\^'"!~\/]/))))return"["==c?e(i,s,["]","]"],a,r):"{"==c?e(i,s,["}","}"],a,r):"<"==c?e(i,s,[">",">"],a,r):"("==c?e(i,s,[")",")"],a,r):e(i,s,[c,c],a,r)}if("`"==o)return e(i,s,[o],"variable-2");if("/"==o)return/~\s*$/.test(i.prefix())?e(i,s,[o],a,r):"operator";if("$"==o){var l=i.pos;if(i.eatWhile(/\d/)||i.eat("{")&&i.eatWhile(/\d/)&&i.eat("}"))return"variable-2";
i.pos=l}if(/[$@%]/.test(o)){var l=i.pos;if(i.eat("^")&&i.eat(/[A-Z]/)||!/[@$%&]/.test(i.look(-2))&&i.eat(/[=|\\\-#?@;:&`~\^!\[\]*'"$+.,\/<>()]/)){var c=i.current();if(n[c])return"variable-2"}i.pos=l}if(/[$@%&]/.test(o)&&(i.eatWhile(/[\w$\[\]]/)||i.eat("{")&&i.eatWhile(/[\w$\[\]]/)&&i.eat("}"))){var c=i.current();return n[c]?"variable-2":"variable"}if("#"==o&&"$"!=i.look(-2))return i.skipToEnd(),"comment";if(/[:+\-\^*$&%@=<>!?|\/~\.]/.test(o)){var l=i.pos;if(i.eatWhile(/[:+\-\^*$&%@=<>!?|\/~\.]/),n[i.current()])return"operator";i.pos=l}if("_"==o&&1==i.pos){if("_END__"==i.suffix(6))return e(i,s,["\x00"],"comment");if("_DATA__"==i.suffix(7))return e(i,s,["\x00"],"variable-2");if("_C__"==i.suffix(7))return e(i,s,["\x00"],"string")}if(/\w/.test(o)){var l=i.pos;if("{"==i.look(-2)&&("}"==i.look(0)||i.eatWhile(/\w/)&&"}"==i.look(0)))return"string";i.pos=l}if(/[A-Z]/.test(o)){var d=i.look(-2),l=i.pos;if(i.eatWhile(/[A-Z_]/),!/[\da-z]/.test(i.look(0))){var c=n[i.current()];return c?(c[1]&&(c=c[0]),":"!=d?1==c?"keyword":2==c?"def":3==c?"atom":4==c?"operator":5==c?"variable-2":"meta":"meta"):"meta"}i.pos=l}if(/[a-zA-Z_]/.test(o)){var d=i.look(-2);i.eatWhile(/\w/);var c=n[i.current()];return c?(c[1]&&(c=c[0]),":"!=d?1==c?"keyword":2==c?"def":3==c?"atom":4==c?"operator":5==c?"variable-2":"meta":"meta"):"meta"}return null}var n={"->":4,"++":4,"--":4,"**":4,"=~":4,"!~":4,"*":4,"/":4,"%":4,x:4,"+":4,"-":4,".":4,"<<":4,">>":4,"<":4,">":4,"<=":4,">=":4,lt:4,gt:4,le:4,ge:4,"==":4,"!=":4,"<=>":4,eq:4,ne:4,cmp:4,"~~":4,"&":4,"|":4,"^":4,"&&":4,"||":4,"//":4,"..":4,"...":4,"?":4,":":4,"=":4,"+=":4,"-=":4,"*=":4,",":4,"=>":4,"::":4,not:4,and:4,or:4,xor:4,BEGIN:[5,1],END:[5,1],PRINT:[5,1],PRINTF:[5,1],GETC:[5,1],READ:[5,1],READLINE:[5,1],DESTROY:[5,1],TIE:[5,1],TIEHANDLE:[5,1],UNTIE:[5,1],STDIN:5,STDIN_TOP:5,STDOUT:5,STDOUT_TOP:5,STDERR:5,STDERR_TOP:5,$ARG:5,$_:5,"@ARG":5,"@_":5,$LIST_SEPARATOR:5,'$"':5,$PROCESS_ID:5,$PID:5,$$:5,$REAL_GROUP_ID:5,$GID:5,"$(":5,$EFFECTIVE_GROUP_ID:5,$EGID:5,"$)":5,$PROGRAM_NAME:5,$0:5,$SUBSCRIPT_SEPARATOR:5,$SUBSEP:5,"$;":5,$REAL_USER_ID:5,$UID:5,"$<":5,$EFFECTIVE_USER_ID:5,$EUID:5,"$>":5,$a:5,$b:5,$COMPILING:5,"$^C":5,$DEBUGGING:5,"$^D":5,"${^ENCODING}":5,$ENV:5,"%ENV":5,$SYSTEM_FD_MAX:5,"$^F":5,"@F":5,"${^GLOBAL_PHASE}":5,"$^H":5,"%^H":5,"@INC":5,"%INC":5,$INPLACE_EDIT:5,"$^I":5,"$^M":5,$OSNAME:5,"$^O":5,"${^OPEN}":5,$PERLDB:5,"$^P":5,$SIG:5,"%SIG":5,$BASETIME:5,"$^T":5,"${^TAINT}":5,"${^UNICODE}":5,"${^UTF8CACHE}":5,"${^UTF8LOCALE}":5,$PERL_VERSION:5,"$^V":5,"${^WIN32_SLOPPY_STAT}":5,$EXECUTABLE_NAME:5,"$^X":5,$1:5,$MATCH:5,"$&":5,"${^MATCH}":5,$PREMATCH:5,"$`":5,"${^PREMATCH}":5,$POSTMATCH:5,"$'":5,"${^POSTMATCH}":5,$LAST_PAREN_MATCH:5,"$+":5,$LAST_SUBMATCH_RESULT:5,"$^N":5,"@LAST_MATCH_END":5,"@+":5,"%LAST_PAREN_MATCH":5,"%+":5,"@LAST_MATCH_START":5,"@-":5,"%LAST_MATCH_START":5,"%-":5,$LAST_REGEXP_CODE_RESULT:5,"$^R":5,"${^RE_DEBUG_FLAGS}":5,"${^RE_TRIE_MAXBUF}":5,$ARGV:5,"@ARGV":5,ARGV:5,ARGVOUT:5,$OUTPUT_FIELD_SEPARATOR:5,$OFS:5,"$,":5,$INPUT_LINE_NUMBER:5,$NR:5,"$.":5,$INPUT_RECORD_SEPARATOR:5,$RS:5,"$/":5,$OUTPUT_RECORD_SEPARATOR:5,$ORS:5,"$\\":5,$OUTPUT_AUTOFLUSH:5,"$|":5,$ACCUMULATOR:5,"$^A":5,$FORMAT_FORMFEED:5,"$^L":5,$FORMAT_PAGE_NUMBER:5,"$%":5,$FORMAT_LINES_LEFT:5,"$-":5,$FORMAT_LINE_BREAK_CHARACTERS:5,"$:":5,$FORMAT_LINES_PER_PAGE:5,"$=":5,$FORMAT_TOP_NAME:5,"$^":5,$FORMAT_NAME:5,"$~":5,"${^CHILD_ERROR_NATIVE}":5,$EXTENDED_OS_ERROR:5,"$^E":5,$EXCEPTIONS_BEING_CAUGHT:5,"$^S":5,$WARNING:5,"$^W":5,"${^WARNING_BITS}":5,$OS_ERROR:5,$ERRNO:5,"$!":5,"%OS_ERROR":5,"%ERRNO":5,"%!":5,$CHILD_ERROR:5,"$?":5,$EVAL_ERROR:5,"$@":5,$OFMT:5,"$#":5,"$*":5,$ARRAY_BASE:5,"$[":5,$OLD_PERL_VERSION:5,"$]":5,"if":[1,1],elsif:[1,1],"else":[1,1],"while":[1,1],unless:[1,1],"for":[1,1],foreach:[1,1],abs:1,accept:1,alarm:1,atan2:1,bind:1,binmode:1,bless:1,bootstrap:1,"break":1,caller:1,chdir:1,chmod:1,chomp:1,chop:1,chown:1,chr:1,chroot:1,close:1,closedir:1,connect:1,"continue":[1,1],cos:1,crypt:1,dbmclose:1,dbmopen:1,"default":1,defined:1,"delete":1,die:1,"do":1,dump:1,each:1,endgrent:1,endhostent:1,endnetent:1,endprotoent:1,endpwent:1,endservent:1,eof:1,eval:1,exec:1,exists:1,exit:1,exp:1,fcntl:1,fileno:1,flock:1,fork:1,format:1,formline:1,getc:1,getgrent:1,getgrgid:1,getgrnam:1,gethostbyaddr:1,gethostbyname:1,gethostent:1,getlogin:1,getnetbyaddr:1,getnetbyname:1,getnetent:1,getpeername:1,getpgrp:1,getppid:1,getpriority:1,getprotobyname:1,getprotobynumber:1,getprotoent:1,getpwent:1,getpwnam:1,getpwuid:1,getservbyname:1,getservbyport:1,getservent:1,getsockname:1,getsockopt:1,given:1,glob:1,gmtime:1,"goto":1,grep:1,hex:1,"import":1,index:1,"int":1,ioctl:1,join:1,keys:1,kill:1,last:1,lc:1,lcfirst:1,length:1,link:1,listen:1,local:2,localtime:1,lock:1,log:1,lstat:1,m:null,map:1,mkdir:1,msgctl:1,msgget:1,msgrcv:1,msgsnd:1,my:2,"new":1,next:1,no:1,oct:1,open:1,opendir:1,ord:1,our:2,pack:1,"package":1,pipe:1,pop:1,pos:1,print:1,printf:1,prototype:1,push:1,q:null,qq:null,qr:null,quotemeta:null,qw:null,qx:null,rand:1,read:1,readdir:1,readline:1,readlink:1,readpipe:1,recv:1,redo:1,ref:1,rename:1,require:1,reset:1,"return":1,reverse:1,rewinddir:1,rindex:1,rmdir:1,s:null,say:1,scalar:1,seek:1,seekdir:1,select:1,semctl:1,semget:1,semop:1,send:1,setgrent:1,sethostent:1,setnetent:1,setpgrp:1,setpriority:1,setprotoent:1,setpwent:1,setservent:1,setsockopt:1,shift:1,shmctl:1,shmget:1,shmread:1,shmwrite:1,shutdown:1,sin:1,sleep:1,socket:1,socketpair:1,sort:1,splice:1,split:1,sprintf:1,sqrt:1,srand:1,stat:1,state:1,study:1,sub:1,substr:1,symlink:1,syscall:1,sysopen:1,sysread:1,sysseek:1,system:1,syswrite:1,tell:1,telldir:1,tie:1,tied:1,time:1,times:1,tr:null,truncate:1,uc:1,ucfirst:1,umask:1,undef:1,unlink:1,unpack:1,unshift:1,untie:1,use:1,utime:1,values:1,vec:1,wait:1,waitpid:1,wantarray:1,warn:1,when:1,write:1,y:null},a="string-2",r=/[goseximacplud]/;
return{startState:function(){return{tokenize:i,chain:null,style:null,tail:null}},token:function(e,t){return(t.tokenize||i)(e,t)},electricChars:"{}"}}),e.defineMIME("text/x-perl","perl"),e.StringStream.prototype.look=function(e){return this.string.charAt(this.pos+(e||0))},e.StringStream.prototype.prefix=function(e){if(e){var t=this.pos-e;return this.string.substr(t>=0?t:0,e)}return this.string.substr(0,this.pos-1)},e.StringStream.prototype.suffix=function(e){var t=this.string.length,i=t-this.pos+1;return this.string.substr(this.pos,e&&t>e?e:i)},e.StringStream.prototype.nsuffix=function(e){var t=this.pos,i=e||this.string.length-this.pos+1;return this.pos+=i,this.string.substr(t,i)},e.StringStream.prototype.eatSuffix=function(e){var t,i=this.pos+e;this.pos=0>=i?0:i>=(t=this.string.length-1)?t:i}}),define("tp/codemirror/mode/php/php",["tp/codemirror/lib/codemirror"],function(e){!function(){function t(e){for(var t={},i=e.split(" "),n=0;n<i.length;++n)t[i[n]]=!0;return t}function i(e){return function(t,i){return t.match(e)?i.tokenize=null:t.skipToEnd(),"string"}}var n={name:"clike",keywords:t("abstract and array as break case catch cfunction class clone const continue declare default do else elseif enddeclare endfor endforeach endif endswitch endwhile extends final for foreach function global goto if implements interface instanceof namespace new or private protected public static switch throw try use var while xor returndie echo empty exit eval include include_once isset list require require_once print unset"),blockKeywords:t("catch do else elseif for foreach if switch try while"),atoms:t("true false null TRUE FALSE NULL"),multiLineStrings:!0,hooks:{$:function(e){return e.eatWhile(/[\w\$_]/),"variable-2"},"<":function(e,t){return e.match(/<</)?(e.eatWhile(/[\w\.]/),t.tokenize=i(e.current().slice(3)),t.tokenize(e,t)):!1},"#":function(e){return e.skipToEnd(),"comment"}}};e.defineMode("php",function(t,i){function a(e,t){if(t.curMode==r){var i=r.token(e,t.curState);return"meta"==i&&/^<\?/.test(e.current())?(t.curMode=l,t.curState=t.php,t.curClose=/^\?>/,t.mode="php"):"tag"==i&&">"==e.current()&&t.curState.context&&(/^script$/i.test(t.curState.context.tagName)?(t.curMode=s,t.curState=s.startState(r.indent(t.curState,"")),t.curClose=/^<\/\s*script\s*>/i,t.mode="javascript"):/^style$/i.test(t.curState.context.tagName)&&(t.curMode=o,t.curState=o.startState(r.indent(t.curState,"")),t.curClose=/^<\/\s*style\s*>/i,t.mode="css")),i
}return e.match(t.curClose,!1)?(t.curMode=r,t.curState=t.html,t.curClose=null,t.mode="html",a(e,t)):t.curMode.token(e,t.curState)}var r=e.getMode(t,"text/html"),s=e.getMode(t,"text/javascript"),o=e.getMode(t,"text/css"),l=e.getMode(t,n);return{startState:function(){var e=r.startState();return{html:e,php:l.startState(),curMode:i.startOpen?l:r,curState:i.startOpen?l.startState():e,curClose:i.startOpen?/^\?>/:null,mode:i.startOpen?"php":"html"}},copyState:function(t){var i,n=t.html,a=e.copyState(r,n),s=t.php,o=e.copyState(l,s);return i=t.curState==n?a:t.curState==s?o:e.copyState(t.curMode,t.curState),{html:a,php:o,curMode:t.curMode,curState:i,curClose:t.curClose}},token:a,indent:function(e,t){return e.curMode!=l&&/^\s*<\//.test(t)||e.curMode==l&&/^\?>/.test(t)?r.indent(e.html,t):e.curMode.indent(e.curState,t)},electricChars:"/{}:"}}),e.defineMIME("application/x-httpd-php","php"),e.defineMIME("application/x-httpd-php-open",{name:"php",startOpen:!0}),e.defineMIME("text/x-php",n)}()}),define("tp/codemirror/mode/ruby/ruby",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("ruby",function(e){function t(e){for(var t={},i=0,n=e.length;n>i;++i)t[e[i]]=!0;return t}function i(e,t,i){return i.tokenize.push(e),e(t,i)}function n(e,t){if(l=null,e.sol()&&e.match("=begin")&&e.eol())return t.tokenize.push(o),"comment";if(e.eatSpace())return null;var n=e.next();if("`"==n||"'"==n||'"'==n||"/"==n)return i(r(n,"string",'"'==n),e,t);if("%"==n){var a,u=!1;e.eat("s")?a="atom":e.eat(/[WQ]/)?(a="string",u=!0):e.eat(/[wxqr]/)&&(a="string");var c=e.eat(/[^\w\s]/);return c?(p.propertyIsEnumerable(c)&&(c=p[c]),i(r(c,a,u,!0),e,t)):"operator"}if("#"==n)return e.skipToEnd(),"comment";if("<"==n&&e.eat("<")){e.eat("-"),e.eat(/[\'\"\`]/);var d=e.match(/^\w+/);return e.eat(/[\'\"\`]/),d?i(s(d[0]),e,t):null}if("0"==n)return e.eatWhile(e.eat("x")?/[\da-fA-F]/:e.eat("b")?/[01]/:/[0-7]/),"number";if(/\d/.test(n))return e.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if("?"==n){for(;e.match(/^\\[CM]-/););return e.eat("\\")?e.eatWhile(/\w/):e.next(),"string"
}return":"==n?e.eat("'")?i(r("'","atom",!1),e,t):e.eat('"')?i(r('"',"atom",!0),e,t):(e.eatWhile(/[\w\?]/),"atom"):"@"==n?(e.eat("@"),e.eatWhile(/[\w\?]/),"variable-2"):"$"==n?(e.next(),e.eatWhile(/[\w\?]/),"variable-3"):/\w/.test(n)?(e.eatWhile(/[\w\?]/),e.eat(":")?"atom":"ident"):"|"!=n||!t.varList&&"{"!=t.lastTok&&"do"!=t.lastTok?/[\(\)\[\]{}\\;]/.test(n)?(l=n,null):"-"==n&&e.eat(">")?"arrow":/[=+\-\/*:\.^%<>~|]/.test(n)?(e.eatWhile(/[=+\-\/*:\.^%<>~|]/),"operator"):null:(l="|",null)}function a(){var e=1;return function(t,i){if("}"==t.peek()){if(e--,0==e)return i.tokenize.pop(),i.tokenize[i.tokenize.length-1](t,i)}else"{"==t.peek()&&e++;return n(t,i)}}function r(e,t,i,n){return function(r,s){for(var o,l=!1;null!=(o=r.next());){if(o==e&&(n||!l)){s.tokenize.pop();break}if(i&&"#"==o&&!l&&r.eat("{")){s.tokenize.push(a(arguments.callee));break}l=!l&&"\\"==o}return t}}function s(e){return function(t,i){return t.match(e)?i.tokenize.pop():t.skipToEnd(),"string"}}function o(e,t){return e.sol()&&e.match("=end")&&e.eol()&&t.tokenize.pop(),e.skipToEnd(),"comment"}var l,u=t(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload"]),c=t(["def","class","case","for","while","do","module","then","unless","catch","loop","proc"]),d=t(["end","until"]),p={"[":"]","{":"}","(":")"};return{startState:function(){return{tokenize:[n],indented:0,context:{type:"top",indented:-e.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(e,t){e.sol()&&(t.indented=e.indentation());var i,n=t.tokenize[t.tokenize.length-1](e,t);if("ident"==n){var a=e.current();n=u.propertyIsEnumerable(e.current())?"keyword":/^[A-Z]/.test(a)?"tag":"def"==t.lastTok||"class"==t.lastTok||t.varList?"def":"variable",c.propertyIsEnumerable(a)?i="indent":d.propertyIsEnumerable(a)?i="dedent":"if"==a&&e.column()==e.indentation()&&(i="indent")
}return(l||n&&"comment"!=n)&&(t.lastTok=a||l||n),"|"==l&&(t.varList=!t.varList),"indent"==i||/[\(\[\{]/.test(l)?t.context={prev:t.context,type:l||n,indented:t.indented}:("dedent"==i||/[\)\]\}]/.test(l))&&t.context.prev&&(t.context=t.context.prev),e.eol()&&(t.continuedLine="\\"==l||"operator"==n),n},indent:function(t,i){if(t.tokenize[t.tokenize.length-1]!=n)return 0;var a=i&&i.charAt(0),r=t.context,s=r.type==p[a]||"keyword"==r.type&&/^(?:end|until|else|elsif|when)\b/.test(i);return r.indented+(s?0:e.indentUnit)+(t.continuedLine?e.indentUnit:0)}}}),e.defineMIME("text/x-ruby","ruby")}),define("tp/codemirror/mode/xml/xml",["tp/codemirror/lib/codemirror"],function(e){e.defineMode("xml",function(e,t){function i(e,t){function i(i){return t.tokenize=i,i(e,t)}var a=e.next();if("<"==a){if(e.eat("!"))return e.eat("[")?e.match("CDATA[")?i(r("atom","]]>")):null:e.match("--")?i(r("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),i(r("meta",">"))):null;if(e.eat("?"))return e.eatWhile(/[\w\._\-]/),t.tokenize=r("meta","?>"),"meta";v=e.eat("/")?"closeTag":"openTag",e.eatSpace(),g="";for(var s;s=e.eat(/[^\s\u00a0=<>\"\'\/?]/);)g+=s;return t.tokenize=n,"tag"}return"&"==a?(e.eatWhile(/[^;]/),e.eat(";"),"atom"):(e.eatWhile(/[^&<]/),null)}function n(e,t){var n=e.next();return">"==n||"/"==n&&e.eat(">")?(t.tokenize=i,v=">"==n?"endTag":"selfcloseTag","tag"):"="==n?(v="equals",null):/[\'\"]/.test(n)?(t.tokenize=a(n),t.tokenize(e,t)):(e.eatWhile(/[^\s\u00a0=<>\"\'\/?]/),"word")}function a(e){return function(t,i){for(;!t.eol();)if(t.next()==e){i.tokenize=n;break}return"string"}}function r(e,t){return function(n,a){for(;!n.eol();){if(n.match(t)){a.tokenize=i;break}n.next()}return e}}function s(){for(var e=arguments.length-1;e>=0;e--)b.cc.push(arguments[e])}function o(){return s.apply(null,arguments),!0}function l(e,t){var i=x.doNotIndent.hasOwnProperty(e)||b.context&&b.context.noIndent;b.context={prev:b.context,tagName:e,indent:b.indented,startOfLine:t,noIndent:i}}function u(){b.context&&(b.context=b.context.prev)
}function c(e){if("openTag"==e)return b.tagName=g,o(f,d(b.startOfLine));if("closeTag"==e){var t=!1;return t=b.context?b.context.tagName!=g:!0,t&&(y="error"),o(p(t))}return"string"==e?(b.context&&"!cdata"==b.context.name||l("!cdata"),b.tokenize==i&&u(),o()):o()}function d(e){return function(t){return"selfcloseTag"==t||"endTag"==t&&x.autoSelfClosers.hasOwnProperty(b.tagName.toLowerCase())?o():"endTag"==t?(l(b.tagName,e),o()):o()}}function p(e){return function(t){return e&&(y="error"),"endTag"==t?(u(),o()):(y="error",o(arguments.callee))}}function f(e){return"word"==e?(y="attribute",o(f)):"equals"==e?o(m,f):"string"==e?(y="error",o(f)):s()}function m(e){return"word"==e&&x.allowUnquoted?(y="string",o()):"string"==e?o(h):s()}function h(e){return"string"==e?o(h):s()}var g,v,b,y,_=e.indentUnit,x=t.htmlMode?{autoSelfClosers:{br:!0,img:!0,hr:!0,link:!0,input:!0,meta:!0,col:!0,frame:!0,base:!0,area:!0},doNotIndent:{pre:!0,"!cdata":!0},allowUnquoted:!0}:{autoSelfClosers:{},doNotIndent:{"!cdata":!0},allowUnquoted:!1},w=t.alignCDATA;return{startState:function(){return{tokenize:i,cc:[],indented:0,startOfLine:!0,tagName:null,context:null}},token:function(e,t){if(e.sol()&&(t.startOfLine=!0,t.indented=e.indentation()),e.eatSpace())return null;y=v=g=null;var i=t.tokenize(e,t);if(t.type=v,(i||v)&&"comment"!=i)for(b=t;;){var n=t.cc.pop()||c;if(n(v||i))break}return t.startOfLine=!1,y||i},indent:function(e,t){var i=e.context;if(i&&i.noIndent)return 0;if(w&&/<!\[CDATA\[/.test(t))return 0;for(i&&/^<\//.test(t)&&(i=i.prev);i&&!i.startOfLine;)i=i.prev;return i?i.indent+_:0},compareStates:function(e,t){if(e.indented!=t.indented||e.tokenize!=t.tokenize)return!1;for(var i=e.context,n=t.context;;i=i.prev,n=n.prev){if(!i||!n)return i==n;if(i.tagName!=n.tagName)return!1}},electricChars:"/"}}),e.defineMIME("application/xml","xml"),e.defineMIME("text/html",{name:"xml",htmlMode:!0})}),define("tp/plugins/vcs/viewDiff/sourcePopup",["tp/codemirror/lib/codemirror","jQuery","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tp/popup","tp/codemirror/mode/diff/diff","tp/codemirror/mode/clike/clike","tp/codemirror/mode/css/css","tp/codemirror/mode/htmlmixed/htmlmixed","tp/codemirror/mode/javascript/javascript","tp/codemirror/mode/perl/perl","tp/codemirror/mode/php/php","tp/codemirror/mode/python/python","tp/codemirror/mode/ruby/ruby","tp/codemirror/mode/xml/xml"],function(e,t,i){var n=function(){this._ctor()
};return n.prototype={emptyText:"No data to display",_ctor:function(){this.placeholder=t('<div class="_viewSourcePopup viewSourcePopup" />'),this.codeViewer=e(this.placeholder[0],{readOnly:!0,lineNumbers:!0})},resizeCodeViewer:function(){var e=t("._viewSourcePopup"),i=e.height(),n=e.width();t(".CodeMirror-scroll").css({height:i,width:n})},_createPopup:function(){if(!this.popup){var e=t.proxy(this.resizeCodeViewer,this);this.popup=this.placeholder.popup({autoOpen:!1,minWidth:300,parentClassName:"vcsSource",open:e,resize:e})}},openPopup:function(e,t){this.codeViewer.setValue(t),this._createPopup(),this.popup.popup("option","title",e),this.popup.popup("open"),this.codeViewer.refresh()},view:function(e,t,n){t=t||this.emptyText;var a="File: "+n+'<br /><span class="subTitle">Revision: '+e+"</span>";this.placeholder.removeClass("_refreshing"),i.get(this.placeholder).hide(),this._setModeByFileExtension(n),this.openPopup(a,t)},loading:function(){this.placeholder.addClass("_refreshing"),i.get(this.placeholder).show(),this.openPopup("","")},_getExtension:function(e){return e.substr(e.lastIndexOf(".")+1)},_setModeByFileExtension:function(e){var t=this._getExtension(e),i="clike";switch(t){case"css":i="text/css";break;case"cs":i="text/x-csharp";break;case"c":case"h":i="text/x-csrc";break;case"cpp":i="text/x-c++src";break;case"html":case"htm":case"shtml":i="text/html";break;case"js":i="text/javascript";break;case"java":i="text/x-java";break;case"perl":i="text/x-perl";break;case"php":case"phtml":case"phl":i="application/x-httpd-php";break;case"py":i="text/x-python";break;case"rb":i="text/x-ruby";break;case"xml":case"config":i="application/xml";break;default:i="null"}this.codeViewer.setOption("mode",i)}},new n}),define("tp/plugins/vcs/viewDiff/diffPopup",["jQuery","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tp/popup"],function(e,t){var i=function(){this._ctor()};return i.prototype={placeholder:e(['<div class="_viewDiffPopup viewDiffPopup">','<div class="diffHeader">','<div class="_legend legend">','<span class="lineAdded">line added</span>&nbsp;&nbsp;','<span class="lineUpdated">line changed</span>&nbsp;&nbsp;','<span class="lineDeleted">line deleted</span>',"</div>",'<div class="revisionsContainer">','<div class="revisionContainer right">','<div class="_rightRevision revision"></div>',"</div>",'<div class="revisionContainer left">','<div class="_leftRevision revision"></div>',"</div>","</div>","</div>",'<div class="diffContainer _diffContainer">','<div class="_rightContainer sourceContainer right">',"<pre>",'<div class="_rightPan"></div>',"</pre>","</div>",'<div class="_leftContainer sourceContainer left">',"<pre>",'<div class="_leftPan"></div>',"</pre>","</div>",'<div style="clear:both;"></div>',"</div>",'<div class="scrollers">','<div class="_rightScroller rightScroller right">','<div class="_scrollerInternals scrollerInternals"></div>',"</div>",'<div class="_leftScroller leftScroller left">','<div class="_scrollerInternals scrollerInternals"></div>',"</div>","</div>","</div>"].join("")),lineTemplate:'<div {{if line.Action}}class="line${actions[line.Action]}"{{/if}}>${line.LineNumber}  ${line.Line}</div>',actions:{0:"None",10:"Added",20:"Updated",30:"Deleted"},emptyText:"No data to display",_ctor:function(){},_createPopup:function(){if(!this.popup){var t=e.proxy(this._getSyncFunction("left","right"),this),i=e.proxy(this._getSyncFunction("right","left"),this),n=e.proxy(function(){this._processScroller("right"),this._processScroller("left")
},this),a=this;this.popup=this.placeholder.popup({autoOpen:!1,minWidth:300,parentClassName:"vcsDiff",open:function(){a._processScroller("right").bind("scroll",i),a._processScroller("left").bind("scroll",t),e(window).bind("resize",n)},close:function(){a.placeholder.find("._rightScroller").unbind("scroll",i),a.placeholder.find("._leftScroller").unbind("scroll",t),e(window).unbind("resize",n)},resize:function(){n()}})}},_getSyncFunction:function(e,t){var i=this;return function(){var n=i.placeholder.find("._"+e+"Scroller");i.placeholder.find("._"+t+"Scroller").scrollLeft(n.scrollLeft()),i.placeholder.find("._"+t+"Container").scrollLeft(n.scrollLeft()),i.placeholder.find("._"+e+"Container").scrollLeft(n.scrollLeft())}},_processScroller:function(t){var i=e("._"+t+"Pan").width(),n=this.placeholder.find("._"+t+"Container"),a=n.width(),r=this.placeholder.find("._"+t+"Scroller"),s=this.placeholder.find("._diffContainer");return n.height()<s.height()?(n.height(s.height()),r.css("right",0)):(n.css("height","auto"),r.css("right","17px")),r.find("._scrollerInternals").width(i),r.width(a),i>a?r.show():r.hide(),r},openPopup:function(e,t){var i=this.placeholder;this._showRevision(i.find("._leftRevision"),t.LeftPanRevisionId),this._showRevision(i.find("._rightRevision"),t.RightPanRevisionId),this._showContent(i.find("._leftPan"),t.LeftPan),this._showContent(i.find("._rightPan"),t.RightPan),this._createPopup(),this.popup.popup("option","title",e),this.popup.popup("open")},view:function(e,i,n){this.placeholder.removeClass("_refreshing"),t.get(this.placeholder).hide(),this.openPopup("Changed file: "+n,i)},loading:function(){this.placeholder.addClass("_refreshing"),t.get(this.placeholder).show();var e={LeftPanRevisionId:"",RightPanRevisionId:"",LeftPan:[],RightPan:[]};this.openPopup("",e)},_showRevision:function(e,t){e.text("Revision "+t)},_showContent:function(t,i){t.html("");for(var n=0;n<i.length;n++){var a=i[n];a.LineNumber=this._normalizeLineNumber(a.LineNumber),a.Line=a.Line.replace(/\t/g,"&#9;")||"&nbsp;",t.append(e.tmpl(this.lineTemplate,{line:a,actions:this.actions}))
}},_normalizeLineNumber:function(e){if(0>e)return"     ";var t="     "+(e+1);return t.slice(-5)}},new i}),define("tau/ui/extensions/revisionList/ui.extension.revisionList.showDiff",["Underscore","jQuery","tau/components/extensions/component.extension.base","tp/plugins/pluginsRepository","tp/plugins/commandGateway","tp/plugins/vcs/viewDiff/sourcePopup","tp/plugins/vcs/viewDiff/diffPopup"],function(e,t,i,n,a,r,s){function o(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}var l=["Subversion","Git","Mercurial","TFS"];return o(require.toUrl("tp/codemirror/theme/default.css")),i.extend({plugins:[],"bus afterRender+dataBind":function(i,o,u){var c=this.plugins,d=e.pluck(u.items,"id"),p=this;e.each(l,function(i){var l={pluginName:i},u=new a(l),f={extension:this,pluginName:i,commandGateway:u,revisions:d,viewSourcePopup:r,viewDiffPopup:s,getImportedRevisions:function(){this.commandGateway.execute("GetImportedRevisions",this.revisions,e.bind(this.getImportedRevisionsSuccess,this))},getImportedRevisionsSuccess:function(e){if(0!==e.length){for(var i=o.element,n={},a=0;a<e.length;a++)n[e[a]]=!0;i.find(".ui-revisionList > tbody").each(function(e){var i=t(this),a=i.tmplItem().data;n.hasOwnProperty(a.id)&&e.attachViewDiffBehaviourForElement(i)},[this])}},attachViewDiffBehaviourForElement:function(e){var i=e.tmplItem().data,n=e.find(".files");n.each(function(e){var n=t(this),a=n.tmplItem().data,r=n.find(".vcsViewDisabled");if("Deleted"!=a.fileAction&&(r.attr("href","#").removeAttr("disabled").addClass("vcsView"),r.click(function(t){t.preventDefault(),e.showView(i.id,i.sourceControlId,a.fileName)}),r.removeClass("vcsViewDisabled")),"Modified"===a.fileAction){var s=n.parent().find(".diff");s.append(t('<a href="#" class="_diff button small">Diff</a>').click(function(t){t.preventDefault(),e.showDiff(i.id,i.sourceControlId,a.fileName)}))}},[this])},showView:function(e,t,i){var n=p.config;n.context.configurator.getKeyBoardManager().pushHandler({handleKeyDown:function(e){27==e.keyCode&&n.context.configurator.getKeyBoardManager().popHandler()
}}),this.viewSourcePopup.loading();var a=this;this.commandGateway.execute("ViewSource",{TpRevisionId:e,Path:i},function(e){var n=e.Content||"File is empty";a.viewSourcePopup.view(t,n,i)},null,this.showError)},showDiff:function(e,t,i){var n=p.config;n.context.configurator.getKeyBoardManager().pushHandler({handleKeyDown:function(e){27==e.keyCode&&n.context.configurator.getKeyBoardManager().popHandler()}}),this.viewDiffPopup.loading();var a=this;this.commandGateway.execute("ViewDiff",{TpRevisionId:e,Path:i},function(e){a.viewDiffPopup.view(t,e,i)},null,this.showError)},showError:function(e){t("<div />").html('<p class="p-15">'+e+"</p>").popup({title:"Error occurred",fitToWindow:!1})}};c[i]=f,n.pluginStartedAndHasAtLeastOneProfile(i,e.bind(f.getImportedRevisions,f))},this)}})}),define("tau/components/component.revisionList",["tau/components/component.list.creator","tau/models/model.revisionList","tau/ui/extensions/testCaseList/ui.extension.testCaseList","tau/ui/templates/revisionList/ui.template.revisionList","tau/ui/extensions/revisionList/ui.extension.revisionList.showDiff","tau/ui/extensions/list/extension.fire.nodata.event","tau/ui/templates/common/ui.template.entityLink"],function(e,t,i,n,a,r){return{create:function(s){var o={template:n,extensions:[t,i,a,r],message:"No revisions found"};return e.create(o,s)}}}),define("tau/models/model.search-resolver",["jQuery"],function(e){return{resolveSearchToken:function(t,i){var n=e.Deferred();return/^\d+$/.test(t)?(t=parseInt(t,10),i.getStore().get("general",{failureGlobal:!1,id:t,fields:["id",{entityType:["id","name"]}],errorHandler:function(e){var t=e.status,i=404==t||400==t;return!i}}).done({success:function(e){var t=e[0].data,a=i.getStore();"project"===t.entityType.name.toLowerCase()?a.get("project",{id:t.id,fields:["id","name"]}).done({success:function(){n.resolve({id:t.id,entity:t.entityType.name})},failure:function(){n.resolve({id:null,entity:"search"})}}):n.resolve({id:t.id,entity:t.entityType.name})},failure:function(){n.resolve({id:null,entity:"search"})
}})):/^(?:\*\d+\*|\*\d+|\d+\*)$/.test(t)||t.length>2?n.resolve({id:null,entity:"search"}):n.reject("Enter more than 2 chars"),n}}}),define("tau/components/component.search.filter",["Underscore","jQuery","tau/components/component.creator","tau/models/model.search-resolver","tau/components/extensions/error/extension.errorBar"],function(e,t,i,n,a){return{create:function(r){r["queue.bus"]=!0;var s={"queue.bus":!0,extensions:[a],template:{engine:"jqote2",name:"search-filter-template",markup:['<div class="tau-search-header">','<form action="">','<div class="tau-search-wrap">','<span class="tau-inline-group tau-search">','<input type="text" class="tau-in-text i-role-search-string" placeholder="Search" value="<%! this.params.searchString %>">','<button class="tau-btn tau-search i-role-search-trigger"></button>',"</span>","</div>",'<div class="search-settings">',"<span>Search in</span>",'<select class="tau-select i-role-entity-type-filter">','<option value=""<% if (!this.params.entityTypeId) { %> selected<% } %>>Any entities</option>',"<% for(var i = 0; i < this.entityTypes.length; i++) { %>","<% var et = this.entityTypes[i]; %>",'<option value="<%= et.id %>"<% if (et.id == this.params.entityTypeId) { %> selected<% } %>>',"<%= et.term %>","</option>","<% } %>","</select>",'<select class="tau-select i-role-entity-state-filter">','<option value=""<% if (!this.params.entityStateIds) { %> selected<% } %>>Any states</option>',"<% for(var i = 0; i < this.entityStates.length; i++) { %>","<% var es = this.entityStates[i]; %>",'<option value="<%= es.id %>" available="<%= es.availableId %>"<% if (es.id == this.params.entityStateIds) { %> selected<% } %>>',"<%= es.name %>","</option>","<% } %>","</select>",'<label class="tau-checkbox">','<input<% if (this.params.isAllProjects) { %> checked<% } %> type="checkbox" class="i-role-all-projects-filter">','<i class="tau-checkbox__icon"></i>',"<span>All projects <% if (this.isBoardEdition) { %>&amp; teams<% } %></span>","</label>","</div>","</form>","</div>"]}},o=i.create(s,r);
return o.on("afterInit",function(e){var t=e.data.config.context.configurator,i=t.service("search"),n=i.params().get();i.getSearchDomain(n).done(function(e){e.isBoardEdition=t.isBoardEdition,o.fire("dataBind",e)})}),o.on("afterRender",function(i){var a=i.data.element,s=r.context.configurator,l=function(e){var t=[".i-role-search-string",".i-role-entity-type-filter",".i-role-entity-state-filter",".i-role-all-projects-filter"].join(","),i=a.find(t);e===!1?i.attr("disabled","disabled"):i.removeAttr("disabled")},u=s.service("search"),c=function(){var t=u.params();return t.set("entityStateIds",null),u.getSearchDomain(t.get()).done(function(t){var i=a.find(".i-role-entity-state-filter"),n=i.val(),r=i.find('option[value="'+n+'"]').text();r=e.trim(r),i.empty().append('<option value="">Any state</option>'),e(t.entityStates).each(function(e){var t=e.name===r?" selected":"";i.append('<option value="'+e.id+'" available="'+e.availableId+'"'+t+">"+e.name+"</option>")})})},d=function(){o.fire("clearError"),l(!1);var t=e.trim(a.find(".i-role-search-string").val());n.resolveSearchToken(t,s).fail(function(e){l(!0),o.fire("error",{message:e})}).done(function(e){if("search"===e.entity){var i=s.service("search");i.offSearch(l),i.onSearch(l);var n=a.find(".i-role-all-projects-filter").prop("checked"),r=a.find(".i-role-entity-state-filter"),o=r.val();n===!0&&o&&(o=r.find('option[value="'+o+'"]').attr("available")),i.params().set("searchString",t).set("entityTypeId",a.find(".i-role-entity-type-filter").val()||null).set("entityStateIds",o).set("isAllProjects",n).set("isAllTeams",!s.isBoardEdition||n).submit()}else s.service("navigator").to(e.entity+"/"+e.id)})};a.find(".i-role-search-trigger").click(function(e){e.preventDefault(),d()}),a.on("change",".i-role-entity-type-filter",function(e){e.preventDefault(),u.params().set("entityTypeId",t(this).val()),c().done(d)}),a.on("change",".i-role-entity-state-filter,.i-role-all-projects-filter",function(e){e.preventDefault();var t=u.params(),i=a.find(".i-role-all-projects-filter").prop("checked");
t.set("isAllProjects",i),t.set("isAllTeams",!s.isBoardEdition||i),c().done(d)})}),o}}}),define("tau/models/model.search",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({init:function(e){var t=this;t._super.apply(t,arguments);var i=e.context.configurator,n=i.service("search");t.refreshTrigger=function(){t.fire("refresh")},n.onSubmit(t.refreshTrigger),t.destructor=function(){n.offSubmit(t.refreshTrigger)}},destroy:function(){this.destructor(),this._super.apply(this,arguments)},"bus afterInit":function(t){var i=this,n=t.data.config.context.configurator,a=n.service("search"),r=a.params().get();a.search(r).done(function(t){t.data.items=e.map(t.data.items,function(e){var t=e.id,i=e.entityType.name;return"comment"==e.entityType.name.toLowerCase()&&(t=e.general.id,i=e.general.entityType.name),e.url=n.getUrlBuilder().getNewViewUrl(t,i,!0),e}),t.data.srcParams=r,i.fire("dataBind",t.data)})}})}),define("tau/ui/templates/search/ui.template.search",["Underscore","jQuery","app.path","tau/core/templates-factory","tau/utils/utils.date"],function(e,t,i,n,a){var r={name:"search",engine:"jqote2",customFunctions:{oldSearchUrl:function(e){return i.get()+"/Search/Search.aspx?SearchString="+e},esc:function(t){return e.escape(t)},generatePagingItems:function(t,i,n){for(var a=[],r=e.max([t-n,0]),s=e.min([t+n,i-1]),o=0;i>o;o++)0===o||o===i-1?a.push({index:o,text:o+1}):o>=r&&s>=o?a.push({index:o,text:o+1}):(o===r-1||o===s+1)&&a.push({index:o,text:"..."});return a},formatDate:function(e){var t=a.getAge(e,new Date),i=t.isZero?"Just added":t.toString(),n=a.format.date.short(a.convertToTimezone(e));return n+" ("+i+")"},highlight:function(e,t){function i(e,t){var n=0;if(e.nodeType==Node.TEXT_NODE){var a=e.data.toUpperCase().indexOf(t);if(a>=0){var r=document.createElement("span");r.className="tau-search-txt";var s=e.splitText(a),o=(s.splitText(t.length),s.cloneNode(!0));r.appendChild(o),s.parentNode.replaceChild(r,s),n=1}}else if(1==e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var l=0;l<e.childNodes.length;++l)l+=i(e.childNodes[l],t);
return n}return e.each(function(){i(this,t.toUpperCase())})},nodeCutOffIterator:function(t,i){if(t){var n=t.textContent.replace(/\s+/g," "),a=n.length,r=[" ","[","]","{","}","(",")","/","\\",",",".",":",";","?","!","&","+","-","*"];if(a>2*i){var s=e.indexOfAnyChar(n,r,i);s=-1===s?i:s;var o=n.substring(0,s),l=a-i,u=e.indexOfAnyChar(n,r,l);u=-1===u?l:u;var c=n.substring(u,a);t.textContent=o+" ... "+c}}return t},iterateTokenThruKeywords:function(t,i){var n={token:i,matches:[]},a=i.toLocaleLowerCase();n.matches=e(t).reduce(function(e,t){var i=t.toLocaleLowerCase(),n=0;do if(n=a.indexOf(i,n),-1!==n){var r=n,s=r+i.length;e.push({a:r,z:s}),n=s}while(-1!==n);return e},n.matches);for(var r=e(n.matches).sortBy(function(e){return e.a}),s=[];r.length;){for(var o=r.shift();r.length&&o.z>=r[0].a;)r[0].z>o.z&&(o.z=r[0].z),r.shift();s.push(o)}return n.matches=s,n},format:function(i,n,a){var r=this;if(i=t("<div>"+(i||"")+"</div>").text(),i=t.trim(i).replace(/</g,"&lt;").replace(/>/g,"&gt;"),0===i.length)return"";var s,o=i.split(" "),l=e(o).chain().map(e.bind(r.iterateTokenThruKeywords,r,n)).reduce(function(e,t){for(var i=t.token,n=[],a=0,r=0;r<t.matches.length;r++){var s=t.matches[r];n.push(i.substring(a,s.a)),n.push('<span class="tau-search-txt">'),n.push(i.substring(s.a,s.z)),n.push("</span>"),a=s.z}return n.push(i.substring(a)),e.push(n.join("")),e},[]).value(),u=t("<div>"+l.join(" ")+"</div>");if(a){s=t("<div></div>");var c=r.nodeCutOffIterator,d=0,p=0;u.contents().each(function(e,i){var n,a=i.nodeType==Node.TEXT_NODE;if(a)n=c(i,30),p+=n.textContent.length;else{var r=t(i).text();p+=r.length,n=i}p>315?!a&&++d:s.append(n)}),d>0&&s.append('... <strong class="more-matches">+ '+d+" more match"+(d>1?"es":"")+".</strong>")}else s=u;return s.html()}},markup:["<% if (this.error) { %>",'<div class="tau-search-results">','<div class="tau-items">','<div class="tau-search-item tau-search-error">','<div class="tau-search-content">','<div class="tau-body"><%= this.response.responseText %></div>',"</div>","</div>",'<div class="tau-search-item">','<div class="tau-search-content">','<div class="tau-body">',"Something&apos;s wrong with the search. ","Try again or ",'<a class="tau-popup-link" href="<%= fn.oldSearchUrl(this.srcParams.searchString) %>">switch to the old search</a>',"</div>","</div>","</div>","</div>","</div>","<% } else { %>",'<div class="tau-search-results">','<div class="tau-items">',"<% if (this.info.indexProgress < 100) { %>",'<div class="tau-search-item tau-search-notification">','<div class="tau-search-content">','<div class="tau-body">Search results might be incomplete at this point. Indexing is still in progress...</div>',"</div>","</div>","<% } %>","<% var keywords = this.keywords; %>","<% if (this.items.length === 0) { %>",'<div class="tau-search-item">','<div class="tau-search-content">','<div class="tau-body">Nothing found</div>',"</div>","</div>","<% } %>","<% _.forEach(this.items, function(d) { %>","<% var entityType = d.entityType.name.toLowerCase(); %>",'<% var isComment = (entityType === "comment"); %>','<div class="tau-search-item">','<div class="tau-search-content">','<div class="tau-header">','<span class="tau-entity-icon tau-entity-icon--<%= d.entityType.name.toLowerCase() %>"><%= d.entityType.term %></span>',"<% if (isComment) { %>",'<span class="tau-entity-icon tau-entity-icon--<%= d.general.entityType.name.toLowerCase() %>"><%= d.general.entityType.term %></span>','<a href="<%= d.url %>" class="tau-entity-id">#<%= d.general.id %></a>',"<% } else { %>",'<a href="<%= d.url %>" class="tau-entity-id">#<%= d.id %></a>','<span class="tau-entity-filter"><%= fn.format(d.tags.join(" "), keywords, false) %></span>',"<% } %>","</div>",'<div class="tau-body">',"<% if (isComment) { %>",'<h3><a href="<%= d.url %>"><%= fn.esc(d.general.name) %></a></h3>',"<% } else { %>",'<h3><a href="<%= d.url %>"><%= fn.format(fn.esc(d.nameExt), keywords, false) %></a></h3>',"<% } %>","<p><%= fn.format(d.descExt, keywords, true) %></p>","</div>","</div>",'<div class="tau-search-info">',"<% if (d.entityState) { %>",'<div class="tau-line<% if (d.entityState.isFinal) { %> tau-done-entity<% } %>">','<div class="tau-caption">State</div>','<div class="tau-txt"><%= d.entityState.name %></div>',"</div>","<% } %>",'<div class="tau-line">','<div class="tau-caption">reated</div>','<div class="tau-txt"><%= fn.formatDate(d.createDate) %></div>',"</div>","<% if (d.project) { %>",'<div class="tau-line">','<div class="tau-caption">Project</div>','<div class="tau-txt"><%= d.project.name %></div>',"</div>","<% } %>","<% if (d.team) { %>",'<div class="tau-line">','<div class="tau-caption">Team</div>','<div class="tau-txt">','<span><%= d.team.name %></span><% if (d.team.icon) { %><i class="tau-icon tau-icon_type_svg tau-icon_name_<%! d.team.icon %>"></i><% } %>',"</div>","</div>","<% } %>","</div>","</div>","<% }); %>","</div>","<% var pagesCount = Math.ceil(this.info.total / this.info.pageSize); %>","<% if (pagesCount > 1) { %>",'<div class="tau-paging i-role-paging-container">','<div class="tau-links">','<a href="" class="tau-prev<% if (this.info.pageNo == 0) { %> tau-disabled<% } %> i-role-paging-prev">Previous <%= this.info.pageSize %></a>','<a href="" class="tau-next<% if (this.info.pageNo == (pagesCount - 1)) { %> tau-disabled<% } %> i-role-paging-next">Next <%= this.info.pageSize %></a>',"</div>",'<ul class="i-role-paging-pageno">',"<% var pagingItems = fn.generatePagingItems(this.info.pageNo, pagesCount, 5); %>","<% for (var i = 0; i < pagingItems.length; i++) { %>","<% var item = pagingItems[i]; %>","<% if (item.index == this.info.pageNo) { %>",'<li class="active"><span><%= item.text %></span></li>',"<% } else { %>",'<li><a href="" data-page="<%= item.index %>"><%= item.text %></a></li>',"<% } %>","<% } %>","</ul>","</div>","<% } %>","</div>","<% } %>"]};
return n.register(r)}),define("tau/components/component.search",["jQuery","tau/components/component.creator","tau/core/extension.base","tau/models/model.search","tau/ui/templates/search/ui.template.search","tau/ui/behaviour/common/ui.behaviour.progressIndicator"],function(e,t,i,n,a,r){return{create:function(s){s=s||{};var o={extensions:[n,i.extend({"bus afterRender":function(e,t){var i=t.element;r.get(i).hide()},"bus afterRender > refresh":function(e,t){var i=t.element;i.css("opacity",.5),r.get(i).show()},"bus afterInit + afterRender":function(t,i,n){var a=i.config.context.configurator,r=a.service("search"),s=n.element;s.on("click",".i-role-paging-container .i-role-paging-prev",function(t){if(t.preventDefault(),!e(t.target).hasClass("tau-disabled")){var i=r.params().get("pageNo");r.params().set("pageNo",--i).submit()}}),s.on("click",".i-role-paging-container .i-role-paging-next",function(t){if(t.preventDefault(),!e(t.target).hasClass("tau-disabled")){var i=r.params().get("pageNo");r.params().set("pageNo",++i).submit()}}),s.on("click",".i-role-paging-container .i-role-paging-pageno a",function(t){t.preventDefault();var i=e(t.target).data("page");r.params().set("pageNo",i).submit()})}})],template:s.template||a};return t.create(o,s)}}}),define("tau/components/setup.process/extensions/suppress.iframe.errors.extension",["require","tau/core/extension.base","tau/utils/utils.frame"],function(e){"use strict";var t=e("tau/core/extension.base"),i=e("tau/utils/utils.frame");return t.extend({"bus afterRender":function(e,t){var n=t.element.find("iframe");n.on("remove",function(){i.suppressRequireErrors(n)})}})}),define("tau/components/setup.process/extensions/extension.process.setup.title",["require","tau/core/extension.base","tau/components/setup.process/process.optionGroups"],function(e){"use strict";var t=e("tau/core/extension.base"),i=e("tau/components/setup.process/process.optionGroups");return t.extend({"bus afterInit":function(e,t){var n=t.config.context.configurator,a=n.getUrlBuilder(),r=i.create(a,t.config.optionGroupId,t.config.processId);
n.getTitleManager().set(r.getTitle())}})}),define("tau/components/setup.process/extensions/extension.process.setup",["require","tau/core/extension.base","tau/components/setup.process/process.optionGroups"],function(e){"use strict";var t=e("tau/core/extension.base"),i=e("tau/components/setup.process/process.optionGroups");return t.extend({"bus afterInit":function(e,t){var n=t.config.context.configurator,a=n.getUrlBuilder(),r=i.create(a,t.config.optionGroupId,t.config.processId);n.getTitleManager().set(r.getTitle()),this.fire("dataBind",{url:r.getTp2Url()})},"bus afterRender":function(e,t){var i=t.element.tauProgressIndicator().tauProgressIndicator("show"),n=i.find("iframe[role=setup-process]").hide();n.load(function(){n.show(),i.tauProgressIndicator("hide")})}})}),define("tau/components/component.setup.process",["require","tau/components/component.creator","tau/components/setup.process/extensions/suppress.iframe.errors.extension","tau/components/setup.process/extensions/extension.process.setup.title","tau/components/setup.process/extensions/extension.process.setup"],function(e){"use strict";var t=e("tau/components/component.creator"),i=e("tau/components/setup.process/extensions/suppress.iframe.errors.extension"),n=e("tau/components/setup.process/extensions/extension.process.setup.title"),a=e("tau/components/setup.process/extensions/extension.process.setup");return{create:function(e){var r={extensions:[a,i,n],template:{engine:"jqote2",markup:['<div class="workflow-iframe__wrap" role="setup-process-holder">','<iframe class="workflow-iframe" src="<%=this.url%>" role="setup-process"/>',"</div>"]}};return t.create(r,e)}}}),define("jsx!tau/components/setup.workflow/views/button",["require","libs/react/react-ex"],function(e){var t=e("libs/react/react-ex");return t.createClass({render:function(){return this.transferPropsTo(t.DOM.button({className:"tau-btn",type:"button"},this.props.children))}})}),define("jsx!tau/components/setup.workflow/views/state.settings",["require","Underscore","libs/react/react-ex","jsx!./button"],function(e){var t=e("Underscore"),i=e("libs/react/react-ex"),n=e("jsx!./button"),a=i.createClass({displayName:"TransitionsView",_getValidStateIds:function(){var e=t.findWhere(this.props.states,{isCurrent:!0});
return t.pluck(t.without(this.props.states,e),"id")},_getStateContent:function(e){if(e.isCurrent)return i.DOM.span({className:"tau-transitions-states__list__item--current"},e.name);var n=t.contains(this.props.activeStateIds,e.id);return i.DOM.label({className:"tau-checkbox tau-extension-board-tooltip"},i.DOM.input({type:"checkbox",value:e.id,checked:n,onChange:this._onStateCheckboxChange}),i.DOM.i({className:"tau-checkbox__icon"}),i.DOM.span({className:"tau-checkbox-label"},e.name))},_onStateCheckboxChange:function(e){var t=parseInt(e.currentTarget.value,10);this.props.changeStatesAction({add:e.currentTarget.checked,values:[t]})},_toggleAllStates:function(e){var t=e.currentTarget.checked;this.props.changeStatesAction({add:t,values:this._getValidStateIds()})},render:function(){var e=0===t.difference(this._getValidStateIds(),this.props.activeStateIds).length;return i.DOM.ul({className:"tau-transitions-states__list"},i.DOM.li({className:"tau-transitions-states__list__item"},i.DOM.label({className:"tau-checkbox tau-extension-board-tooltip"},i.DOM.input({type:"checkbox",value:"all",checked:e,onChange:this._toggleAllStates}),i.DOM.i({className:"tau-checkbox__icon"}),i.DOM.span({className:"tau-checkbox-label tau-transitions-category__title"},this.props.name))),t.map(this.props.states,function(e){return i.DOM.li({key:e.id,className:"tau-transitions-states__list__item"},this._getStateContent(e))},this))}}),r=i.createClass({displayName:"PlannedView",render:function(){return i.DOM.label({className:"tau-checkbox tau-extension-board-tooltip"},i.DOM.input({type:"checkbox",checkedLink:this.props.isPlannedLink}),i.DOM.i({className:"tau-checkbox__icon"}),i.DOM.span({className:"tau-checkbox-label"},"State is Planned"))}}),s=i.createClass({displayName:"RolesView",render:function(){return i.DOM.div(null,i.DOM.label({className:"tau-select"},i.DOM.span({className:"tau-transitions-category__title tau-transitions-category__title--updater"},"Responsible role"),i.DOM.select({disabled:this.props.disabled,valueLink:this.props.activeRoleLink,className:"tau-select tau-transitions-states-feature-list__role"},t.map(this.props.roles,function(e){return i.DOM.option({key:e.id,value:e.id},e.name)
}))),i.DOM.p({className:"tau-transitions-updater-comment"},"People assigned to this role for a ",this.props.terms.name," will be responsible for it in this state."))}});return i.createClass({mixins:[i.addons.LinkedStateMixin],getInitialState:function(){return this.props.config.settings},_changePreviousStates:function(e){this._changeActiveStates("previousStateIds",e)},_changeNextStates:function(e){this._changeActiveStates("nextStateIds",e)},_changeActiveStates:function(e,i){var n={};n[e]=i.add?t.union(this.state[e],i.values):t.difference(this.state[e],i.values),this.setState(n)},_onSave:function(){this.props.saveStateAction(this.state)},_onDelete:function(e){this.props.deleteStateAction(this.state,e.currentTarget)},_isInitialOrFinal:function(){return this.state.isInitial||this.state.isFinal},_canBePlanned:function(){return!this._isInitialOrFinal()},_canBeDeleted:function(){return!this._isInitialOrFinal()},render:function(){this.state.isInitial||this.state.isFinal?null:r({isPlannedLink:this.linkState("isPlanned")});return i.DOM.div({className:"tau-transitions-setup"},i.DOM.section({className:"tau-transitions-category tau-previous-states"},a({name:"Previous states",states:this.props.config.states,activeStateIds:this.state.previousStateIds,changeStatesAction:this._changePreviousStates})),i.DOM.section({className:"tau-transitions-category tau-transitions-updater"},s({disabled:this.state.isFinal,activeRoleLink:this.linkState("activeRoleId"),roles:this.props.config.roles,terms:this.props.config.terms}),this._canBePlanned()?r({isPlannedLink:this.linkState("isPlanned")}):null,i.DOM.section({className:"tau-transitions-controls"},n({className:"tau-btn tau-primary",onClick:this._onSave},"Save"),this._canBeDeleted()?n({className:"tau-attention tau-remove-state",onClick:this._onDelete},"Delete State"):null)),i.DOM.section({className:"tau-transitions-category tau-next-states"},a({name:"Next states",states:this.props.config.states,activeStateIds:this.state.nextStateIds,changeStatesAction:this._changeNextStates})))
}})}),define("jsx!tau/components/setup.workflow/views/delete.confirmation",["require","libs/react/react-ex","jQuery","jsx!./button","Underscore"],function(e){var t=e("libs/react/react-ex"),i=(e("jQuery"),e("jsx!./button")),n=e("Underscore");return t.createClass({mixins:[t.addons.LinkedStateMixin],DEFAULT_SELECT_VALUE:"",getInitialState:function(){return{migrationStateId:this.DEFAULT_SELECT_VALUE}},_isDeleteForbidden:function(){return this.state.migrationStateId===this.DEFAULT_SELECT_VALUE},_onSubmit:function(){var e=parseInt(this.state.migrationStateId,10),t=n.findWhere(this.props.states,{id:e});this.props.onSubmit(t)},render:function(){return t.DOM.div({className:"tau-transitions-setup__content"},t.DOM.p(null,"Entities currently in this state will be moved to the selected one:"),t.DOM.select({valueLink:this.linkState("migrationStateId"),className:"tau-select tau-transitions-setup__new-state"},t.DOM.option({value:this.DEFAULT_SELECT_VALUE},"Select state"),n.map(this.props.states,function(e){return t.DOM.option({key:e.id,value:e.id},e.name)})),t.DOM.div({className:"tau-buttons"},i({onClick:this._onSubmit,className:"tau-danger",disabled:this._isDeleteForbidden()},"Delete"),i({onClick:this.props.onCancel},"Cancel")))}})}),define("tau/components/setup.workflow/services/state.item.process.settings.menu.service",["require","jQuery","Underscore","tau/core/class","libs/react/react-ex","tau/services/rename.service","template!tau/components/tauBubble/templates/board.bubble","jsx!../views/state.settings","jsx!../views/delete.confirmation"],function(e){"use strict";var t=e("jQuery"),i=e("Underscore"),n=e("tau/core/class"),a=e("libs/react/react-ex"),r=e("tau/services/rename.service"),s=e("template!tau/components/tauBubble/templates/board.bubble"),o=e("jsx!../views/state.settings"),l=e("jsx!../views/delete.confirmation");return n.extend({init:function(e,n,a){this._$toggle=t(e),this._namePlaceholder=n,this._stateSettings=a,this.onToggleRename=i.Callbacks(),this.onRename=i.Callbacks()
},isOpened:function(){return Boolean(this._$toggle.tauBubble("instance"))},showNameEditor:function(e){var t={preventDefaultBlur:e,className:"editableText i-role-taububble-ignore"};return this.onToggleRename.fire(!0),r.startRenamingActivity(this._namePlaceholder,t).done(function(t){e||this.onRename.fire(t)}.bind(this)).always(this.onToggleRename.fire.bind(this.onToggleRename,!1))},toggleSettings:function(e){if(this.isOpened())this.closeSettings();else{var t=this.showNameEditor(!0);this._stateSettings.get(e).then(function(e){this._openSettings(e).always(this._hideNameEditor.bind(this)).done(this._commitSettings.bind(this,t)).fail(this._commitRename.bind(this,t)),t.always(this.closeSettings.bind(this))}.bind(this))}},closeSettings:function(){this.isOpened()&&this._$toggle.tauBubble("hide")},_hideNameEditor:function(){r.stopRenaming(this._namePlaceholder)},_commitSettings:function(e,t){e.done(this._saveSettings.bind(this,t))},_commitRename:function(e){e.done(this.onRename.fire.bind(this.onRename))},_saveSettings:function(e,t){e.name=t,this._stateSettings.save(e)},_openSettings:function(e){var i=t.Deferred(),n=document.createElement("div");return a.renderComponent(new o({config:e,saveStateAction:function(e){i.resolve(e),this.closeSettings()}.bind(this),deleteStateAction:this._openDeleteStateConfirmation.bind(this,e,i)}),n),this._$toggle.tauBubble({showOnCreation:!0,content:n,onPositionConfig:function(e){e.collision="fit flip",e.within=t(".i-role-views-workflow-container"),e.my="center top",e.at="right bottom"},onShow:function(){this._$toggle.addClass("t3-opened")}.bind(this),onHide:function(){a.unmountComponentAtNode(n),this._$toggle.removeClass("t3-opened"),this._$toggle.tauBubble("destroy"),i.reject()}.bind(this),onResize:function(e){var t=.7*e.parent().height();e.find(".tau-states-order").css({maxHeight:t,overflowY:"auto"})},zIndex:999}),i.promise()},_openDeleteStateConfirmation:function(e,n,r,o){var u=t(o),c=document.createElement("div"),d=i.reject(e.states,function(e){return e.id===r.id
});a.renderComponent(new l({states:d,terms:e.terms,onCancel:function(){u.tauBubble("destroy")},onSubmit:function(e){n.reject(),this._stateSettings.delete(r,e)}.bind(this)}),c),u.tauBubble({className:"tau-bubble-tooltipArticle",template:s.render(),showOnCreation:!0,content:c,onPositionConfig:function(e){e.my="center top",e.at="center bottom"},onHide:function(){a.unmountComponentAtNode(c),this.destroy()},zIndex:1e3})}})}),define("jsx!tau/components/setup.workflow/views/state.item.process.workflow",["require","libs/react/react-ex","../services/state.item.process.settings.menu.service"],function(e){var t=e("libs/react/react-ex"),i=e("../services/state.item.process.settings.menu.service");return t.createClass({getInitialState:function(){return{name:this.props.name,edit:!1}},componentWillReceiveProps:function(e){e.isLoading||this.setState({name:e.name})},_getSettingsService:function(){var e=new i(this.refs.settings.getDOMNode(),this.refs.namePlaceholder.getDOMNode(),this.props.stateSettings);return e.onToggleRename.add(function(e){this.setState({edit:e,containerWidth:this.refs.container.getDOMNode().offsetWidth})},this),e.onRename.add(this._rename,this),e},_toggleSettings:function(){this._getSettingsService().toggleSettings(this.props.id)},_beginNameEdit:function(){this._getSettingsService().showNameEditor(!1)},_rename:function(e){var t=e!==this.state.name;t&&(this.setState({name:e}),this.props.renameStateAction({id:this.props.id,name:e}))},render:function(){var e=t.addons.classSet({"process-grid__item":!0,active:this.state.edit}),i=this.state.edit?{minWidth:this.state.containerWidth}:{},n=t.addons.classSet({"process-grid__state":!0,edit:this.state.edit}),a={toggleSettings:this.props.isDisabled?null:this._toggleSettings,beginEdit:this.props.isDisabled?null:this._beginNameEdit},r=!this.props.isDisabled,s=this.props.isLoading,o=t.addons.classSet({"tau-icon-general":r||s,"tau-icon-settings-small-dark":r,"tau-icon-loading":s});return t.DOM.div({ref:"container",className:e,style:i},t.DOM.div({className:n},t.DOM.div({ref:"namePlaceholder",className:"tau-in-text",onDoubleClick:a.beginEdit},this.state.name),t.DOM.span({ref:"settings",className:o,onClick:a.toggleSettings})))
}})}),define("jsx!tau/components/setup.workflow/views/view.process.workflow",["require","libs/react/react-ex","Underscore","jsx!./state.item.process.workflow"],function(e){var t=e("libs/react/react-ex"),i=e("Underscore"),n=e("jsx!./state.item.process.workflow");return t.createClass({render:function(){if(!this.props.states)return t.DOM.div({className:"tau-loader"});var e=i.map(this.props.states,function(e){return n({key:e.id,id:e.id,name:e.name,isDisabled:null!==this.props.updatingStateId,isLoading:this.props.updatingStateId===e.id,stateSettings:this.props.stateSettings,renameStateAction:this.props.renameStateAction})},this);return t.DOM.div({className:"i-role-views-workflow-container"},t.DOM.div({className:"tau-container__title"},t.DOM.span({className:"header-h3"},"Workflow for"),t.DOM.i({className:"tau-entity-icon tau-entity-icon--"+this.props.entityType},this.props.entityTerms.name)),t.DOM.div({className:"tau-container__body"},t.DOM.div({className:"process-grid__wrap"},t.DOM.div({className:"process-grid"},e))))}})}),define("tau/components/setup.workflow/controllers/controller.process.workflow",["require","Underscore","tau/core/class","jsx!../views/view.process.workflow","libs/react/react-ex"],function(e){"use strict";var t=e("Underscore"),i=e("tau/core/class"),n=e("jsx!../views/view.process.workflow"),a=e("libs/react/react-ex");return i.extend({init:function(e){this._model=e,this.rendered=t.Callbacks()},render:function(e){return this._container=e,this._view=a.renderComponent(n({entityType:this._model.getEntityType(),processId:this._model.getProcessId(),stateSettings:{get:this._model.getStateSettings.bind(this._model),save:this._model.saveStateSettings.bind(this._model),"delete":this._migrateAndDeleteState.bind(this)},renameStateAction:this._model.renameState.bind(this._model)}),e),this._model.statesChanged.add(this._updateStates.bind(this)),this._model.updateProgress.add(this._updateProgress.bind(this)),this._model.refresh()},_migrateAndDeleteState:function(e,t){this._model.migrateEntityState(e,t).then(function(t){t.deleteEntityState(e)
}.bind(this,this._model))},_updateStates:function(e){this._view&&this._view.setProps({states:e.states,entityTerms:e.entityTerms})},_updateProgress:function(e){this._view&&this._view.setProps({updatingStateId:e.updatingStateId})},destroy:function(){a.unmountComponentAtNode(this._container),this._model=null,this._view=null}})}),define("tau/components/setup.workflow/models/setup.workflow.model",["require","Underscore","jQuery","tau/core/class"],function(e){"use strict";var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class");return n.extend({EMPTY_ROLE:{id:"",name:"- Select Role -"},init:function(e,i,n){this._workflowService=e,this._processId=i,this._entityType=n,this.statesChanged=t.Callbacks(),this.updateProgress=t.Callbacks()},getProcessId:function(){return this._processId},getEntityType:function(){return this._entityType},refresh:function(){return i.when(this._getStates(),this._getTerms()).then(this._fireStatesChanged.bind(this)).then(this._fireStateUpdated.bind(this))},getStateSettings:function(e){return i.when(this._getStates(),this._workflowService.getRoles(),this._getTerms()).then(function(i,n,a){var r=t.findWhere(i,{id:e});return r.isCurrent=!0,{states:i,roles:t.union(this.EMPTY_ROLE,n),terms:a,settings:r}}.bind(this))},saveStateSettings:function(e){var n=function(i){if(i.id===e.id)return e;var n=t.contains(i.nextStateIds,e.id),a=t.contains(e.previousStateIds,i.id);return n&&!a?(i.nextStateIds=t.without(i.nextStateIds,e.id),i):!n&&a?(i.nextStateIds=t.union(i.nextStateIds,e.id),i):null},a=function(e){return this._workflowService.saveEntityState(e.id,{name:e.name,isPlanned:e.isPlanned,role:e.activeRoleId&&e.activeRoleId!==this.EMPTY_ROLE.id?{id:e.activeRoleId}:null,nextStates:t.map(e.nextStateIds,function(e){return{id:e}})})}.bind(this);this._fireStateUpdating(e.id),this._getStates().then(function(e){var r=t.chain(e).map(n).compact().map(a).value();i.when.all(r).always(this.refresh.bind(this))}.bind(this))},renameState:function(e){this._fireStateUpdating(e.id),this._workflowService.saveEntityState(e.id,{name:e.name}).always(this.refresh.bind(this))
},migrateEntityState:function(e,t){return this._fireStateUpdating(e.id),this._workflowService.migrateEntityState(e,t).then(this._fireStateUpdated.bind(this))},deleteEntityState:function(e){return this._fireStateUpdating(e.id),this._workflowService.deleteEntityState(e).always(this.refresh.bind(this))},_getStates:function(){return this._workflowService.getStates(this.getProcessId(),this.getEntityType())},_getTerms:function(){return this._workflowService.getTerms(this.getProcessId(),this.getEntityType())},_fireStatesChanged:function(e,t){this.statesChanged.fire({states:e,entityTerms:t})},_fireStateUpdating:function(e){this.updateProgress.fire({updatingStateId:e})},_fireStateUpdated:function(){this.updateProgress.fire({updatingStateId:null})}})}),define("tau/components/setup.workflow/services/longTaskRunner.service",["require","Underscore","jQuery","tau/core/class","app.path"],function(e){"use strict";var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class"),a=e("app.path"),r=n.extend({STATUS_POLL_INTERVAL:1e3,migrateEntityState:function(e,t){return this._runTask("migrateEntityState",{entityStateId:e,newEntityStateId:t})},_runTask:function(e,t){var n=i.Deferred();return this._post("/api/longTasks/"+e,t).then(this._waitForCompletion.bind(this,n),n.reject.bind(n)),n},_post:function(e,t){return i.ajax({url:a.get()+e,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(t)})},_waitForCompletion:function(e,i){i.isCompleted?e.resolve():(e.notify(i),t.delay(function(){this._queryStatus(i.taskId,e).then(this._waitForCompletion.bind(this,e),e.reject.bind(e))}.bind(this),this.STATUS_POLL_INTERVAL))},_queryStatus:function(e){return i.ajax({url:a.get()+"/api/longTasks/status",contentType:"application/json",data:{taskId:e}})}});return r}),define("tau/components/setup.workflow/services/setup.workflow.service",["require","Underscore","tau/core/class","tau/utils/utils.serverErrorTranslator","tau/core/termProcessor"],function(e){"use strict";var t=e("Underscore"),i=e("tau/core/class"),n=e("tau/utils/utils.serverErrorTranslator"),a=e("tau/core/termProcessor");
return i.extend({MAX_STATE_COUNT:1e3,init:function(e,i,n,a){this._store=e,this._store2=i,this._errorBar=n,this._longTaskRunner=a,this.statesChanged=t.Callbacks()},getStates:function(e,t){var i=["Id","Name","IsInitial","IsFinal","IsPlanned","Role.Id as ActiveRoleId","NextStates.Select(Id) as NextStateIds","PreviousStates.Select(Id) as PreviousStateIds"].join(","),n="&take="+this.MAX_STATE_COUNT;return this._store2.findAll("entityState?select={"+i+"}"+this._whereClause(e,t)+n).fail(this._handleStoreErrorResponse.bind(this))},getTerms:function(e,t){return this._store2.findAll("term?select={wordKey,value,process:{id}}"+this._whereClause(e,t)).fail(this._handleStoreErrorResponse.bind(this)).then(function(e){return new a(e).getTerms(t)})},getRoles:function(){return this._store2.findAll("role").fail(this._handleStoreErrorResponse.bind(this))},saveEntityState:function(e,t){return this._store.saveDef("entitystate",{id:e,$set:t}).fail(this._handleStoreErrorResponse.bind(this))},deleteEntityState:function(e){var t={message:"Entity State "+e.name+" has been deleted"};return this._store.removeDef("entitystate",{id:e.id}).done(this._errorBar.fire.bind(this._errorBar,"notification",t)).fail(this._handleStoreErrorResponse.bind(this))},migrateEntityState:function(e,t){return this._longTaskRunner.migrateEntityState(e.id,t.id).progress(this._errorBar.fire.bind(this._errorBar,"notification")).done(this._errorBar.fire.bind(this._errorBar,"clearError")).fail(this._handleXhrErrorResponse.bind(this))},_whereClause:function(e,t){return"&where=(process.id="+e+' and entityType.name = "'+t+'")'},_handleStoreErrorResponse:function(e){this._errorBar.fire("error",n.translateServerError(e))},_handleXhrErrorResponse:function(e){this._errorBar.fire("error",n.translateXhrError(e))}})}),define("tau/components/setup.workflow/extensions/extension.process.workflow",["require","tau/core/extension.base","../controllers/controller.process.workflow","../models/setup.workflow.model","../services/longTaskRunner.service","../services/setup.workflow.service"],function(e){"use strict";
var t=e("tau/core/extension.base"),i=e("../controllers/controller.process.workflow"),n=e("../models/setup.workflow.model"),a=e("../services/longTaskRunner.service"),r=e("../services/setup.workflow.service");return t.extend({"bus afterInit":function(e,t){this.fire("dataBind"),t.config.context.configurator.getTitleManager().set("Workflow")},"bus afterInit:last + afterRender":function(e,t,s){var o=t.config,l=o.context.configurator,u=new r(l.getStore(),l.getStore2(),l.service("errorBar"),new a),c=new n(u,o.processId,o.entityType);this._controller=new i(c),this._controller.render(s.element[0]).done(this.fire.bind(this,"setup.workflow.rendered",s.element))},"bus destroy":function(){this._controller.destroy(),this._controller=null}})}),define("template!tau/components/setup.workflow/templates/setup.workflow.template",["tau/core/templates-factory"],function(e){var t={name:"setup.workflow",engine:"jqote2",customFunctions:null,markup:'<div class="tau-container" />'};return e.register(t)}),define("tau/components/component.setup.workflow",["require","tau/components/component.creator","./setup.workflow/extensions/extension.process.workflow","template!./setup.workflow/templates/setup.workflow.template"],function(e){"use strict";var t=e("tau/components/component.creator"),i=e("./setup.workflow/extensions/extension.process.workflow"),n=e("template!./setup.workflow/templates/setup.workflow.template");return{create:function(e){var a={extensions:[i],template:n};return t.create(a,e)}}}),define("tau/models/shareLink/model.shareLink",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.entity,n=t.config.context.configurator;this.fire("dataBind",{url:n.getUrlBuilder().getShortViewUrl(i)})}})}),define("tau/ui/extensions/shareLink/ui.extension.shareLink.main",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender":function(e,t){var i=t.element,n=i.find(".i-role-trigger"),a=i.find(".i-role-content");
n.tauBubble({content:a.detach(),onShow:function(){a.find("textarea").caretAll()}})}})}),define("tau/ui/templates/shareLink/ui.template.shareLink",["tau/core/templates-factory"],function(e){var t={name:"shareLink",engine:"jqote2",markup:['<div class="tau-sharelink">','<div class="i-role-trigger">','<i class="tau-icon-general tau-icon-share"></i>',"Share link","</div>",'<div class="i-role-content">','<textarea class="tau-sharelink__link" readonly><%= this.url %></textarea>',"</div>","</div>"]};return e.register(t)}),define("tau/components/component.shareLink",["tau/components/component.creator","tau/models/shareLink/model.shareLink","tau/ui/extensions/shareLink/ui.extension.shareLink.main","tau/ui/templates/shareLink/ui.template.shareLink"],function(e,t,i,n){return{create:function(a){var r={extensions:[t,i],template:n};return e.create(r,a)}}}),define("tau/models/shareLinkReport/model.shareLinkReport",["Underscore","tau/core/extension.base","jQuery"],function(e,t,i){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("dataBind",{url:""}),this.fire("model.shareReport.ready",{getLinkReport:this._getLinkReport.bind(this,i)})},_getLinkReport:function(t){var n=t.getBoardSettingsFactory().createComponentSettings({id:"reports"}),a=t.getRestStorage();return n.get({fields:["reports"]}).then(function(t){var n=t.reports,r="settings",s=n+"Chart";"burnDown"==n&&(r="burnDownVer2Filter",s="setting");var o=e.bind(a.data,a,r,s);return i.when(o(),n)}).then(function(t,i){var n=t.value||{};n.reportType=i;var r=e.bind(a.data,a,"reports");return r({scope:"Public",publicData:n})}).then(function(e){var i=t.getUrlBuilder();return i.getNewViewUrl(e.data.key,"report"),i.getApplicationPath()+"/"+i.getBoardPageRelativePath()+i.getNewViewUrl(e.data.key,"report")})}})}),define("tau/ui/extensions/shareLinkReport/ui.extension.shareLinkReport.main",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender + model.shareReport.ready":function(e,t,i){var n=t.element,a=n.find(".i-role-trigger"),r=n.find(".i-role-loading"),s=n.find(".i-role-content").detach();
a.tauBubble({content:s,onShow:function(){r.show();var e=s.find("textarea");e.hide(),i.getLinkReport().done(function(t){r.hide(),e.show().val(t).caretAll()})}})}})}),define("tau/ui/templates/shareLinkReport/ui.template.shareLink",["tau/core/templates-factory"],function(e){var t={name:"shareLinkReport",engine:"jqote2",markup:['<div class="tau-sharelink tau-sharelink_report">','<div class="i-role-trigger">','<i class="tau-icon-general tau-icon-share"></i>',"Share link","</div>",'<div class="i-role-content">','<div class="i-role-loading">loading...</div>','<textarea class="tau-sharelink__link" readonly><%= this.url %></textarea>',"</div>","</div>"]};return e.register(t)}),define("tau/components/component.shareLinkReport",["tau/components/component.creator","tau/models/shareLinkReport/model.shareLinkReport","tau/ui/extensions/shareLinkReport/ui.extension.shareLinkReport.main","tau/ui/templates/shareLinkReport/ui.template.shareLink"],function(e,t,i,n){return{create:function(a){var r={extensions:[t,i],template:n};return e.create(r,a)}}}),define("tau/views/view.tabs",["Underscore","tau/views/view.container"],function(e,t){return t.extend({startLifeCycle:function(t){var i=this;i.setDefaultConfig(),e.extend(i.config,(t||{}).data),i.config=this.processConfig(i.config),i.fire("beforeInit",{config:i.config})},"bus beforeInit + state.processed":function(){var t=this,i=t.config.children;t.children=[];var n=e.isArray(i)&&e.size(i)>0&&t.config.visible;if(n){var a=t.config.children,r=t.config.context||{};this.fire("createComponents",{components:a,context:r})}else t.completeInitializationWithoutChildren()},processConfig:function(t){return this.additionalHeaderTabIndexList={},this.tabsHeader=e.defaults(t.tabsHeader||{},{type:"tabsHeader",options:{more:!1}}),this.tabsHeader.children=[],this.panels=[],e.each(t.tabs,this.addTabInfo,this),e.each(t.additionalHeaders||[],this.addAdditionalActionToTab,this),t.children=[this.tabsHeader].concat(this.panels),t},addTabInfo:function(e){var t=e.selected===!0,i={type:"container",name:e.label+" tab container",selected:t,children:e.header||[],label:e.label};
this.tabsHeader.children.push(i);var n={type:"container",visible:t,children:e.items||[]};this.panels.push(n)},addAdditionalActionToTab:function(e){var t=e||{};t.position={right:!0};var i=this.tabsHeader;i.children.push(t),this.additionalHeaderTabIndexList[i.children.length]=!0}})}),define("tau/ui/extensions/tabs/ui.extension.tabs.state.base",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){var i=t.extend({getRestoredState:function(){return $.Deferred().resolve(null)},"bus beforeInit":function(t){var i=t.data.config,n=i.children,a=e.filter(n[0].children,function(t){return"container"==t.type&&e.has(t,"selected")});this.initialLabel=null;var r=this;e.forEach(a,function(e){1==e.selected&&(r.initialLabel=e.label)});var s=n.slice(1);this.getRestoredState().done(function(t){var i=!1;t&&e.forEach(a,function(e,n){e.label==t?(i=!0,s[n].visible=!0,e.selected=!0):(s[n].visible=!1,e.selected=!1)}),0==i&&e.forEach(a,function(e,t){e.label==r.initialLabel&&(s[t].visible=!0,e.selected=!0)}),r.fire("state.processed",{})})},"bus childrenRendered":function(t){var i=[];e.forEach(t.data.config.tabs,function(e,t){i[t]={label:e.label}}),this.fire("headerRendered",{component:t.data.children[0],switchConfig:i});var n=t.data.children.slice(1);this.fire("tabsRendered",{components:n})},"bus headerRendered":function(t){var i=t.data.component,n=e.bind(function(t,i){e.bind(this.onHeaderSwitched,this)(i)},this);i.on("switched",n),this.header=i},"bus headerRendered+tabsRendered":function(t){var i=t.headerRendered.data.switchConfig,n=t.tabsRendered.data.components,a={};e.forEach(n,function(e,t){a[i[t].label]=e}),this.tabs=a},onHeaderSwitched:function(e){this.tabs[e]&&this.selectTabExternal(e)},selectTabInternal:function(t){var t=t||this.initialLabel;if(this.tabs[t]){var i=this.tabs[t];e.forEach(this.tabs,function(e){e.fire("hide")}),i.once("show.completed",e.bind(function(){this.fire("tabs.switched.completed",t)},this)),i.fire("show"),this.header.fire("switched.after",t),this.fire("tabs.switched")
}},selectTabExternal:function(e){this.selectTabInternal(e)}});return i}),define("tau/ui/extensions/tabs/ui.extension.tabs.state.routing",["Underscore","tau/ui/extensions/tabs/ui.extension.tabs.state.base"],function(e,t){return t.extend({getRestoredState:function(){var e=$.Deferred(),t=this.getStateName();return this.config.context.componentSettings.get({fields:[t],callback:function(i){e.resolve(i[t])}}),e},getStateName:function(){return this.config.stateName},selectTabExternal:function(e){var t=this.config.context.componentSettings,i={},n=this.getStateName();i[n]=e,t.set({set:i})},onStateChanged:function(e){var t=e[this.getStateName()]||this.defaultState;this.selectTabInternal(t)},"bus initialize":function(){var e=this,t=e.config.context.componentSettings;t.bind({fields:[this.getStateName()],listener:e,callback:e.onStateChanged})},destroy:function(){var e=this,t=e.config.context.componentSettings;t.unbind({listener:e,callback:e.onStateChanged}),this._super()}})}),define("tau/ui/extensions/tabs/ui.extension.tabs.state.simple",["Underscore","tau/ui/extensions/tabs/ui.extension.tabs.state.base"],function(e,t){var i=t.extend({});return i}),define("tau/components/component.tabs",["tau/components/component.creator","tau/views/view.tabs","tau/components/extensions/component.creator.extension","tau/ui/extensions/tabs/ui.extension.tabs.state.routing","tau/ui/extensions/tabs/ui.extension.tabs.state.simple","tau/ui/extensions/layout/ui.extension.layout","tau/ui/templates/container/ui.template.container.list"],function(e,t,i,n,a,r,s){return{create:function(o){var l=o.stateName?n:a,u={extensions:[i,l,r].concat(o.extensions||[]),ViewType:t,template:s};return e.create(u,o)}}}),define("tau/ui/extensions/tabsHeader/ui.extension.tabsHeader.layout",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus beforeInit":function(t,i){var n=i.config;this.options=e.defaults(n.options||{},{itemClassName:"tab-item",itemRightClassName:"tab-item tab-item-right-part",selectedClassName:"selected"})
},"bus afterRender + childrenRendered":function(i,n,a){var r=this,s=n.element,o=s.is(".i-role-tabheaders")?s:s.find(".i-role-tabheaders:first"),l=a.childrenEvtArgs,u=a.config.children;e.forEach(l,function(e,t){var i=e.element,n=u[t];r.insertChild(o,i,n)}),s.on("click",".i-role-tabheader",function(){var e=t(this).data("label");e&&r.fire("switched",e)}),this.fire("$el.ready",s)},insertChild:function(i,n,a){var r=this.options,s=[];e.has(a.position||{},"right")&&a.position.right?s.push(r.itemRightClassName):(s=["i-role-tabheader"],s.push(r.itemClassName)),a.selected&&s.push(r.selectedClassName),a.className&&s.push(a.className),s.push("i-taus");var o=a.label||n.text();n.length&&t("<li></li>").addClass(s.join(" ")).attr("data-label",o).attr("taustype","view-entity").attr("tauspref","tab").append(n).appendTo(i)},"bus $el.ready:last + switched.after":function(e,i,n){var a=i.find(".i-role-tabheader"),r=this.options;a.each(function(){var e=t(this);e.toggleClass(r.selectedClassName,e.data("label")==n)})}})}),define("tau/ui/templates/tabsHeader/ui.template.tabsHeader.item.more",["tau/core/templates-factory"],function(e){var t={name:"tabsHeader.item.more",markup:['<li class="tab-item tab-item-more-trigger i-role-moretrigger">','<span  class=" i-role-morelabel" data-text="More">More</span>','<ul class="i-role-moreholder drop-down-list"></ul>',"</li>"]};return e.register(t)}),define("tau/ui/extensions/tabsHeader/ui.extension.tabsHeader.more",["Underscore","jQuery","tau/core/extension.base","tau/ui/templates/tabsHeader/ui.template.tabsHeader.item.more"],function(e,t,i,n){function a(e){return function(){setTimeout(e,100)}}return i.extend({"bus $el.ready":function(t,i){var n=e.bind(function(){i.parents("body").length?this.fire("view.dom.ready"):e.delay(n,100)},this);n()},"bus beforeInit + $el.ready":function(i,a,r){var s=r.find(".i-role-tabheaders"),o=r.find(".i-role-tabheader"),l=a.config.context.configurator.getTemplateFactory().get(n.name).bind({},{});l.hide(),l.appendTo(s),r.addClass("entity-tabs_more_enable");
var u=r.find(".i-role-moretrigger"),c=r.find(".i-role-moreholder");u.tauBubble({content:c.detach(),zIndex:3,onShow:function(){c.find(".i-role-tabheader").each(function(e,i){var n=t(i).find(".ui-quantity");n.length&&n.text(o.filter("[data-label="+t(i).data("label")+"]").find(".ui-quantity").text())})}}),this.on("destroy",function(){c.remove()}),c.on("click",".i-role-tabheader",e.bind(function(e){var i=t(e.currentTarget).data("label");i&&this.fire("switched",i)},this))},"bus $el.ready + view.dom.ready":function(i,n){var r=n.find(".i-role-tabheaders"),s=n.find(".i-role-tabheader"),o=n.find(".i-role-moretrigger"),l=o,u=l.find(".i-role-morelabel"),c=o.tauBubble("option","content");s.each(function(){var e=t(this).clone();e.addClass("drop-down-option"),c.append(e)});var d=c.find(".i-role-tabheader"),p=function(e){return e.offset().top==r.offset().top},f=function(){o.data("ui-tauBubble")&&o.tauBubble("hide");for(var e=!1,i=0;!e&&100!=i;){i++;var n=t();d.each(function(e,i){var a=t(i),r=s.filter(function(e,i){return t(i).data("label")==a.data("label")}),o=p(r);if(o?(n=r,r.css("visibility","visible")):r.css("visibility","hidden"),a.attr("hidden",o),a.toggleClass("selected",r.is(".selected")),r.is(".selected")){l.toggleClass("selected",!o);var c=u.data("text");o||(c=[r.find(".ui-label").text(),c].join(" - ")),u.text(c)}}),n.length?n.after(l):r.prepend(l);var a=0==d.filter(":not([hidden])").length;l.toggle(!a),a||p(l)?e=!0:l.prev().before(l)}};f(),t(window).on("resize.more",e.debounce(f,100)),this.bus.on("switched.after",f,this),this.bus.globalBus.on("setBadgeData",a(f),this),this.bus.globalBus.on("expanded",a(f),this),this.bus.globalBus.on("collapsed",a(f),this),this.bus.globalBus.on("zoom.updated",a(f),this),this.bus.globalBus.on("collapser.switched",a(f),this)},destroy:function(){t(window).off("resize.more"),this._super()}})}),define("tau/ui/templates/tabsHeader/ui.template.tabsHeader",["tau/core/templates-factory"],function(e){var t={name:"tabsHeader",markup:['<div class="entity-tabs">','<div class="entity-tabs__holder">','<ul class="entity-tabs__list i-role-tabheaders">',"</ul>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.tabsHeader",["tau/components/component.creator","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/tabsHeader/ui.extension.tabsHeader.layout","tau/ui/extensions/tabsHeader/ui.extension.tabsHeader.more","tau/ui/templates/tabsHeader/ui.template.tabsHeader"],function(e,t,i,n,a,r){return{create:function(s){var o=_.defaults(s.options||{},{more:!1}),l={extensions:_.compact([i,n,o.more?a:null].concat(s.extensions||[])),ViewType:t,template:s.template||r};return e.create(l,s)}}}),define("tau/models/tags/model.tags.data",["Underscore","tau/core/extension.base","tau/models/tags/tagsProcessor"],function(e,t,i){return t.extend({"bus beforeInit":function(e,t){var n=t.config.context.entity,a=t.config.context.configurator;this.fire("entity.ready",n),this.fire("configurator.ready",a),this.fire("tagsProcessor.ready",new i)},"bus configurator.ready + entity.ready + tagsProcessor.ready + beforeInit":function(t,i,n,a){var r=i.getStore();r.evictProperties(n.id,n.entityType.name,["tags"]),r.get(n.entityType.name,{id:n.id,fields:["id","tags"]}).done(e.bind(function(e){this.fire("dataBind",{tags:this._process(a.asArray(e[0].data.tags),i)})},this))},_process:function(t,i){return t=e.map(t,function(e){var t={name:e},n=t.name.match(/^duplicateOf\#(\d+)$/i);return n&&(t.isDuplicate=!0,t.href=i.getUrlBuilder().getNewViewUrl(n[1],"bug",!0)),t})}})}),define("tau/models/tags/model.tags.editable",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus configurator.ready:last + entity.ready:last + tagsProcessor.ready:last + form.submitted":function(e,t,i,n,a){var r=t.getStore();r.save(i.entityType.name,{id:i.id,$set:{tags:n.asString(a.tags)},fields:["id","tags"]}).done()},"bus configurator.ready + entity.ready + beforeInit":function(t,i,n){var a=i.getStore();a.unbind(this),a.on({eventName:"afterSave",type:n.entityType.name,listener:this,filter:{id:n.id}},e.bind(function(t){t.data.cmd&&t.data.cmd.config.$set&&e.has(t.data.cmd.config.$set,"tags")&&this.fire("refresh")
},this))},"bus configurator.ready > destroy":function(e,t){var i=t.getStore();i.unbind(this)}})}),define("tau/models/tags/model.tags.duplicateBug",["tau/core/extension.base"],function(e){return e.extend({"bus configurator.ready":function(e,t){var i=t.getGlobalBus();i.removeAllListeners(this),i.on("bugWasMarkedAsDuplicate",_.bind(function(e){this.fire("bug.duplicated",{sourceId:e.data.bugId,duplicateId:e.data.duplicateBugId})},this),this)},"bus configurator.ready:last + entity.ready:last + bug.duplicated":function(e,t,i,n){(i.id==n.duplicateId||i.id==n.sourceId)&&(t.getStore().evictProperties(i.id,i.entityType.name,["tags"]),this.fire("refresh"))},"bus configurator.ready > destroy":function(e,t){t.getGlobalBus().removeAllListeners(this)}})}),define("tau/ui/behaviour/tags/ui.behaviour.tagsEditor",["Underscore","jQuery"],function(e,t){t.widget("ui.tagsEditor",{options:{alwaysShowEditor:!1,renderEditorFirst:!1,selector:".ui-tags__tag",onSave:t.noop,onShow:t.noop},_create:function(){this.init()},init:function(){this.$list=t(this.element);var i=this.options.selector,n=this.$list.find(i);n.append('<span class="ui-tags__control-delete i-role-actiondelete" title="Delete tag">Delete tag</span>');var a=this;this.$list.delegate(".ui-tags__control-delete","click",function(e){e.preventDefault(),t(this).parents(i).eq(0).remove(),a.options.onSave(a.getTags())});var r=e.bind(this.showEditor,this);this.$widget=t(['<li class="ui-tags__editor">',"</li>"].join("")),this.options.renderEditorFirst?this.$list.prepend(this.$widget):this.$list.append(this.$widget),this.options.alwaysShowEditor?r():(this.$widget.append(t(['<span title="Add tag" class="ui-tags__editor__control-show i-role-control_show">',"<i>Add tag</i>","</span>"].join(""))),this.$widget.find(".i-role-control_show").click(function(e){e.preventDefault(),r()}))},_processAddTag:function(e){var t=this,i=t.parseTags(e.find(":text").val()),n=t.getTags();n=n.concat(i),t.options.onSave(n)},showEditor:function(){if(!this._editorIsVisible){if(!this.$editor){var i=t(['<form class="ui-tags__editor__inner">','<input type="text" maxlength="50" class="tau-in-text ui-tags__editor__input" />','<span class="tau-inline-group">','<button title="Add"  type="submit"  class="tau-btn tau-btn-small ui-tags__editor__button-submit">Add</button>',this.options.alwaysShowEditor?"":'<button title="Cancel" type="reset"  class="tau-btn tau-btn-small tau-close ui-tags__editor__button-cancel"></button>',"</span>","</form>"].join("")),n=this;
i.on("submit",function(e){e.preventDefault(),n._processAddTag(i)}),i.on("reset",function(){n.hideEditor()}),i.find(":text").keydown(e.bind(this.mapKeys,this)),i.appendTo(this.$widget),this.$editor=i,this.$text=i.find(":text")}this.resetEditor(),this.$widget.toggleClass("ui-tags__editor-active",!0),this._editorIsVisible=!0,this.$editor.find(":text").focus(),this._trigger("show",this.$editor)}},focus:function(){this.$editor.find(":text").focus()},hideEditor:function(){this.$editor&&this._editorIsVisible&&(this.$editor.find(":text").blur(),this.$widget.toggleClass("ui-tags__editor-active",!1),this._editorIsVisible=!1,this.resetEditor())},resetEditor:function(){this.$editor&&this.$editor.find(":text").val("")},setValue:function(t){e.isArray(t)&&(t=t.join(", ")),this.$editor&&this.$editor.find(":text").val(t)},getValue:function(){return this.parseTags(this.$editor.find(":text").val())},mapKeys:function(e){switch(e.which){case 27:e.preventDefault(),this.hideEditor(e)}},getTagText:function(t){return e.trim(t.find("span:first").text())},getTags:function(){var e=[],i=this;return this.$list.find(this.options.selector).each(function(n,a){var r=t(a);e.push(i.getTagText(r))}),e},parseTags:function(t){t=t||"";var i=t.split(",");return i=e(i).map(function(t){return e.trim(t)}),i=e.uniq(i),i=e.compact(i)}})}),define("tau/ui/extensions/tags/ui.extension.tags.editable",["Underscore","tau/core/extension.base","tau/ui/behaviour/tags/ui.behaviour.tagsEditor"],function(e,t){return t.extend({category:"edit",alwaysShowTagsEditField:!1,"bus beforeInit":function(e,t){this.alwaysShowTagsEditField=t.config.alwaysShowTagsEditField||!1,this.renderEditorFirst=t.config.renderEditorFirst||!1},"bus afterRender:last+focus":function(e,t){t.element.find(".i-role-editor").tagsEditor("focus")},"bus afterRender":function(t,i){var n=i.element;this.fire("$el.ready",n);var a=this,r=n.find(".i-role-editor");r.bind("tagseditorshow",e.bind(this.fire,this,"$editor.shown",r)),r.tagsEditor({validation:{trim:!0},alwaysShowEditor:this.alwaysShowTagsEditField,renderEditorFirst:this.renderEditorFirst,onSave:function(e){r.addClass("data-saving"),a.fire("form.submitted",{tags:e})
}}),this.fire("$editor.ready",r)},"bus tagsProcessor.ready:last + $editor.ready:last + external.toggleTag":function(t,i,n,a){n.tagsEditor("showEditor");var r=n.find(":text"),s=i.asArray(r.val());a.checked?s.push(a.text):s=e.without(s,a.text);var o=i.asString(s);o.length?r.val(o):n.tagsEditor("hideEditor")}})}),define("tau/ui/extensions/tags/ui.extension.tags.autocomplete",["Underscore","tau/libs/store2/store2","tau/core/extension.base"],function(e,t,i){return i.extend({category:"edit","bus configurator.ready":function(e,i){this.fire("store2.ready",new t(i))},"bus store2.ready:last + tagsProcessor.ready:last + autocomplete.resolve":function(t,i,n,a){var r=a.$input[0].selectionEnd;if(e.isUndefined(r)&&document.selection){var s=document.selection.createRange(),o=document.selection.createRange().text.length;s.moveStart("character",-a.$input.val().length),r=s.text.length-o}var l=a.request.term.substr(0,r),u=e.ltrim(e.strRightBack(l,","));u.length>1?(r-=u.length,a.$input.data("acTerm",u),a.$input.data("acPos",r),i.findAll("Tag?select={"+["name"].join(",")+'}&where=name.startsWith("'+i.arg(u.toLowerCase())+'")').done(function(t){var i=n.asArray(e.pluck(t,"name"));i=e.sortBy(i,function(e){return e.toLowerCase()}),a.next(i)})):a.next([])},"bus tagsProcessor.ready:last + $editor.shown":function(t,i,n){var a=n.find(":text"),r=e.bind(this.fire,this);a.autocomplete({minLength:2,position:{my:"left top",at:"left bottom",collision:"flip"},source:function(e,t){r("autocomplete.resolve",{$input:a,request:e,next:t})},focus:function(){return!1},select:function(e,t){var n=t.item.value,r=a.val(),s=r.substr(0,a.data("acPos"))+r.slice(a.data("acPos")+a.data("acTerm").length);return s=i.asArray(s),s.push(n),s=i.asString(s),a.val(s),a.focus(),!1}});var s=a.data("ui-autocomplete");s._renderItem=function(t,i){return $("<li class='tau-autocomplete__item'></li>").data("ui-autocomplete-item",i).append("<a class='tau-autocomplete__itemtrigger drop-down-option'>"+e.escape(i.label)+"</a>").appendTo(t)
},s._renderMenu=function(e,t){$(e).addClass("tau-autocomplete__menu drop-down-list tau-autocomplete__menu__tags").css({maxHeight:.4*$(window).height(),zIndex:this.element.zIndex()+1});var i=this;$.each(t,function(t,n){i._renderItem(e,n)})}}})}),define("tau/ui/templates/tags/ui.template.tags.item",["tau/core/templates-factory"],function(e){var t={name:"tags.item",engine:"jqote2",markup:['<li class="ui-tags__tag i-role-tag" rel="tag">',"<span>","<% if (this.isDuplicate) { %>",'<a class="ui-tags__duplicateBug" href=<%= this.href %>>',"<%! this.name %>","</a>","<% } else { %>","<%! this.name %>","<% } %>","</span>","</li>"]};return e.register(t)}),define("tau/ui/templates/tags/ui.template.tags",["tau/core/templates-factory","tau/ui/templates/tags/ui.template.tags.item"],function(e){var t={name:"tags",engine:"jqote2",markup:["<div>",'<ul class="ui-tags i-role-editor">','<%= fn.sub("tags.item", this.tags) %>',"</ul>","</div>"]};return e.register(t)}),define("tau/components/component.tags",["tau/components/component.creator","tau/models/tags/model.tags.data","tau/models/tags/model.tags.editable","tau/models/tags/model.tags.duplicateBug","tau/ui/extensions/tags/ui.extension.tags.editable","tau/ui/extensions/tags/ui.extension.tags.autocomplete","tau/ui/templates/tags/ui.template.tags"],function(e,t,i,n,a,r,s){return{create:function(o){var l={extensions:[t,i,n,a,r],template:s};return e.create(l,o)}}}),define("tau/models/tagsCloud/model.tagsCloud",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context;this.fire("entity.ready",i.entity),this.fire("configurator.ready",i.configurator)},"bus configurator.ready + entity.ready + beforeInit":function(t,i,n){var a=i.getStore(),r=["id","tags"],s=n.entityType.name;e.has(a.config.proxy.types[s].refs,"project")&&r.push({project:["id"]}),a.get(s,{id:n.id,fields:r}).done(e.bind(function(e){this.fire("entityTags.ready",e[0].data.tags),this.fire("entityProject.ready",e[0].data.project)
},this)),a.unbind(this),a.on({eventName:"afterSave",type:s,listener:this,filter:{id:n.id}},e.bind(function(t){var i=t.data.cmd;i&&i.config&&i.config.$set&&e.has(i.config.$set,"tags")&&this.fire("refresh")},this)),a.on({eventName:"afterSave",type:s,listener:this,filter:{id:n.id},hasChanges:["project"]},e.bind(function(){this.fire("refresh")},this))},"bus configurator.ready + entityProject.ready + beforeInit":function(t,i,n){var a=n&&n.id?n.id:0;$.ajax({url:i.getApplicationPath()+"/PageServices/WebMethods.asmx/GetAllTags",type:"post",data:JSON.stringify({projectID:a}),contentType:"application/json; charset=utf-8"}).done(e.bind(function(t){var i=e.map(t.d,function(e,t){return{name:t,size:e}});i=this._process(i),this.fire("cloudData.ready",i)},this))},"bus cloudData.ready + entityTags.ready":function(e,t){this.fire("dataBind",{showSearch:t.length>20,tags:t})},"bus configurator.ready > destroy":function(e,t){t.getStore().unbind(this)},_process:function(t){var i=e.max(e.pluck(t,"size"))||1,n=7/i;return e.each(t,function(e){e.size=Math.round(n*e.size)}),t=e.sortBy(t,function(e){return 20-e.size+"_"+e.name.toLowerCase()}),e.each(t,function(e,t){t>=100&&(e.hidden=!0)}),t}})}),define("tau/ui/extensions/tagsCloud/ui.extension.tagsCloud.editable",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender":function(e,t){var i=this,n=t.element;this.fire("$el.ready",n),n.on("click",".i-role-tag",function(){var e=$(this);e.toggleClass("tau-active"),i.fire("tag.toggled",{text:e.text(),checked:e.hasClass("tau-active")})})}})}),define("tau/ui/extensions/tagsCloud/ui.extension.tagsCloud.filter",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({"bus $el.ready":function(e,i){var n=this;i.delegate("input[name=filter]","keyup",function(){n.fire("filter.changed",t(this).val())}),i.delegate("input[name=filter]","keydown",function(e){e.keyCode==t.ui.keyCode.ESCAPE&&e.stopPropagation(),e.which==t.ui.keyCode.ENTER&&t(this).trigger("blur")
})},match:function(t,i){var n=t.toLowerCase();return 0==i.length||e.any(i,function(e){return n.indexOf(e)>=0})},"bus $el.ready:last + filter.changed":function(i,n,a){var r=e.trim(a).toLowerCase().split(/\s+/g),s=this.match,o=n.find(".i-role-tag"),l=0;e.trim(a).length>0?(o.each(function(){var e=t(this),i=e.text(),n=s(i,r);n&&(l+=1),e.toggleClass("tau-tags-cloud__item_filtered_false",!n),e.toggleClass("tau-tags-cloud__item_filtered_true",n)}),n.toggleClass("tau-tags-cloud_filtered_none",0==l)):(n.toggleClass("tau-tags-cloud_filtered_none",!1),o.toggleClass("tau-tags-cloud__item_filtered_false",!1),o.toggleClass("tau-tags-cloud__item_filtered_true",!1)),this.fire("filter.completed")}})}),define("tau/ui/templates/tagsCloud/ui.template.tagsCloud.item",["tau/core/templates-factory"],function(e){var t={name:"tagsCloud.item",engine:"jqote2",markup:['<span class="tau-tags-cloud__item tau-tag-rank-<%= this.size %> <% if (this.hidden){ %> tau-tags-cloud__item_hidden_true<% } %> i-role-tag">',"<%! this.name %>","</span>"]};return e.register(t)}),define("tau/ui/templates/tagsCloud/ui.template.tagsCloud",["tau/core/templates-factory","tau/ui/templates/tagsCloud/ui.template.tagsCloud.item"],function(e){var t={name:"tagsCloud",engine:"jqote2",markup:['<div class="tau-tags-cloud">',"<% if (this.showSearch) { %>",'<div class="tau-search-team">','<span class="tau-inline-group tau-search">','<input name="filter" type="text" class="tau-in-text" placeholder="Search Tag" tabindex="-1" />','<button type="button" class="tau-btn tau-search"></button>',"</span>","</div>","<% } %>",'<div class="tau-tags-cloud__inner">','<div class="tau-tags-cloud-items">','<%= fn.sub("tagsCloud.item", this.tags) %>',"</div>",'<div class="tau-tags-cloud__message" data-text-nofound="No such tag found" data-text-noitems="No available tags"></div>',"</div>","</div>"]};return e.register(t)}),define("tau/components/component.tagsCloud",["tau/components/component.creator","tau/models/tagsCloud/model.tagsCloud","tau/ui/extensions/tagsCloud/ui.extension.tagsCloud.editable","tau/ui/extensions/tagsCloud/ui.extension.tagsCloud.filter","tau/ui/templates/tagsCloud/ui.template.tagsCloud"],function(e,t,i,n,a){return{create:function(r){var s={extensions:[t,i,n],template:a};
return e.create(s,r)}}}),define("tau/ui/extensions/tagsEditor/ui.extension.tagsEditor.integration",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({category:"edit","bus beforeInit":function(e,t){this.fire("configurator.ready",t.config.context.configurator)},"bus afterRender":function(e,t){this.fire("$el.ready",t.element)},"bus configurator.ready":function(t,i){i.getComponentBusRegistry().getByName("tagsCloud").done(e.bind(function(t){t.removeAllListeners(this),t.on("tag.toggled",e.bind(function(e,t){this.fire("tagsCloudTag.toggled",t)},this),this),this.fire("tagsCloudBus.ready",t)},this))},"bus componentsCreated":function(t,i){var n=e.pluck(i,"component"),a=n[0],r=n[1];this.fire("tagsBus.ready",a),this.fire("tagsCloudContainerBus.ready",r)},"bus $el.ready:last + tagsCloudContainerBus.ready":function(e,t,i){var n=this;t.on("click",".i-role-action-cloud",function(){$(this).toggleClass("tau-active"),t.find(".i-role-tagscloudcontainer").toggleClass("tau-active"),n.cloudVisible||(n.cloudVisible=!0,i.fire("refresh",{visible:!0}))})},"bus $el.ready:last + tagsBus.ready":function(e,t,i){var n=t.find(".i-role-tabheader").detach().removeAttr("hidden");this.fire("$tabheader.ready",n),t.find(".i-role-editor").append(n),i.on("afterRender",function(){t.find(".i-role-editor").append(n)}),t.on("click",".i-role-editor :submit",function(){t.find(".i-role-action-cloud").toggleClass("tau-active",!1),t.find(".i-role-tagscloudcontainer").toggleClass("tau-active",!1)})},"bus tagsCloudBus.ready + tagsBus.ready":function(t,i,n){i.removeAllListeners(this),i.on("tag.toggled",e.bind(function(e,t){n.fire("external.toggleTag",t)},this),this),i.on("afterRender",e.bind(function(e,t){this.fire("$cloudEl.ready",t.element)},this),this)},"bus $el.ready:last + $cloudEl.ready":function(e,t,i){var n=i.find("[name=filter]").length>0,a=t.find(".i-role-action-cloud");a.toggleClass("tau-tags-cloud__trigger_filter_true",n)}})}),define("tau/ui/templates/tagsEditor/ui.template.tagsEditor",["tau/core/templates-factory"],function(e){var t={name:"tagsEditor",engine:"jqote2",markup:['<div class="tau-container">','<div class="ui-tagsEditor">','<div class="tau-actions i-role-tabheaders i-role-tagslistcontainer">',"</div>",'<li class="i-role-tabheader ui-tags__action" hidden data-tab="tagsCloud">','<div class="tau-tags-cloud__trigger i-role-action-cloud" >',"<i>","Tags Cloud","</i>","</div>","</li>",'<div class="tau-tab-content">','<div class="tau-tab-pane i-role-tagscloudcontainer">',"</div>","</div>","</div>","</div>"]};
return e.register(t)}),define("tau/components/component.tagsEditor",["tau/components/component.creator","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/tagsEditor/ui.extension.tagsEditor.integration","tau/ui/templates/tagsEditor/ui.template.tagsEditor"],function(e,t,i,n,a,r){return{create:function(s){var o={ViewType:t,extensions:[i,n,a],template:r};return e.create(o,s)}}}),define("tau/ui/extensions/tagsInline/model",["Underscore","tau/core/class"],function(e,t){return t.extend({init:function(e,t){this.store=e,this.entity=t,this.items=[],this.listenServer()},processString:function(t){var i=t.split(",");return i=e.compact(e.map(i,function(e){return e.trim()})),i=e.map(i,function(e){return{text:e}}),i=this.processUnique(i)},processUnique:function(t){return e.uniq(t,function(e){return e.text.toLowerCase()})},createString:function(t){return e.pluck(t,"text").join(", ")},load:function(){return this.store.getDef(this.entity.entityType.name,{id:this.entity.id,fields:["id","tags"]}).then(e.bind(function(e){this.items=this.processString(e.tags)},this))},addByString:function(e){var t=this.processString(e);return this.items=this.processUnique(this.items.concat(t)),this.save()},removeByString:function(t){return t=e.asString(t).trim(),this.items=e.reject(this.items,function(e){return e.text===t}),this.save()},save:function(){return this.store.saveDef(this.entity.entityType.name,{id:this.entity.id,$set:{tags:this.createString(this.items)}})},listenServer:function(){this.store.unbind(this),this.store.on({eventName:"afterSave",type:this.entity.entityType.name,filter:{id:this.entity.id},hasChanges:["tags"],listener:this},e.bind(function(e){var t=e.data.changes.tags;this.items=this.processString(t)},this))}})}),define("tau/ui/extensions/tagsInline/jquery.tauTagsAutocomplete",["Underscore","jQuery","tau/models/tags/tagsProcessor"],function(e,t,i){var n=new i;return t.widget("ui.tauTagsAutocomplete",t.ui.autocomplete,{options:{store2:null,minLength:2,position:{my:"left top",at:"left bottom",collision:"flip"},source:function(e,t){this._resolve(e,t)
},focus:function(){return!1},select:function(e,i){var a=t(e.target),r=i.item.value,s=a.val(),o=a.data("acPos"),l=s.substr(0,o)+s.slice(o+a.data("acTerm").length);return l=n.asArray(l),l.push(r),l=n.asString(l),a.val(l).focus(),!1}},_renderItem:function(i,n){return t("<li class='tau-autocomplete__item'></li>").data("ui-autocomplete-item",n).append("<a class='tau-autocomplete__itemtrigger drop-down-option'>"+e.escape(n.label)+"</a>").appendTo(i)},_renderMenu:function(e,i){t(e).addClass("tau-autocomplete__menu drop-down-list tau-autocomplete__menu__tags").css({maxHeight:.4*t(window).height(),zIndex:this.element.zIndex()+1});var n=this;t.each(i,function(t,i){n._renderItem(e,i)})},_resolve:function(e,i){t.when(this._resolveTagTerm(e)).then(this._resolveTags.bind(this)).then(i)},_resolveTagTerm:function(t){var i=this.element[0].selectionEnd;if(e.isUndefined(i)&&document.selection){var n=document.selection.createRange(),a=document.selection.createRange().text.length;n.moveStart("character",-this.element.val().length),i=n.text.length-a}var r=t.term.substr(0,i),s=e.ltrim(e.strRightBack(r,","));return s.length>1&&(i-=s.length,this.element.data("acTerm",s).data("acPos",i)),s},_resolveTags:function(i){if(i.length<=1)return[];var a=["name"],r=this.options.store2.arg(i.toLowerCase()),s=t.Deferred();return this.options.store2.findAll("Tag?select={"+a.join(",")+'}&where=name.startsWith("'+r+'")').done(function(t){var i=n.asArray(e.pluck(t,"name"));i=e.sortBy(i,function(e){return e.toLowerCase()}),s.resolve(i)}),s}})}),define("tau/ui/extensions/tagsInline/ui.extension.tagsInline",["Underscore","tau/core/extension.base","tau/libs/store2/store2","./jquery.tauTagsAutocomplete"],function(e,t,i){return t.extend({init:function(e,t,i){this.configurator=t,this.model=i,this._super(e)},"bus beforeInit":function(){$.when(this.model.load()).then(e.bind(function(){this.fire("dataBind",this.model)},this))},"bus afterRender":function(t,n){var a=n.element,r=a.find("input"),s=r.closest("li");this.toggleHolderFullWidth(s,!this.model.items.length),a.on("click",function(){r.focus()
}),a.find("form").on("submit",!1),r.on({keydown:this._handleKeyDown.bind(this),input:this._handleInput.bind(this),keyup:this._handleInput.bind(this)}),r.tauTagsAutocomplete({store2:new i(this.configurator)}),a.on("click",".i-role-actiondelete",e.bind(function(e){this._removeTag($(e.currentTarget).parent()),r.tauTagsAutocomplete("close"),this.toggleHolderFullWidth(s,!1)},this))},_handleKeyDown:function(e){var t=$(e.target),i=t.closest("li"),n=t.val(),a=$.ui.keyCode;switch(e.keyCode){case a.ENTER:case a.NUMPAD_ENTER:var r=t.data("ui-tauTagsAutocomplete");r.menu.active||(t.tauTagsAutocomplete("close"),n?(t.val(""),this._fireChangeNotificationWith(function(){return this.model.addByString(n)}),this.toggleHolderFullWidth(i,!1)):this.fire("tags.inline.edit.finished"));break;case a.BACKSPACE:n||(this._removeTag(i.prev()),t.tauTagsAutocomplete("close")),this.toggleHolderFullWidth(i,n);break;default:this.toggleHolderFullWidth(i,n)}},_handleInput:function(e){var t=$(e.target),i=t.closest("li");this.toggleHolderFullWidth(i,t.val())},_removeTag:function(e){var t=e.attr("data-text");this._fireChangeNotificationWith(function(){return this.model.removeByString(t)})},_fireChangeNotificationWith:function(e){this.fire("tags.inline.changing"),$.when(e.call(this)).always(this.fire.bind(this,"tags.inline.changed"))},toggleHolderFullWidth:function(e,t){t=!!t,e.toggleClass("ui-tags__inputholder_line_end",!t).toggleClass("ui-tags__inputholder_line_full",t)}})}),define("tau/ui/templates/tagsInline/ui.template.tagsInline",["tau/core/templates-factory"],function(e){return e.register({name:"tagsInline",engine:"jqote2",markup:['<ul class="ui-tags ui-tags-inline">','<li class="ui-tags__tag i-role-tag" rel="tag" rv-each-tag="data.items" rv-data-text="tag.text">','<span rv-text="tag.text"></span>','<span class="ui-tags__control-delete i-role-actiondelete" title="Delete tag">Delete tag</span>',"</li>",'<li class="ui-tags__tag ui-tags__inputholder">','<form><input class="ui-tags__input"></form>',"</li>","</ul>"]})
}),define("tau/components/component.tagsInline",["tau/components/component.creator","tau/ui/extensions/tagsInline/model","tau/ui/extensions/tagsInline/ui.extension.tagsInline","tau/ui/extensions/assignments/ui.extension.assignments.view","tau/ui/templates/tagsInline/ui.template.tagsInline"],function(e,t,i,n,a){return{create:function(r){var s=r.context.configurator,o=r.context.entity,l={ViewType:n,extensions:[{extType:i,args:[s,new t(s.getStore(),o)]}],template:a};return e.create(l,r)}}}),define("tau/models/team-members-editor/model.team-members-editor",["tau/core/extension.base","tau/ui/extensions/list/request/extension.requesters.tabs"],function(e,t){return e.extend({"bus beforeInit":function(){this.fire("dataBind",{})},"bus afterRender":function(e){var i=e.data.element.find("[role=action-add]"),n={actionOnBlur:"destroy",target:i,alignTo:i,componentsConfig:{components:[{type:"tabs",cssClass:"tau-tabs-small",extensions:[t],tabs:[{label:"select",header:[{type:"label",text:"Select user"}],items:[{type:"finder.team-members"}],selected:!0}]}]}};this.fire("initBubble",n);var a=function(){i.tauBubble("empty")};i.on("close externalClose",a),i.on("show",function(){var e=i.tauBubble("widget");e.delegate("[role=action-cancel]","click",a)})},"bus beforeInit + $target.ready":function(e,t){var i=t.config.context.configurator.getStore();i.unbind(this),i.on({eventName:"afterSave",type:"team",listener:this},_.bind(function(){this.fire("refresh")},this))}})}),define("tau/ui/templates/team-members-editor/ui.template.team-members-editor",["tau/core/templates-factory"],function(e){var t={name:"team-members-editor",engine:"jqote2",markup:["<div>",'<br /><button type="button" role="action-add" class="tau-button-add">Assign users</button>',"</div>"]};return e.register(t)}),define("tau/components/component.team-members-editor",["tau/components/component.creator","tau/models/team-members-editor/model.team-members-editor","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/team-members-editor/ui.template.team-members-editor"],function(e,t,i,n,a){return{create:function(r){var s={extensions:[t,i,n],template:a};
return e.create(s,r)}}}),define("tau/models/team.formAdd/model.team.formAdd.data",["Underscore","tau/core/extension.base","tau/configurations/team.icons"],function(e,t,i){return t.extend({"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i)},"bus configurator.ready:last + beforeInit":function(t,n){var a=n.getStore(),r=e.bind(this.fire,this),s=function(e){return e.name.toUpperCase()};a.get("projects",{fields:["id","name","color","isActive"]}).done(function(t){var n=e.sortBy(t[0].data,s);n=e.filter(n,function(e){return e.isActive}),e.each(n,function(e){e.tooltip=""}),r("dataBind",{projects:n,icons:i})}),a.unbind(this),a.on({type:"project",eventName:"afterSave",listener:this},function(t){e.isEmpty(t.data.changes)||r("refresh")})}})}),define("tau/models/team.formAdd/model.team.formAdd.add",["Underscore","tau/core/extension.base","tau/libs/inviter/inviter"],function(e,t,i){return t.extend({"bus configurator.ready:last + form.submitted":function(t,n,a){var r=this,s=n.getStore(),o={name:e.trim(a.name),icon:e.trim(e.asString(a.icon))||null,teamProjects:[]};e.forEach(a.connected,function(e){o.teamProjects.push({project:{id:e}})}),s.save("team",{failureGlobal:!1,fields:["id","name","icon","teamProjects"],$set:o},{success:function(e){r.fire("entity.saved",e.data)},failure:function(e){r.fire("entity.add.failure",e.data.response.Message)}}).done();var l=new i(n);l.invite(a.members).done(function(e){r.fire("members.saved",e)})},"bus configurator.ready:last + entity.saved + members.saved":function(t,i,n,a){var r=this,s=i.getStore(),o=e.compact(e.pluck(a,"success")),l=e.compact(e.pluck(a,"failure"));if(l.length){var u="Can't assign users.";this.fire("entity.add.nonFatalFailure",u)}o=e.filter(o,function(e){return e!=i.getLoggedUser().id});var c={teamMembers:e.map(o,function(e){return{user:{id:e}}})};s.save("team",{id:n.id,$set:c,fields:["id","name","icon",{teamMembers:[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}]}]}).done(function(e){r.fire("members.connected",e[0].data)
})},"bus entity.saved + members.saved + members.connected":function(e,t,i,n){this.fire("entity.add.success",n)}})}),define("tau/ui/extensions/team.formAdd/ui.extension.team.formAdd",["Underscore","jQuery","tau/ui/extensions/board.context.selector/ui.extension.board.context.selector.add.abstract"],function(e,t,i){return i.extend({"bus afterRender":function(e,t){var i=t.element;this.fire("$el.ready",i)},"bus $el.ready":function(e,t){var i=this,n=this._initForm(t);this._addSubmitDataListener(n,function(e){i.fire("form.submitted",e)});var a=n.find("select"),r=this._initRichSelect(n,a);r.on("change",function(e,t){var i=r.attr("data-value");r.removeClass("tau-icon_name_"+i),r.addClass("tau-icon_name_"+(t||"default"))})},"bus configurator.ready:last + $el.ready:last + entity.add.success":function(e,t,i){i.find("form").trigger("entity.add.completed").trigger("reset"),this.fire("entity.add.completed")},"bus $el.ready:last + entity.add.failure":function(e,t,i){t.find("form").trigger("entity.add.failed"),t.find(".i-role-form :text:first").focus().select().addClass("tau-error"),this.fire("error",i)},"bus $el.ready:last + entity.add.nonFatalFailure":function(e,t,i){this.fire("error",i)},"bus $el.ready:last + show.completed":function(e,t){var i=t.find("form");i.trigger("reset"),setTimeout(function(){i.find(":submit:first").focus(),i.find(":text:first").focus()},10)}})}),define("tau/ui/extensions/team.formAdd/ui.extension.team.formAdd.inviter",["Underscore","jQuery","tau/ui/extensions/inviter/ui.extension.inviter.widget.abstract"],function(e,t,i){return i.extend({"bus configurator.ready":function(e,t){this._initTemplates(t)},"bus configurator.ready + $el.ready":function(e,t,i){this._initWidget(t,i)}})}),define("tau/ui/templates/team.formAdd/ui.template.team.formAdd",["tau/core/templates-factory","tau/ui/templates/board.context.selector/ui.template.board.context.selector.projects.list"],function(e){var t={name:"team.addForm",engine:"jqote2",markup:['<div class="tau-managed-category tau-projects">','<form class="i-role-form">','<div class="tau-new-entity-form">','<div class="tau-new-entity-form__row">','<div class="tau-note"><b>New team</b></div>','<div class="tau-new-entity-info">','<span class="tau-select-team-icon tau-extension-board-tooltip" data-title="Select a team icon">','<i class="tau-icon tau-icon_type_svg tau-icon_name_default i-role-currenticon" data-value="default"></i>',"</span>",'<input name="name" type="text" placeholder="Enter team name here"  class="tau-in-text tau-new-entity-name">','<select name="icon" style="display:none;">','<option value=""></option>',"<% _.each(this.icons, function(item){ %>",'<option value="<%= item %>"><%= item %></option>',"<% }); %>","</select>","</div>",'<ul class="tau-teams-icon-list i-role-richselect">','<li><i class="tau-icon tau-i-close i-role-option" data-value=""></i></li>',"<% _.each(this.icons, function(item){ %>",'<li><i class="tau-icon tau-icon_type_svg tau-icon_name_<%= item %> i-role-option" data-value="<%= item %>"></i></li>',"<% }); %>","</ul>","</div>",'<div class="tau-new-entity-form__row tau-invite-widget">','<div class="tau-note">Assign people','<span class="tau-help i-role-tooltipArticle" data-article-id="team.formAdd.assignPeople"></span>',"</div>",'<textarea name="users" placeholder="Start typing name(s) or email(s) to assign people to a team" />',"</div>",'<div class="tau-new-entity-form__row">','<div class="tau-note">Assign projects','<span class="tau-help i-role-tooltipArticle" data-article-id="team.formAdd.assignProjects"></span>',"</div>",'<ul class="tau-category-items-selector i-role-list">','<%= fn.sub("board.context.selector.projects.list", this.projects) %>',"</ul>","</div>",'<div class="tau-new-entity-form__row">','<button class="tau-btn tau-success" type="submit">Create team</button>','<button class="tau-btn" type="reset">Cancel</button>',"</div>","</div>","</form>","</div>"]};
return e.register(t)}),define("tau/components/component.team.formAdd",["tau/components/component.creator","tau/models/team.formAdd/model.team.formAdd.data","tau/models/team.formAdd/model.team.formAdd.add","tau/ui/extensions/team.formAdd/ui.extension.team.formAdd","tau/ui/extensions/team.formAdd/ui.extension.team.formAdd.inviter","tau/components/extensions/error/extension.errorBar","tau/ui/templates/team.formAdd/ui.template.team.formAdd"],function(e,t,i,n,a,r,s){return{create:function(o){var l={extensions:[t,i,n,a,r],template:s};return e.create(l,o)}}}),define("tau/components/component.teamiteration.progressBar",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/progressBar/ui.template.iteration.progressBar"],function(e,t,i){return{create:function(n){var a={extensions:[t],template:i};return e.create(a,n)}}}),define("template!tau/components/terms/templates/terms.template",["tau/core/templates-factory"],function(e){var t={name:"terms",engine:"jqote2",customFunctions:null,markup:'<div class="i-role-views-terms-container terms-container"></div>'};return e.register(t)}),define("jsx!tau/components/terms/views/terms.view",["require","libs/react/react-ex","Underscore"],function(e){var t=e("libs/react/react-ex"),i=e("Underscore"),n=["termsListItem","termsBus"];return t.defineClass(n,function(e,n){return{getInitialState:function(){return{terms:[],process:{},isLoading:!0,isChanged:!1}},resetToDefault:function(){n.fire("terms.resetToDefault")},saveTerms:function(){n.fire("saveTerms")},render:function(){if(this.state.isLoading)return t.DOM.div({className:"tau-loader"});var n=i.map(this.state.terms,function(t){return new e({term:t,key:t.entityKind,isValidCollection:this.state.isValid})},this);return t.DOM.div(null,t.DOM.div({className:"tau-table-forms__wrapper"},t.DOM.div({className:"ui-title ui-title_type_main"},"",this.state.processName," Terms",t.DOM.button({type:"button",disabled:this.state.isDefault,onClick:this.resetToDefault,className:"tau-btn i-role-reset"},"Reset to default"))),t.DOM.div({className:"tau-table-forms__wrap"},t.DOM.table({className:"tau-table-forms"},n)),t.DOM.div({className:"tau-table-forms__wrapper"},t.DOM.button({disabled:!this.state.isChanged||!this.state.isValid,type:"button",onClick:this.saveTerms,className:"tau-btn tau-primary tau-btn-big"},"Save changes"),t.DOM.span({dangerouslySetInnerHTML:{__html:this.state.errorMessage},className:"tau-message-error"}),t.DOM.span({className:"tau-message-success"},this.state.successMessage)))
}}})}),define("tau/components/terms/extensions/terms.extension",["require","tau/core/extension.base","libs/react/react-ex","jsx!./../views/terms.view"],function(e){var t=e("tau/core/extension.base"),i=e("libs/react/react-ex"),n=e("jsx!./../views/terms.view");return t.extend({"bus afterInit":function(e,t){this.fire("dataBind"),t.config.context.configurator.getTitleManager().set("Terms")},"bus afterRender + terms.config.ready":function(e,t,a){var r=i.resolveClass(a.serviceScope,n,{}),s=t.element.filter(".i-role-views-terms-container"),o=i.renderComponent(r,s[0]);this.fire("_terms.view",o)}})}),define("jsx!tau/components/terms/views/terms.list.item.view",["require","libs/react/react-ex"],function(e){var t=e("libs/react/react-ex");return t.defineClass(["termsBus","termProcessor"],function(e,i){return{handlerChangeSingleTerm:function(t){var i={};i[this.props.key]={single:t.target.value},e.fire("changeTerm",i)},handlerChangePluralTerm:function(t){var i={};i[this.props.key]={plural:t.target.value},e.fire("changeTerm",i)},saveTerms:function(t){13===t.keyCode&&e.fire("saveTerms")},render:function(){var e=function(e){return i.getShortAbbreviation(e)},n=function(e){return i.getLongAbbreviation(e)},a=t.addons.classSet,r=a({"tau-in-text__label":!0,"rename-text":!this.props.term.isDefault}),s=a({spacer:this.props.term.isSpacer}),o=a({"tau-in-text":!0,"tau-error":this.props.term.isInvalidPlural}),l=a({"tau-in-text":!0,"tau-error":this.props.term.isInvalidSingle}),u=!this.props.isValidCollection&&!this.props.term.isInvalidSingle,c=!this.props.isValidCollection&&!this.props.term.isInvalidPlural,d=this.props.term.entityKind.toLowerCase(),p="tau-entity-icon tau-entity-icon--icon tau-entity-icon--"+d,f="tau-entity-icon tau-entity-icon-full tau-entity-icon--"+d;return t.DOM.tr({className:s,key:this.props.key},t.DOM.th({className:"tau-table-caption"},t.DOM.label({className:r},this.props.term.defaultSingle)),t.DOM.td(null,t.DOM.input({disabled:u,type:"text",onKeyPress:this.saveTerms,onChange:this.handlerChangeSingleTerm,className:l,value:this.props.term.single,placeholder:this.props.term.defaultSingle})),t.DOM.td(null,t.DOM.input({disabled:c,type:"text",onKeyPress:this.saveTerms,onChange:this.handlerChangePluralTerm,className:o,value:this.props.term.plural,placeholder:this.props.term.defaultPlural})),t.DOM.td(null,t.DOM.i({className:p},e(this.props.term.single||this.props.term.defaultSingle))),t.DOM.td(null,t.DOM.i({className:f},n(this.props.term.single||this.props.term.defaultSingle))))
}}})}),define("tau/services/service.terms.api",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(e){this._configurator=e.configurator},getTermsByProcessId:function(e){return t.ajax({url:this._getCallUrl(),data:{processId:e},dataType:"json",type:"GET"})},saveTerms:function(e){return t.ajax({url:this._getCallUrl(),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e)})},resetToDefaultByProcessId:function(e){return this.saveTerms({processId:e})},_getCallUrl:function(){return this._configurator.getApplicationPath()+"/terms/"}})}),define("libs/pluralize",[],function(){function e(e,t){return t.match(/^[A-Z]/)?e.charAt(0).toUpperCase()+e.slice(1):e}function t(e){e=e.split(",");for(var t=e.length,i={},n=0;t>n;n++)i[e[n]]=1;return i}function i(t,i,o){if(""===t)return"";if(1===i)return t;if("string"==typeof o)return o;var l=t.toLowerCase();if(l in n)return e(n[l],t);if(t.match(/^[A-Z]$/))return t+"'s";if(t.match(/fish$|ois$|sheep$|deer$|pox$|itis$/i))return t;if(t.match(/^[A-Z][a-z]*ese$/))return t;if(l in a)return t;if(l in r)return e(r[l],t);for(var u=s.length,c=0;u>c;c++){var d=s[c];if(t.match(d[0]))return t.replace(d[0],d[1])}return t+"s"}var n={},a=t("aircraft,advice,blues,corn,molasses,equipment,gold,information,cotton,jewelry,kin,legislation,luck,luggage,moose,music,offspring,rice,silver,trousers,wheat,bison,bream,breeches,britches,carp,chassis,clippers,cod,contretemps,corps,debris,diabetes,djinn,eland,elk,flounder,gallows,graffiti,headquarters,herpes,high,homework,innings,jackanapes,mackerel,measles,mews,mumps,news,pincers,pliers,proceedings,rabies,salmon,scissors,sea,series,shears,species,swine,trout,tuna,whiting,wildebeest,pike,oats,tongs,dregs,snuffers,victuals,tweezers,vespers,pinchers,bellows,cattle"),r={I:"we",you:"you",he:"they",it:"they",me:"us",him:"them",them:"them",myself:"ourselves",yourself:"yourselves",himself:"themselves",herself:"themselves",itself:"themselves",themself:"themselves",oneself:"oneselves",child:"children",dwarf:"dwarfs",mongoose:"mongooses",mythos:"mythoi",ox:"oxen",soliloquy:"soliloquies",trilby:"trilbys",person:"people",forum:"forums",syllabus:"syllabi",alumnus:"alumni",genus:"genera",viscus:"viscera",stigma:"stigmata"},s=[[/man$/i,"men"],[/([lm])ouse$/i,"$1ice"],[/tooth$/i,"teeth"],[/goose$/i,"geese"],[/foot$/i,"feet"],[/zoon$/i,"zoa"],[/([tcsx])is$/i,"$1es"],[/ix$/i,"ices"],[/^(cod|mur|sil|vert)ex$/i,"$1ices"],[/^(agend|addend|memorand|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi)um$/i,"$1a"],[/^(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|\w+hedr)on$/i,"$1a"],[/^(alumn|alg|vertebr)a$/i,"$1ae"],[/([cs]h|ss|x)$/i,"$1es"],[/([aeo]l|[^d]ea|ar)f$/i,"$1ves"],[/([nlw]i)fe$/i,"$1ves"],[/([aeiou])y$/i,"$1ys"],[/(^[A-Z][a-z]*)y$/,"$1ys"],[/y$/i,"ies"],[/([aeiou])o$/i,"$1os"],[/^(pian|portic|albin|generalissim|manifest|archipelag|ghett|medic|armadill|guan|octav|command|infern|phot|ditt|jumb|pr|dynam|ling|quart|embry|lumbag|rhin|fiasc|magnet|styl|alt|contralt|sopran|bass|crescend|temp|cant|sol|kimon)o$/i,"$1os"],[/o$/i,"oes"],[/s$/i,"ses"]];
return i.define=function(e,t){n[e.toLowerCase()]=t},i}),define("tau/store/reservedWords.targetprocess.generated",[],function(){return["abbreviation","acid","activedirectoryname","adminprocesses","allocation","appcontext","appcontexts","assignable","assignables","assigneduser","assignment","assignments","attachment","attachmentfile","attachmentfiles","attachments","author","availablefrom","availablefutureallocation","availablefuturehours","avataruri","body","bug","bughistories","bughistory","bugs","build","builddate","builds","canbefinished","canchangeowner","childtestplans","color","comment","comments","commitdate","companies","company","config","configstring","contact","contacts","contains","contenttype","context","contexts","count","created","createdate","crossprojectreleases","cssclass","culture","cultures","currentallocation","currentavailablehours","customactivities","customactivity","customfield","customfield1","customfield10","customfield11","customfield12","customfield13","customfield14","customfield15","customfield16","customfield17","customfield18","customfield19","customfield2","customfield20","customfield21","customfield22","customfield23","customfield24","customfield25","customfield26","customfield27","customfield28","customfield29","customfield3","customfield30","customfield31","customfield32","customfield33","customfield34","customfield35","customfield36","customfield37","customfield38","customfield39","customfield4","customfield40","customfield41","customfield42","customfield43","customfield44","customfield45","customfield46","customfield47","customfield48","customfield49","customfield5","customfield50","customfield51","customfield52","customfield53","customfield54","customfield55","customfield56","customfield57","customfield58","customfield59","customfield6","customfield60","customfield7","customfield8","customfield9","customfieldconfig","customfieldconfigs","customfieldinfo","customfieldinfos","customfields","customreport","customreports","cycletime","date","decimalseparator","defaultvalue","deletedate","description","displayname","duration","edition","effort","effortcompleted","efforttodo","email","enabledforfilter","enddate","entityfieldname","entitykind","entitystate","entitystates","entitytype","entitytypeid","entitytypes","epic","epics","estimate","executed","externalreference","externalreferences","failedcount","feature","featurehistories","featurehistory","features","fieldtype","fileaction","filename","firstname","followers","following","forecastenddate","from","general","generalfieldextension","generalfieldextensions","generalfollower","generalfollowers","generallistitem","generallistitems","generalnumericprioritylistitem","generalnumericprioritylistitems","generalrelation","generalrelations","generalrelationtype","generalrelationtypes","generals","generaluser","generalusers","globalsetting","globalsettings","haseffort","history","icon","iconuri","id","impediment","impedimenthistories","impedimenthistory","impediments","importance","initialestimate","isactive","isadministrator","iscommentrequired","iscurrent","isdefault","isestimation","isextendable","isfinal","isinitial","isnext","isnow","isobserver","isplanned","isprevious","isprivate","isprocessed","isproduct","isprojectaccessed","isread","isreplied","issearchable","isunitinhouronly","iteration","iterations","kind","lastcommentdate","lastcommenteduser","lastfailurecomment","lastlogindate","lastname","lastrundate","laststatus","leadtime","license","licenses","listed","loggeduser","login","longdateformat","maillogin","mailreplyaddress","mailserver","master","masterrelations","membershipenddate","membershipstartdate","message","messagegeneral","messagegenerals","messages","messagetype","messageuid","messageuids","milestone","milestones","mimetype","modifier","modifydate","name","nextstates","no","none","nones","notes","notruncount","numericpriority","owner","parentid","parentprojectid","parenttestplans","passed","passedcount","password","passwordrecoveries","passwordrecovery","phone","plannedenddate","plannedstartdate","pluginprofile","pluginprofilemessage","pluginprofilemessages","pluginprofiles","practice","practices","previousstates","priorities","priority","process","processadmin","processadmins","processes","processinfo","processinfos","processpractice","processpractices","program","programinfo","programinfos","programs","progress","project","projectallocation","projectcontext","projectinfo","projectinfos","projectmember","projectmembers","projects","recipients","relation","relations","relationtype","relationtypes","release","releaseproject","releaseprojects","releases","remain","request","requester","requesters","requesthistories","requesthistory","requestrequester","requestrequesters","requests","requesttype","requesttypes","required","resourcebase","resourcebases","responsible","result","revision","revisionassignable","revisionassignables","revisionfile","revisionfiles","revisions","role","roleeffort","roleefforts","roleentitytype","roleentitytypes","roles","rule","rules","rundate","runned","runorder","savedfilter","savedfilters","selectedprojects","selectedteams","senddate","severities","severity","shortdateformat","simplecontext","simplecontexts","size","skills","slave","slaverelations","sourcecontrolid","sourcetype","spent","squad","squaditeration","squaditerations","squadmember","squadmembers","squadproject","squadprojects","squads","startdate","steps","subject","success","systemuser","systemusers","tag","tagbundle","tagbundles","tagbundletag","tagbundletags","taggeneral","taggenerals","tagobjects","tags","task","taskhistories","taskhistory","tasks","team","teamcontext","teaminfo","teaminfos","teamiteration","teamiterations","teamlistitem","teamlistitems","teammember","teammembers","teamproject","teamprojects","teams","term","terms","testcase","testcaserun","testcaserunbug","testcaserunbugs","testcaseruns","testcases","testcasetestplan","testcasetestplans","testitem","testitems","testplan","testplanrun","testplanruns","testplans","testplantestplan","testplantestplans","teststep","teststeprun","teststepruns","teststeps","thumbnailuri","time","timepattern","timeremain","times","timespent","to","tpevent","tpevents","tpprofile","tpprofiles","tpprojectprofile","tpprojectprofiles","tpsession","tpsessions","type","uid","units","uri","url","user","users","userstories","userstory","userstoryhistories","userstoryhistory","value","velocity","version","weeklyavailablehours","where","wordkey"]
}),define("tau/components/terms/models/terms.model",["require","tau/core/class","Underscore","jQuery","libs/pluralize","tau/store/reservedWords.targetprocess.generated"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n=e("jQuery"),a=e("libs/pluralize"),r=e("tau/store/reservedWords.targetprocess.generated"),s="This term is reserved by Targetprocess, please, use some other.",o="This term already exists, please, use some other.",l="%, ., ), ( and % characters can't be used for custom Terms. Please, use some others.";return t.extend({init:function(e,t){this._termsService=e,this._processId=t,this._viewData={isValid:!0}},getTerms:function(){return this._loadTerms().then(function(e){return i.extend(this._viewData,e),this._viewData.isLoading=!1,this._processDataForView(this._viewData)}.bind(this))},_processDataForView:function(e){var t=!0,n=["epic","build","impediment"];return i.each(e.terms,function(e){var a=""===e.single||e.single===e.defaultSingle,r=""===e.plural||e.plural===e.defaultPlural;e.isDefault=a&&r,t=e.isDefault&&t,e.isSpacer=i.contains(n,e.entityKind.toLowerCase())}),e.isDefault=t,e},_loadTerms:function(){return this._termsService.getTermsByProcessId(this._processId)},resetTermsToDefault:function(){return i.each(this._viewData.terms,function(e){e.single=e.defaultSingle,e.plural=e.defaultPlural}),this._resetTerms(this._viewData),this._viewData.isChanged=!1,this._processDataForView(this._viewData)},_isPluralizing:function(e,t){var i=e.single,n=i&&/^[a-z\s]+$/i.test(i)||""===i;return n&&a(t.single)==t.plural},_prepareWord:function(e){return i.trim(e).toLowerCase().replace(/\s/gi,"")},_validate:function(e,t,n,a){var u=!0,c=this._prepareWord,d=c(e[t]);if(""===d)return this._clearViewData(a);var p=i.capitalize(t),f=a.terms[n]["default"+p],m=i.without(r,c(f)),h={},g=function(){return a.errorMessage="",h.errorMessage&&(a.terms[n]["isInvalid"+p]=!0,u=!1,a.errorMessage=h.errorMessage),a.isValid=u,a};if(/[\(\)\.%]/.test(d))return h={errorMessage:l},g();if(i.contains(m,d))return h={errorMessage:s},g();
var v=[{defaultSingle:s},{single:o},{defaultPlural:s},{plural:o}];return i.each(a.terms,function(e,a){h=i.reduce(v,function(r,s){var o=i.keys(s)[0];return d===c(e[o])?o!==t&&o!=="default"+i.capitalize(t)||a!==n?{errorMessage:s[o]}:r:r},h)}),g()},_clearViewData:function(e){return i.each(e.terms,function(e){e.isInvalidSingle=!1,e.isInvalidPlural=!1}),e.isValid=!0,e.errorMessage="",e.successMessage="",e},updateTerms:function(e){var t=i.keys(e)[0],n=i.values(e)[0],r=i.keys(n)[0],s=0;i.each(this._viewData.terms,function(e,i){e.entityKind==t&&(s=i)}),n[r]=n[r].replace(/^\s+/,"");var o=this._viewData.terms[s];return this._isPluralizing(n,o)&&(n.plural=a(n.single)),i.extend(o,n),this._clearViewData(this._viewData),this._viewData=this._validate(n,r,s,this._viewData),this._viewData.isChanged=!0,this._processDataForView(this._viewData)},saveTerms:function(){return this._viewData.isValid?this._saveTerms(this._viewData).then(function(e){var t=i.extend(this._viewData,{terms:e.terms,isChanged:!1,successMessage:"Terms saved."});return this._processDataForView(t)}.bind(this)):n.Deferred().reject({clientValidation:this._viewData.errorMessage})},_saveTerms:function(e){return this._termsService.saveTerms(i.pick(e,"terms","processId"))},_resetTerms:function(){this._clearViewData(this._viewData),this._termsService.resetToDefaultByProcessId(this._processId)}})}),define("tau/components/terms/extensions/terms.config.extension",["require","tau/core/extension.base","tau/core/injector","jsx!./../views/terms.list.item.view","tau/services/service.terms.api","tau/components/terms/models/terms.model","tau/core/termProcessor"],function(e){var t=e("tau/core/extension.base"),i=e("tau/core/injector"),n=e("jsx!./../views/terms.list.item.view"),a=e("tau/services/service.terms.api"),r=e("tau/components/terms/models/terms.model"),s=e("tau/core/termProcessor");return t.extend({"bus afterInit":function(e,t){var o=t.config,l=o.context.configurator,u=new i,c=new a({configurator:l}),d=new s,p=new r(c,o.processId),f={model:p,serviceScope:u,processId:o.processId};
u.register("termsBus",this.bus),u.register("termProcessor",d),u.register("termsListItem",u.createModule(n)),this.fire("terms.config.ready",f)}})}),define("tau/components/terms/extensions/terms.dispatcher.extension",["require","tau/core/extension.base","tau/utils/utils.serverErrorTranslator"],function(e){var t=e("tau/core/extension.base"),i=e("tau/utils/utils.serverErrorTranslator");return t.extend({init:function(e){this._super(e),this.on("afterRender",function(e,t){this.$element=t.element}.bind(this))},"bus _terms.view":function(e,t){this._view=t},"bus terms.config.ready + _terms.view":function(e,t){t.model.getTerms().done(function(e){this._setState(e)}.bind(this))},"bus terms.config.ready:last + terms.resetToDefault":function(e,t){this.$element.find(".i-role-reset").tauConfirm({content:"<h3>Do you really want to restore default settings?</h3>",callbacks:{success:function(){this._setState(t.model.resetTermsToDefault())}.bind(this)}}),this.$element.find(".i-role-reset").tauConfirm("show")},"bus terms.config.ready:last + changeTerm":function(e,t,i){this._setState(t.model.updateTerms(i))},"bus terms.config.ready:last + saveTerms":function(e,t){t.model.saveTerms().done(function(e){this._setState(e)}.bind(this)).fail(function(e){var t;t=e.clientValidation?e.clientValidation:i.translateXhrError(e).message.replace(/\r\n/gm,"<br/>"),this._setState({errorMessage:t})}.bind(this))},_setState:function(e){this._view&&this._view.setState(e)}})}),define("tau/components/component.terms",["require","tau/components/component.creator","template!tau/components/terms/templates/terms.template","tau/components/terms/extensions/terms.extension","tau/components/terms/extensions/terms.config.extension","tau/components/terms/extensions/terms.dispatcher.extension"],function(e){var t=e("tau/components/component.creator"),i=e("template!tau/components/terms/templates/terms.template"),n=e("tau/components/terms/extensions/terms.extension"),a=e("tau/components/terms/extensions/terms.config.extension"),r=e("tau/components/terms/extensions/terms.dispatcher.extension");
return{create:function(e){e=e||{};var s={extensions:[n,a,r],template:i};return t.create(s,e)}}}),define("tau/models/model.testCaseList",["Underscore","tau/core/model-base","tau/utils/utils.date","tau/utils/utils.htmlConverter"],function(e,t,i,n){function a(e){this.model=e}a.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(t){var i={labelAdd:this.model.config.labelAdd||"Add",items:[]};this.model.assignable=t.data;for(var n=e.sortBy(t.data.testCases,function(e){return e.numericPriority}),a=n.length,r=0;a>r;r++)i.items.push(this.convertServerDataModelData(n[r]));this.model.bus&&this.model.bus.fire("dataBind",i)},convertServerDataModelData:function(e){var t=null;e.lastRunDate&&(t=i.format.datetime.short(e.lastRunDate));var a=void 0;void 0!=e.lastStatus&&(a={isPassed:e.lastStatus});var r=(this.config.context.configurator.getUrlBuilder(),{__type:"testCase",id:e.id,name:e.name,lastRunDate:t,applicationUrl:"#testcase/"+e.id,steps:n.fromSourceToHtml(e.steps),success:n.fromSourceToHtml(e.success)});return a&&(r.lastRunStatus=a),r}};var r=t.extend({onInit:function(){var e=this,t=new a(e),i=e.config.context.entity;this.store.get(i.entityType.name,{id:i.id,fields:["id",{testCases:["id","name","lastRunDate","lastStatus","steps","success","numericPriority"]}]},t.getAssignableRetrievedCallback()).done()},"bus evictTestCases":function(){var e=this.config.context.entity;this.store.evictProperties(e.id,e.entityType.name,["testCases","testCases-count"])}});return r}),define("tau/models/model.testCaseList.editable",["tau/core/model.editable.base"],function(e){return e.extend({category:"edit",name:"Editable State","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.edit.addTestCase",["Underscore","jQuery","tau/components/extensions/component.extension.base","app.path"],function(e,t,i,n){return i.extend({"bus afterRender+permissionsReady":function(e){if(e.permissionsReady.data.editable){var i=e.afterRender.data.element;
i.find(".tau-add-testCase").click(t.proxy(this.addTestCaseClickHandler,this))}},addTestCaseClickHandler:function(){function e(){Ext.WindowMgr.zseed=9999999;var e=new Tp.controls.TestCaseCreateEditorWindow({userStoryId:a,processId:i.getProcessId()});e.show(),e.on("saved",function(){r.fire("testCaseWasAdded",{assignable:{id:a}})})}var i=this.config.context,a=i.entity.id,r=this;if(window.processConfigurations)e();else{var s=window.progressDialog||{show:function(){},hide:function(){}};s.show("Loading..."),Ext.Ajax.request({url:new n.tp.WebServiceURL("/PageServices/TestCaseListService.asmx/GetProcessConfiguration").toString(),headers:{"Content-Type":"application/json"},success:function(i){s.hide();var n=t.parseJSON(i.responseText).d;processConfigurations=n,e()},jsonData:{userStoryId:a}})}}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.edit.runner",["Underscore","jQuery","tau/components/extensions/component.extension.base","app.path"],function(e,t,i,n){return i.extend({"bus dataBind":function(e){this.data=e.data},onAfterRender:function(){},"bus afterRender":function(e){this.element=e.data.element,this.onAfterRender()},"bus afterRender+permissionsReady":function(e){if(e.permissionsReady.data.editable){var i=e.afterRender.data.element;i.find(".last-run").removeClass("hidden"),i.find(".buttons").removeClass("hidden"),i.find(".passed").click(t.proxy(this.passedClickHandler,this)),i.find(".failed").click(t.proxy(this.failedClickHandler,this))}},getTestCaseId:function(e){return t(e.target).parents("tbody").eq(0).tmplItem().data.id},passedClickHandler:function(e){var t=this.getTestCaseId(e);this.setTestCaseStatus(t,!0)},failedClickHandler:function(e){var t=this.getTestCaseId(e);this.setTestCaseStatus(t,!1)},setTestCaseStatus:function(e,t){Ext.Ajax.request({url:new n.tp.WebServiceURL("/PageServices/TestCaseListService.asmx/ChangeRunState").toString(),headers:{"Content-Type":"application/json"},success:this._onChangeStateComplete.createDelegate(this),failure:this._onChangeStateFailed.createDelegate(this),jsonData:{testCaseID:e,status:t}})
},openNextTestCase:function(){for(var e=this.testCaseId,t=this.data.items,i=0;i<t.length-1;i++)t[i].id===e&&this.fire("expandTestCase",{testCaseId:t[i+1].id});this.onAfterRender=function(){}},_onChangeStateComplete:function(e){this.testCaseId=t.parseJSON(e.responseText).d.TestCaseID,this.onAfterRender=this.openNextTestCase,this.fire("testCaseStateWasChanged")},_onChangeStateFailed:function(e){this.fire("showError",{message:e.get_message()})},destroy:function(){delete this.data,delete this.element}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.refresher",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus testCaseWasAdded":function(){this.fire("evictTestCases"),this.fire("refresh")},"bus testCaseStateWasChanged":function(){this.fire("evictTestCases"),this.fire("refresh")}})}),define("tau/ui/templates/testCaseList/ui.template.testCaseList.testCase",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(e){var t={name:"test-case-list-test-case",markup:['<tbody class="collapsed">',"   <tr>",'       <td class="toggler"><button class="extra-info expand" type="button"><div>+</div></button></td>','       <td class="testcase-id">','           {{tmpl($data) "entity-link"}}',"       </td>","       <td>${name}</td>","       <td>${lastRunDate}</td>","       <td>","{{if  lastRunStatus }}","   {{if lastRunStatus.isPassed === true}}",'       <span class="passed">Passed</span>',"   {{/if}}","   {{if lastRunStatus.isPassed === false}}",'       <span class="failed">Failed</span>',"   {{/if}}","{{/if}}",'       <td class="buttons hidden">','           <button class="passed green-button" type="button">Pass</button>','           <button class="failed  red-button" type="button">Fail</button>',"       </td>","</td>","   </tr>","   <tr>","       <td></td>",'       <td colspan="5">','           <div class="steps">',"               <h4>Steps</h4>","               <span>{{html steps}}</span>","           </div>",'           <div class="success">',"               <h4>Success</h4>","               <span>{{html success}}</span>","           </div>","       </td>","   </tr>","</tbody>"].join(""),dependencies:["entity-link"]};
return e.register(t)}),define("tau/ui/templates/testCaseList/ui.template.testCaseList",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/testCaseList/ui.template.testCaseList.testCase"],function(e,t){var i={name:"test-case-list",options:{contentSelector:".ui-testCaseList-content"},tags:[t],markup:['<div class="ui-testCaseList">','   <div class="button-panel">','       <button class="tau-add-testCase" type="button">${labelAdd} {{term("TestCase") "name"}}</button>',"   </div>",'   <div class="ui-testCaseList-content"{{if items.length === 0}} style="display:none"{{/if}}>','       <table class="ui-testCaseList">',"           <colgroup>",'               <col class="toggler">','               <col class="id">','               <col class="name">','               <col class="last-run-date">','               <col class="last-status">','               <col class="last-run">',"           </colgroup>","           <thead>","               <tr>",'                   <th class="toggler">','                       <button class="extra-info expand" type="button"><div>+</div></button>','                        <button class="extra-info collapse" type="button"><div>-</div></button>',"                   </th>",'                   <th class="identificator">ID</th>',"                   <th>Name</th>","                   <th>Last Run Date</th>","                   <th>Last Status</th>",'                   <th class="last-run">Run</th>',"               </tr>","           </thead>",'           {{tmpl(items) "test-case-list-test-case"}}',"       </table>","   </div>","</div>"].join(""),dependencies:["test-case-list-test-case"]};return e.register(i)}),define("tau/components/component.testCaseList",["tau/components/component.list.creator","tau/models/model.testCaseList","tau/models/model.testCaseList.editable","tau/components/extensions/testCaseList/extension.testCaseList.edit.addTestCase","tau/components/extensions/testCaseList/extension.testCaseList.edit.runner","tau/components/extensions/testCaseList/extension.testCaseList.refresher","tau/ui/templates/testCaseList/ui.template.testCaseList","tau/ui/extensions/testCaseList/ui.extension.testCaseList"],function(e,t,i,n,a,r,s,o){return{create:function(l){var u={template:s,extensions:[t,i,o,l.addTestCaseExtension||n,a,r],message:"No test cases found"};
return e.create(u,l)}}}),define("tau/models/quick.add/model.board.testcaserun.quick.add",["require","tau/models/quick.add/model.board.general.quick.add"],function(e){var t=e("tau/models/quick.add/model.board.general.quick.add");return t.extend({getTypes:function(){return this.types},getViewMode:function(){return"board"},onInit:function(e){this.types=e.options.types,this._super(e)},getDefinition:function(e){var t=this._super(e);return t.global.acid=null,t}})}),define("tau/components/component.testCaseRun.quickAdd",["require","tau/components/component.creator","tau/components/extensions/bubble/extension.bubble.creator","tau/components/extensions/component.creator.extension","tau/models/quick.add/model.board.testcaserun.quick.add","tau/ui/extensions/board.cell.quick.add/ui.extension.board.cell.quick.add","tau/components/extensions/error/extension.errorBar","tau/views/view.compositeControl","tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add"],function(e){var t=e("tau/components/component.creator"),i=e("tau/components/extensions/bubble/extension.bubble.creator"),n=e("tau/components/extensions/component.creator.extension"),a=e("tau/models/quick.add/model.board.testcaserun.quick.add"),r=e("tau/ui/extensions/board.cell.quick.add/ui.extension.board.cell.quick.add"),s=e("tau/components/extensions/error/extension.errorBar"),o=e("tau/views/view.compositeControl"),l=e("tau/ui/templates/board.cell.quick.add/ui.template.board.cell.quick.add");return{create:function(e){var u=[a,i,n,r,s],c={ViewType:o,extensions:u,template:l};return e["queue.bus"]=!0,t.create(c,e)}}}),define("tau/ui/extensions/testCaseRun/ui.extension.testCaseRun.quickAddTrigger",["require","tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.base.quickAddTrigger"],function(e){var t=e("tau/ui/extensions/entity.quickAddTrigger/ui.extension.entity.base.quickAddTrigger");return t.extend({"bus beforeInit":function(e,t){this._super(e,t),this.fire("dataBind")},"bus afterRender":function(e,t){var i=t.element.filter("*");
if(i.length){var n=this._createQuickAddConfig(i,"quickAddTestCaseRun","tau-quick-add-dialog-testcaserun",[{name:"test case run quick add",type:"testCaseRun.quickAdd",options:this.options}]);this.fire("initBubble",n)}}})}),define("template!tau/ui/templates/testCaseRun/ui.template.testcaserun.quick.add",["tau/core/templates-factory"],function(e){var t={name:"testCaseRun.quickAddTrigger",engine:"jqote2",customFunctions:null,markup:'<span class="tau-view-quick-add i-role-trigger"></span>'};return e.register(t)}),define("tau/components/component.testCaseRun.quickAddTrigger",["require","tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/components/extensions/bubble/extension.bubble.creator","tau/ui/extensions/testCaseRun/ui.extension.testCaseRun.quickAddTrigger","template!tau/ui/templates/testCaseRun/ui.template.testcaserun.quick.add"],function(e){var t=e("tau/components/component.creator"),i=e("tau/components/extensions/component.creator.extension"),n=e("tau/components/extensions/bubble/extension.bubble.creator"),a=e("tau/ui/extensions/testCaseRun/ui.extension.testCaseRun.quickAddTrigger"),r=e("template!tau/ui/templates/testCaseRun/ui.template.testcaserun.quick.add");return{create:function(e){var s={extensions:[a,n,i],template:r};return t.create(s,e)}}}),define("tau/components/extensions/testcaserun.result/testcaserun.result.container.extension",["tau/core/extension.base"],function(e){return e.extend({init:function(e){this.store=e.store,this.entity=e.context.entity,this._runnerModel=e.context.registry.runnerModel,this._super(e)},"bus afterRender":function(e){var t=this.store,i=this.entity.id,n=this.entity.entityType.name;this.$nextCaseButton=e.data.element.find(".i-role-next-tcr-btn"),this._bindHandlerForRunNextTCRButton(i),this._initRunNextTCRButtonState(t,i,n)},_bindHandlerForRunNextTCRButton:function(e){this.$nextCaseButton.on("click",function(){this._runnerModel.runNext(e)}.bind(this))},_initRunNextTCRButtonState:function(e,t,i){e.get(i,{id:t,fields:["passed","comment","runDate",{testplanrun:[{entitystate:["isFinal"]}]}]}).done({success:function(n){var a=n[0].data;
a.testplanrun.entitystate.isFinal?this.$nextCaseButton.css("display","none"):(this._monitorRunNextTCRButtonState(e,t,i),this._fireStoreData(n))},scope:this})},_monitorRunNextTCRButtonState:function(e,t,i){e.unbind(this),e.on({eventName:"afterSave",type:i,listener:this,filter:{id:t},hasChanges:["comment|runDate"]},function(){this._setRunNextTCRButtonState(e,t,i)}.bind(this))},_setRunNextTCRButtonState:function(e,t,i){e.get(i,{id:t,fields:["passed","comment","runDate"]}).done({success:this._fireStoreData,scope:this})},_fireStoreData:function(e){this.fire("store.data",{passed:e[0].data.passed,comment:e[0].data.comment,runDate:e[0].data.runDate})},"bus store.data":function(e,t){this._updateRunNextTCRButtonState(t)},"bus public.note.changed + store.data:last":function(e,t,i){this._updateRunNextTCRButtonState({passed:i.passed,runDate:i.runDate,comment:t})},_updateRunNextTCRButtonState:function(e){var t=e.passed===!1&&!e.comment||null==e.passed&&null==e.runDate;this.$nextCaseButton.prop("disabled",t)}})}),define("template!tau/ui/templates/testCaseRun/ui.template.testcaserun.results",["tau/core/templates-factory"],function(e){var t={name:"testcaserun.results",engine:"jqote2",customFunctions:null,markup:'<div class="tau-testcaserun-results"> <div class="tau-testcaserun-results__row"/> </div>'};return e.register(t)}),define("template!tau/ui/templates/testCaseRun/ui.template.testcaserun.next",["tau/core/templates-factory"],function(e){var t={name:"testcaserun.next",engine:"jqote2",customFunctions:null,markup:'<div class="tau-testcaserun-results__middle"> <button class="tau-btn tau-btn-big i-role-next-tcr-btn"> Next test case<i class="tau-icon-general tau-icon-b-arrow"></i> </button> </div>'};return e.register(t)}),define("tau/components/component.testcaserun.result.container",["Underscore","tau/components/component.container.with-shared-events","tau/components/extensions/testcaserun.result/testcaserun.result.container.extension","tau/configurations/const.page.entity.modes","template!tau/ui/templates/testCaseRun/ui.template.testcaserun.results","template!tau/ui/templates/testCaseRun/ui.template.testcaserun.next"],function(e,t,i,n,a,r){return{create:function(s){var o={type:"container.with-shared-events",name:"testcaserun.result.container",layout:"selectable",template:a,children:s.context.registry.componentConfigHelper.children([{type:"testcaserun.result.editor",selector:".tau-testcaserun-results__row"},{type:"note",selector:".tau-testcaserun-results__row"},{type:"label",enabledIf:{modeIn:[n.LIST_ENTITY_DETAILS]},selector:".tau-testcaserun-results__row",template:r,extensions:[i]},{selector:".tau-create-bug",type:"entity.quickAddTrigger",options:this.getEntityQuickAddOptions(),printable:!1}])};
return t.create(e.extend(s,o))},getEntityQuickAddOptions:function(){return{items:[{entityType:"bug",relationName:"bugs"}]}}}}),define("tau/models/model.testcaserun.result.editor",["Underscore","tau/core/extension.base.stateful","tau/utils/utils.date"],function(e,t,i){return t.extend({"bus beforeInit":function(e,t){this.entity=t.config.context.entity,this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:["passed","runDate",{testplanrun:[{entitystate:["isFinal"]}]}]}).done({success:function(e){var t=e[0].data,i={};t.passed===!0?i.passed=!0:t.passed===!1?i.failed=!0:null==t.passed&&null!=t.runDate&&(i.skipped=!0),i.isTestPlanRunStateFinal=t.testplanrun.entitystate.isFinal,this.fire("dataBind",i)},scope:this})},"bus test.case.run.change.state.save":function(e,t){var n={id:this.entity.id,runDate:i.format.datetime.full(i.getServerNow()),executed:!0};switch(t.state){case"passed":n.passed=!0;break;case"failed":n.passed=!1;break;case"skipped":n.passed=null;break;default:n.executed=!1,n.runDate=null,n.passed=null}this.store.save("testcaserun",{$set:n}).done()}})}),define("tau/ui/extensions/testCaseRun/ui.extension.testCaseRun.result.editor",["jQuery","Underscore","tau/core/extension.base"],function(e,t,i){return i.extend({"bus beforeInit":function(e,t){var i=t.config;this.store=i.store,this.entity=i.context.entity},"bus afterRender":function(t,i){var n=i.element,a=n.find(".i-role-results");a.on("click",".tau-btn",function(t){var i=e(t.target),n=!i.hasClass("tau-checked"),a=n?i.data("result"):null;this._changeState(i,a)}.bind(this)),i.data.isTestPlanRunStateFinal?a.find(".tau-btn").prop("disabled",!0):this._monitorState(a)},_changeState:function(e,t){this.fire("test.case.run.change.state.save",{state:t})},_setState:function(e,t){var i=e.find(".tau-btn.tau-"+this._convertPassedValueToState(t));i.siblings(".tau-btn").removeClass("tau-checked"),i.addClass("tau-checked")},_getState:function(t){var i=e.Deferred();return this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:["passed"]}).done({success:function(e){i.resolveWith(this,[t,e[0].data.passed])
},scope:this}),i.promise()},_resetState:function(e){e.find(".tau-btn").removeClass("tau-checked")},_convertPassedValueToState:function(e){return null===e?"skipped":e?"passed":"failed"},_monitorState:function(e){this.store.unbind(this),this.store.on({eventName:"afterSave",type:this.entity.entityType.name,listener:this,hasChanges:["passed|runDate"],filter:{id:this.entity.id}},function(i){var n=i.data.changes,a=n.passed,r=n.runDate;r?t.isUndefined(a)?this._getState(e).then(this._setState):this._setState(e,a):this._resetState(e)}.bind(this))}})}),define("template!tau/ui/templates/testCaseRun/ui.template.testcaserun.result.editor",["tau/core/templates-factory"],function(e){var t={name:"testcaserun.result.editor",engine:"jqote2",customFunctions:null,markup:'<div class="tau-testcaserun-results__title">Final result</div> <div class="tau-testcaserun-results__right"> <div class="tau-create-bug"/> </div> <div class="tau-testcaserun-results__middle"> <span class="i-role-results"> <button class="tau-btn tau-btn-big tau-passed <% if (this.passed) { %>tau-checked<% } %>" data-result="passed">Passed</button> <button class="tau-btn tau-btn-big tau-failed <% if (this.failed) { %>tau-checked<% } %>" data-result="failed">Failed</button> <button class="tau-btn tau-btn-big tau-skipped <% if (this.skipped) { %>tau-checked<% } %>" data-result="skipped">Skipped</button> </span> </div>'};return e.register(t)}),define("tau/components/component.testcaserun.result.editor",["tau/components/component.creator","tau/models/model.testcaserun.result.editor","tau/ui/extensions/testCaseRun/ui.extension.testCaseRun.result.editor","template!tau/ui/templates/testCaseRun/ui.template.testcaserun.result.editor"],function(e,t,i,n){return{create:function(a){a=a||{};var r={extensions:[t,i],template:n};return e.create(r,a)}}}),define("tau/models/model.testCasesRunResults",["tau/core/model-base"],function(e){var t=e.extend({onInit:function(){var e=this,t=e.config.context,i=t.entity.entityType.name,n=t.entity.id;this.store.get(i,{id:n,fields:["passedCount","failedCount","notRunCount"]},{success:this.onDataRetrieved,scope:this}).done(),this.store.unbind(this),_.forEach(["passedCount","failedCount","notRunCount"],function(t){e.store.on({eventName:"afterSave",type:i,listener:e,filter:{id:n},hasChanges:[t]},function(){e.fire("refresh")
})})},onDataRetrieved:function(e){var t=e.data,i={passedCount:t.passedCount,failedCount:t.failedCount,notRunCount:t.notRunCount};this.bus.fire("dataBind",i)},"bus beforeInit:last + destroy":function(e,t){t.config.context.configurator.getStore().unbind(this)}});return t}),define("tau/ui/templates/testCasesRunResults/ui.template.testCasesRunResults",["tau/core/templates-factory"],function(e){var t={name:"test-cases-run-results",markup:['<div class="tau-testCasesRunResults">','   <div class="tau-testCasesRunResults-container">','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-passed">Passed: ${passedCount}</span>','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-failed">Failed: ${failedCount}</span>','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-notRun">Not Run: ${notRunCount}</span>',"   </div>","</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.testCasesRunResults",["tau/components/component.creator","tau/models/model.testCasesRunResults","tau/ui/templates/testCasesRunResults/ui.template.testCasesRunResults"],function(e,t,i){return{create:function(n){var a={ModelType:t,template:i};return e.create(a,n)}}}),define("tau/models/testSteps/model.testStep.list.fetcher",["Underscore","jQuery","tau/core/class"],function(e,t,i){return i.extend({init:function(e){this.config=this._createConfig(e)},fetch:function(){return this._fetchData(this._buildFetchCommand())},_fetchData:function(e){var i=t.Deferred();return this.config.store.get(this.config.entityTypeName,e).done({success:function(e){i.resolve(e)},scope:this}),i.promise()},_createConfig:function(e){var t={configurator:e.context.configurator,entityId:e.context.entity.id,entityTypeName:e.context.entity.entityType.name,store:e.store,fieldConfig:e.fieldConfig};return t},_buildFetchCommand:function(){return{id:this.config.entityId,fields:this.config.fieldConfig,nested:!0}}})}),define("tau/models/testSteps/model.testStep.list",["Underscore","jQuery","tau/core/extension.base","tau/models/testSteps/model.testStep.list.fetcher"],function(e,t,i,n){return i.extend({"bus beforeInit":function(e,t){var i=t.config;
this.entityId=i.context.entity.id,this.store=i.store,this.entityTypeName=i.context.entity.entityType.name,this.dataFetcher=new n(i),this._fetch(),this.fire("model.changes",[])},"bus model.changes:last + model.record.update":function(t,i,n){if(n.record.id){var a=e.chain(this.model.items).filter(function(e){return e.id==n.record.id}).first().value();if(a&&(a.description!=n.record.description||a.result!=n.record.result||void 0!==n.record.runorder&&a.runorder!=n.record.runorder)){var r=i[i.length-1];i.length&&r.item.record.id==n.record.id?r.item.record=n.record:(i.push({op:"edit",item:n}),this.changes=i)}}else i.push({op:"add",item:n})},"bus model.changes:last + model.remove":function(e,t,i){t=this._purgeQueueElements(t,i.record.id),t.push({op:"delete",item:i}),this.fire("sync.model")},"bus model.changes:last + sync.model":function(i,n){var a=t.Deferred(),r=n.pop();if(r){switch(r.op){case"delete":if(!r.item.record.id)return void this.fire("model.item.removed",r.item);this._removeItem(r.item.record,a),a.done(function(){this.model.items=e.filter(this.model.items,function(e){return e.id!=r.item.record.id}),this.fire("model.item.removed",r.item.element)}.bind(this));break;case"add":this._addItem(r.item.record,a),a.done(function(e){this.model.items.push(this._createModelItem(e[0])),this.fire("model.item.added",{element:r.item.element,id:e[0].id})}.bind(this));break;case"edit":this._saveItem(r.item.record,a),a.done(function(t){this.model.items[e.indexOf(this.model.items,e.find(this.model.items,function(e){return e.id==t[0].id},this))]=this._createModelItem(t[0])}.bind(this))}this._evictTestStepsCollection(r),this.fire("sync.model")}},"bus destroy":function(){e.each(this.changes,function(e){"edit"==e.op&&this._saveItem(e.item.record,t.Deferred())}.bind(this))},_evictTestStepsCollection:function(e){(e.item.record.runorder||"delete"==e.op)&&this.store.evictProperties(this.entityId,this.entityTypeName,["testSteps"])},_purgeQueueElements:function(t,i){if(!t.length)return t;var n=e.reject(t,function(e){return e.item.record.id==i
});return n.length!=t.length?(this.fire("model.changes",n),n):t},_fetch:function(){this.dataFetcher.fetch().always(function(e){this.model=this._getTestSteps(e),this.fire("dataBind",this.model)}.bind(this))},_getTestSteps:function(e){var t=e[0]&&e[0].data&&e[0].data.testSteps?e[0].data.testSteps:[];return{items:this._createModelItems(t)}},_createModelItems:function(t){return e.map(t,function(e){return this._createModelItem(e)},this)},_createModelItem:function(e){return{id:e.id,description:this._tryGetProperty(e,"Description")||"",result:this._tryGetProperty(e,"Result")||"",runorder:this._tryGetProperty(e,"RunOrder"),__type:e.__type}},_tryGetProperty:function(e,t){return e[t]||e[this.lowerCaseFirstLetter(t)]},lowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},_saveItem:function(e,t){this.store.save("teststep",this._getUpdateFieldConfiguration(e),this._getStoreBehavior(t)).done()},_addItem:function(e,t){this.store.save("teststep",this._getDefaultFieldConfiguration(e),this._getStoreBehavior(t)).done()},_removeItem:function(e,t){this.store.remove("teststep",{id:e.id},this._getStoreBehavior(t)).done()},_getDefaultFieldConfiguration:function(e){return{$set:{description:e.description,result:e.result,runOrder:e.runorder,testCase:{id:this.entityId}},fields:["id","description","result","runOrder",{testCase:["id"]}]}},_getUpdateFieldConfiguration:function(e){return t.extend(this._getDefaultFieldConfiguration(e),{id:e.id})},_getStoreBehavior:function(e){return{scope:this,success:function(t){e.resolve([t.data])},fail:function(){e.reject()}}}})}),define("tau/ui/extensions/testStepList/ui.extension.testStep.editable",["jQuery","Underscore","tau/components/extensions/property/extension.lightweight.richeditor.base"],function(e,t,i){var n="teststep-editor";return i.extend({category:"edit",editorRoleSelector:".i-role-editable",activeEditorRoleSelector:".i-role-editable:not(.disable)",editorRoleClassName:"i-role-editable",itemRoleSelector:".i-role-teststep",removeRoleSelector:".i-role-remove",testCaseDescriptionSelector:".test-case-description_colom","bus afterRender":function(i,a){this._super(i,a);
var r=a.element,s=this;this.$element=r,this.fire("activeRow",null),e(this.activeEditorRoleSelector,r).attr("contenteditable",!0),r.on("click."+n,s.editorRoleSelector,function(){var i,n=e(this),a=n.hasClass("disable"),r={editor:n};a&&(i=[function(t){e(t).focus()}],t.extend(r,{editorIndex:n.closest(s.testCaseDescriptionSelector).index(),insertStep:"above",focusOnNewStep:!0})),s._setFocusToEditor(r,i)}),r.on("blur."+n+" focus."+n,s.activeEditorRoleSelector,this._onFocusChange.bind(this,r)),r.on("keydown."+n,s.editorRoleSelector,function(t){if(t.keyCode!=e.ui.keyCode.TAB||t.shiftKey){if(t.keyCode==e.ui.keyCode.ENTER&&(t.ctrlKey||t.metaKey||(t.ctrlKey||t.metaKey)&&t.shiftKey)){var i=e(t.target).closest(s.itemRoleSelector).find(s.editorRoleSelector).first();s._changeFocusHandler({editor:i,focusOnNewStep:!0,insertStep:t.shiftKey?"above":"below",includeRunOrder:!0})}else if(t.keyCode==e.ui.keyCode.DELETE&&(t.ctrlKey||t.metaKey)){var n=e(t.target).closest(s.itemRoleSelector).first();s._removeHandler(n)}}else{t.preventDefault();var a=e(s.editorRoleSelector,r),o=a.index(this),i=a.eq(o+1);s._changeFocusHandler({editor:i,insertStep:"above",focusOnNewStep:i.hasClass("disable")})}}),r.on("click."+n,s.removeRoleSelector,function(t){var i=e(t.currentTarget);i.attr("tabindex",0),i.focus();var n=e(this).closest(s.itemRoleSelector).first();s._removeHandler(n)}),r.on("mousedown."+n,s.testCaseDescriptionSelector,function(t){var i=e(this).children().first(),n=t.srcElement||t.target;n==e(this).get(0)&&(t.preventDefault(),i.focus())})},_unbindHandlers:function(e){this._super(e),e.off(n)},_getComponentSelector:function(){return this.editorRoleSelector},_onFocusChange:function(e,t){"focusin"==t.type?this._onFocusIn(e,t):this._onFocusOut(e,t)},_onFocusIn:function(t,i){var n=e(i.currentTarget);this._cleanSavedFocusOutEvent(),this._setFocusToEditor({editor:n},[function(){this._initializeEditor(n)}])},_cleanSavedFocusOutEvent:function(){this.fire("focus.out",null)},_onCreate:function(e){this._super(e),this._toggleFullPreviewMode(this.$element,!1);
var t=this._getCkEditor(e);this._setCaretToEnd(t),this._setFocus(t,e[0])},_setCaretToEnd:function(e){var t=new CKEDITOR.dom.range(e.document);t.moveToElementEditEnd(e.editable()),t.select(),t.scrollIntoView()},_setFocus:function(e,t){e.focusManager.focus({$:t})},_onCKEditorBlur:function(e){this._toggleFullPreviewMode(this.$element,!0),this._destroyEditor(e),this.fire("ckeditor.blur",e[0])},_destroyEditor:function(e){e.data("ui-richeditor")&&e.richeditor("destroy")},_onFocusOut:function(t,i){var n=e(i.currentTarget);this.fire("model.record.update",this._createModelItem(this._getTestStepDOMElement(n))),this._hasLostFocus(t,i)&&this.fire("focus.out",n[0])},"bus ckeditor.blur + focus.out:last":function(e,t,i){t===i&&this.fire("activeRowChanged",null)},"bus test.step.order.changed":function(e,t){this.fire("model.record.update",this._createModelItem(t.teststep,!0)),this.fire("sync.model")},"bus activeRow:last + activeRowChanged":function(e,t,i){t&&this._highlightRow(t,!1),i&&this._highlightRow(i,!0),this.fire("activeRow",i),this.fire("sync.model")},"bus activeRow:last + activeEditorChanged":function(e,t,i){var n=this._getTestStepDOMElement(i);t&&this._sameDOMElements(t,n)||this.fire("activeRowChanged",n)},"bus activeRow:last + addRow":function(t,i,n){var a="above"==n.insertRow?n.newRow.insertBefore(n.currentRow):n.newRow.insertAfter(n.currentRow);a.addClass("highlight").find(this.removeRoleSelector).removeClass("hidden");var r=e(this.editorRoleSelector,a).removeClass("disable").attr("contentEditable","true").empty();n.currentRow.removeClass("highlight"),this.fire("model.record.update",this._createModelItem(n.newRow,n.includeRunOrder)),this.fire("sync.model"),n.callback.resolve(r.eq(n.editorIndex?n.editorIndex:0))},"bus activeRow:last + try.addRow":function(e,t,i){var n=i.editor.closest(this.itemRoleSelector),a=this.itemRoleSelector+":last",r=this.$element.find(a).clone();this.fire("activeRowChanged",n),this.fire("addRow",{currentRow:n,newRow:r,callback:i.callback,insertRow:i.insertStep,editorIndex:i.editorIndex,includeRunOrder:i.includeRunOrder})
},"bus activeRow:last + model.item.removed":function(e,t,i){t&&this._sameDOMElements(t,i)&&this.fire("activeRow",null),i.remove()},"bus model.item.added":function(e,t){t.element.attr("data-id",t.id)},_hasLostFocus:function(t,i){return 0==e(t).has(i.relatedTarget).length||!i.relatedTarget||!e(i.relatedTarget).hasClass(this.editorRoleClassName)},_sameDOMElements:function(e,t){return e.get(0)==t.get(0)},_getTestStepDOMElement:function(t){return e(t).closest(this.itemRoleSelector).first()},_createModelItem:function(t,i){var n=e(this.editorRoleSelector,t),a={element:t,record:{id:t.data("id")||void 0,description:n.eq(0).html(),result:n.eq(1).html(),__type:"testStep"}};return i&&(a.record.runorder=t.index(".i-role-teststep")+1),a},_highlightRow:function(e,t){e.toggleClass("active highlight",t)},_highlightAddNewTestStep:function(i){var n=e.Deferred();return this.fire("try.addRow",t.extend(i,{callback:n})),n.promise()},_removeHandler:t.throttle(function(e){this.fire("model.remove",{element:e,record:{id:e.data("id")}})},250,{leading:!1}),_changeFocusHandler:t.throttle(function(e){e.focusOnNewStep?this._highlightAddNewTestStep(e).done(function(e){e.focus()}):e.editor.focus()},200,{leading:!1}),_setFocusToEditor:function(e,i){var n=function(e){this.fire("activeEditorChanged",e),i&&t.isArray(i)&&t.each(i,function(i){t.isFunction(i)&&i.apply(this,e)}.bind(this))}.bind(this);e.focusOnNewStep?this._highlightAddNewTestStep(e).done(n):n(e.editor)}})}),define("tau/ui/extensions/testStepList/ui.extension.testStep.sortable",["require","tau/core/extension.base","jQuery"],function(e){var t=e("tau/core/extension.base"),i=e("jQuery");return t.extend({category:"edit","bus afterRender":function(e,t){var n=t.element;n.sortable({items:".i-role-teststep[data-id]",appendTo:n,distance:5,axis:"y",placeholder:this._createPlaceholder(),opacity:.8,cancel:'[contentEditable="true"]',cursor:"move",start:function(e,t){var a=i(document.activeElement);a.is(".i-role-editable")&&a.blur(),this._toggleClassesOnDnD(n,t.item)
}.bind(this),stop:function(e,t){this._toggleClassesOnDnD(n,t.item)}.bind(this),update:function(e,t){this.fire("test.step.order.changed",{teststep:t.item})}.bind(this)})},_createPlaceholder:function(){return{element:function(){var e=i('<div class="test-case-description_rows i-role-teststep tau-sortable__placeholder-inner">Reordering</div>');return e},update:function(e,t){var i=e.currentItem,n=i.height();t.width(i.width()),t.height(n),t.css("line-height",n+"px")}}},_toggleClassesOnDnD:function(e,t){this._toggleListClass(e),this._toggleListItemClass(t)},_toggleListClass:function(e){e.toggleClass("tau-teststep-reordering")},_toggleListItemClass:function(e){e.toggleClass("tau-teststep-draggable")}})}),define("template!tau/ui/templates/testStepList/ui.template.teststep.hints",["tau/core/templates-factory"],function(e){var t={name:"teststep.hints",engine:"jqote2",customFunctions:null,markup:'<div class="test-case-tip"> <div class="tau-btn tau-btn-small tau-btn-transparent-dark"><%= this.ctrlBtnName%></div> + <div class="tau-btn tau-btn-small tau-btn-transparent-dark">Enter</div> &mdash; add step after,&nbsp;&nbsp; <div class="tau-btn tau-btn-small tau-btn-transparent-dark"><%= this.ctrlBtnName%></div> + <div class="tau-btn tau-btn-small tau-btn-transparent-dark">Shift</div> + <div class="tau-btn tau-btn-small tau-btn-transparent-dark">Enter</div> &mdash; add step before,&nbsp;&nbsp; <div class="tau-btn tau-btn-small tau-btn-transparent-dark"><%= this.ctrlBtnName%></div> <% if(this.delFnBtnName) {%> + <div class="tau-btn tau-btn-small tau-btn-transparent-dark"><%= this.delFnBtnName%></div> <% } %> + <div class="tau-btn tau-btn-small tau-btn-transparent-dark"><%= this.delBtnName%></div> &mdash; delete current step.&nbsp;&nbsp; <a href="#" class="test-case-tip__link">Got it</a> </div>'};return e.register(t)}),define("tau/ui/extensions/testStepList/ui.extension.testStep.hints",["require","tau/core/extension.base","tau/utils/utils.storage","jQuery","Underscore","template!tau/ui/templates/testStepList/ui.template.teststep.hints"],function(e){var t=e("tau/core/extension.base"),i=e("tau/utils/utils.storage"),n=e("jQuery"),a=e("Underscore"),r=e("template!tau/ui/templates/testStepList/ui.template.teststep.hints");
return t.extend({testStepHintsPropertySettings:{masterKey:"testCase",key:"testStepHintsDisabled",group:"settings",scope:"public"},eventNamespace:"testStepHints",testStepHintsSelector:".test-case-tip",testStepHintsHideLinkSelector:".test-case-tip__link",buttonNames:{mac:{ctrlBtnName:"Cmd",delBtnName:"Backspace",delFnBtnName:"Fn"},"default":{ctrlBtnName:"Ctrl",delBtnName:"Del"}},"bus afterInit":function(e,t){var i=t.config.context.configurator;if(this.storage=i.getRestStorage(),this.loggedUser=i.getLoggedUser(),!this._isHintsDisabled()){var n=this._getHintsPropertyValue();n.done(function(e){var t=this._getPropertyValue(e);(a.isUndefined(t)||a.isNull(t))&&this._createUpdateHintsPropertyValue(!1),this.fire("hintsPropertyDataReady",{disabled:t===!0})}.bind(this))}},"bus afterRender + hintsPropertyDataReady:last":function(e,t,i){var n=t.element;this._unbindHandlers(n),i.disabled||this._bindHandlers(n)},"bus afterRender > destroy":function(e,t){var i=t.element;this._unbindHandlers(i)},"bus afterRender:last + hintsPropertyDataReady:last + activeRowChanged":function(e,t,i,n){n&&!i.disabled&&this._showHints(n)},_bindHandlers:function(e){e.on("click."+this.eventNamespace+" mousedown."+this.eventNamespace,this.testStepHintsHideLinkSelector,this._onHideHintsLinkClicked.bind(this)),this.storage.on("afterUpdate",this._onStorageUpdate.bind(this,e),this)},_unbindHandlers:function(e){e.off(this.eventNamespace),this.storage.removeAllListeners(this)},_showHints:function(e){if(!this._hasHints(e)){var t=this._getHintsTemplate();e.append(t)}},_onHideHintsLinkClicked:function(e){e.preventDefault(),e.stopPropagation(),"click"==e.type&&this._createUpdateHintsPropertyValue(!0)},_onStorageUpdate:function(e,t,i){var n=this._getPropertyValue(i.$value);n&&this._hideHints(e)},_getPropertyValue:function(e){return e&&e.userData&&e.userData[this.testStepHintsPropertySettings.key]},_hideHints:function(e){this._disableHints(),this._removeHints(e),this.fire("hintsPropertyDataReady",{disabled:!0})},_getLocalStorageKey:function(){return this.testStepHintsPropertySettings.key+"_"+this.loggedUser.id
},_isHintsDisabled:function(){return i.get(this._getLocalStorageKey())===!0},_disableHints:function(){i.set(this._getLocalStorageKey(),!0)},_removeHints:function(e){e.find(this.testStepHintsSelector).remove()},_hasHints:function(e){return e.has(this.testStepHintsSelector).length},_getHintsTemplate:function(){if(!this.hintsTemplate){var e=window.session&&window.session.browser&&"Mac"==window.session.browser.os?this.buttonNames.mac:this.buttonNames.default;this.hintsTemplate=r.get().bind(null,e)}return this.hintsTemplate},_getHintsPropertyValue:function(){return this._performClientStorageOperation(this.testStepHintsPropertySettings)},_createUpdateHintsPropertyValue:function(e){return this._performClientStorageOperation(this.testStepHintsPropertySettings,e)},_performClientStorageOperation:function(e,t){var i,r=e.group,s=e.masterKey;if(!a.isUndefined(t)){var o={};o[e.key]=t,i={scope:e.scope,userData:o}}var l=n.Deferred();return this.storage.data(r,s,i).then(function(e){l.resolve(e.data)},function(){l.reject()}),l.promise()}})}),define("tau/components/component.testStepList",["tau/components/component.creator","tau/models/testSteps/model.testStep.list","tau/ui/extensions/testStepList/ui.extension.testStep.editable","tau/ui/extensions/testStepList/ui.extension.testStep.sortable","tau/ui/extensions/testStepList/ui.extension.testStep.hints","tau/ui/extensions/content/ui.extension.content.imagePreview","tau/ui/templates/testStepList/ui.template.testStepList"],function(e,t,i,n,a,r,s){return{create:function(o){var l=[t,i,r,a],u=!0;_.isUndefined(o.sortable)?_.isUndefined(o.allData)||_.isUndefined(o.allData.sortable)||(u=o.allData.sortable):u=o.sortable,u&&l.push(n);var c={extensions:l,template:o.template||s};o.fieldConfig=[{testSteps:["description","result","runOrder"]}],o.imagePreviewContentSelector=".i-role-property";var d=e.create(c,o);return d}}}),define("tau/ui/templates/testStepRunList/ui.template.testStepRun.switch",["tau/core/templates-factory"],function(e){var t={engine:"jqote2",name:"test-step-run-switch",markup:['<div class="test-case-description_switch i-role-switch">',"<% if(this.passed) { %>",'<button class="tau-btn tau-btn-big tau-passed i-role-switch-btn active" data-result="passed">Passed</button>','<button class="tau-btn tau-btn-big tau-failed i-role-switch-btn" data-result="failed">Failed</button>',"<% } %>","<% if(!this.passed) { %>",'<button class="tau-btn tau-btn-big tau-failed i-role-switch-btn active" data-result="failed">Failed</button>','<button class="tau-btn tau-btn-big tau-passed i-role-switch-btn" data-result="passed">Passed</button>',"<% } %>","</div>"].join("")};
return e.register(t)}),define("tau/ui/templates/testStepRunList/ui.template.testStepRun.status",["tau/core/templates-factory"],function(e){var t={engine:"jqote2",name:"test-step-run-status",customFunctions:{getStatus:function(e,t){return t&&e?"passed":t&&!e?"failed":"skipped"},getStatusLabel:function(e,t,i){var n=this.getStatus(e,t);return"skipped"==n&&(n="not run"),i?this.capitaliseFirstLetter(n):n},capitaliseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},markup:['<button onclick="return false;" class="tau-btn tau-btn-big i-role-status tau-<%= fn.getStatus(this.passed, this.runned) %>" data-result="<%= fn.getStatus(this.passed, this.runned) %>">',"<%= fn.getStatusLabel(this.passed, this.runned, true) %>","</button>"].join("")};return e.register(t)}),define("tau/ui/templates/testStepRunList/ui.template.testStepRun.active",["tau/core/templates-factory"],function(e){var t={engine:"jqote2",name:"test-step-run-active",markup:['<div class="tau-inline-group" data-result="skipped">','<button class="tau-btn tau-btn-green i-role-set-status" data-result="passed">Pass</button>','<button class="tau-btn tau-btn-red i-role-set-status" data-result="failed">Fail</button>',"</div>"].join("")};return e.register(t)}),define("tau/ui/extensions/testStepRunList/ui.extension.testStepRun.editable",["tau/core/extension.base","tau/ui/templates/testStepRunList/ui.template.testStepRun.switch","tau/ui/templates/testStepRunList/ui.template.testStepRun.status","tau/ui/templates/testStepRunList/ui.template.testStepRun.active"],function(e,t,i,n){return e.extend({category:"edit",testPlanRun:null,element:null,activeElementMarkup:n.get().bind(null),"bus afterInit":function(e,t){this.fire("stateSelectionShown",null);var i=t.config.store,n=t.config.context.entity;i.get(n.entityType.name,{id:n.id,fields:[{testplanrun:["id",{entitystate:["isFinal"]}]}]}).done({success:function(e){this.testPlanRun=e[0].data.testplanrun,this.fire("init.finished")},scope:this})},"bus init.finished + afterRender":function(e,t,i){this.element=i.element;
var n=this;this.testPlanRun.entitystate.isFinal?this.element.find(".i-role-status").attr("disabled","disabled"):(this.element.on("click",".test-case-run-description_colom .i-role-status",function(){if("skipped"!=$(this).attr("data-result")){n.fire("changeStatus");var e=n._$renderSwitch("passed"==$(this).attr("data-result"));e.hide(),$(this).after(e),e.show(100),$("button",e).first().focus(),n.fire("stateSelectionShown",e)}}),this.element.on("click",".i-role-switch .i-role-switch-btn",function(){var e=$(this);e.hasClass("active")||n.fire("model.update.status",n._createModelItem(e))}),this.element.on("click",".i-role-set-status",function(){n.fire("model.set.status",n._createModelItem($(this)))}),this.element.on("blur",".test-case-run-description_colom  .i-role-switch",function(e){e.relatedTarget&&$(e.relatedTarget).hasClass("i-role-switch-btn")||n.fire("changeStatus")}),this.fire("highlightActiveElement")),this.element.on("click mousedown","a:not(.i-role-fullview)",function(e){e.preventDefault(),e.stopPropagation(),"click"==e.type&&window.open(this.href)})},"bus stateSelectionShown:last + changeStatus":function(e,t){this._$removeSwitch(t)},"bus highlightActiveElement":function(){$(".i-role-teststep.active",this.element).removeClass("active");var e=this.element.find('[data-result="skipped"]').first();e.closest(".i-role-teststep").addClass("active"),e.replaceWith(this.activeElementMarkup)},"bus model.did.update":function(e,t){var i=this.element.find('[data-id="'+t.id+'"] .i-role-state'),n=i.data("result"),a=t.passed?"passed":"failed";i.data("result",a),n&&i.find(".i-role-switch").trigger("blur"),this._updateElementState(i,a),this.fire("highlightActiveElement")},_createModelItem:function(e){return{id:this._getTestStepRunId(e),passed:e.data("result")}},_updateElementState:function(e,t){$(e).html(this._$renderStatus("passed"==t))},_getTestStepRunId:function(e){return e.closest(".i-role-teststep").data("id")},_$renderSwitch:function(e){return t.get().bind(null,{passed:e})},_$renderStatus:function(e){return i.get().bind(null,{passed:e,runned:!0})
},_$removeSwitch:_.throttle(function(e){e&&e.hide(100,function(){e.remove()})},200,{leading:!1})})}),define("tau/models/testSteps/model.testStepRun.list",["Underscore","jQuery","tau/core/extension.base","tau/models/testSteps/model.testStep.list.fetcher","tau/utils/utils.date"],function(e,t,i,n,a){return i.extend({"bus beforeInit":function(e,t){var i=t.config;this.dataFetcher=new n(i),this.store=i.store,this.testStepRuns=[],this.entityId=i.context.entity.id,this._fetch()},"bus model.update.status":function(e,t){this._updateItem({id:t.id,passed:"passed"==t.passed?!0:!1})},"bus model.set.status":function(e,t){this._saveItem({id:t.id,passed:"passed"==t.passed?!0:!1})},_fetch:function(){this.dataFetcher.fetch().always(function(e){this.testStepRuns=this._getTestStepsRuns(e),this.fire("dataBind",this.testStepRuns)}.bind(this))},_saveItem:function(e){this.store.save("teststeprun",this._getFieldConfiguration(e),this._getStoreBehavior()).done()},_updateItem:function(e){this.store.save("teststeprun",this._getUpdateFieldConfiguration(e),this._getStoreBehavior()).done()},_getUpdateFieldConfiguration:function(e){return{$set:{id:e.id,passed:e.passed},fields:["id","passed"]}},_getFieldConfiguration:function(t){var i=this._getUpdateFieldConfiguration(t);return e.defaults(i.$set,{runned:!0}),i.fields.push("runned"),i},_getStoreBehavior:function(){return{scope:this,success:function(e){this._updateModel(e.data),this.fire("model.did.update",e.data)}}},_getTestStepsRuns:function(t){var i=t[0]&&t[0].data&&t[0].data.testStepRuns?t[0].data.testStepRuns:[];return{items:e.map(i,function(e){return{id:e.id,step:e.testStep,passed:e.Passed,runned:e.Runned}}.bind(this))}},_updateModel:function(t){var i=e.find(this.testStepRuns.items,function(e){return e.id===t.id});i&&(i.passed=t.passed,this._changeTestCaseRunStateIfNeeded(i))},_changeTestCaseRunStateIfNeeded:function(t){var i,n;t.passed?i=e.every(this.testStepRuns.items,function(e){return e.passed}):n=1==e.reduce(this.testStepRuns.items,function(e,t){return null==t.passed||t.passed?e:++e
},0),(n||i)&&this.store.save("testcaserun",{$set:{id:this.entityId,passed:t.passed,runDate:a.format.datetime.full(a.getServerNow())},fields:["passed","runDate"]}).done()}})}),define("tau/components/component.testStepRunList",["tau/components/component.creator","tau/ui/extensions/testStepRunList/ui.extension.testStepRun.editable","tau/models/testSteps/model.testStepRun.list","tau/ui/templates/testStepRunList/ui.template.testStepRunList","tau/ui/extensions/content/ui.extension.content.imagePreview"],function(e,t,i,n,a){return{create:function(r){var s=[i,a],o=!0;_.isUndefined(r.allData)||_.isUndefined(r.allData.editable)||(o=r.allData.editable),o&&s.push(t);var l={extensions:s,template:r.template||n};r.fieldConfig=[{testStepRuns:["Passed","Runned",{testStep:["Description","Result"]}]}],r.imagePreviewContentSelector=".i-role-teststep";var u=e.create(l,r);return u}}}),define("tau/models/model.text.base",["Underscore","tau/core/extension.base.stateful"],function(e,t){return t.extend({textField:"name",onInit:function(t){var i=t.context,n=this.store,a=i.entity;n.unbind(this),n.on({eventName:"afterSave",type:a.entityType.name,listener:this,filter:{id:a.id},hasChanges:[this.textField]},this.fire.bind(this,"refresh"));var r=["id",this.textField];n.get(a.entityType.name,{id:a.id,fields:r}).done({success:e.bind(function(e){this.fire("data.ready",e[0].data)},this)})},getDataToBind:function(t,i,n){var a=e.pick(t,"id",this.textField);return a.entityType={name:n.entityType.name.toLowerCase()},a},"bus beforeInit+data.ready":function(e,t,i){var n=t.config.context,a=n.configurator,r=n.entity,s=this.getDataToBind(i,a,r);this.fire("dataBind",s)},"bus configurator.ready + destroy":function(e,t){t.getStore().unbind(this)}})}),define("tau/models/model.description",["Underscore","tau/models/model.text.base"],function(e,t){return t.extend({textField:"description",getDataToBind:function(e,t,i){var n=this._super(e,t,i);return n.entity={description:e.description},n}})}),define("tau/models/model.text.editable.base",["tau/core/model.editable.base"],function(e){var t=e.extend({category:"edit","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable===!0||void 0===this.config.editable,deletable:!0})
},"bus validate":function(e){var t=e.data,i=t.cmd.$set;t.validation=this.schema.validate(i)}});return t}),define("tau/models/model.description.editable",["tau/models/model.text.editable.base","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({name:"Editable description",schema:t.Schema.create({type:"object",properties:{description:{optional:!1,empty:!1,type:"string",pre:["trim"]}}})});return i}),define("tau/ui/extensions/time/ui.extension.description.editor",["tau/core/extension.base"],function(e){return e.extend({category:"edit","bus changeDescription":function(e,t){this.fire("save",{description:_.asString(t)})},"bus permissionsReady + afterRender":function(e,t,i){if(t.editable){var n=i.element;this.$el=n.find(".i-role-description"),this.$el.on("keydown",_.bind(function(e){var t=e.charCode||e.keyCode||0;switch(t){case $.ui.keyCode.ENTER:if(e.shiftKey)return!0;this.fire("changeDescription",this.$el.val());break;case $.ui.keyCode.ESCAPE:return this.fire("destroy"),!1}},this)),this.$el.focus(1)}},"bus validate":function(){this.$el&&this.$el.removeClass("tau-error").removeAttr("title").nextAll(".placeholder").removeClass("tau-error")},"bus validationFailed":function(e){this.$el&&this.$el.addClass("tau-error").attr("title",e.data.validation.errors[0].description).nextAll(".placeholder").addClass("tau-error")}})}),define("tau/ui/templates/description/ui.template.description",["tau/core/templates-factory"],function(e){var t={name:"description.simple",engine:"jqote2",markup:['<div class="tau-field">','<textarea placeholder="Description" style="margin: 0;" class="i-role-description tau-in-text ui-title__title"><%! this.description %></textarea>',"</div>"],dependencies:[]};return e.register(t)}),define("tau/components/component.time.description.edit",["require","tau/components/component.creator","tau/models/model.description","tau/models/model.description.editable","tau/ui/extensions/time/ui.extension.description.editor","tau/ui/templates/description/ui.template.description"],function(e){var t=e("tau/components/component.creator"),i=e("tau/models/model.description"),n=e("tau/models/model.description.editable"),a=e("tau/ui/extensions/time/ui.extension.description.editor"),r=e("tau/ui/templates/description/ui.template.description");
return{create:function(e){e=e||{};var s={extensions:[i,n,a],template:e.template||r};return t.create(s,e)}}}),define("tau/ui/extensions/time/ui.extension.time",["Underscore","jQuery","tau/core/extension.base"],function(e,t,i){return i.extend({init:function(e,t,i,n){return this.model=n,this.configurator=t,this.entity=i,this.culture=t.getSystemInfo().culture,this._super(e)},"bus beforeInit":function(){t.when(this.model.load()).then(e.bind(function(e){this.fire("dataBind",{spent:e.spent,remain:e.remain})},this))},"bus afterRender":function(i,n){var a=n.element,r=function(e){return Math.round(100*e)/100},s=a.find(":input"),o=s.filter(".i-role-spent"),l=s.filter(".i-role-remain"),u="^[0-9]*([\\"+this.culture.decimalSeparator+"][0-9]{0,2})?$";o.inputMaskEditor({mask:u}),l.inputMaskEditor({mask:u});var c=n.data.remain+n.data.spent,d="oninput"in o[0]?"input":"keyup";o.on(d,e.bind(function(){o.removeClass("tau-error");var t=e.parseFloatLocal(o.val(),this.culture)||0,i=(e.parseFloatLocal(c,this.culture)||0)-t;i=0>i?0:i,l.val(e.outFloatLocal(r(i),this.culture)||0)},this)),l.on(d,function(){c=l.val()}),a.on("keydown","input",e.bind(function(e){var i=e.charCode||e.keyCode||0;if(i==t.ui.keyCode.TAB||i==t.ui.keyCode.ENTER||i==t.ui.keyCode.ESCAPE||i==t.ui.keyCode.UP||i==t.ui.keyCode.DOWN){var n=t(e.currentTarget),a=n.parents(".tau-effort");switch(i){case t.ui.keyCode.ENTER:if(!this._validateInputValues(a))return!1;this._saveTimes(a),this.fire("time.editor.finished");break;case t.ui.keyCode.ESCAPE:this.fire("destroy");break;case t.ui.keyCode.TAB:case t.ui.keyCode.UP:case t.ui.keyCode.DOWN:return this._moveToNextInput(a,e.currentTarget),!1}}},this)),a.on("focusin focusout","input",e.bind(function(e){var i=t(e.currentTarget).parents(".tau-effort__group");i.toggleClass("tau-effort__group_state_edit","focusin"===e.type),"focusin"===e.type&&t(e.currentTarget).removeClass("tau-error")},this)),a.on("click",".i-role-edittrigger",e.bind(function(e){var i=t(e.currentTarget);i.parent().find(":text").focus(1)
},this)),a.on("click","form",e.bind(function(e){e.stopPropagation()},this)),a.on("submit","form",e.bind(function(e){var i=t(e.currentTarget).find("input");i.blur(),this.fire("time.editor.finished"),e.preventDefault()},this)),a.find(":text").first().focus(1)},_moveToNextInput:function(e,i){var n=e.find(":input"),a=t.inArray(i,n);if(-1!==a){var r=a===n.length-1?n[0]:n[a+1];r.focus()}},_getSpent:function(t){var i=t.find(":text.i-role-spent").val(),n=parseFloat(i);return e.isNaN(n)?0:n},_getRemain:function(t){var i=t.find(":text.i-role-remain").val(),n=parseFloat(i);return e.isNaN(n)?0:n},_setRemain:function(e,t){e.find(":text.i-role-remain").val(t)},_saveTimes:function(e){var i=this._getSpent(e),n=this._getRemain(e);this.fire("time.editor.saving"),t.when(this.model.saveTimes(i,n)).done(this.fire.bind(this,"time.editor.saved")).fail(this.fire.bind(this,"time.editor.saveFailed"))},_validateInputValues:function(e){return 0!==this._getSpent(e)?!0:(e.find(":text.i-role-spent").addClass("tau-error"),!1)}})}),define("tau/ui/extensions/time/model",["Underscore","jQuery","tau/core/class","tau/core/event","tau/utils/utils.translation","tau/models/dataprocessor/model.processor.context"],function(e,t,i,n){return n.extend(i.extend({init:function(e,t,i){this.store=e,this.contextService=t,this.entity=i},load:function(){return this._loadTimes()},_loadTimes:function(){var e=t.Deferred();return this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:["spent","remain"]}).done(function(t){this.spent=t[0].data.spent,this.remain=t[0].data.remain,e.resolve(this)}.bind(this)),e},saveTimes:function(e,t){return this.store.saveDef(this.entity.entityType.name,{$set:{id:this.entity.id,spent:e,remain:t}})}}))}),define("template!tau/ui/templates/time/ui.template.time.efforts.editor",["tau/core/templates-factory"],function(e){var t={name:"time.efforts.editor",engine:"jqote2",customFunctions:null,markup:'<div class="tau-effort"> <div class="i-role-group tau-effort__group"> <span class="tau-time__grouptitle i-role-edittrigger">Spent</span> <form><input type="text" autocomplete="off" class="i-role-spent" value="<%= this.spent %>"></form> </div> <div class="i-role-group tau-effort__group"> <span class="tau-time__grouptitle i-role-edittrigger">Rem.</span> <form><input type="text" autocomplete="off" class="i-role-remain" value="<%= this.remain %>"></form> </div> </div>'};
return e.register(t)}),define("tau/components/component.time",["tau/components/component.creator","tau/ui/extensions/time/ui.extension.time","tau/ui/extensions/time/model","template!tau/ui/templates/time/ui.template.time.efforts.editor"],function(e,t,i,n){return{create:function(a){var r=a.context.configurator,s=a.context.entity,o={extensions:[{extType:t,args:[r,s,new i(r.getStore(),r.getApplicationContextService(),s)]}],template:n};return e.create(o,a)}}}),define("tau/models/model.timeList",["Underscore","tau/core/model-base","tau/utils/utils.date","tau/utils/utils.convertUserName"],function(e,t,i,n){function a(e){return{id:e,fields:["id","name",{times:["id","date","spent","remain","description",{assignable:["id"]},{user:["id","firstName","lastName"]}]}]}}function r(e){return{id:e,fields:["id",{tasks:["id","name",{times:["id","date","spent","remain","description",{assignable:["id"]},{user:["id","firstName","lastName"]}]}]}],list:!0,nested:!0}}var s=function(e){this.times=[],this.urlBuilder=e};return s.prototype={addAssignable:function(e){this.assignable=e,this._addEntityTimes(this.assignable)},addTasks:function(t){e.each(t,function(e){e.__type="task"});for(var i=0;i<t.length;i++)this._addEntityTimes(t[i])},_parseDate:function(t){return t=e.clone(t),t.date=i.parse(t.date),t},getTimesSortedByDate:function(){var t=e.map(this.times,this._parseDate,this);return t.sort(function(e,t){return t.date-e.date||t.id-e.id}),t},getTimes:function(){return e.map(this.getTimesSortedByDate(),this.convertServerDataModelData,this)},convertServerDataModelData:function(e){return{id:e.id,date:i.format.date.short(i.convertToTimezone(e.date)),spent:e.spent,remain:e.remain,description:e.description,person:n.getFullName(e.user),workOn:{__type:e.workOn.__type,name:e.workOn.name},editUrl:this.urlBuilder.getEditUrl(e.id,"time")}},_addEntityTimes:function(t){for(var i=t.times,n=0;n<i.length;n++){var a=e.clone(i[n]);a.workOn=t,this.times.push(a)}}},t.extend({isUserStory:function(e){return"userstory"==e.toLowerCase()
},onInit:function(){var t=this.config.context,i=new s(t.configurator.getUrlBuilder()),n=t.entity,o=n.entityType.name,l=a(n.id),u=this.isUserStory(o),c=this.store;if(c=c.get(o,l,{success:this.safeCallback(function(e){this.assignable=e.data,i.addAssignable(this.assignable)})}),u){var d=r(n.id);c=c.get(o,d,{success:this.safeCallback(function(e){i.addTasks(e.data.tasks)})})}c.done({success:this.safeCallback(function(){var n={edit:!0},a=i.getTimes(),r=t.configurator.getFeaturesService().isEnabled("tp3.only");r&&(n.edit=!1,e.each(a,function(e){e.editUrl=null})),this.fire("dataBind",{access:n,items:a})})})},"bus beforeInit":function(t,i){var n=i.config.context,a=n.configurator.getStore();a.unbind(this),a.on({type:n.entity.entityType.name,eventName:"afterSave",listener:this},e.bind(this.fire,this,"refresh"))},"bus beforeInit + destroy":function(e,t){var i=t.config.context.configurator;i.getStore().unbind(this)}})}),define("tau/models/model.timeList.editable",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){var i=t.extend({category:"edit","bus beforeInit":function(){this.fire("permissionsReady",{editable:!0})}});return i}),define("tau/ui/templates/common/ui.template.entityIcon",["tau/core/templates-factory","tau/ui/tags/ui.tag.term"],function(e,t){var i={tags:[t],name:"entity-icon",markup:['<em class="tau-entity-icon tau-entity-icon-full tau-entity-icon--${__type.toLowerCase()}">{{term(__type) "iconBig"}}</em>'],dependencies:[]};return e.register(i)}),define("tau/ui/templates/timeList/ui.template.timeList.time",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon"],function(e){var t={name:"time-list-time",markup:["<tr>",'   <td class="date">${date}</td>','   <td class="spent">${spent} h</td>','   <td class="remain">${remain} h</td>','   <td class="description">${description}</td>','   <td class="work-on">','    {{tmpl(workOn) "entity-icon"}}',"    <span>${workOn.name}</span>","   </td>",'   <td class="person">${person}</td>',"{{if editUrl}}",'<td class="edit-time hidden"><a href="${editUrl}">Edit</a></td>',"{{/if}}",'   <td class="delete-time hidden"><button type="button" class="action-detach button small">Delete</button></td>',"</tr>"].join(""),dependencies:["entity-icon"]};
return e.register(t)}),define("tau/ui/templates/timeList/ui.template.timeList",["tau/core/templates-factory","tau/ui/templates/timeList/ui.template.timeList.time"],function(e){var t={name:"time-list",options:{contentSelector:".time-list"},markup:['<div class="ui-timeList-content">','<table class="ui-table box time-list"{{if items.length === 0}} style="display:none"{{/if}}>',"<thead>",'   <tr class="head-row">','       <th class="header-cell">Date</th>','       <th class="header-cell">Time Spent</th>','       <th class="header-cell">Time Remain</th>','       <th class="header-cell">Description</th>','       <th class="header-cell">Work On</th>','       <th class="header-cell">Person</th>',"{{if access.edit}}",'<th class="header-cell edit-time hidden"></th>',"{{/if}}",'       <th class="header-cell delete-time hidden"></th>',"   </tr>","</thead>","<tbody>",'    {{tmpl(items) "time-list-time"}}',"</tbody>","</table>","</div>"].join(""),dependencies:["time-list-time"]};return e.register(t)}),define("tau/components/extensions/timeList/extension.timeList.delete",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus afterRender+permissionsReady+dataBind":function(e){if(e.permissionsReady.data.editable){var i=e.afterRender.data.element;i.find(".delete-time,.edit-time").removeClass("hidden"),i.find(".delete-time button").click(t.proxy(this.onDeleteClick,this))}},"bus afterRemove":function(){this.fire("refresh")},onDeleteClick:function(e){var i=t(e.target).parents("tr").tmplItem().data.id;this.fire("remove",{id:i,typeName:"time"})}})}),define("tau/components/component.timeList",["tau/components/component.list.creator","tau/models/model.timeList","tau/models/model.timeList.editable","tau/ui/templates/timeList/ui.template.timeList","tau/components/extensions/timeList/extension.timeList.delete","tau/core/model.editable.base","tau/ui/extensions/list/extension.fire.nodata.event"],function(e,t,i,n,a,r,s){return{create:function(o){var l={ModelType:t,template:n,extensions:[a,r,i,s],message:"No time records found"};
return e.create(l,o)}}}),define("tau/models/model.title",["Underscore","tau/models/model.text.base"],function(e,t){return t.extend({textField:"name",getDataToBind:function(e,t,i){var n=this._super(e,t,i);return n.entity={name:e.name},n.url=t.getUrlBuilder().getNewViewUrl(n.id,n.entityType.name,!0),n}})}),define("tau/models/model.title.editable",["tau/models/model.text.editable.base","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({name:"Editable title",schema:t.Schema.create({type:"object",properties:{name:{optional:!1,type:"string",maxLength:255,pre:["trim",function(){return _.trim(this.instance.name.replace(/\s+/gi," "))}],fallbacks:{maxLength:"truncateToMaxLength",optional:function(){}}}}})});return i}),define("tau/ui/extensions/title/ui.extension.title.editable",["tau/core/extension.base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e){return e.extend({category:"edit","bus changeName":function(e,t){this.fire("save",{name:_.asString(t)})},"bus permissionsReady + afterRender":function(e,t,i){var n=this;if(t.editable){var a=i.element,r=a.find(".i-role-title");this.$widget=r,r.editableText({restoreText:!0,onSave:function(e){n.fire("changeName",e)}}),this.fire("$editable.ready",r)}},"bus validate":function(){this.$widget&&this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(e){this.$widget&&this.$widget.editableText("setValue",e.data.validation.instance.name)},"bus validationFailed":function(e){this.$widget&&this.$widget.editableText("setValidationErrors",e.data.validation.errors[0].description)}})}),define("tau/ui/templates/title/ui.template.title.main",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon"],function(e){var t={name:"title.main",markup:['<div class="ui-title-wrap">','<table class="ui-title ui-title_type_main">',"<tbody>","<tr>","<td>",'<div class="ui-title__info">','{{tmpl({__type:entityType.name}) "entity-icon"}}','<span class="entity-id"><a class="ui-link" href="${url}" data-target="new">#${id}</a></span>',"</div>","</td>","<td>",'<div class="ui-title__title i-role-title">',"${name}","</div>","</td>","</tr>","</tbody>","</table>","</div>"],dependencies:["entity-icon"]};
return e.register(t)}),define("tau/components/component.title",["tau/components/component.creator","tau/models/model.title","tau/models/model.title.editable","tau/ui/extensions/title/ui.extension.title.editable","tau/ui/templates/title/ui.template.title.main"],function(e,t,i,n,a){return{create:function(r){r=r||{};var s={extensions:[t,i,n],template:r.template||a};return e.create(s,r)}}}),define("tau/models/model.feature.totalEffort",["Underscore","tau/core/model-base"],function(e,t){var i=t.extend({childType:"userStory",childCountFieldName:"userStories-count",fieldsToListen:["userStories|effort"],onInit:function(){var e=this.config.context.entity;this.entityType=e.entityType.name,this.entityId=e.id,this.listenToEntityUpdates(),this.getEntity()},listenToEntityUpdates:function(){this.store.unbind(this),this.store.on({eventName:"afterSave",type:this.entityType,filter:{id:this.entityId},hasChanges:this.fieldsToListen,listener:this},this.onEntityUpdate.bind(this))},onEntityUpdate:function(){this.fire("refresh")},getEntity:function(){this.store.get(this.entityType,{id:this.entityId,fields:["id","effort",this.childCountFieldName]},this.safeCallback(this.onGetEntity)).done(this.safeCallback(this.onRequestCompleted))},floatToString:function(e){return e.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onGetEntity:function(e){var t=e.data,i=t[this.childCountFieldName];i>0?(this.hidden=!1,this.childCount=i,this.effort=this.floatToString(t.effort),this.pointName=this._getEffortPoints()):this.hidden=!0},onRequestCompleted:function(){this.fire("dataBind",{entityType:this.entityType,childType:this.childType,childCount:this.childCount,effort:this.effort,pointName:this.pointName,hidden:this.hidden})}});return i}),define("tau/models/model.epic.totalEffort",["Underscore","tau/models/model.feature.totalEffort"],function(e,t){var i=t.extend({childType:"feature",childCountFieldName:"features-count",fieldsToListen:["features|effort"],"bus entity.changed":function(){this.store.evictProperties(this.entityId,this.entityType,["effort",this.childCountFieldName]),this.onEntityUpdate()
}});return i}),define("template!tau/ui/templates/feature/ui.template.totalEffort",["tau/core/templates-factory"],function(e){var t={name:"total-effort",engine:"jqote2",customFunctions:null,markup:'<% if (this.hidden) { %> <div class="hidden"></div> <% } else { %> <div> <div class="ui-total-effort"> <%! fn.term(this.entityType, "name") %> has <span class="child-count"><%= this.childCount %></span> <%! fn.term(this.childType, "names") %> with total effort <span class="effort"><%= this.effort %></span><%= this.pointName %> </div> </div> <% } %>'};return e.register(t)}),define("tau/components/component.totalEffort",["tau/components/component.creator","tau/models/model.epic.totalEffort","tau/models/model.feature.totalEffort","template!tau/ui/templates/feature/ui.template.totalEffort"],function(e,t,i,n){var a={epic:t,feature:i};return{create:function(t){var i=t.context.entity.entityType,r={ModelType:a[i.name.toLowerCase()],extensions:t.extensions||[],template:n};return e.create(r,t)}}}),define("tau/components/component.tp-settings.feedback",["tau/components/component.creator"],function(e){return{create:function(t){var i={name:"board.tp-settings.feedback",engine:"jqote2",markup:['<li class="tau-setting-submenu__item">','   <a href="mailto:support@targetprocess.com" target="_blank" class="i-role-feedback">',"       Submit issue","   </a>","</li>"]},n={template:i,extensions:[]},a=e.create(n,t);return a.fire("dataBind",{}),a}}}),define("tau/components/component.tp-settings.live-chat",["tau/components/component.creator"],function(e){return{create:function(t){var i={name:"board.tp-settings.live-chat",engine:"jqote2",markup:["<!-- BEGIN ProvideSupport.com Text Chat Link Code -->",'<% var src="//image.providesupport.com/js/0ju6t9r4k2h281f93tgt7j0vzx/safe-textlink.js?ps_h=NvMC&ps_t="+new Date().getTime();%>',"<% src+=\"&online-link-html=<span class='tau-icon-general tau-icon-live-chat'></span>Live%20chat\";","<% src+=\"&offline-link-html=<span class='tau-icon-general tau-icon-live-chat-red'></span>Live%20chat\";%>",'<li id="scNvMC" class="tau-setting-submenu__item i-taus" tauspref="chat" taustype="header-menu-click">','    <a href="#" class="i-role-live-chat">','        <span class="tau-icon-general tau-icon-live-chat-red"></span>',"        Live chat","    </a>","</li>",'<li id="sdNvMC" style="display:none;"><script type="text/javascript" src="<%=src%>"></script></li>',"<!-- END ProvideSupport.com Text Chat Link Code -->"]},n={template:i,extensions:[]},a=e.create(n,t);
return a.fire("dataBind",{}),a}}}),define("tau/components/settings.menu/process.setup.link/extension.process.setup.link",["require","tau/core/extension.base"],function(e){var t=e("tau/core/extension.base");return t.extend({"bus afterRender":function(e,t){var i=this.bus.getGlobalBus(),n=i.fire.bind(i,"process.setup.start");t.element.on("click",".i-role-process-setup",n)}})}),define("template!tau/components/settings.menu/process.setup.link/template.process.setup.link",["tau/core/templates-factory"],function(e){var t={name:"board.process.setup.link",engine:"jqote2",customFunctions:null,markup:'<li class="tau-setting-submenu__item"> <a href="#" class="i-role-process-setup i-taus" tauspref="process-setup" taustype="header-menu-click">Process setup</a> </li>'};return e.register(t)}),define("tau/components/component.tp-settings.process-setup",["require","tau/components/component.creator","./settings.menu/process.setup.link/extension.process.setup.link","template!./settings.menu/process.setup.link/template.process.setup.link"],function(e){var t=e("tau/components/component.creator"),i=e("./settings.menu/process.setup.link/extension.process.setup.link"),n=e("template!./settings.menu/process.setup.link/template.process.setup.link");return{create:function(e){var a=t.create({template:n,extensions:[i]},e),r=e.context.configurator.getUrlBuilder(),s=r.getRelativeBoardPageUrl("process-setup");return a.fire("dataBind",{url:s}),a}}}),define("tau/ui/extensions/tp-settings/ui.extension.tp-settings.settings",["jQuery","tau/core/extension.base"],function(e,t){return t.extend({"bus afterRender + afterInit":function(t,i,n){var a=n.config.context.configurator,r=a.getApplicationPath(),s=a.loggedUser.isAdministrator,o=s?"/Admin/GlobalSetting.aspx":"/PersonalSettings.aspx",l=r+o+"?rmnav=1&tp3=1",u=i.element;u.tauIFramePopup({url:l}),a.getFeaturesService().isEnabled("contextPrototype")&&u.on("tauiframepopuphide",function(){a.getApplicationContextService().getApplicationContext({}).done(function(e){a.getPrototypeContextEntityService().updateContextPrototype(e)
})}),u.click(function(){e(this).tauIFramePopup("show")})}})}),define("tau/components/component.tp-settings.settings",["tau/components/component.creator","tau/ui/extensions/tp-settings/ui.extension.tp-settings.settings"],function(e,t){return{create:function(i){var n={name:"board.tp-settings.settings",engine:"jqote2",markup:['<li class="tau-setting-submenu__item">','    <a href="#" class="i-role-item-settings tau-setting-submenu__item_settings_link i-taus"','    tauspref="global settings" taustype="header-menu-click">','       <span class="tau-icon-general tau-icon-settings-dark"></span>',"       Settings","   </a>","</li>"]},a={template:n,extensions:[t]},r=e.create(a,i);return r.fire("dataBind",{}),r}}}),define("tau/components/component.tp-settings.user-guide",["tau/components/component.creator","tau/ui/extensions/board.main.menu/ui.extension.board.main.menu.item.help"],function(e,t){return{create:function(i){var n={name:"board.tp-settings.user-guide",engine:"jqote2",markup:['<li class="tau-setting-submenu__item">','<a href="#" class="i-role-user-guide i-taus" tauspref="guide" taustype="header-menu-click">',"User guide","</a>","</li>"]},a={template:n,extensions:[t]},r=e.create(a,i);return r.fire("dataBind",{}),r}}}),define("tau/components/component.tp-settings.user-voice",["tau/components/component.creator"],function(e){return{create:function(t){var i={name:"board.tp-settings.user-voice",engine:"jqote2",markup:['<li class="tau-setting-submenu__item">','   <a href="javascript:UserVoice.showPopupWidget();" class="i-role-user-voice">Send idea</a>',"</li>"]},n={template:i,extensions:[]},a=e.create(n,t);return a.fire("dataBind",{}),a}}}),define("tau/models/model.user.settings",["Underscore","tau/core/model.editable.base"],function(e,t){var i=t.extend({onInit:function(){var t=this.config,i=t.context.entity.id,n=this,a=t.context.applicationContext.loggedUser,r=a.isAdministrator||a.id===i;this.store.get("user",{id:i,fields:["login","email","weeklyAvailableHours","isActive","isObserver","isAdministrator","activeDirectoryName"]}).done(function(t){n.fire("dataBind",e.extend(e.clone(t[0].data),{allowToEditAdmin:a.id!=i&&a.isAdministrator,allowToEditObserver:a.isAdministrator,allowToEdit:r}))
})},"bus model.save":function(t,i){var n=this.config.context.entity.id,a=this;this.store.save("user",{id:n,$set:e.extend(i,{id:n})}).done(function(){a.fire("refresh"),a.fire("model.data.changed",i)})}});return i}),define("tau/ui/extensions/user.settings/ui.extension.user.settings",["Underscore","jQuery","tau/ui/extensions/ui.extension.domOperationsBase","tau/nls/translator","libs/jquery/jquery.inputMaskEditor"],function(e,t,i,n){return i.extend({init:function(){this._super.apply(this,arguments),this.onSaveProxy=e.bind(this.onSave,this),this.onDeleteProxy=e.bind(this.onDelete,this)},"bus afterRender":function(e,t){this.fire("view.update.state");var i=this.config.context.applicationContext.culture.decimalSeparator,n="^[0-9]*(["+i+"][0-9]{0,2})?$";t.element.find(".tau-weekly-hours").inputMaskEditor({mask:n,className:""}),t.element.on("submit",this.onSaveProxy),t.element.find(".tau-btn.tau-delete").click(this.onDeleteProxy)},"bus afterRender:last+dataBind:last+view.state.updated":function(t,i,n,a){var r=!0;e.each(n,function(e,t){a.hasOwnProperty(t)&&a[t]!=e&&(r=!1)}),(a.password&&a.password.length>0||a.passwordConfirmation&&a.passwordConfirmation.length>0)&&(r=!1)},"bus refresh>afterRender:last>model.data.changed":function(e,t,i,n){var a={login:".tau-login",email:".tau-email",weeklyAvailableHours:".tau-weekly-hours",activeDirectoryName:".tau-active-directory-name",isActive:".tau-is-active-container",isObserver:".tau-is-observer-container",isAdministrator:".tau-is-administrator-container",password:".tau-password,.tau-password-confirmation"};for(var r in a)void 0!==n[r]&&this.fire("updateElement",{element:i.element.find(a[r])})},"bus afterRender:last+before_view.save.changes":function(t,i,a){a=this.getState(i.element);var r=[],s=!1,o={selector:".tau-weekly-hours",hasError:!1};r.push(o),e.isNaN(parseInt(a.weeklyAvailableHours))&&(o.hasError=s=!0,o.message=n("Please provide weekly hours"));var l={selector:".tau-login",hasError:!1};r.push(l),""==a.login&&(l.hasError=s=!0,l.message=n("Please enter login"));
var u={selector:".tau-email",hasError:!1};r.push(u),""!=a.email?this.config.context.configurator.getConstObject().get("emailRegexp").test(e.trim(a.email))||(u.hasError=s=!0,u.message=n("Invalid email address")):(u.hasError=s=!0,u.message=n("Please enter email"));var c={selector:".tau-active-directory-name",hasError:!1};r.push(c);var d=a.activeDirectoryName,p=d&&d.length>0,f=/(^[A-Za-z0-9.-]+)\\(?! +)([^\\/"\[\]:|<>+=;,?*@]+)$/.test(d);p&&!f&&(c.hasError=s=!0,c.message=n("Invalid active directory user name"));var m={selector:".tau-password",hasError:!1},h={selector:".tau-password-confirmation",hasError:!1};r.push(m),r.push(h);var g=a.password&&a.password.length>0||a.passwordConfirmation&&a.passwordConfirmation.length>0,v=a.password===a.passwordConfirmation;g&&!v&&(h.hasError=m.hasError=s=!0,h.message=m.message=n("Your password and confirmation password don't match")),e.each(r,function(e){var t=i.element.find(e.selector);e.hasError?t.addClass("tau-error").attr("title",e.message):t.removeClass("tau-error").removeAttr("title")}),s&&t["before_view.save.changes"].cancelMain()},"bus dataBind:last+view.save.changes":function(e,t,i){var n=this.getChanges(t,i);this.fire("model.save",n)},getChanges:function(t,i){var n=["login","email","password","weeklyAvailableHours","isActive","isObserver","isAdministrator","activeDirectoryName"],a={};return e.each(n,function(e){(t[e]||"")!=i[e]&&(a[e]=i[e])}),a},onSave:function(e){return this.fire("view.save.changes",this.getState(t(e.target))),!1},onDelete:function(){confirm(n("Do you really want to delete user?"))&&this.fire("remove",{id:this.config.context.entity.id})},getState:function(e){var t=e.find(".tau-password").val();return{login:e.find(".tau-login").val(),email:e.find(".tau-email").val(),password:t.length>0?t:void 0,passwordConfirmation:e.find(".tau-password-confirmation").val(),weeklyAvailableHours:e.find(".tau-weekly-hours").val(),activeDirectoryName:e.find(".tau-active-directory-name").val(),isAdministrator:e.find(".tau-is-admin").prop("checked"),isObserver:e.find(".tau-is-observer").prop("checked"),isActive:e.find(".tau-is-active").prop("checked")}
}})}),define("tau/ui/templates/user.settings/ui.template.user.settings",["tau/core/templates-factory"],function(e){var t={name:"user.settings",markup:["<form>",'<div class="tau-account-settings-container">','<div class="tau-account-settings">','<table class="tau-account-settings-data">',"<tbody>","<tr>","<td>","<label>","Login",'<input type="text" tabindex="1" class="tau-in-text tau-large tau-login" value="${login}" {{if (!allowToEdit )}} disabled="disabled"{{/if}}>',"</label>","</td>","<td>","<label>","Email",'<input type="text" tabindex="4" class="tau-in-text tau-large tau-email" value="${email}" {{if (!allowToEdit )}} disabled="disabled"{{/if}}>',"</label>","</td>","</tr>","<tr>","<td>","<label>","Password <small>(Type the new password if you want to change it)</small>",'<input tabindex="2" type="password" class="tau-in-text tau-large tau-password" {{if (!allowToEdit )}} disabled="disabled"{{/if}}>',"</label>","</td>","<td>","<label>","Active Directory User Name <small>(Ex: MyDomain\\Ted)</small>",'<input tabindex="5" type="text" class="tau-in-text tau-large tau-active-directory-name" value="${activeDirectoryName}" {{if (!allowToEdit )}} disabled="disabled"{{/if}}>',"</label>","</td>","</tr>","<tr>","<td>","<label>","Confirm Password",'<input type="password" tabindex="3" class="tau-in-text tau-large tau-password-confirmation" {{if (!allowToEdit )}} disabled="disabled"{{/if}}>',"</label>","</td>","<td>","<label>","Weekly Hours",'<input type="text" tabindex="6" class="tau-in-text tau-small tau-weekly-hours" value="${weeklyAvailableHours}" {{if (!allowToEdit )}} disabled="disabled"{{/if}} >',"</label>","</td>","</tr>","</tbody>","</table>",'<ul class="tau-account-settings-features">','<li class="tau-is-administrator-container {{if (!allowToEditObserver)}} tau-account-settings-features__item_disabled{{/if}}">','<label class="tau-checkbox">','<input tabindex="7" type="checkbox" class="tau-is-admin" {{if (isAdministrator )}} checked="checked"{{/if}} {{if (!allowToEditObserver)}} disabled="disabled"{{/if}} >','<i class="tau-checkbox__icon"></i>',"<span>Administrator <small>(unlimited access)</small></span>","</label>","</li>",'<li class="tau-is-observer-container {{if (!allowToEditObserver )}} tau-account-settings-features__item_disabled{{/if}}">','<label class="tau-checkbox ">','<input tabindex="8" type="checkbox" class="tau-is-observer"{{if (isObserver )}} checked="checked"{{/if}} {{if (!allowToEditObserver )}} disabled="disabled"{{/if}}>','<i class="tau-checkbox__icon"></i>',"<span>Observer <small>(read-only access)</small></span>","</label>","</li>",'<li class="tau-is-active-container {{if (!allowToEditObserver )}} tau-account-settings-features__item_disabled{{/if}}">','<label class="tau-checkbox ">','<input tabindex="9" type="checkbox" class="tau-is-active" {{if (isActive )}} checked="checked"{{/if}} {{if (!allowToEditObserver)}} disabled="disabled"{{/if}}>','<i class="tau-checkbox__icon"></i>',"<span>Active <small>(deactivate if you want to free up a license for an active user)</small></span>","</label>","</li>","</ul>",'<button tabindex="10" class="tau-btn tau-primary tau-update" {{if (!allowToEdit )}} disabled="disabled"{{/if}} type="submit">Update Settings</button>','<button tabindex="11" class="tau-btn tau-danger tau-delete" {{if (!allowToEditAdmin)}} disabled {{/if}} type="button">Delete User</button>',"</div>","</div>","</form>"].join("")};
return e.register(t)}),define("tau/components/component.user.settings",["tau/components/component.creator","tau/models/model.user.settings","tau/ui/extensions/user.settings/ui.extension.user.settings","tau/ui/templates/user.settings/ui.template.user.settings"],function(e,t,i,n){return{create:function(a){var r={name:"avatar",extensions:[t,i],template:n};return a["queue.bus"]=!0,e.create(r,a)}}}),define("tau/models/model.userList",["Underscore","tau/core/model-base","tau/utils/utils.textsearch"],function(e,t,i){return t.extend({init:function(){this._super.apply(this,arguments),this.textSearch=new i},"bus setFilter":function(e){this.config.data.filter=e.data.filter,this.fire("refresh",{refreshSelector:".user-list,.footer-box"})},setShowMore:function(e){this.config.data.showMore=e},"bus showMore":function(){this.setShowMore(!0),this.fire("refresh",{refreshSelector:".user-list,.footer-box"})},onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction",{})},"bus projectMembersReady+excludedUserReady+projectRolesReady":function(e){var t=e.projectMembersReady.data,i=e.excludedUserReady.data,n=e.projectRolesReady.data,a=[];!this.excludedUsersContainsLoggedUser(i)&&this.loggedUserInProjectTeam(t)&&(a=[{id:"assign-to-me",title:"Assign To Me"}]);var r=[];this.filterIsNotEmpty()?r=this.getFilteredGroups(n,t,i):(r=this.getGroups(t,i,n),0==r.length&&(this.setShowMore(!0),r=this.getGroups(t,i,n)));var s={headerActions:a,moreAvailable:!1,groups:r};this.fire("extendDataToBind",s),this.fire("dataBind",s)},getGroups:function(e,t,i){for(var n=[],a=0;a<i.length;a++){var r=i[a];if(this.usersForRoleIsVisible(r)){var s=this.getUsersForRole(r,e,t);s.length>0&&n.push({role:r,users:s})}}return n},isStringValidForFilter:function(e){return null!==this.textSearch.match(e,this.config.data.filter)},getFilteredGroups:function(e,t,i){for(var n=[],a=0;a<e.length;a++){for(var r=e[a],s=this.getUsersForRole(r,t,i),o=[],l=0;l<s.length;l++)this.isStringValidForFilter(s[l].name)&&o.push(s[l]);
o.length>0&&n.push({role:r,users:o})}return n},usersForRoleIsVisible:function(e){if(this.isMoreAvailable()){var t=this.config.data||{};if(t.hasOwnProperty("roleId"))return e.id===t.roleId;if(t.role)return e.id==t.role.id}return!0},userIsNotExcluded:function(e,t){if(!e.user.isActive)return!1;var i=e.user.id;if(t.constructor!=Array)return i!=t.id;for(var n=0;n<t.length;n++)if(i==t[n].id)return!1;return!0},getUsersForRole:function(e,t,i){for(var n=[],a=0;a<t.length;a++){var r=t[a];r.role.id==e.id&&this.userIsNotExcluded(r,i)&&n.push(this.convertUser(r.user))}return n.sort(function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return n>i?-1:i>n?1:0}),n},convertUser:function(t){var i=e.trim(t.email);(t.firstName||t.lastName)&&(i=e.trim([t.firstName,t.lastName].join(" ")));var n=this.config.context.configurator;return{id:t.id,name:i,role:t.role,avatar:[n.getApplicationPath(),"/Avatar.ashx?UserId=",t.id,"&size=32"].join("")}},getLoggedUser:function(){return this.config.context.configurator.getLoggedUser()||this.config.context.getLoggedUser()},loggedUserInProjectTeam:function(t){var i=this.getLoggedUser();return e.any(t,function(e){return e.user.id===i.id})},excludedUsersContainsLoggedUser:function(t){var i=this.getLoggedUser();return e.any(t,function(e){return e.id===i.id})},filterIsNotEmpty:function(){return this.config.data.filter&&this.config.data.filter.length},filterIsEmpty:function(){return!this.filterIsNotEmpty()},isMoreAvailable:function(){var e=this.config.data;return this.filterIsEmpty()&&e.showMore!==!0&&(e.hasOwnProperty("roleId")||e.hasOwnProperty("role"))},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/extensions/team/extension.model.teamOfEntityRetriever",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}},t=this.config.context.configurator.getStore().config.proxy.types[e.entityType.name].refs,i=[{project:["id"]}];
t.team&&i.push({team:["id"]}),this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:i},callback:{scope:this,success:function(e){this.fire("teamOfEntityRetriever",e),this.fire("commitTransaction")}}})},"bus teamOfEntityRetriever":function(t){var i=this.config.context.entity||{entityType:{name:""}},n=i.entityType.name.toLowerCase(),a=null,r=null,s=t.data.data;s.project?a=s.project.id:"project"===n&&(a=s.id),s.team?r=s.team.id:"team"===n&&(r=s.id);var o=[],l=e.bind(this.fire,this);a&&o.push(function(e){l("get",{type:"project",query:{id:a,fields:["id",{projectMembers:[{user:["id","firstName","lastName","isActive","email"]},{role:["id","name"]}]}]},callback:{success:function(t){e(!1,t.data.projectMembers)}}})}),r&&o.push(function(e){l("get",{type:"team",query:{id:r,fields:["id",{teamMembers:[{user:["id","firstName","lastName","email","isActive"]},{role:["id","name"]}]}]},callback:{success:function(t){e(!1,t.data.teamMembers)}}})});var u=this;e.parallel(o,function(t,i){var n=e.flatten(i,!0);n=e.uniq(n,!1,function(e){return e.user.id}),e.forEach(n,function(t){t.username=t.email,(t.firstName||t.lastName)&&(t.username=e.trim([t.firstName,t.lastName].join(" ")))}),l("projectMembersReady",n);var a=u.getRoles(n);l("projectRolesReady",a)})},getRoles:function(t){var i={},n=[];return e.each(t,function(e){var t=e.role;i.hasOwnProperty(t.id)||(i[t.id]=!0,n.push(t))}),n}})}),define("tau/models/userList/extension.model.assignmentsUser.Excluder",["Underscore","tau/core/model-base"],function(e,t){return t.extend({"bus registerStoreRequest":function(){var e=this.config.context.entity||{entityType:{}},t={role:["id","name"]},i={generalUser:["id","firstName","lastName"]};this.fire("get",{type:e.entityType.name,query:{id:e.id,fields:[{assignments:["id",t,i],list:!0}]},callback:{scope:this,success:this.onEntityRetrieved}})},"bus assignmentsUserExluder":function(e){var t=this.config.data||{},i=e.data.data,n=[],a=t.roleId||(t.role||{}).id;if(a)for(var r=i.assignments||[],s=0;s<r.length;s++)r[s].role.id==a&&n.push(r[s].generalUser);
this.fire("excludedUserReady",n)},onEntityRetrieved:function(e){this.fire("assignmentsUserExluder",e)}})}),define("tau/components/extensions/userList/extension.userList.editable",["Underscore","jQuery","tau/core/extension.base.stateful","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(e,t,i){return i.extend({category:"edit",name:"user list","bus initialize + afterRender":function(t,i,n){var a=n.element;a.delegate(".unassign-button","click",e.bind(this.onUnassignClick,this)),a.delegate(".assign-to-me-button","click",e.bind(this.onAssignToMeClick,this)),a.delegate(".user-search-box","keyup",e.bind(this.onFilterChanged,this)),a.delegate(".user","click",e.bind(this.onUserClick,this)),a.delegate(".more-link","click",e.bind(this.onMoreClick,this))},"bus afterRender":function(e,t){var i=t.element,n=i.find("[role=list]");n.listSelectable({items:".user",className:"user_hover",keyboardManager:this.config.context.configurator.getKeyBoardManager()}),this.fire("$listSelectable.ready",n)},"bus $listSelectable.ready:last+focus":function(e,t){t.data("ui-listSelectable")&&t.listSelectable("enable")},"bus afterRender:last+focus":function(e,t){var i=t.element;i.is(":visible")&&i.find(".user-search-box").focus()},"bus $listSelectable.ready:last+blur":function(e,t){t.is(":visible")&&t.data("ui-listSelectable")&&t.listSelectable("disable")},onMoreClick:function(e){e.stopPropagation(),this.fire("showMore")},onUserClick:function(e){var i=t(e.target),n=i.tmplItem().data;this.fire("changeAssignment",{user:n})},onUnassignClick:function(){this.fire("removeAssignment")},onAssignToMeClick:function(){this.fire("assignToLoggedUser")},onFilterChanged:function(e){e.keyCode!=t.ui.keyCode.DOWN&&e.keyCode!=t.ui.keyCode.UP&&e.keyCode!=t.ui.keyCode.ENTER&&(e.preventDefault(),this.fire("setFilter",{filter:t(e.target).val()}))}})}),define("tau/ui/templates/filteredUserList/ui.template.filteredUserList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user"],function(e){var t={name:"user-list",markup:'<div class="role-title" role="user-group">${role.name}</div>{{tmpl(users) "user"}}',dependencies:["user"]};
return e.register(t)}),define("tau/ui/templates/common/ui.template.linkAction",["tau/core/templates-factory"],function(e){var t={name:"link-action",markup:['<a class="${id}-link user-action" >',"   ${title}","</a>"].join("")};return e.register(t)}),define("tau/ui/templates/filteredUserList/ui.template.filteredUserList",["tau/core/templates-factory","tau/ui/templates/filteredUserList/ui.template.filteredUserList.userList","tau/ui/templates/common/ui.template.buttonAction","tau/ui/templates/common/ui.template.linkAction"],function(e){var t={name:"filtered-user-list",markup:['<div class="filtered-user-list">','<div class="header-box">{{tmpl(headerActions) "button-action"}}</div>','<div class="search-box-container">','<input type="text" class="user-search-box" />','<div class="help">For filter start typing name</div>',"</div>",'<div role="list" class="user-list i-user-list">','<div class="i-inner">{{tmpl(groups) "user-list"}}</div>',"</div>",'<div class="footer-box">','<a class="more-link {{if moreAvailable == false}}link-hidden{{/if}}">more&hellip;</a>',"</div>","</div>"],dependencies:["user-list","button-action","link-action"]};return e.register(t)}),define("tau/components/component.userList",["Underscore","tau/components/component.creator","tau/models/model.userList","tau/models/assignmentsList/extension.model.store.operations","tau/models/extensions/team/extension.model.teamOfEntityRetriever","tau/models/userList/extension.model.assignmentsUser.Excluder","tau/components/extensions/userList/extension.userList.editable","tau/ui/extensions/bubble/ui.extension.bubble.listResizer","tau/ui/templates/filteredUserList/ui.template.filteredUserList"],function(e,t,i,n,a,r,s,o,l){return{create:function(u){var c=[];e.isArray(u.extensions)&&(c=e.clone(u.extensions));var d={extensions:c,template:l};return c.push(i),c.push(s),c.push(n),c.push(u.Retriever||a),c.push(u.UserExcluder||r),c.push(o),t.create(d,u)}}}),define("tau/components/component.video-intro.popup",["jQuery","Underscore","tau/components/component.factory"],function(e,t,i){return new(i.extend({getCreatorConfig:function(){return{template:{engine:"jqote2",name:"video-intro.popup",markup:["<div>",'<iframe width="853" height="480" src="<%= this.url %>?rel=0" frameborder="0" allowfullscreen=""></iframe>',"<% if (this.showNextButton) { %>",'<p class="tau-help-video-header">We recommend to watch this quick intro video before the experiments.</p>','<p class="tau-help-continue"><button class="i-role-next tau-btn tau-primary">Thanks for the video! Continue to Targetprocess 3</button></p>',"<%} else {%>",'<p class="tau-help-video-header">Please contact your admin if you want to try Targetprocess 3.</p>',"<% } %>","</div>"]}}
},create:function(i){i=t.defaults(i,{render:e.Deferred(),destroy:e.Deferred()});var n=this._super(i);return n.on("destroy",function(){i.destroy.resolve()}),n.on("afterRender",function(t,a){var r=a.element,s=e("<div></div>");s.tauPopup({hideOnEscape:!1,enableClose:!1,className:"tau-help-video-intro",destroy:function(){n.fire("destroy")}}),s.tauPopup("show"),s.tauPopup("widget").append(r),r.on("click",".i-role-next",function(){s.tauPopup("destroy")}),i.render.resolve(r)}),n.initialize(),n.fire("dataBind",i),n}}))}),define("tp/reports/plot",["jQuery","libs/d3/d3","app.path"],function(e,t){function i(e){this.height=e.height||600,this.margin=e.margin||30,this.mode=e.mode||"simple",this.detalization=e.detalization||"full",this.charts=e.charts||[],this.captions=e.captions||[],this.legend='<div class="legend-wrapper">\n    <div class="legend-element"><p><i class="img img-actual-progress" />Actual progress</p></div>\n    <div class="legend-element"><p><i class="img img-ideal-line" />Ideal line</p></div>\n    <div class="legend-element"><p><i class="img img-forecast" />Forecast</p></div>\n</div>'}return i.prototype={_initialize:function(e){this.xAxis=e.getXAxis(),this.yAxis=e.getYAxis(),this.yCellSize=this._getYCellSize(this.yAxis.count),this.xCellSize=this._getXCellSize(this.placeholder.width(),this.xAxis.count,this.yCellSize),this.width=this.xAxis.count*this.xCellSize+2*this.margin,this.x=t.scale.linear().domain([0,this.xAxis.max]).range([0+this.margin+5,this.width-this.margin]),this.y=t.scale.linear().domain([0,this.yAxis.max]).range([this.height-this.margin-35,0+this.margin])},_getYCellSize:function(e){return(this.height-this.margin)/e},_getXCellSize:function(e,t,i){var n=i,a=t*n+2*this.margin;return a>e&&(n=e>.75*a?(e-2*this.margin)/t:.75*i),n},render:function(e){return this._initialize(e),this.placeholder.html(""),0==this.xAxis.count||null==e.filter?void this.placeholder.html('<div class="_empty empty">\n    <div class="empty-text">\n        <div class="first-line">Not enough data to build this beautiful chart</div>\n        <div class="second-line">Add Release or Iteration and complete some user stories</div>\n    </div>\n</div>').find(".empty").height(this.height).width(1e3):(this._renderPlot(e),this._renderCaptions(e),this._renderCharts(e),void this.placeholder.append(this.legend))
},_renderPlot:function(e){this._createPlot(),this._renderAxes(),this._renderGrid(),this._renderLabels(e)},_renderAxes:function(){var e=this.createGroup("axes");e.append("line").attr("class","yAxis").attr("y1",this.y(this.yAxis.values[0])).attr("x1",this.x(this.xAxis.values[0])).attr("y2",this.y(this.yAxis.max)).attr("x2",this.x(this.xAxis.values[0])),e.append("line").attr("class","xAxis").attr("x1",this.x(this.xAxis.values[0])).attr("y1",this.y(this.xAxis.values[0])).attr("x2",this.x(this.xAxis.max)).attr("y2",this.y(this.yAxis.values[0]))},_renderGrid:function(){var e=this.createGroup("grid");e.selectAll(".yLine").data(this.y.ticks(this.yAxis.count+1)).enter().append("line").attr("class","yLine").attr("y1",this.y).attr("x1",this.x(this.xAxis.values[0])).attr("y2",this.y).attr("x2",this.x(this.xAxis.max)),e.selectAll(".xLine").data(this.x.ticks(this.xAxis.count)).enter().append("line").attr("class","xLine").attr("x1",this.x).attr("y1",this.y(this.yAxis.values[0])).attr("x2",this.x).attr("y2",this.y(this.yAxis.max))},_renderLabels:function(){var e=this.createGroup("labels"),t=this;e.selectAll(".xLabel").data(this.x.ticks(this.xAxis.count)).enter().append("text").attr("class","xLabel").attr("x",t.x).attr("y",this.y(0)+.9*this.margin).text(this.xAxis.xLabel).call(this.xAxis.transform({x:t.x,y:t.y})),e.selectAll(".yLabel").data(this.y.ticks(this.yAxis.count+1)).enter().append("text").attr("class","yLabel").text(this.yAxis.label).attr("x",this.margin-10).attr("y",this.y).attr("dy",4)},_createPlot:function(){this.placeholder.width(t.max([this.width,this.optimalWidth])),this.caption=t.select(this.placeholder[0]).append("div").attr("id","report-caption").attr("class","caption").style("width",t.max([this.width,this.optimalWidth/3])+"px"),this.plot=t.select(this.placeholder[0]).append("div").attr("class","report-caption__wrap").style({height:this.height+"px"}).append("svg").attr("width",this.width).attr("height",this.height)},createGroup:function(e){return this.plot.append("g").attr("class","_"+e)
},getLastBurnDownPoint:function(){return e(this.plot.selectAll("line.lineChart")[0]).last()[0]},_renderCaptions:function(e){for(var t=0;t<this.captions.length;t++)this.captions[t].render(this,e)},_renderCharts:function(e){for(var t=0;t<this.charts.length;t++)this.charts[t].render(this,e)}},i}),define("tp/reports/burndown/summaryPopup",["jQuery","app.path","tau/utils/utils.date","libs/jquery/jquery.tmpl"],function(e,t){return e.widget("ui.summaryPopup",{options:{index:0,data:[],show:e.noop,hide:e.noop,navigate:e.noop},_template:'<div class="chart-bubble">\n    <div class="date">${title}</div>\n    <div class="_details">\n        <table>\n            <tr class="{{if yesterday}}_collapsible collapse-block{{else}}noncollapse-block{{/if}}">\n                <td>\n                    <div class="indicator-small yesterday">${yesterday.toFixed(2).replace(".00", "")}${units}</div>\n                </td>\n                <td style="width: 100%;">\n                    <div class="_remained yesterday-text">{{if initial}}Initial&nbsp;Effort{{else}}Start-of-Day&nbsp;Time&nbsp;Remaining{{/if}}\n                    </div>\n                </td>\n            </tr>\n\n            <tr style="display: none;">\n                <td colspan="2" class="nopadding">\n                    <div class="inner-top-shadow"></div>\n                        <div class="inner">\n                            <table>\n                                {{each effort.remained}}\n                                <tr>\n                                    <td><span class="entity-indicator">${total}${units}</span></td>\n                                    <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                    <td class="name"><div class="name-overflow">\n                                    {{if isDeleted === true}}\n                                        <span data-type="${entityType}">${name}</span>\n                                    {{else}}\n                                        <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                    {{/if}}\n                                    \n                                    </div></td>\n                                </tr>\n                                {{/each}}\n                            </table>\n                        </div>\n                    <div class="inner-bottom-shadow"></div>\n                </td>\n            </tr>\n\n            {{if added}}\n            <tr  class="_collapsible collapse-block">\n                <td>\n                    <div class="indicator-small add">+&nbsp;${added.toFixed(2).replace(".00", "")}${units}</div>\n                </td>\n                <td style="width: 100%;">\n                    <div class="_added complete-text">Added</div>\n                </td>\n            </tr>\n            <tr style="display: none;">\n                <td colspan="2" class="nopadding">\n                    <div class="inner-top-shadow"></div>\n                        <div class="inner">\n                            <table>\n                                {{each effort.added}}\n                                <tr>\n                                    <td><span class="entity-indicator">${total}${units}</span></td>\n                                    <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                    <td class="name _parent"><div class="name-overflow">\n                                    {{if isDeleted === true}}\n                                        <span data-type="${entityType}">${name}</span>\n                                    {{else}}\n                                        <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                    {{/if}}\n                                    </div></td>\n                                </tr>\n\n                                {{if showChildren}}\n                                <tr><td colspan="3"><table>\n                                    {{each children}}\n                                    <tr class="inner-task">\n                                        <td class="task-time"><span class="entity-indicator">${effort}{{if entityType == \'Task\'}}h{{else}}${units}{{/if}}</span></td>\n                                        <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                        <td class="name font-11"><div class="name-overflow">\n                                        {{if isDeleted === true}}\n                                            <span data-type="${entityType}">${name}</span>\n                                        {{else}}\n                                            <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                        {{/if}}\n                                        </div></td>\n                                    </tr>\n                                    {{/each}}\n                                </table></td></tr>\n                                {{/if}}\n                                {{/each}}\n                            </table>\n                        </div>\n                    <div class="inner-bottom-shadow"></div>\n                </td>\n            </tr>\n            {{/if}}\n\n            {{if removed}}\n\n            <tr class="_collapsible collapse-block">\n                <td>\n                    <div class="indicator-small remove" style="white-space:nowrap;">-&nbsp;${removed.toFixed(2).replace(".00", "")}${units}</div>\n                </td>\n                <td style="width: 100%;">\n                    <div class="_removed complete-text">Removed</div>\n                </td>\n            </tr>\n            <tr style="display: none;">\n                <td colspan="2" class="nopadding">\n                    <div class="inner-top-shadow"></div>\n                        <div class="inner">\n                            <table>\n                                {{each effort.removed}}\n                                <tr>\n                                    <td><span class="entity-indicator">${total}${units}</span></td>\n                                    <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                    <td class="name _parent"><div class="name-overflow">\n                                    {{if isDeleted === true}}\n                                        <span data-type="${entityType}">${name}</span>\n                                    {{else}}    \n                                        <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                    {{/if}}\n                                    </div></td>\n                                </tr>\n                                {{if showChildren}}\n                                <tr><td colspan="3"><table>\n                                    {{each children}}\n                                    <tr class="inner-task">\n                                        <td class="task-time"><span class="entity-indicator">${effort}{{if entityType == \'Task\'}}h{{else}}${units}{{/if}}</span></td>\n                                        <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                        <td class="name font-11"><div class="name-overflow">\n                                        {{if isDeleted === true}}\n                                            <span data-type="${entityType}">${name}</span>\n                                        {{else}}    \n                                            <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                        {{/if}}\n                                        </div></td>\n                                    </tr>\n                                    {{/each}}\n                                </table></td></tr>\n                                {{/if}}\n                                {{/each}}\n                            </table>\n                        </div>\n                    <div class="inner-bottom-shadow"></div>\n                </td>\n            </tr>\n            {{/if}}\n\n            {{if spent}}\n            <tr class="_collapsible collapse-block">\n                <td>\n                    <div class="indicator-small complete" style="white-space: nowrap;">-&nbsp;${spent.toFixed(2).replace(".00", "")}${units}</div>\n                </td>\n                <td style="width: 100%;">\n                    <div class="_spent complete-text">Completed</div>\n                </td>\n            </tr>\n            <tr style="display: none;">\n                <td colspan="2" class="nopadding">\n                    <div class="inner-top-shadow"></div>\n                        <div class="inner">\n                            <table>\n                                {{each effort.spent}}\n                                <tr>\n                                    <td><span class="entity-indicator">${total}${units}</span></td>\n                                    <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                    <td class="name _parent"><div class="name-overflow">\n                                    {{if isDeleted === true}}\n                                        <span data-type="${entityType}">${name}</span>\n                                    {{else}}    \n                                        <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                    {{/if}}\n                                    </div></td>\n                                </tr>\n                                {{if showChildren}}\n                                <tr><td colspan="3"><table>\n                                    {{each children}}\n                                    <tr class="inner-task">\n                                        <td class="task-time"><span class="entity-indicator">${effort}{{if entityType == \'Task\'}}h{{else}}${units}{{/if}}</span></td>\n                                        <td><i class="tau-entity-icon tau-entity-icon--${entityType.toLowerCase()}">${term}</i></td>\n                                        <td class="name font-11"><div class="name-overflow">\n                                        {{if isDeleted === true}}\n                                            <span data-type="${entityType}">${name}</span>\n                                        {{else}}    \n                                            <a href="${url}" title="${name}" data-id="${id}" data-type="${entityType}" class="_entity-ref">${name}</a>\n                                        {{/if}}\n                                        </div></td>\n                                    </tr>\n                                    {{/each}}\n                                </table></td></tr>\n                                {{/if}}\n                                {{/each}}\n                            </table>\n                        </div>\n                    <div class="inner-bottom-shadow"></div>\n                </td>\n            </tr>\n            {{/if}}\n    </div>\n    {{if remained}}\n\n    <tr>\n        <td>\n            <div class="remain{{if today}} today{{/if}}">${remained.toFixed(2).replace(".00", "")}${units}</div>\n        </td>\n        <td>\n            <div class="_remained remain-text{{if today}} today{{/if}}">End-of-Day Time Remaining</div>\n        </td>\n    </tr>\n    {{/if}}\n    \n    {{if forecast != null && today}}\n\n    <tr>\n         <td>\n            <div class="remain today">${forecast}</div>\n        </td>\n        <td>\n            <div class="_forecast remain-text today">Forecast End Date</div>\n        </td>\n    </tr>\n    {{/if}}\n    \n    </table>\n</div>\n',_create:function(){this.element.tauBubble({className:"tau-summaryPopup",alignTo:this.options.alignTo,onPositionConfig:function(e){e.my="left top"
},onArrowPositionConfig:function(e,t){"top"===t?e.my+="+1":"bottom"===t&&(e.my+="-1")},onBeforeShow:e.proxy(this._onBeforeShow,this),onHide:e.proxy(this._onHide,this),dontCloseSelectors:["div.close"]})},show:function(){this.element.tauBubble("show"),this.options.show()},popup:function(){return this.element.data("ui-tauBubble").$popup},_onHide:function(){this.options.hide()},_onBeforeShow:function(){var t=this._getTemplateData(this.options.data,this.options.index),i=e.tmpl(this._template,t),n=this;i.find("._details").accordion({header:"tr._collapsible",collapsible:!0,active:!1,icons:!1,autoHeight:!1,animated:!1,change:function(){n.element.tauBubble("adjustPosition")}});var a=this;i.on("click","._entity-ref",function(t){var i=e(this),n=i.data();t.preventDefault(),a.options.navigate({id:n.id,type:n.type})}),this.element.tauBubble("option","content",i).on("close",function(){var e=i.find("._details");e.data("ui-accordion")&&e.accordion("destroy"),i.off("click","._entity-ref")})},_getTemplateData:function(t,i){var n=this.options.termProcessor,a=this,r=function(t){return t.map(function(t){var i=t.children.filter(function(e){return e.effort}).map(function(e){return{id:e.id,name:e.name,effort:e.effort,url:a._getUrl(e.id,e.entityType),term:n.getTerms(e.entityType).iconSmall,isDeleted:e.isDeleted,entityType:e.entityType}}),r=e.grep(i,function(e){return"Bug"==e.entityType}),s=!1;return"None"==t.action?s=!0:r.length>0&&(s=!0,i=r),{id:t.id,name:t.name,total:t.total,action:t.action,url:a._getUrl(t.id,t.entityType),term:n.getTerms(t.entityType).iconSmall,isDeleted:t.isDeleted,entityType:t.entityType,showChildren:s,children:i}})};return{initial:0==i,yesterday:t.total.remained,title:t.title?t.title:t.date.startDate.toString("d MMMM, dddd"),date:t.date,remained:t.total.remained+t.total.added-t.total.spent-t.total.removed,spent:t.total.spent,added:t.total.added,removed:t.total.removed,today:t.today,units:t.units,forecast:null==t.forecast?null:t.forecast.toString("d MMM").replace(" ","&nbsp;"),effort:{remained:r(t.effort.remained),spent:r(t.effort.spent),added:r(t.effort.added),removed:r(t.effort.removed)}}
},_getUrl:function(e,i){var n="/View.aspx?ID="+e+"&Entity="+i;return new t.tp.WebServiceURL(new t.tp.AcidURL(n).toString()).toString()},destroy:function(){this.element.tauBubble("destroy")}}),e}),define("tp/reports/report",["jQuery","tp/reports/plot","tp/reports/burndown/summaryPopup"],function(e,t){var i=function(e){this._ctor(e)};return i.prototype={template:'<div class="burnDownReport _burnDownReport">\n    <span class="tableTitle">Burn Down</span>\n    <div>\n        <div id="report-filter">\n        </div>\n    </div>\n    <div id="report-chart" class="tau-chart-plot">    \n    </div>\n</div>',_ctor:function(i){this.filter=i.filter,this.name=i.name,this.placeholder=e(i.placeholder),this.dataProvider=i.dataProvider,this.plot=new t({charts:i.charts,captions:i.captions,height:i.height,margin:50}),this.contextProvider=i.contextProvider,this.navigator=i.navigator,e(i.charts).on("click",e.proxy(this._chartClick,this))},render:function(){this.contextProvider.onReady(e.proxy(function(){this.placeholder.html(e.tmpl(this.template,{name:this.name})),e(this).trigger("afterInit"),this.plot.placeholder=this.placeholder.find("#report-chart"),this.plot.optimalWidth=.85*e(window).width(),this.filter.initialize({placeholder:this.placeholder.find("#report-filter"),update:e.proxy(this._renderChart,this),dataProvider:this.dataProvider,contextProvider:this.contextProvider})},this))},_renderChart:function(){this._showLoader(),this.dataProvider.initialize(this.filter.getData(),e.proxy(function(){this.placeholder.find("#report-chart").removeClass("loader"),this.plot.render(this.dataProvider),e(this).trigger("afterRender")},this))},_showLoader:function(){this.placeholder.find("#report-chart").addClass("loader")},_chartClick:function(t,i){if(i.data.effort){var n=i.$rect;if(n.data("summaryPopup")&&n.summaryPopup("popup").is(":visible"))return void i.origin.stopPropagation();var a=this,r=this.contextProvider.getTermProcessorForCurrentProject(),s=this.navigator;this.dataProvider.getDetails(i.data,function(o){n.summaryPopup({alignTo:i.$pointer,termProcessor:r,index:i.index,data:o,show:function(){t.target.fadeOut(i.rect)
},hide:function(){t.target.fadeIn(i.rect)},navigate:function(e){s.navigate(e)}}).summaryPopup("show"),e(a).trigger("details.afterRender",[n.summaryPopup("popup")])})}}},i}),define("tp/reports/dataRepository",["tp/gateway","app.path"],function(e,t){function i(t){this.url=t.url,this.gateway=e}return i.prototype={get:function(e,t,i,n){this.gateway.postJSON(this._getUrl(this.url),e,t,i,n)},getDetails:function(e,t){this.gateway.postJSON(this._getDetailsUrl(this.url),e,t)},getPlannable:function(e,t,i){this.gateway.postJSON(this._getUrl(this.url+"/plannableProperties"),e,t,i)},_getDetailsUrl:function(e){return this._getUrl(e+"/details")},_getUrl:function(e){return new t.tp.WebServiceURL(e).url}},i}),define("tp/reports/burndown/dataProvider",["libs/d3/d3","tau/utils/utils.date","tp/reports/dataRepository","jQuery"],function(e,t,i,n){function a(){this.dataRepository=new i({url:"/reports/v1/burnDown"})}return a.prototype={yAxisPointsCount:10,yRoundTo:10,data:[],initialize:function(i,n){var a=this;a.filter=i,i?this.dataRepository.get(i,function(r){a.forecast=r.forecastFinishDate,a.forecastDay=r.forecastDay,a.iterationEndDay=r.iterationEndDay,a.isTitlesProvided=r.isTitlesProvided,a.velocity=r.velocity,a.manuallySetVelocity=r.manuallySetVelocity,a.decimalSeparator=r.decimalSeparator,a.isPlannableFinished=r.isPlannableFinished,a.d3=e,a.data=[];for(var s=r.effort,o=0;o<s.length;o++){var l=s[o],u=s[o+1],c={date:{startDate:t.convertToTimezone(l.date.startDate),endDate:t.convertToTimezone(l.date.endDate)},total:a._getTotal(l,u),effort:l.effort,units:i.units,forecast:null!=a.forecast?t.convertToTimezone(a.forecast):null};a.data.push(c)}a.data.length&&a._adjustLastDay(),n()}):n()},_getTotal:function(t,i){var n=null;return t.effort&&(n={remained:e.sum(t.effort,function(e){return e.remained}),spent:e.sum(t.effort,function(e){return e.spent}),added:e.sum(t.effort,function(e){return e.added}),removed:e.sum(t.effort,function(e){return Math.abs(e.removed)})},n.remainedForNextDay=i&&i.effort?e.sum(i.effort,function(e){return e.remained
}):n.remained+n.added-n.spent-n.removed),n},_adjustLastDay:function(){for(var e=this.data.length-2;e>0;e--){var i=this.data[e],n=this.data[e-1];if(null==i.total&&null!=n.total&&!t.between(t.getNow(),n.date.startDate,n.date.endDate))return void(n.last=!0)}},getPlannable:function(e,t){this.dataRepository.getPlannable(e,t,n.proxy(function(e){n(this).trigger("data-error",JSON.parse(e.responseText))},this))},getDetails:function(t,i){var a=function(t,i,n){var a=t.filter(function(e){return e.item.parentId==i.id});i.children=a.map(function(e){var t=e.item;return{id:t.id,name:t.name,effort:n(e),isDeleted:t.isDeleted,entityType:t.entityType}});var r=t.filter(function(e){return e.item.id==i.id})[0];return i.total=e.sum(i.children.map(function(e){return e.effort}))+(r?n(r):0),i},r={date:t.date,remained:this._getParentIds(t,function(e){return e.remained}),added:this._getParentIds(t,function(e){return e.added}),removed:this._getParentIds(t,function(e){return e.removed}),spent:this._getParentIds(t,function(e){return e.spent})};this.dataRepository.getDetails(r,n.proxy(function(e){var n={date:t.date,effort:{remained:e.remained.map(function(e){return a(t.effort,e,function(e){return e.remained})}),added:e.added.map(function(e){return a(t.effort,e,function(e){return e.added})}),removed:e.removed.map(function(e){return a(t.effort,e,function(e){return e.removed})}),spent:e.spent.map(function(e){return a(t.effort,e,function(e){return e.spent})})},total:t.total,units:t.units,forecast:t.forecast,today:e.today};i(n)},this))},_getParentIds:function(e,t){for(var i=e.effort.filter(function(e){return t(e)}).map(function(e){var t=e.item.parentId;return null!=t&&t>0?t:e.item.id}),a=[],r=0;r<i.length;r++){var s=i[r];0==n.grep(a,function(e){return e==s}).length&&a.push(s)}return a},getIdealLineStartValue:function(){var e=this.data[0],t=0;return this.data.length?(e&&e.total&&(t=e.total.remained),this.data.filter(function(e){return"undefined"!=typeof e.total&&null!=e.total}).reduce(function(e,t){return e+t.total.added-t.total.removed
},t)):t},_getYUpperBound:function(){var t=this.data.filter(function(e){return e.total});if(0==t.length)return 10;var i=Math.max(e.max(t,function(e){return e.total.remained+e.total.added-e.total.removed-e.total.spent}),this.getIdealLineStartValue())||10,n=Math.floor(Math.log(i)/Math.log(this.yRoundTo));n>1&&n--;var n=Math.pow(this.yRoundTo,n),a=Math.ceil(i/n)*n;return a},_getYAxisValues:function(){var t=this._getYUpperBound(),i=this;return e.range(this.yAxisPointsCount+1).map(function(e){return t/i.yAxisPointsCount*e})},getYAxis:function(){return{label:function(e){return e},values:this._getYAxisValues(),count:this.yAxisPointsCount,max:this._getYUpperBound()}},_getXAxisValuesCount:function(){return this.data.length},getXAxis:function(){function t(e){return e.toString("d MMM")}function i(i){switch(i){case"release":return{xLabel:function(e,i){return a.data[i]?"[Week "+(i+1)+"] "+t(a.data[i].date.startDate)+" - "+t(a.data[i].date.endDate):void 0},transform:function(){return function(){this.attr("transform",function(){var t=e.select(this).attr("x"),i=e.select(this).attr("y");return"rotate(325 "+t+","+i+")"})}}};default:return{xLabel:function(e,i){return a.data[i]?t(a.data[i].date.startDate):void 0},transform:function(e){return function(){this.attr("dx",(e.x(1)-e.x(0))/2)}}}}}var a=this,r=Math.max(0,this._getXAxisValuesCount());return n.extend(a.filter?i(a.filter.burnDownType):{},{count:r,max:r,values:e.range(r)})},getXValue:function(e){return this.data.indexOf(e)},getYValue:function(e){return e.total?e.total.remained:null}},a}),define("tp/dropdown",["jQuery"],function(e){return e.widget("ui.dropDown",{options:{value:null,quickData:[],data:[],select:e.noopF},_template:'<div class="_dropDown">\n    <div class="_items">\n        {{each groups}}\n        <div data-id="${id}" class="parents">${name}</div>\n        <ul>\n            {{each items}}\n            <li data-id="${id}" class="_item">${name}</li>\n            {{/each}}\n        </ul>\n        {{/each}}\n    </div>\n    {{if hasMore && showMore}}\n    <div class="more">\n        <a href="#" class="_more">more&hellip;</a>\n    </div>\n    {{/if}}\n</div>',_create:function(){this.element.after('<span class="add-on _opener"></span>'),this._opener=this.element.next(),this.element.tauBubble({className:"tau-summaryPopup iteration-bubble",onPositionConfig:function(e){e.my="left top"
},onBeforeShow:e.proxy(this._onBeforeShow,this)}),this.element.next().click(e.proxy(function(e){e.stopPropagation(),this.element.click()},this)),this._setValue(this._getDataItem(this.options.value)),this.options.data&&this.options.data.length||this.options.quickData&&this.options.quickData.length||(this.element.addClass("caret-disabled"),this._opener.addClass("caret-disabled")),this.key="dropDown"+(new Date).getTime()},_getData:function(e){return{groups:e,hasMore:e!=this.options.data,showMore:this.options.data&&this.options.data.length>0}},_onItemClick:function(){var t=this;return function(){t.element.data("id",e(this).data("id")),t.element.text(e(this).text()),t.element.tauBubble("hide"),t._setValue(t._getSelectedItem()),t.options.select()}},_onMoreClick:function(){var e=this;return function(t){t.preventDefault(),t.stopPropagation();var i=e.element.data("ui-tauBubble").$popup;i.find("._item").unbind(),i.find("._more").unbind(),e.element.tauBubble("option","content",e._getContent(e.options.data)),i.find("._item").click(e._onItemClick())}},_getContent:function(t){return e.tmpl(this._template,this._getData(t))},_getSelectedItem:function(){var e=this.element.data("id");return this._getItem(e)},_getQuickDataItem:function(e){return this.options.quickData.length?this._getItemFromDataSource(this.options.quickData,e):this._getItem(e)},_getDataItem:function(e){var t=this._getQuickDataItem(e);return"undefined"==typeof t?this._getItemFromDataSource(this.options.data,e):t},_getItem:function(e){return this._getItemFromDataSource(this.options.data,e)},_getItemFromDataSource:function(t,i){var n=e.map(t,function(t){return e.grep(t.items,function(e){return e.id==i})});return n?n[0]:null},option:function(e,t){return"undefined"==typeof t?this.options[e]:("data"==e&&this._disable(!t||!t.length),"value"==e&&this._setValue(this._getQuickDataItem(t)),void(this.options[e]=t))},_disable:function(e){e=!!e,this.element.toggleClass("caret-disabled",e),this._opener.toggleClass("caret-disabled",e),this.options.disabled=e
},_onBeforeShow:function(){if(this.element.is(".caret-disabled"))return!1;var e=this.options.quickData.length?this.options.quickData:this.options.data;if(e.length){var t=this._getContent(e);this.element.tauBubble("option","content",t),t.find("._item").click(this._onItemClick()),t.find("._more").click(this._onMoreClick())}},value:function(e){return"undefined"!=typeof e?(this._setValue(this._getItem(e)),void this.options.select()):this.options.disabled?"":this.element.data("id")||""},values:function(){var t=[];return e.merge(t,this.options.data),e.merge(t,this.options.quickData),e.map(t,function(e){return e.id})},_setValue:function(e){e&&(this.element.data("id",e.id),this.element.text(e.name))},destroy:function(){this.element.next().remove(),this.bubble&&(this.bubble.bubblePopup("content").find("._item").unbind(),this.bubble.bubblePopup("content").find("._more").unbind(),this.bubble.bubblePopup("destroy"))}}),e}),define("tp/reports/burndown/burnDownTypeProvider",["jQuery","app.path","tp/reports/burndown/dataProvider","tau/core/tau","tp/dropdown"],function(e,t,i,n){function a(){this.dataProvider=new i,this.typeDictionary={iteration:"iteration",release:"release",teamiteration:"teamiteration"}}return a.prototype={initialize:function(e){this.queryStringPlannableId=parseInt(n.getQueryValueFromUrl(location.href.toLowerCase(),"entityid")),this.queryStringBurnDownType=n.getQueryValueFromUrl(location.href.toLowerCase(),"burndowntype"),this.placeholder=e.placeholder,this.contextProvider=e.contextProvider,this.filterProvider=e.filterProvider,this.updatePlannable=e.updatePlannable,this.savedFilter=e.savedFilter?e.savedFilter:{plannableId:-1,burnDownType:this._getDefaultType()},isNaN(this.queryStringPlannableId)||"teamiteration"!=this.queryStringBurnDownType&&"release"!=this.queryStringBurnDownType&&"iteration"!=this.queryStringBurnDownType||(this.savedFilter.plannableId=this.queryStringPlannableId,this.savedFilter.burnDownType=this.typeDictionary[this.queryStringBurnDownType])},_getPlannableFromQueryString:function(){var e=null;
if(!isNaN(this.queryStringPlannableId)){var t=this;e=this.filterProvider.allIterations.filter(function(e){return e.id==t.queryStringPlannableId})[0]}return e},_getSavedPlannable:function(){var t=this._getPlannables(),i=this,n=e.grep(t,function(e){return e.id==i.savedFilter.plannableId});return n.length?n[0]:null},_getDefaultPlannable:function(){var t=this._getPlannables(),i=this.filterProvider._getDefaultIteration();if(!i){var n=e.grep(t,function(e){return e.current});n.length&&(i=n[0])}return i},render:function(){function t(){return n.savedFilter.burnDownType.toLowerCase()==this.toLowerCase()}var i=[{id:"",name:"",items:[]}];(this._isIterationsAvailable()||"iteration"==this.queryStringBurnDownType)&&i[0].items.push({id:"iteration",name:this.contextProvider.getIterationTerm()}),i[0].items.push({id:"release",name:this.contextProvider.getReleaseTerm()}),this._areTeamIterationsAvailable()&&i[0].items.push({id:"teamiteration",name:"Team Iteration"});var n=this,a=e.proxy(function(){var e=this._getSavedPlannable()||this._getDefaultPlannable();return e?e.id:0},n),r=e.proxy(function(){return this.filterProvider.getIterationsDropDownDataSource(this._getPlannables())},n),s=e.proxy(function(){return this.filterProvider.getIterationsDropDownDataSource(this._getCurrentPlannables())},n),o=e.proxy(function(){var e=n.filterProvider._getSelectedPlannable()||n._getPlannableFromQueryString()||this._getSavedPlannable()||this._getDefaultPlannable();e&&e.entityType.toLowerCase()==n.getType().toLowerCase()&&(n.contextProvider.setCurrentProject(e.parent.id),n.filterProvider.setStartDate(e.startDate),n.filterProvider.processFilterOptionsVisibility(e)),n.filterProvider.update()},n),l=e.proxy(function(){n.iterationsDropDown||(n.iterationsDropDown=n.placeholder.find("._selectedIteration").dropDown({value:a(),quickData:s(),data:r(),select:o})),o()},n),u=e.proxy(function(){n.iterationsDropDown.dropDown("option","data",r()),n.iterationsDropDown.dropDown("option","quickData",s()),n.iterationsDropDown.dropDown("option","value",a()),o()
},n),c=n._getDefaultType();n.savedFilter&&n.savedFilter.burnDownType&&e(n._getPossibleTypes()).filter(t).length>0&&(c=n.savedFilter.burnDownType),this.burnDownTypeDropDown=this.placeholder.find("._burnDownType").dropDown({value:c,quickData:i,data:[],select:function(){var e=n.burnDownTypeDropDown.dropDown("value");n.updatePlannable(e,u)}}),l()},getPlannableId:function(){return this.iterationsDropDown.dropDown("value")},getType:function(){return this.burnDownTypeDropDown?this.burnDownTypeDropDown.dropDown("value"):this.savedFilter&&this.savedFilter.burnDownType?this.savedFilter.burnDownType:this._getDefaultType()},_getPlannables:function(){return this._filterPlannables(this.filterProvider.allIterations)},_getCurrentPlannables:function(){return this._filterPlannables(this.filterProvider.allCurrentIterations)},_filterPlannables:function(e){var t=this.getType();return e.filter(function(e){return e.entityType.toLowerCase()==t.toLowerCase()})},_getDefaultType:function(){return this._getPossibleTypes()[0]},_getPossibleTypes:function(){function t(e){return function(t,i){return i.entityType.toLowerCase()==e.toLowerCase()}}var i=this,n=[];return this._isIterationsAvailable()&&n.push("iteration"),n.push("release"),this._areTeamIterationsAvailable()&&n.push("teamiteration"),e(n).filter(function(n,a){return e(i.filterProvider.allIterations).filter(t(a)).length>0})},_isIterationsAvailable:function(){return this.contextProvider.isPracticeAvailable("Iterations")},_areTeamIterationsAvailable:function(){return this.contextProvider.getTeamIds().length>0}},a}),define("tp/reports/filterProvider",["jQuery","Underscore","app.path","tau/utils/utils.date","tp/reports/burndown/filterStorage","tp/reports/burndown/burnDownTypeProvider","tp/dropdown"],function(e,t,i,n,a,r){function s(e){e=e||{},this.currentIterations=[],this.storage=e.storage?e.storage:new a({groupName:"burnDownVer2Filter"}),this.burnDownTypeProvider=new r}return s.prototype={initialize:function(t){this.dataProvider=t.dataProvider,this.placeholder=t.placeholder,this.template=t.template,this.contextProvider=t.contextProvider,this.plannablesRetrieved=!1;
var i=this;this.update=function(){i._saveFilter(),t.update()},this._getSavedFilter(function(n){i.savedFilter=n,i.burnDownTypeProvider.initialize({placeholder:t.placeholder,contextProvider:t.contextProvider,updatePlannable:e.proxy(this._drawChart,this),savedFilter:i.savedFilter,filterProvider:this});var a=i.burnDownTypeProvider.getType();i._drawChart(a,e.proxy(i._render,i))})},_drawChart:function(t,i){this.plannableRetrieve=e.proxy(this.dataProvider.getPlannable,this.dataProvider),this._getIterations(i)},_getIterations:function(t){if(this.plannablesRetrieved)return this.iterations=this._getForType(this.allIterations),this.currentIterations=this._getForType(this.allCurrentIterations),void t();var i=this;this._retrieveIterations(this.contextProvider.getProjectIds(),this.contextProvider.getTeamIds(),function(a){var r=n.getServerNow();i.allIterations=e.map(a,function(e){var t=n.convertToTimezone(e.startDate),i=n.convertToTimezone(e.endDate);return{startDate:t,endDate:i,id:e.id,name:e.name,entityType:e.entityType,current:n.between(r,t,i),isBugsAvailable:e.isBugsAvailable,isPointsAvailable:e.isPointsAvailable,isTimeTrackingAvailable:e.isTimeTrackingAvailable,parent:{id:e.parentId,name:e.parentName}}}),i.allCurrentIterations=i.allIterations.filter(function(e){return e.current}),i.iterations=i._getForType(i.allIterations),i.currentIterations=i._getForType(i.allCurrentIterations),i.plannablesRetrieved=!0,t()})},_getForType:function(e){var t=this.burnDownTypeProvider.getType();return e.filter(function(e){return e.entityType.toLowerCase()==t.toLowerCase()})},_retrieveIterations:function(e,t,i){this.plannableRetrieve({projectIds:e,teamIds:t},i)},_render:function(){var t=this.contextProvider.getBugsTerm();this.template=this.template.replace("{1}",t),this.placeholder.html(this.template),0==this.allIterations.length&&this.placeholder.hide(),e.datepicker.parseDate=function(e,t){return n.parse(t)},e.datepicker.formatDate=function(e,t){return n.formatAs(t,e)},this.placeholder.find("._startDate").datepicker({buttonImageOnly:!1,showOn:"both",buttonText:"Choose",onSelect:this.update,dateFormat:"MM/dd/yyyy"}),this.placeholder.find("._weekends").click(this.update),this._pointsButton().click(e.proxy(this._onUnitsClick,this)),this._hoursButton().click(e.proxy(this._onUnitsClick,this)),this.placeholder.find("._include-bugs").click(this.update);
var i=this._getDefaultIteration();"undefined"!=typeof i&&this.processFilterOptionsVisibility(i);var a=this,r=function(e){a.burnDownTypeProvider.render(e)};this._applySavedFilter(r),e(this).trigger("afterRender")},_saveFilter:function(){var e=this._getFilterData();if(null!=e){if(""==e.burnDownType)return;this._bugsSection().is(":visible")||delete e.showBugs,this._unitsSection().is(":visible")||delete e.isInPoints}this.storage.savePlannableFilter(e)},_getSavedFilter:function(t){this.storage.findPlannableFilter(e.proxy(t,this))},_applySavedFilter:function(e){null!=this.savedFilter&&(this._bugsSection().is(":visible")&&this._setShowBugs(this.savedFilter.showBugs),this._unitsSection().is(":visible")&&this._selectUnit(this.savedFilter.isInPoints),this._setIncludeWeekends(this.savedFilter.includeWeekends)),e(this.savedFilter)},_onUnitsClick:function(t){var i=e(t.currentTarget).text()==this._pointsButton().text();this._selectUnit(i);var n=this._getSelectedPlannable();n&&this._showBugs(n)?this._bugsSection().removeClass("invisible"):this._bugsSection().addClass("invisible"),this.update()},_selectUnit:function(e){e?(this._pointsButton().addClass("selected"),this._hoursButton().removeClass("selected")):(this._pointsButton().removeClass("selected"),this._hoursButton().addClass("selected"))},_showBugs:function(e){return e.isBugsAvailable&&!(e.isPointsAvailable&&!e.isTimeTrackingAvailable&&this._hoursButton().hasClass("selected")&&this._unitsSection().is(":visible"))},processFilterOptionsVisibility:function(e){var t=this._unitsSection(),i=this._bugsSection();e.isPointsAvailable?t.show():t.hide(),this._showBugs(e)?i.removeClass("invisible"):i.addClass("invisible")},_getDefaultIteration:function(){var e=this.iterations[0];return this.currentIterations.length&&(e=this.currentIterations.map(function(e){return e})[0]),e},getIterationsDropDownDataSource:function(t){for(var i=e.map(t,function(e){return e.parent}),n=[],a=0;a<i.length;a++){var r=i[a];0==e.grep(n,function(e){return e.id==r.id
}).length&&n.push({id:r.id,name:r.name})}for(var a=0;a<n.length;a++)n[a].items=e.grep(t,function(e){return e.parent.id==n[a].id}).map(function(e){return{id:e.id,name:e.current?e.name+" (current)":e.name}});return n.sort(function(e,t){return e.name==t.name?0:e.name.toLowerCase()<t.name.toLowerCase()?-1:1}),n},getManuallySetVelocity:function(){var e=this.placeholder.closest("._burnDownReport").find(".velocity-input");return e.length>0&&""!==e.val()?parseFloat(e.val()):0},_getUrl:function(e){return new i.tp.WebServiceURL(e).url},_getFilterData:function(){var e=this._getSelectedPlannable(),t=this._getStartDate();return e?{burnDownType:this.burnDownTypeProvider.getType(),plannableId:e.id,startDate:t?t:null,includeWeekends:this._getIncludeWeekends(),isInPoints:this.isInPoints(),showBugs:this.isShowBugs(),units:e.isPointsAvailable&&this.isInPoints()?"p":"h"}:null},_getPlannableId:function(){return this.burnDownTypeProvider.getPlannableId()},_getStartDate:function(){var e=this._getRawStartDate();return n.format.date.short(e)},_getRawStartDate:function(){var e=this.placeholder.find("._startDate").datepicker().datepicker("getDate");return e},setStartDate:function(e){this.placeholder.find("._startDate").datepicker("setDate",e)},_getIncludeWeekends:function(){return this._isChecked("_weekends")},_setIncludeWeekends:function(e){return this.placeholder.find("._weekends").attr("checked",e)},isInPoints:function(){return this._unitsSection().is(":visible")?this._pointsButton().hasClass("selected"):this._getSelectedPlannable().isPointsAvailable},isShowBugs:function(){return this._bugsSection().is(":visible")?this._isChecked("_include-bugs"):!1},_isChecked:function(e){return this.placeholder.find("."+e+":visible")&&"on"==this.placeholder.find("."+e+":checked").val()},_unitsSection:function(){return this.placeholder.find("._unitsOption")},_pointsButton:function(){return this.placeholder.find("._inPoints")},_hoursButton:function(){return this.placeholder.find("._inHours")},_bugsSection:function(){return this.placeholder.find("._bugsOption")
},_setShowBugs:function(e){this.placeholder.find("._include-bugs").attr("checked",e)},_getSelectedPlannable:function(){var t=this._getPlannableId(),i=e.grep(this.allIterations,function(e){return e.id==t});if(i.length>0){var n=i[0];return n.typeName=this.burnDownTypeProvider.getType(),n}return null}},s}),define("tp/reports/burndown/filter",["jQuery","tp/reports/burndown/dataProvider","tp/reports/filterProvider"],function(e,t,i){function n(n){this.dataProvider=new t,this.template='<div class="chart-filter">\n    <span class="pr-10">\n        <label><span class="divider">Burn Down for&nbsp;&nbsp;</span><span class="_burnDownType iterations-caret iterations-caret-disabled"></span></label>\n    </span>\n    <span class="pr-10">\n        <label><span class="divider">&nbsp;&nbsp;</span><span class="_selectedIteration iterations-caret iterations-caret-disabled"></span></label>\n    </span>\n    <span class="ui-dateeditor pr-10">\n        <label><span class="divider">Start Date&nbsp;&nbsp;</span><input type="text" name="StartDate" class="_startDate hasDatePicker" maxlength="20"></label>\n    </span>\n    <span class="divider">\n        <label class="pr-10"><input type="checkbox" name="Weekends" class="_weekends" checked="checked">Weekends</label>\n    </span>    \n    <span class="divider _bugsOption">\n        <label><input type="checkbox" name="dont-count-bugs" class="_include-bugs" checked="checked">Include {1}</label>\n    </span>\n    <div class="button-group _unitsOption">\n        <a class="button middle selected _inPoints" href="javascript:void(0);">In points</a>\n        <a class="button middle _inHours" href="javascript:void(0);">In hours</a>\n    </div>\n</div>',this.filterProvider=new i(n),e(this.filterProvider).on("afterRender",e.proxy(function(){e(this).trigger("afterRender")},this))}return n.prototype={initialize:function(e){e.template=this.template,this.filterProvider.initialize(e)},getData:function(){var e=this.filterProvider._getSelectedPlannable(),t=this.filterProvider._getStartDate();
if(e&&t){var i={startDate:t,includeWeekends:this.filterProvider._getIncludeWeekends(),isInPoints:this.filterProvider.isInPoints(),showBugs:this.filterProvider.isShowBugs(),units:e.isPointsAvailable&&this.filterProvider.isInPoints()?"p":"h",plannableId:e.id,burnDownType:e.typeName,manuallySetVelocity:this.filterProvider.getManuallySetVelocity()};return i}return null},update:function(){this.filterProvider.update()}},n}),define("tp/reports/burndown/idealLine",["tau/utils/utils.date"],function(){var e=function(e,t){var i=t.data[0];i&&e.createGroup("idealLine").append("line").attr("class","idealLine").attr("x1",e.x(0)).attr("y1",e.y(t.getIdealLineStartValue())).attr("x2",e.x(t.iterationEndDay+1)).attr("y2",e.y(0))};return{render:e}}),define("tp/reports/chart.format",["libs/d3/d3"],function(e){return{precision:function(t){return function(i){return e.format("s")(Math.round(i*Math.pow(10,t))/Math.pow(10,t))}}}}),define("tp/reports/burndown/forecastCaption",["Underscore","tau/utils/utils.date","tp/reports/chart.format","libs/jquery/jquery.inputMaskEditor"],function(e,t,i){function n(){}return n.prototype={initialize:function(e){this.filter=e.filter},render:function(n,a){var r=i.precision(1),s=function(e){var t="release"==a.filter.burnDownType?"Weekly":"Daily";return e?t.toLowerCase():t},o=function(){var e=a.velocity?r(a.velocity)+""+a.filter.units+".&nbsp;&nbsp;":"n/a.";return"Calculated "+s(!0)+" velocity: "+e},l=function(){return a.forecast?"Estimated finish: "+t.convertToTimezone(a.forecast).toString("d MMM")+".":""},u=function(){return'<div class="forecast-section"><a href="javascript:void(0)" class="show-velocity-section ui-link">Forecast using new velocity</a><div class="velocity-section" style="display: '+(a.manuallySetVelocity?"block":"none")+'"><span>'+s(!1)+' velocity:</span> <input id="input-forecast" class="velocity-input" type="text" value="'+a.manuallySetVelocity+'" /> '+a.filter.units+' <button class="_show-new-forecasted tau-btn" onclick="return false;">Forecast</button> <a href="javascript:void(0)" class="_discard-velocity ui-link">Discard</a></div></div>'
};n.caption.html("<div>"+o()+l()+(a.isPlannableFinished?"":u())+"</div>");var c=function(){return n.placeholder.find(".velocity-input")};c().inputMaskEditor({mask:"^[0-9]*([\\"+a.decimalSeparator+"][0-9]{0,2})?$"}),c().keypress(e.bind(function(e){e.which==$.ui.keyCode.ENTER&&this.filter.update()},this)),n.placeholder.find("._show-new-forecasted").click(e.bind(this.filter.update,this.filter)),n.placeholder.find("._discard-velocity").click(e.bind(function(){c().val(""),this.filter.update()},this)),n.placeholder.find(".show-velocity-section").click(e.bind(function(){c().val("");var t=function(){return n.placeholder.find(".velocity-section")};t().slideToggle(400,e.bind(function(){t().is(":visible")||this.filter.update()},this))},this))}},n}),define("tp/reports/burndown/forecastLine",["tau/utils/utils.date"],function(){var e=function(e,t){var i=t.data[0];if(i&&null!=t.forecast&&!(t.forecastDay<=0)){var n=e.getLastBurnDownPoint();e.createGroup("forecastLine").append("line").attr("class","forecastLine").attr("x1",n.x2.baseVal.value).attr("y1",n.y2.baseVal.value).attr("x2",e.x(t.forecastDay+1)).attr("y2",e.y(0))}};return{render:e}}),define("tp/reports/burndown/lineChart",["jQuery","libs/d3/d3"],function(e,t){var i=function(){};return i.prototype={render:function(i,n){var a=this,r=i.createGroup("marker"),s=r.append("rect").attr("class","lineChartPointYCoordinateRect").attr("x",0).attr("width",i.margin).attr("height",20).attr("rx",5).attr("ry",5).style("display","none"),o=r.append("text").attr("class","lineChartPointYCoordinate").attr("x",i.margin/2).attr("y",0).attr("width",i.margin).attr("height",i.margin).style("display","none"),l=o.append("tspan").attr("dy",0),u=r.append("line").attr("class","lineChartPointYLine").attr("x1",i.x(0)).style("display","none"),c=function(e,t){s.attr("y",i.y(n.getYValue(e))-s.attr("height")/2).style("display",null),o.attr("y",i.y(n.getYValue(e))+5).style("display",null),l.text(Math.round(n.getYValue(e))),t>0&&u.attr("x2",i.x(t)-7).attr("y1",i.y(n.getYValue(e))).attr("y2",i.y(n.getYValue(e))).style("display",null)
},d=function(){o.style("display","none"),u.style("display","none"),s.style("display","none")},p=function(e){e.attr("stroke-width",5)},f=function(e){e.attr("stroke-width",3)};i.createGroup("chart").selectAll("line.lineChart").data(n.data).enter().append("g").attr("class",function(e,t){return"item"+t}).each(function(n,r){if(null!=n.total){{var s=t.select(this),o=s.append("circle").attr("cx",i.x(r+.5)).attr("cy",i.y((n.total.remained+n.total.remainedForNextDay)/2)).attr("r",1).attr("stroke","#3BCAFF").attr("stroke-width",1),l=s.append("line").attr("class","lineChart").attr("x1",i.x(r)).attr("y1",i.y(n.total.remained)).attr("x2",i.x(r+1)).attr("y2",i.y(n.total.remainedForNextDay)).attr("stroke","#3BCAFF").attr("stroke-width",3);s.append("circle").attr("class","lineChartPoint").attr("cx",i.x(r)).attr("cy",i.y(n.total.remained)).attr("r",4)}n.last&&s.append("circle").attr("class","lineChartPoint").attr("cx",i.x(r+1)).attr("cy",i.y(n.total.remainedForNextDay)).attr("r",4);var u=s.append("rect").attr("x",i.x(r)).attr("y",i.y(i.yAxis.max)).attr("class","lineChartPointHover").attr("width",i.xCellSize).attr("height",i.y(0)-i.y(i.yAxis.max)).attr("opacity",0).on("mouseover",function(){t.select(this).attr("opacity",.1),c(n,r),p(l)}).on("mouseout",function(){t.select(this).classed("lineChartPointHoverSelected")||t.select(this).attr("opacity",0),d(),f(l)});e(u[0]).click(function(t){e(a).trigger("click",{name:"lineChart",$pointer:e(o[0]),data:n,index:r,$rect:e(this),origin:t})})}})},fadeOut:function(e){t.select(e).attr("opacity",.1),t.select(e).attr("class","lineChartPointHoverSelected")},fadeIn:function(e){t.select(e).attr("class","lineChartPointHover"),t.select(e).attr("opacity",0)}},i}),define("tp/reports/contextProvider",["Underscore","tau/core/termProcessor"],function(e,t){function i(e,i){this.context=e,this.termProcessor=i?i:this.context&&this.context.applicationContext&&this.context.getTerms?new t(config.context.getTerms()):new t}return i.prototype={onReady:function(e){e()},_exceptNulls:function(t){return e.filter(t,function(e){return"null"!=e
})},getProjectIds:function(){return this._exceptNulls(this.context.selectedProjectIds)},getTeamIds:function(){return this._exceptNulls(this.context.selectedTeamIds)},getBugsTerm:function(){return this.termProcessor.getTerms("Bug").names.toLowerCase()},getIterationTerm:function(){return this.termProcessor.getTerms("Iteration").name},getReleaseTerm:function(){return this.termProcessor.getTerms("Release").name},setCurrentProject:function(){},getTermProcessorForCurrentProject:function(){return this.termProcessor},getTerms:function(e){return this.termProcessor.getTerms(e)},getTerm:function(e,t){var i=this.getTerms(e);return 1==t?i.name:i.names},isPracticeAvailable:function(t){return e.any(this.context.processes,function(i){return e.any(i.practices,function(e){return e.name==t})})}},i}),define("tp/reports/extension.context",["tau/components/extensions/component.extension.base","tp/reports/contextProvider","tau/models/dataprocessor/model.processor.context","tau/core/termProcessor"],function(e,t,i,n){return e.extend({"bus afterInit":function(e,a){var r=this,s=a.config.context.configurator,o=s.getAppStateStore(),l=s.getApplicationContextService();o.get({fields:["acid"],callback:function(e){l.getApplicationContext({acid:e.acid},{success:function(e){var a=new n(i({applicationContext:e}).getTerms());r.fire("contextProvider.ready",new t(e,a))}})}})}})}),define("tp/reports/extension.navigator",["tau/components/extensions/component.extension.base","Underscore"],function(e){function t(e){this.configurator=e}return t.prototype={navigate:function(e){this.configurator.service("navigator").to(e.type+"/"+e.id)}},e.extend({"bus afterInit":function(e,i){this.fire("navigator.ready",new t(i.config.context.configurator))}})}),define("tp/reports/burndown/component.report",["jQuery","tp/reports/report","tp/reports/burndown/filter","tp/reports/burndown/dataProvider","tp/reports/burndown/idealLine","tp/reports/burndown/forecastCaption","tp/reports/burndown/forecastLine","tp/reports/burndown/lineChart","tau/components/component.creator","tp/reports/extension.context","tp/reports/extension.navigator","tau/components/extensions/component.extension.base","tau/components/extensions/error/extension.errorBar"],function(e,t,i,n,a,r,s,o,l,u,c,d,p){var f=d.extend({"bus afterInit":function(t,n){var a=new i({storage:n.config.storage});
e(a).on("afterRender",e.proxy(function(){this.fire("filter.afterRender",a)},this)),this.fire("filter.ready",a)},"bus afterRender + contextProvider.ready + navigator.ready + filter.ready":function(i,l,u,c,d){var p=new n;e(p).on("data-error",e.proxy(function(e,t){this.fire("error",t.Message)},this));var f=new r;f.initialize({filter:d});var m=new t({height:.7*e(window).height(),placeholder:l.element,filter:d,dataProvider:p,charts:[a,new o,s],captions:[f],contextProvider:u,navigator:c});e(m).on("afterInit",e.proxy(function(){l.element.find(".tableTitle").hide(),this.fire("plot.afterInit",m)},this)),e(m).on("afterRender",e.proxy(function(){this.fire("plot.afterRender",m)},this)),e(m).on("details.afterRender",e.proxy(function(e,t){this.fire("details.afterRender",t)},this)),m.render()}});return{create:function(e){var t={extensions:[u,c,f,p],template:{engine:"jqote2",name:"reports-template",markup:['<div class="tau-chart tp2-chart i-role-burnDown">',"</div>"]}},i=l.create(t,e);return i.fire("dataBind",{}),i}}}),define("tp/reports/settings/type/template.type",["tau/nls/translator","tau/core/templates-factory","tau/extensions/extension.underscore"],function(e,t,i){var n={name:"report.type",engine:"jqote2",markup:i.flatten(['<span class="tau-chart-entities _entities">',"<% var termProcessor = this.termProcessor; %>","<% _.forEach(this.types, function(item) { %>",'<input type="checkbox" name="entities" value="<%= item.id %>" <% if (item.isDefault) { %> checked="checked" <% } %> style="position: absolute; left: -99999px;" />','<button type="button" class="i-role-report-entity-type tau-btn tau-<%= item.id %><% if (item.isDefault) { %> tau-checked<% } %>"><%= fn.term(item.id, "name", termProcessor) %></button>',"<% }); %>","</span>"])};return t.register(n)}),define("tp/reports/settings/type/extension.type.form",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({})}),define("tp/reports/settings/type/config",["tp/reports/settings/type/template.type","tp/reports/settings/type/extension.type.form"],function(e,t){return{extensions:[t]}
}),define("tp/reports/settings/filter/template.filter",["tau/nls/translator","tau/core/templates-factory","tau/ui/templates/board.editor/ui.template.board.editor.filter","tau/extensions/extension.underscore"],function(e,t,i,n){var a={name:"report.filter",engine:"jqote2",markup:n.flatten(['<%= fn.sub("board.editor.filter", {name: "data", filter: this.filter, useFilter: this.useFilter}) %>']),dependencies:[]};return t.register(a)}),define("tp/reports/settings/filter/model.filter.help",["Underscore","tau/core/model-base","tau/models/board.editor/board.filter.help"],function(e,t,i){return t.extend({"bus settings.changed":function(t,n){var a=this,r={data:{types:e.map(n.parameters.definition.cells.items,function(e){return e.id})}};(new i).get(r).done(function(e){a.fire("refresh.help.content",e)})}})}),define("tp/reports/settings/filter/model.filter.autocomplete",["Underscore","tau/core/extension.base","tau/models/board.editor/board.filter.suggestionManager"],function(e,t,i){var n=t.extend({"bus beforeInit":function(e,t){var n=t.config.context.configurator;this.fire("configurator.ready",n),this.fire("suggestionManager.ready",new i(n))},getTypes:function(t){return e.map(t.parameters.definition.cells.items,function(e){return e.id})},"bus filter.autocomplete.preload + suggestionManager.ready:last + settings.changed:last":function(t,i,n,a){var r=this.getTypes(a);if(0!=r.length){var s=i.value;if(s&&0!==s.length&&"?"==s[0]){var o=[s.trim()+" ",s.trim()+"."];e.each(o,function(e){var t={query:{resourceTypes:r,script:e}};n.get(t)})}}},"bus filter.autocomplete.resolve + suggestionManager.ready:last + settings.changed:last":function(t,i,n,a){var r=i.$input,s=this.getTypes(a);if(0==s.length)return void i.next([]);var o=i.request.term.slice(0,r[0].selectionStart),l=function(t){var n=t.Suggestions?t.Suggestions.Items:[];n=e.map(n,function(e){return e.Source=t.Source,e.Position=t.Position,e}),i.next(n)},u=function(){i.next([])},c={query:{resourceTypes:s,script:o}};n.get(c).done(l).fail(u)
}});return n}),define("tp/reports/settings/filter/extension.filter.form",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay","libs/jquery/jquery.placeholder","libs/jquery/jquery.toggleFilter"],function(e,t,i){return i.extend({"bus $el.ready:last + error":function(e,t){t.tauOverlay("hide")},"bus $form.ready":function(e,i){var n=this,a=i.find(".i-role-filter-input");a.placeholder(),a.each(function(){t(this).data("default",t(this).val())}),i.find(".i-role-filter-control").toggleFilter({}),i.on("click",".i-role-report-entity-type",function(e){var n=t(this),a=n.prev(),r=!n.hasClass("tau-checked");n.toggleClass("tau-checked",r),a.prop("checked",r),i.trigger("_change",{$input:a,sourceEvent:e})});var r="[name=data_filter]",s=i.find(r);i.delegate(r,"keydown",function(e){if(e.which==t.ui.keyCode.ENTER){var i=t(this);i.blur()}}),i.on("_change",function(){n._enableFilter(n.unbind(i).entities.length,s),n.fire("filter.form.changed")})},_enableFilter:function(e,t){t.prop("disabled",!e);var i=t.closest(".i-role-filter-control");i.find(".i-role-help").prop("disabled",!e),i.find(".i-role-filter-toggle").prop("disabled",!e&&!i.hasClass("i-role-filter-control_on"))},"bus configurator.ready:last + $form.ready:last + filter.resolve":function(e,t,i,n){var a=this.unbind(i),r=this;t.getAppStateStore().get({fields:["acid"],callback:function(e){r.getSpaceTotal(t.getSliceFactory(),e.acid,a).done(function(e){r.updateForm(t,i,e),n.resolve(a)})}})},unbind:function(e){return{entities:e.find("[name=entities]:checked").map(function(){return{id:t(this).val()}}),filter:e.find("[name=data_filter]").val(),useFilter:!!e.find(".i-role-useFilter").prop("checked")}},updateForm:function(i,n,a){var r=n.find(".i-role-filter-input");r.placeholder("refresh");var s=n.find("[name=entities]"),o=a.cells.types;e.forEach(o,function(e){var i=s.filter(function(){return this.value==e.id||t(this).hasClass("permission-denied")}),n=i.next(),a=!e.isAvailable;
i.add(n).prop("disabled",a).toggleClass("tau-disabled",a)})},getSpaceTotal:function(i,n,a){return t.when(this.spaceAvailable(i,n),this.spaceCells(i,n,a)).pipe(function(t,i){var n={spaceDefault:t.space,spaceAvailable:{cells:i.space.cells||[]},settingsCurrent:i.settings},a={cells:{name:"cells",types:[],filter:""}},r=function(e){return e.toLowerCase()};return a.cells.types=e.map(n.spaceDefault.cells.items,function(t){var i={id:t.id,name:t.name,isAvailable:e.any(n.spaceAvailable.cells.items,function(e){return r(e.id)===r(t.id)}),isSelected:e.any(n.settingsCurrent.cells.items,function(e){return r(e.id)===r(t.id)})};return i.isAvailable=i.isSelected?!0:i.isAvailable,i}),a.cells.filter=n.settingsCurrent.cells.filter||"",a.acid=i.settings.acid||"",a})},spaceAvailable:function(e,t){var i={global:{acid:t}},n=e.create({definition:i});return n.space().pipe(function(e){return{space:e.data}})},spaceCells:function(t,i,n){var a={cells:{items:n.entities,filter:n.filter},acid:i},r={definition:{global:{acid:i},cells:{items:e.map(a.cells.items,function(e){return{id:e.id,data:null,filter:null,type:e.id}})}}},s=t.create(r);return s.space().pipe(function(e){return{space:e.data,settings:a}})}})}),define("tp/reports/settings/filter/config",["tp/reports/settings/filter/template.filter","tp/reports/settings/filter/model.filter.help","tp/reports/settings/filter/model.filter.autocomplete","tp/reports/settings/filter/extension.filter.form","tau/ui/extensions/board.editor/ui.extension.board.editor.autocomplete","tau/ui/extensions/board.editor/ui.extension.board.editor.help","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/board.plus/ui.extension.board.plus.errors"],function(e,t,i,n,a,r,s,o){return{extensions:[t,i,n,a,r,s,o]}}),define("tp/reports/settings/time/template.time",["tau/nls/translator","tau/core/templates-factory","tau/extensions/extension.underscore"],function(e,t,i){var n={name:"report.time",engine:"jqote2",markup:i.flatten(['<span class="tau-inline-group tau-chart-time-switch _time-switch">','   <% _.forEach(this, function(item){ %><button type="button" data-val="<%= item.id %>" data-axislabel="<%= item.label %>" data-filter="<%= item.filter%>" class="tau-btn<% if (item.isDefault) { %> tau-checked<% } %>"><%= item.name %></button><% }); %>',"</span>"]),dependencies:[]};
return t.register(n)}),define("tp/reports/settings/time/extension.time.form",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({"bus $form.ready":function(e,i){var n=this;i.delegate(".tau-chart-time-switch button","click",function(){i.find(".tau-chart-time-switch button").removeClass("tau-checked"),t(this).addClass("tau-checked"),n.fire("time.form.changed")})},"bus $form.ready:last + time.resolve":function(e,t,i){var n=t.find(".tau-chart-time-switch button.tau-checked");i.resolve({key:n.data("val"),label:n.data("axislabel"),filter:n.data("filter")})}})}),define("tp/reports/settings/time/config",["tp/reports/settings/time/template.time","tp/reports/settings/time/extension.time.form"],function(e,t){return{extensions:[t]}}),define("tp/reports/chart.plot",["jQuery","libs/d3/d3","tp/reports/service.chart.size"],function(e,t,i){function n(n){var a=new i;this.defaultSize=a.size(),e.extend(this,n),this.size=this.size||a,this.empty=e(n.placeholder).find(".empty"),this.plot=t.select(n.placeholder).select("svg"),e(this.placeholder).height(this.defaultSize.height),this.loader=e('<div class="loader-container"></div>').prependTo(e(this.placeholder)).css({width:"100%",height:this.defaultSize.height,position:"absolute",top:0}).tauProgressIndicator(),this.plot.append("defs");var r=this.plot.selectAll("g.axis").data(this.axes).enter().append("g").attr("class","axis");r.append("text").attr("class","axisLabel axisTitle"),this.plot.selectAll("g.chart").data(this.charts).enter().append("g").attr("class","chart")}return n.prototype={loading:function(e){e?(this.loader.tauProgressIndicator("show"),this._hideEmpty()):this.loader.tauProgressIndicator("hide")},_hideEmpty:function(){this.empty.addClass("invisible")},_showEmpty:function(){this.empty.removeClass("invisible")},data:function(t,i){var n=this,a=t?t.nodes:[],r=function(){e(n.plot[0][0]).hide(),n.setSize(n.defaultSize),n._showEmpty()},s=function(){n._hideEmpty(),e(n.plot[0][0]).show()
};if(!a||!a.length)return e(this).trigger("nodata"),void r();var o=this.getBox(a);this.setSize(o),s();var l=this.scales.get(a,i,o),u={scales:l,extend:function(t){return e.extend(t,this)},plot:o};this.plot.selectAll("g.axis").data(this.axes).each(function(e){e.render(u.extend({placeholder:this}))}),this.plot.selectAll("g.chart").data(this.charts).each(function(e){e.data(t,u.extend({placeholder:this}))})},getBox:function(t){var i=this.size?this.size.size(t):this.defaultSize;return e.extend(i,{margin:60})},setSize:function(t){e(this.placeholder).height(t.height),e(this.plot).height(t.height),e(this.empty).height(t.height)}},n}),define("tp/reports/chart.scales",["libs/d3/d3"],function(e){return{type:function(){return e.scale.ordinal().domain(["UserStory","Bug","Task","Feature","Request"]).range(["userstory","bug","task","feature","request"])}}}),define("tp/reports/cycleTimeDistribution/chart.scales",["Underscore","libs/d3/d3","tp/reports/chart.scales"],function(e,t,i){function n(){}return n.prototype={get:function(e,n,a){var r=t.scale.linear().range([a.margin,a.width-a.margin]).domain([0,t.max(e,function(e){return e.values.length})]);r.label=n.mapping.x.label;var s=t.max(e,function(e){return t.max(e.values,function(e){return e.y})});s=t.min([1.2*s,1]);var o=t.scale.linear().range([a.height-a.margin,a.margin]).domain([0,s]);o.label=n.mapping.y.label;var l=t.scale.linear().range([a.height-a.margin,a.margin]).domain([0,1]),u=function(e){return r(e)-r(0)},c=function(e){return o.range()[0]-o(e)};return{x:r,y:o,fill:i.type(),probability:l,width:u,height:c,axisMargin:20}}},n.xMax=200,n}),define("tp/reports/chart.behaviour",["Underscore","tau/core/class"],function(e,t){var i=t.extend({init:function(e){this.handlers=this.initHandlers(e.handlers||[])},initHandlers:function(e){return e},_handle:function(t,i,n,a){e.each(this.handlers,function(e){e[t]&&e[t].call(i,n,a)})},_subscribe:function(t,i,n){var a=this;return e.each(i,function(e){t=t.on(e,function(t){a._handle(e,this,t,n)})}),t
}});return i}),define("tp/reports/cycleTimeDistribution/chart.histogram",["jQuery","Underscore","libs/d3/d3","tp/reports/chart.behaviour"],function(e,t,i,n){return n.extend({init:function(e){this.handlers=this.initHandlers(e.handlers||[])},_join:function(t){return t[0].values.map(function(n,a){return{x:n.x,values:t.map(function(t){return e.extend(t.values[a],{fill:t.key,count:t.values.count})}).filter(function(e){return e.y>0}).sort(function(e,t){return i.descending(e.y,t.y)})}})},data:function(e,t){var n=e.nodes,e=this._join(n),a=i.select(t.placeholder).selectAll("g.day").data(e,function(e){return e.x});a.enter().append("g").attr("class","day"),a.exit().remove(),a.attr("transform",function(e){return"translate("+t.scales.x(e.x)+",0)"}).each(function(){var e=i.select(this);e.select("g")[0][0]||(e.append("g").attr("class","bar"),e.append("g").attr("class","top"))});var r=a.select("g.bar").selectAll("rect").data(function(e){return e.values},function(e){return e.fill});r.enter().append("rect"),r.exit().remove(),r.attr("class",function(e){return t.scales.fill(e.fill)}).transition().attr("y",function(e){return t.scales.y(e.y)}).attr("width",function(e){return t.scales.width(e.dx)-1}).attr("height",function(e){return t.scales.height(e.y)});var s=a.select("g.top").selectAll("line").data(function(e){return e.values},function(e){return e.fill});s.enter().append("line"),s.exit().remove(),s.attr("class",function(e){return t.scales.fill(e.fill)}).transition().attr("y1",function(e){return t.scales.y(e.y)}).attr("y2",function(e){return t.scales.y(e.y)}).attr("x1",.5).attr("x2",t.scales.x(1)-t.scales.x(0)-1),this._subscribe(a,["mousemove","mouseover","mouseout"],t)}})}),define("tp/reports/cycleTimeDistribution/chart.maxValues",["jQuery","Underscore","libs/d3/d3"],function(e,t,i){function n(e){this.contextProvider=e.contextProvider}return n.prototype={data:function(t,n){var a=t.nodes,r=a.map(function(t){var n=i.max(t.values,function(e){return e.length}),a=t.values.filter(function(e){return e.length==n
});return e.extend(a[0],{key:t.key,count:t.values.count})});r=i.nest().key(function(e){return e.x}).rollup(function(e){return e.sort(function(e,t){return i.descending(e.y,t.y)})}).entries(r);var s=i.select(n.placeholder).selectAll("text.max-val").data(r,function(e){return e.key});s.enter().append("text").attr("class","max-val"),s.attr("y",function(e){return n.scales.y(e.values[0].y)}),s.exit().remove();var o=s.selectAll("tspan").data(function(e){return e.values});o.enter().append("tspan"),o.exit().remove();var l=this;o.attr("class",function(e){return n.scales.fill(e.key)}).text(function(e){return e.length+" of "+e.count+" "+l.contextProvider.getTerm(e.key,e.all).toLowerCase()}).transition().attr("x",function(e){return n.scales.x(e.x)}).attr("dy",function(e,t){return-5-9*t}).attr("dx",2)}},n}),define("tp/reports/cycleTimeDistribution/chart.probability",["jQuery","Underscore","libs/d3/d3","tp/reports/chart.behaviour"],function(e,t,i){function n(){}return n.prototype={init:function(e){this.handlers=this.initHandlers(e.handlers||[])},_cumulative:function(e){var t=i.layout.stack();return e.map(function(e){return t(e.values.map(function(t){return[{x:t.x,y:t.y,dx:t.dx,fill:e.key}]}))})},_join:function(e){return e[0].map(function(t,i){return{x:t[0].x,values:e.map(function(e){return e[i][0]})}})},data:function(e,t){var n=e.nodes,e=this._join(this._cumulative(n)),a=i.select(t.placeholder).attr("opacity",0).selectAll("g.probability").data(e);a.enter().append("g").attr("class",function(e){return"probability data-x-"+e.x}),a.exit().remove();var r=a.selectAll("path").data(function(e){return e.values},function(e){return e.fill});r.enter().append("path"),r.exit().remove(),r.attr("class",function(e){return t.scales.fill(e.fill)}).transition().attr("d",function(e){return"M"+t.scales.x(e.x)+","+t.scales.probability(e.y0)+"L"+t.scales.x(e.x)+","+t.scales.probability(e.y+e.y0)+"L"+t.scales.x(e.x+e.dx)+","+t.scales.probability(e.y+e.y0)})}},n}),define("tp/reports/cycleTimeDistribution/chart.hover",["jQuery","Underscore","libs/d3/d3","tp/reports/chart.behaviour"],function(e,t,i,n){return n.extend({init:function(e){this.handlers=this.initHandlers(e.handlers||[])
},data:function(e,t){var n=e.nodes,e=n[0].values.map(function(e){return{x:e.x,dx:e.dx}}),a=i.select(t.placeholder).selectAll("rect.transparent").data(e),r=t.scales.y.domain()[1];a.enter().append("rect").attr("class","transparent"),a.attr("x",function(e){return t.scales.x(e.x)}).attr("y",t.scales.y.range()[1]).attr("width",function(e){return t.scales.width(e.dx)}).attr("height",t.scales.height(r)),a.exit().remove(),this._subscribe(a,["mousemove","mouseover","mouseout"],t)}})}),define("tp/reports/chart.axis",["libs/d3/d3"],function(e){var t=function(t){function i(){i.d3axis.apply(this.d3axis,arguments),i.transform.apply(i.transform,arguments),i.axis.apply(i.axis,arguments),i.tick.apply(i.tick,arguments),i.label.apply(i.label,arguments),i.additionalAxes.apply(i.additionalAxes,arguments)}var n=10;return i.d3axis=e.svg.axis(),i.transform=function(){},i.axis=function(){},i.tick=function(i){i.selectAll("g").attr("class","axisLabel");var n=i.selectAll(".tick")[0].map(function(t){var i=e.select(t);return{x2:i.attr("x2"),transform:i.attr("transform")}}).concat(i.selectAll("g.axisLabel")[0].map(function(t){var i=e.select(t);return{x2:i.select("line.tick").attr("x2"),transform:i.attr("transform")}}));i.selectAll(".tick").attr("y1",-t).attr("y2",function(){return parseFloat(e.select(this).attr("y2"))-t}),i.selectAll(".smallAxisTick").remove();var a=i.selectAll(".smallAxisTick").data(n.filter(function(e){return e.transform}));a.enter().append("line").attr("x2",function(e){return e.x2}).attr("y2",6).attr("transform",function(e){return e.transform}).attr("class","smallAxisTick")},i.label=function(){},i.scale=function(e){return this.d3axis.scale(e),i},i.additionalAxes=function(){},i.orient=function(a){switch(a.type){case"x-grid":var r=a.margin-a.height;return i.d3axis.orient("bottom").tickSize(r,a.margin-a.height,0).tickPadding(10),i.transform=function(e){e.attr("transform","translate(0,"+(a.height+t)+")")},i.axis=function(i){i.select("path").attr("d",function(){var i=e.select(this).attr("d"),n=/M\D*\d+\D*/.exec(i)[0].length-1,a=parseFloat(i.substr(1,n-1));
return"M"+(a-t)+i.substr(n)})},i.label=function(t){var n=e.select(t.selectAll(".axisLabel text")[0][0]);t.selectAll("text.axisLabel").attr("transform","translate("+(i.d3axis.scale().range()[1]+a.margin/4)+", 0)").attr("y",n.attr("y")).attr("dy",n.attr("dy")).text(a.label)},i.additionalAxes=function(e){var n=[{id:"top",value:a.margin-a.height-t},{id:"bottom",value:-t}],r=e.selectAll("line._additionalXAxis").data(n,function(e){return e.id});r.enter().append("line").attr("class","additionalAxis _additionalXAxis"),r.attr("x1",i.d3axis.scale().range()[0]).attr("x2",i.d3axis.scale().range()[1]).attr("y1",function(e){return e.value}).attr("y2",function(e){return e.value}),r.exit().remove()},i;case"y-grid":var r=-a.width+a.margin;return i.d3axis.orient("left").tickSize(r,r,0).tickPadding(n),i.transform=function(e){e.attr("transform","translate("+(a.margin-t)+", 0)")},i.axis=function(i){i.select("path").attr("d",function(){var i=e.select(this).attr("d"),n=i.indexOf("V"),a=i.indexOf("H",n),r=parseFloat(i.substr(n+1,a-n-1))+t;return i.substr(0,n+1)+r+i.substr(a)})},i.tick=function(i){i.selectAll("g").attr("class","axisLabel"),i.selectAll(".tick").attr("dx",.5*a.margin).attr("x1",t).attr("x2",function(){return parseFloat(e.select(this).attr("x2"))+t});var n=i.selectAll(".tick")[0].map(function(t){var i=e.select(t);return{y2:i.attr("y2"),transform:i.attr("transform")}}).concat(i.selectAll("g.axisLabel")[0].map(function(t){var i=e.select(t);return{y2:i.select("line.tick").attr("y2"),transform:i.attr("transform")}}));i.selectAll(".smallAxisTick").remove();var r=i.selectAll(".smallAxisTick").data(n.filter(function(e){return e.transform}));r.enter().append("line").attr("y2",function(e){return e.y2}).attr("x2",-6).attr("transform",function(e){return e.transform}).attr("class","smallAxisTick")},i.label=function(e){e.selectAll("text.axisLabel").attr("transform","translate("+-a.margin/2+","+(a.margin-t+n)+")").text(a.label)},i.additionalAxes=function(e){var n=[{id:"right",value:a.width-a.margin+t},{id:"left",value:t}],r=e.selectAll("line._additionalYAxis").data(n,function(e){return e.id
});r.enter().append("line").attr("class","additionalAxis _additionalYAxis"),r.attr("x1",function(e){return e.value}).attr("x2",function(e){return e.value}).attr("y1",i.d3axis.scale().range()[0]).attr("y2",i.d3axis.scale().range()[1]),r.exit().remove()},i}},i.tickSubdivide=function(e){return i.d3axis.tickSubdivide(e),i},i.tickFormat=function(e){return i.d3axis.tickFormat(e),i},i};return t}),define("tp/reports/cycleTimeDistribution/chart.axes.format",["tp/reports/chart.format","tp/reports/cycleTimeDistribution/chart.scales"],function(e,t){function i(t){return function(i){return e.precision(t)(100*i)+"%"}}function n(e,t){return function(i){switch(i){case e:return"less than 1 day";case 1:return"1 day";case t:return"more than "+i+" days";default:return i+" days"}}}return{y:i(1),days:n(0,t.xMax)}}),define("tp/reports/cycleTimeDistribution/chart.axes",["libs/d3/d3","tp/reports/chart.axis","tp/reports/cycleTimeDistribution/chart.axes.format"],function(e,t,i){var n=function(i){var n=t(i.scales.axisMargin).scale(i.scales.x).orient({type:"x-grid",height:i.scales.y.range()[0],margin:i.plot.margin,label:i.scales.x.label});e.select(i.placeholder).classed("_x x",!0).call(n)},a=function(n){var a=t(n.scales.axisMargin).scale(n.scales.y).orient({type:"y-grid",width:n.scales.x.range()[1],margin:n.plot.margin,label:n.scales.y.label}).tickSubdivide(1).tickFormat(i.y);e.select(n.placeholder).classed("_y y",!0).call(a)};return{x:{render:n},y:{render:a}}}),define("tp/reports/cycleTimeDistribution/behaviour.hover.bars",["jQuery","libs/d3/d3","tp/reports/cycleTimeDistribution/chart.axes.format"],function(e,t,i){return{create:function(n){var a=e('<div class="tau-chart-tooltip" style="position:absolute"></div>').appendTo(n.placeholder).tauBubble({content:"",className:"tau-chart-tooltip",onPositionConfig:function(e){e.my="left bottom"},onBeforeShow:function(e){function t(){return["<div>"+i.days(a.values[0].x)+"</div>"].concat(a.values.map(function(e){return'<div><span class="'+r.scales.fill(e.fill)+'"><strong>'+i.y(e.y)+"</strong> of all "+n.contextProvider.getTerms(e.fill).names.toLowerCase()+"</span><span> ("+e.length+" of "+e.count+")</span></div>"
})).join("")}var a=this.$target.data("d"),r=this.$target.data("context");e.find('[role="content"]').html(t())}});return{mouseover:function(i,n){var r=e(this).offset();r.top+=1,r.left+=n.scales.width(.5),a.data("d",t.select(this).datum()),a.data("context",n),a.offset(r).tauBubble("show")},mouseout:function(){a.data("ui-tauBubble")&&a.tauBubble("hide")}}}}}),define("tp/reports/cycleTimeDistribution/behaviour.hover.probability",["jQuery","libs/d3/d3","tp/reports/cycleTimeDistribution/chart.axes.format"],function(e,t,i){function n(e){return t.event.pageX-e.offset().left}function a(i){return t.event.pageX-e(i).closest("div").offset().left}function r(e){return{render:function(i,n){var a=e.selectAll("path.hover").data([[i,n]]);a.enter().insert("path",":first-child").attr("class","hover"),a.attr("stroke","black").attr("d",t.svg.line())}}}function s(e,t){return{render:function(i,n){var a=e.selectAll("div.hover").data([i]);a.enter().append("div").attr("class","hover tau-chart-tooltip"),a.exit().remove(),a.style("position","absolute").style("left",function(e){return e[0]+"px"}).style("top",function(e){return e[1]+"px"}).attr("class","hover tau-chart-tooltip").html(t(n))}}}function o(e){return function(t){return["<span>probability to complete entities in "+i.days(t.x)+": </span>"].concat(t.values.map(function(t){return'<span class="'+e.scales.fill(t.fill)+'">'+i.y(t.y+t.y0)+" </span>"})).join("")}}return{create:function(){return{mousemove:function(i,l){var u=e(this).closest("div"),c=t.select(u[0]),d=e(this).closest("svg").find(".chart"),p=t.select(d[0]),f=c.selectAll(".probability.data-x-"+i.x),m=a(this),h=[m,l.scales.y.range()[0]],g=[m,l.scales.y.range()[1]-20];r(p).render(h,g),s(c,o(l)).render([n(u),39],f.datum())},mouseout:function(){{var i=e(this).closest("div")[0];t.select(i).selectAll("path.hover, div.hover").remove()}}}}}}),define("tp/reports/cycleTimeDistribution/extension.report",["Underscore","jQuery","tau/components/extensions/component.extension.base","tp/reports/chart.plot","tp/reports/cycleTimeDistribution/chart.scales","tp/reports/cycleTimeDistribution/chart.histogram","tp/reports/cycleTimeDistribution/chart.maxValues","tp/reports/cycleTimeDistribution/chart.probability","tp/reports/cycleTimeDistribution/chart.hover","libs/d3/d3","tp/reports/cycleTimeDistribution/chart.axes","tp/reports/cycleTimeDistribution/behaviour.hover.bars","tp/reports/cycleTimeDistribution/behaviour.hover.probability"],function(e,t,i,n,a,r,s,o,l,u,c,d,p){return i.extend({"bus afterRender + contextProvider.ready + configurator.ready:last":function(e,t,i,u){var f=p.create({placeholder:t.element}),m=d.create({placeholder:t.element,contextProvider:i}),h=new n({scales:new a,placeholder:t.element.find(".tau-chart-plot").get(0),axes:[c.x,c.y],size:u.service("chart.size"),charts:[new s({contextProvider:i}),new o,new l({handlers:[f]}),new r({handlers:[m,f]})]});
this.fire("plot.ready",h)},"bus afterRender:last + plot.afterRender":function(e,t){var i=t.element.find(".chart:has(g.probability)"),n=u.select(i[0]);t.element.find(".chart").on("mouseover",function(){n.transition().attr("opacity",1)}),t.element.find(".chart").on("mouseout",function(){n.transition().attr("opacity",0)})},_hist:function(e){var i=u.range(0,Math.min(Math.round(u.max(e,function(e){return e.y}))+1,a.xMax+1)+1),n=u.layout.histogram().bins(i).frequency(!1).value(function(e){return e.y});return u.nest().key(function(e){return e.fill}).rollup(function(e){return t.extend(n(e),{count:e.length})}).entries(e)},"bus plot.ready:last + beforeLoad":function(e,t){t.loading(!0)},"bus plot.ready:last + afterLoad":function(e,t){t.loading(!1)},"bus plot.ready:last + data.ready":function(e,t,i){t.data({nodes:this._hist(i.data)},i.settings),this.fire("plot.afterRender",t)}})}),define("tp/reports/settings/model.settings",["Underscore","tau/core/extension.base"],function(e,t){return t.extend({defaultData:{},scopeData:"userData",initialSettings:function(t){return t.data&&t.data.userData?e.defaults(t.data.userData,this.defaultData):this.defaultData},getStorage:function(t,i){var n=i.getRestStorage();return e.bind(n.data,n,"settings",t.config.storageName)},"bus beforeInit":function(e,t){var i=t.config.context.configurator;this.fire("configurator.ready",i);var n=this.getStorage(t,i);this.fire("storageSettings.ready",n),n().then(this.initialSettings.bind(this)).done(function(e){this.fire("model.ready",e)}.bind(this))},"bus configurator.ready:last > storageSettings.ready:last > formData.changed":function(t,i,n,a){this.saveSettings(n,a),this.getAcid(i).done(e.bind(function(e){this.setSettings(a,e,i)},this))},"bus saveSettings:last + storageSettings.ready:last + saveSetting":function(t,i,n,a){this.saveToStorage(n,e.extend(i,a))},saveToStorage:function(e,t){e({scope:"Public",userData:t}).done()},getAcid:function(e){var t=$.Deferred();return e.getAppStateStore().get({fields:["acid"],callback:function(e){t.resolve(e.acid)
}}),t},saveSettings:function(e,t){var i=this.processSettings(t);this.saveToStorage(e,i),this.fire("saveSettings",i)},setSettings:function(){},processSettings:function(){}})}),define("tp/reports/settings/definitionBuilder",["Underscore","tau/models/board.customize.units/board.customize.cards.builderSelector","tau/services/customize/service.customize.card.layout.factory","tau/configurations/definitions/board.definition.factory","tau/models/board.customize.units/const.card.sizes"],function(e,t,i,n,a){var r=function(e){switch(e){case"feature":case"userstory":case"task":case"bug":case"request":return"assignable";case"solution":return;default:return e}},s={relations:function(){return"masterRelations.Select({Master.id as id, Master.name as name,Master.entityType.name as type,RelationType.name as relationType,id as relationId}) as masters,slaveRelations.Select({Slave.id as id,Slave.name as name, Slave.entityType.name as type,RelationType.name as relationType,id as relationId}) as slaves"},data:function(){return"id, name, entityType.name as type"}},o=function(n,a,r,o){var l=e.filter(a,function(e){return"program"!==e.toLowerCase()}),u={get:function(){return $.Deferred().resolve({cells:l,zoomLevel:{board:3}})}},c=new i(r,u),d=new t;c.getCardLayoutsByTypesAndSize(l,o).then(function(t){return e.reduce(t,function(e,t,i){return e.types.push({type:i,data:d.build(i,t)}),e.mapLayouts[i]=t,e},{types:[],mapLayouts:{}})}).done(function(t){n.cells.types=t.types,n.layouts=t.mapLayouts,n.cells.items=e.map(t.types,function(e){return{id:e.type,data:e.data.substring(0,e.data.lastIndexOf("}"))+","+s.data()+","+s.relations()+"}",ordering:null}})}.bind(this))};return{getTypeGroup:r,cell:s,getWithRelations:function(t,i,n){var r=e.map(t.entities,function(e){return e.id}),s={base64:!0,take:100,where:null,definition:{global:{acid:i},x:null,y:null,cells:{items:{},filter:t.useFilter?t.filter:null,types:[]},user:{cardFilter:t.onlyWithRelations?"?(MasterRelations.Count > 0) or (SlaveRelations.Count > 0)":""}}};
return o(s.definition,r,n,a.M),{definition:s,layouts:{primary:s.definition.layouts}}},getSecondaryRelations:function(t,i,n){var r=e.map(t,function(e){return e.type}),s={CardsIds:e.pluck(t,"id"),base64:!0,take:t.length,where:null,definition:{global:{acid:i},x:null,y:null,cells:{items:{}}}};return o(s.definition,r,n,a.XS),{definition:s,layouts:{secondary:s.definition.layouts}}},getWithLeadAndCycleTime:function(t,i){return{base64:!0,take:1e3,where:null,definition:{global:{acid:i},x:{id:"entitystate",filter:"?IsFinal is True",ordering:null},cells:{items:e.map(t.entities,function(e){return{id:e.id,data:"{id,name,entityType.name as type,endDate,leadTime,cycleTime}",filter:null,ordering:null}}),filter:t.useFilter?t.filter:null},user:{cardFilter:"?EndDate is not None and ("+t.time.filter+")"}}}}}}),define("tp/reports/settings/templateDataBuilder",["Underscore"],function(e){return{times:function(e){return[{id:"leadTime",name:"Lead Time",label:"Lead Time, days",isDefault:"leadTime"===e.scale,filter:"True"},{id:"cycleTime",name:"Cycle Time",label:"Cycle Time, days",isDefault:"cycleTime"===e.scale,filter:"StartDate is not none"}]},filter:function(e,t){return void 0!==e.filter?e.filter:t},assignables:function(e){var t=[{id:"feature",name:"Feature"},{id:"userstory",name:"User Story"},{id:"task",name:"Task"},{id:"bug",name:"Bug"},{id:"request",name:"Request"}];return this.applyDefaultValues(e,t)},generals:function(e){var t=[{id:"feature",name:"Feature"},{id:"userstory",name:"User Story"},{id:"task",name:"Task"},{id:"bug",name:"Bug"},{id:"request",name:"Request"},{id:"testcase",name:"Test Case"},{id:"testplan",name:"Test Plan"},{id:"testplanrun",name:"Test Plan Run"},{id:"impediment",name:"Impediment"},{id:"team",name:"Team"},{id:"project",name:"Project"},{id:"release",name:"Release"},{id:"iteration",name:"Iteration"},{id:"teamiteration",name:"Team Iteration"},{id:"build",name:"Build"}];return this.applyDefaultValues(e,t)},tp2generals:function(e){var t=[{id:"feature",name:"Feature"},{id:"userstory",name:"User Story"},{id:"task",name:"Task"},{id:"bug",name:"Bug"},{id:"request",name:"Request"},{id:"testcase",name:"Test Case"},{id:"testplan",name:"Test Plan"},{id:"testplanrun",name:"Test Plan Run"},{id:"impediment",name:"Impediment"},{id:"project",name:"Project"},{id:"iteration",name:"Iteration"},{id:"build",name:"Build"}];
return this.applyDefaultValues(e,t)},applyDefaultValues:function(t,i){var n="string"==typeof t.entities?JSON.parse(t.entities):t.entities;return e.each(i,function(t){t.isDefault=e.contains(n,t.id)}),i}}}),define("tp/reports/cycleTimeDistribution/model.settings",["Underscore","tp/reports/settings/model.settings","tp/reports/settings/definitionBuilder","tp/reports/settings/templateDataBuilder"],function(e,t,i,n){return t.extend({NAME_CHART:"Cycle Time Distribution",defaultData:{scale:"cycleTime",entities:["userstory","bug"],filter:"?EndDate > Today - 180(days)"},processSettings:function(t){return{scale:t.time.key,filter:t.filter,useFilter:t.useFilter,entities:JSON.stringify(e.reduce(t.entities,function(e,t){return e.push(t.id),e},[]))}},setSettings:function(e,t){function n(e){return function(t){return t[e]}}function a(e,t){return{map:n(e),label:t}}function r(e){return{map:$.noop,label:e}}var s={strategy:"all",parameters:i.getWithLeadAndCycleTime(e,t),mapping:{y:a(e.time.key,"% of all entities"),x:r(e.time.label),fill:a("type")}};this.fire("settings.changed",s)},"bus model.ready + contextProvider.ready":function(t,i,a){this.fire("dataBind",{times:n.times(i),types:n.assignables(i),isShowSettings:i.isShowSettings,name:this.NAME_CHART,description:this.getDescription(a),filter:n.filter(i,"?EndDate > Today - 180(days)"),useFilter:e.isUndefined(i.useFilter)?!0:i.useFilter,termProcessor:a.getTermProcessorForCurrentProject()})},getDescription:function(e){return["The distribution bars show how many entities were completed within a given cycle time. ","The cumulative line shows how many days will it take to complete a ",e.getTerms("userStory").name.toLowerCase()," or other entity with the desired probability."].join("")}})}),define("tp/reports/model.report",["tp/reports/dataRepository","tau/components/extensions/component.extension.base"],function(e,t){function i(e){return function(t){return t[e]}}function n(e){return function(t){var i={id:t.id,data:t};for(var n in e)i[n]=e[n].map(t);
return i}}var a=new e({url:"/slice/v1/matrix/list"});return t.extend({_error:function(e){this.fire("afterLoad"),this.fire("report.error",JSON.parse(e.responseText))},_afterLoad:function(){this.fire("clearError"),this.fire("afterLoad")},_beforeLoad:function(){this.fire("beforeLoad")},"bus settings.changed":function(e,t){function r(e){return e.items[0].dynamic.items.map(i("data")).map(n(t.mapping))}function s(e){var t=!1;if(e.items.length>0){var i=e.items[0].fixed.items;t=i.length>0&&i.filter(function(e){return"cellpaging"==e.type}).length>0}return{hasMore:t}}function o(e,i){u.fire("data.ready",{data:e,metaData:i,settings:t}),u._afterLoad()}function l(e,t,i){a.get(e,function(n){t(e,n,i)},$.proxy(u._error,u),$.proxy(u._error,u))}this._beforeLoad();var u=this,c={page:function(e,t){o(r(t),s(t))},all:function(e,t,i){i=i||[],i=i.concat(r(t)),s(t).hasMore?(e.skip=e.skip||0,e.skip+=e.take,l(e,c.all,i)):o(i,null)}};l(t.parameters,c[t.strategy],null)}})}),define("template!tp/reports/cycleTimeDistribution/template.legend",["tau/core/templates-factory"],function(e){var t={name:"cycleTimeDistribution.legend",engine:"jqote2",customFunctions:null,markup:'<div class="_t3-chart-legend t3-cycle-time-distribution"> <div class="t3-item t3-x-axis"> <div class="t3-name">X-axis</div> <div class="t3-description">Cycle or Lead Time in days</div> </div> <div class="t3-item t3-y-axis"> <div class="t3-name">Y-axis</div> <div class="t3-description t3-completed-entities-amount">The completed entities in &percnt;</div> <div class="t3-description t3-completion-probability-amount">Completion probability in &percnt;</div> </div> <div class="t3-item t3-color"> <div class="t3-name">Color</div> <div class="t3-description">Entity type (<span class="t3-userstory tau-text_type_userstory"><%= this.usTerm %></span>, <span class="t3-bug tau-text_type_bug"><%= this.bugTerm%></span>, etc.)</div> </div> </div>'};return e.register(t)}),define("tp/reports/cycleTimeDistribution/extension.form",["Underscore","jQuery","tau/components/extensions/component.extension.base","template!tp/reports/cycleTimeDistribution/template.legend"],function(e,t,i,n){return i.extend({whenFilterResolved:function(e){var i=t.Deferred();
this.fire("filter.resolve",i),i.then(e)},whenTimeResolved:function(e){var i=t.Deferred();this.fire("time.resolve",i),i.then(e)},unbindSettings:function(){var e=this;e.whenFilterResolved(function(i){e.whenTimeResolved(function(n){e.fire("formData.changed",t.extend({time:n},i))})})},"bus afterRender + contextProvider.ready":function(e,t,i){var n=t.element;this.fire("$form.ready",n),this.fire("view.dom.ready",{$element:n,legend:this.getLegend(i)}),this.unbindSettings()},"bus filter.form.changed":function(){this.unbindSettings()},"bus time.form.changed":function(){this.unbindSettings()},getLegend:function(e){return n.render({usTerm:e.getTerms("userStory").name,bugTerm:e.getTerms("bug").name})}})}),define("tp/reports/extension.info",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({"bus view.dom.ready":function(t,i){var n=i.$element;n.find(".i-role-toggle-settings").on("click",e.bind(function(e){$(e.currentTarget).toggleClass("tau-checked");var t=$(e.currentTarget).hasClass("tau-checked");n.find(".i-role-settings").toggleClass("tau-chart-settings_hide",!t),this.fire("saveSetting",{isShowSettings:t})},this)),n.find(".i-role-toggle-legend").tauBubble({className:"tau-"+this.config.className+"-legend",stackName:"legend",onShow:function(){this.$target.addClass("tau-checked")},onHide:function(){this.$target.removeClass("tau-checked")},content:i.legend})}})}),define("tp/reports/chart.template.info",["tau/core/templates-factory"],function(e){var t={name:"chart.template.info",engine:"jqote2",markup:['       <div class="tau-chart-info">','           <div class="tau-chart-info-lcol">','               <div class="tau-chart-info-table">','                   <div class="tau-chart-info-lcell"><span class="tau-chart-info__name"><%=this.name%></span></div>','                   <div class="tau-chart-info-rcell"><span class="tau-chart-info__description"><%=this.description%></span></div>',"               </div>","           </div>",'           <div class="tau-chart-info-rcol"><button class="tau-btn i-role-toggle-legend"  type="button">Legend</button></div>','           <button class="tau-btn tau-chart-settings-toggle i-role-toggle-settings <%=(this.isShowSettings)?"tau-checked":""%>"  type="button">Chart settings</button>',"       </div>"],dependencies:[]};
return e.register(t)}),define("tp/reports/cycleTimeDistribution/component.report",["jQuery","Underscore","tp/reports/settings/type/config","tp/reports/settings/filter/config","tp/reports/settings/time/config","tau/components/component.creator","tp/reports/cycleTimeDistribution/extension.report","tp/reports/cycleTimeDistribution/model.settings","tp/reports/model.report","tp/reports/extension.context","tp/reports/cycleTimeDistribution/extension.form","tp/reports/extension.info","tp/reports/chart.template.info","tau/configurator"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f){return{create:function(e){var p=['<div class="tau-chart tau-cycle-time-distribution">',"   <div>",'       <%= fn.sub("chart.template.info", this) %> ','       <div class="tau-chart-settings  i-role-settings <%=(this.isShowSettings)?"":"tau-chart-settings_hide"%>">','           <div class="tau-chart-settings-controls">'];p=p.concat(f.getFeaturesService().isEnabled("tp2.application")?['              <div class="tau-section">','                   <%= fn.sub("report.time", [this.times]) %>','                   <%= fn.sub("report.type", { types: this.types, termProcessor: this.termProcessor }) %>',"               </div>",'              <div class="tau-section">','                   <%= fn.sub("report.filter", this) %>',"               </div>"]:['               <%= fn.sub("report.time", [this.times]) %>','               <%= fn.sub("report.type", { types: this.types, termProcessor: this.termProcessor }) %>','               <%= fn.sub("report.filter", this) %>']),p=p.concat(["           </div>","       </div>",'       <div class="tau-chart-plot">','           <div class="empty invisible">','               <div class="empty-text">','                   <div class="first-line">Not enough data to build this beautiful chart</div>','                   <div class="second-line">You need to have at least some of the work items completed</div>','                   <div class="second-line">Also, check if your filter is correct, and make sure that you\'ve<br /> actually selected some work item(s) in chart settings</div>',"               </div>","           </div>","           <svg>","          </svg>","      </div>","   </div>","</div>"]);
var m={extensions:t.flatten([e.extensions||[],i.extensions,n.extensions,a.extensions,[s,u,c,d,l,o.extend(e.modelOverride||{})]],!1),template:{engine:"jqote2",name:"reports-template",markup:p}};return e["queue.bus"]=!0,e.storageName="timeDistributionChart",e.className="cycle-time-distribution",r.create(m,e)}}}),define("tp/reports/processControl/chart.scatterplot",["jQuery","Underscore","libs/d3/d3","tp/reports/chart.behaviour"],function(e,t,i,n){var a=function(e,t,n,a){return function(r){var s=i.svg.line().x(function(e){return e[0]}).y(function(e){return e[1]});r.attr("d",s([[n[0],t],[e,t],[e,a[0]]])).attr("fill","none")}},r={mouseover:function(e,t){i.select(this).classed("hover",!0),i.select(t.placeholder).insert("path",":first-child").classed("highlighter",!0).classed(t.scales.stroke(e.stroke),!0).call(a(t.scales.x(e.x),t.scales.y(e.y),[t.scales.x.range()[0]-t.scales.axisMargin,t.scales.x.range()[1]],[t.scales.y.range()[0]+t.scales.axisMargin,t.scales.y.range()[1]]))},mouseout:function(e,t){i.select(this).classed("hover",!1),i.select(t.placeholder).selectAll("path.highlighter").remove()}};return n.extend({initHandlers:function(e){return e.concat(r)},data:function(e,t){i.select(t.placeholder).classed("_scatterPlot scatterPlot",!0);var n=i.select(t.placeholder).selectAll("circle").data(e.nodes,function(e){return e.id});n.enter().append("circle"),n.exit().remove(),n.attr("class",function(e){return t.scales.stroke(e.stroke)}).transition().attr("cx",function(e){return t.scales.x(e.x)}).attr("cy",function(e){return t.scales.y(e.y)}).attr("r",function(e){return e.r}).attr("data-id",function(e){return e.id}).attr("fill","none"),this._subscribe(n,["click","mouseover","mouseout"],t)}})}),define("tp/reports/processControl/chart.axes.format",["libs/d3/d3","tau/models/model.leadCycleTime"],function(e,t){function i(e){return function(t){for(var i=e.length-1,n=e[i];!n[1](t);)n=e[--i];return n[0](t)}}var n=function(e){return[[e.year,function(){return!0}],[e.month,function(e){return e.getMonth()
}],[e.date,function(e){return 1!=e.getDate()}],[e.day,function(e){return e.getDay()&&1!=e.getDate()}],[e.time,function(e){return e.getHours()}]]},a=i(n({year:e.time.format("%Y"),month:e.time.format("%b %Y"),date:e.time.format("%b %e %Y"),day:e.time.format("%b %e %Y"),time:e.time.format("%b %e %Y")})),r=i(n({year:e.time.format("%Y"),month:e.time.format("%b"),date:e.time.format("%b %e"),day:e.time.format("%a %e"),time:e.time.format("%I %p")})),s=new t({});return{time:function(e,t){return 0==t?a(e):r(e)},timerange:function(e,t,i){return function(n){return s.getTimeWithAbbreviation(n,e,t,i)}}}}),define("tp/reports/processControl/chart.axes",["libs/d3/d3","tp/reports/processControl/chart.axes.format","tp/reports/chart.axis"],function(e,t,i){var n=function(n){var a=i(n.scales.axisMargin).scale(n.scales.x).orient({type:"x-grid",height:n.scales.y.range()[0],margin:n.plot.margin,label:n.scales.x.label}).tickSubdivide(3).tickFormat(t.time);e.select(n.placeholder).classed("_x x",!0).call(a)},a=function(t){var n=i(t.scales.axisMargin).scale(t.scales.y).orient({type:"y-grid",width:t.scales.x.range()[1],margin:t.plot.margin,label:t.scales.y.label}).tickSubdivide(1);e.select(t.placeholder).classed("_y y",!0).call(n)};return{x:{render:n},y:{render:a}}}),define("tp/reports/processControl/behaviour.scatterplot.hover",["jQuery","libs/d3/d3","tp/reports/processControl/chart.axes.format"],function(e,t,i){return{create:function(n){var a=e('<div class="tau-chart-tooltip" style="position:absolute"></div>').appendTo(n.placeholder).tauBubble({content:"",className:"tau-chart-tooltip",onPositionConfig:function(e){e.my="left bottom"}});return a.on("show",function(e,n){var a=n.target.data("d");n.popup.find('[role="content"]').html("<div>"+a.data.name+"</div><div>"+i.timerange("d","h","min")(a.y)+", "+t.time.format("%d %b")(a.x)+"</div>")}),{mouseover:function(t){var i=e(this).offset();i.top+=1,i.left+=4,a.data("d",t),a.offset(i).tauBubble("show")},mouseout:function(){a.data("ui-tauBubble")&&a.tauBubble("hide")
}}}}}),define("tp/reports/processControl/behaviour.scatterplot.popup",[],function(){return{create:function(e){var t=e.navigator;return{click:function(e){var i=e.data;t.to(i.type+"/"+i.id)}}}}}),define("libs/jstat/jstat",[],function(){return this.j$=this.jStat=function(e){function t(){return new t.fn.init(arguments)}var i=Array.prototype.slice,n=Object.prototype.toString,a=function(t,i){var n=t>i?t:i;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))},r=Array.isArray||function(e){return"[object Array]"===n.call(e)},s=function(e){return"[object Function]"===n.call(e)},o=function(e){return"[object Number]"===n.call(e)&&!isNaN(e)},l=function(e){return[].concat.apply([],e)};return t.fn=t.prototype={constructor:t,init:function(e){var i=0;if(r(e[0]))if(r(e[0][0])){for(s(e[1])&&(e[0]=t.map(e[0],e[1]));i<e[0].length;i++)this[i]=e[0][i];this.length=e[0].length}else this[0]=s(e[1])?t.map(e[0],e[1]):e[0],this.length=1;else if(o(e[0]))this[0]=t.seq.apply(null,e),this.length=1;else{if(e[0]instanceof t)return t(e[0].toArray());this[0]=[],this.length=1}return this},length:0,toArray:function(){return this.length>1?i.call(this):i.call(this)[0]},push:[].push,sort:[].sort,splice:[].splice,slice:[].slice},t.fn.init.prototype=t.fn,t.utils={calcRdx:a,isArray:r,isFunction:s,isNumber:o,toVector:l},t.extend=function(e){var n,a=i.call(arguments),r=1;if(1===a.length){for(n in e)t[n]=e[n];return this}for(;r<a.length;r++)for(n in a[r])e[n]=a[r][n];return e},t.extend({rows:function(e){return e.length||1},cols:function(e){return e[0].length||1},dimensions:function(e){return{rows:t.rows(e),cols:t.cols(e)}},row:function(e,t){return e[t]},col:function(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=[e[n][t]];return i},diag:function(e){for(var i=0,n=t.rows(e),a=new Array(n);n>i;i++)a[i]=[e[i][i]];return a},antidiag:function(e){for(var i=t.rows(e)-1,n=new Array(i),a=0;i>=0;i--,a++)n[a]=[e[a][i]];return n},transpose:function(e){var t,i,n,a=[],s=0;for(r(e[0])||(e=[e]),t=e.length,i=e[0].length;i>s;s++)for(a.push(new Array(t)),n=0;t>n;n++)a[s][n]=e[n][s];
return 1===a.length?a[0]:a},map:function(e,t,i){var n,a,s,o,l=0;for(r(e[0])||(e=[e]),n=e.length,a=e[0].length,s=i?e:new Array(n);n>l;l++)for(s[l]||(s[l]=new Array(a)),o=0;a>o;o++)s[l][o]=t(e[l][o],l,o);return 1===s.length?s[0]:s},alter:function(e,i){return t.map(e,i,!0)},create:function(e,t,i){var n,a,r=new Array(e);for(s(t)&&(i=t,t=e),n=0;e>n;n++)for(r[n]=new Array(t),a=0;t>a;a++)r[n][a]=i(n,a);return r},zeros:function(e,i){return o(i)||(i=e),t.create(e,i,function(){return 0})},ones:function(e,i){return o(i)||(i=e),t.create(e,i,function(){return 1})},rand:function(i,n){return o(n)||(n=i),t.create(i,n,function(){return e.random()})},identity:function(e,i){return o(i)||(i=e),t.create(e,i,function(e,t){return e===t?1:0})},symmetric:function(e){var t,i=0,n=e.length;if(e.length!==e[0].length)return!1;for(;n>i;i++)for(t=0;n>t;t++)if(e[t][i]!==e[i][t])return!1;return!0},clear:function(e){return t.alter(e,function(){return 0})},seq:function(e,t,i,n){s(n)||(n=!1);for(var r=[],o=a(e,t),l=(t*o-e*o)/((i-1)*o),u=e,c=0;t>=u;c++,u=(e*o+l*o*c)/o)r.push(n?n(u,c):u);return r}}),function(e){for(var i=0;i<e.length;i++)(function(e){t.fn[e]=function(i){var n,a=this;return i?(setTimeout(function(){i.call(a,t.fn[e].call(a))},15),this):(n=t[e](this),r(n)?t(n):n)}})(e[i])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var i=0;i<e.length;i++)(function(e){t.fn[e]=function(i,n){var a=this;return n?(setTimeout(function(){n.call(a,t.fn[e].call(a,i))},15),this):t(t[e](this,i))}})(e[i])}("row col".split(" ")),function(e){for(var i=0;i<e.length;i++)(function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}})(e[i])}("create zeros ones rand identity".split(" ")),t.extend(t.fn,{map:function(e,i){return t(t.map(this,e,i))},alter:function(e){return t.alter(this,e),this}}),t}(Math),function(e,t){!function(t){for(var i=0;i<t.length;i++)(function(t){e[t]=function(e,t,i){return this instanceof arguments.callee?(this._a=e,this._b=t,this._c=i,this):new arguments.callee(e,t,i)
},e.fn[t]=function(i,n,a){var r=e[t](i,n,a);return r.data=this,r},e[t].prototype.sample=function(i){var n=this._a,a=this._b,r=this._c;return i?e.alter(i,function(){return e[t].sample(n,a,r)}):e[t].sample(n,a,r)},function(i){for(var n=0;n<i.length;n++)(function(i){e[t].prototype[i]=function(n){var a=this._a,r=this._b,s=this._c;return n||(n=this.data),"number"!=typeof n?e.fn.map.call(n,function(n){return e[t][i](n,a,r,s)}):e[t][i](n,a,r,s)}})(i[n])}("pdf cdf inv".split(" ")),function(i){for(var n=0;n<i.length;n++)(function(i){e[t].prototype[i]=function(){return e[t][i](this._a,this._b,this._c)}})(i[n])}("mean median mode variance".split(" "))})(t[i])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),e.extend(e.beta,{pdf:function(i,n,a){return i>1||0>i?0:t.pow(i,n-1)*t.pow(1-i,a-1)/e.betafn(n,a)},cdf:function(t,i,n){return t>1||0>t?1*(t>1):e.ibeta(t,i,n)},inv:function(t,i,n){return e.ibetainv(t,i,n)},mean:function(e,t){return e/(e+t)},median:function(){},mode:function(e,i){return e*i/(t.pow(e+i,2)*(e+i+1))},sample:function(t,i){var n=e.randg(t);return n/(n+e.randg(i))},variance:function(e,i){return e*i/(t.pow(e+i,2)*(e+i+1))}}),e.extend(e.centralF,{pdf:function(i,n,a){return i>=0?t.sqrt(t.pow(n*i,n)*t.pow(a,a)/t.pow(n*i+a,n+a))/(i*e.betafn(n/2,a/2)):void 0},cdf:function(t,i,n){return e.ibeta(i*t/(i*t+n),i/2,n/2)},inv:function(t,i,n){return n/(i*(1/e.ibetainv(t,i/2,n/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,i){var n=2*e.randg(t/2),a=2*e.randg(i/2);return n/t/(a/i)},variance:function(e,t){return t>4?2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4)):void 0}}),e.extend(e.cauchy,{pdf:function(e,i,n){return n/(t.pow(e-i,2)+t.pow(n,2))/t.PI},cdf:function(e,i,n){return t.atan((e-i)/n)/t.PI+.5},inv:function(e,i,n){return i+n*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e
},sample:function(i,n){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*n+i}}),e.extend(e.chisquare,{pdf:function(i,n){return t.exp((n/2-1)*t.log(i)-i/2-n/2*t.log(2)-e.gammaln(n/2))},cdf:function(t,i){return e.gammap(i/2,t/2)},inv:function(t,i){return 2*e.gammapinv(t,.5*i)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,i){return 0>e?0:i*t.exp(-i*e)},cdf:function(e,i){return 0>e?0:1-t.exp(-i*e)},inv:function(e,i){return-t.log(1-e)/i},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(e){return-1/e*t.log(t.random())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(i,n,a){return t.exp((n-1)*t.log(i)-i/a-e.gammaln(n)-n*t.log(a))},cdf:function(t,i,n){return e.gammap(i,t/n)},inv:function(t,i,n){return e.gammapinv(t,i)*n},mean:function(e,t){return e*t},mode:function(e,t){return e>1?(e-1)*t:void 0},sample:function(t,i){return e.randg(t)*i},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(i,n,a){return t.exp(-(n+1)*t.log(i)-a/i-e.gammaln(n)+n*t.log(a))},cdf:function(t,i,n){return 1-e.gammap(i,n/t)},inv:function(t,i,n){return n/e.gammapinv(1-t,i)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,i){return i/e.randg(t)},variance:function(e,t){return e>2?t*t/((e-1)*(e-1)*(e-2)):void 0}}),e.extend(e.kumaraswamy,{pdf:function(e,i,n){return t.exp(t.log(i)+t.log(n)+(i-1)*t.log(e)+(n-1)*t.log(1-t.pow(e,i)))},cdf:function(e,i,n){return 1-t.pow(1-t.pow(e,i),n)},mean:function(t,i){return i*e.gammafn(1+1/t)*e.gammafn(i)/e.gammafn(1+1/t+i)},median:function(e,i){return t.pow(1-t.pow(2,-1/i),1/e)},mode:function(e,i){return e>=1&&i>=1&&1!==e&&1!==i?t.pow((e-1)/(e*i-1),1/e):void 0},variance:function(){}}),e.extend(e.lognormal,{pdf:function(e,i,n){return t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(n)-t.pow(t.log(e)-i,2)/(2*n*n))
},cdf:function(i,n,a){return.5+.5*e.erf((t.log(i)-n)/t.sqrt(2*a*a))},inv:function(i,n,a){return t.exp(-1.4142135623730951*a*e.erfcinv(2*i)+n)},mean:function(e,i){return t.exp(e+i*i/2)},median:function(e){return t.exp(e)},mode:function(e,i){return t.exp(e-i*i)},sample:function(i,n){return t.exp(e.randn()*n+i)},variance:function(e,i){return(t.exp(i*i)-1)*t.exp(2*e+i*i)}}),e.extend(e.normal,{pdf:function(e,i,n){return t.exp(-.5*t.log(2*t.PI)-t.log(n)-t.pow(e-i,2)/(2*n*n))},cdf:function(i,n,a){return.5*(1+e.erf((i-n)/t.sqrt(2*a*a)))},inv:function(t,i,n){return-1.4142135623730951*n*e.erfcinv(2*t)+i},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,i){return e.randn()*i+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,i,n){return e>i?n*t.pow(i,n)/t.pow(e,n+1):void 0},cdf:function(e,i,n){return 1-t.pow(i/e,n)},mean:function(e,i){return i>1?i*t.pow(e,i)/(i-1):void 0},median:function(e,i){return e*i*t.SQRT2},mode:function(e){return e},variance:function(e,i){return i>2?e*e*i/(t.pow(i-1,2)*(i-2)):void 0}}),e.extend(e.studentt,{pdf:function(i,n){return e.gammafn((n+1)/2)/(t.sqrt(n*t.PI)*e.gammafn(n/2))*t.pow(1+i*i/n,-((n+1)/2))},cdf:function(i,n){var a=n/2;return e.ibeta((i+t.sqrt(i*i+n))/(2*t.sqrt(i*i+n)),a,a)},inv:function(i,n){var a=e.ibetainv(2*t.min(i,1-i),.5*n,.5);return a=t.sqrt(n*(1-a)/a),i>0?a:-a},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(i){return e.randn()*t.sqrt(i/(2*e.randg(i/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,i,n){return 0>e?0:n/i*t.pow(e/i,n-1)*t.exp(-t.pow(e/i,n))},cdf:function(e,i,n){return 0>e?0:1-t.exp(-t.pow(e/i,n))},inv:function(e,i,n){return i*t.pow(-t.log(1-e),1/n)},mean:function(t,i){return t*e.gammafn(1+1/i)},median:function(e,i){return e*t.pow(t.log(2),1/i)},mode:function(e,i){return i>1?e*t.pow((i-1)/i,1/i):void 0},sample:function(e,i){return e*t.pow(-t.log(t.random()),1/i)
},variance:function(i,n){return i*i*e.gammafn(1+2/n)-t.pow(this.mean(i,n),2)}}),e.extend(e.uniform,{pdf:function(e,t,i){return t>e||e>i?0:1/(i-t)},cdf:function(e,t,i){return t>e?0:i>e?(e-t)/(i-t):1},mean:function(e,t){return.5*(e+t)},median:function(t,i){return e.mean(t,i)},mode:function(){},sample:function(e,i){return e/2+i/2+(i/2-e/2)*(2*t.random()-1)},variance:function(e,i){return t.pow(i-e,2)/12}}),e.extend(e.binomial,{pdf:function(i,n,a){return 0===a||1===a?n*a===i?1:0:e.combination(n,i)*t.pow(a,i)*t.pow(1-a,n-i)},cdf:function(t,i,n){var a=[],r=0;if(0>t)return 0;if(i>t){for(;t>=r;r++)a[r]=e.binomial.pdf(r,i,n);return e.sum(a)}return 1}}),e.extend(e.negbin,{pdf:function(i,n,a){return i!==i|0?!1:0>i?0:e.combination(i+n-1,i)*t.pow(1-a,n)*t.pow(a,i)},cdf:function(t,i,n){var a=0,r=0;if(0>t)return 0;for(;t>=r;r++)a+=e.negbin.pdf(r,i,n);return a}}),e.extend(e.hypgeom,{pdf:function(t,i,n,a){return t!==t|0?!1:0>t?0:e.combination(n,t)*e.combination(i-n,a-t)/e.combination(i,a)},cdf:function(t,i,n,a){var r=0,s=0;if(0>t)return 0;for(;t>=s;s++)r+=e.hypgeom.pdf(s,i,n,a);return r}}),e.extend(e.poisson,{pdf:function(i,n){return t.pow(n,i)*t.exp(-n)/e.factorial(i)},cdf:function(t,i){var n=[],a=0;if(0>t)return 0;for(;t>=a;a++)n.push(e.poisson.pdf(a,i));return e.sum(n)},mean:function(e){return e},variance:function(e){return e},sample:function(e){var i=1,n=0,a=t.exp(-e);do n++,i*=t.random();while(i>a);return n-1}}),e.extend(e.triangular,{pdf:function(e,t,i,n){return t>=i||t>n||n>i?void 0:t>e||e>i?0:n>=e?2*(e-t)/((i-t)*(n-t)):2*(i-e)/((i-t)*(i-n))},cdf:function(e,i,n,a){return i>=n||i>a||a>n?void 0:i>e?0:a>=e?t.pow(e-i,2)/((n-i)*(a-i)):1-t.pow(n-e,2)/((n-i)*(n-a))},mean:function(e,t,i){return(e+t+i)/3},median:function(e,i,n){return(e+i)/2>=n?i-t.sqrt((i-e)*(i-n))/t.sqrt(2):n>(e+i)/2?e+t.sqrt((i-e)*(n-e))/t.sqrt(2):void 0},mode:function(e,t,i){return i},sample:function(e,i,n){var a=t.random();return(n-e)/(i-e)>a?e+t.sqrt(a*(i-e)*(n-e)):i-t.sqrt((1-a)*(i-e)*(i-n))},variance:function(e,t,i){return(e*e+t*t+i*i-e*t-e*i-t*i)/18
}})}(this.jStat,Math),function(e,t){var i=Array.prototype.push,n=e.utils.isArray;e.extend({add:function(t,i){return n(i)?(n(i[0])||(i=[i]),e.map(t,function(e,t,n){return e+i[t][n]})):e.map(t,function(e){return e+i})},subtract:function(t,i){return n(i)?(n(i[0])||(i=[i]),e.map(t,function(e,t,n){return e-i[t][n]||0})):e.map(t,function(e){return e-i})},divide:function(t,i){return n(i)?(n(i[0])||(i=[i]),e.multiply(t,e.inv(i))):e.map(t,function(e){return e/i})},multiply:function(t,i){var a,r,s,o,l=t.length,u=t[0].length,c=e.zeros(l,s=n(i)?i[0].length:u),d=0;if(n(i)){for(;s>d;d++)for(a=0;l>a;a++){for(o=0,r=0;u>r;r++)o+=t[a][r]*i[r][d];c[a][d]=o}return 1===l&&1===d?c[0][0]:c}return e.map(t,function(e){return e*i})},dot:function(t,i){n(t[0])||(t=[t]),n(i[0])||(i=[i]);for(var a,r,s=1===t[0].length&&1!==t.length?e.transpose(t):t,o=1===i[0].length&&1!==i.length?e.transpose(i):i,l=[],u=0,c=s.length,d=s[0].length;c>u;u++){for(l[u]=[],a=0,r=0;d>r;r++)a+=s[u][r]*o[u][r];l[u]=a}return 1===l.length?l[0]:l},pow:function(i,n){return e.map(i,function(e){return t.pow(e,n)})},abs:function(i){return e.map(i,function(e){return t.abs(e)})},norm:function(e,i){var a=0,r=0;for(isNaN(i)&&(i=2),n(e[0])&&(e=e[0]);r<e.length;r++)a+=t.pow(t.abs(e[r]),i);return t.pow(a,1/i)},angle:function(i,n){return t.acos(e.dot(i,n)/(e.norm(i)*e.norm(n)))},aug:function(e,t){for(var n=e.slice(),a=0;a<n.length;a++)i.apply(n[a],t[a]);return n},inv:function(t){for(var i,n=t.length,a=t[0].length,r=e.identity(n,a),s=e.gauss_jordan(t,r),o=[],l=0;n>l;l++)for(o[l]=[],i=a-1;i<s[0].length;i++)o[l][i-a]=s[l][i];return o},det:function(e){var t,i=e.length,n=2*i,a=new Array(n),r=i-1,s=n-1,o=r-i+1,l=s,u=0,c=0;if(2===i)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;n>u;u++)a[u]=1;for(u=0;i>u;u++){for(t=0;i>t;t++)a[0>o?o+i:o]*=e[u][t],a[i>l?l+i:l]*=e[u][t],o++,l--;o=--r-i+1,l=--s}for(u=0;i>u;u++)c+=a[u];for(;n>u;u++)c-=a[u];return c},gauss_elimination:function(i,n){var a,r,s,o,l=0,u=0,c=i.length,d=i[0].length,p=1,f=0,m=[];for(i=e.aug(i,n),a=i[0].length;c>l;l++){for(r=i[l][l],u=l,o=l+1;d>o;o++)r<t.abs(i[o][l])&&(r=i[o][l],u=o);
if(u!=l)for(o=0;a>o;o++)s=i[l][o],i[l][o]=i[u][o],i[u][o]=s;for(u=l+1;c>u;u++)for(p=i[u][l]/i[l][l],o=l;a>o;o++)i[u][o]=i[u][o]-p*i[l][o]}for(l=c-1;l>=0;l--){for(f=0,u=l+1;c-1>=u;u++)f=m[u]*i[l][u];m[l]=(i[l][a-1]-f)/i[l][l]}return m},gauss_jordan:function(i,n){for(var a=e.aug(i,n),r=a.length,s=a[0].length,o=0;r>o;o++){for(var l=o,u=o+1;r>u;u++)t.abs(a[u][o])>t.abs(a[l][o])&&(l=u);var d=a[o];a[o]=a[l],a[l]=d;for(var u=o+1;r>u;u++){c=a[u][o]/a[o][o];for(var p=o;s>p;p++)a[u][p]-=a[o][p]*c}}for(var o=r-1;o>=0;o--){c=a[o][o];for(var u=0;o>u;u++)for(var p=s-1;p>o-1;p--)a[u][p]-=a[o][p]*a[u][o]/c;a[o][o]/=c;for(var p=r;s>p;p++)a[o][p]/=c}return a},lu:function(){},cholesky:function(){},gauss_jacobi:function(i,n,a,r){for(var s,o,l,u,c=0,d=0,p=i.length,f=[],m=[],h=[];p>c;c++)for(f[c]=[],m[c]=[],h[c]=[],d=0;p>d;d++)c>d?(f[c][d]=i[c][d],m[c][d]=h[c][d]=0):d>c?(m[c][d]=i[c][d],f[c][d]=h[c][d]=0):(h[c][d]=i[c][d],f[c][d]=m[c][d]=0);for(l=e.multiply(e.multiply(e.inv(h),e.add(f,m)),-1),o=e.multiply(e.inv(h),n),s=a,u=e.add(e.multiply(l,a),o),c=2;t.abs(e.norm(e.subtract(u,s)))>r;)s=u,u=e.add(e.multiply(l,s),o),c++;return u},gauss_seidel:function(i,n,a,r){for(var s,o,l,u,c,d=0,p=i.length,f=[],m=[],h=[];p>d;d++)for(f[d]=[],m[d]=[],h[d]=[],s=0;p>s;s++)d>s?(f[d][s]=i[d][s],m[d][s]=h[d][s]=0):s>d?(m[d][s]=i[d][s],f[d][s]=h[d][s]=0):(h[d][s]=i[d][s],f[d][s]=m[d][s]=0);for(u=e.multiply(e.multiply(e.inv(e.add(h,f)),m),-1),l=e.multiply(e.inv(e.add(h,f)),n),o=a,c=e.add(e.multiply(u,a),l),d=2;t.abs(e.norm(e.subtract(c,o)))>r;)o=c,c=e.add(e.multiply(u,o),l),d+=1;return c},SOR:function(i,n,a,r,s){for(var o,l,u,c,d,p=0,f=i.length,m=[],h=[],g=[];f>p;p++)for(m[p]=[],h[p]=[],g[p]=[],o=0;f>o;o++)p>o?(m[p][o]=i[p][o],h[p][o]=g[p][o]=0):o>p?(h[p][o]=i[p][o],m[p][o]=g[p][o]=0):(g[p][o]=i[p][o],m[p][o]=h[p][o]=0);for(c=e.multiply(e.inv(e.add(g,e.multiply(m,s))),e.subtract(e.multiply(g,1-s),e.multiply(h,s))),u=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(m,s))),n),s),l=a,d=e.add(e.multiply(c,a),u),p=2;t.abs(e.norm(e.subtract(d,l)))>r;)l=d,d=e.add(e.multiply(c,l),u),p++;
return d},householder:function(i){for(var n,a,r,s,o,l=i.length,u=i[0].length,c=0,d=[],p=[];l-1>c;c++){for(n=0,s=c+1;u>s;s++)n+=i[s][c]*i[s][c];for(o=i[c+1][c]>0?-1:1,n=o*t.sqrt(n),a=t.sqrt((n*n-i[c+1][c]*n)/2),d=e.zeros(l,1),d[c+1][0]=(i[c+1][c]-n)/(2*a),r=c+2;l>r;r++)d[r][0]=i[r][c]/(2*a);p=e.subtract(e.identity(l,u),e.multiply(e.multiply(d,e.transpose(d)),2)),i=e.multiply(p,e.multiply(i,p))}return i},QR:function(i,n){for(var a,r,s,o,l,u,c=i.length,d=i[0].length,p=0,f=[],m=[],h=[];c-1>p;p++){for(r=0,a=p+1;d>a;a++)r+=i[a][p]*i[a][p];for(l=i[p+1][p]>0?-1:1,r=l*t.sqrt(r),s=t.sqrt((r*r-i[p+1][p]*r)/2),f=e.zeros(c,1),f[p+1][0]=(i[p+1][p]-r)/(2*s),o=p+2;c>o;o++)f[o][0]=i[o][p]/(2*s);m=e.subtract(e.identity(c,d),e.multiply(e.multiply(f,e.transpose(f)),2)),i=e.multiply(m,i),n=e.multiply(m,n)}for(p=c-1;p>=0;p--){for(u=0,a=p+1;d-1>=a;a++)u=h[a]*i[p][a];h[p]=n[p][0]/i[p][p]}return h},jacobi:function(i){for(var n,a,r,s,o,l,u,c,d=1,p=0,f=i.length,m=e.identity(f,f),h=[];1===d;){for(p++,l=i[0][1],s=0,o=1,a=0;f>a;a++)for(r=0;f>r;r++)a!=r&&l<t.abs(i[a][r])&&(l=t.abs(i[a][r]),s=a,o=r);for(u=i[s][s]===i[o][o]?i[s][o]>0?t.PI/4:-t.PI/4:t.atan(2*i[s][o]/(i[s][s]-i[o][o]))/2,c=e.identity(f,f),c[s][s]=t.cos(u),c[s][o]=-t.sin(u),c[o][s]=t.sin(u),c[o][o]=t.cos(u),m=e.multiply(m,c),n=e.multiply(e.multiply(e.inv(c),i),c),i=n,d=0,a=1;f>a;a++)for(r=1;f>r;r++)a!=r&&t.abs(i[a][r])>.001&&(d=1)}for(a=0;f>a;a++)h.push(i[a][a]);return[m,h]},rungekutta:function(e,t,i,n,a,r){var s,o,l,u,c;if(2===r)for(;i>=n;)s=t*e(n,a),o=t*e(n+t,a+s),l=a+(s+o)/2,a=l,n+=t;if(4===r)for(;i>=n;)s=t*e(n,a),o=t*e(n+t/2,a+s/2),u=t*e(n+t/2,a+o/2),c=t*e(n+t,a+u),l=a+(s+2*o+2*u+c)/6,a=l,n+=t;return a},romberg:function(e,i,n,a){for(var r,s,o,l,u,c=0,d=(n-i)/2,p=[],f=[],m=[];a/2>c;){for(u=e(i),o=i,l=0;n>=o;o+=d,l++)p[l]=o;for(r=p.length,o=1;r-1>o;o++)u+=(o%2!==0?4:2)*e(p[o]);u=d/3*(u+e(n)),m[c]=u,d/=2,c++}for(s=m.length,r=1;1!==s;){for(o=0;s-1>o;o++)f[o]=(t.pow(4,r)*m[o+1]-m[o])/(t.pow(4,r)-1);s=f.length,m=f,f=[],r++}return m},richardson:function(e,i,n,a){function r(e,t){for(var i,n=0,a=e.length;a>n;n++)e[n]===t&&(i=n);
return i}for(var s,o,l,u,c,d=(e.length,t.abs(n-e[r(e,n)+1])),p=0,f=[],m=[];a>=d;)s=r(e,n+a),o=r(e,n),f[p]=(i[s]-2*i[o]+i[2*o-s])/(a*a),a/=2,p++;for(u=f.length,l=1;1!=u;){for(c=0;u-1>c;c++)m[c]=(t.pow(4,l)*f[c+1]-f[c])/(t.pow(4,l)-1);u=m.length,f=m,m=[],l++}return f},simpson:function(e,t,i,n){for(var a,r=(i-t)/n,s=e(t),o=[],l=t,u=0,c=1;i>=l;l+=r,u++)o[u]=l;for(a=o.length;a-1>c;c++)s+=(c%2!==0?4:2)*e(o[c]);return r/3*(s+e(i))},hermite:function(e,t,i,n){for(var a,r=e.length,s=0,o=0,l=[],u=[],c=[],d=[];r>o;o++){for(l[o]=1,a=0;r>a;a++)o!=a&&(l[o]*=(n-e[a])/(e[o]-e[a]));for(u[o]=0,a=0;r>a;a++)o!=a&&(u[o]+=1/(e[o]-e[a]));c[o]=(1-2*(n-e[o])*u[o])*l[o]*l[o],d[o]=(n-e[o])*l[o]*l[o],s+=c[o]*t[o]+d[o]*i[o]}return s},lagrange:function(e,t,i){for(var n,a,r=0,s=0,o=e.length;o>s;s++){for(a=t[s],n=0;o>n;n++)s!=n&&(a*=(i-e[n])/(e[s]-e[n]));r+=a}return r},cubic_spline:function(t,i,n){for(var a,r=t.length,s=0,o=[],l=[],u=[],c=[],d=[],p=[],f=[];r-1>s;s++)d[s]=t[s+1]-t[s];for(u[0]=0,s=1;r-1>s;s++)u[s]=3/d[s]*(i[s+1]-i[s])-3/d[s-1]*(i[s]-i[s-1]);for(s=1;r-1>s;s++)o[s]=[],l[s]=[],o[s][s-1]=d[s-1],o[s][s]=2*(d[s-1]+d[s]),o[s][s+1]=d[s],l[s][0]=u[s];for(c=e.multiply(e.inv(o),l),a=0;r-1>a;a++)p[a]=(i[a+1]-i[a])/d[a]-d[a]*(c[a+1][0]+2*c[a][0])/3,f[a]=(c[a+1][0]-c[a][0])/(3*d[a]);for(a=0;r>a&&!(t[a]>n);a++);return a-=1,i[a]+(n-t[a])*p[a]+e.sq(n-t[a])*c[a]+(n-t[a])*e.sq(n-t[a])*f[a]},gauss_quadrature:function(){},PCA:function(t){var i,n,a=t.length,r=t[0].length,s=0,o=[],l=[],u=[],c=[],d=[],p=[],f=[],m=[],h=[],g=[];for(s=0;a>s;s++)o[s]=e.sum(t[s])/r;for(s=0;r>s;s++)for(f[s]=[],i=0;a>i;i++)f[s][i]=t[i][s]-o[i];for(f=e.transpose(f),s=0;a>s;s++)for(m[s]=[],i=0;a>i;i++)m[s][i]=e.dot([f[s]],[f[i]])/(r-1);for(u=e.jacobi(m),h=u[0],l=u[1],g=e.transpose(h),s=0;s<l.length;s++)for(i=s;i<l.length;i++)l[s]<l[i]&&(n=l[s],l[s]=l[i],l[i]=n,c=g[s],g[s]=g[i],g[i]=c);for(p=e.transpose(f),s=0;a>s;s++)for(d[s]=[],i=0;i<p.length;i++)d[s][i]=e.dot([g[s]],[p[i]]);return[t,l,g,d]}}),function(t){for(var i=0;i<t.length;i++)(function(t){e.fn[t]=function(i,n){var a=this;
return n?(setTimeout(function(){n.call(a,e.fn[t].call(a,i))},15),this):e(e[t](this,i))}})(t[i])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),jStat.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;t++){var i=[1];e[t]=i.concat(arguments[t])}return jStat(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var i=[1];e[t]=i.concat(arguments[0][t])}return jStat(e)},buildjxmatrix:function(e){for(var t=new Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return jStat.builddxmatrix(t)},buildymatrix:function(e){return jStat(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,t){if(e.cols()==t.rows()){if(t.rows()>1){for(var i=[],n=0;n<e.rows();n++){i[n]=[];for(var a=0;a<t.cols();a++){for(var r=0,s=0;s<e.cols();s++)r+=e.toArray()[n][s]*t.toArray()[s][a];i[n][a]=r}}return jStat(i)}for(var i=[],n=0;n<e.rows();n++){i[n]=[];for(var a=0;a<t.cols();a++){for(var r=0,s=0;s<e.cols();s++)r+=e.toArray()[n][s]*t.toArray()[a];i[n][a]=r}}return jStat(i)}},regress:function(e,t){var i=jStat.xtranspxinv(e),n=e.transpose(),a=jStat.matrixmult(jStat(i),n);return jStat.matrixmult(a,t)},regresst:function(e,t,i){var n=jStat.regress(e,t),a={};a.anova={};var r=jStat.jMatYBar(e,n);a.yBar=r;var s=t.mean();a.anova.residuals=jStat.residuals(t,r),a.anova.ssr=jStat.ssr(r,s),a.anova.msr=a.anova.ssr/(e[0].length-1),a.anova.sse=jStat.sse(t,r),a.anova.mse=a.anova.sse/(t.length-(e[0].length-1)-1),a.anova.sst=jStat.sst(t,s),a.anova.mst=a.anova.sst/(t.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=jStat.anovaftest(a.anova.fratio,e[0].length-1,t.length-(e[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(e[0].length);for(var o,l,u,c=jStat.xtranspxinv(e),d=0;d<n.length;d++)o=Math.sqrt(a.anova.mse*Math.abs(c[d][d])),l=Math.abs(n[d]/o),u=jStat.ttest(l,t.length-e[0].length-1,i),a.stats[d]=[n[d],o,l,u];
return a.regress=n,a},xtranspx:function(e){return jStat.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var t=jStat.matrixmult(e.transpose(),e),i=jStat.inv(t);return i},jMatYBar:function(e,t){var i=jStat.matrixmult(e,t);return new jStat(i)},residuals:function(e,t){return jStat.matrixsubtract(e,t)},ssr:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t,2);return i},sse:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t[n],2);return i},sst:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t,2);return i},matrixsubtract:function(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++){i[n]=new Array(e[n].length);for(var a=0;a<e[n].length;a++)i[n][a]=e[n][a]-t[n][a]}return jStat(i)}}),function(e,t){e.extend({gammaln:function(e){var i,n,a,r=0,s=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015;for(a=(n=i=e)+5.5,a-=(i+.5)*t.log(a);6>r;r++)o+=s[r]/++n;return t.log(2.5066282746310007*o/i)-a},gammafn:function(e){var i,n,a,r,s=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],o=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,c=0,d=0,p=e;if(0>=p){if(r=p%1+3.6e-16,!r)return 1/0;l=(1&p?-1:1)*t.PI/t.sin(t.PI*r),p=1-p}for(a=p,n=1>p?p++:(p-=u=(0|p)-1)-1,i=0;8>i;++i)d=(d+s[i])*n,c=c*n+o[i];if(r=d/c+1,p>a)r/=a;else if(a>p)for(i=0;u>i;++i)r*=p,p++;return l&&(r=l/r),r},gammap:function(i,n){var a,r=e.gammaln(i),s=i,o=1/i,l=o,u=n+1-i,c=1/1e-30,d=1/u,p=d,f=1,m=-~(8.5*t.log(i>=1?i:1/i)+.4*i+17);if(0>n||0>=i)return 0/0;if(i+1>n){for(;m>=f;f++)o+=l*=n/++s;return o*t.exp(-n+i*t.log(n)-r)}for(;m>=f;f++)a=-f*(f-i),u+=2,d=a*d+u,c=u+a/c,d=1/d,p*=d*c;return 1-p*t.exp(-n+i*t.log(n)-r)},factorialln:function(t){return 0>t?0/0:e.gammaln(t+1)},factorial:function(t){return 0>t?0/0:e.gammafn(t+1)
},combination:function(i,n){return i>170||n>170?t.exp(e.combinationln(i,n)):e.factorial(i)/e.factorial(n)/e.factorial(i-n)},combinationln:function(t,i){return e.factorialln(t)-e.factorialln(i)-e.factorialln(t-i)},permutation:function(t,i){return e.factorial(t)/e.factorial(t-i)},betafn:function(i,n){return 0>=i||0>=n?void 0:i+n>170?t.exp(e.betaln(i,n)):e.gammafn(i)*e.gammafn(n)/e.gammafn(i+n)},betaln:function(t,i){return e.gammaln(t)+e.gammaln(i)-e.gammaln(t+i)},betacf:function(e,i,n){var a,r,s,o,l,u,c,d,p,f=1e-30,m=1;for(c=i+n,p=i+1,d=i-1,s=1,o=1-c*e/p,t.abs(o)<f&&(o=f),o=1/o,u=o;100>=m&&(a=2*m,r=m*(n-m)*e/((d+a)*(i+a)),o=1+r*o,t.abs(o)<f&&(o=f),s=1+r/s,t.abs(s)<f&&(s=f),o=1/o,u*=o*s,r=-(i+m)*(c+m)*e/((i+a)*(p+a)),o=1+r*o,t.abs(o)<f&&(o=f),s=1+r/s,t.abs(s)<f&&(s=f),o=1/o,l=o*s,u*=l,!(t.abs(l-1)<3e-7));m++);return u},gammapinv:function(i,n){var a,r,s,o,l,u,c,d=0,p=n-1,f=1e-8,m=e.gammaln(n);if(i>=1)return t.max(100,n+100*t.sqrt(n));if(0>=i)return 0;for(n>1?(u=t.log(p),c=t.exp(p*(u-1)-m),l=.5>i?i:1-i,s=t.sqrt(-2*t.log(l)),a=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,.5>i&&(a=-a),a=t.max(.001,n*t.pow(1-1/(9*n)-a/(3*t.sqrt(n)),3))):(s=1-n*(.253+.12*n),a=s>i?t.pow(i/s,1/n):1-t.log(1-(i-s)/(1-s)));12>d;d++){if(0>=a)return 0;if(r=e.gammap(n,a)-i,s=n>1?c*t.exp(-(a-p)+p*(t.log(a)-u)):t.exp(-a+p*t.log(a)-m),o=r/s,a-=s=o/(1-.5*t.min(1,o*((n-1)/a-1))),0>=a&&(a=.5*(a+s)),t.abs(s)<f*a)break}return a},erf:function(e){var i,n,a,r,s=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],o=s.length-1,l=!1,u=0,c=0;for(0>e&&(e=-e,l=!0),i=2/(2+e),n=4*i-2;o>0;o--)a=u,u=n*u-c+s[o],c=a;return r=i*t.exp(-e*e+.5*(s[0]+n*u)-c),l?r-1:1-r
},erfc:function(t){return 1-e.erf(t)},erfcinv:function(i){var n,a,r,s,o=0;if(i>=2)return-100;if(0>=i)return 100;for(s=1>i?i:2-i,r=t.sqrt(-2*t.log(s/2)),n=-.70711*((2.30753+.27061*r)/(1+r*(.99229+.04481*r))-r);2>o;o++)a=e.erfc(n)-s,n+=a/(1.1283791670955126*t.exp(-n*n)-n*a);return 1>i?n:-n},ibetainv:function(i,n,a){var r,s,o,l,u,c,d,p,f,m,h,g=1e-8,v=n-1,b=a-1,y=0;if(0>=i)return 0;if(i>=1)return 1;for(n>=1&&a>=1?(o=.5>i?i:1-i,l=t.sqrt(-2*t.log(o)),d=(2.30753+.27061*l)/(1+l*(.99229+.04481*l))-l,.5>i&&(d=-d),p=(d*d-3)/6,f=2/(1/(2*n-1)+1/(2*a-1)),m=d*t.sqrt(p+f)/f-(1/(2*a-1)-1/(2*n-1))*(p+5/6-2/(3*f)),d=n/(n+a*t.exp(2*m))):(r=t.log(n/(n+a)),s=t.log(a/(n+a)),l=t.exp(n*r)/n,u=t.exp(a*s)/a,m=l+u,d=l/m>i?t.pow(n*m*i,1/n):1-t.pow(a*m*(1-i),1/a)),h=-e.gammaln(n)-e.gammaln(a)+e.gammaln(n+a);10>y;y++){if(0===d||1===d)return d;if(c=e.ibeta(d,n,a)-i,l=t.exp(v*t.log(d)+b*t.log(1-d)+h),u=c/l,d-=l=u/(1-.5*t.min(1,u*(v/d-b/(1-d)))),0>=d&&(d=.5*(d+l)),d>=1&&(d=.5*(d+l+1)),t.abs(l)<g*d&&y>0)break}return d},ibeta:function(i,n,a){var r=0===i||1===i?0:t.exp(e.gammaln(n+a)-e.gammaln(n)-e.gammaln(a)+n*t.log(i)+a*t.log(1-i));return 0>i||i>1?!1:(n+1)/(n+a+2)>i?r*e.betacf(i,n,a)/n:1-r*e.betacf(1-i,a,n)/a},randn:function(i,n){var a,r,s,o,l;if(n||(n=i),i)return e.create(i,n,function(){return e.randn()});do a=t.random(),r=1.7156*(t.random()-.5),s=a-.449871,o=t.abs(r)+.386595,l=s*s+o*(.196*o-.25472*s);while(l>.27597&&(l>.27846||r*r>-4*t.log(a)*a*a));return r/a},randg:function(i,n,a){var r,s,o,l,u,c,d=i;if(a||(a=n),i||(i=1),n)return c=e.zeros(n,a),c.alter(function(){return e.randg(i)}),c;1>i&&(i+=1),r=i-1/3,s=1/t.sqrt(9*r);do{do u=e.randn(),l=1+s*u;while(0>=l);l=l*l*l,o=t.random()}while(o>1-.331*t.pow(u,4)&&t.log(o)>.5*u*u+r*(1-l+t.log(l)));if(i==d)return r*l;do o=t.random();while(0===o);return t.pow(o,1/d)*r*l}}),function(t){for(var i=0;i<t.length;i++)(function(t){e.fn[t]=function(){return e(e.map(this,function(i){return e[t](i)}))}})(t[i])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var i=0;i<t.length;i++)(function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))
}})(t[i])}("randn".split(" "))}(this.jStat,Math),function(e,t){var i=[].slice,n=e.utils.isNumber;e.extend({zscore:function(){var t=i.call(arguments);return n(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var a=i.call(arguments);if(4===a.length){if(n(a[1])){var r=e.zscore(a[0],a[1],a[2]);return 1===a[3]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)}var r=a[0];return 1===a[2]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)}var r=e.zscore(a[0],a[1],a[3]);return 1===a[1]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(i,n,a){var r=t.abs(this.zscore(i,a));return 1===n?e.normal.cdf(-r,0,1):2*e.normal.cdf(-r,0,1)}}),e.extend({tscore:function(){var n=i.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var a,r=i.call(arguments);return 5===r.length?(a=t.abs(e.tscore(r[0],r[1],r[2],r[3])),1===r[4]?e.studentt.cdf(-a,r[3]-1):2*e.studentt.cdf(-a,r[3]-1)):n(r[1])?(a=t.abs(r[0]),1==r[2]?e.studentt.cdf(-a,r[1]-1):2*e.studentt.cdf(-a,r[1]-1)):(a=t.abs(e.tscore(r[0],r[1])),1==r[2]?e.studentt.cdf(-a,r[1].length-1):2*e.studentt.cdf(-a,r[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(i,n){return 1===n?1-e.studentt.cdf(t.abs(this.tscore(i)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(i)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,a,r,s,o,l,u,c,d=i.call(arguments);if(1===d.length){for(o=new Array(d[0].length),u=0;u<d[0].length;u++)o[u]=d[0][u];d=o}if(2===d.length)return e.variance(d[0])/e.variance(d[1]);for(a=new Array,u=0;u<d.length;u++)a=a.concat(d[u]);for(r=e.mean(a),n=0,u=0;u<d.length;u++)n+=d[u].length*t.pow(e.mean(d[u])-r,2);for(n/=d.length-1,l=0,u=0;u<d.length;u++)for(s=e.mean(d[u]),c=0;c<d[u].length;c++)l+=t.pow(d[u][c]-s,2);return l/=a.length-d.length,n/l
},anovaftest:function(){var t,a,r,s,o=i.call(arguments);if(n(o[0]))return 1-e.centralF.cdf(o[0],o[1],o[2]);for(anovafscore=e.anovafscore(o),t=o.length-1,r=0,s=0;s<o.length;s++)r+=o[s].length;return a=r-t-1,1-e.centralF.cdf(anovafscore,t,a)},ftest:function(t,i,n){return 1-e.centralF.cdf(t,i,n)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftest:function(){var t,i=0;for(t=0;t<this.length;t++)i+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,i-this.length)}}),e.extend({normalci:function(){var n,a=i.call(arguments),r=new Array(2);return n=t.abs(4===a.length?e.normal.inv(a[1]/2,0,1)*a[2]/t.sqrt(a[3]):e.normal.inv(a[1]/2,0,1)*e.stdev(a[2])/t.sqrt(a[2].length)),r[0]=a[0]-n,r[1]=a[0]+n,r},tci:function(){var n,a=i.call(arguments),r=new Array(2);return n=t.abs(4===a.length?e.studentt.inv(a[1]/2,a[3]-1)*a[2]/t.sqrt(a[3]):e.studentt.inv(a[1]/2,a[2].length)*e.stdev(a[2],!0)/t.sqrt(a[2].length)),r[0]=a[0]-n,r[1]=a[0]+n,r},significant:function(e,t){return t>e}}),e.extend(e.fn,{normalci:function(t,i){return e.normalci(t,i,this.toArray())},tci:function(t,i){return e.tci(t,i,this.toArray())}})}(this.jStat,Math),function(e,t){var i=e.utils.isFunction,n=function(e,t){return e-t};e.extend({sum:function(e){for(var t=0,i=e.length;--i>=0;)t+=e[i];return t},sumsqrd:function(e){for(var t=0,i=e.length;--i>=0;)t+=e[i]*e[i];return t},sumsqerr:function(t){for(var i,n=e.mean(t),a=0,r=t.length;--r>=0;)i=t[r]-n,a+=i*i;return a},product:function(e){for(var t=1,i=e.length;--i>=0;)t*=e[i];return t},min:function(e){for(var t=e[0],i=0;++i<e.length;)e[i]<t&&(t=e[i]);return t},max:function(e){for(var t=e[0],i=0;++i<e.length;)e[i]>t&&(t=e[i]);return t},mean:function(t){return e.sum(t)/t.length},meansqerr:function(t){return e.sumsqerr(t)/t.length},geomean:function(i){return t.pow(e.product(i),1/i.length)},median:function(e){var t=e.length,i=e.slice().sort(n);return 1&t?i[t/2|0]:(i[t/2-1]+i[t/2])/2},cumsum:function(e){var t=e.length,i=new Array(t),n=1;for(i[0]=e[0];t>n;n++)i[n]=i[n-1]+e[n];
return i},diff:function(e){var t=[],i=e.length,n=1;for(n=1;i>n;n++)t.push(e[n]-e[n-1]);return t},mode:function(e){for(var t=e.length,i=e.slice().sort(n),a=1,r=0,s=0,o=0,l=[];t>o;o++)i[o]===i[o+1]?a++:(a>r?(l=[i[o]],r=a,s=0):a===r&&(l.push(i[o]),s++),a=1);return 0===s?l[0]:l},range:function(t){return e.max(t)-e.min(t)},variance:function(t,i){return e.sumsqerr(t)/(t.length-(i?1:0))},stdev:function(i,n){return t.sqrt(e.variance(i,n))},meandev:function(i){for(var n=0,a=e.mean(i),r=i.length-1;r>=0;r--)n+=t.abs(i[r]-a);return n/i.length},meddev:function(i){for(var n=0,a=e.median(i),r=i.length-1;r>=0;r--)n+=t.abs(i[r]-a);return n/i.length},coeffvar:function(t){return e.stdev(t)/e.mean(t)},quartiles:function(e){var i=e.length,a=e.slice().sort(n);return[a[t.round(i/4)-1],a[t.round(i/2)-1],a[t.round(3*i/4)-1]]},covariance:function(t,i){for(var n=e.mean(t),a=e.mean(i),r=t.length,s=new Array(r),o=0;r>o;o++)s[o]=(t[o]-n)*(i[o]-a);return e.sum(s)/(r-1)},corrcoeff:function(t,i){return e.covariance(t,i)/e.stdev(t,1)/e.stdev(i,1)}}),function(t){for(var n=0;n<t.length;n++)(function(t){e.fn[t]=function(n,a){var r=[],s=0,o=this;if(i(n)&&(a=n,n=!1),a)return setTimeout(function(){a.call(o,e.fn[t].call(o,n))},15),this;if(this.length>1){for(o=n===!0?this:this.transpose();s<o.length;s++)r[s]=e[t](o[s]);return n===!0?e[t](e.utils.toVector(r)):r}return e[t](this[0],n)}})(t[n])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),e.fn.cumsum=function(t,n){var a=[],r=0,s=this;if(i(t)&&(n=t,t=!1),n)return setTimeout(function(){n.call(s,e.fn.cumsum.call(s,t))},15),this;if(this.length>1){for(s=t===!0?this:this.transpose();r<s.length;r++)a[r]=e.cumsum(s[r]);return a}return e.cumsum(this[0],t)}}(this.jStat,Math),this.jStat}),define("libs/jstat/jstat.extensions",["libs/jstat/jstat"],function(e){e.extend({medsumsqerr:function(t){for(var i,n=e.median(t),a=0,r=t.length;--r>=0;)i=t[r]-n,a+=i*i;return a},medsqerr:function(t){return e.medsumsqerr(t)/t.length
}});var t=e.utils.isFunction;return function(i){for(var n=0;n<i.length;n++)(function(i){e.fn[i]=function(n,a){var r=[],s=0,o=this;if(t(n)&&(a=n,n=!1),a)return setTimeout(function(){a.call(o,e.fn[i].call(o,n))},15),this;if(this.length>1){for(o=n===!0?this:this.transpose();s<o.length;s++)r[s]=e[i](o[s]);return n===!0?e[i](e.utils.toVector(r)):r}return e[i](this[0],n)}})(i[n])}("medsumsqerr medsqerr".split(" ")),e}),define("tp/reports/processControl/chart.limits",["libs/jstat/jstat.extensions","libs/d3/d3","Underscore","tp/reports/chart.behaviour","tp/reports/processControl/chart.axes.format"],function(e,t,i,n,a){return n.extend({getData:function(e,t){for(var i=[],n=t.scales.stroke.domain(),a=t.scales.stroke.range(),r=0;r<n.length;r++){var s=this._getEntityDataForStroke(e,n[r]);if(s.length>0){var o=a[r],l=this._getLimitsData(s,o,t);i=i.concat(l)}}return this.adjustLabelsPlacement(i)},_getEntityDataForStroke:function(e,t){return e.filter(function(e){return e.stroke==t}).map(function(e){return e.y})},_getLimitsData:function(t,n,a){var r=e(t),s=r.median(),o=Math.sqrt(r.meansqerr()),l=a.scales.y.range()[1];return i.filter([this.getControlLimitData(s,o,n,a),this.getWarningLimitData(s,o,n,a),this.getMedianData(s,n,a)],function(e){return e.y>l})},getControlLimitData:function(e,t,i,n){var a=e+3*t,r=n.scales.y(a);return 0===t&&(r-=2),{id:i+"control",value:a,text:"Control limit: ","class":"control",entityType:i,description:"Indicates the threshold at which the process is statistically 'unlikely' (3 standard errors from the median).",y:r}},getWarningLimitData:function(e,t,i,n){var a=e+2*t,r=n.scales.y(a);return 0===t&&(r-=1),{id:i+"warning",value:e+2*t,text:"Warning limit: ","class":"warning",entityType:i,description:"Indicates the dangerous threshold. All the items above this line are suspicious (2 standard errors from the median).",y:r}},getMedianData:function(e,t,i){return{id:t+"median",value:e,text:"Median: ","class":"median",entityType:t,description:'Typical lead or cycle time. The "middle" value in the list of all values.',y:i.scales.y(e)}
},adjustLabelsPlacement:function(t){var n=18,a=function(e,t,i){return Math.abs(e-t)<=n*i},r=i.chain(t).sortBy(function(e){return e.y}).value();return i.each(r,function(t,r,s){var o=i.filter(s,function(e,i){return a(e.y,t.y,Math.abs(r-i))}),l=o.length,u=e(o.map(function(e){return e.y})).mean();i.each(o,function(e,t){e.y=u+(t-l/2)*n+10})}),r},data:function(e,i){t.select(i.placeholder).classed("limits",!0);var n=this.getData(e.nodes,i),r=t.select(i.placeholder).selectAll("line.limit").data(n,function(e){return e.id});r.enter().append("line"),r.exit().remove(),r.attr("class",function(e){return"limit "+e["class"]+" "+e.entityType}).transition().attr("x1",i.scales.x.range()[0]-i.scales.axisMargin).attr("y1",function(e){return i.scales.y(e.value)}).attr("x2",i.scales.x.range()[1]).attr("y2",function(e){return i.scales.y(e.value)});var s=t.select(i.placeholder).selectAll("text.limit.limitLabel").data(n,function(e){return e.id});s.enter().append("text"),s.exit().remove(),s.attr("class",function(e){return"limit limitLabel "+e.entityType}).transition().text(function(e){return e.text+a.timerange("d","h","min")(e.value)}).attr("x",i.scales.x.range()[1]+i.plot.margin/4).attr("y",function(e){return e.y}).attr("dy",".35em"),this._subscribe(s,["mouseover","mouseout"],i)}})}),define("tp/reports/processControl/behaviour.limits.hover",["jQuery"],function(e){return{create:function(t){var i=e('<div class="tau-chart-tooltip" style="position:absolute"></div>').appendTo(t.placeholder).tauBubble({content:"",className:"tau-chart-tooltip",onPositionConfig:function(e){e.my="left bottom"}});return{mouseover:function(t){var n=e(this).offset();n.left+=10,i.offset(n),i.tauBubble("show"),i.tauBubble("option","content",t.description)},mouseout:function(){i.data("ui-tauBubble")&&i.tauBubble("hide")}}}}}),define("tp/reports/processControl/chart.scales",["libs/d3/d3","tau/utils/utils.date","tp/reports/chart.scales"],function(e,t,i){function n(){}return n.prototype={get:function(n,a,r){function s(){return e.extent(n,function(e){return e.x
})}function o(){return[0,e.max(n,function(e){return e.y})]}function l(e,i){return[t.addDays(e[0],-i/2),t.addDays(e[1],i/2)]}function u(t,i){var n=e.max([1.1*t[1]-t[0],i]);return[t[0],t[0]+n]}function c(e,t){return e?t?e+", "+t:e:t}var d=e.time.scale().domain(l(s(),2)).range([r.margin,r.width-r.margin]);d.label=c(a.mapping.x.label,a.mapping.x.units);var p=e.scale.linear().domain(u(o(),2)).range([r.height-r.margin,r.margin]).nice();return p.label=c(a.mapping.y.label,a.mapping.y.units),{x:d,y:p,stroke:i.type(),axisMargin:20}}},n}),define("tp/reports/processControl/extension.report",["Underscore","jQuery","tau/components/extensions/component.extension.base","tp/reports/chart.plot","tp/reports/processControl/chart.scatterplot","tp/reports/processControl/chart.axes","tp/reports/processControl/behaviour.scatterplot.hover","tp/reports/processControl/behaviour.scatterplot.popup","tp/reports/processControl/chart.limits","tp/reports/processControl/behaviour.limits.hover","tp/reports/processControl/chart.scales"],function(e,t,i,n,a,r,s,o,l,u,c){return i.extend({"bus afterRender + configurator.ready:last":function(e,t,i){var d=new n({scales:new c,placeholder:t.element.find(".tau-chart-plot").get(0),axes:[r.x,r.y],size:i.service("chart.size"),charts:[new l({handlers:[u.create({placeholder:t.element})]}),new a({handlers:[s.create({placeholder:t.element}),o.create({navigator:i.service("navigator")})]})]});this.fire("plot.ready",d)},"bus plot.ready:last + data.ready":function(e,t,i){t.data({nodes:i.data},i.settings),this.fire("plot.afterRender",t)},"bus plot.ready:last + beforeLoad":function(e,t){t.loading(!0)},"bus plot.ready:last + afterLoad":function(e,t){t.loading(!1)},"bus data.ready":function(e,t){t.metaData.hasMore&&alert("There are more items to show.\n\nOne can only see up to 1000 items at a time. You might want to narrow down your filter settings.")}})}),define("tp/reports/processControl/model.settings",["Underscore","tp/reports/settings/model.settings","tau/utils/utils.date","tp/reports/settings/definitionBuilder","tp/reports/settings/templateDataBuilder"],function(e,t,i,n,a){return t.extend({NAME_CHART:"Process ontrol",defaultData:{scale:"cycleTime",entities:["userstory","bug"],filter:"?EndDate > Today - 180(days)"},processSettings:function(t){return{scale:t.time.key,filter:t.filter,useFilter:t.useFilter,entities:JSON.stringify(e.reduce(t.entities,function(e,t){return e.push(t.id),e
},[]))}},setSettings:function(e,t){function a(e,t){return function(i){var n=i[e];return"undefined"==typeof t||"undefined"!=typeof n&&null!=n||(n=t),n}}function r(e,t,i){return{map:a(e,i),label:t}}function s(e,t){return{map:function(t){return a(e)(t)?i.convertToTimezone(a(e)(t))[0]:void 0},label:t}}function o(e){return{map:function(){return e}}}var l={strategy:"page",parameters:n.getWithLeadAndCycleTime(e,t),mapping:{x:s("endDate","End Date"),y:r(e.time.key,e.time.label,0),r:o(4),stroke:r("type","Entity Type")}};this.fire("settings.changed",l)},"bus model.ready + contextProvider.ready":function(t,i,n){this.fire("dataBind",{times:a.times(i),types:a.assignables(i),isShowSettings:i.isShowSettings,name:this.NAME_CHART,description:this.getDescription(n),filter:a.filter(i,"?EndDate > Today - 180(days)"),useFilter:e.isUndefined(i.useFilter)?!0:i.useFilter,termProcessor:n.getTermProcessorForCurrentProject()})},getDescription:function(e){return["Process control chart shows distribution of cycle time of all completed entities (",e.getTerms("userStory").names.toLowerCase(),", ",e.getTerms("feature").names.toLowerCase(),", ",e.getTerms("bug").names.toLowerCase(),", tasks, requests) for a given time frame."].join("")}})}),define("template!tp/reports/processControl/template.legend",["tau/core/templates-factory"],function(e){var t={name:"processControl.legend",engine:"jqote2",customFunctions:null,markup:'<div class="_t3-chart-legend t3-process-control"> <div class="t3-item t3-y-axis"> <div class="t3-name">Y-axis</div> <div class="t3-description">Cycle or Lead time in days</div> </div> <div class="t3-item t3-x-axis"> <div class="t3-name">X-axis</div> <div class="t3-description">Date when entity was completed</div> </div> <div class="t3-item t3-color"> <div class="t3-name">Color</div> <div class="t3-description">Entity type (<span class="t3-userstory tau-text_type_userstory"><%= this.usTerm %></span>, <span class="t3-bug tau-text_type_bug"><%= this.bugTerm %></span>, etc.)</div> </div> </div>'};
return e.register(t)}),define("tp/reports/processControl/extension.form",["Underscore","jQuery","tau/components/extensions/component.extension.base","template!tp/reports/processControl/template.legend"],function(e,t,i,n){return i.extend({whenFilterResolved:function(e){var i=t.Deferred();this.fire("filter.resolve",i),i.then(e)},whenTimeResolved:function(e){var i=t.Deferred();this.fire("time.resolve",i),i.then(e)},unbindSettings:function(){var e=this;e.whenFilterResolved(function(i){e.whenTimeResolved(function(n){e.fire("formData.changed",t.extend({time:n},i))})})},"bus afterRender + contextProvider.ready":function(e,t,i){var n=t.element;this.fire("$form.ready",n),this.fire("view.dom.ready",{$element:n,legend:this.getLegend(i)}),this.unbindSettings()},"bus filter.form.changed":function(){this.unbindSettings()},"bus time.form.changed":function(){this.unbindSettings()},getLegend:function(e){return n.render({usTerm:e.getTerms("userStory").name,bugTerm:e.getTerms("bug").name})}})}),define("tp/reports/processControl/component.report",["jQuery","Underscore","libs/jquery/jquery.ui","tau/components/component.creator","tp/reports/settings/type/config","tp/reports/settings/filter/config","tp/reports/settings/time/config","tp/reports/processControl/extension.report","tp/reports/extension.context","tp/reports/processControl/model.settings","tp/reports/model.report","tp/reports/processControl/extension.form","tp/reports/extension.info","tp/reports/chart.template.info","tau/configurator"],function(e,t,i,n,a,r,s,o,l,u,c,d,p,f,m){return{create:function(e){var i=['<div class="tau-chart i-role-processControlChart">','   <div class="tau-process-control">','       <%= fn.sub("chart.template.info", this) %> ','       <div class="tau-chart-settings i-role-settings <%=(this.isShowSettings)?"":"tau-chart-settings_hide"%>">','           <div class="tau-chart-settings-controls">'];i=i.concat(m.getFeaturesService().isEnabled("tp2.application")?['               <div class="tau-section">','                   <%= fn.sub("report.time", [this.times]) %>','                   <%= fn.sub("report.type", { types: this.types, termProcessor: this.termProcessor }) %>',"               </div>",'               <div class="tau-section">','                   <%= fn.sub("report.filter", this) %>',"               </div>"]:['               <%= fn.sub("report.time", [this.times]) %>','               <%= fn.sub("report.type", { types: this.types, termProcessor: this.termProcessor }) %>','               <%= fn.sub("report.filter", this) %>']),i=i.concat(["           </div>","       </div>",'       <div class="tau-chart-plot">',"           <svg>","           </svg>",'           <div class="_empty empty invisible">','               <div class="empty-text">','                   <div class="first-line">Not enough data to build this beautiful chart</div>','                   <div class="second-line">You need to have at least some of the work items completed</div>','                   <div class="second-line">Also, check if your filter is correct, and make sure that you\'ve<br /> actually selected some work item(s) in chart settings</div>',"               </div>","           </div>","       </div>","   </div>","</div>"]);
var f={extensions:t.flatten([e.extensions||[],a.extensions,r.extensions,s.extensions,[o,l,d,u.extend(e.modelOverride||{}),c,p]],!1),template:{engine:"jqote2",name:"reports-template",markup:i}};return e["queue.bus"]=!0,e.storageName="processControlChart",e.className="process-control",n.create(f,e)}}}),define("tp/reports/chart.layout",["libs/d3/d3"],function(e){function t(){}function i(e){return function(t){return t[e]}}function n(e){return e*e}function a(){var t=e.layout.force(),i=t.resume,n={resume:function(){for(i.call(t);!t.tick.call(t););return this}};return e.rebind(t,n,"resume")}return{graph:function(){function r(e){var t=Math.min(1,p[1]/p[0]),n=Math.min(1,p[0]/p[1]),a=d*e.alpha;a&&m.forEach(function(e){e.x+=(p[0]/2-e.x)*a*t,e.y+=(p[1]/2-e.y)*a*n}),f.forEach(function(t){var i=(t.source.r+t.target.r)/2;if(t.source.x>t.target.x-i){var n=1.5*(t.source.x-t.source.x+i)*e.alpha;t.source.x-=n,t.target.x+=n}t.source.y+=e.alpha*(t.target.y-t.source.y)/2,t.target.y+=e.alpha*(t.source.y-t.target.y)/2}),m.filter(i("fixed")).forEach(function(e){e.x=e.px,e.y=e.py})}function s(){}function o(){v.stop(),e.select(this).style("z-index",100)}function l(t){e.select(this).style("z-index",void 0),t.fixed=!0,v.resume()}function u(t){t.px=t.x,t.py=t.y,t.x=s.scales.x.invert(e.event.x),t.y=s.scales.y.invert(e.event.y),g(t)}var c,d=2.5,p=[],f=[],m=[],h=t,g=t,v=a();return s.doLayout=function(){m.forEach(function(e){e.r=Math.sqrt(2*n(e.size[0])),e.charge=-n(e.r*(1+Math.log(e.links.length/10+1)))});var t=e.max(m,function(e){return e.size[0]}),a=e.max(m,function(e){return e.size[1]}),o=e.max(m,function(e){return e.size[1]/e.size[0]});p[0]=Math.min(c,2*Math.sqrt(-e.sum(m,i("charge")))),p[1]=-4*e.sum(m,i("charge"))/p[0]/d;var l=function(){var n=e.extent(m,i("x")),r=e.extent(m,i("y"));s.height=function(){return(r[1]-r[0])*o+2*a},s.scales={x:e.scale.linear().range([t,p[0]-t]).domain(n),y:e.scale.linear().range([a,s.height()-a]).domain(r)},h()};return v.gravity(0).charge(i("charge")).linkDistance(Math.sqrt(2*n(t))).nodes(m).links(f).size(p).on("tick",function(e){r(e)
}).on("end",function(){l(),l=h}).start(),s},s.nodes=function(e){return e?(m=e,s):m},s.links=function(e){return e?(f=e,s):f},s.gravity=function(e){return d=e,s},s.width=function(e){return c=e,s},s.end=function(e){return h=e,s},s.dragmove=function(e){return g=e,s},s.drag=e.behavior.drag().on("dragstart.graph",o).on("dragend.graph",l).on("drag.graph",u),s}}}),define("tp/reports/relationsNetwork/chart.network.layout",["libs/d3/d3","Underscore","tp/reports/chart.layout","tau/core/tau"],function(e,t,i,n){var a=function(e){return e*e},r=function(e,t){return a(e.x-t.x)+a(e.y-t.y)},s=t.contains([10,11],n.ieVersion);return{links:function(i){var n=function(e){var t=i.x(e.x),n=i.y(e.y),a=10;return[{x:t-e.size[0]/2,y:n},{x:t+e.size[0]/2,y:n},{x:t,y:n-e.size[1]/2},{x:t,y:n+a+e.size[1]/2}]},a=function(i,a){var s=n(i),o=n(a);return t.flatten(s.map(function(e){return o.map(function(t){return{source:e,target:t}})})).sort(function(t,i){return e.ascending(r(t.source,t.target),r(i.source,i.target))})[0]};return function(){this.each(function(e){e.line=a(e.source,e.target)}).attr("x1",function(e){return e.line.source.x}).attr("y1",function(e){return e.line.source.y}).attr("x2",function(e){return e.line.target.x}).attr("y2",function(e){return e.line.target.y}),s&&this.each(function(){this.parentNode.insertBefore(this,this)})}},nodes:function(e){return function(){this.style("left",function(t){return Math.round(e.x(t.x)-t.size[0]/2)+"px"}).style("top",function(t){return Math.round(e.y(t.y)-t.size[1]/2)+"px"})}}}}),define("tp/reports/relationsNetwork/chart.network",["jQuery","Underscore","libs/d3/d3","tp/reports/chart.layout","tp/reports/relationsNetwork/chart.network.layout","tp/reports/chart.behaviour","tau/core/tau","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(e,t,i,n,a,r,s,o){var l=t.contains([10,11],s.ieVersion);return r.extend({init:function(e){this.handlers=this.initHandlers(e.handlers||[]),this.cardTemplate=e.templateFactory.get("board.plus.default.card.customized")},nodes:function(n,a){var r=t.filter(n.nodes,function(e){return e.cardData
}),s=this,o=e(a.placeholder).closest("div")[0];i.select(o).selectAll(".tau-chart-box").style("display","block");var l=i.select(o).selectAll(".tau-chart-box").data(r,function(e){return e.id});return l.enter().append("div"),l.attr("class",function(e){return"tau-chart-box i-trigger-set-focus tau-ui-size-"+a.scales.zoom(e.nodeType)}).html(function(t){return e("<div></div>").append(s.cardTemplate.bind({},{dataItem:{data:t,type:t.type},layout:n.settings.layouts[t.nodeType][t.type.toLowerCase()],configurator:n.settings.configurator})).html()}),l.exit().remove(),l},links:function(e,t){var n=i.select(t.placeholder);n.selectAll("line.link").remove();var a=n.selectAll(".link").data(e);return a.enter().append("line").attr("data-entity-id",function(e){return e.id}).attr("class",function(e){return"link "+t.scales.relationType(e.type)}).attr("marker-end",function(e){return"url(#"+t.scales.relationType(e.type)+")"}),a.exit().remove(),a},addTransparentClickHandler:function(e){var t=i.select(e.placeholder).append("rect").attr("width",e.plot.width-e.plot.margin).attr("class","transparent i-trigger-reset-focus");this._subscribe(t,["click"],e)},resetFocus:function(e){i.select(e.placeholder.parentNode.parentNode.parentNode).classed("tau-chart-focus",!1).selectAll(".tau-chart-focused").classed("tau-chart-focused",!1)},data:function(r,s){function u(){return e(s.placeholder).closest("div")}var c=r.nodes,d=this,p=s.plot.width,f=s.plot.height;this.addTransparentClickHandler(s),this.resetFocus(s);var m=t.chain(c).map(function(e){return e.links}).flatten(!1).unique().value();c.forEach(function(e){var t=e.type?o.getCardSize(e.type.toLowerCase(),s.scales.zoom(e.nodeType)):{width:0,height:0};e.size=[t.width,t.height]},this);var h=this.nodes(r,s),g=this.links(m,s),v=function(e){return e&&!l?function(){h.transition().call(a.nodes(y.scales)),g.transition().call(a.links(y.scales))}:function(){h.call(a.nodes(y.scales)),g.call(a.links(y.scales))}},b=function(){f=Math.max(f,y.height()),u().height(f),i.select(s.placeholder.parentNode).style("height",f+"px"),i.select(s.placeholder).style("height",f+"px"),i.select(s.placeholder).select(".transparent").attr("height",f),c.forEach(function(e){e.fixed="primary"==e.nodeType
}),v(!1)(),e(d).trigger("afterRender")},y=n.graph().width(p).links(m).nodes(c).end(function(){b(),b=v(!0)}).dragmove(function(e){function t(e,t,i){return Math.min(Math.max(e,t),i)}var i=t(y.scales.x(e.x),e.size[0]/2,p-e.size[0]/2-12),n=t(y.scales.y(e.y),e.size[1]/2,f-e.size[1]/2);e.x=y.scales.x.invert(i),e.y=y.scales.y.invert(n),v(!1)()});h.call(y.drag),i.select(s.placeholder.parentNode).select("defs").selectAll("marker").data(s.scales.relationType.range()).enter().append("marker").attr("id",String).attr("viewBox","0 -7 14 14").attr("refX",14).attr("markerUnits","userSpaceOnUse").attr("markerWidth",7).attr("markerHeight",7).attr("orient","auto").append("path").attr("class",String).attr("stroke-width","1").attr("d","M0,-7L14,0L0,7"),this._subscribe(h,["click","dblclick"],s),this._subscribe(y.drag,["dragstart.behavior"],s),y.doLayout()}})}),define("tp/reports/relationsNetwork/chart.scales",["libs/d3/d3","tp/reports/chart.scales"],function(e,t){function i(){}return i.prototype={get:function(){var i=e.scale.ordinal().domain(["primary","secondary"]).range(["m","xs"]),n=e.scale.ordinal().domain(["Relation","Blocker","Impediment","Dependency"]).range(["relation","blocker","blocker","dependency"]),a=e.scale.ordinal().domain(["primary","secondary"]).range([[197,84],[105,38]]);return{entityType:t.type(),zoom:i,size:a,relationType:n}}},i}),define("tp/reports/relationsNetwork/behaviour.network.popup",[],function(){return{create:function(e){var t=e.navigator;return{dblclick:function(e){t.to(e.type+"/"+e.id)}}}}}),define("tp/reports/relationsNetwork/behaviour.focus",["libs/d3/d3"],function(e){function t(t){return e.select(t.placeholder.parentNode.parentNode.parentNode)}function i(e,t){return e.push(t),t.links.forEach(function(t){-1==e.indexOf(t)&&e.push(t),-1==e.indexOf(t.source)&&i(e,t.source),-1==e.indexOf(t.target)&&i(e,t.target)}),e}function n(e){return!e.selectAll(".tau-chart-focused").empty()}function a(t){return function(){this.each(function(){e.select(this).classed("tau-chart-focused",t),e.select(this).style("z-index",t?100:void 0)
})}}function r(e){e.classed("tau-chart-focus",!1),e.selectAll(".tau-chart-focused").call(a(!1))}function s(e,t){function i(t){return e.selectAll('[data-entity-id="'+t+'"]')}r(e),e.classed("tau-chart-focus",!0),t.forEach(function(e){i(e.id).call(a(!0))})}return{"dragstart.behavior":function(i,a){n(e.select(this))||r(t(a))},click:function(a,o){var l=e.select(e.event.target).attr("class");!l||l.indexOf("tau-id")>-1||(n(e.select(this))?r(t(o)):e.select(this).classed("i-trigger-set-focus")?s(t(o),i([],a)):e.select(this).classed("i-trigger-reset-focus")&&r(t(o)))}}}),define("tp/reports/relationsNetwork/extension.report",["Underscore","jQuery","libs/d3/d3","tau/components/extensions/component.extension.base","tp/reports/chart.plot","tp/reports/relationsNetwork/chart.network","tp/reports/relationsNetwork/chart.scales","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized","tp/reports/relationsNetwork/chart.network.layout","tp/reports/relationsNetwork/behaviour.network.popup","tp/reports/relationsNetwork/behaviour.focus","tau/models/dataprocessor/model.processor.context","tau/core/termProcessor"],function(e,t,i,n,a,r,s,o,l,u,c){return n.extend({"bus configurator.ready:last + afterRender":function(e,i,n){var o=new r({templateFactory:i.getTemplateFactory(),handlers:[u.create({navigator:i.service("navigator")}),c]}),l=i.service("chart.size"),d=new a({scales:new s,placeholder:n.element.find(".tau-chart-plot").get(0),axes:[],size:{size:function(e){var t=l.size(e);return{width:t.width/.9,height:t.height}}},charts:[o]});t(o).on("afterRender",function(){d.loading(!1)}),t(d).on("nodata",function(){d.loading(!1),n.element.find(".tau-chart-box").hide()}),this.fire("plot.ready",d)},"bus data.ready":function(e,t){t.metaData.hasMore&&alert("There are more items to show.\n\nOne can only see up to 100 items at a time. You might want to narrow down your filter settings.")},"bus plot.ready:last + error":function(e,t){t.loading(!1)},"bus plot.ready:last + beforeLoad":function(e,t){t.loading(!0)
},"bus plot.ready:last + nodes.ready":function(e,t,i){t.data(i),this.fire("plot.afterRender",t)}})}),define("tp/reports/relationsNetwork/model.settings",["Underscore","tp/reports/settings/model.settings","tp/reports/settings/definitionBuilder","tp/reports/settings/templateDataBuilder"],function(e,t,i,n){return t.extend({NAME_CHART:"Relations Network",defaultData:{entities:JSON.stringify(["userstory"]),filter:"?Iteration is Current",onlyWithRelations:!1,isShowSettings:!0,isShowLegend:!0},processSettings:function(t){return{filter:t.filter,useFilter:t.useFilter,onlyWithRelations:t.onlyWithRelations,entities:JSON.stringify(e.map(t.entities,function(e){return e.id}))}},setSettings:function(e,t,n){var a=i.getWithRelations(e,t,n),r={strategy:"page",parameters:a.definition,layouts:a.layouts,configurator:n};this.fire("settings.changed",r)},"bus configurator.ready:last + model.ready + contextProvider.ready":function(t,i,a,r){var s=i.getFeaturesService().isEnabled("tp2.application")?n.tp2generals(a):n.generals(a);this.fire("dataBind",{onlyWithRelations:a.onlyWithRelations,types:s,filter:n.filter(a,"?Iteration is Current"),useFilter:e.isUndefined(a.useFilter)?!0:a.useFilter,isShowSettings:a.isShowSettings,name:this.NAME_CHART,description:this.getDescription(r),termProcessor:r.getTermProcessorForCurrentProject()})},getDescription:function(e){return"This network is a visualization of direct and hidden dependency relations between any entities in Targetprocess (e.g. projects, "+e.getTerms("userStory").names.toLowerCase()+", "+e.getTerms("feature").names.toLowerCase()+", "+e.getTerms("bug").names.toLowerCase()+", tasks, etc.)"}})}),define("tp/reports/relationsNetwork/extension.form",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,i){return i.extend({whenFilterResolved:function(e){var i=t.Deferred();this.fire("filter.resolve",i),i.then(e)},whenOnlyWithRelationsFilterResolved:function(e){var i=t.Deferred();this.fire("onlyWithRelations.resolve",i),i.then(e)
},"bus $form.ready:last + onlyWithRelations.resolve":function(e,t,i){i.resolve(t.find("#onlyWithRelations").is(":checked"))},unbindSettings:function(){var e=this;e.whenFilterResolved(function(i){e.whenOnlyWithRelationsFilterResolved(function(n){e.fire("formData.changed",t.extend(i,{onlyWithRelations:n}))})})},"bus afterRender":function(e,t){var i=this,n=t.element;this.fire("$form.ready",n.find(".i-role-settings")),this.fire("view.dom.ready",{$element:n}),n.find("#onlyWithRelations").change(function(){i.unbindSettings()}),this.unbindSettings()},"bus filter.form.changed":function(){this.unbindSettings()}})}),define("tp/reports/relationsNetwork/model.report",["Underscore","jQuery","tp/reports/dataRepository","tp/reports/model.report","tp/reports/settings/definitionBuilder"],function(e,t,i,n,a){function r(e){return function(t){return e==t.id}}function s(e){return function(t){return t[e]}}function o(e){return function(t){return t!=e}}function l(e,t,i,n,r){var s=a.getSecondaryRelations(e,t,i);p.get(s.definition,n(s.layouts),r,r)}function u(t){var i=function(e){return function(t){return{id:t.relationId,type:t.relationType,master:e.id,slave:t.id}}},n=function(e){return function(t){return{id:t.relationId,type:t.relationType,master:t.id,slave:e.id}}};return e.chain(t).map(function(e){return[e.data.slaves.map(i(e.data)),e.data.masters.map(n(e.data))]}).flatten(!1).unique(!1,s("id")).value()}function c(t){var i=e.map(t,s("id"));return e.chain(t).map(function(e){return[e.slaves,e.masters]}).flatten(!1).unique(!1,s("id")).filter(function(e){return i.every(o(e.id))}).value()}function d(e,t){return e.map(function(e){return{id:e.id,source:t.filter(r(e.master))[0],target:t.filter(r(e.slave))[0],value:1,type:e.type}}).filter(function(e){return e.source&&e.target})}var p=new i({url:"/slice/v1/matrix/cardsDetails"});return n.extend({"bus data.ready":function(i,n){this._beforeLoad();var a=this,r=e.map(n.data,s("data")),o=c(r),p=n.settings.parameters.definition.global.acid;l(o,p,n.settings.configurator,function(i){return function(s){var o=e.map(r,function(e){return t.extend(e,{nodeType:"primary"})
}),l=e.map(s.items,function(e){return t.extend(e.data,{nodeType:"secondary"})}),c=e.union(o,l);c.forEach(function(e){e.links=e.links||[]});var p=u(n.data);d(p,c).forEach(function(e){e.source.links.push(e),e.target.links.push(e)}),n.settings.layouts=t.extend(n.settings.layouts,i),a._afterLoad(),a.fire("nodes.ready",{nodes:c,settings:n.settings})}},e.bind(this._error,this))}})}),define("tp/reports/relationsNetwork/component.report",["jQuery","Underscore","libs/jquery/jquery.ui","tau/components/component.creator","tp/reports/settings/type/config","tp/reports/settings/filter/config","tp/reports/relationsNetwork/extension.report","tp/reports/extension.context","tp/reports/relationsNetwork/model.settings","tp/reports/relationsNetwork/extension.form","tp/reports/relationsNetwork/model.report","tp/reports/extension.info","tp/reports/chart.template.info"],function(e,t,i,n,a,r,s,o,l,u,c,d){return{create:function(e){var i={extensions:t.flatten([e.extensions||[],a.extensions,r.extensions,[s,o,u,l.extend(e.modelOverride||{}),c,d]],!1),template:{engine:"jqote2",name:"reports-template",markup:['<div class="tau-chart tau-relations-network">',"   <div>",'       <%= fn.sub("chart.template.info", this) %> ','       <div class="tau-chart-settings i-role-settings <%=(this.isShowSettings)?"":"tau-chart-settings_hide"%>">','           <div class="tau-chart-settings-controls">','              <div class="tau-section">','                   <%= fn.sub("report.type", {types: this.types, termProcessor: this.termProcessor}) %>',"               </div>",'              <div class="tau-section">','                   <%= fn.sub("report.filter", this) %>','                   <label class="tau-checkbox">                       <input type="checkbox" id="onlyWithRelations" <%= this.onlyWithRelations ? "checked" : "" %>>                       <i class="tau-checkbox__icon"></i>                       <span class="tau-checkbox-label">Only with relations</span>                   </label>',"               </div>","           </div>","       </div>",'       <div class="tau-chart-plot">','           <div class="empty invisible">','               <div class="empty-text">','                   <div class="first-line">Not enough data to build this beautiful chart</div>','                   <div class="second-line">Check if your filter is correct, and make sure that you\'ve actually selected some work item(s) in the bar above</div>',"               </div>","           </div>","           <svg>","          </svg>","      </div>","   </div>","</div>"]}};
return e["queue.bus"]=!0,e.storageName="relationsNetworkChart",e.className="relations-network",n.create(i,e)}}}),require([],function(){window.console&&(window.console.dump=function(e){return window.console.log(e),e},window.console.table=window.console.table||function(e){function t(e,t){return 1>t?"":new Array(t+1).join(e)}function i(e,i){e=""+e;var n=t(" ",i-e.length);return e+n}var n,a,r,s,o={};for(n=0;n<e.length;n++){r=e[n];for(a in r)r.hasOwnProperty(a)&&(s=o[a]||{name:a,width:0},s.width=Math.max(s.width,(""+r[a]).length),o[a]=s)}for(n=0;n<e.length;n++){r=e[n];var l=[];for(a in o)s=o[a],l.push(i(r[s.name],s.width));window.console.log(l.join(" "))}})}),define("libs/debug.extensions",function(){}),define("all.components",["tau/components/component.additionalInfo","tau/components/component.application.generic","tau/components/component.application","tau/components/component.assignedEffort","tau/components/component.assignments","tau/components/component.assignmentsList","tau/components/component.attachments","tau/components/component.attachmentsPreview","tau/components/component.auditHistory","tau/components/component.avatar.editor","tau/components/component.avatar","tau/components/component.base.new.list","tau/components/component.board.cell.quick.add","tau/components/component.board.clear.sample.data","tau/components/component.board.clipboard","tau/components/component.board.clone","tau/components/component.board.collapser.aside","tau/components/component.board.container","tau/components/component.board.context.output","tau/components/component.board.context.selector","tau/components/component.board.csv","tau/components/component.board.editor.access","tau/components/component.board.editor.container","tau/components/component.board.editor.customize.board","tau/components/component.board.editor.customize.editor","tau/components/component.board.editor.customize.editor.list","tau/components/component.board.editor.customize","tau/components/component.board.editor.customize.library.base","tau/components/component.board.editor.customize.library.board","tau/components/component.board.editor.customize.library.list","tau/components/component.board.editor.customize.list","tau/components/component.board.editor.customize.sizes","tau/components/component.board.editor.customize.types","tau/components/component.board.editor.encoding","tau/components/component.board.editor","tau/components/component.board.editor.prioritization","tau/components/component.board.editor.remember.context","tau/components/component.board.editor.remember.context.output","tau/components/component.board.editor.timeline","tau/components/component.board.entityViewer","tau/components/component.board.flowHelp","tau/components/component.board.flowHelp.popup","tau/components/component.board.general.quick.add","tau/components/component.board.limits","tau/components/component.board.main.menu.item.help","tau/components/component.board.main.menu.item.social-share","tau/components/component.board.main.menu","tau/components/component.board.menu","tau/components/component.board.new.list","tau/components/component.board.overview","tau/components/component.board.owner","tau/components/component.board.owner.list","tau/components/component.board.paging","tau/components/component.board.plus.base","tau/components/component.board.plus.container","tau/components/component.board.plus","tau/components/component.board.plus.list","tau/components/component.board.plus.timeline","tau/components/component.board.remove","tau/components/component.board.selector.add-program","tau/components/component.board.startScreen","tau/components/component.board.system-info","tau/components/component.board.templates.editor","tau/components/component.board.templates.selector","tau/components/component.board.toolbar","tau/components/component.board.tools.container","tau/components/component.board.user-help","tau/components/component.board.workflow","tau/components/component.breadcrumbs","tau/components/component.bubble.container","tau/components/component.button","tau/components/component.buttonGroup","tau/components/component.choice.entityState","tau/components/component.choice","tau/components/component.collapsible","tau/components/component.collapsibleHeader","tau/components/component.comment.add","tau/components/component.comment","tau/components/component.commentList","tau/components/component.comments","tau/components/component.container","tau/components/component.container.with-shared-events","tau/components/component.creator","tau/components/component.current-user","tau/components/component.customField.checkbox","tau/components/component.customField.date","tau/components/component.customField.dropdown","tau/components/component.customField.dropdown.list","tau/components/component.customField.entity","tau/components/component.customField.multipleEntities.container","tau/components/component.customField.multipleEntities","tau/components/component.customField.multiselect","tau/components/component.customField.multiselect.list","tau/components/component.customField.number","tau/components/component.customField.richtext","tau/components/component.customField.templatedurl","tau/components/component.customField.text","tau/components/component.customField.url.editor","tau/components/component.customField.url","tau/components/component.date","tau/components/component.description","tau/components/component.diagnostics.globalListeners","tau/components/component.diagnostics","tau/components/component.diagnostics.store","tau/components/component.duplicateBugList","tau/components/component.duplicateBugListPanel","tau/components/component.editor.requester","tau/components/component.editor.team-member","tau/components/component.effort","tau/components/component.entity.delete","tau/components/component.entity.menuTrigger","tau/components/component.entity.new.list","tau/components/component.entity.new.list.testPlanRun.testCaseRuns","tau/components/component.entity.quickAdd","tau/components/component.entity.quickAddTrigger","tau/components/component.factory","tau/components/component.feature.assignmentList","tau/components/component.finder.entity","tau/components/component.finder.project.byProgram","tau/components/component.finder.project.byTeam","tau/components/component.finder.project.byUser","tau/components/component.finder.requesters","tau/components/component.finder.team.byProject","tau/components/component.finder.team.byUser","tau/components/component.finish-iteration","tau/components/component.followButton","tau/components/component.global.context.control","tau/components/component.implementationHistory","tau/components/component.inviter","tau/components/component.iteration.canBeFinished","tau/components/component.iteration.progressBar","tau/components/component.label.baseAssignable.timecount","tau/components/component.label.duplicateBugCount","tau/components/component.label","tau/components/component.label.relationCount","tau/components/component.label.testplan.testcasecount","tau/components/component.leadCycleTime","tau/components/component.list.baseInfo","tau/components/component.list.creator","tau/components/component.list.editable","tau/components/component.list","tau/components/component.master.board","tau/components/component.master.empty","tau/components/component.menu.actions","tau/components/component.menu.actions.testplanrun","tau/components/component.menu.testPlanRun","tau/components/component.note","tau/components/component.page.base","tau/components/component.page.board","tau/components/component.page.entity","tau/components/component.page.error","tau/components/component.page.finish-iteration","tau/components/component.page.report","tau/components/component.page.reports","tau/components/component.page.search","tau/components/component.pluginsList","tau/components/component.print.cards","tau/components/component.print","tau/components/component.process.menu","tau/components/component.program.progressBar","tau/components/component.progressBar","tau/components/component.progressBar.small","tau/components/component.project.formAdd","tau/components/component.project.progressBar","tau/components/component.property.abbreviation","tau/components/component.property.assignable","tau/components/component.property.bool","tau/components/component.property.build","tau/components/component.property.build.testPlanRun","tau/components/component.property.buildDate","tau/components/component.property.color","tau/components/component.property.company","tau/components/component.property.completeDate","tau/components/component.property.createDate","tau/components/component.property.date","tau/components/component.property.effort","tau/components/component.property.email","tau/components/component.property.endDate.list","tau/components/component.property.endDate.portfolio","tau/components/component.property.endDate.projectMember","tau/components/component.property.entityState","tau/components/component.property.epic","tau/components/component.property.failureComment","tau/components/component.property.feature","tau/components/component.property.icon","tau/components/component.property.impedimentDate","tau/components/component.property.initialEstimate","tau/components/component.property.isActive","tau/components/component.property.isPrivate","tau/components/component.property.isProduct","tau/components/component.property.iteration","tau/components/component.property","tau/components/component.property.lastFailureComment","tau/components/component.property.lastRunDate","tau/components/component.property.lastRunDate.list","tau/components/component.property.lastStatus","tau/components/component.property.owner","tau/components/component.property.owner.project","tau/components/component.property.owner.request","tau/components/component.property.password","tau/components/component.property.plannedEndDate","tau/components/component.property.plannedStartDate","tau/components/component.property.priority","tau/components/component.property.process","tau/components/component.property.program","tau/components/component.property.project","tau/components/component.property.relationType","tau/components/component.property.release","tau/components/component.property.requestSource","tau/components/component.property.requestType","tau/components/component.property.responsible","tau/components/component.property.richtext","tau/components/component.property.role","tau/components/component.property.role.modern","tau/components/component.property.runDate","tau/components/component.property.severity","tau/components/component.property.startDate","tau/components/component.property.startDate.portfolio","tau/components/component.property.startDate.projectMember","tau/components/component.property.status.testCaseRun","tau/components/component.property.team","tau/components/component.property.teamIteration","tau/components/component.property.testCase","tau/components/component.property.testPlan","tau/components/component.property.testPlanRun","tau/components/component.property.text","tau/components/component.property.time","tau/components/component.property.user","tau/components/component.property.userStory","tau/components/component.property.velocity","tau/components/component.quick.add","tau/components/component.redirect","tau/components/component.relations.add","tau/components/component.relations.add.trigger","tau/components/component.relations.connection","tau/components/component.relations.container","tau/components/component.relations.filter","tau/components/component.release.assignedEffort","tau/components/component.release.progressBar","tau/components/component.releaseNotes","tau/components/component.reports","tau/components/component.requestList","tau/components/component.revisionList","tau/components/component.search.filter","tau/components/component.search","tau/components/component.setup.process","tau/components/component.setup.workflow","tau/components/component.shareLink","tau/components/component.shareLinkReport","tau/components/component.side.menu.switcher","tau/components/component.tabs","tau/components/component.tabsHeader","tau/components/component.tags","tau/components/component.tagsCloud","tau/components/component.tagsEditor","tau/components/component.tagsInline","tau/components/component.team-members-editor","tau/components/component.team.formAdd","tau/components/component.teamiteration.progressBar","tau/components/component.terms","tau/components/component.testCaseList","tau/components/component.testCaseRun.quickAdd","tau/components/component.testCaseRun.quickAddTrigger","tau/components/component.testcaserun.result.container","tau/components/component.testcaserun.result.editor","tau/components/component.testCasesRunResults","tau/components/component.testStepList","tau/components/component.testStepRunList","tau/components/component.time-sheet","tau/components/component.time.description.edit","tau/components/component.time","tau/components/component.timeList","tau/components/component.title","tau/components/component.totalEffort","tau/components/component.tp-buy","tau/components/component.tp-settings.feedback","tau/components/component.tp-settings","tau/components/component.tp-settings.live-chat","tau/components/component.tp-settings.process-setup","tau/components/component.tp-settings.settings","tau/components/component.tp-settings.user-guide","tau/components/component.tp-settings.user-voice","tau/components/component.user.settings","tau/components/component.userList","tau/components/component.video-intro.popup","tp/reports/burndown/component.report","tp/reports/cycleTimeDistribution/component.report","tp/reports/processControl/component.report","tp/reports/relationsNetwork/component.report","tau/components/extensions/component.creator.extension","libs/debug.extensions"],function(){return{}
});