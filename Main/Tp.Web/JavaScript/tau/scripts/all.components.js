/*! Copyright (c) 2011, Lloyd Hilaiel, ISC License */
/*!!
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license <http://www.opensource.org/licenses/mit-license.php>
 * @author Miller Medeiros <http://millermedeiros.com/>
 * @version 0.6
 * @build 174 (04/09/2011 05:27 PM)
 */
/*!!
 * Crossroads - JavaScript Routes
 * Released under the MIT license <http://www.opensource.org/licenses/mit-license.php>
 * @author Miller Medeiros
 * @version 0.4
 * @build 31 (06/07/2011 12:15 AM)
 * ----------------------------------
 *
 * !!! WARNING: Patch for getParamIds method is added. Take into account when update to new version.
 *
 * ----------------------------------
 */
/**
 * @version: 1.0 Alpha-1
 * @author: Coolite Inc. http://www.coolite.com/
 * @date: 2008-05-13
 * @copyright: Copyright (c) 2006-2008, Coolite Inc. (http://www.coolite.com/). All rights reserved.
 * @license: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 * @website: http://www.datejs.com/
 */
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
define("Underscore",["libs/underscore"],function(a){return a}),define("jQuery",["libs/jquery/jquery","libs/jquery/jquery.ui"],function(){return $}),define("tau/core/class",[],function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,c=function(){},d=0;return c.extend=function(c){function h(){!a&&this.init&&(this.__objectId=d++,this.init.apply(this,arguments))}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]=typeof c[g]=="function"&&typeof e[g]=="function"&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return h.prototype=f,h.constructor=h,h.extend=arguments.callee,h},c}),function(exports){function b(a){try{return JSON&&JSON.parse?JSON.parse(a):(new Function("return "+a))()}catch(b){d("ijs",b.message)}}function d(a,b){throw new Error(c[a]+(b&&" in '"+b+"'"))}function h(a,c){c||(c=0);var g=f.exec(a.substr(c));if(!g)return undefined;c+=g[0].length;var h;return g[1]?h=[c," "]:g[2]?h=[c,g[0]]:g[3]?h=[c,e.typ,g[0]]:g[4]?h=[c,e.psc,g[0]]:g[5]?h=[c,e.psf,g[0]]:g[6]?d("upc",a):g[8]?h=[c,g[7]?e.ide:e.str,b(g[8])]:g[9]?d("ujs",a):g[10]&&(h=[c,e.ide,g[10].replace(/\\([^\r\n\f0-9a-fA-F])/g,"$1")]),h}function j(a,b){return typeof a===b}function l(a,c){var d,e=i.exec(a.substr(c));if(e)return c+=e[0].length,d=e[1]||e[2]||e[3]||e[5]||e[6],e[1]||e[2]||e[3]?[c,0,b(d)]:e[4]?[c,0,undefined]:[c,d]}function m(a,b){b||(b=0);var c=l(a,b),e;if(c&&c[1]==="("){e=m(a,c[0]);var f=l(a,e[0]);(!f||f[1]!==")")&&d("epex",a),b=f[0],e=["(",e[1]]}else!c||c[1]&&c[1]!="x"?d("ee",a+" - "+(c[1]&&c[1])):(e=c[1]==="x"?undefined:c[2],b=c[0]);var g=l(a,b);if(!g||g[1]==")")return[b,e];(g[1]=="x"||!g[1])&&d("bop",a+" - "+(g[1]&&g[1]));var h=m(a,g[0]);b=h[0],h=h[1];var i;if(typeof h!="object"||h[0]==="("||k[g[1]][0]<k[h[1]][0])i=[e,g[1],h];else{i=h;while(typeof h[0]=="object"&&h[0][0]!="("&&k[g[1]][0]>=k[h[0][1]][0])h=h[0];h[0]=[e,g[1],h[0]]}return[b,i]}function n(a,b){function c(a){return typeof a!="object"||a===null?a:a[0]==="("?c(a[1]):[c(a[0]),a[1],c(a[2])]}var d=m(a,b?b:0);return[d[0],c(d[1])]}function o(a,b){if(a===undefined)return b;if(a===null||typeof a!="object")return a;var c=o(a[0],b),d=o(a[2],b);return k[a[1]][1](c,d)}function p(a,b,c,e){c||(e={});var f=[],g,i;b||(b=0);for(;;){var j=s(a,b,e);f.push(j[1]),j=h(a,b=j[0]),j&&j[1]===" "&&(j=h(a,b=j[0]));if(!j)break;if(j[1]===">"||j[1]==="~")j[1]==="~"&&(e.usesSiblingOp=!0),f.push(j[1]),b=j[0];else if(j[1]===",")g===undefined?g=[",",f]:g.push(f),f=[],b=j[0];else if(j[1]===")"){c||d("ucp",j[1]),i=1,b=j[0];break}}c&&!i&&d("mcp",a),g&&g.push(f);var k;return!c&&e.usesSiblingOp?k=r(g?g:f):k=g?g:f,[b,k]}function q(a){var b=[],c;for(var d=0;d<a.length;d++)if(a[d]==="~"){if(d<2||a[d-2]!=">")c=a.slice(0,d-1),c=c.concat([{has:[[{pc:":root"},">",a[d-1]]]},">"]),c=c.concat(a.slice(d+1)),b.push(c);if(d>1){var e=a[d-2]===">"?d-3:d-2;c=a.slice(0,e);var f={};for(var g in a[e])a[e].hasOwnProperty(g)&&(f[g]=a[e][g]);f.has||(f.has=[]),f.has.push([{pc:":root"},">",a[d-1]]),c=c.concat(f,">",a.slice(d+1)),b.push(c)}break}return d==a.length?a:b.length>1?[","].concat(b):b[0]}function r(a){if(a[0]===","){var b=[","];for(var c=c;c<a.length;c++){var d=q(d[c]);b=b.concat(d[0]===","?d.slice(1):d)}return b}return q(a)}function s(a,b,c){var f=b,i={},j=h(a,b);j&&j[1]===" "&&(f=b=j[0],j=h(a,b)),j&&j[1]===e.typ?(i.type=j[2],j=h(a,b=j[0])):j&&j[1]==="*"&&(j=h(a,b=j[0]));for(;;){if(j===undefined)break;if(j[1]===e.ide)i.id&&d("nmi",j[1]),i.id=j[2];else if(j[1]===e.psc)(i.pc||i.pf)&&d("mpc",j[1]),j[2]===":first-child"?(i.pf=":nth-child",i.a=0,i.b=1):j[2]===":last-child"?(i.pf=":nth-last-child",i.a=0,i.b=1):i.pc=j[2];else{if(j[1]!==e.psf)break;if(j[2]===":val"||j[2]===":contains")i.expr=[undefined,j[2]===":val"?"=":"*=",undefined],j=h(a,b=j[0]),j&&j[1]===" "&&(j=h(a,b=j[0])),(!j||j[1]!=="(")&&d("pex",a),j=h(a,b=j[0]),j&&j[1]===" "&&(j=h(a,b=j[0])),(!j||j[1]!==e.str)&&d("sex",a),i.expr[2]=j[2],j=h(a,b=j[0]),j&&j[1]===" "&&(j=h(a,b=j[0])),(!j||j[1]!==")")&&d("epex",a);else if(j[2]===":has"){j=h(a,b=j[0]),j&&j[1]===" "&&(j=h(a,b=j[0])),(!j||j[1]!=="(")&&d("pex",a);var k=p(a,j[0],!0);j[0]=k[0],i.has||(i.has=[]),i.has.push(k[1])}else if(j[2]===":expr"){i.expr&&d("mexp",a);var l=n(a,j[0]);j[0]=l[0],i.expr=l[1]}else{(i.pc||i.pf)&&d("mpc",a),i.pf=j[2];var m=g.exec(a.substr(j[0]));m||d("mepf",a),m[5]?(i.a=2,i.b=m[5]==="odd"?1:0):m[6]?(i.a=0,i.b=parseInt(m[6],10)):(i.a=parseInt((m[1]?m[1]:"+")+(m[2]?m[2]:"1"),10),i.b=m[3]?parseInt(m[3]+m[4],10):0),j[0]+=m[0].length}}j=h(a,b=j[0])}return f===b&&d("se",a),[b,i]}function t(b){return Array.isArray?Array.isArray(b):a.call(b)==="[object Array]"}function u(a){if(a===null)return"null";var b=typeof a;return b==="object"&&t(a)&&(b="array"),b}function v(a,b,c,d,e){var f=[],g=b[0]===">"?b[1]:b[0],h=!0,i;g.type&&(h=h&&g.type===u(a)),g.id&&(h=h&&g.id===c),h&&g.pf&&(g.pf===":nth-last-child"?d=e-d:d++,g.a===0?h=g.b===d:(i=(d-g.b)%g.a,h=!i&&d*g.a+g.b>=0));if(h&&g.has){var j=function(){throw 42};for(var k=0;k<g.has.length;k++){try{w(g.has[k],a,j)}catch(l){if(l===42)continue}h=!1;break}}return h&&g.expr&&(h=o(g.expr,a)),b[0]!==">"&&b[0].pc!==":root"&&f.push(b),h&&(b[0]===">"?b.length>2&&(h=!1,f.push(b.slice(2))):b.length>1&&(h=!1,f.push(b.slice(1)))),[h,f]}function w(a,b,c,d,e,f){var g=a[0]===","?a.slice(1):[a],h=[],i=!1,j=0,k=0,l,m;for(j=0;j<g.length;j++){m=v(b,g[j],d,e,f),m[0]&&(i=!0);for(k=0;k<m[1].length;k++)h.push(m[1][k])}if(h.length&&typeof b=="object"){h.length>=1&&h.unshift(",");if(t(b))for(j=0;j<b.length;j++)w(h,b[j],c,undefined,j,b.length);else for(l in b)b.hasOwnProperty(l)&&w(h,b[l],c,l)}i&&c&&c(b)}function x(a,b){var c=[];return w(a,b,function(a){c.push(a)}),c}function y(a){return{sel:p(a)[1],match:function(a){return x(this.sel,a)},forEach:function(a,b){return w(this.sel,a,b)}}}var a=Object.prototype.toString,c={bop:"binary operator expected",ee:"expression expected",epex:"closing paren expected ')'",ijs:"invalid json string",mcp:"missing closing paren",mepf:"malformed expression in pseudo-function",mexp:"multiple expressions not allowed",mpc:"multiple pseudo classes (:xxx) not allowed",nmi:"multiple ids not allowed",pex:"opening paren expected '('",se:"selector expected",sex:"string expected",sra:"string required after '.'",uc:"unrecognized char",ucp:"unexpected closing paren",ujs:"unclosed json string",upc:"unrecognized pseudo class"},e={psc:1,psf:2,typ:3,str:4,ide:5},f=new RegExp('^(?:([\\r\\n\\t\\ ]+)|([~*,>\\)\\(])|(string|boolean|null|array|object|number)|(:(?:root|first-child|last-child|only-child))|(:(?:nth-child|nth-last-child|has|expr|val|contains))|(:\\w+)|(?:(\\.)?(\\"(?:[^\\\\\\"]|\\\\[^\\"])*\\"))|(\\")|\\.((?:[_a-zA-Z]|[^\\0-\\0177]|\\\\[^\\r\\n\\f0-9a-fA-F])(?:[_a-zA-Z0-9\\-]|[^\\u0000-\\u0177]|(?:\\\\[^\\r\\n\\f0-9a-fA-F]))*))'),g=/^\s*\(\s*(?:([+\-]?)([0-9]*)n\s*(?:([+\-])\s*([0-9]))?|(odd|even)|([+\-]?[0-9]+))\s*\)/,i=new RegExp('^\\s*(?:(true|false|null)|(-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)|("(?:[^\\]|\\[^"])*")|(x)|(&&|\\|\\||[\\$\\^<>!\\*]=|[=+\\-*/%<>])|([\\(\\)]))'),k={"*":[9,function(a,b){return a*b}],"/":[9,function(a,b){return a/b}],"%":[9,function(a,b){return a%b}],"+":[7,function(a,b){return a+b}],"-":[7,function(a,b){return a-b}],"<=":[5,function(a,b){return j(a,"number")&&j(b,"number")&&a<=b}],">=":[5,function(a,b){return j(a,"number")&&j(b,"number")&&a>=b}],"$=":[5,function(a,b){return j(a,"string")&&j(b,"string")&&a.lastIndexOf(b)===a.length-b.length}],"^=":[5,function(a,b){return j(a,"string")&&j(b,"string")&&a.indexOf(b)===0}],"*=":[5,function(a,b){return j(a,"string")&&j(b,"string")&&a.indexOf(b)!==-1}],">":[5,function(a,b){return j(a,"number")&&j(b,"number")&&a>b}],"<":[5,function(a,b){return j(a,"number")&&j(b,"number")&&a<b}],"=":[3,function(a,b){return a===b}],"!=":[3,function(a,b){return a!==b}],"&&":[2,function(a,b){return a&&b}],"||":[1,function(a,b){return a||b}]};exports._lex=h,exports._parse=p,exports.match=function(a,b){return y(a).match(b)},exports.forEach=function(a,b,c){return y(a).forEach(b,c)},exports.compile=y}(typeof exports=="undefined"?window.JSONSelect={}:exports),define("libs/jsonselect",function(){}),define("tau/extensions/extension.underscore",["Underscore","libs/jsonselect"],function(a){return a.mixin({keysExt:function(b){if(a.isArray(b))return a.keys(b);var c=[];for(var d in b)c.push(d);return c},findComplexField:function(b,c){var d=null,e=this;return a.each(b,function(a){if(e.isSimple(a))return;if(!a.hasOwnProperty(c))return;d=a}),d},concat:function(b){return a.flatten(a.compact(b))},getFieldName:function(b){if(this.isSimple(b))return b;var c=a.select(a.keys(b),function(a){return a!=="list"});if(c.length>1||c.length===0)throw"Only one reference or list should be defined";return c[0]},isSimple:function(b){return a.isString(b)},mergeFields:function(b,c,d){var e=this,f=d&&d.prependFields?"unshift":"push";a.each(c,function(c){if(b===c)return;if(e.isSimple(c)){var d=a.select(b,function(a){return a===c});d.length===0&&b[f](c);return}var g=e.getFieldName(c),h=e.findComplexField(b,g);if(h===null){b[f](c);return}var i=c[g],j=h[g];e.mergeFields(j,i)})},mergeArrayObjects:function(b,c,d){a.each(a(b).keys(),function(e){if(!a.isArray(b[e]))return;if(!a.isArray(c[e]))return;if(d&&a.isArray(d)&&a(d).indexOf(e)<0)return;b[e]=b[e].concat(c[e])})},functionsExt:function(b){return a.filter(a.keysExt(b),function(c){return a.isFunction(b[c])}).sort()},groupBy:function(b,c){var d=[],e={};return a(b).each(function(a){var b=c(a);if(!e.hasOwnProperty(b)){var f={key:b,items:[]};d.push(f),e[b]=f}e[b].items.push(a)}),d},complexKey:function(b,c){var d=undefined,e=c.split(".");return e.length===1?b[c]:(a.forEach(e,function(c){d=b=b[c];if(a.isUndefined(d)===!0)return!1}),d)},jsonSelect:function(a,b){return JSONSelect.match(b,a)}}),a.MIN_INT=-9007199254740992,a.MAX_INT=-a.MIN_INT,a}),define("tau/core/event",["Underscore","tau/extensions/extension.underscore"],function(a){var b=function(){};return b.implementOn=function(a){var c=b.prototype;for(var d in c)a[d]==undefined&&(a[d]=c[d]);return a},b.signUpOnEvents=function(b,c,d,e,f){var g={},h=b,i=function(b){g[b.name]=b,a(g).keys().length===h.length&&(c[d].call(c,g),g={})};a(h).each(function(a){e.on(a,i,c,null,f)})},b.subscribeOn=function(c){var d=a(c);a.each(d.keys(),function(d){var e=c[d];if(!e)return;if(a.isFunction(e.on)){var f=a(c).functionsExt();for(var g=0,h=f.length;g<h;g++){var i=f[g],j=i.split(" "),k=j[1],l=j[0],m;if(j.length<2)continue;j.length>2&&!isNaN(j[2])&&(m=j[2]);var n=k.split("+");l==d&&(n.length>1?b.signUpOnEvents(n,c,i,e,m):e.on(k,c[i],c,null,m))}}})},b.unSubscribe=function(b){var c=a(b);a.each(c.keys(),function(c){var d=b[c];d&&a.isFunction(d.removeAllListeners)&&d.removeAllListeners(b)})},b.prototype=function(){var b=function(a){var b=a.getPrivate&&a.getPrivate()||a._||(a._={});return b.events||(b.events={})},c=function(a){this.name=a,this.listeners=[]};return c.prototype={getListenerIndex:function(a,b){for(var c=0,d=this.listeners;c<d.length;c++)if(d[c].fn==a&&(d[c].scopeObj===b||!d[c].scopeObj&&(arguments.length==1||!b)))return c;return-1}},{on:function(d,e,f,g,h){if(a.isArray(d)){var i=arguments.callee,j=this;a.each(d,function(a){i.call(j,a,e,f,g,h)});return}var k=b(this),l=k[d]||(k[d]=new c(d));if(l.getListenerIndex(e,f)<0){var m=l.listeners;f||(f=this),isNaN(h)&&(h=10);var n=this,o=function(a,b,c,h){var i={name:d,sender:this,caller:a,data:b,listenerData:g,stop:c,cancel:h,removeListener:function(){n.removeListener(d,e,f)}};return e.call(f,i),i.data};o.fn=e,o.scopeObj=f,o.priority=h;for(var p=m.length-1;p>=0;p--)if(m[p].priority<=h){m.splice(p+1,0,o);return}m.unshift(o)}return this},fire:function(){var a=!1,c=function(){a=!0},d=!1,e=function(){d=!0};return function(f,g,h){var i=b(this)[f],j=a,k=d;a=d=!1;if(i){var l=i.listeners;if(l.length){l=l.slice(0);for(var m=0;m<l.length;m++){var n=l[m].call(this,h,g,c,e);typeof n!="undefined"&&(g=n);if(a||d)break}}}var o=d||(typeof g=="undefined"?!1:g);return a=j,d=k,o}}(),fireOnce:function(a,c,d){var e=this.fire(a,c,d);return delete b(this)[a],e},removeListener:function(a,c,d){var e=b(this)[a];if(e){var f=e.getListenerIndex(c,d);f>=0&&e.listeners.splice(f,1)}},removeAllListeners:function(a){var c=b(this);for(var d in c)if(c[d].listeners)if(!a)delete c[d].listeners,delete c[d];else{var e=c[d].listeners,f=[];for(var g=0;g<e.length;g++)e[g].scopeObj!=a&&f.push(e[g]);c[d].listeners=f}},hasListeners:function(a){var c=b(this)[a];return c&&c.listeners.length>0},getListeners:function(){var a=b(this),c=[];for(var d in a){var e=a[d].listeners;if(e&&e.length>0){var f=[];for(var g=0;g<e.length;g++){var h=e[g],i={name:"unknown",item:h};h.scopeObj&&h.scopeObj.bus&&h.scopeObj.bus.name?i.name=h.scopeObj.bus.name:h.scopeObj&&h.scopeObj.name&&(i.name=h.scopeObj.name),f.push(i)}c.push({name:d,items:e,count:e.length,listeners:f})}}return c},getListenersCount:function(){var a=b(this),c=0;for(var d in a)a[d].listeners&&(c+=a[d].listeners.length);return c}}}(),b}),define("tau/core/event.emitter",["tau/core/class","tau/core/event"],function(a,b){var c=function(){},d=a.extend({init:function(a){this.bus=a.bus,b.subscribeOn(this)},"bus refresh":function(a){this.lifeCycleCleanUp()},lifeCycleCleanUp:c,on:function(){this.bus.on.apply(this.bus,arguments)},fire:function(){return this.bus.fire.apply(this.bus,arguments)},"bus destroy":function(){this.on=c,this.fire=c,this.destroy()},destroy:function(){var a=this.bus.getGlobalBus();a&&a.removeAllListeners(this),b.unSubscribe(this),delete this.bus}});return d}),define("tau/core/typesClass",["Underscore","tau/core/class"],function(a,b){return b.extend({init:function(){this._dictionary={}},registerType:function(b,c){c[b.name]=b,b.aliases=b.aliases||[],b.refs=b.refs||{},a.each(b.aliases,function(a){c[a]=c[a.toLowerCase()]=b})},register:function(a){var b=this,c=b._dictionary;this.registerType(a,c)},findByKeyword:function(a){return this._dictionary[a]||null},getDictionary:function(){return this._dictionary}})}),define("tau/core/types",["tau/core/typesClass"],function(a){return new a}),define("tau/core/types.targetprocess.generated",["tau/core/types"],function(a){return[{name:"context"},{name:"process",parent:null,resource:"processes",aliases:["Process","processes","Processes"],fields:["id","name"],simpleFields:["id","name","description","entityStates-count","projects-count","practices-count","customFields-count"],refs:{entityStates:{list:!0,name:"entityState"},projects:{list:!0,name:"project"},practices:{list:!0,name:"practice"},customFields:{list:!0,name:"customField"}}},{name:"practice",parent:null,resource:"practices",aliases:["Practice","practices","Practices"],fields:["id","name"],simpleFields:["id","name","description","processes-count"],refs:{processes:{list:!0,name:"process"}}},{name:"entityType",parent:null,resource:"entityTypes",aliases:["EntityType","entityTypes","EntityTypes"],fields:["id","name"],simpleFields:["id","name","entityStates-count"],refs:{entityStates:{list:!0,name:"entityState"}}},{name:"priority",parent:null,resource:"priorities",aliases:["Priority","priorities","Priorities"],fields:["id","name"],simpleFields:["id","name","importance","isDefault"],refs:{entityType:{name:"entityType"}}},{name:"severity",parent:null,resource:"severities",aliases:["Severity","severities","Severities"],fields:["id","name"],simpleFields:["id","name","importance","isDefault"],refs:{}},{name:"entityState",parent:null,resource:"entityStates",aliases:["EntityState","entityStates","EntityStates"],fields:["id","name"],simpleFields:["id","name","isInitial","isFinal","isPlanned","isCommentRequired","numericPriority","nextStates-count","previousStates-count"],refs:{role:{name:"role"},nextStates:{list:!0,name:"entityState"},previousStates:{list:!0,name:"entityState"},entityType:{name:"entityType"},process:{name:"process"}}},{name:"general",parent:null,resource:"generals",aliases:["General","generals","Generals"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","comments-count","messages-count","attachments-count"],refs:{entityType:{name:"entityType"},owner:{name:"generalUser"},project:{name:"project"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"assignable",parent:"general",resource:"assignables",aliases:["Assignable","assignables","Assignables"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{assignedUser:{list:!0,name:"generalUser"},release:{name:"release"},iteration:{name:"iteration"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},times:{list:!0,name:"time"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},project:{name:"project"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"generalUser",parent:null,resource:"generalUsers",aliases:["GeneralUser","generalUsers","GeneralUsers"],fields:["id","firstName","lastName"],simpleFields:["id","firstName","lastName","email","login","createDate","modifyDate","isActive","isAdministrator","kind","password","assignables-count","comments-count"],refs:{assignables:{list:!0,name:"assignable"},comments:{list:!0,name:"comment"}}},{name:"user",parent:"generalUser",resource:"users",aliases:["User","users","Users"],fields:["id","firstName","lastName"],simpleFields:["id","weeklyAvailableHours","currentAllocation","currentAvailableHours","availableFrom","availableFutureAllocation","availableFutureHours","isObserver","firstName","lastName","email","login","createDate","modifyDate","isActive","isAdministrator","kind","password","times-count","impediments-count","customActivities-count","revisions-count","assignables-count","comments-count"],refs:{role:{name:"role"},times:{list:!0,name:"time"},impediments:{list:!0,name:"impediment"},customActivities:{list:!0,name:"customActivity"},revisions:{list:!0,name:"revision"},assignables:{list:!0,name:"assignable"},comments:{list:!0,name:"comment"}}},{name:"project",parent:"general",resource:"projects",aliases:["Project","projects","Projects"],fields:["id","name"],simpleFields:["id","isActive","isProduct","abbreviation","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","generals-count","features-count","releases-count","iterations-count","userStories-count","tasks-count","bugs-count","testCases-count","testPlans-count","builds-count","times-count","revisions-count","customActivities-count","projectMembers-count","requests-count","testPlanRuns-count","comments-count","messages-count","attachments-count"],refs:{generals:{list:!0,name:"general"},program:{name:"program"},process:{name:"process"},features:{list:!0,name:"feature"},releases:{list:!0,name:"release"},iterations:{list:!0,name:"iteration"},userStories:{list:!0,name:"userStory"},tasks:{list:!0,name:"task"},bugs:{list:!0,name:"bug"},testCases:{list:!0,name:"testCase"},testPlans:{list:!0,name:"testPlan"},builds:{list:!0,name:"build"},times:{list:!0,name:"time"},revisions:{list:!0,name:"revision"},customActivities:{list:!0,name:"customActivity"},company:{name:"company"},projectMembers:{list:!0,name:"projectMember"},requests:{list:!0,name:"request"},testPlanRuns:{list:!0,name:"testPlanRun"},entityType:{name:"entityType"},owner:{name:"generalUser"},project:{name:"project"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"program",parent:"general",resource:"programs",aliases:["Program","programs","Programs"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","projects-count","comments-count","messages-count","attachments-count"],refs:{projects:{list:!0,name:"project"},entityType:{name:"entityType"},owner:{name:"generalUser"},project:{name:"project"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"release",parent:"general",resource:"releases",aliases:["Release","releases","Releases"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","iterations-count","assignables-count","features-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","requests-count","builds-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},iterations:{list:!0,name:"iteration"},assignables:{list:!0,name:"assignable"},features:{list:!0,name:"feature"},userStories:{list:!0,name:"userStory"},tasks:{list:!0,name:"task"},bugs:{list:!0,name:"bug"},testPlanRuns:{list:!0,name:"testPlanRun"},requests:{list:!0,name:"request"},builds:{list:!0,name:"build"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"iteration",parent:"general",resource:"iterations",aliases:["Iteration","iterations","Iterations"],fields:["id","name"],simpleFields:["id","velocity","duration","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","assignables-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","requests-count","builds-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},release:{name:"release"},assignables:{list:!0,name:"assignable"},userStories:{list:!0,name:"userStory"},tasks:{list:!0,name:"task"},bugs:{list:!0,name:"bug"},testPlanRuns:{list:!0,name:"testPlanRun"},requests:{list:!0,name:"request"},builds:{list:!0,name:"build"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"feature",parent:"assignable",resource:"features",aliases:["Feature","features","Features"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","userStories-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},release:{name:"release"},userStories:{list:!0,name:"userStory"},requests:{list:!0,name:"request"},assignedUser:{list:!0,name:"generalUser"},iteration:{name:"iteration"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},times:{list:!0,name:"time"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"userStory",parent:"assignable",resource:"userStories",aliases:["UserStory","userStories","UserStories"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","tasks-count","bugs-count","testCases-count","times-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},feature:{name:"feature"},tasks:{list:!0,name:"task"},bugs:{list:!0,name:"bug"},testCases:{list:!0,name:"testCase"},times:{list:!0,name:"time"},release:{name:"release"},iteration:{name:"iteration"},requests:{list:!0,name:"request"},assignedUser:{list:!0,name:"generalUser"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"task",parent:"assignable",resource:"tasks",aliases:["Task","tasks","Tasks"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","times-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},userStory:{name:"userStory"},times:{list:!0,name:"time"},release:{name:"release"},iteration:{name:"iteration"},requests:{list:!0,name:"request"},assignedUser:{list:!0,name:"generalUser"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"bug",parent:"assignable",resource:"bugs",aliases:["Bug","bugs","Bugs"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","times-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},build:{name:"build"},userStory:{name:"userStory"},severity:{name:"severity"},times:{list:!0,name:"time"},release:{name:"release"},iteration:{name:"iteration"},requests:{list:!0,name:"request"},assignedUser:{list:!0,name:"generalUser"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"testCase",parent:"general",resource:"testCases",aliases:["TestCase","testCases","TestCases"],fields:["id","name"],simpleFields:["id","steps","success","lastStatus","lastFailureComment","lastRunDate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","testPlans-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},userStory:{name:"userStory"},priority:{name:"priority"},testPlans:{list:!0,name:"testPlan"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"testCaseRun",parent:null,resource:"testCaseRuns",aliases:["TestCaseRun","testCaseRuns","TestCaseRuns"],fields:["id"],simpleFields:["id","executed","passed","comment","runDate"],refs:{testPlanRun:{name:"testPlanRun"}}},{name:"testPlan",parent:"general",resource:"testPlans",aliases:["TestPlan","testPlans","TestPlans"],fields:["id","name"],simpleFields:["id","initialEstimate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","testCases-count","testPlanRuns-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},testCases:{list:!0,name:"testCase"},testPlanRuns:{list:!0,name:"testPlanRun"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"testPlanRun",parent:"assignable",resource:"testPlanRuns",aliases:["TestPlanRun","testPlanRuns","TestPlanRuns"],fields:["id","name"],simpleFields:["id","passedCount","failedCount","notRunCount","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","testCaseRuns-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{release:{name:"release"},build:{name:"build"},iteration:{name:"iteration"},testPlan:{name:"testPlan"},project:{name:"project"},testCaseRuns:{list:!0,name:"testCaseRun"},assignedUser:{list:!0,name:"generalUser"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},times:{list:!0,name:"time"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"time",parent:null,resource:"times",aliases:["Time","times","Times"],fields:["id"],simpleFields:["id","description","spent","remain","isEstimation","date","createDate"],refs:{project:{name:"project"},user:{name:"user"},assignable:{name:"assignable"},role:{name:"role"},customActivity:{name:"customActivity"}}},{name:"revision",parent:null,resource:"revisions",aliases:["Revision","revisions","Revisions"],fields:["id"],simpleFields:["id","sourceControlId","description","commitDate","revisionFiles-count","assignables-count"],refs:{project:{name:"project"},revisionFiles:{list:!0,name:"revisionFile"},author:{name:"user"},assignables:{list:!0,name:"assignable"}}},{name:"revisionFile",parent:null,resource:"revisionFiles",aliases:["RevisionFile","revisionFiles","RevisionFiles"],fields:["id","fileName"],simpleFields:["id","fileName"],refs:{revision:{name:"revision"}}},{name:"customActivity",parent:null,resource:"customActivities",aliases:["CustomActivity","customActivities","CustomActivities"],fields:["id","name"],simpleFields:["id","name","created","estimate","times-count"],refs:{project:{name:"project"},user:{name:"user"},times:{list:!0,name:"time"}}},{name:"request",parent:"assignable",resource:"requests",aliases:["Request","requests","Requests"],fields:["id","name"],simpleFields:["id","sourceType","isReplied","effort","effortCompleted","effortToDo","timeSpent","timeRemain","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","tasks-count","features-count","userStories-count","bugs-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},release:{name:"release"},iteration:{name:"iteration"},requestType:{name:"requestType"},tasks:{list:!0,name:"task"},features:{list:!0,name:"feature"},userStories:{list:!0,name:"userStory"},bugs:{list:!0,name:"bug"},assignedUser:{list:!0,name:"generalUser"},priority:{name:"priority"},entityState:{name:"entityState"},assignments:{list:!0,name:"assignment"},impediments:{list:!0,name:"impediment"},times:{list:!0,name:"time"},roleEfforts:{list:!0,name:"roleEffort"},revisions:{list:!0,name:"revision"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"requestType",parent:null,resource:"requestTypes",aliases:["RequestType","requestTypes","RequestTypes"],fields:["id","name"],simpleFields:["id","name","requests-count"],refs:{requests:{list:!0,name:"request"}}},{name:"build",parent:"general",resource:"builds",aliases:["Build","builds","Builds"],fields:["id","name"],simpleFields:["id","buildDate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","bugs-count","testPlanRuns-count","comments-count","messages-count","attachments-count"],refs:{project:{name:"project"},release:{name:"release"},iteration:{name:"iteration"},bugs:{list:!0,name:"bug"},testPlanRuns:{list:!0,name:"testPlanRun"},entityType:{name:"entityType"},owner:{name:"generalUser"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"comment",parent:null,resource:"comments",aliases:["Comment","comments","Comments"],fields:["id"],simpleFields:["id","description","parentId","createDate"],refs:{general:{name:"general"},owner:{name:"generalUser"}}},{name:"assignment",parent:null,resource:"assignments",aliases:["Assignment","assignments","Assignments"],fields:["id"],simpleFields:["id"],refs:{assignable:{name:"assignable"},generalUser:{name:"user"},role:{name:"role"}}},{name:"role",parent:null,resource:"roles",aliases:["Role","roles","Roles"],fields:["id","name"],simpleFields:["id","name","isPair","hasEffort","roleEfforts-count","entityStates-count"],refs:{roleEfforts:{list:!0,name:"roleEffort"},entityStates:{list:!0,name:"entityState"}}},{name:"impediment",parent:"general",resource:"impediments",aliases:["Impediment","impediments","Impediments"],fields:["id","name"],simpleFields:["id","isPrivate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","comments-count","messages-count","attachments-count"],refs:{assignable:{name:"assignable"},entityState:{name:"entityState"},priority:{name:"priority"},responsible:{name:"user"},entityType:{name:"entityType"},owner:{name:"generalUser"},project:{name:"project"},comments:{list:!0,name:"comment"},messages:{list:!0,name:"message"},attachments:{list:!0,name:"attachment"}}},{name:"company",parent:null,resource:"companies",aliases:["Company","companies","Companies"],fields:["id","name"],simpleFields:["id","name","url","description","projects-count"],refs:{projects:{list:!0,name:"project"}}},{name:"roleEffort",parent:null,resource:"roleEfforts",aliases:["RoleEffort","roleEfforts","RoleEfforts"],fields:["id"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain"],refs:{assignable:{name:"assignable"},role:{name:"role"}}},{name:"projectMember",parent:null,resource:"projectMembers",aliases:["ProjectMember","projectMembers","ProjectMembers"],fields:["id"],simpleFields:["id","weeklyAvailableHours","membershipEndDate","allocation"],refs:{project:{name:"project"},user:{name:"user"},role:{name:"role"}}},{name:"message",parent:null,resource:"messages",aliases:["Message","messages","Messages"],fields:["id"],simpleFields:["id","subject","recipients","body","isRead","isProcessed","createDate","sendDate","messageType","contentType","generals-count","attachments-count"],refs:{from:{name:"generalUser"},to:{name:"generalUser"},messageUid:{name:"messageUid"},generals:{list:!0,name:"general"},attachments:{list:!0,name:"attachment"}}},{name:"messageUid",parent:null,resource:"messageUids",aliases:["MessageUid","messageUids","MessageUids"],fields:["id"],simpleFields:["id","uid","mailServer","mailLogin"],refs:{}},{name:"customField",parent:null,resource:"customFields",aliases:["CustomField","customFields","CustomFields"],fields:["id","name","entityFieldName"],simpleFields:["id","name","value","entityFieldName","fieldType","enabledForFilter","required"],refs:{entityType:{name:"entityType"},process:{name:"process"}}},{name:"resourceBase",parent:"resource",resource:"resourceBases",aliases:["ResourceBase","resourceBases","ResourceBases"],fields:["id"],simpleFields:["id","actions-count"],refs:{actions:{list:!0,name:"action"}}},{name:"attachment",parent:null,resource:"attachments",aliases:["Attachment","attachments","Attachments"],fields:["id","name"],simpleFields:["id","name","description","date","mimeType","uri","thumbnailUri","size"],refs:{owner:{name:"generalUser"},general:{name:"general"},message:{name:"message"}}},{name:"history",parent:"resource",resource:"histories",aliases:["History","histories","Histories"],fields:["id"],simpleFields:["id","date","description","modification"],refs:{entity:{name:"general"},innerEntity:{name:"general"},modifier:{name:"generalUser"}}},{name:"change",parent:"resource",resource:"changes",aliases:["Change","changes","Changes"],fields:["id"],simpleFields:["id","field","oldValue","newValue"],refs:{history:{name:"history"}}},{name:"action",parent:"resource",resource:"actions",aliases:["Action","actions","Actions"],fields:["id","name"],simpleFields:["id","name","uri"],refs:{entity:{name:"resourceBase"}}},{name:"page",parent:"resource",resource:"pages",aliases:["Page","pages","Pages"],fields:["id"],simpleFields:["id","prev","next","items-count"],refs:{items:{list:!0,name:"resource"}}},{name:"context",parent:null,resource:"contexts",aliases:["Context","contexts","Contexts"],fields:["id"],simpleFields:["id","acid","selectedProjects-count","processes-count"],refs:{loggedUser:{name:"user"},culture:{name:"culture"},selectedProjects:{list:!0,name:"projectInfo"},processes:{list:!0,name:"processInfo"}}},{name:"culture",parent:null,resource:"cultures",aliases:["Culture","cultures","Cultures"],fields:["id","name"],simpleFields:["id","name","decimalSeparator","shortDateFormat","longDateFormat","timePattern"],refs:{}},{name:"processInfo",parent:null,resource:"processInfos",aliases:["ProcessInfo","processInfos","ProcessInfos"],fields:["id","name"],simpleFields:["id","name","terms-count","customFields-count","practices-count"],refs:{terms:{list:!0,name:"term"},customFields:{list:!0,name:"customFieldInfo"},practices:{list:!0,name:"practice"}}},{name:"term",parent:null,resource:"terms",aliases:["Term","terms","Terms"],fields:["id","name"],simpleFields:["id","name","value"],refs:{}},{name:"customFieldInfo",parent:null,resource:"customFieldInfos",aliases:["CustomFieldInfo","customFieldInfos","CustomFieldInfos"],fields:["id","name"],simpleFields:["id","entityKind","name","type","required","listed"],refs:{}},{name:"projectInfo",parent:null,resource:"projectInfos",aliases:["ProjectInfo","projectInfos","ProjectInfos"],fields:["id","name"],simpleFields:["id","name"],refs:{process:{name:"processInfo"},program:{name:"programInfo"}}},{name:"programInfo",parent:null,resource:"programInfos",aliases:["ProgramInfo","programInfos","ProgramInfos"],fields:["id","name"],simpleFields:["id","name"],refs:{}}]}),define("tau/core/types.targetprocess",["Underscore","tau/core/types","tau/core/types.targetprocess.generated"],function(a,b,c){var d=function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a.charAt(c);c===0?e=e.toUpperCase():e===e.toUpperCase()&&b.push(" "),b.push(e)}return b.join("")},e=function(a){return{key:a,val:a}},f=function(a){var b=a.length-1;if(a.charAt(b)==="y"){var c=a.substring(0,b),d="ies";a=c+d}else a+="s";return{key:a,val:a}},g=function(a){var b=a.split(" "),c=b.length,d=c-1||0,e=b[d];return{key:a+" Big Icon Text",val:e}},h=function(a){var b=a.split(" "),c=b.length,d=c-1||0,e=b[d];return{key:a+" Small Icon Text",val:e.charAt(0)}},i=function(a){if(a&&a.entityType&&a.entityType.name)return a.entityType.name;throw"type of entity is not detected"},j=function(a){var b=d(a);return{name:e(b),names:f(b),iconBig:g(b),iconSmall:h(b)}};return a.each(c,function(a){a.name==="userStory"&&(a.aliases.unshift("story","stories","us"),a.simpleFields.push("tasks-effort-sum","tasks-effortToDo-sum"));if(a.name==="general"||a.name==="assignable")a.isParentType=!0,a.discriminator={entityType:["id","name"]},a.detectType=i;(a.parent==="general"||a.parent==="assignable")&&a.simpleFields.push("customFields"),a.terms=j(a.name),a.name==="process"&&a.refs&&a.refs.customFields&&delete a.refs.customFields,a.name==="processInfo"&&a.refs&&(a.refs={}),a.name==="context"&&(a.refs||(a.refs={}),a.refs.culture&&delete a.refs.culture,a.refs.selectedProjects={list:!0,name:"project"},a.simpleFields=["id","acid"]),b.register(a)}),b.register({name:"implementationHistory",aliases:["stats"]}),b.register({name:"prioritizer",fields:["id"],refs:[]}),b}),define("tau/core/termProcessor",["Underscore","tau/core/class","tau/core/types.targetprocess"],function(a,b,c){var d=b.extend({init:function(a){a=a||[],this.mapping={};for(var b=0,c=a.length;b<c;b++){var d=a[b];this.mapping[d.name]=this.mapping[d.name.toLowerCase()]=d.value}},resolve:function(a,b){var c=b||a;return a&&this.mapping.hasOwnProperty(a)&&(c=this.mapping[a]),c},getTerms:function(b){var d=this,e=c.findByKeyword(b),f=e.terms,g=a(f).keys(),h={};return a(g).each(function(a){h[a]=d.resolve(f[a].key,f[a].val)}),h}});return d}),define("tau/ui/templateRenderer.extensions",["Underscore","tau/core/class","tau/core/termProcessor"],function(a,b,c){var d=b.extend({init:function(a){this.termProc=new c(a.terms)},terms:function(a){return this.termProc.getTerms(a)},text_implode:function(b){var c=new String(b);if(a.isString(b))c=b;else if(a.isArray(b)){var d=a.clone(b),e=d.pop();c=a.filter([d.join(", "),e],function(a){return a!=0}).join(" &amp; ")}return c},key:function(a,b){}});return d}),define("tau/core/templates-factory",["Underscore","jQuery","libs/jquery/jquery.tmpl"],function(a,b){var c={templates:{},initialized:{},get:function(a){var c=this;if(!b.template.hasOwnProperty(a))throw["Template '",a,"' was not found."].join("");return{bind:function(d,e){var f={},g=c.templates[a],h=g.tags||[];for(var i=0;i<h.length;i++){var j=h[i];j.register(d,f)}var k=b.template[a];return b.tmpl(k,e,f)}}},registerRecursively:function(a,c){var d=this;c=c||{tags:[]};var e=null;if(!b.template.hasOwnProperty(a)){e=this.templates[a];if(!e)throw["Template '",a,"' was not found."].join("");e.tags&&(c.tags=c.tags.concat(e.tags)),b.each(e.dependencies,function(a,b){d.registerRecursively(b,c)}),e.tags=c.tags;var f=e.markup;b.isArray(f)&&(f=f.join("")),b.template(a,f)}else e=e||this.templates[a],e.tags&&(c.tags=c.tags.concat(e.tags))},register:function(a){var b=this;return a.dependencies=a.dependencies||[],this.templates[a.name]=a,b.registerRecursively(a.name),{name:a.name,options:a.options||{},get:function(){return b.get(a.name)}}}};return c}),define("tau/ui/templateRenderer",["Underscore","jQuery","libs/jquery/jquery.tmpl"],function(a,b){return b.extend(b.tmpl.tag,{"@":{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while(!$__t.$tau && $__t.parent){","$__t = $__t.parent","}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")},tauKey:{_default:{$1:"id",$2:"null"},open:['_=_.concat(new String(window._.complexKey($2["data"], $1) || "").toString());'].join("")}}),b}),define("tau/core/view-base",["Underscore","jQuery","tau/core/event.emitter","tau/ui/templateRenderer.extensions","tau/core/templates-factory","tau/ui/templateRenderer"],function(a,b,c,d,e){var f=c.extend({init:function(a){this._super(a),this.config=a||{}},destroy:function(){this._super(),this.element&&this.element.remove(),delete this.element,delete this.config},merge:function(c,d){var e=this;if(d&&e.element){b.isArray(d)||(d=[d]);var f=a(d).isArray()?d:[d],g=this.element;a(f).each(function(a){var d=g.find(a),e=c.find(a);d.each(function(a){b(this).replaceWith(e.eq(a))})})}},bindTemplate:function(a){var b=this.config.template.name,c=e.get(b).bind(this.config,a);return c},prepareElement:function(a){var b=this.config.template.name,c=" tmpl-"+b,d="ui-placeholder"+c.replace(".","-");return a.addClass(d),a},updateElement:function(a,b){var c=this;c.element&&b?c.merge(a,b):(c.element&&(a.length?c.element.replaceWith(a):c.element.remove()),c.element=a)},doRender:function(a,b){var c=this.bindTemplate(a);c=this.prepareElement(c),this.updateElement(c,b),!this.config.visible&&this.hide()},fireAfterInit:function(a){this.fire("afterInit",{config:this.config,refreshSelector:a})},initialize:function(a){var b=this;this.fireAfterInit(a)},setDefaultConfig:function(){var b=this;a.defaults(b.config,{visible:!0})},"bus refreshData":function(a){this.doRender(a.data),this.fire("elementRefreshedWithData",{element:this.element})},"bus refresh":function(a){this._super();var b=a.data||{},c=b.refreshSelector;this.startLifeCycle(a,c)},"bus initialize":function(a){this.startLifeCycle(a)},startLifeCycle:function(b,c){var d=this;d.setDefaultConfig(),a.extend(d.config,b.data),d.fire("beforeInit",{config:d.config}),this.initialize(c)},"bus show":function(){this.show()},"bus hide":function(){this.hide()},showElement:function(){this.element.show()},show:function(){this.showElement(),this.config.visible=!0},hideElement:function(){this.element.hide()},hide:function(){this.hideElement(),this.config.visible=!1},"bus applyTo":function(a){this.element=a.data.element},"bus afterInit+dataBind":function(a){this.render(a.dataBind.data,a.afterInit.data)},render:function(a,b){this.fireBeforeRender({data:a}),this.doRender(a,b.refreshSelector),this.fireAfterRender({data:a})},fireBeforeRender:function(a){a=a||{},this.fire("beforeRender",{data:a.data,view:this,element:this.element})},fireAfterRender:function(a){a=a||{},this.fire("afterRender",{data:a.data,view:this,element:this.element})}});return f}),define("tau/core/event-dispatcher",["Underscore","tau/core/class"],function(a,b){var c=b.extend({init:function(a){this.components=a,this.eventArgsQueue={},this.dictionaryQueue={}},listen:function(b,c){var d=this;d.dictionaryQueue.hasOwnProperty(b)||(d.dictionaryQueue[b]=a(d.components).clone(),d.eventArgsQueue[b]=[]);var e=function(b){var e=b.sender;b.removeListener();var f=a(d.components).indexOf(e);d.eventArgsQueue[b.name][f]=b.data,d.dictionaryQueue[b.name]=a(d.dictionaryQueue[b.name]).without(e);if(a.isEmpty(d.dictionaryQueue[b.name])){var g={eventName:b.name,argsArr:d.eventArgsQueue[b.name]};c(g)}};a(d.components).each(function(a){a.on(b,e,null,{},1e3)})}});return c}),define("tau/ui/templates/container/ui.template.container.list",["tau/core/templates-factory"],function(a){var b={name:"container.list",markup:['<div class="tau-container ${cssClass}"></div>'],dependencies:[]};return a.register(b)}),define("tau/components/extensions/component.extension.base",["Underscore","tau/core/event.emitter"],function(a,b){var c=function(b){return b!=="bus"&&!a.isFunction(this[b])},d=function(a){delete this[a]},e=b.extend({init:function(a){this._super(a),this.config=a},"bus beforeInit":function(b){this.config||console.log("config is null "+this.category),a(this.config).extend((b.data||{}).config)},"bus afterRender":function(a){this.element=a.data.element},createComponents:function(a,b){var c={bus:this.bus,config:a,create:function(){this.bus.on("componentsCreated",this.onComponentCreated,this),this.bus.fire("createComponents",this.config,this)},onComponentCreated:function(a){if(a.caller!==this)return;a.removeListener(),b(a.data)}};c.create()},isEntityInContext:function(a){var b=this.config.context.entity.id,c=b==(a.data.entity||a.data.assignable).id;return c},destroy:function(){delete this.config;var b=a.keys(this);a(b).chain().select(c,this).each(d,this).value(),this._super()}});return e}),define("tau/components/extensions/additionalInfo/extension.additionalInfo.editable",["jQuery","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({category:"edit",editableIndexes:null,init:function(){this._super.apply(this,arguments),this.onRowClickProxy=a.proxy(this.onRowClick,this)},"bus beforeComponentsInitialize":function(a){this.editableIndexes=[],this.createComponentList(a.data),this.attachListeners()},"bus afterRender":function(a){this.$el=a.data.element,this.addEditableBehaviour()},"bus refresh":function(){this.clearComponent()},createComponentList:function(a){this.components=[];for(var b=1;b<a.length;b+=2)this.components.push(a[b].component)},addEditableBehaviour:function(){for(var a=0;a<this.editableIndexes.length;a++)this.doEditableRow(this.editableIndexes[a])},attachListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].on("permissionsReady",this.onPermissionsReady,this,{index:b})},removeListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].removeListener("permissionsReady",this.onPermissionsReady,this)},onRowClick:function(b){a(b.target).hasClass("ui-type-icon")===!1&&(b.stopPropagation(),b.data.component.fire("edit"))},doEditableRow:function(a){var b=this.$el.find(" > tbody > tr").eq(a),c=this.onRowClickProxy;b.unbind("click",c),b.bind("click",{component:this.components[a]},c),b.addClass("ui-additionalinfo_editable_true")},onPermissionsReady:function(a){if(a.data.editable){var b=a.listenerData.index;this.$el?this.doEditableRow(b):this.editableIndexes.push(b)}},clearComponent:function(){this.removeListeners(),delete this.components,delete this.editableIndexes,delete this.$el},destroy:function(){this.clearComponent(),this._super()}})}),define("tau/components/extensions/additionalInfo/extension.additionalInfo.updateAnimation",["jQuery","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({category:"edit",editableIndexes:null,init:function(){this._super.apply(this,arguments),this.onRowClickProxy=a.proxy(this.onRowClick,this)},"bus beforeComponentsInitialize":function(a){this.editableIndexes=[],this.createComponentList(a.data),this.attachListeners()},"bus afterRender":function(a){this.$el=a.data.element},"bus refresh":function(){this.clearComponent()},createComponentList:function(a){this.components=[];for(var b=1;b<a.length;b+=2)this.components.push(a[b].component)},attachListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].on("beforeChangeProperty",this.onBeforeChangeProperty,this,{index:b}),a[b].on("propertyChanged",this.onPropertyChanged,this,{index:b,component:a[b]},1)},removeListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].removeListener("permissionsReady",this.onPermissionsReady,this)},onRowClick:function(a){a.stopPropagation(),a.data.component.fire("edit")},onPropertyChanged:function(a){var b=a.listenerData.index,c=a.listenerData.component,d=this;c.on("afterRender",function(a){a.removeListener();var c=d.$el.find(" > tbody > tr").eq(b).find(">td");d.fire("updateElement",{element:c})},c)},markRowAsUpdating:function(a){var b=this.$el.find(" > tbody > tr").eq(a).find(">td");this.fire("markElementToBeUpdated",{element:b})},onBeforeChangeProperty:function(a){var b=a.listenerData.index;this.markRowAsUpdating(b)},clearComponent:function(){this.removeListeners(),delete this.components,delete this.editableIndexes,delete this.$el},destroy:function(){this.clearComponent(),this._super()}})}),define("tau/components/extensions/component.creator.extension",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){var c=b.extend({getDependencies:function(b){var c=[];return a(b).each(function(a){if(a.path)c.push(a.path);else{if(!a.type)throw"Configuration error: type or path is missing";var b="tau/components/component."+a.type;c.push(b)}}),c},childrenLoadedCallback:function(b,c){var d=this,e=[];a(b).each(function(a){a.name||(a.name="",a.type&&(a.name=a.type),a.id&&(a.name+=":"+a.id));var b=a.component.create(a);d.fire("componentCreated",{component:b}),e.push({config:a,component:b})}),d.fire("componentsCreated",e,c)},createDependenciesLoadedCallback:function(b,c){var d=this,e=b.components,f=b.context;return function(){var b=arguments;a(e).each(function(a,c){a.component=b[c],a.context=f}),d.childrenLoadedCallback(e,c)}},"bus createComponents":function(b){var c=b.data,d=b.caller,e=c.components;e=c.components=a.isArray(e)?e:[e];var f=this.getDependencies(e);require(f,this.createDependenciesLoadedCallback(c,d))}});return c}),define("tau/ui/templates/container/ui.template.container.table",["tau/core/templates-factory"],function(a){var b={name:"container.table",markup:['<table class="${cssClass} container-table">',"   <tr></tr>","</table>"],dependencies:[]};return a.register(b)}),define("tau/views/view.container",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher","tau/ui/templates/container/ui.template.container.list","tau/ui/templates/container/ui.template.container.table"],function(a,b,c,d){var e=c.extend({init:function(a){this._loaded=!1,this._super(a)},completeInitializationWithoutChildren:function(){var a=this;a.fire("afterInit"),a._fireChildrenRendered({children:[],childrenEvtArgs:[]})},setDefaultConfig:function(){var b=this;b._super(),a.defaults(b.config,{template:{name:"container."+(b.config.layout||"list")}})},"bus componentCreated":function(a){var b=a.data.component;this.fire("childComponentCreated",b),this.children.push(b)},_fireChildrenRendered:function(a){this.fire("internalChildrenRendered",a)},"bus afterInit+internalChildrenRendered":function(b){var c=this._getRenderConfig();this.fireBeforeRender({data:c}),this.doRender(c);var d=b.internalChildrenRendered.data;a.extend(d,{config:this.config}),this.fire("childrenRendered",d),this.fireAfterRender({data:c})},initializeComponents:function(b){var c=this;c.dispatcher=new d(c.children);var e=["afterInit"],f=function(a){c.fire(a.eventName)};a(e).each(function(a){c.dispatcher.listen(a,f)}),c.dispatcher.listen("afterRender",function(a){var b=a.argsArr,d={children:c.children,childrenEvtArgs:b};c._fireChildrenRendered(d)});var g=a(b.data).pluck("config");a(c.children).each(function(a,b){a.fire("initialize",g[b])})},"bus componentsCreated":function(a){this.fire("beforeComponentsInitialize",a.data),this.initializeComponents(a),this.fire("afterComponentsInitialize",a.data)},lifeCycleCleanUp:function(){this.destroyChildren()},"bus refresh":function(a){this.startLifeCycle()},startLifeCycle:function(b){var c=this;c.setDefaultConfig(),a.extend(c.config,b.data),c.fire("beforeInit",{config:c.config});var d=c.config.children;c.children=[];var e=a.size(d)>0&&c.config.visible;if(e){var f=c.config.children,g=c.config.context||{};this.fire("createComponents",{components:f,context:g})}else c.completeInitializationWithoutChildren()},"bus initialize":function(a){this.startLifeCycle(a)},hideElement:function(){if(this._loaded&&!b.fx.off){this.element.slideUp(200);return}this._super()},showElement:function(){if(!b.fx.off){this.element.slideDown(200);return}this._super()},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},_getRenderConfig:function(){var a=this.config;return a.visible&&(this._loaded=!0),a},destroyChildren:function(){var a=null;if(this.children&&this.children.length)while(a=this.children.pop())a.destroy();this.children=null},destroy:function(){this.dispatcher=null,this.destroyChildren(),this._super()}});return e}),define("tau/ui/extensions/layout/ui.extension.layout",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus childrenRendered+afterRender":function(b){var c=this;c.element=b.afterRender.data.element;var d=b.childrenRendered.data.childrenEvtArgs;c.config.layout=c.config.layout||"list";var e=c.config,f=["_add",e.layout,"item"].join(" ");e.childrenContainerSelector=e.childrenContainerSelector||(e.layout==="list"?null:"> tbody > tr"),a(d).each(function(a){var b=a.element;c[f](b)})},"_add list item":function(a){var b=a.jquery?a:a.element,c=this.config.childrenContainerSelector?this.element.find(this.config.childrenContainerSelector):this.element;c.append(b)},getTableItemContainer:function(){var a=this,c=a.config,d=a.element.find(c.childrenContainerSelector+":last");if(c.hasOwnProperty("columnCount")){var e=d.children("td").size();e>=c.columnCount&&(d=b("<tr></tr>"),a.element.children("tbody").append(d))}return d},"_add table item":function(a){var c=this,d=a.jquery?a:a.element,e=c.config,f=this.getTableItemContainer(),g=f.children("td").length,h=e.cellsCssClass&&e.cellsCssClass[g]||"";b("<td></td>").addClass(h).append(d).appendTo(f)}})}),define("tau/ui/extensions/spinner/ui.extension.spinner",["tau/components/extensions/component.extension.base"],function(a){return a.extend({options:{spinnerClass:"ui-spinner"},"bus beforeInit":function(a){var b=this;b.element&&b.element.addClass(b.options.spinnerClass)},"bus afterRender":function(a){var b=this;b.element=a.data.element,b.element.removeClass(b.options.spinnerClass)}})}),Function.prototype.tauCreateDelegate=function(a){var b=this,c=(a.bus||{name:""}).name;return c==="entity component"&&console.log(c),function(){b.apply(a,arguments)}},String.prototype.trim=function(a){return function(){var b=this,c=/^\s+/,d=/\s+$/,e=a?a.call(b):b.toString().replace(c,"").replace(d,"");return e}}(String.prototype.trim),Date.prototype.setISO8601=function(a){var b="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",c=a.match(new RegExp(b)),d=0,e=new Date(c[1],0,1);c[3]&&e.setMonth(c[3]-1),c[5]&&e.setDate(c[5]),c[7]&&e.setHours(c[7]),c[8]&&e.setMinutes(c[8]),c[10]&&e.setSeconds(c[10]),c[12]&&e.setMilliseconds(Number("0."+c[12])*1e3),c[14]&&(d=Number(c[16])*60+Number(c[17]),d*=c[15]=="-"?1:-1),d-=e.getTimezoneOffset(),time=Number(e)+d*60*1e3,this.setTime(Number(time))},Date.prototype.toISO8601String=function(a,b){if(!a)var a=6;if(!b)var b="Z",c=this;else{var d=b.match(/([-+])([0-9]{2}):([0-9]{2})/),e=Number(d[2])*60+Number(d[3]);e*=d[1]=="-"?-1:1;var c=new Date(Number(Number(this)+e*6e4))}var f=function(a){return(a<10?"0":"")+a},g="";g+=c.getUTCFullYear(),a>1&&(g+="-"+f(c.getUTCMonth()+1)),a>2&&(g+="-"+f(c.getUTCDate())),a>3&&(g+="T"+f(c.getUTCHours())+":"+f(c.getUTCMinutes()));if(a>5){var h=Number(c.getUTCSeconds()+"."+(c.getUTCMilliseconds()<100?"0":"")+f(c.getUTCMilliseconds()));g+=":"+f(h)}else a>4&&(g+=":"+f(c.getUTCSeconds()));return a>3&&(g+=b),g},define("tau/extensions/extension.javascript",function(){}),define("tau/core/tau",["tau/extensions/extension.javascript"],function(){var a=a||{};return a.empty=function(){},a.ns=function(a){var b=a.split("."),c=window;for(var d=0,e=b.length;d<e;d++){var f=b[d];typeof c[f]=="undefined"&&(c[f]={}),c=c[f]}},a.getValueFromQueryString=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.href);return d==null?"":d[1]},a.extendArgs=function(a,b){var c=a;return c=[].slice.call(a),c.unshift(b),c},a.concat=function(){return String.prototype.concat.apply("",arguments)},a.createScopedCallbackIfRequired=function(b){return typeof b=="function"?b:a.createScopedCallback(b.fn,b.scope)},a.createScopedCallback=function(a,b){return typeof a!="function"&&typeof a.fn=="function"&&(a=a.fn,a.scope&&(b=a.scope)),typeof a=="function"&&b&&(a=a.tauCreateDelegate(b)),a},a.getCallbacks=function(b){b=b||{},b.success||(b.success=a.empty),b.failure||(b.failure=a.empty);var c=a.createScopedCallback(b.success,b.scope),d=a.createScopedCallback(b.failure,b.scope);return{success:c,failure:d}},a}),define("tau/store/store",["Underscore","tau/core/class","tau/core/tau","tau/core/types","tau/core/typesClass","tau/extensions/extension.underscore"],function(a,b,c,d,e){var f={_processCommand:function(a,b,c,d){d=d||{};var e=this.types[b];e&&(b=e.name);var f={type:b,name:a,config:c,callbacks:d};return this.commands.push(f),this}},g=function(){var b=this;if(a.isEmpty(b._frozenPromises)){var c=[].concat(b._frozenCommandsQueue);b._frozenCommandsQueue=[],b.config.proxy.execute(c)}};return b.extend({init:function(b){var g=this;g.id=a.uniqueId("store_"),g._frozenCommandsQueue=[],g._frozenPromises={},g.config=b,g.eventEmitter=g.config.eventEmitter||{fire:function(){},on:function(){},removeAllListeners:function(){}};var h=b.types||b.proxy.types;if(h){var i=new e;a(h).each(function(a){i.register(a)}),f.types=i.getDictionary()}else f.types=d.getDictionary();var j=a.functionsExt(b.proxy);a.each(j,function(a){var b=a.split("api ");if(b.length!==2)return;var d=b[1];f[d]=function(){var a=c.extendArgs(arguments,d);return this._processCommand.apply(this,a)}}),g._extendWithCommonAPI(g,g)},_extendWithCommonAPI:function(b,c){a.each(a.functionsExt(f),function(d){if(d[0]=="_")return;b[d]=function(){var e=a.extend({},f);return e.commands=b.commands||[],e[d].apply(e,arguments),e.done=function(a){c._done(e.commands,a)},e}})},freeze:function(){var b=this,d=a.uniqueId(),e={id:d,unfreeze:function(){this.unfreeze=c.empty,delete b._frozenPromises[d],g.call(b)}};return b._frozenPromises[e.id]=e,e},on:function(a,b){return this.config.proxy.on(a,b),this.eventEmitter.fire("afterStoreOn",a),this},unbind:function(a){return this.config.proxy.unbind(a),this.eventEmitter.fire("afterStoreUnbind",a),this},_processChain:function(b,d){d=c.getCallbacks(d);var e=[].concat(b);a.each(b,function(f){var g=c.getCallbacks(f.callbacks),h=function(c,h){e[a.indexOf(e,f)]=c;var i=a.select(b,function(a){return a.executed!==!0});g[h](c);if(i.length===0){var j=a.select(b,function(a){return a.failed===!0});d[j.length>0?"failure":"success"](e)}};f.callbacks={success:function(a){h(a,"success")},failure:function(a){h(a,"failure")}}})},done:function(a){c.getCallbacks(a).success([])},evictProperties:function(a,b,c){this.config.proxy.evictProperties(a,b,c)},isPropertyInitialized:function(a,b,c){return this.config.proxy.isPropertyInitialized(a,b,c)},_done:function(b,c){var d=this;d._processChain(b,c),a.isEmpty(d._frozenPromises)?d.config.proxy.execute(b):d._frozenCommandsQueue=[].concat(d._frozenCommandsQueue,b)}})}),define("tau/core/header",["Underscore","tau/core/tau"],function(a,b){var c=a.extend(b,{ref:function(a,b){var c={};return c[a]=b,c},list:function(a,c){var d=b.ref(a,c);return d.list=!0,d},formatObject:function(b,c){var d=this;c=c?c:"Lower";var e=function(a){return a.charAt(0)["to"+c+"Case"]()+a.substr(1)};if(a.isArray(b)){var f=[];return a.each(b,function(a){f.push(d.formatObject(a,c))}),f}if(a.isUndefined(b)||a.isNull(b))return null;if(typeof b!="object")return b;var g={};return a.each(a.keys(b),function(f){var h=e(f),i=h.split("-");if(i.length>1){var j=[];a.each(i,function(a){j.push(e(a))}),h=j.join("-")}g[h]=d.formatObject(b[f],c)}),g},header:{getFieldName:function(b){return a.getFieldName(b)},isSimple:function(b){return a.isString(b)},isList:function(a){return a.list===!0}}});return c}),define("tau/core/comparer",["Underscore"],function(a){return{isEqualIncluded:function(b,c){if(b===c)return!0;var d=typeof b,e=typeof c;if(d!=e)return!1;if(b==c)return!0;if(!b&&c||b&&!c)return!1;if(a.isDate(b)&&a.isDate(c))return b.getTime()===c.getTime();if(a.isNaN(b)&&a.isNaN(c))return!1;if(a.isRegExp(b)&&a.isRegExp(c))return b.source===c.source&&b.global===c.global&&b.ignoreCase===c.ignoreCase&&b.multiline===c.multiline;if(d!=="object")return!1;if(d==="array"&&b.length&&b.length!==c.length)return!1;var f=a.keys(c);for(var g=0;g<f.length;g++){var h=f[g];if(b.hasOwnProperty(h)&&!this.isEqualIncluded(b[h],c[h]))return!1}return!0},compare:function(b,c){var d=this,e={changes:{}};return b?(a.each(a(c).keys(),function(a){var f={value:c[a]};if(!b.hasOwnProperty(a)){e.changes[a]=f;return}d.isEqualIncluded(b[a],c[a])||(e.changes[a]=f)}),e):e}}}),define("tau/store/db",["Underscore","tau/core/class","tau/core/header","tau/core/comparer"],function(a,b,c,d){return b.extend({init:function(a){this.__data={},this.__types=a.types||{}},_getTypeHolder:function(a,b){var c=a[b]||{};return a.hasOwnProperty(b)||(a[b]=c),c},_getTypeDictionary:function(a){return this._getTypeHolder(this.__data,a)},getPersistedNode:function(a,b){var c=this,d=c.__data[b];if(!d)return null;if(!a)return d;var e=d[a];return e?e:null},isDataRegistered:function(a,b){return(this.__data[b]||{}).hasOwnProperty(a)},_registerReferenceInNode:function(a,b,c,d,e){var f={isReference:!0,id:a,type:b.name};f.property=e,f.list=d.list,c.refs[f.type+"_"+f.id+"_"+f.property]=f},_registerReferences:function(b,c,d){var e=this,f=e._getRegisterTemplate(),g=function(a){return a.id===c.id};return a.each(a(b.refs||{}).keys(),function(h){if(!c.hasOwnProperty(h))return;var i=c[h],j=b.refs[h];if(d.data.hasOwnProperty(h)){var k=d.data[h]||[];a.isArray(k)||(k=[k]),a.each(k,function(a){var d=e.getPersistedNode(a.id,a.type);e._cleanUpRefsInNode(c.id,b.name,d,h)})}if(i===null||i.id===null){c[h]=null,j.list&&(c[h]=[]);return}a.extend(i,{__type:j.name});var l=e.__types[j.name];j.list===!0&&a.each(a(l.refs||{}).keys(),function(c){var f=l.refs[c],g=b;while(g!=null){if(f.name==g.name&&f.list!==!0){a.each(i,function(a){a.hasOwnProperty(c)||(a[c]={id:d.id})});break}g.parent?g=e.__types[g.parent]:g=null}});var m=e._register(i);a.mergeArrayObjects(f,m,["diffs"]),c[h]=j.list?a.extend(m.refs,{isReference:!0,type:j.name,list:!0}):m.refs[0],a.each(m.nodes,function(a){e._registerReferenceInNode(c.id,b,a,j,h)}),j.list!==!0&&l&&a.each(a(l.refs||{}).keys(),function(i){var j=l.refs[i];if(j.name==b.name&&j.list===!0){var k=e.getPersistedNode(c[h].id,l.name)||{},m=k.data||{},n=m[i];if(a.isArray(n)&&!a.any(n,g)){var o={};e._attachReference(n,c.id,b.name),o[i]=n,e._registerReferenceInNode(k.id,k.origin?e.__types[k.origin.type]:l,d,j,i),f.diffs.push({id:k.id,type:l.name,changes:o})}}})}),f},_removeCascadeObjects:function(b,c){var d=this,e=d._getRegisterTemplate();return a.each(a(b.refs||{}).keys(),function(f){var g=b.refs[f];g.cascade&&(g.list?a.each(c[f],function(a){d._extendRegister(e,d.remove(a.id,a.type))}):d._extendRegister(e,d.remove(c[f].id,c[f].type)))}),e},_cleanUpRefsInNode:function(b,c,d,e){a(a(d.refs).keys()).each(function(a){var f=new RegExp(c+"_"+(b||"\\d*")+("_"+e||""));a.search(f)!==-1&&delete d.refs[a]})},_removeObjectFromRefs:function(b,c,d){var e=this,f=e._getRegisterTemplate();return a(d).each(function(d){var g=e.getPersistedNode(d.id,d.type);if(!g)return;f.nodes.push(g);var h={};h[d.property]=null,d.list?(g.data[d.property]=a(g.data[d.property]).select(function(a){return a.id!=b}),h[d.property]=g.data[d.property]):g.data[d.property]=null,e._cleanUpRefsInNode(b,c,g),f.diffs.push({id:d.id,type:d.type,changes:h})}),f},removeProperties:function(b,c,d){var e=this,f=e.getPersistedNode(b,c);if(!f)return;var g=e.__types[c],h=f.data;a(d).each(function(c){var d=h[c];d&&d.isReference&&(d.list||(d=[d]),a(d).each(function(a){var d=e.getPersistedNode(a.id,a.type);e._cleanUpRefsInNode(b,g.name,d,c)})),delete h[c]})},remove:function(b,c){var d=this,e=d._getRegisterTemplate(),f=d.getPersistedNode(b,c);if(!f)return e;var g=d.__types[c],h=f.refs,i=f.data;return e.deletedData.push(a(i).defaults({id:b,type:c})),delete d.__data[c][b],d._extendRegister(e,d._removeCascadeObjects(g,i)),d._extendRegister(e,d._removeObjectFromRefs(b,c,h)),e},isPropertyInitialized:function(a,b,c){var d=this.getPersistedNode(a,b);return d?d.data.hasOwnProperty(c):!1},_attachReference:function(a,b,c){var d={isReference:!0,id:b,type:c};return a.push(d),d},_registerParentNodes:function(b,c,d,e){var f=this,g=f.__types[b];if(g){var h=g.parent;while(h){var i=f.__types[h];e=f._getTypeDictionary(h);if(!i)break;e[c]=e[c]||{},a.extend(e[c],{data:d.data,refs:d.refs,id:c,origin:{id:c,type:b}}),h=i.parent}}},_getRegisterTemplate:function(){return{refs:[],nodes:[],diffs:[],tree:{},deletedData:[]}},_registerObjectInTree:function(b,c){var d=this,e=d._getTypeHolder(b,c.type);if(!e.hasOwnProperty(c.id)){var f={},g=d.__types[c.type],h={id:c.id,changes:f};if(g.isParentType||g.parent){var i=d.getPersistedNode(c.id,c.type);i.origin&&(g=d.__types[i.origin.type],i=d.getPersistedNode(i.origin.id,i.origin.type));var j=g.parent;while(j){var k=d.__types[j],l=d._getTypeHolder(b,k.name);l[c.id]=h,j=k.parent}}e[c.id]=h}a.extend(e[c.id].changes,c.changes)},_extendTree:function(b,c){var d=this;a.each(c,function(a){d._registerObjectInTree(b,a)})},_extendRegister:function(b,c){this._extendTree(b.tree,c.diffs),a.mergeArrayObjects(b,c,["diffs","deleteData"])},register:function(a){var b=this._register(a);return b},isTypeDetectionRequired:function(a){var b=this.__types[a];return b.isParentType},getTypeDetectionForNode:function(a,b){if(!this.isTypeDetectionRequired(b))return{required:!1};var c=this.getPersistedNode(a,b),d={required:!0};return c?c.origin?!c.origin.id||!c.origin.type?d:{required:!1,type:c.origin.type}:d:d},_register:function(b){var c=this,e=c._getRegisterTemplate();if(a.isEmpty(b))return e;var f=b.__type;return a.isArray(b)||(b=[b]),a.each(b,function(b){var g=b.__type||f,h=b.id;if(!g||!h)throw"properties __type and id are required for data registration";var i=c.__types[g];if(i.isParentType){var j=c.getTypeDetectionForNode(h,f);g=j.required?i.detectType(b):j.type,i=c.__types[g]}var k={id:h,type:g,changes:{}},l=c._getTypeDictionary(g),m=l[h];m||(l[h]=m={__type:g,data:{},id:h,refs:{}}),c._registerParentNodes(g,h,m,l);var n=a.clone(m.data),o=a.clone(b),p=c._registerReferences(i,o,m);c._extendRegister(e,p),a.extend(m.data,o),m.data.hasOwnProperty("__type")&&delete m.data.__type,c._attachReference(e.refs,h,g),e.nodes.push(m),a.each(a(b).keys(),function(a){if(a==="__type"||a==="id")return;var b=n[a],c=m.data[a];d.isEqualIncluded(c,b)||(k.changes[a]=c)}),c._extendTree(e.tree,[k]),e.diffs.push(k)}),e},get:function(b,c,d){var e=this;if(!b){var f={data:[],notInitializedFields:[],all:!0};return a.each(a(this._getTypeDictionary(c)).keys(),function(a){var b=e._get(a,c,d);f.data.push(b.data),e.mergeFields(f.notInitializedFields,b.notInitializedFields)}),f}return this._get(b,c,d)},_get:function(b,d,e){var f=this;e=e||{};var g=f.getPersistedNode(b,d),h=f.__types[d]||{},i=h.refs||{},j=e.$fields||e.fields||[],k={data:null,type:h,notInitializedFields:j};if(!g)return k;var l={},m=[],n=function(a,b,c){var d=f._get(a.id,a.type,{fields:b||[]});return d.notInitializedFields.length&&c.push(d.notInitializedFields),d.data},o=g.data;return a.each(j,function(b){var d=c.header.getFieldName(b),e=o[d];if(a.isUndefined(e)){m.push(b);return}l[d]=e;if(i.hasOwnProperty(d)&&e){var g=[];if(a.isArray(e)){var h=e;e=[],a.each(h,function(a){e.push(n(a,b[d],g))})}else e=n(e,b[d],g);if(g.length>0){var j={};j[d]=[],a(g).each(function(a){f.mergeFields(j[d],a)}),j[d].length>0&&m.push(j)}}l[d]=e}),g.origin&&(d=g.origin.type),{type:h,data:a(l).defaults({id:b,__type:d}),notInitializedFields:m}},mergeFields:function(b,c,d){return a.mergeFields(b,c,d)},destroy:function(){delete this.__data,delete this.__types}})}),define("tau/core/repository",["Underscore","tau/core/class","tau/core/event","tau/core/tau","tau/core/header","tau/core/comparer","tau/core/types","tau/store/db"],function(a,b,c,d,e,f,g,h){var i=b.extend({init:function(a){if(!a.service)throw"rest service should be defined";this.__allTypeLoadMarkers={},this.__listenerObjects={objects:[],holders:[]},this.__subscriptions={},this.types=a.types||g.getDictionary(),this.db=new h({types:this.types}),this.service=a.service},mergeCommands:function(b){var c={},e=this;return a.each(b,function(b){b=a.defaults(b,{name:"get",config:{},callbacks:{}}),b.callbacks=d.getCallbacks(b.callbacks),e._processFieldsConfig(b,b.name==="get"?null:"_getEmptyArray");var f=[b.type,b.config.id||"_",b.name,b.config.nested===!0?a.uniqueId():""].join("_");if(!c.hasOwnProperty(f))c[f]=b,b.commands=[];else{var g=c[f];e.db.mergeFields(g.config.fields,b.config.fields),g.commands.push(b)}}),c},execute:function(b){var c=this;a.isArray(b)||(b=[b]);var d=c.mergeCommands(b);a.each(a.values(d),function(a){if(a.executed===!0)throw"command is already executed. the same command can not be used twice";c["api "+a.name](a)})},_registerListener:function(b,c,e){var f=b||{},g=c.eventName;f.hasOwnProperty(g)||(f[g]={});var h=a.uniqueId(g),i={id:h,config:c,callback:d.createScopedCallbackIfRequired(e)},j=f[g];if(c.listener){var k=a.indexOf(this.__listenerObjects.objects,c.listener),l={id:h,holder:j};k<0?(this.__listenerObjects.objects.push(c.listener),this.__listenerObjects.holders.push([l])):this.__listenerObjects.holders[k].push(l)}return j[h]=i,i},_getListeners:function(b){var c=this,d=c._getSubscriptions(b.type);if(!d)return[];var e=d[b.eventName];if(!e)return[];var g=[];return a.each(a(e).values(),function(d){var e=d.config.filter,h=d.config.hasChanges||[];if(e){var i=c.db.getPersistedNode(b.obj.id,b.obj.type),j=b.obj;i&&i.data?j=i.data:b.nodeEvent.changes&&!a.isEmpty(b.nodeEvent.changes)&&(j=b.nodeEvent.changes);var k=f.compare(j,e);if(a(k.changes).keys().length>0)return}if(b.nodeEvent&&h.length>0){var l=b.nodeEvent.changes||{},m=a.select(h,function(a){return l.hasOwnProperty(a)}).length;if(m!==h.length)return}g.push(d)}),g},on:function(a,b){var c=this,d=a.type?c.types[a.type].name:"_all_",e=c._getSubscriptions(d);return c._registerListener(e,a,b)},_getSubscriptions:function(a){return this.__subscriptions.hasOwnProperty(a)||(this.__subscriptions[a]={}),this.__subscriptions[a]},unbind:function(b){var c=a.indexOf(this.__listenerObjects.objects,b);if(c<0)return;var d=this.__listenerObjects.holders[c];this.__listenerObjects.holders.splice(c,1),this.__listenerObjects.objects.splice(c,1),a(d).each(function(a){var b=a.holder[a.id];b.callback=function(){},delete a.holder[a.id]})},_autoAppend:function(b,c,d){a.each(c,function(c){a.any(b,function(a){return e.header.getFieldName(a)===e.header.getFieldName(c)})||b[d?d:"unshift"](c)})},registerData:function(a){this.db.register(a)},_getEmptyArray:function(){return[]},_getDefaultFields:function(b){var c=this.types[b.type];return a.clone(c?c.fields||[]:[])},_processFieldsConfig:function(b,c){var d=this;c=c||"_getDefaultFields";if(!b.config.fields||b.config.fields.length===0)b.config.fields=d[c](b);var e=b.config.fields;d._autoAppend(e,["id"]);for(var f=e.length;f>0;f--){var g=e[f-1];if(a.isSimple(g))continue;var h=a.getFieldName(g),i=b.type?d.types[b.type]:null,j=null,k=[];if(i&&i.refs&&i.refs[h]){var l=i.refs[h];l.list===!0&&(g.list=!0),k=l.fields,j=l.name}var m={type:j,config:{fields:g[h]||k}};g[h]=d._processFieldsConfig(m,c)}var n=e.length;for(f=0;f<n;f++){var o=a.getFieldName(e[f]);for(var p=f+1;p<n;p++)a.getFieldName(e[p])===o&&(a.isSimple(e[f])||a.mergeFields(e[f][o],e[p][o]),e.splice(p,1),n--,p--)}return e},_invokeCommandCallback:function(b,c,d,e){var f=this;f._invokeCommandCallbackR(b,c,d,e);if(d.config.silent===!0)return;if(!f.__subscriptions._all_||a.isEmpty(f.__subscriptions._all_))return;var g=a.values(f.__subscriptions._all_[b]||[]),h={name:b,data:{cmd:d,data:e}};a(g).each(function(a){a.callback(h)})},_invokeCommandCallbackR:function(b,c,d,e){var f=this;d.executed=!0,c[b]({command:d,data:e}),d.hasOwnProperty("commands")&&a.each(d.commands,function(a){a.executed=!0,a.failed=d.failed,f._invokeCommandCallbackR(b,a.callbacks,a,e)})},"api remove":function(a){var b=this,c=a.callbacks;a.callbacks={success:function(d){var e=b.evictPersistedObject(a.config.id,a.type);b._invokeCommandCallback("success",c,a,a.callbacks),b._populateAfterRemoveEvent(a,e)},failure:function(d){a.failed=!0,b._invokeCommandCallback("failure",c,a,d)}},b._populateBeforeRemoveEvent(a),b.service.remove(a)},evictPersistedObject:function(a,b){return this.db.remove(a,this.types[b].name)},evictProperties:function(a,b,c){this.db.removeProperties(a,this.types[b].name,c)},isPropertyInitialized:function(a,b,c){return this.db.isPropertyInitialized(a,b,c)},"api save":function(b){var c=this,d=b.callbacks;b.config.$set=b.config.$set||{},b.callbacks={success:function(e){a.extend(e,{__type:b.type});var f=a.extend(a.extend({},b.config.$set),e),g=c.db.register(f);c._invokeCommandCallback("success",d,b),c._notifyAboutNewsAndChanges(g,b)},failure:function(a){b.failed=!0,c._invokeCommandCallback("failure",d,b,a)}},c._populateBeforeSaveEvent(b),c._processFieldsConfig(b,"_getEmptyArray"),c.service.save(b)},_notifyAboutNewsAndChanges:function(b,c){var d=this;a.each(a.keys(b.tree),function(e){a.each(a(b.tree[e]).values(),function(a){d._populateEvent(c,"afterSave",a,{id:a.id,type:e})})})},_populateEvent:function(b,c,d,e){var f=a.uniqueId("repositoryEvent"),g=this._getListeners({type:e.type,eventName:c,nodeEvent:d,obj:e});if(g.length!==0){var h={id:f,name:c,data:{id:e.id,type:e.type,cmd:b,obj:e,changes:d.changes}};a(g).each(function(a){a.callback(h)})}},_populateBeforeRemoveEvent:function(a){this._populateEvent(a,"beforeRemove",{},{id:a.config.id,type:a.type})},_populateAfterRemoveEvent:function(b,c){var d=this;a.each(c.deletedData,function(a){d._populateEvent(b,"afterRemove",{},a)})},_populateBeforeSaveEvent:function(a){this._populateEvent(a,"beforeSave",{changes:a.config.$set||{}},{id:a.config.id,type:a.type})},markRecordSetAsCompleteLoaded:function(a){this.__allTypeLoadMarkers[a]=!0},isTypeMarkedAsCompleteLoaded:function(a){return this.__allTypeLoadMarkers[a]===!0},_appendDiscriminator:function(b,c){var d=this;b.isParentType&&a.indexOf(c,"id")>=0&&d._autoAppend(c,[b.discriminator],"push"),a.each(c,function(a){if(e.header.isSimple(a))return;var c=e.header.getFieldName(a),f=b.refs[c];f&&d._appendDiscriminator(d.types[f.name],a[c])})},_processCommandForGet:function(b){var c=this,d=c.db.get(b.config.id,b.type,b.config),e=b.config.fields;if(d.notInitializedFields.length===0)if(!d.all||!!c.isTypeMarkedAsCompleteLoaded(b.type))return b.config.fields=e,c._invokeCommandCallback("success",b.callbacks,b,d.data),{isInvoked:!0};var f=d.notInitializedFields;return d.all&&!c.isTypeMarkedAsCompleteLoaded(b.type)&&(f=a.clone(e)),{isInvoked:!1,fields:f}},_runReadCommand:function(b,c,d,e){var f=this;f._appendDiscriminator(f.types[b.type],d),a.extend(b.config,{fields:d}),f._processFieldsConfig(b);var g=b.callbacks;b.callbacks={success:function(d){b.config.fields=c,a.defaults(d,{__type:b.type}),f.db.register(d);var h=e(d);f._invokeCommandCallback("success",g,b,h),b.callbacks=g},failure:function(a){b.config.fields=c,b.failed=!0,f._invokeCommandCallback("failure",g,b,a),b.callbacks=g}},this.service[b.name](b)},"api find":function(b){var c=this,d=b.config.fields,e=function(e){var f=[];a.each(e,function(a){f.push(c.db.get(a.id,b.type,{fields:d}).data)});if(e.hasOwnProperty("getNextUrl")){f.isNextPageAvailable=function(){return!0};var g=a.clone(b);g.config=a.clone(g.config),g.config.$skip=g.config.$skip+g.config.$limit,f.getNextPageCommand=function(){return g}}else f.isNextPageAvailable=function(){return!1};return f};this._runReadCommand(b,d,a.clone(d),e)},"api get":function(a){var b=this,c=a.config.fields,d=b._processCommandForGet(a);if(d.isInvoked)return;var e=function(d){return a.config.id||b.markRecordSetAsCompleteLoaded(a.type),b.db.get(a.config.id,a.type,{fields:c}).data};this._runReadCommand(a,c,d.fields,e)}});return i}),define("tau/core/Class",[],function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,c=function(){},d=0;return c.extend=function(c){function h(){!a&&this.init&&(this.__objectId=d++,this.init.apply(this,arguments))}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]=typeof c[g]=="function"&&typeof e[g]=="function"&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return h.prototype=f,h.constructor=h,h.extend=arguments.callee,h},c}),define("tau/services/formatProperties",[],function(){return{customFields:{}}}),define("tau/services/service.arrayToJsonConverter",["Underscore","tau/core/header","tau/services/formatProperties"],function(a,b,c){return{convertArray:function(b,c){var d=this,e=[];if(c.next){var f=c.next;e.getNextUrl=function(){return f}}return c=c.items?c.items:c,a.each(c,function(a){e.push(d.convert(b,a))}),e},convert:function(d,e){var f={},g=this;for(var h=0,i=d.header.length;h<i;h++){var j=e[h];a.isUndefined(j)&&(j=null);var k=d.header[h];if(b.header.isSimple(k)){c.hasOwnProperty(k)&&(j=b.formatObject(j)),f[k]=j;continue}var l=b.header.getFieldName(k);if(a.isEmpty(j)&&k.list!==!0){f[l]=null;continue}if(!a.isNull(j)){var m={header:k[l]};if(k.list===!0){var n=[];a.each(j,function(a){n.push(g.convert(m,a))}),j=n}else j=g.convert(m,j)}a.isNull(j)&&k.list===!0&&(j=[]),f[l]=j}return f}}});var JSON;JSON||(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("libs/json2",function(){}),define("tau/services/service.rest",["Underscore","jQuery","tau/core/Class","tau/core/types","tau/services/service.arrayToJsonConverter","tau/core/header","libs/json2"],function(a,b,c,d,e,f){var g=c.extend({init:function(c){c=c||{},a.defaults(c,{api:b,types:d.getDictionary()}),this.config=c},remove:function(a){var b=this,c={Id:a.config.id},d={url:b.getUrl(a),contentType:"application/json; charset=utf-8",type:"DELETE",processData:!1,data:JSON.stringify(c),dataType:"json"},e=this.getErrorCallback(a);b.config.api.ajax(d).success(function(){a.callbacks.success({id:a.config.id})}).error(e)},save:function(b){var c={$set:b.config.$set||{}};if(b.type==="prioritizer"){a.extend(c,{$include:this._formIncludes(b.config.fields)}),this.executeCrudCommandViaPageService(b,c,"save");return}this.executeCrudCommand(b,c,"save")},getErrorCallback:function(a){var c=this.config.appPath,d=function(d){if(d.status===401){document.location.href=c+"/login.aspx?ReturnUrl="+document.location.href;return}try{d.response=b.parseJSON(d.responseText)}catch(e){}finally{a.callbacks.failure(d)}};return d},executeCrudCommandViaPageService:function(c,d,e){var g=this,h={id:c.config.id,type:c.type};a.extend(h,d);var i=JSON.stringify({json:JSON.stringify(h)}),j={url:[g.config.appPath,"PageServices/RESTCrud.asmx",e].join("/"),contentType:"application/json; charset=utf-8",type:"POST",data:i,dataType:"json"},k=this.getErrorCallback(c);g.config.api.ajax(j).success(function(d){var e={id:d.d.id};if(d.d.isError===!0){c.callbacks.failure({Message:d.d.errorMessage,CRUD:!0});return}if(d.d.jsonToReturn&&d.d.jsonToReturn.length>0){var g=b.parseJSON(d.d.jsonToReturn);g=f.formatObject(g),a.extend(e,g)}c.callbacks.success(e)}).error(k)},executeCrudCommand:function(b,c){var d=this,e={Id:b.config.id};a.extend(e,f.formatObject(c.$set,"Upper"));var g={url:d.getUrl(b,"resultInclude"),contentType:"application/json; charset=utf-8",type:"POST",processData:!1,data:JSON.stringify(e),dataType:"json"},h=this.getErrorCallback(b);d.config.api.ajax(g).success(function(a){b.callbacks.success(f.formatObject(a))}).error(h)},find:function(a){this.get(a)},get:function(b){var c=this;a.defaults(b.config,{format:"array"});var d=b.config.nested===!0||!b.config.id?"convertArray":"convert",g=function(a){b.arrStr=a;var f=c.config.api.parseJSON(a);return e[d]({header:c._getFields(b)},f)},h=function(a){var b=c.config.api.parseJSON(a),d=b;return b&&b.hasOwnProperty("Items")&&(d=b.Items,b.hasOwnProperty("Next")&&(d.getNextUrl=function(){return b.Next})),d},i=c.getUrl(b),j={url:i,accepts:{array:"application/x-array"},dataType:b.config.format,converters:{"text array":g,"text json":h}},k=function(a){b.config.format!=="array"&&(a=f.formatObject(a));if(b.type==="context"||b.type==="implementationHistory")a.id=b.config.id;if(b.config.nested===!0){var d=c._getNestedObject(b),e=f.header.getFieldName(d),g={id:b.config.id};g[e]=a,a=g}b.callbacks.success(a)},l=c.getErrorCallback(b),m=[],n=function(d){if(!a.isArray(d)||b.name!=="get"){k(d);return}m=m.concat(d);if(d.getNextUrl){var e=a.clone(j);e.url=d.getNextUrl(),c.config.api.ajax(e).success(n).error(l)}else k(m)};c.config.api.ajax(j).success(n).error(l)},_formIncludes:function(b){var c=[],d=this;return a.each(b,function(a){if(f.header.isSimple(a)){var b=a;a.indexOf("$ref")===0&&(b=a.replace("$ref:","")),c.push(b);return}var e=f.header.getFieldName(a);c.push(e+d._formIncludes(a[e]))}),["[",c.join(","),"]"].join("")},_getQueryOperators:function(){var b=function(b,c){var d=this,e=[];return a.isArray(c)||(c=[c]),a.each(c,function(a){e.push("("+b+" "+d.name+" "+JSON.stringify(a)+")")}),e},c=function(a){return["("+a+" "+this.name+")"]},d=function(b,c){var d=this,e=[];a.isArray(c)||(c=[c]);var f=[];return a(c).each(function(a){f.push(JSON.stringify(a))}),e.push("("+b+" "+d.name+" ("+f.join(",")+"))"),e};return{$in:{name:"in",render:d},$ne:{name:"ne",render:b},$gt:{name:"gt",render:b},$gte:{name:"gte",render:b},$lt:{name:"lt",render:b},$lte:{name:"lte",render:b},$contains:{name:"contains",render:b},$eq:{name:"eq",render:b},$isNull:{name:"is null",render:c},$isNotNull:{name:"is not null",render:c}}},_isQueryValueWithOperator:function(b,c){var d=a(b).keys();if(d.length===0)return!1;var e=c||this._getQueryOperators();return e.hasOwnProperty(d[0])},_formWhere:function(b,c){var d=[],e=this;c=c||"";var f=e._getQueryOperators();return a.each(a(b).keys(),function(g){var h=b[g],i=c+g;if(a.isString(h)||a.isNumber(h)||a.isDate(h)||a.isArray(h)||a.isBoolean(h)||a.isNull(h)){var j=h===null?"$isNull":"$eq";d=d.concat(f[j].render(i,h));return}if(e._isQueryValueWithOperator(h,f)){a.each(a(h).keys(),function(a){d=d.concat(f[a].render(i,h[a]))});return}d.push(e._formWhere(h,g+"."))}),d},_getWhere:function(a){var b=this._formWhere(a);return b.length===0?"":"&where="+encodeURIComponent(b.join(" and "))},_getNestedObject:function(b){var c=null;return a.each(b.config.fields,function(a){f.header.isSimple(a)||(c=a)}),c},_getFields:function(a){if(a.config.nested!==!0)return a.config.fields;var b=this._getNestedObject(a),c=f.header.getFieldName(b);return b[c]},_getOrderBy:function(a){return!a.config.$orderBy||a.config.$orderBy===""?"":"&orderBy="+a.config.$orderBy},_getOrderByDesc:function(a){return!a.config.$orderByDesc||a.config.$orderByDesc===""?"":"&orderByDesc="+a.config.$orderByDesc},getUrl:function(b,c){var d=this;a.defaults(b.config,{$skip:0,$limit:999,$query:{}});if(b.type==="context")return b.config.format="json",[d.config.path,"context.asmx","?ids="+b.config.id].join("/");if(b.type==="implementationHistory")return b.config.format="json",[d.config.appPath,"Reports/ImplementationHistory.ashx?id="+b.config.id+"&"+(new Date).valueOf()].join("/");var e=d.config.types[b.type]||{resource:b.type},g=b.config.fields,h=[d.config.path,e.resource+".asmx",b.config.id].join("/");if(b.config.nested===!0){var i=d._getNestedObject(b),j=f.header.getFieldName(i);g=i[j],h=[h,j].join("/")}return h=[h,"?skip=",b.config.$skip,"&take=",b.config.$limit,"&",c?c:"include","=",d._formIncludes(g),b.name==="find"?d._getWhere(b.config.$query):"",d._getOrderBy(b),d._getOrderByDesc(b)].join(""),h}});return g}),define("tau/core/keyboard.manager",["Underscore","jQuery"],function(a,b){function c(){}function d(){b(document).keydown(e.tauCreateDelegate(this))}function e(){if(this.keyboardHandlers.length==0)return;var a=this.keyboardHandlers[this.keyboardHandlers.length-1];a.handleKeyDown.apply(a,arguments)}function f(){this.keyboardHandlers=[],this.pushHandler=h,d.call(this),this.pushHandler.apply(this,arguments)}function g(){this.keyboardHandlers.pop()}function h(a){this.keyboardHandlers.push(a)}return c.prototype={pushHandler:f,popHandler:g},c}),define("tau/utils/utils.storage",[],function(){var a=typeof window.localStorage!="undefined",b={set:function(a,b){return localStorage[a]=JSON.stringify(b),!0},get:function(a){var b=localStorage[a];if(b)try{b=JSON.parse(b)}catch(c){}return b},remove:function(a){return delete localStorage[a]}},c={set:function(a,b,c){var d=new Date;d.setTime(d.getTime()+31536e6),c=c||d.toGMTString();var e="expires="+c,f=[a+"="+JSON.stringify(b),e,"path=/"].join("; ");document.cookie=f},get:function(a){a+="=";var b=document.cookie.split(";"),c;for(i=0;i<b.length;i++){var d=b[i];while(d.charAt(0)===" ")d=d.substring(1,d.length);d.indexOf(a)===0&&(c=d.substring(a.length,d.length),c=JSON.parse(c))}return c},remove:function(a){return c.set(a,"",-1)}};return a?storage=b:storage=c,storage}),function(){function a(a){var b=a.currentTarget||a.srcElement,c;if(a.type==="load"||f.test(b.readyState)){a=b.getAttribute("data-requiremodule"),h[a]=!0;for(a=0;c=g[a];a++)if(h[c.name])c.req([c.name],c.onLoad);else break;a>0&&g.splice(0,a),setTimeout(function(){b.parentNode.removeChild(b)},15)}}function b(a){var b,c;a.setAttribute("data-orderloaded","loaded");for(a=0;c=j[a];a++)if((b=i[c])&&b.getAttribute("data-orderloaded")==="loaded")delete i[c],require.addScriptToDom(b);else break;a>0&&j.splice(0,a)}var c=typeof document!="undefined"&&typeof window!="undefined"&&document.createElement("script"),d=c&&(c.async||window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"||"MozAppearance"in document.documentElement.style),e=c&&c.readyState==="uninitialized",f=/^(complete|loaded)$/,g=[],h={},i={},j=[],c=null;define("order",{version:"1.0.0",load:function(c,f,h,l){var p=f.nameToUrl(c,null);require.s.skipAsync[p]=!0,d||l.isBuild?f([c],h):e?(l=require.s.contexts._,!l.urlFetched[p]&&!l.loaded[c]&&(l.urlFetched[p]=!0,require.resourcesReady(!1),l.scriptCount+=1,p=require.attach(p,l,c,null,null,b),i[c]=p,j.push(c)),f([c],h)):f.specified(c)?f([c],h):(g.push({name:c,req:f,onLoad:h}),require.attach(p,null,c,a,"script/cache"))}})}(),function(a){function c(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}var b={VERSION:"0.6"};c.prototype={active:!0,execute:function(a){var b;return this.active&&(b=this._listener.apply(this.context,a),this._isOnce&&this.detach()),b},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach(),this._destroy()},_destroy:function(){delete this._signal,delete this._isOnce,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", active: "+this.active+"]"}},b.Signal=function(){this._bindings=[]},b.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(a,b,d,e){if(typeof a!="function")throw new Error("listener is a required param of add() and addOnce() and should be a Function.");var f=this._indexOfListener(a),g;if(f!==-1){g=this._bindings[f];if(g.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else g=new c(this,a,b,d,e),this._addBinding(g);return g},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a){var b=this._bindings.length;while(b--)if(this._bindings[b]._listener===a)return b;return-1},add:function(a,b,c){return this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return this._registerListener(a,!0,b,c)},remove:function(a){if(typeof a!="function")throw new Error("listener is a required param of remove() and should be a Function.");var b=this._indexOfListener(a);return b!==-1&&(this._bindings[b]._destroy(),this._bindings.splice(b,1)),a},removeAll:function(){var a=this._bindings.length;while(a--)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(!this.active)return;var b=Array.prototype.slice.call(arguments),c=this._bindings.slice(),d=this._bindings.length;this._shouldPropagate=!0;do d--;while(c[d]&&this._shouldPropagate&&c[d].execute(b)!==!1)},dispose:function(){this.removeAll(),delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}},a.signals=b}(window||global||this),define("libs/crossroads.js/dist/js-signals",function(){}),function(a){function g(a,b){var c=a.length;while(c--)if(a[c]===b)return c;return-1}function h(a,b){return"[object "+a+"]"===e.call(b)}function i(a){return h("RegExp",a)}function j(a){return h("Array",a)}function k(a){return h("Function",a)}function l(a){return a===null?a:f.test(a)?a.toLowerCase()==="true":a===""||isNaN(a)?a:parseFloat(a)}var b,c,d,e=Object.prototype.toString,f=/^(true|false)$/i;b=function(){function f(a,b,d){var e=new c(a,b,d);return h(e),e}function h(b){var c=i();do--c;while(a[c]&&b._priority<=a[c]._priority);a.splice(c+1,0,b)}function i(){return a.length}function j(b){var c=k(b);c>=0&&a.splice(c,1),b._destroy()}function k(b){return g(a,b)}function l(){var b=i();while(b--)a[b]._destroy();a.length=0}function m(a){a=a||"";var c=n(a),d=c?o(a,c):null;c?(d?c.matched.dispatch.apply(c.matched,d):c.matched.dispatch(),e.dispatch(a,c,d)):b.dispatch(a)}function n(b){var c=i(),d;while(d=a[--c])if(d.match(b))return d;return null}function o(a,b){return d.getParamValues(a,b._matchRegexp)}var a=[],b=new signals.Signal,e=new signals.Signal;return{_routes:a,addRoute:f,removeRoute:j,removeAllRoutes:l,parse:m,bypassed:b,routed:e,getNumRoutes:i,toString:function(){return"[crossroads numRoutes:"+i()+"]"}}}(),c=function(a,b,c){var e=i(a);this._pattern=a,this._paramsIds=e?null:d.getParamIds(this._pattern),this._matchRegexp=e?a:d.compilePattern(a),this.matched=new signals.Signal,b&&this.matched.add(b,this),this._priority=c||0},c.prototype={rules:void 0,match:function(a){return this._matchRegexp.test(a)&&this._validateParams(a)},_validateParams:function(a){var b=this.rules,c;for(c in b)if(b.hasOwnProperty(c)&&!this._isValidParam(a,c))return!1;return!0},_isValidParam:function(a,b){var c=this.rules[b],d=this._getParamValuesObject(a),e=d[b],f;return i(c)?f=c.test(e):j(c)?f=g(c,e)!==-1:k(c)&&(f=c(e,a,d)),f||!1},_getParamValuesObject:function(a){var b=this._paramsIds,c=d.getParamValues(a,this._matchRegexp),e={},f=b?b.length:0;while(f--)e[b[f]]=c[f];return e.request_=l(a),e},dispose:function(){b.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.matched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},d=b.patternLexer=function(){function f(a){var b=[],d,e=new RegExp(c);while(d=e.exec(a))b.push(d[1]);return b}function g(a){return a=a?h(a):"",a=a.replace(/\/$/,""),a=j(a),a=i(a),new RegExp("^"+a+"/?$")}function h(a){return a.replace(c,d)}function i(a){return a.replace(e,b.source)}function j(b){return b.replace(a,"\\$&")}function k(a,b){var c=b.exec(a);return c&&(c.shift(),c=m(c)),c}function m(a){var b=a.length,c=[];while(b--)c[b]=l(a[b]);return c}var a=/[\\\.\+\*\?\^\$\[\]\(\)\{\}\/\'\#]/g,b=/([^\/]+)/,c=/\{([^\}]+)\}/g,d="___CR_PARAM___",e=new RegExp(d,"g");return{getParamIds:f,getParamValues:k,compilePattern:g}}(),a.crossroads=b}(window||this),define("libs/crossroads.js/dist/crossroads",function(){}),define("tau/utils/utils.history",["Underscore","tau/core/class","tau/core/event","order!libs/crossroads.js/dist/js-signals","order!libs/crossroads.js/dist/crossroads"],function(a,b,c){var d=b.extend({init:function(){this.stack=[],this.current=null},size:function(){return this.stack.length},push:function(a){var b=a;return b.index=this.stack.length,this.stack.push(b),this},pop:function(){var a=this.stack.pop();return a},rewindTo:function(a){var b=this.stack.length;for(var c=b-1;c>=0;c--){var d=this.stack[c];d.index>a&&this.stack.pop()}return this},setCurrent:function(a){this.current=a},getCurrent:function(){return this.current},process:function(){this.current&&this.stack.push(a.clone(this.current)),this.current=null},updateCurrent:function(a){this.current&&(this.current.url=a.url||this.current.url,this.current.title=a.title||this.current.title,this.current.id=a.id||this.current.id)},exclude:function(b){this.stack=a.reject(this.stack,function(a,c){return a.id&&a.id==b}),this.current.id===b&&(this.current=null)}});return c.implementOn(d.prototype),d}),define("libs/parseUri",[],function(){function a(b){var c=a.options,d=c.parser[c.strictMode?"strict":"loose"].exec(b),e={},f=14;while(f--)e[c.key[f]]=d[f]||"";return e[c.q.name]={},e[c.key[12]].replace(c.q.parser,function(a,b,d){b&&(e[c.q.name][b]=d)}),e}return a.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},a}),define("tau/utils/utils.routing/utils.routing.store.hash",["Underscore","jQuery","tau/core/class","tau/core/event","libs/parseUri"],function(a,b,c,d,e){var f=c.extend({init:function(a){this.config=a,this.window=this.config.window||window,this.params=[];var c=this;this.hashChangeHandler=function(a){a.stopPropagation(),a.preventDefault();var b=a.hash||a.target.location.hash;c.fire("urlChanged",{url:c.parseUrl(b)})},b(this.window).bind("hashchange",this.hashChangeHandler),this.destroyHandler=function(a){c.fire("destroyed",{})},b(this.window).bind("unload",this.destroyHandler)},_extract:function(a){var b=a;if(this.config.safe==1){a="?"+a;var c=e(a);this.params=c.queryKey,b=this.params[this.config.safeParameterName]||""}return b},_generate:function(c,d){d=!!d;var e=c.url;a.isEmpty(c.states)==0&&d&&(e+="||"+JSON.stringify(c.states));var f=e;return this.config.safe==1&&(this.params[this.config.safeParameterName]=e,f=b.param(this.params)),f},parseUrl:function(a){a&&a[0]=="#"&&(a=a.slice(1));var b=this._extract(a);b=decodeURIComponent(b);var c={url:null,states:{},source:"#"+a},d=b.split("||");c.url=d[0];if(d[1])try{c.states=JSON.parse(d[1])}catch(e){}return c},generateUrl:function(a,b){return this._generate(a,b)},setUrl:function(b){var c="#";a.isObject(b)&&b.hasOwnProperty("url")&&b.hasOwnProperty("states")?c=this._generate(b,!0):a.isString(b)&&(c=b),this.window.location.hash=c},getUrl:function(){return this.parseUrl(this.window.location.hash)}});return d.implementOn(f.prototype),f}),define("tau/utils/utils.routing",["Underscore","jQuery","tau/core/class","tau/core/event","tau/utils/utils.routing/utils.routing.store.hash","tau/utils/utils.storage","order!libs/crossroads.js/dist/js-signals","order!libs/crossroads.js/dist/crossroads"],function(a,b,c,d,e,f){var g=c.extend({init:function(a){return this.backend=window.crossroads,this.options=a,this.window=this.options.window||window,this.store=new e(this.options),this.current={url:"",states:{},source:""},this.processed={url:"",states:{},source:""},this.referer=this.restoreReferer(),this.reset(),this},register:function(b,c,d){var e=b;arguments.length>1&&(e={pattern:b,callback:c});var f=this;return this.backend.addRoute(e.pattern,function(){var b=Array.prototype.slice.call(arguments),c=this,d={};a.forEach(c._paramsIds,function(a,c){d[a]=b[c]});var g=f.processed.states;e.callback.apply(this,[d,g])}),this},register404:function(a){return this.backend.bypassed.add(a),this},_applyRouter:function(a){this.backend.parse(a)},start:function(){var b=this,c=a.bind(this._applyRouter,this),d=function(d){this.processed=d;if(this.processed.url!==this.current.url){this.setReferer(a.clone(this.current)),this.current=this.processed,c(this.current.url);return}var e=this.current.states,f=this.processed.states,g=a.union(a.keys(e),a.keys(f)),h={};a.forEach(g,function(a){e[a]!=f[a]&&(h[a]=f[a]||null)}),a.forEach(h,function(a,c){b.fire("stateChanged",{name:c,value:a})}),this.current=this.processed};this.setChangeListener(a.bind(d,this));var e=function(){this.setReferer(a.clone(this.current))};return this.setDestroyListener(a.bind(e,this)),this},redirect:function(a){this.window.open(a,"_self")},setInternalUrl:function(a){this.setUrl({url:a,states:{}})},getUrl:function(){return this.store.getUrl()},setUrl:function(a){this.store.setUrl(a)},generateUrl:function(a){return typeof a=="undefined"&&(a=this.current),this.store.generateUrl(a,!0)},setChangeListener:function(a){this.changeListener=function(b){a(b.data.url)},this.store.on("urlChanged",this.changeListener,this)},setDestroyListener:function(a){this.destroyListener=function(b){a(b.data.url)},this.store.on("destroyed",this.destroyListener,this)},reset:function(){return this.backend.removeAllRoutes(),this.backend.bypassed.removeAll(),this},execute:function(a){var b=this.store.parseUrl(a);return this.current=b,this._applyRouter(b.url),this},stop:function(){this.changeListener&&(this.store.removeListener("urlChanged",this.changeListener,this),delete this.changeListener),this.destroyListener&&(this.store.removeListener("destroy",this.destroyListener,this),delete this.destroyListener)},getStateParameter:function(a){return this.current.states[a]},setStateParameter:function(a,b,c){this.current.states[a]=b,this.setUrl(this.current),c&&this.fire("stateChanged",{name:a,value:b})},getReferer:function(){return this.referer},setReferer:function(a){this.referer=a,f.set("utils.routing.referer",this.referer)},restoreReferer:function(){var a=f.get("utils.routing.referer");return a}});return d.implementOn(g.prototype),g}),define("tau/services/service.globalSettings",["tau/core/class"],function(a){var b=null,c=a.extend({init:function(a){this.config=a},resetSettings:function(){b=null},getGlobalSettings:function(a){var c=function(a,b){a.success&&a.success.call(a.scope,b.d)};if(b){c(a,b);return}this.sendRequest("GlobalSettingsService","GetGlobalSettings",null,function(d){b=d,c(a,d)},function(b){a.failure&&a.failure.call(a.scope,b)})},sendRequest:function(a,b,c,d,e){var f=this.config.appPath+"/PageServices/"+a+".asmx/"+b,g={contentType:"application/json",type:"POST",success:d,error:e};c&&(g.data=JSON.stringify(c)),$.ajax(f,g)}});return c}),define("tau/services/service.notifications",["tau/core/class"],function(a){var b=a.extend({init:function(a){this.config=a},notifyComment:function(a,b,c){c=c||{},this.sendRequest("CommentsNotificationService","Notify",{commentId:a,options:b},function(a){c.success&&c.success.call(c.scope,a.d)},function(a){c.failure&&c.failure.call(c.scope,a)})},sendRequest:function(a,b,c,d,e){var f=this.config.appPath+"/PageServices/"+a+".asmx/"+b,g={contentType:"application/json",type:"POST",success:d,error:e};c&&(g.data=JSON.stringify(c)),$.ajax(f,g)}});return b}),define("tau/rules/auto-include-beforeSave",["Underscore"],function(a){return{"auto include beforeSave":function(b,c){var d=this,e=b.data.obj;for(var f=0;f<c.fields.length;f++){var g=c.fields[f];(d.store.isPropertyInitialized(e.id,e.type,a.getFieldName(g))||c.force)&&a.mergeFields(b.data.cmd.config.fields,[g])}}}}),define("tau/rules/core",["Underscore","tau/core/class","tau/rules/auto-include-beforeSave"],function(a,b,c){return b.extend({init:function(b){var d=this;d.store=b.store||{},b.ruleImplemenations=b.ruleImplemenations||{},a.extend(d,c),a.extend(d,{name:"rules engine"}),a.extend(d,b.ruleImplemenations),d.register(b.rules||[])},register:function(b){var d=this;a.isArray(b)||(b=[b]),a(b).each(function(b){a.defaults(b,{name:a(c).keys()[0],fields:[],changes:[]});if(!b.hasOwnProperty("type"))throw"type should be configured for rule";if(b.fields.length===0)return;a.each(b.changes,function(a){var c=function(a){d[b.name](a,b)},e=b.name.split(" ");d.store.on({eventName:e[e.length-1],type:b.type,listener:d,hasChanges:[a]},c)})})},destroy:function(){var a=this.store;delete this.store,a.unbind(this)}})}),define("tau/target.process.rules.registrator",["Underscore","tau/core/types.targetprocess"],function(a,b){return{typeContainSimpleField:function(b,c){return a.find(b.simpleFields,function(a){return a===c})},registerRules:function(c){this.registeredEntityTypes={},this.rules=c,a.each(b.getDictionary(),this.registerType,this),c.register({type:"feature",changes:["initialEstimate"],fields:["timeRemain"]}),c.register({type:"iteration",changes:["startDate"],fields:["endDate"]}),c.register({type:"iteration",changes:["endDate"],fields:["startDate"]}),c.register({type:"roleEffort",changes:["effort"],fields:[{assignable:["effort","effortToDo","effortCompleted"]}]})},registerType:function(b){var c=this.registeredEntityTypes,d=this.rules;if(!c.hasOwnProperty(b.name)){c[b.name]=!0,a.each(b.aliases,function(a){c[a]=!0});var e="endDate";b.refs.hasOwnProperty("entityState")&&this.typeContainSimpleField(b,e)&&d.register({type:b.name,changes:["entityState"],fields:["endDate"]})}}}}),define("tau/core/bus.reg",["Underscore","tau/core/event"],function(a,b){var c={buses:{},onCreate:function(a){var b=this;b.buses[a.id]=a,b.fire("create",{bus:a})},onDestroy:function(a){if(a.id==="global")return;delete this.buses[a.id],this.fire("destroy",{bus:a})},logCount:function(){console.log("#count: "+this.count())},count:function(b){var c=a(this.buses).keys();return b&&(c=a(c).without("global")),c.length},stats:function(){var b={},c=this;a.each(a(c.buses).keys(),function(a){var d=c.buses[a];b.hasOwnProperty(d.name)||(b[d.name]=0),b[d.name]++}),a.each(a(b).keys(),function(a){console.log(a+" : "+b[a])})}};return b.implementOn(c),window.tau=window.tau||{},a.extend(window.tau,{buses:c}),c}),define("tau/core/bus",["Underscore","tau/core/class","tau/core/bus.reg","tau/core/event"],function(a,b,c,d){function f(a,b,c){var d=b[1],e=b[0];a.name.match(/(diagnostics)/)&&console.log(a.name,"["+a.id+"]",":",e,d||"")}var e=b.extend({globalBus:null,init:function(b){b=b||{},this.globalBus=b&&b.globalBus?b.globalBus:null,this.name=b&&b.name?b.name:a.uniqueId()+"",a.defaults(b,{id:a.uniqueId("bus_")}),this.id=b.id,c.onCreate(this)},initialize:function(a){this.fire("initialize",a)},destroy:function(){this.fire("destroy"),delete this.globalBus},getGlobalBus:function(){return this.globalBus}});return d.implementOn(e.prototype),e.prototype.fire=function(a,b,e){this.globalBus&&this.globalBus.fire(a,b,this);var f=d.prototype.fire.apply(this,arguments);return a==="destroy"&&(c.onDestroy(this),delete this.globalBus),f},e}),define("tau/configurator",["tau/store/store","tau/core/repository","tau/services/service.rest","tau/core/keyboard.manager","tau/core/bus","tau/utils/utils.routing","tau/utils/utils.history","libs/parseUri","tau/services/service.globalSettings","tau/services/service.notifications","tau/rules/core","tau/target.process.rules.registrator"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var a=new d;return this.getKeyBoardManager=function(){return a},this.getKeyBoardManager()}return{ckPath:"../Ckeditor/",getKeyBoardManager:m,globalBus:null,setGlobalSettingsService:function(a){this.globalSettingsService=a},getGlobalSettingsService:function(){if(!this.globalSettingsService){var a={appPath:this.getApplicationPath()};this.globalSettingsService=new i(a)}return this.globalSettingsService},setNotificationService:function(a){this.notificationService=a},getNotificationService:function(){if(!this.notificationService){var a={appPath:this.getApplicationPath()};this.notificationService=new j(a)}return this.notificationService},clearSingles:function(){this.rules&&(this.rules.destroy&&this.rules.destroy(),delete this.rules),delete this.proxy,delete this.service,delete this.store},clear:function(){this.clearSingles(),this.globalBus&&this.globalBus.removeAllListeners(),delete this.globalBus,delete this.initialData,delete this.appPath,delete this.currentDate,delete this.rulesDisabled},getCurrentAcid:function(){var a="",b=this.getWindow();if(b.location&&b.location.href){var c=b.location.href;a=h(c).queryKey.acid||a}return a},setWindow:function(a){this.window=a},getWindow:function(){return this.window||window},getHistory:function(){return this.history||(this.history=new g),this.history},getRouting:function(){return this.routing||(this.routing=new f({window:this.getWindow()})),this.routing},setCurrentDate:function(a){this.currentDate=a},getCurrentDate:function(){return this.currentDate?this.currentDate:new Date},getGlobalBus:function(){return this.globalBus=this.globalBus||new e({id:"global",name:"globalBus"}),this.globalBus},setApplicationPath:function(a){if(this.appPath===a)return;this.appPath=a},getApplicationPath:function(){return this.appPath},getCkPath:function(){return this.ckPath},setCkPath:function(a){this.ckPath=a},setInitialData:function(a){this.initialData=a},setService:function(a){if(this.service===a)return;this.clearSingles(),this.service=a},getService:function(){return this.service||(this.service=new c({appPath:this.getApplicationPath(),path:this.getRestPath()})),this.service},getRestPath:function(){return this.getApplicationPath()+"/api/v1"},setProxy:function(a){this.proxy=a},getProxy:function(){return this.proxy||(this.proxy=new b({service:this.getService()})),this.initialData&&(this.proxy.registerData(this.initialData,!0),delete this.initialData),this.proxy},disableRules:function(){this.rulesDisabled=!0},initRules:function(){if(this.rulesDisabled==1)return;this.rules=new k({store:this.store,rules:[]}),l.registerRules(this.rules)},getStore:function(b){return b=b||{},this.store||(b.proxy=this.getProxy(),_.defaults(b,{eventEmitter:this.getGlobalBus()}),this.store=new a(b),this.initRules()),this.store}}}),define("tau/core/component-base",["Underscore","tau/core/class","tau/configurator","tau/core/bus"],function(a,b,c,d){return b.extend({init:function(b){return this.config=a.extend({},b),this.bus=new d({name:b.name,globalBus:c.getGlobalBus()}),a.defaults(this.config,{configurator:c,bus:this.bus}),this},attach:function(b,c){c=c||{};var d=this.config.disabledExtensionCategories;if(d){var e=b.prototype.category;if(e&&a.indexOf(d,e)>=0)return this}var f=a.clone(this.config);c.hasOwnProperty("onCreate")||(f=a.extend(f,c));var g=new b(f);return c.onCreate&&c.onCreate(g),this}})}),define("tau/components/extensions/application/extension.history",["Underscore","tau/core/class","tau/core/event","tau/core/types","tau/configurator"],function(a,b,c,d,e){return b.extend({init:function(b){this.config=b,this.bus=b.bus,this.globalBus=this.bus.getGlobalBus(),e.getWindow().document&&(this.defaultTitle=e.getWindow().document.title),c.subscribeOn(this);var d=function(a){a.data&&a.data.title&&(e.getWindow().document.title=a.data.title)};this._currentHandler=a.bind(d,this),this._updateHandler=a.bind(this["bus history.updateCurrent"],this),this.bus.getGlobalBus().on("history.updateCurrent",this._updateHandler,this)},"bus controller.preExecute":function(a){e.getHistory().process()},"bus controller.postExecute":function(a){},"globalBus history.setCurrent":function(a){a.data&&a.data.title&&(e.getWindow().document.title=a.data.title)},"globalBus history.clearCurrent":function(){this.clearCurrent()},"globalBus history.exclude":function(a){var b=a.data.id;e.getHistory().exclude(b)},"bus history.updateCurrent":function(a){e.getHistory().updateCurrent(a.data)},clearCurrent:function(){e.getHistory().current=null},"bus destroy":function(){e.getWindow().document&&(e.getWindow().document.title=this.defaultTitle),this.clearCurrent(),e.getHistory().stack=[],e.getGlobalBus().removeAllListeners(this)}})}),define("tau/components/extensions/application/extension.routing",["Underscore","tau/core/class","tau/core/event","tau/core/types","tau/configurator"],function(a,b,c,d,e){return b.extend({init:function(b){this.config=b,this.bus=b.bus;var d=this.routing=e.getRouting(),f=d.getUrl().source;this.defaultHash=f!=="#"?f:"#__"+a.uniqueId(),c.subscribeOn(this);var g=this;g.bus.getGlobalBus().on("routing.setState",function(b){a.forEach(b.data,function(a,b){d.setStateParameter(b,a,!1)}),g.bus.fire("history.updateCurrent",{url:d.getUrl().source})},g),g.bus.getGlobalBus().on("routing.redirect",function(a){d.redirect(a.data.url)},g),d.on("stateChanged",function(a){g.bus.getGlobalBus().fire("routing.stateChanged",a.data)},g)},"bus registerRoute":function(a){var b=a.data;this.routing.register(b.pattern,b.callback)},"bus registerRouteNotFound":function(a){var b=a.data;this.routing.register404(b.callback)},"bus afterInit":function(a){this.bus.fire("routing.registered",{})},"bus controller.ready":function(){this.routing.start();var a=e.getRouting().getUrl();this.config.startUrl?this.routing.execute(this.config.startUrl):this.config.executeOnStart!==!1&&this.routing.execute(a.source)},"bus destroy":function(){this.bus.getGlobalBus().removeAllListeners(this),this.routing.reset(),this.routing.stop(),this.routing.setUrl(this.defaultHash),this.routing.removeAllListeners(this)}})}),define("tau/utils/utils.redirect",["Underscore","jQuery","tau/core/class","tau/configurator"],function(a,b,c,d){return c.extend({init:function(a){this.context=a,this.window=d.getWindow()},_process:function(a){var c=null;if(a.match(/^http(s)?:\/\//i))c=a;else if(a[0]=="#")c=a;else{var e=d.getApplicationPath();a[0]!=="/"&&(a="/"+a),c=e+a}return this.context&&(c=b.tmpl(c,this.context).text()),c},_redirect:function(a,b){b.location.href=a},redirect:function(a,c){var d=this.window;if(typeof c!="undefined"){var e=b(document),f={scrollbars:1,width:e.width()*.8,height:e.height()*.8,top:50},g=[],h=null;for(h in f)g.push(h+"="+f[h]);var i=g.join(",");d=this.window.open(this._process(a),c,i);return}this._redirect(this._process(a),d)},back:function(){this.window.history&&this.window.history.back&&this.window.history.back()},reload:function(){this.window.location&&this.window.location.reload&&this.window.location.reload()}})}),define("tau/components/extensions/application/extension.integration",["Underscore","jQuery","tau/core/class","tau/core/event","tau/core/types","tau/configurator","tau/utils/utils.redirect"],function(a,b,c,d,e,f,g){return c.extend({init:function(a){this.config=a,this.config.integration=this.config.integration||{},this.bus=a.bus,this.globalBus=this.bus.getGlobalBus(),d.subscribeOn(this),this.criticalChanged=!1,this.window=f.getWindow(),this.redirect=new g},"bus afterRender":function(){b("body").delegate("a[href=#]","click",function(a){a.preventDefault()})},"bus initProgress":function(a){this.config.integration.progress&&this.config.integration.progress.show("Reloading...")},"bus application.error":function(a){this.config.integration.progress&&this.config.integration.progress.hide()},"globalBus showProgress":function(a){this.config.integration.progress&&this.config.integration.progress.show(a.data.text)},"globalBus hideProgress":function(a){this.config.integration.progress&&this.config.integration.progress.hide()},"bus destroy":function(){f.getGlobalBus().removeAllListeners(this),this.window._criticalTauChanges&&(this.bus.fire("initProgress"),this.redirect.reload()),b("body .jquery-notify-bar").remove()},"bus application.reload":function(a){var b=this.config.integration.reloadCallback;if(!!b==0)return;b(a)},"bus application.exit":function(a){var b=this.config.integration.reloadCallback,c=!!b;c?(this.window._criticalTauChanges=!0,this.bus.fire("destroy")):(this.bus.fire("initProgress"),this.redirect.redirect("default.aspx"))}})}),define("libs/jquery/jquery.notifyBar",["jQuery"],function(a){return a.notifyBar=function(b){(function(a){var c=notifyBarNS={};notifyBarNS.shown=!1,b||(b={}),notifyBarNS.html=b.html||"Your message here",notifyBarNS.delay=b.delay||2e3,notifyBarNS.animationSpeed=b.animationSpeed||200,notifyBarNS.jqObject=b.jqObject,notifyBarNS.cls=b.cls||"",notifyBarNS.close=b.close||!1,notifyBarNS.jqObject?(c=notifyBarNS.jqObject,notifyBarNS.html=c.html()):c=jQuery("<div></div>").addClass("jquery-notify-bar").addClass(notifyBarNS.cls).attr("id","__notifyBar"),c.html(notifyBarNS.html).hide();var d=c.attr("id");switch(notifyBarNS.animationSpeed){case"slow":asTime=600;break;case"normal":asTime=400;break;case"fast":asTime=200;break;default:asTime=notifyBarNS.animationSpeed}c=="object",a("body").prepend(c),notifyBarNS.close&&(c.append(a("<a href='#' class='notify-bar-close'>Close [X]</a>")),a(".notify-bar-close").click(function(){return c.attr("id")=="__notifyBar"?a("#"+d).slideUp(asTime,function(){a("#"+d).remove()}):a("#"+d).slideUp(asTime),!1})),a(".jquery-notify-bar:visible").length>0?a(".jquery-notify-bar:visible").stop().slideUp(asTime,function(){c.stop().slideDown(asTime)}):c.slideDown(asTime),c.click(function(){a(this).slideUp(asTime)}),c.attr("id")=="__notifyBar"?setTimeout("jQuery('#"+d+"').stop().slideUp("+asTime+", function() {jQuery('#"+d+"').remove()});",notifyBarNS.delay+asTime):setTimeout("jQuery('#"+d+"').stop().slideUp("+asTime+", function() {jQuery('#"+d+"')});",notifyBarNS.delay+asTime)})(a)},a.notifyBar}),define("tau/components/extensions/error/extension.errorBar",["jQuery","tau/components/extensions/component.extension.base","libs/jquery/jquery.notifyBar"],function(a,b){var c=b.extend({"bus error":function(b){var c=b.data.message;a.notifyBar({cls:"error",html:c,delay:6e6})}});return c}),define("tau/ui/extensions/popup/ui.extension.popup",["tau/components/extensions/component.extension.base","tau/core/tau","tau/configurator","tau/extensions/extension.javascript"],function(a,b,c){return a.extend({init:function(a){var b=this;b.bodyOverflow=$("body").css("overflow"),$("body").css("overflow","hidden"),b.$overlay=$('<div class="ui-popup-overlay" style="display: none;"></div>').appendTo("body"),b.$container=$('<div class="ui-popup" style="display: none;"><div class="close"></div></div>').appendTo("body"),b._super(a)},"bus beforeDelete":function(){},"bus deleted":function(){var a=this,b=this.$container.position(),c=b.top,d=b.left,e=this.$container.width(),f=this.$container.height();this.$container.animate({opacity:0,top:c+f/2,left:d+e/2,width:0,height:0},800,function(){a.bus.fire("destroy")}),this.$overlay.hide()},"bus contentRendered":function(a){var b=this;b.$overlay.show(),b.element=a.data.element,b.element.addClass("ui-popup-content");var c=b.$container,d=$(".close",c);d.hide(),c.animate({opacity:"show"},150,function(){b.element.appendTo(c),d.fadeIn(1e3),b._attachHandlers()})},_attachKeyBoardHandling:function(){var a=this,b={handleKeyDown:function(){a._onDocumentKeyDown.apply(a,arguments)}};c.getKeyBoardManager().pushHandler(b)},_attachHandlers:function(){if(this._attached)return;this._attached=!0,this._onBodyClickHandler=$.proxy(this._onBodyClick,this),this._onDocumentKeyDownHandler=$.proxy(this._onDocumentKeyDown,this),this._onCloseButtonClickHandler=$.proxy(this._onCloseButtonClick,this),$(document).bind("click",this._onBodyClickHandler),this._attachKeyBoardHandling(),this.$container.find(".close").bind("click",this._onCloseButtonClickHandler),this._removeElements=this._removeElementsInnerImpl},_onDocumentKeyDown:function(a){a.keyCode==$.ui.keyCode.ESCAPE&&this.fire("destroy")},_onBodyClick:function(a){if(a.target!=this.$overlay[0])return;this.fire("destroy")},_onCloseButtonClick:function(){this.fire("destroy")},_detachHandlers:function(){$(document).unbind("click",this._onBodyClickHandler),this.element&&this.element.parents(".ui-popup").unbind("click",this._onElementClickHandler),c.getKeyBoardManager().popHandler(),this.$container.find(".close").unbind("click",this._onCloseButtonClickHandler)},_removeElementsInnerImpl:function(){this.$overlay.remove(),this.$container.remove(),$("body").css("overflow",this.bodyOverflow)},_removeElements:b.empty,"bus destroy":function(){this._detachHandlers(),this._removeElements(),this._super()}})}),define("tau/ui/templates/application/ui.template.application",["tau/core/templates-factory"],function(a){var b={name:"application",markup:['<div class="ui-application-viewport">',"</div>"]};return a.register(b)}),define("tau/core/model-base",["Underscore","tau/core/event.emitter"],function(a,b){var c=b.extend({init:function(a){this._super(a),this.store=a.store,this.config=a},onInit:function(){},isCommandForEntityInContext:function(a){return a.data.cmd.config.id===this.config.context.entity.id},isPropertyChanged:function(b,c){var d=c.changes;return a.any(b,function(a){return d.hasOwnProperty(a)})},attachToChangePropertiesOfCurrentEntity:function(b){var c=a.isArray(b)?b:[b],d=this.config.context.entity.id,e=this,f=function(a){var b=a.data;e.isPropertyChanged(c,b)&&e.fire("propertyChanged",b)},g=function(a){var b=a.data;e.isPropertyChanged(c,b)&&e.fire("beforeChangeProperty",b)},h=this.config.context.entity.entityType.name||"general";e.store.on({type:h,eventName:"afterSave",filter:{id:d},listener:e},f),e.store.on({type:h,eventName:"beforeSave",filter:{id:d},listener:e},g),b[this.propertyName]=[this.displayField,this.valueField]},"bus beforeInit":function(a){this.config=a.data?a.data.config:{},this.onInit()},"bus evictData":function(){var a=this.config.context.entity,b=a.id;this.store.config.proxy.evictPersistedObject(b,"context"),this.store.config.proxy.evictPersistedObject(b,a.entityType.name)},destroy:function(){this.store.unbind(this),delete this.config,delete this.store,this._super()}});return c}),define("tau/models/model.iteration.progressBar",["Underscore","tau/core/model-base"],function(a,b){var c=b.extend({name:"Progress Bar",init:function(){this._super.apply(this,arguments);var a=this;a.store.on({eventName:"beforeSave",type:"roleEffort",listener:this},function(){a.beforeSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"afterSave",type:"roleEffort",listener:this},function(){a.afterSaveRoleEffort.apply(a,arguments)})},beforeSaveRoleEffort:function(a){var b=a.data.cmd.config;b.fields=b.fields||[],b.fields.push({assignable:["id","effortCompleted","effortToDo","timeSpent","timeRemain"]})},afterSaveRoleEffort:function(a){var b=this;b.store.get("roleEffort",{id:a.data.obj.id,fields:[{assignable:["id"]}]},{success:function(a){a.data.assignable.id===b.config.context.assignable.id&&b.fire("roleEffortChanged")}}).done()},floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onInit:function(){var a=this.config.context,b=a.entity.entityType.name,c=a.entity.id,d=[{userStories:["effortToDo","effortCompleted"]},{bugs:["effortToDo","effortCompleted"]}];this.store.get(b,{id:c,fields:d},{success:this.setEntity,scope:this}).done({success:this.done,scope:this})},setEntity:function(b){var c=0,d=0,e=function(a){c+=a.effortToDo,d+=a.effortCompleted};a.each(b.data.userStories,e),a.each(b.data.bugs,e);var f=Math.round(100*parseFloat(c)+100*parseFloat(d))/100,g=Math.round(1e4*(d/f))/100;g=isNaN(g)?0:g,g=g>100?100:g,this.effortToDo=c,this.effortCompleted=d,this.percentCompleted=g},done:function(){this.fire("dataBind",{effortToDo:this.floatToString(this.effortToDo),effortCompleted:this.floatToString(this.effortCompleted),percentCompleted:this.percentCompleted,totalEffort:this.floatToString(this.effortToDo+this.effortCompleted),point:this._getEffortPoints()})},"bus evictState":function(){delete this.entity.entityState}});return c}),define("tau/ui/templates/label/ui.template.assignmentEffort.label",["tau/core/templates-factory"],function(a){var b={name:"assignment-effort-label",markup:['<div><span class="property"><span class="effort">${totalEffort}&nbsp;${point}</span></span>']};return a.register(b)}),define("tau/models/extension.model.base",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({category:"extension model base",floatToString:function(a){return a.toFixed(2).replace(".00","")},destroy:function(){this._super(),this.destroy=function(){}}})}),define("tau/models/assignmentsList/extension.model.effortRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){return b.extend({category:"model effort retriver","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:["effort","effortToDo"]},callback:{scope:this,success:this.onEffortRetrieved}})},"bus extendDataToBind":function(a){var b=a.data||{},c=this.entity||{};b.totalEffort={effort:this.floatToString(c.effort),remain:this.floatToString(c.effortToDo)}},onEffortRetrieved:function(a){this.entity=a.data},destroy:function(){delete this.entity,this._super()}})}),define("tau/models/assignmentsList/extension.model.store.operations",["Underscore","tau/core/model-base","tau/core/event"],function(a,b){var c=b.extend({category:"store operations","bus commitTransaction":function(a){var b=this.transaction||this.store;delete this.transaction,b.done(a.data)},"bus get":function(a){var b=this.transaction=this.transaction||this.store,c=a.data||{};this.transaction=b.get(c.type,c.query,c.callback)},destroy:function(){this._super.apply(this,arguments),this.destroy=function(){}}});return c}),define("tau/models/assignmentsList/extension.model.effortPointsRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){return b.extend({category:"model effort points extension",_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},"bus extendDataToBind":function(a){var b=a.data||{};b.effortPoints=this._getEffortPoints()}})}),define("tau/models/assignmentsList/extension.model.assignmentsRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){return b.extend({category:"model extension assignments retriever","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={generalUser:["id","firstName","lastName"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{assignments:["id",{role:["id","name"]},b],list:!0}]},callback:{scope:this,success:this.onAssignmentsRetrieved}})},onAssignmentsRetrieved:function(a){var b=a.data.assignments;this.fire("assignmentsReady",b)}})}),define("tau/models/assignmentsList/extension.model.entityRolesRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){return b.extend({category:"model entity roles retriever extension","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={role:["id","name","isPair","hasEffort"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{roleEfforts:["id","effort","effortToDo",b,{assignable:["id"]}],list:!0}]},callback:{scope:this,success:this.onRoleEffortsRetrieved}})},"bus userGroupWasCreated":function(b){var c=b.data||{},d=c.role||{};if(d.hasEffort){var e=this.entity.roleEfforts;a.each(e,function(a){if(a.role.id==d.id)return c.roleEffort={effort:this.floatToString(a.effort),remain:this.floatToString(a.effortToDo),id:a.id},!0},this),this.fire("roleEffortsReady",e)}else c.roleEffort=null},getRoles:function(){var a=this.entity.roleEfforts,b=[],c=a.length;for(var d=0;d<c;d++)b.push(a[d].role);return b},onRoleEffortsRetrieved:function(a){this.entity=a.data;var b=this.getRoles();this.fire("rolesReady",b)},"bus extendDataToBind":function(a){var b=a.data||{}}})}),define("tau/models/assignmentsList/extension.model.featureRolesRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){return b.extend({category:"model feature roles retriever extension","bus registerStoreRequest":function(){var a=this.config.context.applicationContext.processes[0].id;this.fire("get",{type:"process",query:{id:a,fields:[{entityStates:["id",{role:["id","name","hasEffort","isPair"]},{entityType:["id","name"]}],list:!0}]},callback:{scope:this,success:this.onEntityStatesRetrieved}})},onEntityStatesRetrieved:function(b){var c=b.data.entityStates,d=this.roles=[],e={},f=this.config.context.entity.entityType.name.toLocaleLowerCase();a.each(c,function(a){var b=a.role;b&&a.entityType.name.toLowerCase()===f&&(e.hasOwnProperty(b.id)||(e[b.id]=!0,d.push(b)))}),this.fire("rolesReady",d)}})}),define("tau/models/assignmentsList/extension.model.assignmentToRolesMapper",["Underscore","tau/models/extension.model.base","tau/configurator"],function(a,b,c){return b.extend({category:"model assignment to role mapper","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={generalUser:["id","firstName","lastName"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{assignments:["id",{role:["id","name"]},b],list:!0}]},callback:{scope:this,success:this.onAssignmentsRetrieved}})},"bus assignmentsReady+rolesReady+extendDataToBind":function(a){var b=(a.assignmentsReady||{}).data,c=(a.rolesReady||{}).data,d=(a.extendDataToBind||{}).data,e=c,f=[];for(var g=0;g<e.length;g++){var h=e[g],i={};i.role=h,i.users=this.getUsersInRole(b,h),i.allowAdd=(h.isPair?2:1)>i.users.length,this.fire("userGroupWasCreated",i),f.push(i)}d.assignments={groups:f}},_convertUserDataToViewData:function(a){var b=[c.getApplicationPath(),"/Avatar.ashx?UserId=",a.id,"&size=32"].join("");return{id:a.id,name:a.firstName+" "+a.lastName,avatar:b}},getUsersInRole:function(b,c){var d=[],b=a.sortBy(b,function(a){return a.id}),e=b.length;for(var f=0;f<e;f++){var g=b[f];if(g.role.id==c.id){var h=this._convertUserDataToViewData(g.generalUser);h.assignmentId=g.id,h.roleId=c.id,d.push(h)}}return d}})}),define("tau/models/assignmentsList/extension.model.taskEffortRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){return b.extend({category:"model task EffortRetriever","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:["tasks-count","tasks-effort-sum","tasks-effortToDo-sum"]},callback:{scope:this,success:this.onTaskEffortRetrieved}})},"bus extendDataToBind":function(a){var b=a.data||{},c=this.entity||{};c["tasks-count"]>0&&(b.tasksEffort={effort:this.floatToString(c["tasks-effort-sum"]),remain:this.floatToString(c["tasks-effortToDo-sum"])})},onTaskEffortRetrieved:function(a){this.entity=a.data},destroy:function(){delete this.entity,this._super()}})}),define("tau/models/model.assignmentsList",["Underscore","tau/core/types","tau/core/model-base","tau/models/assignmentsList/extension.model.effortRetriever","tau/models/assignmentsList/extension.model.store.operations","tau/models/assignmentsList/extension.model.effortPointsRetriever","tau/models/assignmentsList/extension.model.assignmentsRetriever","tau/models/assignmentsList/extension.model.entityRolesRetriever","tau/models/assignmentsList/extension.model.featureRolesRetriever","tau/models/assignmentsList/extension.model.assignmentToRolesMapper","tau/models/assignmentsList/extension.model.taskEffortRetriever"],function(a,b,c,d,e,f,g,h,i,j,k){var l=c.extend({"bus evictTotalEfforts":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,["effort","effortToDo"])},"bus assignmentsReady":function(a){this.assignments=a.data},"bus roleEffortsReady":function(a){this.roleEfforts=a.data},destroyExtensions:function(){var b=this.extensions||[];a.each(b,function(a){a.destroy("destroy")}),delete this.extensions},initExtensions:function(){this.destroyExtensions();var a=b.findByKeyword(this.config.context.entity.entityType.name),c=new(a.name!="feature"?h:i)(this.config);this.extensions=[new d(this.config),new e(this.config),new f(this.config),new g(this.config),c,new j(this.config)],a.name.toLowerCase()=="userstory"&&this.extensions.push(new k(this.config))},onInit:function(){this.clearData();var a=this;a.store.unbind(a),a.initExtensions(),a.fire("registerStoreRequest"),a.fire("commitTransaction",{success:a.done,scope:a}),this.bindStoreListeners()},done:function(){var a={};this.bus.fire("extendDataToBind",a),this.bus.fire("dataBind",a),this.destroyExtensions()},bindStoreListeners:function(){var b=this;b.store.on({eventName:"afterSave",type:"assignment",listener:b},function(){b.afterAssignmentSaved.apply(b,arguments)}),b.store.on({eventName:"beforeSave",type:"assignment",listener:b},function(){b.beforeSaveAssignment.apply(b,arguments)}),b.store.on({eventName:"beforeSave",type:"roleEffort",listener:b},function(){b.beforeSaveRoleEffort.apply(b,arguments)}),b.store.on({eventName:"afterSave",type:"roleEffort",listener:b},function(){b.afterSaveRoleEffort.apply(b,arguments)}),b.store.on({eventName:"beforeRemove",type:"assignment",listener:b},function(){b.beforeRemoveAssignment.apply(b,arguments)}),b.store.on({eventName:"afterRemove",type:"assignment",listener:b},function(){b.afterAssignmentRemoved.apply(b,arguments)});var c={id:this.config.context.entity.id};b.store.on({eventName:"beforeSave",type:this.config.context.entity.entityType.name,listener:b,filter:c,hasChanges:["entityState"]},a.bind(b.beforeEntityEntityStateChanged,b)),b.store.on({eventName:"afterSave",type:this.config.context.entity.entityType.name,listener:b,filter:c,hasChanges:["entityState"]},a.bind(b.afterEntityEntityStateChanged,b))},beforeEntityEntityStateChanged:function(a){this.fire("beforeStateChanged")},afterEntityEntityStateChanged:function(a){this.fire("afterStateChanged")},beforeSaveRoleEffort:function(b){var c=b.data.id;if(a.isNumber(c)&&this.isRoleEffortOfCurrentEntity(c)){var d=b.data.cmd;d.config.fields=d.config.fields||[],d.config.fields.push("effortToDo"),this.fire("beforeSaveRoleEffort",{roleEffortId:c})}},afterSaveRoleEffort:function(b){var c=b.data.id;a.isNumber(c)&&this.isRoleEffortOfCurrentEntity(c)&&(this.fire("evictTotalEfforts"),this.fire("afterSaveRoleEffort",{roleEffortId:c}))},beforeRemoveAssignment:function(a){this.fireEventIfAssignmentFromCurrentEntity(a,"beforeRemoveAssignment")},afterAssignmentRemoved:function(a){this.fireEventIfAssignmentFromCurrentEntity(a,"afterAssignmentRemoved")},beforeSaveAssignment:function(b){a.isNumber(b.data.id)?this.fireEventIfAssignmentFromCurrentEntity(b,"beforeSaveAssignment"):this.fireEventIfAssignmentFromCurrentEntity(b,"beforeAddAssignment")},afterAssignmentSaved:function(b){a.isNumber(b.data.cmd.config.id)?this.fireEventIfAssignmentFromCurrentEntity(b,"afterAssignmentSaved"):this.fireEventIfAssignmentFromCurrentEntity(b,"afterAssignmentAdded")},fireEventIfAssignmentFromCurrentEntity:function(b,c){var d=b.data.id;if(this.isAssignmentOfCurrentEntity(d)||((b.data.changes||{}).assignable||{}).id===this.config.context.entity.id){var e=a.extend({assignmentId:d},b.data.changes);this.fire(c,e)}},isRoleEffortOfCurrentEntity:function(b){return a.any(this.roleEfforts,function(a){return a.id===b})},isAssignmentOfCurrentEntity:function(b){return a.any(this.assignments,function(a){return a.id===b})},clearData:function(){delete this.assignments,delete this.roleEfforts},destroy:function(){this.clearData(),this._super.apply(this,arguments)}});return l}),define("tau/core/model.editable.base",["tau/core/model-base"],function(a){var b=a.extend({"bus save":function(a){var b=this,c=b.config.context?b.config.context.entity:{},d=a.data||{},e=d.$set||d,f=d.$include,g=d.hasOwnProperty("id")?d.id:c.id,h=d.typeName||c.entityType.name,i={$set:e,fields:f};g&&(i.id=g);var j={type:h,cmd:i,validation:{isValid:!0,isError:function(){return!1}}};b.fire("validate",j),b.fire("afterValidate",j);if(j.validation.isValid===!1||j.validation.isError&&j.validation.isError()==1){b.fire("validationFailed",j);return}b.fire("beforeSave",j),b.store.save(h,i,{success:function(a){b.fire("afterSave",{type:a.command.type,cmd:i})},failure:function(a){b.fire("saveFailed",{type:a.command.type,cmd:i})}}).done()},"bus remove":function(a){var b=this,c=b.config.context.entity,d=a.data||{},e=d.typeName||c.entityType.name;b.fire("beforeRemove",d),b.store.remove(e,{id:d.id},{success:function(a){b.fire("afterRemove",a.data)},failure:function(){}}).done()}});return b}),define("tau/models/model.assignmentsList.editable",["tau/core/model.editable.base"],function(a){var b=a.extend({"bus dataBind":function(a){this.fire("permissionsReady",{editable:!0})}});return b}),define("tau/models/userList/extension.model.unassignAction",["Underscore","tau/core/model-base"],function(a,b){return b.extend({name:"Model Extension Unassign Action","bus extendDataToBind":function(a){var b=a.data;b.headerActions.push({id:"unassign",title:"Unassign"})}})}),define("tau/models/userList/extension.model.showMore",["Underscore","tau/core/model-base"],function(a,b){return b.extend({name:"Model Extension Unassign Action","bus extendDataToBind":function(a){var b=a.data;b.moreAvailable=this.isMoreAvailable()},filterIsEmpty:function(){return!this.filterIsNotEmpty()},isMoreAvailable:function(){var a=this.config.data;return this.filterIsEmpty()&&a.showMore!==!0&&(a.hasOwnProperty("roleId")||a.hasOwnProperty("role"))},filterIsNotEmpty:function(){return this.config.data.filter&&this.config.data.filter.length}})}),define("tau/components/extensions/assignmentsList/extension.assignmentsList.editable",["Underscore","jQuery","tau/core/model-base"],function(a,b,c){return c.extend({category:"edit",init:function(){var a=this;a._super.apply(a,arguments),a.animations=[]},"bus dataBind":function(a){this.bindedData=a.data},"bus afterRender":function(a){this.$el=a.data.element,this.startAnimations()},"bus permissionsReady+afterRender":function(a){var b=a.permissionsReady.data;if(b.editable){var c=this;c.$el.removeClass("assignments-table-readonly"),c.$el.find(".group .effort").editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(a){var b=this.$element.parents(".group").tmplItem().data,d=c.normalizeEffort(b.roleEffort.effort),e=c.normalizeEffort(a);if(d===e)return this.restoreInitialText(),!1;var f={typeName:"roleEffort",$include:["id"],id:b.roleEffort.id,$set:{effort:e}};c.bus.fire("save",f)},onEditStart:function(){this.$element.data("points",this.$element.find("span").detach())},onEditEnd:function(){this.$element.append(this.$element.data("points"))}})}},"bus afterAssignmentSaved":function(){this.refresh()},"bus beforeSaveAssignment":function(a){var b=this,c=a.data.assignmentId,d,e;c&&(d=this.getAssignmentSelector(c),e=this.$el.find(d),e&&(this.fire("markElementToBeUpdated",{element:e}),this.addAnimation(function(){b.fire("updateElement",{element:b.$el.find(d)})})))},"bus beforeStateChanged":function(a){var b=this;b.fire("markElementToBeUpdated",{element:this.$el}),b.addAnimation(function(){b.fire("updateElement",{element:b.$el})})},"bus afterStateChanged":function(a){this.refresh()},"bus afterAssignmentAdded":function(a){this.refresh()},"bus beforeAddAssignment":function(a){var c=a.data,d=this,e=d.generateAssignmentIdForNewAssignment(c),f={name:"",role:{},assignmentId:e};b.tmpl("user",f).appendTo(d.$el.find(".group[roleId="+c.role.id+"]"));var g=d.getUserSelector({roleId:c.role.id,id:c.generalUser.id});d.addAnimation(function(){d.fire("updateElement",{element:d.$el.find(g)})})},"bus afterAssignmentRemoved":function(){this.refresh()},"bus beforeRemoveAssignment":function(a){var b=a.assignmentId,c=this.$el.find(this.getAssignmentSelector(b));this.fire("markElementToBeDeleted",{element:c})},"bus afterSaveRoleEffort":function(a){var b=a.data.roleEffortId,c=this;c.addAnimation(function(){var a=c.findRoleEffortElementByRoleEffortId(b);c.fire("updateElement",{element:a}),c.fire("updateElement",{element:c.$el.find(".total-row .effort-cell span")})}),this.refresh()},"bus beforeSaveRoleEffort":function(a){var b=a.data,c=b.roleEffortId,d=this.findRoleEffortElementByRoleEffortId(c);this.fire("markElementToBeUpdated",{element:d})},getUserSelector:function(a){return".group[roleId="+a.roleId+"] .user[userId="+a.id+"]"},getAssignmentSelector:function(a){var b=this,c=".user",d=b.$el.find(c),e;return d.each(function(b){var f=d.eq(b);if(f.tmplItem().data.assignmentId==a)return e=f,c+=":eq("+b+")",!1}),c},generateAssignmentIdForNewAssignment:function(a){return[this.config.context.entity.id,a.role.id,a.generalUser.id].join(",")},findRoleEffortElementByRoleEffortId:function(a){var c=this.$el.find(".role-effort .effort"),d=b();return c.each(function(){var c=b(this),e=c.parents(".group"),f=e.tmplItem().data;f.roleEffort=f.roleEffort||{};if(f.roleEffort.id===a)return d=c,!1}),d},addAnimation:function(a){this.animations.push(a)},startAnimations:function(){a.each(this.animations,function(a){a()}),this.animations=[]},refresh:function(){this.fire("refresh")},normalizeEffort:function(a){return Math.abs(Math.round(parseFloat(a)*100)/100)||0},destroy:function(){delete this.$el,delete this.bindedData,delete this.animations,this._super()}})}),define("tau/ui/extensions/editable-base",["tau/components/extensions/component.extension.base"],function(a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.permissionsReady.data;if(!c.editable)return;b.onEditActivated({element:a.afterRender.data.element})},onEditActivated:function(a){}})}),define("tau/ui/behaviour/common/ui.behaviour.tauBubble",["Underscore","jQuery"],function(a,b){return b.widget("ui.tauBubble",{_bubblesCache:[],_isInit:!1,$popup:null,$closeEl:null,$arrows:{top:null,bottom:null},$target:null,$alignTo:null,options:{viewport:"body",alignTo:null,collision:"fit flip",onShow:b.noop,showOnCreation:!1,closeOnEscape:!0},_create:function(){this.$target=this.element,this.options.alignTo&&(this.$alignTo=b(this.options.alignTo)),this.$alignTo=this.$alignTo.length?this.$alignTo:this.$target;if(this.options.showOnCreation==1)this.show();else{var a=this.onTargetClickDelegate=b.proxy(this._onTargetClick,this);this.$target.bind("click",a)}},_onTargetClick:function(a){a.preventDefault(),a.stopPropagation(),this.toggle()},_initInstance:function(a){var c=this,d,e=this.$target.parents(".ui-popup-content:first"),f=null;e.length?(d=e,f=d.parent()):(d=b("body"),f=d);var g=b('<div class="tau-bubble popup-container"><div class="tau-bubble__inner" role="content"></div></div>');g.appendTo(f),this.$popup=g,c.$arrows={top:b('<div class="tau-bubble__arrow-top"></div>'),bottom:b('<div class="tau-bubble__arrow-bottom"></div>')},c.$arrows.top.prependTo(g),c.$arrows.bottom.prependTo(g),c._bubblesCache.push(c);var h=b.proxy(this.hide,this);g.mouseenter(function(a){g.data("focus",!0)}),g.mouseleave(function(a){g.data("focus",!1)}),d.scroll(function(){h()}),this._initInstance=function(){}},show:function(){this._initInstance();var c=this;c.$popup.zIndex(c.$target.zIndex()+1),c.adjustPosition(),c.options.onShow.call(c,c.$popup),b.each(c._bubblesCache,function(){this!=c&&this.hide()}),c._signUpForCloseEvents(),c._windowResizeDelegate||(c._windowResizeDelegate=a.bind(function(){this.adjustPosition()},this)),b(window).bind("resize",c._windowResizeDelegate),c.$target.trigger("show",{}),c.$popup.trigger("show",{})},hide:function(){var a=this,c=a.$popup;if(!c.is(":visible"))return;c.hide(),a._documentKeyDown&&(b(document).unbind("keydown",a._documentKeyDown),delete a._documentKeyDown),a._documentClickDelegate&&(b(document).unbind("click",a._documentClickDelegate),delete a._documentClickDelegate),a._windowResizeDelegate&&(b(window).unbind("resize",a._windowResizeDelegate),delete a._windowResizeDelegate),a.$target.trigger("close",{})},_onKeyDown:function(a){if(a.keyCode!=b.ui.keyCode.ESCAPE)return;this.hide()},_signUpForCloseEvents:function(){var a=this;a.options.closeOnEscape&&!a._documentKeyDown&&(a._documentKeyDown=function(b){a._onKeyDown(b)},b(document).keydown(a._documentKeyDown)),a._documentClickDelegate||(a._documentClickDelegate=function(b){a._onDocumentClick(b)},b(document).click(a._documentClickDelegate))},_processArrows:function(){var a=this,c=a.$alignTo,d=a.$popup;a.$arrows.top.hide(),a.$arrows.bottom.hide();var e=a.$arrows.top,f=c.offset(),g=d.offset();g.top<f.top&&(e=a.$arrows.bottom);if(g.left<f.left){var h=c.width(),i=f.left-g.left-(b.browser.webkit?17:24)+h/2;e.css("left",i+"px")}e.show()},toggle:function(){var a=this;!a.$popup||!a.$popup.is(":visible")?a.show():a.hide()},widget:function(){return this.$popup||b()},adjustPosition:function(){var a=this,b=a.$alignTo,c=a.$popup;c.show();var d="-20 9";b.width()>=20&&(d="0 9");var e={of:b,my:"left top",at:"left bottom",offset:d,collision:a.options.collision};c.position(e);var f=b.position(),g=c.position();g.top<0&&(e.collision="none",c.position(e),g=c.position()),a._processArrows();var h=a.element},_onDocumentClick:function(a){var c=this,d=b(a.target);if(!c.$popup.is(":visible"))return;if(d.hasClass("tau-bubble-target")||d.parents(".tau-bubble-target,.ui-menu-item").length>0)return;if(d.hasClass("tau-bubble")||d.parents("div.tau-bubble").length>0)return;if(c._justActivated){c._justActivated=!1;return}c._trigger("hide"),c.hide()},activate:function(){this._justActivated=!0,this.show()},destroy:function(){var a=this,c=a.element;a.$popup&&(a.hide(),a.$popup.remove(),a.$arrows.top.remove(),a.$arrows.bottom.remove()),c.unbind("click",a.onTargetClickDelegate),b.Widget.prototype.destroy.apply(this,arguments)},empty:function(){var a=this;a.hide(),a.$popup.find(".tau-bubble__inner").empty()}}),b.fn.tauBubble}),define("tau/ui/extensions/popupEditorContainer.extension",["Underscore","jQuery","tau/ui/extensions/editable-base","tau/ui/behaviour/common/ui.behaviour.tauBubble"],function(a,b,c,d){return c.extend({category:"edit",init:function(a){this._super(a),this.containers=[]},destroy:function(){this.destroyContainers(),this._super()},onEditActivated:function(c){this.destroyContainers();var e=this,f=this.element=c.element;for(var g=0;g<e.config.popupEditorContainer.length;g++){var h=e.config.popupEditorContainer[g],i=f.find(h.targetSelector);i.find(".external-view,.ui-type-icon").click(function(a){a.stopPropagation()}),i.each(function(){var c=b(this);h.component.data=c.tmplItem().data;var g={components:a.clone(h.component),context:e.config.context};c.addClass("tau-bubble-target"),h.targetCssClass&&c.addClass(h.targetCssClass);var i=!1;h.alignmentSelector&&(h.alignmentSelectorFrom=="target"?i=c.find(h.alignmentSelector):i=f.find(h.alignmentSelector));if(!i||!i.length)i=c;i.addClass("ui-link");var j=function(a){return function(){e.initializeContainer(this.$target,this.$popup,a)}}(g);d.call(c,{alignTo:i,onShow:j})})}},initializeContainer:function(a,b,c){var d=this,e=b.find(".tau-bubble__inner");d.$popupInner=e,d.$target=a;if(a.data("bubbleLoaded")===!0)return;e.find("div.ui-loading-message").remove(),e.append("<div class='ui-loading-message'>Loading...</div>"),d.createComponents(c,function(b){var c=b[0].component;c.on("afterRender",function(b){e.find(".ui-loading-message").remove();var d=b.data.element;d.appendTo(e),a.data("bubbleLoaded",!0),b.removeListener(),a.tauBubble("adjustPosition"),a.tauBubble("adjustPositionStart"),a.tauBubble("adjustPosition"),a.bind("close",function(){c.fire("blur",{})}),a.bind("show",function(){c.fire("focus",{}),c.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition")}),c.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition"),a.tauBubble("adjustPosition"),setTimeout(function(){c.fire("focus",{})},500)}),d.addContainer(c),c.initialize();var f=function(){a.data("bubbleLoaded",!1),a.tauBubble("empty")},g=function(){a.tauBubble("hide")},h=function(){a.tauBubble("destroy"),c.destroy()};c.on("beforeSave",f),c.on("beforeRemove",f),c.on("reset",g),c.on("afterSave",h),c.on("afterRemove",h)})},addContainer:function(a){this.containers.push(a)},destroyContainers:function(){var b=this.containers;a.each(b,function(a){a.destroy()}),this.containers=[]}})}),define("tau/models/assignment/model.property.assignUser.editable.base",["Underscore","tau/core/model.editable.base","tau/configurator"],function(a,b){return b.extend({"bus assignToLoggedUser":function(){this.assignTo(this.getLoggedUser().id)},"bus changeAssignment":function(a){var b=a.data.user.id;this.assignTo(b)},getLoggedUser:function(){return this.config.context.applicationContext.loggedUser},assignTo:function(a){},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/assignment/model.assignment.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base","tau/configurator"],function(a,b){return b.extend({"bus removeAssignment":function(){var a={id:this.config.data.assignmentId,typeName:"assignment"};this.fire("remove",a)},assignTo:function(b){var c={typeName:"assignment",$include:[{generalUser:["id","firstName","lastName"]},{role:["id","name"]},{assignable:["id"]}]};this.config.data.hasOwnProperty("assignmentId")&&a.extend(c,{id:this.config.data.assignmentId,$set:{generalUser:{id:b}}}),this.fire("save",c)},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/assignment/model.add.assignment.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base","tau/configurator"],function(a,b){return b.extend({assignTo:function(b){var c={typeName:"assignment",$include:[{generalUser:["id","firstName","lastName"]},{role:["id","name"]},{assignable:["id"]}]};this.config.data.role&&a.extend(c,{id:null,$set:{generalUser:{id:b},assignable:{id:parseInt(this.config.context.entity.id)},role:{id:this.config.data.role.id}}}),this.fire("save",c)},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn",["tau/core/templates-factory"],function(a){var b={name:"assignments-add-btn",markup:['<button class="add-btn',"{{if allowAdd == false}}"," disabled","{{/if}}",'" type="button"><div>AddAssignment</div></button>'].join(""),dependencies:[]};return a.register(b)}),define("tau/ui/templates/common/ui.template.userName",["tau/core/templates-factory"],function(a){return a.register({name:"user-name",markup:"<span class='user-name'>${name}</span><br/>"})}),define("tau/ui/templates/common/ui.template.user",["tau/core/templates-factory","tau/ui/templates/common/ui.template.userName"],function(a){return a.register({name:"user",markup:["<table class='user' userId='${id}'><tr>","<td class='user-avatar-container'>","{{if avatar}}<img src='${avatar}' class='user-avatar'/>{{/if}}","</td>","<td class='user-info'>","   {{tmpl 'user-name'}}","{{if role}}","<span class='user-role'>${role.name}</span>","{{/if}}","</td>","</tr></table>"].join(""),dependencies:["user-name"]})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(a){var b={name:"assignments-user-list",markup:['<div class="group" roleId="${role.id}">','<table class="role-header">',"   <tr>",'   <td class="role-title">','   {{tmpl "assignments-add-btn"}}',"&nbsp;${role.name}","   </td>",'   <td class="role-effort">',"{{if roleEffort}}",'       <div class="effort">${roleEffort.effort}<span class="point">${$item.effortPoints}</span></div>',"{{/if}}","   </td>",'   <td class="role-effort">',"{{if roleEffort}}",'       <div class="remain">${roleEffort.remain}<span class="point">${$item.effortPoints}</span></div>',"{{/if}}","   </td>","</tr>","</table>",'{{tmpl(users) "user"}}',"</div>"].join(""),dependencies:["user","assignments-add-btn"]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList","tau/ui/templates/common/ui.template.user"],function(a){var b={name:"assignments-list",markup:['<table class="box assignments-table-readonly assignments-table">','   <tr class="title">','       <td class="assignments-title"></td>','       <td class="effort title-cell">Effort</td>','       <td class="effort title-cell">Remain</td>',"    </tr>",'    <tr class="title-row">','       <td class="user-list" colspan="3">','               {{tmpl(assignments.groups, {effortPoints: effortPoints}) "assignments-user-list"}}',"       </td>","   </tr>",'   <tr class="head-row">',"       <td></td>","       <td></td>","       <td></td>","   </tr>","{{if tasksEffort}}",'   <tr class="tasks-row">','       <td class="task-title">Tasks</td>','       <td class="effort-cell">${tasksEffort.effort} h</td>','       <td class="effort-cell">${tasksEffort.remain} h</td>',"   </tr>","{{/if}}",'   <tr class="total-row">','       <td class="total-title">Total</td>','       <td class="effort-cell"><span>${totalEffort.effort} ${effortPoints}</span></td>','       <td class="effort-cell"><span>${totalEffort.remain} ${effortPoints}</span></td>',"   </tr>",'   <tr class="title-row" style="display: none;">','       <td class="owner title-cell">Owner</td>',"       <td></td>","   </tr>","</table>"].join(""),dependencies:["assignments-user-list","user"]};return a.register(b)}),define("tau/utils/utils.date/utils.date.formats",[],function(){var a={};return a={date:{"short":"d-MMM-yyyy"},time:{"short":"HH:mm"},datetime:{"short":"d-MMM-yyyy HH:mm"}},a}),define("tau/utils/utils.translation",["Underscore"],function(a){var b={pluralize:function(b,c){var d=a.isArray(b)?b:b.split("|"),e=function(a){return a===1?0:1},f=e(c);return d[f]?d[f]:d[0]}};return b}),Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]},function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a,b){return b||(b=2),("000"+a).slice(b*-1)};b.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},b.setTimeToNow=function(){var a=new Date;return this.setHours(a.getHours()),this.setMinutes(a.getMinutes()),this.setSeconds(a.getSeconds()),this.setMilliseconds(a.getMilliseconds()),this},a.today=function(){return(new Date).clearTime()},a.compare=function(a,b){if(isNaN(a)||isNaN(b))throw new Error(a+" - "+b);if(a instanceof Date&&b instanceof Date)return a<b?-1:a>b?1:0;throw new TypeError(a+" - "+b)},a.equals=function(a,b){return a.compareTo(b)===0},a.getDayNumberFromName=function(a){var b=c.dayNames,d=c.abbreviatedDayNames,e=c.shortestDayNames,f=a.toLowerCase();for(var g=0;g<b.length;g++)if(b[g].toLowerCase()==f||d[g].toLowerCase()==f||e[g].toLowerCase()==f)return g;return-1},a.getMonthNumberFromName=function(a){var b=c.monthNames,d=c.abbreviatedMonthNames,e=a.toLowerCase();for(var f=0;f<b.length;f++)if(b[f].toLowerCase()==e||d[f].toLowerCase()==e)return f;return-1},a.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},a.getDaysInMonth=function(b,c){return[31,a.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]},a.getTimezoneAbbreviation=function(a){var b=c.timezones,d;for(var e=0;e<b.length;e++)if(b[e].offset===a)return b[e].name;return null},a.getTimezoneOffset=function(a){var b=c.timezones,d;for(var e=0;e<b.length;e++)if(b[e].name===a.toUpperCase())return b[e].offset;return null},b.clone=function(){return new Date(this.getTime())},b.compareTo=function(a){return Date.compare(this,a)},b.equals=function(a){return Date.equals(this,a||new Date)},b.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()},b.isAfter=function(a){return this.compareTo(a||new Date)===1},b.isBefore=function(a){return this.compareTo(a||new Date)===-1},b.isToday=function(){return this.isSameDay(new Date)},b.isSameDay=function(a){return this.clone().clearTime().equals(a.clone().clearTime())},b.addMilliseconds=function(a){return this.setMilliseconds(this.getMilliseconds()+a),this},b.addSeconds=function(a){return this.addMilliseconds(a*1e3)},b.addMinutes=function(a){return this.addMilliseconds(a*6e4)},b.addHours=function(a){return this.addMilliseconds(a*36e5)},b.addDays=function(a){return this.setDate(this.getDate()+a),this},b.addWeeks=function(a){return this.addDays(a*7)},b.addMonths=function(b){var c=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+b),this.setDate(Math.min(c,a.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},b.addYears=function(a){return this.addMonths(a*12)},b.add=function(a){if(typeof a=="number")return this._orient=a,this;var b=a;return b.milliseconds&&this.addMilliseconds(b.milliseconds),b.seconds&&this.addSeconds(b.seconds),b.minutes&&this.addMinutes(b.minutes),b.hours&&this.addHours(b.hours),b.weeks&&this.addWeeks(b.weeks),b.months&&this.addMonths(b.months),b.years&&this.addYears(b.years),b.days&&this.addDays(b.days),this};var e,f,g;b.getWeek=function(){var a,b,c,d,h,i,j,k,l,m;return e=e?e:this.getFullYear(),f=f?f:this.getMonth()+1,g=g?g:this.getDate(),f>2?(a=e,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),l=b-c,h=l+1,i=g+(153*(f-3)+2)/5+58+l):(a=e-1,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),l=b-c,h=0,i=g-1+31*(f-1)),j=(a+b)%7,d=(i+j-h)%7,k=i+3-d|0,k<0?m=53-((j-l)/5|0):k>364+l?m=1:m=(k/7|0)+1,e=f=g=null,m},b.getISOWeek=function(){return e=this.getUTCFullYear(),f=this.getUTCMonth()+1,g=this.getUTCDate(),d(this.getWeek())},b.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())},a._validate=function(a,b,c,d){if(typeof a=="undefined")return!1;if(typeof a!="number")throw new TypeError(a+" is not a Number.");if(a<b||a>c)throw new RangeError(a+" is not a valid value for "+d+".");return!0},a.validateMillisecond=function(b){return a._validate(b,0,999,"millisecond")},a.validateSecond=function(b){return a._validate(b,0,59,"second")},a.validateMinute=function(b){return a._validate(b,0,59,"minute")},a.validateHour=function(b){return a._validate(b,0,23,"hour")},a.validateDay=function(b,c,d){return a._validate(b,1,a.getDaysInMonth(c,d),"day")},a.validateMonth=function(b){return a._validate(b,0,11,"month")},a.validateYear=function(b){return a._validate(b,0,9999,"year")},b.set=function(b){return a.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds()),a.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds()),a.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes()),a.validateHour(b.hour)&&this.addHours(b.hour-this.getHours()),a.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth()),a.validateYear(b.year)&&this.addYears(b.year-this.getFullYear()),a.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate()),b.timezone&&this.setTimezone(b.timezone),b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset),b.week&&a._validate(b.week,0,53,"week")&&this.setWeek(b.week),this},b.moveToFirstDayOfMonth=function(){return this.set({day:1})},b.moveToLastDayOfMonth=function(){return this.set({day:a.getDaysInMonth(this.getFullYear(),this.getMonth())})},b.moveToNthOccurrence=function(a,b){var c=0;if(b>0)c=b-1;else if(b===-1)return this.moveToLastDayOfMonth(),this.getDay()!==a&&this.moveToDayOfWeek(a,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(a,1).addWeeks(c)},b.moveToDayOfWeek=function(a,b){var c=(a-this.getDay()+7*(b||1))%7;return this.addDays(c===0?c+=7*(b||1):c)},b.moveToMonth=function(a,b){var c=(a-this.getMonth()+12*(b||1))%12;return this.addMonths(c===0?c+=12*(b||1):c)},b.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864e5)+1},b.getTimezone=function(){return a.getTimezoneAbbreviation(this.getUTCOffset())},b.setTimezoneOffset=function(a){var b=this.getTimezoneOffset(),c=Number(a)*-6/10;return this.addMinutes(c-b)},b.setTimezone=function(b){return this.setTimezoneOffset(a.getTimezoneOffset(b))},b.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()},b.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&(new Date).getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset()},b.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6,b;return a<0?(b=(a-1e4).toString(),b.charAt(0)+b.substr(2)):(b=(a+1e4).toString(),"+"+b.substr(1))},b.getElapsed=function(a){return(a||new Date)-this},b.toISOString||(b.toISOString=function(){function a(a){return a<10?"0"+a:a}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'}),b._toString=b.toString,b.toString=function(a){var b=this;if(a&&a.length==1){var e=c.formatPatterns;b.t=b.toString;switch(a){case"d":return b.t(e.shortDate);case"D":return b.t(e.longDate);case"F":return b.t(e.fullDateTime);case"m":return b.t(e.monthDay);case"r":return b.t(e.rfc1123);case"s":return b.t(e.sortableDateTime);case"t":return b.t(e.shortTime);case"T":return b.t(e.longTime);case"u":return b.t(e.universalSortableDateTime);case"y":return b.t(e.yearMonth)}}var f=function(a){switch(a*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return a?a.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(a){if(a.charAt(0)==="\\")return a.replace("\\","");b.h=b.getHours;switch(a){case"hh":return d(b.h()<13?b.h()===0?12:b.h():b.h()-12);case"h":return b.h()<13?b.h()===0?12:b.h():b.h()-12;case"HH":return d(b.h());case"H":return b.h();case"mm":return d(b.getMinutes());case"m":return b.getMinutes();case"ss":return d(b.getSeconds());case"s":return b.getSeconds();case"yyyy":return d(b.getFullYear(),4);case"yy":return d(b.getFullYear());case"dddd":return c.dayNames[b.getDay()];case"ddd":return c.abbreviatedDayNames[b.getDay()];case"dd":return d(b.getDate());case"d":return b.getDate();case"MMMM":return c.monthNames[b.getMonth()];case"MMM":return c.abbreviatedMonthNames[b.getMonth()];case"MM":return d(b.getMonth()+1);case"M":return b.getMonth()+1;case"t":return b.h()<12?c.amDesignator.substring(0,1):c.pmDesignator.substring(0,1);case"tt":return b.h()<12?c.amDesignator:c.pmDesignator;case"S":return f(b.getDate());default:return a}}):this._toString()}}(),function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=Number.prototype;b._orient=1,b._nth=null,b._is=!1,b._same=!1,b._isSecond=!1,d._dateElement="day",b.next=function(){return this._orient=1,this},a.next=function(){return a.today().next()},b.last=b.prev=b.previous=function(){return this._orient=-1,this},a.last=a.prev=a.previous=function(){return a.today().last()},b.is=function(){return this._is=!0,this},b.same=function(){return this._same=!0,this._isSecond=!1,this},b.today=function(){return this.same().day()},b.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},b.at=function(b){return typeof b=="string"?a.parse(this.toString("d")+" "+b):this.set(b)},d.fromNow=d.after=function(a){var b={};return b[this._dateElement]=this,(a?a.clone():new Date).add(b)},d.ago=d.before=function(a){var b={};return b[this._dateElement]=this*-1,(a?a.clone():new Date).add(b)};var e="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),f="january february march april may june july august september october november december".split(/\s/),g="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),h="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),i="final first second third fourth fifth".split(/\s/),j;b.toObject=function(){var a={};for(var b=0;b<g.length;b++)a[g[b].toLowerCase()]=this["get"+h[b]]();return a},a.fromObject=function(a){return a.week=null,Date.today().set(a)};var k=function(b){return function(){if(this._is)return this._is=!1,this.getDay()==b;if(this._nth!==null){this._isSecond&&this.addSeconds(this._orient*-1),this._isSecond=!1;var c=this._nth;this._nth=null;var d=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(b,c);if(this>d)throw new RangeError(a.getDayName(b)+" does not occur "+c+" times in the month of "+a.getMonthName(d.getMonth())+" "+d.getFullYear()+".");return this}return this.moveToDayOfWeek(b,this._orient)}},l=function(b){return function(){var d=a.today(),e=b-d.getDay();return b===0&&c.firstDayOfWeek===1&&d.getDay()!==0&&(e+=7),d.addDays(e)}};for(var m=0;m<e.length;m++)a[e[m].toUpperCase()]=a[e[m].toUpperCase().substring(0,3)]=m,a[e[m]]=a[e[m].substring(0,3)]=l(m),b[e[m]]=b[e[m].substring(0,3)]=k(m);var n=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}},o=function(b){return function(){return a.today().set({month:b,day:1})}};for(var p=0;p<f.length;p++)a[f[p].toUpperCase()]=a[f[p].toUpperCase().substring(0,3)]=p,a[f[p]]=a[f[p].substring(0,3)]=o(p),b[f[p]]=b[f[p].substring(0,3)]=n(p);var q=function(a){return function(){if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;var b=this.toObject(),c=(arguments[0]||new Date).toObject(),d="",e=a.toLowerCase();for(var f=g.length-1;f>-1;f--){d=g[f].toLowerCase();if(b[d]!=c[d])return!1;if(e==d)break}return!0}return a.substring(a.length-1)!="s"&&(a+="s"),this["add"+a](this._orient)}},r=function(a){return function(){return this._dateElement=a,this}};for(var s=0;s<g.length;s++)j=g[s].toLowerCase(),b[j]=b[j+"s"]=q(g[s]),d[j]=d[j+"s"]=r(j);b._ss=q("Second");var t=function(a){return function(b){return this._same?this._ss(arguments[0]):b||b===0?this.moveToNthOccurrence(b,a):(this._nth=a,a!==2||b!==undefined&&b!==null?this:(this._isSecond=!0,this.addSeconds(this._orient)))}};for(var u=0;u<i.length;u++)b[i[u]]=u===0?t(-1):t(u)}(),function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var a=Date.Parsing,b=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c)}},token:function(a){return function(a){return b.rtoken(new RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return b.rtoken(new RegExp("^"+a))},until:function(a){return function(b){var c=[],d=null;while(b.length){try{d=a.call(this,b)}catch(e){c.push(d[0]),b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){var c=[],d=null;while(b.length){try{d=a.call(this,b)}catch(e){return[c,b]}c.push(d[0]),b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c)}},ignore:function(a){return a?function(b){var c=null;return c=a.call(this,b),[null,c[1]]}:null},product:function(){var a=arguments[0],c=Array.prototype.slice.call(arguments,1),d=[];for(var e=0;e<a.length;e++)d.push(b.each(a[e],c));return d},cache:function(b){var c={},d=null;return function(e){try{d=c[e]=c[e]||b.call(this,e)}catch(f){d=c[e]=f}if(d instanceof a.Exception)throw d;return d}},any:function(){var b=arguments;return function(c){var d=null;for(var e=0;e<b.length;e++){if(b[e]==null)continue;try{d=b[e].call(this,c)}catch(f){d=null}if(d)return d}throw new a.Exception(c)}},each:function(){var b=arguments;return function(c){var d=[],e=null;for(var f=0;f<b.length;f++){if(b[f]==null)continue;try{e=b[f].call(this,c)}catch(g){throw new a.Exception(c)}d.push(e[0]),c=e[1]}return[d,c]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,c.length==1?c[0]:function(b){var f=null,g=null,h=[];for(var i=0;i<c.length;i++){try{f=c[i].call(this,b)}catch(j){break}h.push(f[0]);try{g=d.call(this,f[1])}catch(k){g=null;break}b=g[1]}if(!f)throw new a.Exception(b);if(g)throw new a.Exception(g[1]);if(e)try{f=e.call(this,f[1])}catch(l){throw new a.Exception(f[1])}return[h,f?f[1]:b]}},between:function(a,c,d){d=d||a;var e=b.each(b.ignore(a),c,b.ignore(d));return function(a){var b=e.call(this,a);return[[b[0][0],r[0][2]],b[1]]}},list:function(a,c,d){return c=c||b.rtoken(/^\s*/),d=d||null,a instanceof Array?b.each(b.product(a.slice(0,-1),b.ignore(c)),a.slice(-1),b.ignore(d)):b.each(b.many(b.each(a,b.ignore(c))),px,b.ignore(d))},set:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,function(f){var g=null,h=null,i=null,j=null,k=[[],f],l=!1;for(var m=0;m<c.length;m++){i=null,h=null,g=null,l=c.length==1;try{g=c[m].call(this,f)}catch(n){continue}j=[[g[0]],g[1]];if(g[1].length>0&&!l)try{i=d.call(this,g[1])}catch(o){l=!0}else l=!0;!l&&i[1].length===0&&(l=!0);if(!l){var p=[];for(var q=0;q<c.length;q++)m!=q&&p.push(c[q]);h=b.set(p,d).call(this,i[1]),h[0].length>0&&(j[0]=j[0].concat(h[0]),j[1]=h[1])}j[1].length<k[1].length&&(k=j);if(k[1].length===0)break}if(k[0].length===0)return k;if(e){try{i=e.call(this,k[1])}catch(r){throw new a.Exception(k[1])}k[1]=i[1]}return k}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},c=function(a){return function(){var b=null,c=[];arguments.length>1?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(b=arguments[0]);if(!b)return a.apply(null,arguments);for(var d=0,e=b.shift();d<e.length;d++)return b.unshift(e[d]),c.push(a.apply(null,b)),b.shift(),c}},d="optional not ignore cache".split(/\s/);for(var e=0;e<d.length;e++)b[d[e]]=c(b[d[e]]);var f=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}},g="each any all".split(/\s/);for(var h=0;h<g.length;h++)b[g[h]]=f(b[g[h]])}(),function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a){var b=[];for(var c=0;c<a.length;c++)a[c]instanceof Array?b=b.concat(d(a[c])):a[c]&&b.push(a[c]);return b};a.Grammar={},a.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=a.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2e3<c.twoDigitYearMax?2e3:1900)}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(b){b=b instanceof Array?b:[b];for(var c=0;c<b.length;c++)b[c]&&b[c].call(this);var d=new Date;(this.hour||this.minute)&&!this.month&&!this.year&&!this.day&&(this.day=d.getDate()),this.year||(this.year=d.getFullYear()),!this.month&&this.month!==0&&(this.month=d.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.day>a.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?e.set({timezone:this.timezone}):this.timezoneOffset&&e.set({timezoneOffset:this.timezoneOffset}),e},finish:function(b){b=b instanceof Array?d(b):[b];if(b.length===0)return null;for(var c=0;c<b.length;c++)typeof b[c]=="function"&&b[c].call(this);var e=a.today();if(this.now&&!this.unit&&!this.operator)return new Date;this.now&&(e=new Date);var f=!!(this.days&&this.days!==null||this.orient||this.operator),g,h,i;i=this.orient=="past"||this.operator=="subtract"?-1:1,!this.now&&"hour minute second".indexOf(this.unit)!=-1&&e.setTimeToNow(),(this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!=-1&&(this.value=this.month+1,this.month=null,f=!0);if(!f&&this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate(),this.month||(this.month=j.getMonth()),this.year=j.getFullYear()}f&&this.weekday&&this.unit!="month"&&(this.unit="day",g=a.getDayNumberFromName(this.weekday)-e.getDay(),h=7,this.days=g?(g+i*h)%h:i*h),this.month&&this.unit=="day"&&this.operator&&(this.value=this.month+1,this.month=null),this.value!=null&&this.month!=null&&this.year!=null&&(this.day=this.value*1),this.month&&!this.day&&this.value&&(e.set({day:this.value*1}),f||(this.day=this.value*1)),!this.month&&this.value&&this.unit=="month"&&!this.now&&(this.month=this.value,f=!0),f&&(this.month||this.month===0)&&this.unit!="year"&&(this.unit="month",g=this.month-e.getMonth(),h=12,this.months=g?(g+i*h)%h:i*h,this.month=null),this.unit||(this.unit="day");if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null)this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*i;else if(this[this.unit+"s"]==null||this.operator!=null)this.value||(this.value=1),this[this.unit+"s"]=this.value*i;this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate(),j.getMonth()!==e.getMonth()&&(this.month=j.getMonth())}return(this.month||this.month===0)&&!this.day&&(this.day=1),!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month?Date.today().setWeek(this.value):(f&&this.timezone&&this.day&&this.days&&(this.day=this.days),f?e.add(this):e.set(this))}};var e=a.Parsing.Operators,f=a.Grammar,g=a.Translator,h;f.datePartDelimiter=e.rtoken(/^([\s\-\.\,\/\x27]+)/),f.timePartDelimiter=e.stoken(":"),f.whiteSpace=e.rtoken(/^\s*/),f.generalDelimiter=e.rtoken(/^(([\s\,]|at|@|on)+)/);var i={};f.ctoken=function(a){var b=i[a];if(!b){var d=c.regexPatterns,f=a.split(/\s+/),g=[];for(var h=0;h<f.length;h++)g.push(e.replace(e.rtoken(d[f[h]]),f[h]));b=i[a]=e.any.apply(null,g)}return b},f.ctoken2=function(a){return e.rtoken(c.regexPatterns[a])},f.h=e.cache(e.process(e.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),g.hour)),f.hh=e.cache(e.process(e.rtoken(/^(0[0-9]|1[0-2])/),g.hour)),f.H=e.cache(e.process(e.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),g.hour)),f.HH=e.cache(e.process(e.rtoken(/^([0-1][0-9]|2[0-3])/),g.hour)),f.m=e.cache(e.process(e.rtoken(/^([0-5][0-9]|[0-9])/),g.minute)),f.mm=e.cache(e.process(e.rtoken(/^[0-5][0-9]/),g.minute)),f.s=e.cache(e.process(e.rtoken(/^([0-5][0-9]|[0-9])/),g.second)),f.ss=e.cache(e.process(e.rtoken(/^[0-5][0-9]/),g.second)),f.hms=e.cache(e.sequence([f.H,f.m,f.s],f.timePartDelimiter)),f.t=e.cache(e.process(f.ctoken2("shortMeridian"),g.meridian)),f.tt=e.cache(e.process(f.ctoken2("longMeridian"),g.meridian)),f.z=e.cache(e.process(e.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone)),f.zz=e.cache(e.process(e.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone)),f.zzz=e.cache(e.process(f.ctoken2("timezone"),g.timezone)),f.timeSuffix=e.each(e.ignore(f.whiteSpace),e.set([f.tt,f.zzz])),f.time=e.each(e.optional(e.ignore(e.stoken("T"))),f.hms,f.timeSuffix),f.d=e.cache(e.process(e.each(e.rtoken(/^([0-2]\d|3[0-1]|\d)/),e.optional(f.ctoken2("ordinalSuffix"))),g.day)),f.dd=e.cache(e.process(e.each(e.rtoken(/^([0-2]\d|3[0-1])/),e.optional(f.ctoken2("ordinalSuffix"))),g.day)),f.ddd=f.dddd=e.cache(e.process(f.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}})),f.M=e.cache(e.process(e.rtoken(/^(1[0-2]|0\d|\d)/),g.month)),f.MM=e.cache(e.process(e.rtoken(/^(1[0-2]|0\d)/),g.month)),f.MMM=f.MMMM=e.cache(e.process(f.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),g.month)),f.y=e.cache(e.process(e.rtoken(/^(\d\d?)/),g.year)),f.yy=e.cache(e.process(e.rtoken(/^(\d\d)/),g.year)),f.yyy=e.cache(e.process(e.rtoken(/^(\d\d?\d?\d?)/),g.year)),f.yyyy=e.cache(e.process(e.rtoken(/^(\d\d\d\d)/),g.year)),h=function(){return e.each(e.any.apply(null,arguments),e.not(f.ctoken2("timeContext")))},f.day=h(f.d,f.dd),f.month=h(f.M,f.MMM),f.year=h(f.yyyy,f.yy),f.orientation=e.process(f.ctoken("past future"),function(a){return function(){this.orient=a}}),f.operator=e.process(f.ctoken("add subtract"),function(a){return function(){this.operator=a}}),f.rday=e.process(f.ctoken("yesterday tomorrow today now"),g.rday),f.unit=e.process(f.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}}),f.value=e.process(e.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}}),f.expression=e.set([f.rday,f.operator,f.value,f.unit,f.orientation,f.ddd,f.MMM]),h=function(){return e.set(arguments,f.datePartDelimiter)},f.mdy=h(f.ddd,f.month,f.day,f.year),f.ymd=h(f.ddd,f.year,f.month,f.day),f.dmy=h(f.ddd,f.day,f.month,f.year),f.date=function(a){return(f[c.dateElementOrder]||f.mdy).call(this,a)},f.format=e.process(e.many(e.any(e.process(e.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(f[b])return f[b];throw a.Parsing.Exception(b)}),e.process(e.rtoken(/^[^dMyhHmstz]+/),function(a){return e.ignore(e.stoken(a))}))),function(a){return e.process(e.each.apply(null,a),g.finishExact)});var j={},k=function(a){return j[a]=j[a]||f.format(a)[0]};f.formats=function(a){if(a instanceof Array){var b=[];for(var c=0;c<a.length;c++)b.push(k(a[c]));return e.any.apply(null,b)}return k(a)},f._formats=f.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),f._start=e.process(e.set([f.date,f.time,f.expression],f.generalDelimiter,f.whiteSpace),g.finish),f.start=function(a){try{var b=f._formats.call({},a);if(b[1].length===0)return b}catch(c){}return f._start.call({},a)},a._parse=a.parse,a.parse=function(b){var c=null;if(!b)return null;if(b instanceof Date)return b;try{c=a.Grammar.start.call({},b.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(d){return null}return c[1].length===0?c[0]:null},a.getParseFunction=function(b){var c=a.Grammar.formats(b);return function(a){var b=null;try{b=c.call({},a)}catch(d){return null}return b[1].length===0?b[0]:null}},a.parseExact=function(b,c){return a.getParseFunction(c)(b)}}(),define("libs/date.js/build/date",function(){}),define("tau/utils/utils.date",["Underscore","tau/configurator","tau/utils/utils.date/utils.date.formats","tau/utils/utils.translation","libs/date.js/build/date"],function(_,configurator,formatData,Translation){var util={},f=function(a){return function(b){var c=util.parse(b);return c?util._format(c,a):""}};return util={format:{date:{"short":f(formatData.date.short)},time:{"short":f(formatData.time.short)},datetime:{"short":f(formatData.datetime.short)}},_format:function(a,b){return a.toString(b)||""},formatAs:function(a,b){return this._format(a,b)},parse:function(dateString){return _.isString(dateString)&&/^\/Date\(/.test(dateString)&&(dateString=eval(["new ",dateString.replace(/\//gi,"")].join(""))),Date.parse(dateString)},getFormatData:function(){return formatData},getAge:function(a,b){b=b||configurator.getCurrentDate(),a=Date.parse(a);var c={isZero:!0,value:0,unit:"sec",direction:"ago",toString:function(){var a;return this.isZero?a="now":a=this.value+" "+this.unit+" "+this.direction,a}};c.direction=b>a?"ago":"after";var d=new Date(0),e=new Date(b>a?b-a:a-b),f=[{func:"getYear",units:"year|years"},{func:"getMonth",units:"month|months"},{func:"getDate",units:"day|days"},{func:"getHours",units:"hour|hours"},{func:"getMinutes",units:"min"},{func:"getSeconds",units:"sec"}],g=_.detect(f,function(a){var b=e[a.func]()-d[a.func]();if(b>0)return a.value=b,a.unit=Translation.pluralize(a.units,b),!0});return g&&(c.isZero=!1,c.value=g.value,c.unit=g.unit),c}},util}),define("tau/models/model.attachments",["tau/core/model-base","tau/configurator","tau/utils/utils.date"],function(a,b,c){function e(a,b){this.model=a,this.filterCallback=b||d}var d=function(){return!0};e.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(a){this.assignable=a.data;var b={items:this.getAttachments()},c=this.getSelected();c&&(b.selected=c),this.model.data=b,this.model.bus.fire("dataBind",b)},each:function(a){var b=this.assignable.attachments,c=b.length;for(var d=0;d<c;d++){var e=b[d];this.filterCallback(e)&&a(e)}},getAttachments:function(){var a=this,b=[],c=a.model.config.selected,d=function(d){var e=a.attachmentDTOToModelAttachment(d);b.push(e),c&&d.id==c.id&&(a.selected=e,e.selected=!0)};return this.each(d),b},attachmentDTOToModelAttachment:function(a){var b=c.parse(a.date);return{id:a.id,name:a.name,mimeType:a.mimeType,ownerName:[a.owner.firstName," ",a.owner.lastName].join(""),date:c.format.date.short(b),thumbnailUri:a.thumbnailUri,uri:a.uri}},getSelected:function(){return this.selected}};var f=a.extend({init:function(a,b,c){this.name="Attachment Model",this._super.apply(this,arguments),this.filter=this.config.filter||c},_getFields:function(){var a=[{attachments:["id","date","name","mimeType","uri","thumbnailUri",{owner:["id","firstName","lastName"]}]}];return a},onInit:function(){var a=this.config.context.entity,b=new e(this,this.filter),c=this._getFields();this.store.get(a.entityType.name,{id:a.id,fields:c},b.getAssignableRetrievedCallback()).done()},setSelected:function(a){if(this.config.selected.id!=a.id){var b=this.data.items,c=null;for(var d=0;d<b.length;d++)if(b[d].id==a.id){c=b[d];break}c&&(this.config.selected=c,this.fire("selectedChanged",{attachment:a}))}},next:function(){var a=this.data.items,b=null,c=this.config.selected;for(var d=0;d<a.length;d++)if(a[d].id==c.id){b=a[d];break}b&&(d==a.length-1&&(d=-1),this.setSelected(a[d+1]))},prev:function(){var a=this.data.items,b=null,c=this.config.selected;for(var d=0;d<a.length;d++)if(a[d].id==c.id){b=a[d];break}b&&(d==0&&(d=a.length),this.setSelected(a[d-1]))},close:function(){this.fire("close")},"bus attachmentUploaded":function(a){var b=this,c=[{general:["id"]}].concat(b._getFields()[0].attachments);b.store.save("attachment",{id:a.data.data.id,$set:{},fields:c}).done({success:function(){b.bus.fire("attachmentUploadCompleted",{element:a.data.element})}})}});return f}),define("tau/models/model.attachments.editable",["Underscore","tau/core/model.editable.base"],function(a,b){return b.extend({category:"edit",name:"Editable attachment","bus dataBind":function(a){this.bus.fire("permissionsReady",{editable:!0,deletable:!0}),this._attachments||(this._attachments=a.data.items)},"bus attachmentUploaded":function(a){this._addAttachment(a.data.data)},onInit:function(){var a=this;this.store.on({eventName:"afterRemove",listener:a,type:"attachment"},function(b){var c=parseInt(b.data.cmd.config.id);a._isValidAttachmentId(c)&&(a._removeAttachment(c),a.bus.fire("afterAttachmentRemove",{id:c}))})},_addAttachment:function(a){this._attachments.push(a)},_removeAttachment:function(b){this._attachments=a.reject(this._attachments,function(a){return b===a.id})},_isValidAttachmentId:function(b){return a.any(this._attachments,function(a){return a.id===b})}})}),define("libs/jquery/jquery.fileupload",["libs/jquery/jquery.ui"],function(a){return function(a){a.widget("blueimp.fileupload",{options:{namespace:undefined,dropZone:a(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,sequentialUploads:!1,forceIframeTransport:!1,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,formData:function(a){return a.serializeArray()},add:function(a,b){b.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","dropZone","fileInput"],_isXHRUpload:function(a){var b="undefined";return!a.forceIframeTransport&&typeof XMLHttpRequestUpload!==b&&typeof File!==b&&(!a.multipart||typeof FormData!==b)},_getFormData:function(b){var c;return typeof b.formData=="function"?b.formData(b.form):a.isArray(b.formData)?b.formData:b.formData?(c=[],a.each(b.formData,function(a,b){c.push({name:a,value:b})}),c):[]},_getTotal:function(b){var c=0;return a.each(b,function(a,b){c+=b.size||1}),c},_onProgress:function(a,b){if(a.lengthComputable){var c=b.total||this._getTotal(b.files),d=parseInt(a.loaded/a.total*(b.chunkSize||c),10)+(b.uploadedBytes||0);this._loaded+=d-(b.loaded||b.uploadedBytes||0),b.lengthComputable=!0,b.loaded=d,b.total=c,this._trigger("progress",a,b),this._trigger("progressall",a,{lengthComputable:!0,loaded:this._loaded,total:this._total})}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():a.ajaxSettings.xhr();d.upload&&d.upload.addEventListener&&(d.upload.addEventListener("progress",function(a){c._onProgress(a,b)},!1),b.xhr=function(){return d})},_initXHRData:function(b){var c,d=b.files[0];if(!b.multipart||b.blob)b.headers=a.extend(b.headers,{"X-File-Name":d.name,"X-File-Type":d.type,"X-File-Size":d.size}),b.blob?b.multipart||(b.contentType="application/octet-stream",b.data=b.blob):(b.contentType=d.type,b.data=d);b.multipart&&typeof FormData!="undefined"&&(b.formData instanceof FormData?c=b.formData:(c=new FormData,a.each(this._getFormData(b),function(a,b){c.append(b.name,b.value)})),b.blob?c.append(b.paramName,b.blob):a.each(b.files,function(a,d){d instanceof Blob&&c.append(b.paramName,d)}),b.data=c),b.blob=null},_initIframeSettings:function(a){a.dataType="iframe "+(a.dataType||""),a.formData=this._getFormData(a)},_initDataSettings:function(a){this._isXHRUpload(a)?this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)):this._initIframeSettings(a)},_initFormSettings:function(b){if(!b.form||!b.form.length)b.form=a(b.fileInput.prop("form"));b.paramName||(b.paramName=b.fileInput.prop("name")||"files[]"),b.url||(b.url=b.form.prop("action")||location.href),b.type=(b.type||b.form.prop("method")||"").toUpperCase(),b.type!=="POST"&&b.type!=="PUT"&&(b.type="POST")},_getAJAXSettings:function(b){var c=a.extend({},this.options,b);return this._initFormSettings(c),this._initDataSettings(c),c},_enhancePromise:function(a){return a.success=a.done,a.error=a.fail,a.complete=a.always,a},_getXHRPromise:function(b,c,d){var e=a.Deferred(),f=e.promise();return c=c||this.options.context||f,b===!0?e.resolveWith(c,d):b===!1&&e.rejectWith(c,d),f.abort=e.promise,this._enhancePromise(f)},_chunkedUpload:function(b,c){var d=this,e=b.files[0],f=e.size,g=b.uploadedBytes=b.uploadedBytes||0,h=b.maxChunkSize||f,i=e.webkitSlice||e.mozSlice||e.slice,j,k,l,m;return!this._isXHRUpload(b)||!i||!g&&h>=f||b.data?!1:c?!0:g<f?(k=Math.ceil((f-g)/h),j=function(c){return c?j(c-=1).pipe(function(){var f=a.extend({},b);return f.blob=i.call(e,g+c*h,g+(c+1)*h),f.chunkSize=f.blob.size,d._initXHRData(f),d._initProgressListener(f),l=(a.ajax(f)||d._getXHRPromise(!1,f.context)).done(function(){f.loaded||d._onProgress(a.Event("progress",{lengthComputable:!0,loaded:f.chunkSize,total:f.chunkSize}),f),b.uploadedBytes=f.uploadedBytes+=f.chunkSize}),l}):d._getXHRPromise(!0)},m=j(k),m.abort=function(){return l.abort()},this._enhancePromise(m)):(e.error="uploadedBytes",this._getXHRPromise(!1))},_beforeSend:function(a,b){this._active===0&&this._trigger("start"),this._active+=1,this._loaded+=b.uploadedBytes||0,this._total+=this._getTotal(b.files)},_onDone:function(b,c,d,e){this._isXHRUpload(e)||this._onProgress(a.Event("progress",{lengthComputable:!0,loaded:1,total:1}),e),e.result=b,e.textStatus=c,e.jqXHR=d,this._trigger("done",null,e)},_onFail:function(a,b,c,d){d.jqXHR=a,d.textStatus=b,d.errorThrown=c,this._trigger("fail",null,d),d.recalculateProgress&&(this._loaded-=d.loaded||d.uploadedBytes||0,this._total-=d.total||this._getTotal(d.files))},_onAlways:function(a,b,c,d,e){this._active-=1,e.result=a,e.textStatus=b,e.jqXHR=c,e.errorThrown=d,this._trigger("always",null,e),this._active===0&&(this._trigger("stop"),this._loaded=this._total=0)},_onSend:function(b,c){var d=this,e,f,g=d._getAJAXSettings(c),h=function(c,f){return e=e||(c!==!1&&d._trigger("send",b,g)!==!1&&(d._chunkedUpload(g)||a.ajax(g))||d._getXHRPromise(!1,g.context,f)).done(function(a,b,c){d._onDone(a,b,c,g)}).fail(function(a,b,c){d._onFail(a,b,c,g)}).always(function(a,b,c){c&&c.done?d._onAlways(a,b,c,undefined,g):d._onAlways(undefined,b,a,c,g)}),e};return this._beforeSend(b,g),this.options.sequentialUploads?(f=this._sequence=this._sequence.pipe(h,h),f.abort=function(){return e?e.abort():h(!1,[undefined,"abort","abort"])},this._enhancePromise(f)):h()},_onAdd:function(b,c){var d=this,e=!0,f=a.extend({},this.options,c);if(f.singleFileUploads&&this._isXHRUpload(f))return a.each(c.files,function(f,g){var h=a.extend({},c,{files:[g]});return h.submit=function(){return d._onSend(b,h)},e=d._trigger("add",b,h)}),e;if(c.files.length)return c=a.extend({},c),c.submit=function(){return d._onSend(b,c)},this._trigger("add",b,c)},_normalizeFile:function(a,b){b.name===undefined&&b.size===undefined&&(b.name=b.fileName,b.size=b.fileSize)},_replaceFileInput:function(a){var b=a.clone(!0).val("");return a.replaceWith(b),b},_onChange:function(b){var c=b.data.fileupload,d={files:a.each(a.makeArray(b.target.files),c._normalizeFile),fileInput:a(b.target),form:a(b.target.form)};d.files.length||(d.files=[{name:b.target.value.replace(/^.*\\/,"")}]),d.form.length?d.fileInput.data("blueimp.fileupload.form",d.form):d.form=d.fileInput.data("blueimp.fileupload.form"),c.options.replaceFileInput&&c._replaceFileInput(d.fileInput);if(c._trigger("change",b,d)===!1||c._onAdd(b,d)===!1)return!1},_onDrop:function(b){var c=b.data.fileupload,d=b.dataTransfer=b.originalEvent.dataTransfer,e={files:a.each(a.makeArray(d&&d.files),c._normalizeFile)};if(c._trigger("drop",b,e)===!1||c._onAdd(b,e)===!1)return!1;b.preventDefault()},_onDragOver:function(a){var b=a.data.fileupload,c=a.dataTransfer=a.originalEvent.dataTransfer;if(b._trigger("dragover",a)===!1)return!1;c&&(c.dropEffect=c.effectAllowed="copy"),a.preventDefault()},_initEventHandlers:function(){var a=this.options.namespace||this.name;this.options.dropZone.bind("dragover."+a,{fileupload:this},this._onDragOver).bind("drop."+a,{fileupload:this},this._onDrop),this.options.fileInput.bind("change."+a,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var a=this.options.namespace||this.name;this.options.dropZone.unbind("dragover."+a,this._onDragOver).unbind("drop."+a,this._onDrop),this.options.fileInput.unbind("change."+a,this._onChange)},_beforeSetOption:function(a,b){this._destroyEventHandlers()},_afterSetOption:function(b,c){var d=this.options;d.fileInput||(d.fileInput=a()),d.dropZone||(d.dropZone=a()),this._initEventHandlers()},_setOption:function(b,c){var d=a.inArray(b,this._refreshOptionsList)!==-1;d&&this._beforeSetOption(b,c),a.Widget.prototype._setOption.call(this,b,c),d&&this._afterSetOption(b,c)},_create:function(){var b=this.options;b.fileInput===undefined?b.fileInput=this.element.is("input:file")?this.element:this.element.find("input:file"):b.fileInput||(b.fileInput=a()),b.dropZone||(b.dropZone=a()),this._sequence=this._getXHRPromise(!0),this._active=this._loaded=this._total=0,this._initEventHandlers()},destroy:function(){this._destroyEventHandlers(),a.Widget.prototype.destroy.call(this)},enable:function(){a.Widget.prototype.enable.call(this),this._initEventHandlers()},disable:function(){this._destroyEventHandlers(),a.Widget.prototype.disable.call(this)},add:function(b){if(!b||this.options.disabled)return;b.files=a.each(a.makeArray(b.files),this._normalizeFile),this._onAdd(null,b)},send:function(b){if(b&&!this.options.disabled){b.files=a.each(a.makeArray(b.files),this._normalizeFile);if(b.files.length)return this._onSend(null,b)}return this._getXHRPromise(!1,b&&b.context)}})}(a),a.fn.fileupload}),define("libs/jquery/jquery.iframe-transport",["libs/jquery/jquery"],function(a){return function(a){var b=0;a.ajaxTransport("iframe",function(c,d,e){if(c.type==="POST"||c.type==="GET"){var f,g;return{send:function(d,e){f=a('<form style="display:none;"></form>'),g=a('<iframe src="javascript:false;" name="iframe-transport-'+(b+=1)+'"></iframe>').bind("load",function(){var b;g.unbind("load").bind("load",function(){var b;try{b=g.contents();if(!b.length||!b[0].firstChild)throw new Error}catch(c){b=undefined}e(200,"success",{iframe:b}),a('<iframe src="javascript:false;"></iframe>').appendTo(f),f.remove()}),f.prop("target",g.prop("name")).prop("action",c.url).prop("method",c.type),c.formData&&a.each(c.formData,function(b,c){a('<input type="hidden"/>').prop("name",c.name).val(c.value).appendTo(f)}),c.fileInput&&c.fileInput.length&&c.type==="POST"&&(b=c.fileInput.clone(),c.fileInput.after(function(a){return b[a]}),c.paramName&&c.fileInput.each(function(){a(this).prop("name",c.paramName)}),f.append(c.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),f.submit(),b&&b.length&&c.fileInput.each(function(c,d){var e=a(b[c]);a(d).prop("name",e.prop("name")),e.replaceWith(d)})}),f.append(g).appendTo("body")},abort:function(){g&&g.unbind("load").prop("src","javascript".concat(":false;")),f&&f.remove()}}}}),a.ajaxSetup({converters:{"iframe text":function(a){return a.text()},"iframe json":function(b){return a.parseJSON(b.text())},"iframe html":function(a){return a.find("body").html()},"iframe script":function(b){return a.globalEval(b.text())}}})}(a),{}}),define("tau/components/extensions/attachments/component.attachments.uploader",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","libs/jquery/jquery.fileupload","libs/jquery/jquery.iframe-transport"],function(a,b,c,d,e,f){var g=/<title\b[^>]*>(.*?)<\/title>/;return c.extend({"bus permissionsReady+afterRender":function(a){if(!this._initialized){this._initialized=!0,this.element=a.afterRender.data.element;var b=a.permissionsReady.data;b.editable&&b.deletable&&this._initUploader()}},_initUploader:function(){this._createToolbar(),this._bindUploader()},_createToolbar:function(){var a=b('<div class="uploader-toolbar"></div>'),c=this._createFileBrowser();a.append(c).prependTo(this.element),this._$fileInput=c.find("input"),/\bapple\b/i.test(navigator.vendor)&&this._$fileInput.removeAttr("multiple")},_bindUploader:function(){e.call(this._$fileInput,{url:this._getUploadUrl(),formData:this._getFormData(),add:b.proxy(this,"_onFileAdd")})},_createFileBrowser:function(){return b('<span class="fileBrowser"><i>Attach files</i></span>').append(b('<input type="file" multiple/>'))},_getUploadUrl:function(){return this.config.configurator.getApplicationPath()+"/UploadFile.ashx"},_getFormData:function(){return[{name:"generalId",value:this._getGeneralId()}]},_getGeneralId:function(){return this.config.context.entity.id},_getGeneralType:function(){return this.config.context.entity.entityType.name},_onFileAdd:function(a,b){var c=this,d=this._createAttachmentDummy(b.files[0].name);d.appendTo(this._getAttachmentsPlaceholder()),b.submit().success(function(a){var b=c._getResponseText(a);try{var e=c._parseResponse(b)}catch(f){c._onAttachmentUploadFail(d);return}c.bus.fire("attachmentUploaded",{element:c._updateAttachmentElement(d,e),data:e})}).error(function(a,b,e){var f=a.responseText.match(g),h="Looks like application is not available. Please check your connection or server availability";f&&f.length>0&&(h=f[1]),c._onAttachmentUploadFail(d,h)})},_updateAttachmentElement:function(a,b){var c=this._createAttachmentElement(b);return a.replaceWith(c),c},_onAttachmentUploadFail:function(a,b){this._deleteFailedAttachmentElement(a,b)},_getResponseText:function(a){var b="";return typeof a=="string"?b=a:a.jquery&&(b=a.text()),b},_createAttachmentDummy:function(a){var b=this._createAttachmentElement({name:a});return b.addClass("uploading").find(".toolbar").remove(),b},_deleteFailedAttachmentElement:function(a,c){c=c||"Upload failed",this.fire("error",{message:c}),a.addClass("failed");var d=b('<p class="error"></p>').insertAfter(a.find(".name"));d.text("Upload failed"),a.fadeOut(1500,function(){a.remove()})},_getAttachmentsPlaceholder:function(){return this.element.find(".ui-attachments-content")},_createAttachmentElement:function(a){return b.tmpl("attachments-attachment",a)},_parseResponse:function(a){var c=b.parseJSON(a)[0],e=d.parse(c[1]),f={id:c[0],uri:c[4],thumbnailUri:c[5],mimeType:c[3],name:c[2],ownerName:c[6][1]+" "+c[6][2],date:d.format.date.short(e)};return f}})}),define("tau/components/extensions/attachments/component.attachments.selectable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(a,b,c){return c.extend({"bus afterRender":function(a){var c=a.data.element;c.delegate(".ui-attach .inner","click",b.proxy(this,"_onAttachmentClick"))},_onAttachmentClick:function(a){var c=b(a.target),d=c.closest(".toolbar").size()!=0;if(!d){a.preventDefault();var e=c.closest(".ui-attach");this.bus.fire("attachmentSelected",{attachment:e.data().tmplItem.data,index:e.index()})}}})}),define("tau/components/extensions/attachments/component.attachments.showPreview",["Underscore","tau/components/extensions/component.creator.extension"],function(a,b){var c=b.extend({"bus initialize":function(b){var c=b.data.context,d=c.assignable;this.contextForPreview={applicationContext:c.applicationContext};var e={entityType:d.entityType,id:d.id};a(this.contextForPreview).extend({assignable:e,general:e,entity:e})},"bus attachmentSelected":function(a){var b=a.data.attachment;b.mimeType=b.mimeType||"";if(b.mimeType.indexOf("image/")==0){var c={components:[{type:"attachmentsPreview",selected:{id:b.id}}],context:this.contextForPreview};this.createComponents(c,function(a){var b=a[0],c=b.component;c.on("afterRender",function(a){a.removeListener(),a.data.element.appendTo($("body"))}),c.fire("initialize")})}else window.location.assign(b.uri)}});return c}),define("tau/components/extensions/attachments/component.attachments.thumbProxy",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(a){var c=a.data.element.find(".ui-attach .preview img");c.each(function(){var a=b(this);if(!a.prop("complete")){var c=a.parent();c.addClass("loading"),a.load(function(){c.removeClass("loading")})}})}})}),define("libs/jquery/jquery.ui.confirmation",["libs/jquery/jquery.ui"],function(a){return function(a,b){a.widget("ui."+b,{options:{message:"Question?",okLabel:"OK",cancelLabel:"Cancel"},_create:function(){if(a.type(this.options.message)!="string")throw new TypeError('Invalid confirmation message type. A "string" expected.');this.element.addClass(b+"Host"),this._$widget=this._bindBehaviour(this._createTemplate())},_createTemplate:function(){var c=a('<div class="'+b+'"/>'),d=a('<div class="inner"/>'),e=a("<p/>").text(this.options.message),f=a('<button type="button" class="ok button mr-5 danger">').text(this.options.okLabel),g=a('<button type="button" class="cancel button">').text(this.options.cancelLabel);return c.append(d.append(e,f,g))},_bindBehaviour:function(b){return b.click(a.proxy(function(b){b.stopPropagation(),b.preventDefault();var c=a(b.target);if(c.is(".ok"))return this._trigger("ok");if(c.is(".cancel"))return this._trigger("cancel")},this)),b},show:function(){this._$widget.appendTo(this.element),this._trigger("show")},hideConfirmationMessage:function(){this._$widget.find(".inner").hide()},hide:function(){this._$widget.detach(),this._trigger("hide")},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments),this._$widget.remove(),this.element.removeClass(b+"Host")}})}(a,"confirmation"),a}),define("tau/components/extensions/attachments/component.attachments.deletable",["Underscore","jQuery","tau/components/extensions/component.extension.base","libs/jquery/jquery.ui.confirmation"],function(a,b,c){return c.extend({"bus permissionsReady+afterRender":function(a){this.$element=a.afterRender.data.element;var b=a.permissionsReady.data;b.deletable&&this._createDeleteTriggers()},"bus attachmentUploaded":function(a){this._createDeleteTriggers()},"bus afterAttachmentRemove":function(a){var c=this,d=a.data.id,e=this.$element.find("#attach-"+d);this.bus.fire("deleteElement",{element:e,callback:function(){b(this).remove()}})},_getDeleteTriggerProto:function(){return this._deleteTriggerProto||(this._deleteTriggerProto=b('<button class="delete" type="button">delete</button>').click(b.proxy(this,"_onAttachmentDelete"))),this._deleteTriggerProto},_createDeleteTriggers:function(){var a=this;this.$element.find(".ui-attach:not(.deletable)").each(function(c,d){b(d).addClass("deletable").find(".toolbar").append(a._getDeleteTriggerProto().clone(!0))})},_onAttachmentDelete:function(a){var c=this._findUpConfirmationPlaceholder(b(a.target));c.data("confirmation")||this._createConfirmation(c),this._showConfirmation(c)},_findUpConfirmationPlaceholder:function(a){return a.closest(".ui-attach").children(".inner")},_findUpAttachElement:function(a){return a.closest(".ui-attach")},_createConfirmation:function(a){a.confirmation({message:"Delete attachment?",ok:b.proxy(this,"_deleteAttachment"),cancel:b.proxy(this,"_cancelAttachmentDelete")})},_showConfirmation:function(a){a.confirmation("show")},_hideConfirmation:function(a){a.confirmation("hide")},_deleteAttachment:function(a){var c=b(a.target);this._hideConfirmation(this._findUpConfirmationPlaceholder(c));var d=this._findUpAttachElement(c);this.bus.fire("markElementToBeDeleted",{element:d}),this.bus.fire("remove",{id:d.attr("id").replace(/[^\d]/g,""),typeName:"attachment"})},_cancelAttachmentDelete:function(a){this._hideConfirmation(this._findUpConfirmationPlaceholder(b(a.target)))}})}),define("tau/ui/templates/attachments/ui.template.attachments.attachment",["tau/core/tau","tau/core/templates-factory"],function(a,b){var c={name:"attachments-attachment",markup:a.concat('<div id="attach-${id}" class="ui-attach">','<div class="inner">','<a class="preview" href="${uri}">','<img src="${thumbnailUri}" />',"</a>",'<p class="name">${name}</p>','<p class="owner">by ${ownerName}</p>','<p class="date">on ${date}</p>','<p class="toolbar">','<a class="download" href="${uri}" target="_blank">download</a>',"</p>","</div>","</div>")};return b.register(c)}),define("tau/ui/templates/attachments/ui.template.attachments",["tau/core/templates-factory","tau/ui/templates/attachments/ui.template.attachments.attachment"],function(a){var b={name:"attachments",options:{contentSelector:".ui-attachments-content"},dependencies:["attachments-attachment"],markup:['<div class="box ui-attachments-control">','   <div class="ui-attachments-content">','       {{tmpl(items) "attachments-attachment"}}',"   </div>","</div>"].join("")};return a.register(b)}),define("tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview.attachmentThumbnail",["tau/core/templates-factory"],function(a){var b={name:"attachments-preview-attachment-thumbnail",markup:["<li>",'   <img class="ui-attach-thumbnail{{if selected}} selected{{/if}}" src="${thumbnailUri}"   />',"</li>"].join("")};return a.register(b)}),define("tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview",["tau/core/templates-factory","tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview.attachmentThumbnail"],function(a){var b={name:"attachments-preview",markup:['<div class="ui-attachments-preview-control">','<div class="toolbar">','<button class="close" type="button">X</button>','<button class="prev" type="button">&larr;</button>','<button class="next" type="button">&rarr;</button>',"</div>",'   <div class="swap-view">','    <div class="image-view">','       <div class="ui-attachment-wait"></div>','       <img class="ui-attachment-view-image" src="${selected.uri}">',"    </div>","   </div>",'   <ul class="thumbnail-nav">','       {{tmpl(items) "attachments-preview-attachment-thumbnail"}}',"   </ul>","</div>"].join(""),dependencies:["attachments-preview-attachment-thumbnail"]};return a.register(b)}),define("tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator","tau/extensions/extension.javascript"],function(a,b,c,d){return c.extend({"bus afterRender":function(a){var c=this;c.element=a.data.element,c.element.find(".thumbnail-nav").click(c._onAttachmentThumbnailsContainerClick.tauCreateDelegate(c)),c.element.find(".toolbar .prev, .toolbar .next").click(b.proxy(c,"_onAttachmentsNavigationClick")),c.element.click(b.proxy(c,"_onClose")),d.getKeyBoardManager().pushHandler({handleKeyDown:function(){c._onKeyDown.apply(c,arguments)}})},"bus destroy":function(){this.destroy()},"bus changeSelected":function(a){var b=a.data.attachment;this._changeSelectedAttachment(b)},_getSelectedAttachmentSelector:function(){return".thumbnail-nav > li > img.selected"},_getAttachmentsCount:function(){return this.element.find(".thumbnail-nav > li").length},_getCurrentSelectedAttachment:function(){return this.element.find(this._getSelectedAttachmentSelector()).parent().data().tmplItem.data},_getAttachmentData:function(a){return this.element.find(".thumbnail-nav > li").eq(a).data().tmplItem.data},_getCurrentSelectedAttachmentIndex:function(){return this.element.find(this._getSelectedAttachmentSelector()).parent().index()},_changeSelectedAttachment:function(a){if(this._getCurrentSelectedAttachment().id==a.id)return;var c=this.element;c.find(".thumbnail-nav > li > img.selected").removeClass("selected");var d=c.find(".thumbnail-nav > li > img"),e=this;d.each(function(){if(b(this).parent("li").data().tmplItem.data.id==a.id){b(this).addClass("selected");var d=c.find(".ui-attachment-view-image");return e.bus.fire("beforeChangeImage",a.uri)&&(d.attr("src",a.uri),e.bus.fire("afterChangeImage")),!1}})},_onKeyDown:function(a){a.keyCode==b.ui.keyCode.ESCAPE&&this._close()},_close:function(){this.element.remove(),this.bus.fire("closed"),this.fire("destroy")},_next:function(){var a=this._getCurrentSelectedAttachmentIndex()+1;a>=this._getAttachmentsCount()&&(a=0),this._setSelectedAttachmentIndex(a)},_prev:function(){var a=this._getCurrentSelectedAttachmentIndex()-1;a<0&&(a=this._getAttachmentsCount()-1),this._setSelectedAttachmentIndex(a)},_setSelectedAttachmentIndex:function(a){this._changeSelectedAttachment(this._getAttachmentData(a))},_closeButtonClick:function(a){a.stopPropagation(),this._close()},_onAttachmentsNavigationClick:function(a){a.stopPropagation();var c=b(a.target);c.hasClass("prev")?this._prev():c.hasClass("next")&&this._next()},_onAttachmentThumbnailsContainerClick:function(a){a.stopPropagation();var c=b(a.target);if(c.is(".ui-attach-thumbnail")){var d=c.parent("li").data(),e=d.tmplItem.data;this._changeSelectedAttachment(e)}},_onClose:function(a){/^img$/i.test(a.target.tagName)||this._close()},destroy:function(){d.getKeyBoardManager().popHandler(),this.element.find(".ui-attachments-control > .display-table").unbind("click")}})}),define("tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview.animations",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(a){var c=this;c.element=a.data.element,b(window).bind("resize",function(){c._resizeImage()});var d=c.element.find(".ui-attachment-wait"),e=c.element.find(".ui-attachment-view-image");e.hide(),d.show(),this.element.find(".ui-attachment-view-image").bind("load",function(){c._onImageLoad()});var f=function(){b(this).parent().removeClass("ui-thumbnail-loading"),b(this).unbind("load",f),b(this).fadeIn("slow")};this.element.find(".thumbnail-nav li").addClass("ui-thumbnail-loading"),this.element.find(".thumbnail-nav li > img").each(function(){this.complete?f.call(this):b(this).bind("load",f).hide()})},_onImageLoad:function(){var a=this,b=a.element.find(".ui-attachment-wait"),c=a.element.find(".ui-attachment-view-image");a._resizeImage(),c.fadeIn("slow",function(){b.hide()})},_resizeImage:function(){var a=this,b=a.element;if(!b)return;var c=a.element.find(".ui-attachment-wait"),d=a.element.find(".ui-attachment-view-image"),e=b.find(".image-view");d.width(""),d.height("");var f=e.width(),g=e.height(),h=d.width(),i=d.height();if(h>f||i>g){var j=g/i*h,k=f/h*i;j<f?(d.width(j),d.height(g)):(d.width(f),d.height(k))}return{$wait:c,$image:d}},"bus beforeChangeImage":function(a){var b=this,c=b.element.find(".ui-attachment-wait"),d=b.element.find(".ui-attachment-view-image");c.show();var e=a.data;d.fadeOut("slow",function(){d.attr("src",e)}),a.data=!1}})}),define("tau/models/model.label",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){var a={text:this.config.text};this.config.cssClass&&(a.cssClass=this.config.cssClass),this.bus.fire("dataBind",a);var b=this.config.getBadgeText;typeof b=="function"&&(this.fire("beforeGetBadgeText",{prevValue:this.badgeText}),b.call(this,{callback:this.onBadgeTextRetrieved,scope:this}))},onBadgeTextRetrieved:function(a){var b=a[this.config.badgeFieldName];this.badgeText=b,this.bus?this.bus.fire("setBadgeText",{text:b}):this.fire("badgeTextChanged",{text:b})}});return b}),define("tau/ui/templates/auditHistory/ui.template.auditHistory",["tau/core/templates-factory"],function(a){var b={name:"audit-history",markup:['<div class="tau-audit-history-placeholder"><span class="ui-empty-data-msg">loading history...</span></div>'],dependencies:[]};return a.register(b)}),define("tau/ui/extensions/auditHistory/ui.audit.history",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c,d){return c.extend({getColumns:function(){return[{Id:"RowID",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Entity",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"ID",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Modification",Title:null,Type:"int",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"ProjectID",Title:null,Type:"int",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"InnerEntity",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Date",Title:"Date Time",Type:"date",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Description",Title:"Action",Type:"HTMLText",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:300,Facet:{}},{Id:"Modifier",Title:"Modified By",Type:"HTMLText",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}}]},getDataRequest:function(){var a=this.config.context.entity;return{GridID:null,GroupBy:null,OrderBy:"Date",OrderDir:!1,Start:0,Limit:10,Cnt:{ID:a.id,Type:a.entityType.name}}},"bus extJsHistoryPanel":function(a){var b=a.data.panel;this.config.store.on({type:"general",eventName:"afterSave",listener:this},function(a){b.getStore().reload()})},"bus extJsHistoryPanel+destroy":function(a){var b=a.extJsHistoryPanel.data.panel;b.destroy()},"bus initialize":function(){var a=this,b=d.getApplicationPath()+"/PageServices/AuditHistoryListService.asmx/js?d=1";require([b],function(){a.fire("serviceLoaded")})},"bus afterRender+serviceLoaded":function(a){var c=a.afterRender.data.element,d=c[0],e=this;e.config.store.unbind(this),gridPanelType="Ext.grid.GridPanel",configurationFactory="Tp.controls.grid.AuditHistoryConfigurationFactory",editorFieldFactory="Tp.controls.grid.AuditHistoryFieldFactory",gridProxy="Ext.Tp.GridServiceProxy({ webServiceProxy: Tp.Web.Extensions.ExtJs.AuditHistoryListService, webServiceProxyMethod: Tp.Web.Extensions.ExtJs.AuditHistoryListService.GetData })";var f={id:"super_grid",canEdit:!1,canDelete:!1,isOwner:!1,gridHeader:{Title:"History",Columns:e.getColumns()},gridDataRequest:e.getDataRequest(),pluginTypes:"Tp.controls.grid.plugins.HidePagingConstraint",innerGridConfig:[]};Ext.onReady(function(){var a=b('<div class="ext-holder"/>').hide().appendTo("body"),d=Tp.controls.grid.Factory.getInstance();f=d.getConfigurationFactory(f).createConfig(),f.applyTo=a[0];var g=new Ext.grid.GridPanel(f);a.appendTo(c).show(),e.fire("extJsHistoryPanel",{panel:g}),b(".ui-empty-data-msg",c).hide()})}})}),define("tau/models/model.breadcrumbs",["Underscore","tau/core/model-base","tau/core/event","tau/configurator"],function(a,b,c,d){var e=b.extend({"bus currentFound":function(a){this._dataHandler(a.data)},"bus currentUpdated":function(a){d.getHistory().updateCurrent(a.data),this.bus.getGlobalBus().fire("history.setCurrent",a.data)},_dataHandler:function(b){var c=this;if(b){d.getHistory().setCurrent(b),this.bus.getGlobalBus().fire("history.setCurrent",b);var e=d.getHistory().stack,f=a.detect(e,function(a){return a.id===b.id});if(f){var g=a.indexOf(e,f);d.getHistory().stack=e.slice(0,g)}}this.bus.fire("stackFound",{})},"bus beforeInit+stackFound":function(){var b=a.clone(d.getHistory().stack);b=b.slice(-3),this.fire("dataBind",{items:b});var c=this}});return e}),define("tau/models/model.breadcrumbs.entity",["Underscore","tau/core/model-base","tau/configurator","tau/core/termProcessor"],function(a,b,c,d){var e=function(a,b){this.model=a,this.appContext=b;var c=b.processes[0].terms;this.termProcessor=new d(c)};e.prototype={convertToItem:function(b){var d=a.bind(function(a){var b=a,c=this.termProcessor.getTerms(b.__type).name,d=c+" #"+b.id+" "+b.name;return d},this),e=c.getRouting().getUrl().source;return{id:b.id,url:e.length&&e.match(/\//)?e:"#"+b.__type.toLowerCase()+"/"+b.id,title:d(b)}},onGetEntity:function(a){this.entity=a.data},done:function(){this.model.fire("currentFound",this.convertToItem(this.entity))}};var f=b.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id,f=b.applicationContext.processes[0],g=new e(a,b.applicationContext),h=function(b){b.data.changes.hasOwnProperty("name")&&a.store.get(c,{id:d,fields:["id","name"]},{success:function(b){a.bus.fire("currentUpdated",g.convertToItem(b.data))}}).done()};a.store.on({eventName:"afterSave",type:c,listener:this},h),a.store.get(c,{id:d,fields:["id","name"]},{scope:g,success:g.onGetEntity}).done({scope:g,success:g.done})}});return f}),define("tau/components/extensions/breadcrumbs/extension.breadcrumbs.items",["tau/components/extensions/component.extension.base","tau/core/event","tau/core/types","tau/configurator"],function(a,b,c,d){return a.extend({init:function(a){this._super(a);var b=this;this.historyListener||(this.historyListener=function(){b.bus.fire("refresh")},this.bus.getGlobalBus().on("history.changed",this.historyListener,this))},destroy:function(a){this.historyListener&&this.bus.getGlobalBus().removeListener("history.changed",this.historyListener,this),this._super()}})}),define("tau/ui/templates/breadcrumbs/ui.template.breadcrumbs.item",["tau/core/templates-factory"],function(a){var b={name:"breadcrumbs-item",markup:['   <li class="ui-breadcrumbs__item"><a href="${url}">${title}</a></li>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/breadcrumbs/ui.template.breadcrumbs",["tau/core/templates-factory","tau/ui/templates/breadcrumbs/ui.template.breadcrumbs.item"],function(a){var b={name:"breadcrumbs",markup:["{{if items.length}}",'   <ul class="ui-breadcrumbs">','       {{tmpl(items) "breadcrumbs-item"}}',"   </ul>","{{/if}}"],dependencies:["breadcrumbs-item"]};return a.register(b)}),define("tau/views/view.collapsible",["tau/views/view.container"],function(a){var b=a.extend({"bus beforeInit":function(a){var b=a.data.config,c=b.collapsed,d=this.bus.name||"unknown";b.children=[{id:"header",type:"collapsibleHeader",name:d+" header",collapsed:c,children:b.header||[]},{id:"inners",type:"container",name:d+" inner",visible:!c,children:b.items||[]}]},"bus childrenRendered":function(a){var b=a.data.children,c=b[0],d=b[1];c.on("expanded",function(a){d.fire("show")}),c.on("collapsed",function(a){d.fire("hide")})}});return b}),define("tau/ui/extensions/collapsible/ui.extension.collapsible",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender":function(a){this.element=a.data.element,a.data.data.collapsed&&this._collapse()},"bus expand":function(){this._expand()},"bus collapse":function(){this._collapse()},_collapse:function(){this.element.addClass("closed")},_expand:function(){this.element.removeClass("closed")}})}),define("tau/components/component.collapsible",["Underscore","tau/configurator","tau/core/component-base","tau/views/view.collapsible","tau/components/extensions/component.creator.extension","tau/ui/extensions/collapsible/ui.extension.collapsible","tau/ui/extensions/layout/ui.extension.layout","tau/ui/templates/container/ui.template.container.list"],function(a,b,c,d,e,f,g,h){return{create:function(i){i=i||{},a.defaults(i,{store:b.getStore(),template:h,cssClass:"ui-collapsible",layout:"list",collapsed:!0});var j=new c(i);return a.isArray(i.extensions)&&a.each(i.extensions,function(a){j.attach(a)}),j.attach(e).attach(f).attach(g).attach(d).bus}}}),define("tau/ui/extensions/collapsibleHeader/ui.extension.collapsibleHeader",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(a,b,c){return c.extend({"bus afterRender":function(a){var c=this;c.element=a.data.element;var d=a.data.data,e=d.collapsed;c.collapsed=e;var f=e?"collapsed":"expanded";c.element.addClass(f),c.element.bind("click",b.proxy(c._onClickHandler,c))},_onClickHandler:function(){var a=this;a.collapsed=!a.collapsed;var b=a.collapsed,c=b?"expanded":"collapsed",d=b?"collapsed":"expanded",e=a.element;e.removeClass(c),e.addClass(d),this.fire(d)}})}),define("tau/ui/templates/collapsibleHeader/ui.template.collapsibleHeader",["tau/core/templates-factory"],function(a){var b={name:"collapsibleHeader",markup:['<div class="ui-collapsible-header">','    <div class="ui-children-container"></div>',"</div>"]};return a.register(b)}),define("tau/components/component.collapsibleHeader",["Underscore","tau/core/component-base","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/collapsibleHeader/ui.extension.collapsibleHeader","tau/ui/templates/collapsibleHeader/ui.template.collapsibleHeader"],function(a,b,c,d,e,f,g){return{create:function(h){return h=h||{},a.defaults(h,{template:g,cssClass:"ui-collapsible-header",childrenContainerSelector:".ui-children-container"}),(new b(h)).attach(d).attach(e).attach(f).attach(c).bus}}}),define("tau/ui/behaviour/common/ui.behaviour.richeditor",["Underscore","jQuery","tau/configurator"],function(a,b,c){b.widget("ui.richeditor",{staticExecutionGroups:{},$target:null,$editor:null,$input:null,ckeInstance:null,ckeConfig:{enterMode:3,language:"en",toolbar:[],toolbarStartupExpanded:!1,disableNativeSpellChecker:!1,scayt_autoStartup:!1,removePlugins:"elementspath",resize_enabled:!1,height:150,width:"auto",skin:"v3",resize_dir:"vertical",startupFocus:!0,autoGrow_maxHeight:8e3,extraPlugins:"autogrow"},options:{validation:{},executionGroupName:null,hideTarget:!0,scrollToButtonBar:!1,placeholder:{className:null,text:null},settings:{},saveAction:{disableIfEmpty:!1,available:!0,text:"Save"},cancelAction:{available:!0,text:"Cancel"},onSave:function(a){},onCancel:function(){}},_create:function(){this.init()},getTemplate:function(){var a=['<div class="ui-richeditor">','   <textarea class="ui-richeditor__area" style="height:'+this.options.settings.height+'px;"></textarea>','   <div class="ui-richeditor__controls button-group">'],b=this.options.saveAction;b.available&&(a=a.concat(['<button class="ui-richeditor__controls__save button" type="button">',b.text,"</button>"]));var c=this.options.cancelAction;return c.available&&(a=a.concat(['<button class="ui-richeditor__controls__cancel button" type="button">',c.text,"</button>"])),a=a.concat(["   </div>","</div>"]),a.join("")},setText:function(a){this.$target.html(a)},setValidationErrors:function(b){this.element.addClass("ui-validationerror"),a.isString(b)&&this.element.attr("title",b)},resetValidationErrors:function(a){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title")},setValue:function(a){this.setText(a)},init:function(){this.$target=b(this.element),this.$target.addClass("editable");var a={};b.extend(!0,a,this.ckeConfig,this.options.settings),a.autoGrow_minHeight=Math.max(this.$target.height(),a.height),this.options.settings=a,this.bindEventsTarget(this.$target),this._applyPlaceholder(this.$target,this.options.placeholder)},_applyPlaceholder:function(a,c){c.className&&b.trim(a.html())===""&&(a.addClass(c.className),a.text(c.text))},_removePlaceholder:function(a,b){b.className&&a.hasClass(b.className)&&(a.removeClass(b.className),a.text(""))},bindEventsTarget:function(a){var c=function(a,b){return function(a,b){var c=null,d=null;a.bind("mousedown",function(a){a.which!=3&&(c=a.pageX,d=a.pageY)}),a.bind("mouseup",function(a){if(a.which!=3){var e=5;c>a.pageX-e&&c<a.pageX+e&&d>a.pageY-e&&d<a.pageY+e&&b.call(this,a),c=null,d=null}})}.call(this,a,b)},d=b.proxy(this.showEditor,this),e=function(a,b){a.bind("dblclick",b)},f=function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var a=window.getSelection();a.removeAllRanges()}};e(a,function(a){f();if(a.target.tagName.toLowerCase()=="a")return;d()})},_dataChangeEventHandler:function(a){var b=this;if(!b._visible)return;var c=b.$editor.find(".ui-richeditor__controls__save");window.setTimeout(function(){var b=a.sender.getData(),d=b.length>0;c.attr("disabled",d?!1:"disabled"),d?c.removeClass("disable"):c.addClass("disable")},150)},__displayEditor:function(){var a=this;a.options.hideTarget&&a.$target.hide(),a.$editor.show();if(a.options.scrollToButtonBar){var c=a.element.parent().find(".ui-richeditor__controls"),d=b(".ui-popup-content.tau-container");d.size()==0&&(d=b(window)),d.scrollTop(c.offset().top)}},getSettings:function(){return this.options.settings},setSettings:function(a){this.options.settings=a},_applyEditor:function(){var a=this;a.$input.parents("body").length?this.ckeInstance?(a.__displayEditor(),this.ckeInstance.setMode("wysiwyg"),this.ckeInstance.setData(this.$input.val())):(a._trigger("beforeapply",this.options.settings),this.initCKEditor(this.$input,this.options.settings,function(c,d){a.__displayEditor(),a.ckeInstance=d;var e=a.options.saveAction;if(e.available&&e.disableIfEmpty){var f=["contentDom","afterCommandExec","key","insertElement","taukeypress"],g=b.proxy(a._dataChangeEventHandler,a);for(var h=0,i=f.length;h<i;h++)d.on(f[h],g)}})):(a.$editor.show(),window.setTimeout(function(){a._applyEditor()},0))},showEditor:function(){if(!this._visible){this._visible=!0,this._removePlaceholder(this.$target,this.options.placeholder),this._initText||(this._initText=this.options.hasOwnProperty("text")?this.options.text:this.$target.html()),this.$editor?this.$editor.hide():(this.$editor=this.createEditor(),this.$editor.hide(),this.$editor.insertAfter(this.$target));var a=this.options.executionGroupName;return a&&(this.staticExecutionGroups[a]&&this.staticExecutionGroups[a]._innerCancel(),this.staticExecutionGroups[a]=this),this.$input.val(this._initText),this._applyEditor(),this.$editor}},hideEditor:function(){var a=this.$target,b=this.$input,c=this.$editor;b.blur(),c.hide(),this.options.hideTarget&&a.show();var d=this;d._applyPlaceholder(d.$target,d.options.placeholder),this._visible=!1},initCKEditor:function(a,b,d){var e=c.getCkPath(),f=this;require(["Underscore","order!"+e+"ckeditor.js",,"order!"+e+"ckfinder/ckfinder.js",,"order!"+e+"../Javascript/EditView/ui.comments.js"],function(c){CKEDITOR.tools.indexOf=c.indexOf,CKEDITOR.replace(a.attr("id"),b);var g=CKEDITOR.instances[a.attr("id")];CKFinder.SetupCKEditor(g,e+"ckfinder/");var h=function(){f.$editor.find(".ui-richeditor__controls__save").attr("disabled","disabled").addClass("disable")},i=function(){f.$editor.find(".ui-richeditor__controls__save").removeAttr("disabled").removeClass("disable")};g.on("charcount_limit_reached",h),g.on("charcount_limit_restored",i),d(a,g)})},createEditor:function(){var c=b(this.getTemplate()),d=this.$input=c.find("textarea");return d.attr("id",a.uniqueId("ui-richeditor__area")),this.bindEventsEditor(c),c},bindEventsEditor:function(a){var c=this.options,d=a.find(".ui-richeditor__controls__save"),e=a.find(".ui-richeditor__controls__cancel");c.saveAction.available&&d.click(b.proxy(this._save,this)),c.cancelAction.available&&e.click(b.proxy(this._cancel,this))},_isChangedText:function(a){return a!=this._initText},_save:function(a){a.preventDefault();var b=this.$input;this.ckeInstance&&this.ckeInstance.updateElement();var c=b.val();this._isChangedText(c)?(this._initText=c,this.setText(c),this.options.onSave(c)):this._innerCancel(),this.hideEditor()},_cancel:function(a){a.preventDefault(),this._innerCancel()},_innerCancel:function(){this.hideEditor(),this.options.onCancel()},destroy:function(){var a=this.options.executionGroupName;a&&this.staticExecutionGroups[a]===this&&(this.staticExecutionGroups[a]=null),this.ckeInstance&&(this.ckeInstance.focusManager.forceBlur(),this.ckeInstance.destroy()),this.$editor&&this.$editor.remove()}})}),define("tau/utils/utils.htmlConverter",["tau/configurator"],function(a){return{fromSourceToHtml:function(b){var c=a.getApplicationPath()+"/",d=b||"",e=/(?:<img(?=\s)(?:[^>"']|"[^"]*"|'[^']*')*?\s)src\s*=\s*("~\/([^"]*)"|'~\/([^']*)')(?:[^>]*>)/gi;return d=d.replace(e,function(a,b,d,e){var f=d||e,g=b[0];return a.replace(b,function(){return g+c+f+g})}),d},fromHtmlToSource:function(b){var c=a.getApplicationPath(),d=b||"",e='(?:<img(?=\\s)(?:[^>"\']|"[^"]*"|\'[^\']*\')*?\\s)src\\s*=\\s*("'+c+'/([^"]*)"|\''+c+"/([^']*)')(?:[^>]*>)",f=new RegExp(e,"gi");return d=d.replace(f,function(a,b,c,d){var e=c||d,f=b[0];return a.replace(b,function(){return f+"~/"+e+f})}),d}}}),define("tau/models/dataprocessor/model.processor.comment",["tau/configurator","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(a,b,c){function d(a){this.context=a}return d.prototype={destroy:function(){this.context=null},convertDTO:function(c){var d=this,e={id:c.id,parentId:c.parentId,avatar:[a.getApplicationPath(),"/Avatar.ashx?UserId=",c.owner.id,"&size=32"].join(""),name:d.getName(c.owner),description:b.fromSourceToHtml(c.description),age:this.getAge(c.createDate),comments:[],deleted:"DELETED"===c.description,isRequester:c.owner.kind&&c.owner.kind.toString().toLowerCase()==="requester"};return this.context.applicationContext.loggedUser.id==c.owner.id&&(e.isOwnerComment=!0),e},getName:function(a){var b=a.firstName||"",c=a.lastName||"",d="";if(b.length>0||c.length>0)d=[b," ",c.trim().substring(0,1),"."].join("");return d},getAge:function(a){if(!a)return"Draft";var b=c.getAge(c.parse(a));return b.isZero?"Just added":b.toString()}},d}),define("tau/models/model.comment.editable",["Underscore","tau/core/model.editable.base","tau/configurator","tau/models/dataprocessor/model.processor.comment"],function(a,b,c,d){var e=b.extend({name:"Editable Comments","bus applyTo":function(a){var b=this.bindedData=a.data.data;this.authorizate(b)},authorizate:function(a){var b=this.bindedData.deleted,c={editable:!b,deletable:!0};this.fire("permissionsReady",c)},_convertDTO:function(b){var c=this.config,e=c.parentCommentId,f=new d(c.context),g=f.convertDTO(a.extend({},b));return g.parentId=e,g},"bus afterInit":function(a){var b=this;this.config=a.data.config;var c={id:null,description:"",owner:b.config.context.applicationContext.loggedUser},d=b._convertDTO(c);b.bindedData=d,b.fire("dataBind",d)},_fireUpdate:function(a,b){var c=this;b.general={id:c.config.context.entity.id},c.fire("save",{id:a,typeName:"comment",$set:b,$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName","kind"]}]})},"bus saveComment":function(a){var b=this,c=a.data,d=this.bindedData.id;b._fireUpdate(d,c)},"bus replyToComment":function(a){var b=this,c=a.data;b._fireUpdate(null,c)},"bus deleteComment":function(){var a=this.bindedData,b=a.id;a.comments&&a.comments.length>0?this._fireUpdate(b,{description:"DELETED"}):this.fire("remove",{id:b,typeName:"comment"})}});return e}),define("tau/ui/extensions/comments/ui.extension.comment.practices.notification",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c,d){var e=d.extend({category:"edit",beforeSaveComment:function(a){var c=this.placeHolder.find('input[type="checkbox"]'),d={};c.each(function(a,c){var e=b(c);e.attr("checked")&&(d[e.val()]=!0)}),this.guid=+(new Date),a.cmd["comment-practices-notification-guid"]=this.guid,a.cmd["comment-practices-notification-opts"]=d},afterSaveComment:function(b){if(b.cmd["comment-practices-notification-guid"]===this.guid){var d=b.cmd["comment-practices-notification-opts"];if(a(d).keys().length){var e=c.getNotificationService();e.notifyComment(b.obj.id,d)}}},"bus editorSave":function(){if(!this.globalSettings.IsEmailNotificationsEnabled)return;var a=this;a.config.store.on({eventName:"beforeSave",type:"comment",listener:a},function(b){var c=b.data;a.beforeSaveComment(c)}),a.config.store.on({eventName:"afterSave",type:"comment",listener:a},function(b){var c=b.data;a.afterSaveComment(c),a.config.store.unbind(a)})},"bus editorCreated":function(a){this.globalSettings=this.config.context.applicationContext.globalSettings||{};if(!this.globalSettings.IsEmailNotificationsEnabled)return;var c=a.data.editorElement;this.placeHolder=c.find(".tau-notification-practices-settings");if(!this.placeHolder.length){var d=this.placeHolder=b('<div class="tau-notification-practices-settings"><span class="prompt">Notify by email: </span></div>');d.append("<input type='checkbox' id='owner' value='Owner' /><label for='owner'>Owner</label>"),d.append("<input type='checkbox' id='people' value='Assigned' /><label for='people'>Assigned people</label>"),this.config.context.general.entityType.name.toLowerCase()==="request"?d.append("<input type='checkbox' id='requestor' value='Requesters' /><label for='requestor'>Requester(s)</label>"):d.append("<input type='checkbox' id='team' value='Team' /><label for='team'>Project Team</label>"),d.insertBefore(c.find(".ui-richeditor__controls"))}},"bus destroy":function(){this.config.store.unbind(this),this._super.apply(this,arguments)}});return e}),define("tau/ui/templates/comments/ui.template.comments.comment",["tau/core/templates-factory"],function(a){var b={name:"comments-comment",markup:['<div class="ui-comment comment-id-${id}">','   <div class="ui-comment-body{{if isOwnerComment }} ui-commets-comment-owner{{/if}}{{if isRequester }} tau-comments-requester{{/if}}" >',"      {{if deleted}}","      DELETED","      {{else}}",'      <div class="ui-comment-heading">','         <li class="ui-comment-avatar" style=\'background-image:url("${avatar}")\'></li>','         <li class="ui-comment-name">${name}</li>','         <li class="ui-comment-ago">(${age})</li>',"      </div>",'      <div class="ui-comment-text">{{html description}}</div>',"      {{/if}}","   </div>",'   <div class="ui-comments">',"       {{if comments }}",'           {{tmpl(comments) "comments-comment"}}',"       {{/if}}","   </div>","</div>"].join("")};return a.register(b)}),define("tau/ui/extensions/comments/ui.extension.comment.editable",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base","tau/ui/templates/comments/ui.template.comments.comment","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(a,b,c,d,e){var f=d.extend({category:"edit",destroy:function(){this.destroyDynamicComponents(),this._super()},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){var a=this;a.componentList&&(a.componentList.destroy(),delete a.componentList)},"bus applyTo+permissionsReady":function(a){var b=a.applyTo.data,c=a.permissionsReady.data;this.applyPermissions(b.config,b.data,b.element,c)},applyPermissions:function(c,d,e,f){var g=this,h=this.config=a.extend({},c,{comment:d}),i=this.element=e,j=b('<li class="ui-comment-menu button-group"></li>'),k=i.children(".ui-comment-body");if(f.editable){k.addClass("editable");var l=g.onReply.tauCreateDelegate(g);j.append(b('<a class="reply button small"><span class="icon"></span>reply</a>').click(l));var m=g.onEdit.tauCreateDelegate(g);j.append(b('<a class="edit button small"><span class="icon"></span>edit</a>').click(m)),b(['<div class="ui-comment-reply">','   <div class="ui-editor-placeholder" style="display: none;"></div>',"</div>"].join("")).insertAfter(k.find(".ui-comment-text"))}if(f.deletable){var n=g.onDelete.tauCreateDelegate(g);j.append(b('<a class="delete button danger small"><span class="icon"></span>delete</a>').click(n)),k.addClass("deletable")}k.find(".ui-comment-heading").append(j);var o=i.children(".ui-comments"),p={components:[{type:"commentList"}],context:h.context};this.componentList||this.createComponents(p,function(b){var c=b[0],e={element:o,data:{comments:d.comments||[]},config:a.extend({},c.config,{commentId:g.config.comment.id})};g.componentList=c.component,c.component.fire("applyTo",e)})},showEditorForEdit:function(){var a=this,b=this.element.find("> .ui-comment-body > .ui-comment-text"),c=this.element.tmplItem().data;this.showEditor({element:b,text:c.description,saveHandler:function(b){a.fire("saveComment",{description:b})}})},showEditorForReply:function(){var a=this,b=this.element.find("> .ui-comment-body > .ui-comment-reply > .ui-editor-placeholder"),c=this.element.tmplItem().data;a.showEditor({element:b,text:"",hideTarget:!1,saveText:"Add Reply",saveHandler:function(b){a.fire("replyToComment",{description:b,parentId:c.id})}})},showEditor:function(a){var b=this,c=function(){b.fire("editorSave"),a.saveHandler.apply(this,arguments)},d=a.element,e=d.richeditor({text:a.text,hideTarget:a.hideTarget!==!1,executionGroupName:"comments",onSave:c,validation:{trim:!0},settings:{toolbar:[["Bold","Italic","Strike"],["NumberedList","BulletedList"],["Link","Unlink"],["Image"],["Source"]],startupFocus:!0,extraPlugins:""},saveAction:{text:a.saveText||"Save",disableIfEmpty:!0},cancelAction:{available:!0}}),f=e.richeditor("showEditor");this.fire("editorCreated",{editorElement:f})},onReply:function(a){var b=this;a.stopPropagation(),a.preventDefault(),b.showEditorForReply()},onEdit:function(a){var b=this;a.stopPropagation(),a.preventDefault(),b.showEditorForEdit()},onDelete:function(a){a.stopPropagation(),a.preventDefault(),this.fire("deleteComment")}});return f}),define("tau/ui/extensions/comments/ui.extension.comments.new.editor",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(a,b,c){var d=c.extend({category:"edit",destroy:function(){this.$ckEditor.richeditor("destroy"),this._super()},"bus afterRender":function(a){this.element=a.data.element,this.initializeEditor()},onSave:function(a){var b=this;b.fire("editorSave"),b.fire("saveComment",{description:a}),b.closeEditor()},onCancel:function(a){this.closeEditor()},closeEditor:function(){this.fire("destroy")},initializeEditor:function(){var a=this;this.$editorPlaceHolder=this.element.find(".ui-comment-text"),this.$ckEditor=this.$editorPlaceHolder.richeditor({executionGroupName:"comments",onSave:b.proxy(a.onSave,a),onCancel:b.proxy(a.onCancel,a),validation:{trim:!0},scrollToButtonBar:!0,settings:{toolbar:[["Bold","Italic","Strike"],["NumberedList","BulletedList"],["Link","Unlink"],["Image"],["Source"]],startupFocus:!0,extraPlugins:""},saveAction:{text:"Add comment",disableIfEmpty:!0},cancelAction:{available:!0}});var c=this.$ckEditor.richeditor("showEditor");this.fire("editorCreated",{editorElement:c})}});return d}),define("tau/ui/templates/comments/ui.template.comments.comment.new.editor",["tau/core/templates-factory"],function(a){var b={name:"comments-comment-new-editor",markup:['<div class="ui-comment-new">','    <div class="ui-comment-heading">',"        <div class=\"ui-comment-avatar\" style='background:url(${avatar}) top left no-repeat;width:32px; height:32px;'></div>","    </div>",'    <div class="ui-comment-editor-placeholder">','        <div class="ui-comment-text"></div>',"    </div>","</div>"].join("")};return a.register(b)}),define("tau/ui/extensions/comments/ui.extension.commentList.editable",["tau/configurator","tau/components/extensions/component.extension.base","tau/ui/templates/comments/ui.template.comments.comment"],function(a,b,c){var d=b.extend({destroy:function(){this.destroyDynamicComponents(),this._super()},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){var a=this;if(a.dynamicComponents&&a.dynamicComponents.length){var b=null;while(b=a.dynamicComponents.pop())b.destroy()}},"bus applyTo":function(a){var b=this;b.dynamicComponents=[];var c=a.data,d=c.data.comments;this.element=c.element;var e=c.element.children(".ui-comment");this.config=c.config;var f=c.config.context,g={components:[],context:f};e.each(function(a){g.components.push({type:"comment"})}),b.createComponents(g,function(a){for(var c=0,f=a.length;c<f;c++){var g=a[c],h={element:e.eq(c),data:d[c],config:g.config};g.component.fire("applyTo",h),b.dynamicComponents.push(g.component)}})}});return d}),define("tau/models/model.comments",["Underscore","tau/core/model-base","tau/models/dataprocessor/model.processor.comment","tau/utils/utils.date","tau/core/types.targetprocess"],function(a,b,c,d){function e(a,b){this.model=a,this.converter=b}e.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(b){this.assignable=this.model.assignable=b.data;var c=b.data.comments,e=a(c).sortBy(function(a){return+d.parse(a.createDate)}),f=this.convertDTO(e).convertToTree(null);this.model.bus.fire("dataBind",{items:f})},convertDTO:function(b){var c=this;return this.convertedComments=a(b).map(function(a){return c.converter.convertDTO(a)}),this},convertToTree:function(a){var b=[],c=this.convertedComments;for(var d=0,e=c.length;d<e;d++){var f=c[d];f.parentId==a&&(b.push(f),f.comments=this.convertToTree(f.id))}return b}};var f=b.extend({name:"Comments",onInit:function(){var a=this.config.context.entity;this.converter=new c(this.config.context);var b=new e(this,this.converter);this.store.get(a.entityType.name,{id:a.id,fields:["id",{comments:["id","description","createDate","parentId",{owner:["id","firstName","lastName","kind"]}],list:!0}]},b.getAssignableRetrievedCallback()).done()},"bus createDTO":function(a){var b=a.data,c=this.converter.convertDTO(b);c.comments=[],this.fire("DTOCreated",c)},destroy:function(){this.converter.destroy(),this.converter=null,this._super()}});return f}),define("tau/models/model.comments.editable",["Underscore","tau/core/model.editable.base"],function(a,b){var c=b.extend({name:"Editable Comments",_signUpEventsIfRequired:function(){var a=this;if(a._signedUp)return;a._signedUp=!0;var b=function(b){b.data.cmd.guid=+(new Date),a.fire("prepareUpdate",b.data)},c=function(b){a.fire("applyUpdate",b.data)},d=function(b){b.data.cmd.guid=+(new Date),a.fire("prepareRemove",b.data)},e=function(b){var c=b.data.obj.parentId,d=a.getComment(c);d&&d.deleted&&d.comments.length===1?a.store.remove("comment",{id:c}).done():a.fire("applyRemove",b.data)};a.store.unbind(a),a.store.on({eventName:"beforeSave",type:"comment",listener:a},b).on({eventName:"afterSave",type:"comment",listener:a},c).on({eventName:"beforeRemove",type:"comment",listener:a},d).on({eventName:"afterRemove",type:"comment",listener:a},e)},"bus dataBind":function(b){var c=b.data.items;this.commentsList=this.getPlainList(c);var d=a(this.commentsList).pluck("id"),e={editable:!0,editableItems:d,deletable:!0,deletableItems:d},f=this;f._signUpEventsIfRequired(),f.fire("permissionsReady",e)},getComment:function(b){var c=b?a(this.commentsList).detect(function(a){return a.id===b}):null;return c},getPlainList:function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.push(e);var f=arguments.callee.call(this,a[c].comments);b=b.concat(f)}return b}});return c}),define("tau/ui/extensions/ui.extension.shortcutProcessor",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(c){var d=c.data,e=this.$element=d.element,f=this.config.shortcutProcessorTarget,g=[],h=e.find(f);h.each(function(c,d){var e=b(d),f=e.html(),h=/\b(id):(\d+)\b/gi,i=f.match(h);if(i){var j=a(i).map(function(a){return a.split(":")[1]});g=g.concat(j);var k="<span class='tau-shortcut-loading' entity_ref='$2'>$1:$2</span>";f=f.replace(h,k),e.html(f)}}),g=a(g).uniq();var i=g.length;if(i){var j=this,k=this.config.store;for(var l=0;l<i;l++){var m=g[l],n={id:m,fields:["id","name",{entityType:["id","name"]}],silent:!0};k=k.get("general",n,{success:j.replaceShortcut,scope:j})}k.done()}},replaceShortcut:function(a){var c=a.data,d=b('<a href="#'+c.entityType.name+"/"+c.id+'">#'+c.id+"&nbsp;"+c.name+"</a>");this.$element.find("[entity_ref='"+c.id+"']").each(function(a,c){var e=b(c);e.replaceWith(d.clone())})}})}),define("tau/ui/extensions/comments/ui.extension.comments.editable",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base","tau/ui/templates/comments/ui.template.comments.comment"],function(a,b,c,d,e){var f=d.extend({category:"edit",destroy:function(){var a=this;a.destroyDynamicComponents(),a._super()},destroyDynamicComponents:function(){var a=this;a.commentListComponent&&(a.commentListComponent.destroy(),delete a.commentListComponent)},"bus dataBind+afterRender":function(a){var b=this;b.destroyDynamicComponents();var c={comments:a.dataBind.data.items},d=this.element=a.afterRender.data.element,e=".ui-all-comments",f=d.find(e),g={components:{type:"commentList"},context:this.config.context};b.createComponents(g,function(a){b.commentListComponent=a[0].component;var d={element:f,data:c,config:g};b.commentListComponent.fire("applyTo",d)})},getGUIDSelector:function(a){return"guid-comment-"+a},getCommentIdClass:function(a){return"comment-id-"+a},"bus prepareUpdate":function(a){var c=a.data.cmd,d=null,e=c.config.$set.parentId,f=".ui-all-comments"+(e?" ."+this.getCommentIdClass(e)+" .ui-comments":""),g=this.getGUIDSelector(c.guid);if(!c.config.id)d=b("<div class='ui-comment "+g+"'><div class='ui-comment-body'>Adding new comment. Please wait...</div></div>").appendTo(this.element.find(f));else{var h=this.getCommentIdClass(c.config.id);d=this.element.find(".ui-all-comments ."+h)}this.fire("markElementToBeUpdated",{element:d})},"bus applyUpdate":function(a){var b=this,c=a.data.cmd,d=c.guid,e=this.getCommentIdClass(a.data.id);if(!c.config.id){var f=this.getGUIDSelector(d),g=this.element.find(".ui-all-comments").find("."+f);g.addClass(e).removeClass(f)}this.on("afterRender",function(a){a.removeListener();var c=a.data.element,d=c.find("."+e+" > .ui-comment-body");b.fire("updateElement",{element:d})}),this.fire("refresh")},"bus prepareRemove":function(a){var b=a.data.cmd,c=this.getCommentIdClass(b.config.id),d=this.element.find(".ui-all-comments ."+c);this.fire("markElementToBeDeleted",{element:d})},"bus applyRemove":function(a){var b=this,c=a.data.cmd,d=this.getCommentIdClass(c.config.id),e=this.element.find(".ui-all-comments ."+d);this.fire("deleteElement",{element:e,callback:function(){b.fire("refresh")}})}});return f}),define("tau/ui/extensions/comments/ui.extension.comments.add",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(a,b,c){var d=c.extend({category:"edit",destroy:function(){var a=this;a.destroyDynamicComponents(),a._super()},lifeCycleCleanUp:function(){var a=this;a.destroyDynamicComponents(),a._super()},destroyDynamicComponents:function(){var a=this;a.commentNewEditorComponent&&(a.commentNewEditorComponent.destroy(),delete a.commentNewEditorComponent)},"bus initialize":function(a){this.config=a.data},"bus afterRender+permissionsReady+dataBind":function(a){this.element=a.afterRender.data.element;var b=a.permissionsReady.data;this.data=a.dataBind.data,this.initializeAddCommentLink()},initializeAddCommentLink:function(){this.$addLink=b("<span class='ui-comments-add-link'>Add Comment</span>").click(b.proxy(this.addNewComment,this)).insertAfter(this.element.find(".ui-all-comments"))},onCloseEditor:function(a){this.$addLink.show()},addNewComment:function(){var a=this;a.$addLink.hide();var c={components:[{type:"comment.new.editor"}],context:a.config.context};a.createComponents(c,function(c){var d=a.commentNewEditorComponent=c[0].component;d.on("afterRender",function(b){var c=b.data.element;c.insertAfter(a.$addLink)}),d.on("destroy",b.proxy(a.onCloseEditor,a)),d.initialize()})}});return d}),define("tau/ui/templates/comments/ui.template.comments",["tau/core/templates-factory","tau/ui/templates/comments/ui.template.comments.comment"],function(a){var b={name:"comments",options:{contentSelector:".ui-comments-content"},markup:['<div class="box ui-comments-control">','   <div class="ui-all-comments ui-comments-content">','       {{tmpl(items) "comments-comment"}}',"   </div>","</div>"].join(""),dependencies:["comments-comment"]};return a.register(b)}),define("tau/ui/extensions/ui.extension.domOperationsBase",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus markElementToBeDeleted":function(a){var b=a.data,c=b.element;c.addClass("deleting")},"bus deleteElement":function(a){var b=a.data.element,c=a.data.callback;b.fadeOut(750,c)},"bus markElementToBeUpdated":function(a){var b=a.data,c=b.element;c.addClass("updating")},"bus cancelUpdateElement":function(a){var b=a.data.element;this._highlightElement(b,"#EE5757",1500)},"bus updateElement":function(a){var c=this,d=a.data.element;d.each(function(){var a=b(this);c._highlightElement(a,"#FFFFD3",1500)})},_highlightElement:function(a,b,c){a.stop(!0,!0),a.removeClass("updating"),a.addClass("before-animate");var d=this._getElementBgColor(a),e=a.css("backgroundColor"),f=function(){a.css("backgroundColor","")};a.removeClass("before-animate"),a.css({backgroundColor:b}).animate({backgroundColor:d},c,f)},_getElementBgColor:function(a){var b="transparent";while(a.length>0&&a.parent()&&((b=a.css("backgroundColor"))=="transparent"||b==undefined||b=="rgba(0, 0, 0, 0)"||b.length==0)){a=a.parent();if(a.is("body"))break}if(b=="transparent"||b.length==0)b="#ffffff";return b}})}),define("tau/components/component.creator",["Underscore","tau/core/component-base","tau/core/view-base","tau/configurator","tau/ui/extensions/ui.extension.domOperationsBase"],function(a,b,c,d,e){return{create:function(f,g){var h=g||{};f=f||{},a.defaults(h,{store:g.store||d.getStore()}),f.template&&(h.template=f.template),a.defaults(h,{name:f.name}),a.defaults(h,{name:h.name});var i=new b(h),j=f.ViewType||c;i.attach(j),f.ModelType&&i.attach(f.ModelType);var k=f.domOperations||e;i.attach(k);if(f.extensions&&f.extensions.constructor==Array)for(var l=0;l<f.extensions.length;l++){var m=f.extensions[l];m.hasOwnProperty("type")&&m.hasOwnProperty("config")?i.attach(m.type,m.config):i.attach(m)}return i.bus}}}),define("tau/components/component.additionalInfo",["Underscore","tau/components/component.creator","tau/views/view.container","tau/components/extensions/additionalInfo/extension.additionalInfo.editable","tau/components/extensions/additionalInfo/extension.additionalInfo.updateAnimation","tau/components/extensions/component.creator.extension","tau/ui/templates/container/ui.template.container.table","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/spinner/ui.extension.spinner"],function(a,b,c,d,e,f,g,h,i){return{create:function(j){j=j||{};var k=[];a.forEach(j.children,function(a){a.label&&a.field?(a.label.disabledExtensionCategories=j.disabledExtensionCategories,k.push(a.label),a.field.disabledExtensionCategories=j.disabledExtensionCategories,k.push(a.field)):(a.disabledExtensionCategories=j.disabledExtensionCategories,k.push(a))}),j.children=k,a.defaults(j,{template:g,cssClass:"additional-info-table",columnCount:2,cellsCssClass:["ui-additionalinfo__label","ui-additionalinfo__value"],layout:"table"});var l={extensions:[f,h,e,i,d],ViewType:c};return b.create(l,j)}}}),define("tau/components/component.assignedEffort",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/label/ui.template.assignmentEffort.label"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.assignmentsList",["Underscore","tau/components/component.creator","tau/models/model.assignmentsList","tau/models/model.assignmentsList.editable","tau/models/userList/extension.model.unassignAction","tau/models/userList/extension.model.showMore","tau/components/extensions/assignmentsList/extension.assignmentsList.editable","tau/components/extensions/component.creator.extension","tau/ui/extensions/popupEditorContainer.extension","tau/models/assignment/model.assignment.editable","tau/models/assignment/model.add.assignment.editable","tau/ui/templates/assignmentsList/ui.template.assignmentsList"],function(a,b,c,d,e,f,g,h,i,j,k,l){return{create:function(m){var n={extensions:a.concat([c,h,d,g,{type:i,config:{popupEditorContainer:[{targetSelector:".user-list .user",alignmentSelector:".user-name",alignmentSelectorFrom:"target",component:{type:"userList",extensions:[j,e,f]}}]}},{type:i,config:{popupEditorContainer:[{targetSelector:".owner-cell .user-name",component:{type:"userList",extensions:[f]}}]}},{type:i,config:{popupEditorContainer:[{targetSelector:".add-btn:not(.disabled)",component:{type:"userList",extensions:[k,f]}}]}},m.extensions]),template:m.template||l};return b.create(n,m)}}}),define("tau/components/component.attachments",["tau/components/component.creator","tau/models/model.attachments","tau/models/model.attachments.editable","tau/components/extensions/attachments/component.attachments.uploader","tau/components/extensions/attachments/component.attachments.selectable","tau/components/extensions/attachments/component.attachments.showPreview","tau/components/extensions/attachments/component.attachments.thumbProxy","tau/components/extensions/attachments/component.attachments.deletable","tau/components/extensions/error/extension.errorBar","tau/ui/templates/attachments/ui.template.attachments"],function(a,b,c,d,e,f,g,h,i,j){return{create:function(k){var l=k||{},m={extensions:[b,c,d,e,f,g,h,i],template:j};return a.create(m,l)}}}),define("tau/components/component.attachmentsPreview",["tau/components/component.creator","tau/models/model.attachments","tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview","tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview","tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview.animations"],function(a,b,c,d,e){return{create:function(f){var g=function(a){return(a.mimeType||"").indexOf("image/")==0},h={ModelType:b,template:c,extensions:[d,e]};return f.filter=f.filter||g,a.create(h,f)}}}),define("tau/components/component.audit.history",["tau/components/component.creator","tau/models/model.label","tau/ui/templates/auditHistory/ui.template.auditHistory","tau/ui/extensions/auditHistory/ui.audit.history"],function(a,b,c,d){return{create:function(e){var f={name:"auditHistory",ModelType:b,template:c,extensions:[d]};return a.create(f,e)}}}),define("tau/components/component.breadcrumbs",["tau/components/component.creator","tau/models/model.breadcrumbs","tau/models/model.breadcrumbs.entity","tau/components/extensions/breadcrumbs/extension.breadcrumbs.items","tau/ui/templates/breadcrumbs/ui.template.breadcrumbs"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[b,c,d],template:e};return a.create(g,f)}}}),define("tau/components/component.comment",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/comments/ui.extension.comment.editable","tau/models/model.comment.editable","tau/ui/extensions/comments/ui.extension.comment.practices.notification","tau/ui/templates/comments/ui.template.comments.comment"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[d,c,e,b],template:f};return a.create(h,g)}}}),define("tau/components/component.comment.new.editor",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.comment.editable","tau/ui/extensions/comments/ui.extension.comments.new.editor","tau/ui/extensions/comments/ui.extension.comment.practices.notification","tau/ui/templates/comments/ui.template.comments.comment.new.editor"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[c,d,e,b],template:f};return a.create(h,g)}}}),define("tau/components/component.commentList",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/comments/ui.extension.commentList.editable"],function(a,b,c){return{create:function(){var d={extensions:[b,c]};return a.create(d,{name:"comment.commentList"})}}}),define("tau/components/component.container",["Underscore","tau/components/component.creator","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/spinner/ui.extension.spinner"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:a.concat([g.extensions,d,e,f]),ViewType:c};return b.create(h,g)}}}),define("tau/models/model.customField",["Underscore","tau/core/model-base","tau/configurator","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(a,b,c,d,e){var f={url:function(a,b){var c={label:"",url:""};return a&&(c.url=a.url||"",c.label=a.label||""),c},entity:function(a,b){var c={id:"",name:"",kind:""};return a&&(c.id=a.id,c.name=a.name||"",c.__type=c.kind=a.kind||""),c},date:function(a,b){var c={text:"",date:null};return a&&(c.date=e.parse(a),c.text=e.format.date.short(a)),c},richtext:function(a,b){return d.fromSourceToHtml(a)}},g=function(a){this.model=a};g.prototype={done:function(a){var b=a[0].data;this.fireAfterInit(b.customFields)},parseValue:function(a,b){b=b.toLowerCase();var c=this.model.config.context.applicationContext,d=f[b];return d?d(a,c):a},fireAfterInit:function(b){var c=this,d=this.model.config.customField||this.model.config.data,e={name:d.name,type:d.type,required:d.required,listed:d.listed,value:""},f=a(b).find(function(a){return a.name===d.name});e.type.toLowerCase()=="dropdown"&&(e.options=a.isArray(d.value)?d.value:(new String(d.value)).split("\r\n")),f&&(e.value=c.parseValue(f.value,d.type)),this.model.fieldInfo=e,this.model.fire("dataBind",e)}};var h=b.extend({TYPE_TEXT:"Text",TYPE_RICHTEXT:"RichText",TYPE_CHECKBOX:"CheckBox",TYPE_URL:"URL",TYPE_DATE:"Date",TYPE_NUMBER:"Number",fieldInfo:{},onInit:function(){var b=new g(this),c=this.config.context,d=c.entity.entityType.name,e=c.entity.id,f=c.applicationContext.processes[0].customFields;if(f&&f.length>0){var h={id:e,fields:["id","customFields"]},i=this;this.beforeSaveHandler||(this.beforeSaveHandler=a.bind(this._beforeSave,this),this.store.on({eventName:"beforeSave",type:d,listener:this},this.beforeSaveHandler)),this.afterSaveHandler||(this.afterSaveHandler=a.bind(this._afterSave,this),this.store.on({eventName:"afterSave",type:d,listener:this},this.afterSaveHandler)),this.store.get(d,h).done({success:b.done,scope:b})}else b.fireAfterInit([])},_beforeSave:function(b){var c=this;if(!b.data.changes.customFields)return;var d=b.data.cmd.config.fields;a.mergeFields(d,["customFields"]);var e=b.data.changes.customFields[0];e.value===""&&(e.value=null),e.name==c.fieldInfo.name&&c.bus.fire("preRefreshRow",{data:b.data.changes.customFields[0]})},_afterSave:function(a){var b=this;if(a.data.cmd.config.$set.customFields&&a.data.cmd.config.$set.customFields.length){var c=a.data.cmd.config.$set.customFields[0];c.name==b.fieldInfo.name&&b.bus.fire("refreshRow",c)}},destroy:function(){this.beforeSaveHandler=null,this.afterSaveHandler=null,this._super()}});return h}),define("tau/models/model.customField.editable",["tau/core/model.editable.base"],function(a){var b=a.extend({category:"edit",name:"Editable custom field","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})}});return b}),define("tau/core/tau-widget",["Underscore","jQuery","tau/core/event"],function(a,b,c){var d=function(d,e){var f=e._create||function(){};e._create=function(){var a=this;f.apply(a,arguments),a.bus=a.options.bus||a.element.data("bus"),c.subscribeOn(a)},a.extend(e,{_fire:function(){this.bus.fire.apply(this.bus,arguments)}}),b.widget(d,e)};return{widget:d}}),define("tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle",["jQuery","tau/core/tau-widget"],function(a,b){b.widget("ui.checkboxToggle",{options:{onSave:function(){},classNames:{checked:"checked",unchecked:"unchecked"}},_create:function(){this.init()},init:function(){var b=this.element,c=this,d=this.options.classNames;this.toggleProxy=a.proxy(this.onClick,this),b.click(this.toggleProxy)},activate:function(){var a=this.options.classNames;this._toggle(this.element,a.checked,a.unchecked),this.options.onSave(this.element.hasClass(a.checked))},onClick:function(a){a.stopPropagation(),this.toggle()},toggle:function(){var a=this.element,b=this.options.classNames;this._toggle(a,b.checked,b.unchecked),this.options.onSave(a.hasClass(b.checked))},_toggle:function(a,b,c){var d=a;d.hasClass(b)?(d.removeClass(b),d.addClass(c)):d.hasClass(c)?(d.removeClass(c),d.addClass(b)):d.addClass(b)},destroy:function(){delete this.toggleProxy}})}),define("tau/components/extensions/customField/extension.customField.checkbox.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var c=this,d=a.afterRender.data.data,e=a.permissionsReady.data;if(e.editable){var f=a.afterRender.data.element,g=f.find(".ui-customfield__value");g.checkboxToggle({classNames:{checked:"ui-customfield__value_checked",unchecked:"ui-customfield__value_unchecked"},onSave:function(a){c.bus.fire("elementUpdated"),c.bus.fire("save",{customFields:[{name:d.name,value:a}]})}}),f.behaviourCustomFieldRow({onActivate:function(a){a.stopPropagation(),b(a.target).hasClass("ui-customfield__value")==0&&g.checkboxToggle("activate")}}),f.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/templates/customField/ui.template.customField.checkbox",["tau/core/templates-factory"],function(a){var b={name:"customField-checkbox",markup:['<div class="ui-customfield ui-customfield-checkbox">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value ui-customfield__value_{{if value}}checked{{else}}unchecked{{/if}}">&nbsp;</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/components/component.customField.checkbox",["tau/components/component.creator","tau/models/model.customField","tau/models/model.customField.editable","tau/components/extensions/customField/extension.customField.checkbox.editable","tau/ui/templates/customField/ui.template.customField.checkbox"],function(a,b,c,d,e){return{create:function(f){var g={ModelType:b,template:e,extensions:[c,d]};return a.create(g,f)}}}),define("libs/schema.js/lib/utils",["require","exports","module"],function(require,exports,module){var a=Array.prototype.slice,b=Object.hasOwnProperty;Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new Error("Invalid object");var c=[];for(var d in a)b.call(a,d)&&(c[c.length]=d);return c}),exports.extend=function(b){var c=a.call(arguments,1),d;for(var e=0,f=c.length;e<f;e++){d=c[e];for(var g in d)b[g]=d[g]}return b},exports.locale=function(a,b){if(a instanceof Object){b=""+b||"en";if(a[b]!==undefined)return a[b];parts=b.split("_");while(parts.pop()){b=parts.join("_");if(a[b]!==undefined)return a[b]}return a.en}return a}}),define("libs/schema.js/lib/objecttools",["require","exports","module"],function(require,exports,module){typeof global=="undefined"&&typeof window=="object"&&(window.global=window),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)a.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b});var a=0,b=["$ref","$refs","$$refs"],c={},d=c.find=function(a,b){var c,d=a;for(var e=b.length,f=0;f<e;f++){if((c=b[f])===undefined)break;if((d instanceof Object||d instanceof Array)&&c in d)d=d[c];else return}return d},e={},f=c.id=function(b){if(b instanceof Object)return b.hasOwnProperty("__id")||(b.__id=a++),b.__id;return},g=c.resetRefs=function(a){if(a instanceof Object){var b=h(a);return b?(b.splice(0),b):(b=[],a instanceof Array?a.push({$$refs:b}):a.$refs=b,b)}return null},h=c.getRefs=function(a){if(a instanceof Object)return a instanceof Array&&a[a.length-1]&&a[a.length-1].$$refs instanceof Array?a[a.length-1].$$refs:a.hasOwnProperty("$refs")?a.$refs:null;return null},i=c.addRef=function(a,b,c){var d=h(a);if(!d)throw new Error("You need to call resetRefs(object) first!");return d.push(b),d.push(c),d},j=c.findRefs=function(a){var c={},d=[],e=g(a),h=function(g){if(!(g instanceof Object))return;var i=f(g);if(c[i]!==undefined){e.push([].concat(d)),e.push(c[i]);return}c[i]=["#"].concat(d);if(a instanceof Array){for(var j=a.length,k=0;k<j;k++)d.push(k),h(g[k]),d.pop();return}for(var l=Object.keys(g),j=l.length,k=0,m;m=l[k],k<j;k++){if(b.indexOf(m)>-1)continue;d.push(m),h(g[m]),d.pop()}};return h(a),a},k=c.resolveRefs=function(a,b){var c,e=a instanceof Array;if(e){var f=a[a.length-1];f instanceof Object&&f.$refs instanceof Array&&(c=f.$refs)}else a instanceof Object&&a.$refs instanceof Array&&(c=a.$refs);if(!c)return a;var g,h,i,j,k;for(var l=c.length,m=0;m<l;m+=2){g=[].concat(c[m]),i=[].concat(c[m+1]),h=g.pop(),j=i.shift();if(h===undefined||j===undefined)continue;k=d(a,g);if(!k)continue;j!=="#"&&i.unshift(j);if(j!=="#"&&!b)continue;k[h]=d(j==="#"?a:global,i),c.splice(m,2),m-=2,l-=2}return a};module.exports={},typeof module=="object"&&module.exports&&(module.exports=c)}),define("libs/schema.js/lib/validation",["require","exports","module","./utils","./objecttools"],function(require,exports,module){var a=require("./utils"),b=require("./objecttools"),c=a.locale,d=Array.prototype.slice;module.exports=function(){var e=this,f=this.detectRecursion,g=this.Validation=function(b,d,h){h=h||{},this._flags={},this._errors={},this._wasError=0,this._stack=[],this.path=[],this.id=g._id++,this.schema,this.push(b),this.instance=d,this.locale=e.locale||"en",this.detectRecursion=h.detectRecursion||f,this.errors=[];var i=this,j=this.Error=function(b,d,e){this.schema=i.schema,this.path=i.path?[].concat(i.path):[],this.attribute=b||"",this.description=typeof d=="object"?c(d,i.locale)(this):d||"",e&&a.extend(this,e),i._errors[this.id()]||(i._errors[this.id()]=!0,i.errors.push(this)),i._wasError++};j.prototype.toJSON=function(){return{path:this.path,name:this.attribute,description:this.description}},j.prototype.id=function(){return[this.path,undefined,this.attribute]+""},this.instance=this.start(d),delete this._flags,this._errors,this._wasError,this._stack,this.path,this.id};a.extend(g.prototype,{isError:function(){return this.errors.length>0},getError:function(){if(this.errors.length===0)return null;var a=new Error(c(e.i18n("validation_error"),this.locale)(this));return a.errors=this.errors,a.toJSON=function(){return{message:this.message,errors:this.errors}},a},wasError:function(){var a=this._wasError;return this._wasError=0,a},push:function(a,b){this.schema=a,this._stack.push(a),b!==undefined&&this.path.push(b)},pop:function(a){var b=[this._stack.pop(),a?undefined:this.path.pop()],c=this._stack.length;return this.schema=c?this._stack[c-1]:null,b},getFlag:function(a){return b.id(a)+"_"+this.schema.id},flagObject:function(a){return this._flags[this.getFlag(a)]=!0,a},isObjectFlagged:function(a){return this.getFlag(a)in this._flags},callPlugin:function(a,b){var c=arguments.length>2?d.call(arguments,1):[b];return typeof a!="function"&&(a=g.plugins[a]||g.plugins.addError),a.apply(this,c)}}),a.extend(g,{_id:1,registerPlugins:function(b){a.extend(g.plugins,b)},plugins:{addError:function(a,b){return new this.Error(b,e.i18n["validation_error_"+b]),a}}}),require("./"+this.v+"/validation").call(this)}}),define("libs/schema.js/lib/schema",["require","exports","module","./utils","./objecttools"],function(require,exports,module){var a=require("./utils"),b=require("./objecttools");module.exports=function(){var c=this,d=this.Schema=function(b){typeof b=="string"&&(b=JSON.parse(b));if(b instanceof d)return b;a.extend(this,b),this.id===undefined&&(this.id=""+d._id++),d.instances[this.id]=this};a.extend(d.prototype,{validate:function(a,b){var d=new c.Validation(this,a,b);return delete d.instance.__id,d},setFallbacks:function(b){return typeof b=="string"?this.fallbacks=c.Validation[b]:b===undefined?this.fallbacks=c.fallbacks:this.fallbacks=a.extend({},c.fallbacks,b),this}}),a.extend(d,{_id:1,create:function(a){if(typeof a=="string")var a=JSON.parse(a);var b=c.schemaSchema.validate(a);if(b.isError())throw console.log(b.getError()),b.getError();return b.instance},createSeveral:function(a){for(var b in a)a[b].id===undefined&&(a[b].id=b),a[b]=this.create(a[b]);return a},instances:{},resolveRefs:function(){for(var a in this.instances)b.resolveRefs(this.instances[a],!0)}})}}),define("libs/schema.js/lib/environment",["require","exports","module","./objecttools","./utils","./schema","./validation"],function(require,exports,module){var a=require("./objecttools"),b=require("./utils"),c=Array.prototype.slice,d=b.extend,e=b.locale,f=function(a,b){var c;if(typeof a=="object")b=a;else{if(f.instances[a])return f.instances[a];c=this,this.id=a,f.instances[a]=this}b=b||{};var e=b.i18n||["../i18n/default"];e instanceof Array||(e=[e]);var g=this.i18n=function(a){return g[a]||{en:function(){return""}}},h;for(var i=0,j=e.length;i<j;i++)h=e[i],typeof h=="object"?d(g,h):d(g,require(h));delete b.i18n,this.locale=b.locale||"en",delete b.locale,this.v="draft-02",delete b.v,this.detectRecursion=b.detectRecursion===undefined?!0:b.detectRecursion,delete b.detectRecursion,require("./schema").call(this);var k=this.Schema;k.v=this.v,require("./validation").call(this);var l=this.Validation,m=b.fallbacks||"TOLERANT_FALLBACKS";typeof m=="object"?this.fallbacks=d(l.STRICT_FALLBACKS,m):this.fallbacks=l[m],delete b.fallbacks,d(this,b),require("./"+this.v+"/setupSchemaSchema").call(this);var n=this.schemaSchema.validate(this.schemaSchema,{detectRecursion:!0});if(n.isError())throw console.log("The core schema is not valid!"),n.getError()};d(f.prototype,{validateCall:function(a,b){if(a.SCHEMA instanceof this.Schema){var d=a.SCHEMA.validate(c.call(arguments,2)),e=d.instance;if(d.isError())throw d.getError();return a.apply(b,e)}throw"No SCHEMA defined"},validateCallAsync:function(a,b){if(!(a.SCHEMA instanceof this.Schema))throw"No SCHEMA defined";var d=c.call(arguments,2),e=d.pop(),f=a.SCHEMA.validate(d),d=f.instance;if(f.isError())return e(f.getError());d.push(e),a.apply(b,d)},f:function(a,b,d,e){var f=c.call(arguments),e=f.pop();if(f.length===0)return e.IS_ASYNC=!1,e;if(a instanceof Object){var b=!!f[1],a=this.Schema.create(a),d=!!f[2],g,h,i=this;return d?g=function(){return i.validateCallAsync.apply(i,[e,this].concat(c.call(arguments)))}:g=function(){return i.validateCall.apply(i,[e,this].concat(c.call(arguments)))},e.SCHEMA=a,e.IS_VALIDATING=b,e.IS_ASYNC=d,g.SCHEMA=a,g.IS_VALIDATING=b,g.IS_ASYNC=d,h=b?g:e,b||(h.validate=g),h}return e.IS_ASYNC=!!f[0],e}}),f.instances={};var g=function(a,b){return new f(a,b)};return module.exports={},typeof module=="object"&&module.exports?module.exports=g:window.createEnvironment=g,module.exports}),define("libs/schema.js/i18n/default",["require","exports","module"],function(require,exports,module){module.exports={validation_error:{de:function(){return"Diese Instanz ist nicht gltig"},en:function(){return"This instance is not valid"}},validation_error_type:{de:function(a){return"Ungltiger Typ"},en:function(a){return"Invalid type"}},validation_error_minLength:{de:function(a){return"Der Text muss mindestens "+a.schema.minLength+" Zeichen haben."},en:function(a){return"Text must be longer than "+a.schema.minLength+" symbols"}},validation_error_maxLength:{en:function(a){return"Text must be shorter than "+a.schema.maxLength+" symbols"}},validation_error_minimum:{en:function(a){return"Number must be greater than "+a.schema.minimum+""}},validation_error_maximum:{en:function(a){return"Number must be less than "+a.schema.maximum+""}},validation_error_pattern:{en:function(a){return"Incorrect value"}},validation_error_optional:{en:function(a){return"Required field"}}}}),define("libs/schema.js/lib/draft-02/validation",["require","exports","module","Underscore","../utils","../objecttools"],function(require,exports,module){var a=require("Underscore"),b=require("../utils"),c=require("../objecttools");module.exports=function(){var d=this,e=this.Schema;b.extend(this.Validation.prototype,{start:function(a){if(this.detectRecursion&&a instanceof Object){if(this.isObjectFlagged(a))return a;this.flagObject(a)}return a=this["extends"](a),this.wasError()?a:(a=this.adapters(a,"pre"),this.wasError()?a:(a=this.optional(a),this.wasError()||a===undefined?a:(a=this.empty(a),this.wasError()||a===""||a===null?a:(a=this.type(a),this.wasError()?a:(a=this.requires(a),this.wasError()?a:(a=this.adapters(a,"post"),a))))))},"extends":function(a){return this.schema["extends"]?(this.push(this.schema["extends"]),a=this.start(a),this.pop(!0),a):a},optional:function(a){return this.schema.optional||a!==undefined?a:this.callPlugin(this.schema.fallbacks.optional,a,"optional")},empty:function(a){return this.schema.empty||a!==undefined&&a!==""&&a!==null?a:this.callPlugin(this.schema.fallbacks.optional,a,"empty")},adapters:function(a,b){if(!this.schema[b])return a;var c=this.schema[b];c instanceof Array||(c=[c]);var d=this.errors.length,e;for(var f=c.length,g=0;g<f;g++){e=c[g],a=this.callPlugin(e,a);if(this.errors.length>d)return a}return a},type:function(a,b,c){c=c===!1?!1:!0;var d=b||this.schema.type;if(!(d instanceof Array)){var e=typeof a,f=function(){if(d==="any")return!0;if(d==="null")return a===null;if(d==="array")return a instanceof Array;if(d==="object")return a instanceof Object&&!(a instanceof Array);if(d==="number")return e==="number";if(d==="integer")return e==="number"&&Math.round(a)===a;if(d==="string")return e==="string";if(d==="boolean")return e==="boolean"}();if(!f){a=this.callPlugin(this.schema.fallbacks.type,a,"type");if(this.wasError())return a}var b=typeof a;return b==="number"?(a=this.minimum(a),this.wasError()?a:(a=this.maximum(a),this.wasError()?a:(a=this.maxDecimal(a),this.wasError()?a:(c&&(a=this["enum"](a)),a)))):b==="string"?(a=this.pattern(a),this.wasError()?a:(a=this.minLength(a),this.wasError()?a:(a=this.maxLength(a),this.wasError()?a:(c&&(a=this["enum"](a)),a)))):a instanceof Array?(a=this.minItems(a),this.wasError()?a:(a=this.maxItems(a),this.wasError()?a:(a=this.items(a),this.wasError()?a:(a=this.additionalProperties(a),this.wasError()?a:(c&&(a=this["enum"](a)),a))))):a instanceof Object?(a=this.properties(a),a=this.additionalProperties(a),this.wasError()?a:(c&&(a=this["enum"](a)),a)):a}var g,h=this.errors.length;for(var i=d.length,j=0;j<i;j++){g=this.type(a,d[j],j===0);if(this.errors.length===h){a=g;break}j+1<i&&(this.errors.splice(h,1),this.wasError())}return a},"enum":function(b){return"enum"in this.schema?a.indexOf(this.schema["enum"],b)>-1?b:this.callPlugin(this.schema.fallbacks["enum"],b,"enum"):b},requires:function(a){if(this.schema.requires!==undefined&&this.parentInstance){var b;typeof this.schema.requires=="string"?(b={properties:{}},b.properties[this.schema.requires]={type:"any"}):b={properties:this.schema.requires},b=e.create(b);var c=this.pop();this.push(b),this.properties(this.parentInstance),this.pop(!0),this.push.apply(this,c)}return a},properties:function(a){if("properties"in this.schema){var b=this.schema.properties,c,d;this.parentInstance=a;var e,d;for(var f in b){this.push(b[f],f),e=f in a,f!="__id"?d=this.start(a[f]):(d=undefined,e=!1);if(e||d!==undefined)a[f]=d;this.pop()}this.parentInstance=null}return this.wasError(),a},additionalProperties:function(a){if("additionalProperties"in this.schema)if(a instanceof Object&&!(a instanceof Array)){var b=this.schema.properties||{};if(!this.schema.additionalProperties){for(var c=Object.keys(a),d=c.length,e=0,f;f=c[e],e<d;e++)if(!(f in b)&&f!="__id")return this.callPlugin(this.schema.fallbacks.additionalProperties,a,"additionalProperties")}else if(this.schema.additionalProperties!==!0)for(var c=Object.keys(a),d=c.length,e=0,f;f=c[e],e<d;e++)f in b||(this.push(this.schema.additionalProperties,f),f!=="__id"&&(a[f]=this.start(a[f])),this.pop())}else if(this.schema.items instanceof Array)if(!this.schema.additionalProperties){if(a.length>this.schema.items.length)return this.callPlugin(this.schema.fallbacks.additionalProperties,a,"additionalProperties")}else if(this.schema.additionalProperties!==!0)for(var d=a.length,e=this.schema.items.length;e<d;e++)this.push(this.schema.additionalProperties,e),a[e]=this.start(a[e]),this.pop();return a},items:function(a){if("items"in this.schema)if(this.schema.items instanceof Array){var b,c;for(var d=this.schema.items.length,e=0;e<d;e++){this.push(this.schema.items[e],e),b=e in a,e!="__id"?c=this.start(a[e]):(b=!1,c=undefined);if(b||c!==undefined)a[e]=c;this.pop()}}else for(var d=a.length,e=0;e<d;e++)this.push(this.schema.items,e),e!="__id"&&(a[e]=this.start(a[e])),this.pop();return a},maxItems:function(a){return this.schema.maxItems&&a.length>this.schema.maxItems?this.callPlugin(this.schema.fallbacks.maxItems,a,"maxItems"):a},minItems:function(a){return this.schema.minItems&&a.length<this.schema.minItems?this.callPlugin(this.schema.fallbacks.minItems,a,"minItems"):a},minimum:function(a){if("minimum"in this.schema){var b="minimumCanEqual"in this.schema?this.schema.minimumCanEqual:!0;return(b?a>=this.schema.minimum:a>this.schema.minimum)?a:this.callPlugin(this.schema.fallbacks.minimum,a,"minimum")}return a},maximum:function(a){if("maximum"in this.schema){var b="maximumCanEqual"in this.schema?this.schema.maximumCanEqual:!0;return(b?a<=this.schema.maximum:a<this.schema.maximum)?a:this.callPlugin(this.schema.fallbacks.maximum,a,"maximum")}return a},maxDecimal:function(a){if("maxDecimal"in this.schema){var b=Math.pow(10,this.schema.maxDecimal);return Math.round(a*b)/b===a?a:this.callPlugin(this.schema.fallbacks.maxDecimal,a,"maxDecimal")}return a},pattern:function(a){return this.schema.pattern?this.schema.pattern.test(a)?a:this.callPlugin(this.schema.fallbacks.pattern,a,"pattern"):a},minLength:function(a){return this.schema.minLength===undefined?a:a.length<this.schema.minLength?this.callPlugin(this.schema.fallbacks.minLength,a,"minLength"):a},maxLength:function(a){return this.schema.maxLength===undefined?a:a.length>this.schema.maxLength?this.callPlugin(this.schema.fallbacks.maxLength,a,"maxLength"):a}}),b.extend(this.Validation,{TOLERANT_FALLBACKS:{optional:"setDefault",type:"castTolerantlyToType","enum":"setDefault",requires:"addError",additionalProperties:"removeAdditionalProperties",maxItems:"sliceToMaxItems",minItems:"addError",maximum:"setMaximum",minimum:"setMinimum",maxDecimal:"roundToMaxDecimal",pattern:"addError",minLength:"addError",maxLength:"addError"},STRICT_FALLBACKS:{optional:"addError",type:"addError","enum":"addError",requires:"addError",additionalProperties:"addError",maxItems:"addError",minItems:"addError",maximum:"addError",minimum:"addError",maxDecimal:"addError",pattern:"addError",minLength:"addError",maxLength:"addError"}}),this.Validation.registerPlugins({addToRefs:function(a){if(a instanceof Object&&!(a instanceof Array)&&typeof a.$ref=="string"){var b=this.path,d=a.$ref.split(".");c.addRef(this.instance,[].concat(b),d[0]==="#"?[].concat(d):["#","constructor","instances"].concat(d))}return a},instantiateSchema:function(a){if(!(a instanceof Object)||a instanceof Array)return a;var b=a===this.instance;a instanceof e||(a=new e(a)),b&&(this.instance=a);if(a.properties instanceof Object){var d=a.properties||{};for(var f in d)d[f]instanceof Object&&!(d[f]instanceof e)&&(d[f]=new e(d[f]))}if(a.items instanceof Array){var g=a.items;for(var h=g.length,i=0;i<h;i++)g[i]instanceof Object&&!(g[i]instanceof e)&&(g[i]=new e(g[i]))}else a.items instanceof Object&&(a.items instanceof e||(a.items=new e(a.items)));if(a.requires&&a.requires instanceof Object&&!(a.requires instanceof Array)){var d=a.requires;for(var f in d)d[f]=new e(d[f])}return a.additionalProperties instanceof Object&&!(a.additionalProperties instanceof e)&&(a.additionalProperties=new e(a.additionalProperties)),a["extends"]instanceof Object&&(a["extends"]instanceof e||(a["extends"]=new e(a["extends"]))),a.setFallbacks(a.fallbacks),c.resetRefs(a),a},castTolerantlyToType:function(a,b){b=b||"type";var c=this.schema.type,e=typeof a,f;if(c==="string")return e==="object"?a!==null&&typeof a.toString=="function"&&a.toString!==Object.prototype.toString&&a.toString!==Array.prototype.toString?""+a:(new this.Error(b,d.i18n["validation_error_"+b]),a):""+a;if(c==="number"){if(e!=="boolean")return f=parseFloat(a),isNaN(f)&&a!=0?(new this.Error(b,d.i18n["validation_error_"+b]?d.i18n["validation_error_"+b]:"validation_error_"+b),a):isNaN(f)?a:f;if(a===!1)return 0;if(a===!0)return 1}if(c==="integer"){if(e!=="boolean")return f=parseInt(a,10),isNaN(f)?(new this.Error(b,d.i18n["validation_error_"+b]),a):f;if(a===!1)return 0;if(a===!0)return 1}if(c==="boolean")return e==="string"?a.trim().toLowerCase()==="false"?!1:(f=parseFloat(a),isNaN(f)?!0:!!f):!!a;if(c==="object")return a instanceof Array&&a.length===0?{}:((e!=="object"||a===null||a instanceof Array)&&new this.Error(b,d.i18n["validation_error_"+b]),a);if(c==="array"){if(!a)return[];if(a instanceof Object){var f=[],g,h=!0;if(Object.keys(a).length===0)return f;for(var i in a){g=parseInt(i,10),""+g===i?f[g]=a[i]:h=!1;break}}return new this.Error(b,d.i18n["validation_error_"+b]),a}if(c==="null")return new this.Error(b,d.i18n["validation_error_"+b]),a},roundToMaxDecimal:function(a,b){if(this.schema.maxDecimal===undefined)return new this.Error(b,d.i18n["validation_error_"+b]),a;var c=Math.pow(10,this.schema.maxDecimal);return Math[a<0?"ceil":"floor"](a*c)/c},setMinimum:function(a,b){return this.schema.minimum===undefined?(new this.Error(b,d.i18n["validation_error_"+b]),a):this.schema.minimum},setMaximum:function(a,b){return this.schema.maximum===undefined?(new this.Error(b,d.i18n["validation_error_"+b]),a):this.schema.maximum},truncateToMaxLength:function(a,b){return this.schema.maxLength===undefined?(new this.Error(b,d.i18n["validation_error_"+b]),a):a.substr(0,this.schema.maxLength)},setDefault:function(a,b){if("default"in this.schema)return this.schema["default"];new this.Error(b,d.i18n["validation_error_"+b])},removeAdditionalProperties:function(a,b){if(this.schema.type==="object"){var c=this.schema.properties||{};for(var d=Object.keys(a),e=d.length,f=0,g;g=d[f],f<e;f++)c[g]===undefined&&delete a[g];return a}if(this.schema.items&&this.schema.items instanceof Array)for(var e=a.length,f=this.schema.items.length;f<e;f++)delete a[f];return a},sliceToMaxItems:function(a,b){return this.schema.maxItems!==undefined?a.length>this.schema.maxItems&&a.splice(this.schema.maxItems):new this.Error(b,d.i18n["validation_error_"+b]),a},deleteInstance:function(a){return undefined}})}}),define("libs/schema.js/lib/draft-02/setupSchemaSchema",["require","exports","module"],function(require,exports,module){module.exports=function(){var a=this.Schema,b=this.Validation,c={id:"jsonSchemaCore",title:"JSON Schema Core Schema",description:"This is the JSON Schema for JSON Schemas.",type:"object",properties:{type:{type:["string","array"],items:{type:"string","enum":{$ref:"#.properties.type.enum"}},uniqueItems:!0,description:"This is a type definition value. This can be a simple type, or a union type","enum":["string","object","array","boolean","number","integer","null","any"],minItems:2,optional:!0,"default":"any",pre:"addToRefs",labels:{de:{string:"Text",object:"Objekt",array:"Liste","boolean":"wahr/falsch",number:"Zahl",integer:"ganze Zahl","null":"undefiniert"},en:{}}},id:{type:"string",optional:!0,minLength:1,pattern:"[^\\.#]",description:"A globally unique ID for this schema. It can be used to reference the schema from another one."},optional:{type:"boolean",description:"This indicates that the instance property in the instance object is not required.",optional:!0,"default":!1,pre:"addToRefs"},empty:{type:"boolean",description:"This indicates that the instance property in the instance object can be empty.",optional:!0,"default":!1,pre:"addToRefs"},"enum":{type:"array",optional:!0,description:"This provides an enumeration of possible values that are valid for the instance property. It goes only for the first type, if type is an array of types.",minItems:1,uniqueItems:!0},description:{type:"string",optional:!0,description:"This provides a description of the purpose the instance property. The value can be a string or it can be an object with properties corresponding to various different instance languages (with an optional default property indicating the default description).",pre:"addToRefs"},title:{type:"string",optional:!0,description:"This provides the title of the property",pre:"addToRefs"},"default":{type:"any",optional:!0,description:"This indicates the default for the instance property.",pre:"addToRefs"},options:{type:"array",optional:!0,items:{type:"object",properties:{label:{type:"string",optional:!0},value:{type:"any"}}},pre:"addToRefs"},"extends":{type:"object",optional:!0,pre:"addToRefs"},requires:{type:["string","object"],additionalProperties:{$ref:"#"},optional:!0,description:"indicates a required property or a schema that must be validated if this property is present",pre:"addToRefs"},nonStandard:{type:"boolean",optional:!0,"default":!1,nonStandard:!0},pre:{type:["string","array","any"],items:{type:["string","any"]},optional:!0,description:"One or several prefix adapters identified by plugin IDs",nonStandard:!0,pre:"addToRefs"},post:{type:["string","array","any"],items:{type:["string","any"]},optional:!0,description:"One or several postfix adapters identified by plugin IDs",nonStandard:!0,pre:"addToRefs"},fallbacks:{type:"object",additionalProperties:{type:["string","object"],description:"Identifier for a adapter function that will be executed if a constraint is violated"},description:"Fallback object, with property names = schema property names",nonStandard:!0,pre:"addToRefs"},properties:{type:"object",additionalProperties:{$ref:"#"},description:"This is a definition for the properties of an object value",optional:!0,"default":{},pre:"addToRefs"},items:{type:["object","array"],properties:{$ref:"#.properties"},items:{$ref:"#"},description:"When the value is an array, this indicates the schema to use to validate each item in an array",optional:!0,pre:["instantiateSchema","addToRefs"]},maxItems:{type:"integer",optional:!0,description:"When the instance value is an array, this indicates maximum number of items.",minimum:0,pre:"addToRefs"},minItems:{type:"integer",optional:!0,description:"When the instance value is an array, this indicates minimum number of items.",minimum:0,pre:"addToRefs"},additionalProperties:{type:["boolean","object"],properties:{$ref:"#.properties"},description:"This provides a default property definition for all properties that are not explicitly defined in an object type definition.",optional:!0,"default":!0,pre:["instantiateSchema","addToRefs"]},minimum:{type:"number",optional:!0,description:"This indicates the minimum value for the instance property when the type of the instance value is a number.",pre:"addToRefs"},minimumCanEqual:{type:"boolean",optional:!0,description:"If the minimum is defined, this indicates whether or not the instance property value can equal the minimum.","default":!0,pre:"addToRefs"},maximum:{type:"number",optional:!0,description:"This indicates the maximum value for the instance property when the type of the instance value is a number.",pre:"addToRefs"},maximumCanEqual:{type:"boolean",optional:!0,description:"If the maximum is defined, this indicates whether or not the instance property value can equal the maximum.","default":!0,pre:"addToRefs"},maxDecimal:{type:"integer",optional:!0,description:"This indicates the maximum number of decimal places in a floating point number.",pre:"addToRefs"},pattern:{type:["string","object"],format:"regex",description:"When the instance value is a string, this provides a regular expression that a instance string value should match in order to be valid.",optional:!0,pre:["addToRefs",function(a,b){return a instanceof RegExp?a:typeof a=="string"?new RegExp(a):a}]},maxLength:{type:"number",optional:!0,description:"When the instance value is a string, this indicates maximum length of the string.",pre:"addToRefs"},minLength:{type:"number",optional:!0,description:"When the instance value is a string, this indicates minimum length of the string.",pre:"addToRefs"},format:{type:"string",optional:!0,description:"This indicates what format the data is among some predefined formats which may include:\n\ndate - a string following the ISO format \naddress \nschema - a schema definition object \nperson \npage \nhtml - a string representing HTML",pre:"addToRefs"}},pre:["instantiateSchema","addToRefs"]};(jsonSchemaCore=new a(c)).setFallbacks(b.STRICT_FALLBACKS);for(var d in jsonSchemaCore.properties)(jsonSchemaCore.properties[d]=new a(jsonSchemaCore.properties[d])).setFallbacks(b.STRICT_FALLBACKS);(jsonSchemaCore.properties.type.items=new a(jsonSchemaCore.properties.type.items)).setFallbacks(b.STRICT_FALLBACKS),jsonSchemaCore.properties.type.items["enum"]=jsonSchemaCore.properties.type["enum"],jsonSchemaCore.properties.id.pattern=new RegExp(jsonSchemaCore.properties.id.pattern),(jsonSchemaCore.properties.options.items=new a(jsonSchemaCore.properties.options.items)).setFallbacks(b.STRICT_FALLBACKS),jsonSchemaCore.properties.requires.additionalProperties=jsonSchemaCore,(jsonSchemaCore.properties.pre.items=new a(jsonSchemaCore.properties.pre.items)).setFallbacks(b.STRICT_FALLBACKS),(jsonSchemaCore.properties.post.items=new a(jsonSchemaCore.properties.post.items)).setFallbacks(b.STRICT_FALLBACKS),(jsonSchemaCore.properties.fallbacks.additionalProperties=new a(jsonSchemaCore.properties.fallbacks.additionalProperties)).setFallbacks(b.STRICT_FALLBACKS),jsonSchemaCore.properties.properties.additionalProperties=jsonSchemaCore,jsonSchemaCore.properties.items.properties=jsonSchemaCore.properties,jsonSchemaCore.properties.items.items=jsonSchemaCore,jsonSchemaCore.properties.additionalProperties.properties=jsonSchemaCore.properties,this.schemaSchema=jsonSchemaCore}}),define("tau/utils/utils.jsonSchema",["Underscore","jQuery","libs/schema.js/lib/environment","libs/schema.js/lib/utils","libs/schema.js/lib/objecttools","libs/schema.js/lib/schema","libs/schema.js/i18n/default","libs/schema.js/lib/draft-02/validation","libs/schema.js/lib/draft-02/setupSchemaSchema"],function(a,b,c,d,e,f,g,h){var i=c("prod",{fallbacks:"STRICT_FALLBACKS"});return i.PATTERN_DATE=/^([0-1]{0,1}[0-9]{1})\/([0-3]{0,1}[0-9]{1})\/([0-9]{4})$/,i.PATTERN_URL=/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/,i.Validation.registerPlugins({trim:function(a){return b.trim(a)}}),i.Validation.prototype.optional=function(a){return this.schema.optional||a!==undefined&&a!==null&&a!==""?a:this.callPlugin(this.schema.fallbacks.optional,a,"optional")},i}),define("tau/models/customField/model.customField.date.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(a,b,c){var d=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"string",optional:!1,post:function(a){if(this.wasError()==0){var b=c.parse(a);b==null?new this.Error("Date","Incorrect date format"):b<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 01-01-1900"):a=c.format.date.short(b)}return a},additionalProperties:{dateFormat:c.getFormatData().date.short}}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,b.validation=this.schema.validate(c)}});return d}),define("libs/jquery/jquery.ui.timepicker",["jQuery"],function(jQuery){(function($){function Timepicker(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",ampm:!1,amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone"},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:.05,stepMinute:.05,stepSecond:.05,stepMillisec:.5,hour:0,minute:0,second:0,millisec:0,timezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,showTimepicker:!0,timezoneIso8609:!1,timezoneList:null},$.extend(this._defaults,this.regional[""])}function extendRemove(a,b){$.extend(a,b);for(var c in b)if(b[c]===null||b[c]===undefined)a[c]=b[c];return a}$.extend($.ui,{timepicker:{version:"0.9.7"}}),$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,setDefaults:function(a){return extendRemove(this._defaults,a||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={};for(var attrName in this._defaults){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(a,b){$.isFunction(o.beforeShow)&&o.beforeShow(a,b,tp_inst)},onChangeMonthYear:function(a,b,c){tp_inst._updateDateTime(c),$.isFunction(o.onChangeMonthYear)&&o.onChangeMonthYear.call($input[0],a,b,c,tp_inst)},onClose:function(a,b){tp_inst.timeDefined===!0&&$input.val()!=""&&tp_inst._updateDateTime(b),$.isFunction(o.onClose)&&o.onClose.call($input[0],a,b,tp_inst)},timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(a){return a.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(a){return a.toUpperCase()});if(tp_inst._defaults.timezoneList===null){var timezoneList=[];for(var i=-11;i<=12;i++)timezoneList.push((i<0?"-":"+")+("0"+Math.abs(i).toString()).slice(-2)+"00");tp_inst._defaults.timezoneIso8609&&(timezoneList=$.map(timezoneList,function(a){return a=="+0000"?"Z":a.substring(0,3)+":"+a.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}tp_inst.hour=tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")}));if(tp_inst._defaults.minDate==0||tp_inst._defaults.minDateTime==0)tp_inst._defaults.minDate=new Date;if(tp_inst._defaults.maxDate==0||tp_inst._defaults.maxDateTime==0)tp_inst._defaults.maxDate=new Date;return tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst},_addTimePicker:function(a){var b=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(b),this._limitMinMaxDateTime(a,!1),this._injectTimePicker()},_parseTime:function(a,b){var c=this._defaults.timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/l{1}/ig,"(\\d?\\d?\\d)").replace(/t{1,2}/ig,this._getPatternAmpm()).replace(/z{1}/ig,"(z|[-+]\\d\\d:?\\d\\d)?").replace(/\s/g,"\\s?")+this._defaults.timeSuffix+"$",d=this._getFormatPositions(),e="",f;this.inst||(this.inst=$.datepicker._getInst(this.$input[0]));if(b||!this._defaults.timeOnly){var g=$.datepicker._get(this.inst,"dateFormat"),h=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");c=".{"+g.length+",}"+this._defaults.separator.replace(h,"\\$&")+c}f=a.match(new RegExp(c,"i"));if(f){d.t!==-1&&(f[d.t]===undefined||f[d.t].length===0?(e="",this.ampm=""):(e=$.inArray(f[d.t].toUpperCase(),this.amNames)!==-1?"AM":"PM",this.ampm=this._defaults[e=="AM"?"amNames":"pmNames"][0])),d.h!==-1&&(e=="AM"&&f[d.h]=="12"?this.hour=0:e=="PM"&&f[d.h]!="12"?this.hour=(parseFloat(f[d.h])+12).toFixed(0):this.hour=Number(f[d.h])),d.m!==-1&&(this.minute=Number(f[d.m])),d.s!==-1&&(this.second=Number(f[d.s])),d.l!==-1&&(this.millisec=Number(f[d.l]));if(d.z!==-1&&f[d.z]!==undefined){var i=f[d.z].toUpperCase();switch(i.length){case 1:i=this._defaults.timezoneIso8609?"Z":"+0000";break;case 5:this._defaults.timezoneIso8609&&(i=i.substring(1)=="0000"?"Z":i.substring(0,3)+":"+i.substring(3));break;case 6:this._defaults.timezoneIso8609?i.substring(1)=="00:00"&&(i="Z"):i=i=="Z"||i.substring(1)=="00:00"?"+0000":i.replace(/:/,"")}this.timezone=i}return!0}return!1},_getPatternAmpm:function(){var a=[];return o=this._defaults,o.amNames&&$.merge(a,o.amNames),o.pmNames&&$.merge(a,o.pmNames),a=$.map(a,function(a){return a.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+a.join("|")+")?"},_getFormatPositions:function(){var a=this._defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z)/g),b={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(a)for(var c=0;c<a.length;c++)b[a[c].toString().charAt(0)]==-1&&(b[a[c].toString().charAt(0)]=c+1);return b},_injectTimePicker:function(){var a=this.inst.dpDiv,b=this._defaults,c=this,d=(b.hourMax-(b.hourMax-b.hourMin)%b.stepHour).toFixed(0),e=(b.minuteMax-(b.minuteMax-b.minuteMin)%b.stepMinute).toFixed(0),f=(b.secondMax-(b.secondMax-b.secondMin)%b.stepSecond).toFixed(0),g=(b.millisecMax-(b.millisecMax-b.millisecMin)%b.stepMillisec).toFixed(0),h=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,"");if(a.find("div#ui-timepicker-div-"+h).length===0&&b.showTimepicker){var i=' style="display:none;"',j='<div class="ui-timepicker-div" id="ui-timepicker-div-'+h+'"><dl>'+'<dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+h+'"'+(b.showTime?"":i)+">"+b.timeText+"</dt>"+'<dd class="ui_tpicker_time" id="ui_tpicker_time_'+h+'"'+(b.showTime?"":i)+"></dd>"+'<dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+h+'"'+(b.showHour?"":i)+">"+b.hourText+"</dt>",k=0,l=0,m=0,n=0,o;if(b.showHour&&b.hourGrid>0){j+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+h+'"'+(b.showHour?"":i)+"></div>"+'<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var p=b.hourMin;p<=d;p+=parseInt(b.hourGrid,10)){k++;var q=b.ampm&&p>12?p-12:p;q<10&&(q="0"+q),b.ampm&&(p==0?q="12a":p<12?q+="a":q+="p"),j+="<td>"+q+"</td>"}j+="</tr></table></div></dd>"}else j+='<dd class="ui_tpicker_hour" id="ui_tpicker_hour_'+h+'"'+(b.showHour?"":i)+"></dd>";j+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+h+'"'+(b.showMinute?"":i)+">"+b.minuteText+"</dt>";if(b.showMinute&&b.minuteGrid>0){j+='<dd class="ui_tpicker_minute ui_tpicker_minute_'+b.minuteGrid+'">'+'<div id="ui_tpicker_minute_'+h+'"'+(b.showMinute?"":i)+"></div>"+'<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var r=b.minuteMin;r<=e;r+=parseInt(b.minuteGrid,10))l++,j+="<td>"+(r<10?"0":"")+r+"</td>";j+="</tr></table></div></dd>"}else j+='<dd class="ui_tpicker_minute" id="ui_tpicker_minute_'+h+'"'+(b.showMinute?"":i)+"></dd>";j+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+h+'"'+(b.showSecond?"":i)+">"+b.secondText+"</dt>";if(b.showSecond&&b.secondGrid>0){j+='<dd class="ui_tpicker_second ui_tpicker_second_'+b.secondGrid+'">'+'<div id="ui_tpicker_second_'+h+'"'+(b.showSecond?"":i)+"></div>"+'<div style="padding-left: 1px"><table><tr>';for(var s=b.secondMin;s<=f;s+=parseInt(b.secondGrid,10))m++,j+="<td>"+(s<10?"0":"")+s+"</td>";j+="</tr></table></div></dd>"}else j+='<dd class="ui_tpicker_second" id="ui_tpicker_second_'+h+'"'+(b.showSecond?"":i)+"></dd>";j+='<dt class="ui_tpicker_millisec_label" id="ui_tpicker_millisec_label_'+h+'"'+(b.showMillisec?"":i)+">"+b.millisecText+"</dt>";if(b.showMillisec&&b.millisecGrid>0){j+='<dd class="ui_tpicker_millisec ui_tpicker_millisec_'+b.millisecGrid+'">'+'<div id="ui_tpicker_millisec_'+h+'"'+(b.showMillisec?"":i)+"></div>"+'<div style="padding-left: 1px"><table><tr>';for(var t=b.millisecMin;t<=g;t+=parseInt(b.millisecGrid,10))n++,j+="<td>"+(t<10?"0":"")+s+"</td>";j+="</tr></table></div></dd>"}else j+='<dd class="ui_tpicker_millisec" id="ui_tpicker_millisec_'+h+'"'+(b.showMillisec?"":i)+"></dd>";j+='<dt class="ui_tpicker_timezone_label" id="ui_tpicker_timezone_label_'+h+'"'+(b.showTimezone?"":i)+">"+b.timezoneText+"</dt>",j+='<dd class="ui_tpicker_timezone" id="ui_tpicker_timezone_'+h+'"'+(b.showTimezone?"":i)+"></dd>",j+="</dl></div>",$tp=$(j),b.timeOnly===!0&&($tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+b.timeOnlyTitle+"</div>"+"</div>"),a.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),this.hour_slider=$tp.find("#ui_tpicker_hour_"+h).slider({orientation:"horizontal",value:this.hour,min:b.hourMin,max:d,step:b.stepHour,slide:function(a,b){c.hour_slider.slider("option","value",b.value),c._onTimeChange()}}),this.minute_slider=$tp.find("#ui_tpicker_minute_"+h).slider({orientation:"horizontal",value:this.minute,min:b.minuteMin,max:e,step:b.stepMinute,slide:function(a,b){c.minute_slider.slider("option","value",b.value),c._onTimeChange()}}),this.second_slider=$tp.find("#ui_tpicker_second_"+h).slider({orientation:"horizontal",value:this.second,min:b.secondMin,max:f,step:b.stepSecond,slide:function(a,b){c.second_slider.slider("option","value",b.value),c._onTimeChange()}}),this.millisec_slider=$tp.find("#ui_tpicker_millisec_"+h).slider({orientation:"horizontal",value:this.millisec,min:b.millisecMin,max:g,step:b.stepMillisec,slide:function(a,b){c.millisec_slider.slider("option","value",b.value),c._onTimeChange()}}),this.timezone_select=$tp.find("#ui_tpicker_timezone_"+h).append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(b.timezoneList,function(a,b){return $("<option />").val(typeof a=="object"?a.value:a).text(typeof a=="object"?a.label:a)})),this.timezone_select.val(typeof this.timezone!="undefined"&&this.timezone!=null&&this.timezone!=""?this.timezone:b.timezone),this.timezone_select.change(function(){c._onTimeChange()}),b.showHour&&b.hourGrid>0&&(o=100*k*b.hourGrid/(d-b.hourMin),$tp.find(".ui_tpicker_hour table").css({width:o+"%",marginLeft:o/(-2*k)+"%",borderCollapse:"collapse"}).find("td").each(function(a){$(this).click(function(){var a=$(this).html();if(b.ampm){var d=a.substring(2).toLowerCase(),e=parseInt(a.substring(0,2),10);d=="a"?e==12?a=0:a=e:e==12?a=12:a=e+12}c.hour_slider.slider("option","value",a),c._onTimeChange(),c._onSelectHandler()}).css({cursor:"pointer",width:100/k+"%",textAlign:"center",overflow:"hidden"})})),b.showMinute&&b.minuteGrid>0&&(o=100*l*b.minuteGrid/(e-b.minuteMin),$tp.find(".ui_tpicker_minute table").css({width:o+"%",marginLeft:o/(-2*l)+"%",borderCollapse:"collapse"}).find("td").each(function(a){$(this).click(function(){c.minute_slider.slider("option","value",$(this).html()),c._onTimeChange(),c._onSelectHandler()}).css({cursor:"pointer",width:100/l+"%",textAlign:"center",overflow:"hidden"})})),b.showSecond&&b.secondGrid>0&&$tp.find(".ui_tpicker_second table").css({width:o+"%",marginLeft:o/(-2*m)+"%",borderCollapse:"collapse"}).find("td").each(function(a){$(this).click(function(){c.second_slider.slider("option","value",$(this).html()),c._onTimeChange(),c._onSelectHandler()}).css({cursor:"pointer",width:100/m+"%",textAlign:"center",overflow:"hidden"})}),b.showMillisec&&b.millisecGrid>0&&$tp.find(".ui_tpicker_millisec table").css({width:o+"%",marginLeft:o/(-2*n)+"%",borderCollapse:"collapse"}).find("td").each(function(a){$(this).click(function(){c.millisec_slider.slider("option","value",$(this).html()),c._onTimeChange(),c._onSelectHandler()}).css({cursor:"pointer",width:100/n+"%",textAlign:"center",overflow:"hidden"})});var u=a.find(".ui-datepicker-buttonpane");u.length?u.before($tp):a.append($tp),this.$timeObj=$tp.find("#ui_tpicker_time_"+h);if(this.inst!==null){var v=this.timeDefined;this._onTimeChange(),this.timeDefined=v}var w=function(){c._onSelectHandler()};this.hour_slider.bind("slidestop",w),this.minute_slider.bind("slidestop",w),this.second_slider.bind("slidestop",w),this.millisec_slider.bind("slidestop",w)}},_limitMinMaxDateTime:function(a,b){var c=this._defaults,d=new Date(a.selectedYear,a.selectedMonth,a.selectedDay);if(!this._defaults.showTimepicker)return;if($.datepicker._get(a,"minDateTime")!==null&&$.datepicker._get(a,"minDateTime")!==undefined&&d){var e=$.datepicker._get(a,"minDateTime"),f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null)this.hourMinOriginal=c.hourMin,this.minuteMinOriginal=c.minuteMin,this.secondMinOriginal=c.secondMin,this.millisecMinOriginal=c.millisecMin;a.settings.timeOnly||f.getTime()==d.getTime()?(this._defaults.hourMin=e.getHours(),this.hour>this._defaults.hourMin?(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal):(this.hour=this._defaults.hourMin,this._defaults.minuteMin=e.getMinutes(),this.minute>this._defaults.minuteMin?this.second>this._defaults.secondMin?(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal):(this.second=this._defaults.secondMin,this._defaults.millisecMin=e.getMilliseconds()):(this.minute=this._defaults.minuteMin,this._defaults.secondMin=e.getSeconds()))):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if($.datepicker._get(a,"maxDateTime")!==null&&$.datepicker._get(a,"maxDateTime")!==undefined&&d){var g=$.datepicker._get(a,"maxDateTime"),h=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null)this.hourMaxOriginal=c.hourMax,this.minuteMaxOriginal=c.minuteMax,this.secondMaxOriginal=c.secondMax,this.millisecMaxOriginal=c.millisecMax;a.settings.timeOnly||h.getTime()==d.getTime()?(this._defaults.hourMax=g.getHours(),this.hour<this._defaults.hourMax?(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal):(this.hour=this._defaults.hourMax,this._defaults.minuteMax=g.getMinutes(),this.minute<this._defaults.minuteMax?this.second<this._defaults.secondMax?(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal):(this.second=this._defaults.secondMax,this._defaults.millisecMax=g.getMilliseconds()):(this.minute=this._defaults.minuteMax,this._defaults.secondMax=g.getSeconds()))):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(b!==undefined&&b===!0){var i=(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour).toFixed(0),j=(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute).toFixed(0),k=(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond).toFixed(0),l=(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec).toFixed(0);this.hour_slider&&this.hour_slider.slider("option",{min:this._defaults.hourMin,max:i}).slider("value",this.hour),this.minute_slider&&this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:j}).slider("value",this.minute),this.second_slider&&this.second_slider.slider("option",{min:this._defaults.secondMin,max:k}).slider("value",this.second),this.millisec_slider&&this.millisec_slider.slider("option",{min:this._defaults.millisecMin,max:l}).slider("value",this.millisec)}},_onTimeChange:function(){var a=this.hour_slider?this.hour_slider.slider("value"):!1,b=this.minute_slider?this.minute_slider.slider("value"):!1,c=this.second_slider?this.second_slider.slider("value"):!1,d=this.millisec_slider?this.millisec_slider.slider("value"):!1,e=this.timezone_select?this.timezone_select.val():!1,f=this._defaults;typeof a=="object"&&(a=!1),typeof b=="object"&&(b=!1),typeof c=="object"&&(c=!1),typeof d=="object"&&(d=!1),typeof e=="object"&&(e=!1),a!==!1&&(a=parseInt(a,10)),b!==!1&&(b=parseInt(b,10)),c!==!1&&(c=parseInt(c,10)),d!==!1&&(d=parseInt(d,10));var g=f[a<12?"amNames":"pmNames"][0],h=a!=this.hour||b!=this.minute||c!=this.second||d!=this.millisec||this.ampm.length>0&&a<12!=($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||e!=this.timezone;h&&(a!==!1&&(this.hour=a),b!==!1&&(this.minute=b),c!==!1&&(this.second=c),d!==!1&&(this.millisec=d),e!==!1&&(this.timezone=e),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),f.ampm&&(this.ampm=g),this._formatTime(),this.$timeObj&&this.$timeObj.text(this.formattedTime+f.timeSuffix),this.timeDefined=!0,h&&this._updateDateTime()},_onSelectHandler:function(){var a=this._defaults.onSelect,b=this.$input?this.$input[0]:null;a&&b&&a.apply(b,[this.formattedDateTime,this])},_formatTime:function(a,b,c){c==undefined&&(c=this._defaults.ampm),a=a||{hour:this.hour,minute:this.minute,second:this.second,millisec:this.millisec,ampm:this.ampm,timezone:this.timezone};var d=(b||this._defaults.timeFormat).toString(),e=parseInt(a.hour,10);c&&(!$.inArray(a.ampm.toUpperCase(),this.amNames)!==-1&&(e%=12),e===0&&(e=12)),d=d.replace(/(?:hh?|mm?|ss?|[tT]{1,2}|[lz])/g,function(b){switch(b.toLowerCase()){case"hh":return("0"+e).slice(-2);case"h":return e;case"mm":return("0"+a.minute).slice(-2);case"m":return a.minute;case"ss":return("0"+a.second).slice(-2);case"s":return a.second;case"l":return("00"+a.millisec).slice(-3);case"z":return a.timezone;case"t":case"tt":if(c){var d=a.ampm;return b.length==1&&(d=d.charAt(0)),b.charAt(0)=="T"?d.toUpperCase():d.toLowerCase()}return""}});if(arguments.length)return d;this.formattedTime=d},_updateDateTime:function(a){a=this.inst||a,dt=new Date(a.selectedYear,a.selectedMonth,a.selectedDay),dateFmt=$.datepicker._get(a,"dateFormat"),formatCfg=$.datepicker._getFormatConfig(a),timeAvailable=dt!==null&&this.timeDefined,this.formattedDate=$.datepicker.formatDate(dateFmt,dt===null?new Date:dt,formatCfg);var b=this.formattedDate;if(a.lastVal!==undefined&&a.lastVal.length>0&&this.$input.val().length===0)return;this._defaults.timeOnly===!0?b=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||timeAvailable)&&(b+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=b,this._defaults.showTimepicker?this.$altInput&&this._defaults.altFieldTimeOnly===!0?(this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate)):this.$altInput?(this.$altInput.val(b),this.$input.val(b)):this.$input.val(b):this.$input.val(this.formattedDate),this.$input.trigger("change")}}),$.fn.extend({timepicker:function(a){a=a||{};var b=arguments;return typeof a=="object"&&(b[0]=$.extend(a,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),b)})},datetimepicker:function(a){a=a||{};var b=this,c=arguments;return typeof a=="string"?a=="getDate"?$.fn.datepicker.apply($(this[0]),c):this.each(function(){var a=$(this);a.datepicker.apply(a,c)}):this.each(function(){var b=$(this);b.datepicker($.timepicker._newInst(b,a)._defaults)})}}),$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(a,b){var c=this._getInst($(a)[0]),d=this._get(c,"timepicker");d?(d._limitMinMaxDateTime(c,!0),c.inline=c.stay_open=!0,this._base_selectDate(a,b),c.inline=c.stay_open=!1,this._notifyChange(c),this._updateDatepicker(c)):this._base_selectDate(a,b)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(a){var b=a.input[0];if($.datepicker._curInst&&$.datepicker._curInst!=a&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=b)return;if(typeof a.stay_open!="boolean"||a.stay_open===!1){this._base_updateDatepicker(a);var c=this._get(a,"timepicker");c&&c._addTimePicker(a)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(a){var b=$.datepicker._getInst(a.target),c=$.datepicker._get(b,"timepicker");if(c&&$.datepicker._get(b,"constrainInput")){var d=c._defaults.ampm,e=$.datepicker._possibleChars($.datepicker._get(b,"dateFormat")),f=c._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,d?"APM":"").replace(/Tt/g,d?"AaPpMm":"").replace(/tT/g,d?"AaPpMm":"").replace(/T/g,d?"AP":"").replace(/tt/g,d?"apm":"").replace(/t/g,d?"ap":"")+" "+c._defaults.separator+c._defaults.timeSuffix+(c._defaults.showTimezone?c._defaults.timezoneList.join(""):"")+c._defaults.amNames.join("")+c._defaults.pmNames.join("")+e,g=String.fromCharCode(a.charCode===undefined?a.keyCode:a.charCode);return a.ctrlKey||g<" "||!e||f.indexOf(g)>-1}return $.datepicker._base_doKeyPress(a)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(a){var b=$.datepicker._getInst(a.target),c=$.datepicker._get(b,"timepicker");if(c&&c._defaults.timeOnly&&b.input.val()!=b.lastVal)try{$.datepicker._updateDatepicker(b)}catch(d){$.datepicker.log(d)}return $.datepicker._base_doKeyUp(a)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(a){var b=this._getInst($(a)[0]),c=b.dpDiv;this._base_gotoToday(a);var d=new Date,e=this._get(b,"timepicker");if(e._defaults.showTimezone&&e.timezone_select){var f=d.getTimezoneOffset(),g=f>0?"-":"+";f=Math.abs(f);var h=f%60;f=g+("0"+(f-h)/60).slice(-2)+("0"+h).slice(-2),e._defaults.timezoneIso8609&&(f=f.substring(0,3)+":"+f.substring(3)),e.timezone_select.val(f)}this._setTime(b,d),$(".ui-datepicker-today",c).click()},$.datepicker._disableTimepickerDatepicker=function(a,b,c){var d=this._getInst(a),e=this._get(d,"timepicker");$(a).datepicker("getDate"),e&&(e._defaults.showTimepicker=!1,e._updateDateTime(d))},$.datepicker._enableTimepickerDatepicker=function(a,b,c){var d=this._getInst(a),e=this._get(d,"timepicker");$(a).datepicker("getDate"),e&&(e._defaults.showTimepicker=!0,e._addTimePicker(d),e._updateDateTime(d))},$.datepicker._setTime=function(a,b){var c=this._get(a,"timepicker");if(c){var d=c._defaults,e=b?b.getHours():d.hour,f=b?b.getMinutes():d.minute,g=b?b.getSeconds():d.second,h=b?b.getMilliseconds():d.millisec;if(e<d.hourMin||e>d.hourMax||f<d.minuteMin||f>d.minuteMax||g<d.secondMin||g>d.secondMax||h<d.millisecMin||h>d.millisecMax)e=d.hourMin,f=d.minuteMin,g=d.secondMin,h=d.millisecMin;c.hour=e,c.minute=f,c.second=g,c.millisec=h,c.hour_slider&&c.hour_slider.slider("value",e),c.minute_slider&&c.minute_slider.slider("value",f),c.second_slider&&c.second_slider.slider("value",g),c.millisec_slider&&c.millisec_slider.slider("value",h),c._onTimeChange(),c._updateDateTime(a)}},$.datepicker._setTimeDatepicker=function(a,b,c){var d=this._getInst(a),e=this._get(d,"timepicker");if(e){this._setDateFromField(d);var f;b&&(typeof b=="string"?(e._parseTime(b,c),f=new Date,f.setHours(e.hour,e.minute,e.second,e.millisec)):f=new Date(b.getTime()),f.toString()=="Invalid Date"&&(f=undefined),this._setTime(d,f))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(a,b){var c=this._getInst(a),d=b instanceof Date?new Date(b.getTime()):b;this._updateDatepicker(c),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(a,d,!0)},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(a,b){var c=this._getInst(a),d=this._get(c,"timepicker");if(d){this._setDateFromField(c,b);var e=this._getDate(c);return e&&d._parseTime($(a).val(),d.timeOnly)&&e.setHours(d.hour,d.minute,d.second,d.millisec),e}return this._base_getDateDatepicker(a,b)},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(a,b,c){var d;try{d=this._base_parseDate(a,b,c)}catch(e){d=this._base_parseDate(a,b.substring(0,b.length-(e.length-e.indexOf(":")-2)),c)}return d},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(a,b,c,d){var e=this._get(a,"timepicker");if(e){if(b)var f=this._base_formatDate(a,b,c,d);return e._updateDateTime(),e.$input.val()}return this._base_formatDate(a)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(a,b,c){var d=this._getInst(a),e=this._get(d,"timepicker");if(e){var f,g,h;typeof b=="string"?b==="minDate"||b==="minDateTime"?f=c:b==="maxDate"||b==="maxDateTime"?g=c:b==="onSelect"&&(h=c):typeof b=="object"&&(b.minDate?f=b.minDate:b.minDateTime?f=b.minDateTime:b.maxDate?g=b.maxDate:b.maxDateTime&&(g=b.maxDateTime)),f?(f==0?f=new Date:f=new Date(f),e._defaults.minDate=f,e._defaults.minDateTime=f):g?(g==0?g=new Date:g=new Date(g),e._defaults.maxDate=g,e._defaults.maxDateTime=g):h&&(e._defaults.onSelect=h)}this._base_optionDatepicker(a,b,c)},$.timepicker=new Timepicker,$.timepicker.version="0.9.7"})(jQuery)}),define("tau/ui/behaviour/date/ui.behaviour.dateEditor",["Underscore","jQuery","tau/core/tau","tau/configurator","libs/jquery/jquery.ui.timepicker"],function(a,b,c,d){b.widget("ui.dateEditor",{options:{widgetName:"datepicker",onSave:function(){},validation:{required:!1},dateFormat:"m/dd/yy"},errors:[],_create:function(){this.init()},init:function(){var a=b(this.element);this.$element=a,a.click(b.proxy(this.showEditor,this)),a.addClass("ui-dateeditor-source")},setValidationErrors:function(b){this.element.addClass("ui-validationerror"),a.isString(b)&&this.element.attr("title",b)},resetValidationErrors:function(a){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title",a)},activate:function(){this._justActivated=!0,this.showEditor(),this.$editor.find(":text").focus()},_attachKeyBoardHandling:function(){var a=this,b={handleKeyDown:function(){a.mapKeys.apply(a,arguments)}};d.getKeyBoardManager().pushHandler(b)},showEditor:function(a){var d=this;if(!this._editorIsVisible){if(!this.$editor){var e=b(c.concat('<span class="ui-dateeditor">','    <input type="text" maxlength="20" />',"</span>")),f=e.find(":text");f.focus();var g=b("body"),h=function(a){d._onDocumentClick.apply(d,arguments),g.unbind("click",h)},i=function(){g.click(h)};f[this.options.widgetName]({showButtonPanel:!1,dateFormat:this.options.dateFormat,buttonText:"choose",showOn:"button",beforeShow:i,onSelect:function(a){f.focus()}}),e.insertAfter(this.$element),this.$editor=e}this._attachKeyBoardHandling(),d._documentClickDelegate||(d._documentClickDelegate=function(a){d._onDocumentClick(a)},b(document.body).click(d._documentClickDelegate)),this.$element.hide(),this._editorIsVisible=!0,this.$editor.show(),this.$editor.find(":text").val(this.$element.text())}},trimString:function(a){return(a||"").trim()},_getDefaultValue:function(){return this.options.date||this.element.text()},_onSave:function(){var a=this.$editor.find(":text").val(),b={value:a};(this.options.beforeChange||function(){})(b),a=b.value,this.hideEditor(),this.$element.show();var c=this._getDefaultValue();this.trimString(c)!=this.trimString(a)&&this.options.onSave(a),this.$element.text(a),d.getKeyBoardManager().popHandler()},_onCancel:function(){d.getKeyBoardManager().popHandler();var a=this.$editor.find(":text").val();this.hideEditor(),this.$element.show(),this.options.onCancel&&this.options.onCancel()},hideEditor:function(){this.$editor&&this._editorIsVisible&&(this.$editor.hide(),this._editorIsVisible=!1),this._documentClickDelegate&&(b(document.body).unbind("click",this._documentClickDelegate),delete this._documentClickDelegate)},_onDocumentClick:function(a){var c=this,d=b(a.target);if(!this._editorIsVisible)return;if(this._justActivated&&a.target!=document.body){this._justActivated=!1;return}if(d.hasClass("ui-dateeditor-source")||d.hasClass("ui-dateeditor")||d.parents(".ui-dateeditor").length>0||d.parents(".ui-datepicker").length>0||d.parents(".ui-datepicker-calendar").length>0||d.parents(".ui-datepicker-header").length>0)return;c._onSave(),c.hideEditor(),a.stopPropagation(),a.preventDefault()},destroy:function(){this.hideEditor();var a=this.$editor;if(a){var b=a.find(":text");b[this.options.widgetName]("destroy"),a.remove()}},mapKeys:function(a){switch(a.which){case 13:a.preventDefault(),this._onSave();break;case 27:a.preventDefault(),this._onCancel()}}})}),define("tau/components/extensions/customField/extension.customField.date.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(a,b,c,d){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var c=this,e=a.afterRender.data.data,f=a.permissionsReady.data;if(f.editable){var g=a.afterRender.data.element,h=g.find(".ui-customfield__value");h.addClass("editableText"),this.$widget=h,b.datepicker.parseDate=function(a,b,c){return d.parse(b)},b.datepicker.formatDate=function(a,b,c){return d.formatAs(b,a)};var i=d.getFormatData().date.short;h.dateEditor({dateFormat:i,onSave:function(a){c.bus.fire("save",{customFields:[{name:e.name,value:a}]})}}),g.behaviourCustomFieldRow({onActivate:function(){h.dateEditor("activate"),h.focus()}}),g.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.dateEditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/ui/extensions/customField/ui.extension.customField.editable",["tau/components/extensions/component.extension.base"],function(a){var b=a.extend({"bus afterRender":function(a){this.element=a.data.element},"bus preRefreshRow":function(a){this.element.tauOverlay(),this.fire("markElementToBeUpdated",{element:this.element})},"bus refreshRow":function(a){this.element.parents(".tmpl-container-list:first").tauOverlay("hide");var b=this;this.on("afterRender",function(a){a.removeListener(),b.fire("updateElement",{element:b.element})}),this.fire("refresh")}});return b}),define("tau/ui/templates/customField/ui.template.customField.date",["tau/core/templates-factory"],function(a){var b={name:"customField-date",markup:['<div class="ui-customfield {{if !value.text}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value">${value.text}</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/components/component.customField.date",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.date.editable","tau/components/extensions/customField/extension.customField.date.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.date"],function(a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:f,extensions:[c,d,e]};return a.create(h,g)}}}),define("tau/ui/behaviour/customField/ui.behaviour.customField.row",["Underscore","jQuery"],function(a,b){b.widget("ui.behaviourCustomFieldRow",{options:{onActivate:b.noop},_create:function(){var a=this.element;this.$element=a;var b=this;a.click(function(a){a.preventDefault(),b.options.onActivate.call(this,a)})},setValidationErrors:function(b){var c=this.$element;a.each(b,function(a,b){c.find("[name="+b+"]").addClass("ui-editableText-validationerror").attr("title",a)})},resetValidationErrors:function(a){this.$element.find(":text").removeClass("ui-editableText-validationerror").attr("title",null)},setValue:function(b){var c=this.$element;a.each(b,function(a,b){c.find("[name="+b+"]").val(a)})},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.url.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");this.$widget=f,e.find(".ui-customfield__label").behaviourCustomFieldRow({}),e.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/templates/customField/ui.template.customField.dropdown",["tau/core/templates-factory"],function(a){var b={name:"customField-dropdown",markup:['<div class="ui-customfield ui-customfield-dropdown {{if !value}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value">${value}</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/components/component.customField.dropdown",["Underscore","tau/components/component.creator","tau/models/model.customField","tau/models/model.customField.editable","tau/ui/extensions/popupEditorContainer.extension","tau/components/extensions/component.creator.extension","tau/components/extensions/customField/extension.customField.url.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.dropdown"],function(a,b,c,d,e,f,g,h,i){return{create:function(j){var k={ModelType:c,extensions:[d,g,h,f,{type:e,config:{onCreate:function(b){a(b.config).extend({popupEditorContainer:[{targetSelector:"tr",alignmentSelector:".ui-customfield__value",component:{type:"customField.dropdown.list"}}]})}}}],template:i};return b.create(k,j)}}}),define("tau/models/customField/model.customField.dropdown.editable",["Underscore","tau/models/model.customField.editable"],function(a,b){var c=b.extend({onInit:function(){if(this.config.data){var b=this.config.data.value,c=[];a.map(this.config.data.options,function(a){b!==a&&c.push({id:a,name:a})});var d=b?!this.config.data.required:!1;this.fire("dataBind",{states:c,nullableValue:d})}},"bus updateState":function(a){var b=null;a.data&&a.data.id&&(b=a.data.id);var c={customFields:[{name:this.config.data.name,value:b}]};this.fire("save",c)}});return c}),define("libs/underscore/underscore.string",["Underscore"],function(a){(function(b){if(typeof a!="undefined")var c=a().reverse,d=a.include;var e=String.prototype.trim,f=function(a){return a*1||0},g=function(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")},h=function(a){return Array.prototype.slice.call(a)},i=function(a){return a?l.escapeRegExp(a):"\\s"},j=function(a){return function(){var b=h(arguments);for(var c=0;c<b.length;c++)b[c]=b[c]==null?"":""+b[c];return a.apply(null,b)}},k=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var b=g,c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var e=1,f=c.length,g="",h,i=[],j,l,m,n,o,p;for(j=0;j<f;j++){g=a(c[j]);if(g==="string")i.push(c[j]);else if(g==="array"){m=c[j];if(m[2]){h=d[e];for(l=0;l<m[2].length;l++){if(!h.hasOwnProperty(m[2][l]))throw k('[_.sprintf] property "%s" does not exist',m[2][l]);h=h[m[2][l]]}}else m[1]?h=d[m[1]]:h=d[e++];if(/[^s]/.test(m[8])&&a(h)!="number")throw k("[_.sprintf] expecting number but found %s",a(h));switch(m[8]){case"b":h=h.toString(2);break;case"c":h=String.fromCharCode(h);break;case"d":h=parseInt(h,10);break;case"e":h=m[7]?h.toExponential(m[7]):h.toExponential();break;case"f":h=m[7]?parseFloat(h).toFixed(m[7]):parseFloat(h);break;case"o":h=h.toString(8);break;case"s":h=(h=String(h))&&m[7]?h.substring(0,m[7]):h;break;case"u":h=Math.abs(h);break;case"x":h=h.toString(16);break;case"X":h=h.toString(16).toUpperCase()}h=/[def]/.test(m[8])&&m[3]&&h>=0?"+"+h:h,o=m[4]?m[4]=="0"?"0":m[4].charAt(1):" ",p=m[6]-String(h).length,n=m[6]?b(o,p):"",i.push(m[5]?h+n:n+h)}}return i.join("")},c.cache={},c.parse=function(a){var b=a,c=[],d=[],e=0;while(b){if((c=/^[^\x25]+/.exec(b))!==null)d.push(c[0]);else if((c=/^\x25{2}/.exec(b))!==null)d.push("%");else{if((c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b))===null)throw"[_.sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if((h=/^([a-z_][a-z_\d]*)/i.exec(g))===null)throw"[_.sprintf] huh?";f.push(h[1]);while((g=g.substring(h[0].length))!=="")if((h=/^\.([a-z_][a-z_\d]*)/i.exec(g))!==null)f.push(h[1]);else if((h=/^\[(\d+)\]/.exec(g))!==null)f.push(h[1]);else throw"[_.sprintf] huh?";c[2]=f}else e|=2;if(e===3)throw"[_.sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d},c}(),l={isBlank:j(function(a){return/^\s*$/.test(a)}),stripTags:j(function(a){return a.replace(/<\/?[^>]+>/ig,"")}),capitalize:j(function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()}),chop:j(function(a,b){b=f(b)||a.length;var c=[];for(var d=0;d<a.length;)c.push(a.slice(d,d+b)),d+=b;return c}),clean:j(function(a){return l.strip(a.replace(/\s+/g," "))}),count:j(function(a,b){var c=0,d;for(var e=0;e<a.length;)d=a.indexOf(b,e),d>=0&&c++,e=e+(d<0?0:d)+b.length;return c}),chars:j(function(a){return a.split("")}),escapeHTML:j(function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),unescapeHTML:j(function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),escapeRegExp:j(function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")}),insert:j(function(a,b,c){var d=a.split("");return d.splice(f(b),0,c),d.join("")}),includes:j(function(a,b){return a.indexOf(b)!==-1}),include:function(a,b){return!d||/string|number/.test(typeof a)?this.includes(a,b):d(a,b)},join:j(function(a){var b=h(arguments);return b.join(b.shift())}),lines:j(function(a){return a.split("\n")}),reverse:function(b){return!c||/string|number/.test(typeof b)?Array.prototype.reverse.apply(String(b).split("")).join(""):c.call(a(b))},splice:j(function(a,b,c,d){var e=a.split("");return e.splice(f(b),f(c),d),e.join("")}),startsWith:j(function(a,b){return a.length>=b.length&&a.substring(0,b.length)===b}),endsWith:j(function(a,b){return a.length>=b.length&&a.substring(a.length-b.length)===b}),succ:j(function(a){var b=a.split("");return b.splice(a.length-1,1,String.fromCharCode(a.charCodeAt(a.length-1)+1)),b.join("")}),titleize:j(function(a){var b=a.split(" "),c;for(var d=0;d<b.length;d++)c=b[d].split(""),typeof c[0]!="undefined"&&(c[0]=c[0].toUpperCase()),d+1===b.length?b[d]=c.join(""):b[d]=c.join("")+" ";return b.join("")}),camelize:j(function(a){return l.trim(a).replace(/(\-|_|\s)+(.)?/g,function(a,b,c){return c?c.toUpperCase():""})}),underscored:function(a){return l.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-|\s+/g,"_").toLowerCase()},dasherize:function(a){return l.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/^([A-Z]+)/,"-$1").replace(/\_|\s+/g,"-").toLowerCase()},trim:j(function(a,b){return!b&&e?e.call(a):(b=i(b),a.replace(new RegExp("^["+b+"]+|["+b+"]+$","g"),""))}),ltrim:j(function(a,b){return b=i(b),a.replace(new RegExp("^["+b+"]+","g"),"")}),rtrim:j(function(a,b){return b=i(b),a.replace(new RegExp("["+b+"]+$","g"),"")}),truncate:j(function(a,b,c){return c=c||"...",b=f(b),a.length>b?a.slice(0,b)+c:a}),prune:j(function(a,b,c){c=c||"...",b=f(b);var d="";return a.substring(b-1,b+1).search(/^\w\w$/)===0?d=l.rtrim(a.slice(0,b).replace(/([\W][\w]*)$/,"")):d=l.rtrim(a.slice(0,b)),d=d.replace(/\W+$/,""),d.length+c.length>a.length?a:d+c}),words:function(a,b){return String(a).split(b||" ")},pad:j(function(a,b,c,d){var e="",h=0;b=f(b),c?c.length>1&&(c=c.charAt(0)):c=" ";switch(d){case"right":h=b-a.length,e=g(c,h),a+=e;break;case"both":h=b-a.length,e={left:g(c,Math.ceil(h/2)),right:g(c,Math.floor(h/2))},a=e.left+a+e.right;break;default:h=b-a.length,e=g(c,h),a=e+a}return a}),lpad:function(a,b,c){return l.pad(a,b,c)},rpad:function(a,b,c){return l.pad(a,b,c,"right")},lrpad:function(a,b,c){return l.pad(a,b,c,"both")},sprintf:k,vsprintf:function(a,b){return b.unshift(a),k.apply(null,b)},toNumber:function(a,b){var c=f(f(a).toFixed(f(b)));return c!==0||a==="0"||a===0?c:Number.NaN},strRight:j(function(a,b){var c=b?a.indexOf(b):-1;return c!=-1?a.slice(c+b.length,a.length):a}),strRightBack:j(function(a,b){var c=b?a.lastIndexOf(b):-1;return c!=-1?a.slice(c+b.length,a.length):a}),strLeft:j(function(a,b){var c=b?a.indexOf(b):-1;return c!=-1?a.slice(0,c):a}),strLeftBack:j(function(a,b){var c=a.lastIndexOf(b);return c!=-1?a.slice(0,c):a})};l.strip=l.trim,l.lstrip=l.ltrim,l.rstrip=l.rtrim,l.center=l.lrpad,l.ljust=l.lpad,l.rjust=l.rpad,a.mixin(l)})(this||window)}),define("tau/utils/utils.textsearch",["Underscore","tau/core/class","libs/underscore/underscore.string"],function(a,b){var c=b.extend({data:[],load:function(b){var c=this;a.forEach(b,function(a){a.normalizeData=c._normalize(a.data)}),this.data=b},_createRegex:function(b){var c=a.trim(b);c=c.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),c=c.replace(/[ ]+/g,"([-[\\]{}()*+?.,\\\\^$|#:;! ]+|\\s+|\\s+[ \\S]*?\\s+)");var d=new RegExp(c,"i");return d},_normalize:function(b){return a.trim(b)},search:function(b){var c=[],d=this._createRegex(b);return a.forEach(this.data,function(a){var b=a.normalizeData,e=b.match(d);if(e){var f={_id:a._id,data:a.data,entry:{from:e.index,len:e[0].length}};c.push(f)}}),c},match:function(a,b){var c=null,d=this._normalize(a).match(this._createRegex(b));return d&&(c={from:d.index,len:d[0].length}),c}});return c}),define("tau/ui/behaviour/common/ui.behaviour.listSelectable",["Underscore","jQuery","tau/configurator"],function(a,b,c){b.widget("ui.listSelectable",{_create:function(){},_handler:function(a){},enable:function(){if(this._enabled)return;this._enabled=!0;var a=this.element.parents(".ui-drop-down:first").find(".filter-field-wrapper :text");a.length&&a.focus();var d=this;this.reset();var e=function(a){return a++,a>=d._max&&(a=0),a},f=function(a){return a--,a<0&&(a=d._max-1),a},g=this.$items,h=this.options.className;c.getKeyBoardManager().pushHandler({handleKeyDown:function(a){var c=d._index;switch(a.keyCode){case b.ui.keyCode.DOWN:a.preventDefault(),c=e(c);break;case b.ui.keyCode.UP:a.preventDefault(),c=f(c);break;case b.ui.keyCode.ENTER:a.preventDefault();if(c<0)return;d.$items.eq(c).trigger("click")}d._index=c,d.$items.removeClass(h),c>=0&&d.$items.eq(c).addClass(h),d.$list.animate({scrollTop:d._getOffset(c)},{duration:0})}})},_getOffset:function(a){var b=this.$items.eq(a);if(b.length==0)return 0;var c=b.parents(".i-inner:first").position().top,d=b.position().top,e=b.parent("i-group");e.length&&(d+=e.position().top);var f=-c+d-this.$list.height()/2;return f},reset:function(){this.$items=this.element.find(this.options.items).filter(":visible");var a=this.element;this.$list=a,a.scrollTop(0);var b=a.height();this.step=this.$items.eq(0).height()*.5,this._index=-1,this._max=this.$items.length;var c=this.options.className;this.$items.removeClass(c)},disable:function(){if(!this._enabled)return;this._enabled=!1,c.getKeyBoardManager().popHandler()},destroy:function(){this.disable()}})}),define("tau/ui/extensions/stateList/ui.extension.stateList.editable",["Underscore","jQuery","tau/utils/utils.textsearch","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(a,b,c,d){var e=d.extend({"bus dataBind+afterRender":function(c){this.searchIndex=null;var d=this.config,e=this.element=c.afterRender.data.element,f=this.dataToBind=c.dataBind.data,g=0;a.forEach(f.states,function(a){a.items?g+=a.items.length:g++}),this.$list=e.find(".drop-down-list"),this.$options=this.$list.find(".drop-down-option"),this.$options.click(b.proxy(this.onItemSelected,this)),d.hasOwnProperty("maxHeight")&&this.$list.css("max-height",d.maxHeight).css("overflow-y","auto");var h=b("<div class='drop-down-actions' />"),i=!1;if(f.hasOwnProperty("defaultValue")){i=!0;var j=this.config.defaultValueLabel||"default";b("<span class='action-link default'>"+j+"</span>").click(b.proxy(this.defaultValue,this)).appendTo(h)}this.config.allowToReset=a.isUndefined(this.config.allowToReset)?!0:this.config.allowToReset;if(f.nullableValue&&this.config.allowToReset){i=!0;var k=this.config.clearValueLabel||"reset";b("<span class='action-link clear'>"+k+"</span>").click(b.proxy(this.clearValue,this)).appendTo(h)}i&&h.insertBefore(this.$list);if(f.states.length===0&&f.completed){var l=d.emptyDataMessage||"None";this.$list.append("<span class='empty-message'>"+l+"</span>")}d.filter&&g>3&&(this.filterField=b("<input type='text' class='filter-field' />").keyup(b.proxy(this._filterDelegate,this)),b("<div class='filter-field-wrapper'></div>").append(this.filterField).insertBefore(this.$list));if(d.expandable&&!f.completed){var m=d.mode||"short";if(m!=="full"){var n=b("<div class='drop-down-footer'></div>"),o=this.config.fullModeLabel||"more...";this.$mode=b("<div class='action-link more'>"+o+"</div>").click(b.proxy(this._toggleMode,this)).appendTo(n),n.insertAfter(this.$list)}}this._resize()},"bus focus":function(a){this.element.find(".drop-down-list").listSelectable({items:".drop-down-option:visible",className:"drop-down-option_hover"}),this.element.find(".drop-down-list").listSelectable("enable")},"bus refresh":function(a){this.element.find(".drop-down-list").listSelectable({items:".drop-down-option:visible",className:"drop-down-option_hover"}),this.element.find(".drop-down-list").listSelectable("enable")},"bus blur":function(a){this.element.find(".drop-down-list").listSelectable("disable")},_resize:function(a){if(!this.element)return;var c=this.element,d=c.find(".drop-down-list");d.css("maxHeight",b(window).height()/2*.8),d.css("overflowY","auto"),d.css("overflowX","hidden")},"bus afterRender+popupResize":function(a){this._resize(a.popupResize.data)},"bus popupResize":function(a){this._resize(a.data)},_toggleMode:function(a){a.stopPropagation();var b=this.config.mode==="full"?"short":"full";this.fire("refresh",{mode:b})},clearValue:function(a){a.stopPropagation(),this._updateState(null)},defaultValue:function(a){a.stopPropagation(),this._updateState(this.dataToBind.defaultValue)},onItemSelected:function(a){var c=b(a.target).tmplItem().data;this._updateState(c.id)},_updateState:function(a){var b=!0;this.config.confirmation&&window.confirm&&(b=window.confirm(this.config.confirmation)),b&&this.fire("updateState",{id:a})},_resetList:function(){this.$options.show()},_noResults:function(a){var a='"'+a+'" not found';this.$noResults?this.$noResults.text(a):this.$noResults=b("<div class='not-found' />").text(a).insertBefore(this.$list),this.$noResults.show()},_clearNoResults:function(){this.$noResults&&this.$noResults.hide()},_filterDelegate:function(d){if(d.keyCode==jQuery.ui.keyCode.DOWN||d.keyCode==jQuery.ui.keyCode.UP||d.keyCode==jQuery.ui.keyCode.ENTER)return;if(!this.searchIndex){var e=[];this.searchIndex=new c,this.$options.each(function(a,c){e.push({_id:a,data:b(c).text()}),b(this).data("text",b(c).text())}),this.searchIndex.load(e)}var f=this.filterField.val(),g=this.searchIndex.search(f);this.$options.hide();var h=this.$options;a.forEach(g,function(a){var b=h.eq(a._id),c=b.data("text")+"";c=c.substr(0,a.entry.from)+"<em>"+c.substr(a.entry.from,a.entry.len)+"</em>"+c.substr(a.entry.from+a.entry.len,c.length),b.html(c),b.show(),b.parent().show()}),h.filter(":hidden").parent().not(h.filter(":visible").parent()).hide(),f.length?g.length==0?this._noResults(f):this._clearNoResults():(this._clearNoResults(),this._resetList()),this.element.find(".drop-down-list").listSelectable("reset")}});return e}),define("tau/ui/templates/state/ui.template.state.option",["tau/core/templates-factory"],function(a){var b={name:"state-option",markup:["{{if items}}",'<div class="drop-down-group i-group"><span class="i-group-name">${name}</span>','{{tmpl(items) "state-option"}}',"</div>","{{else}}",'<div class="drop-down-option" {{if description}}title="${description}"{{/if}}>${name}</div>',"{{/if}}"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/state/ui.template.state-list",["tau/core/templates-factory","tau/ui/templates/state/ui.template.state.option"],function(a){var b={name:"state-list",markup:['<div class="ui-drop-down">','    <div class="drop-down-list"><div class="drop-down-list__inner i-inner">{{tmpl(states) "state-option"}}</div></div>',"</div>"],dependencies:["state-option"]};return a.register(b)}),define("tau/components/component.customField.dropdown.list",["tau/components/component.creator","tau/core/model-base","tau/models/customField/model.customField.dropdown.editable","tau/ui/extensions/stateList/ui.extension.stateList.editable","tau/ui/templates/state/ui.template.state-list"],function(a,b,c,d,e){return{create:function(f){var g={ModelType:b,extensions:[c,d],template:e};return a.create(g,f)}}}),define("tau/ui/tags/ui.tag.term",["Underscore","jQuery","tau/core/termProcessor","libs/jquery/jquery.tmpl"],function(a,b,c){return b.extend(b.tmpl.tag,{term:{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while($__t.parent && !$__t.$tau){","$__t = $__t.parent","}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")}}),{register:function(a,b){var d=a.context&&a.context.applicationContext?a.context.applicationContext.processes[0].terms:{};b.$tau=b.$tau||{};var e=new c(d);b.$tau.terms=function(a){return e.getTerms(a)}}}}),define("tau/ui/templates/common/ui.template.entityLink",["tau/core/templates-factory","tau/ui/tags/ui.tag.term"],function(a,b){var c={tags:[b],name:"entity-link",markup:['<a href="#${__type.toLowerCase()}/${id}">','   <em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em>',"</a>&nbsp;"],dependencies:[]};return a.register(c)}),define("tau/ui/templates/customField/ui.template.customField.entity",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(a){var b={name:"customField-entity",markup:['<div class="ui-customfield">',"   <table>","   <tbody>",'   <tr class="{{if !value.id }}ui-customfield_empty_true{{/if}}">','       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container">',"{{if  value.id }}",'{{tmpl(value) "entity-link"}}',"{{/if}}",,'&nbsp;<span class="entity-custom-field-link property-text">${value.name}</span>',,"</td>","   </tr>","   </tbody>","   </table>","</div>"],dependencies:["entity-link"]};return a.register(b)}),define("tau/models/customField/model.customField.entity.editable",["Underscore","tau/models/model.customField.editable"],function(a,b){return b.extend({"bus entitySelected":function(a){var b={},c={name:this.config.data.name,value:null};b.customFields=[c];var d=a.data.entity;d&&d.id&&(c.value={id:d.id}),this.fire("save",{$set:b})}})}),define("tau/components/component.customField.entity",["Underscore","tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.customField","tau/ui/templates/customField/ui.template.customField.entity","tau/ui/extensions/popupEditorContainer.extension","tau/models/customField/model.customField.entity.editable","tau/ui/extensions/customField/ui.extension.customField.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={template:e,extensions:[g,d,f,h,c]};i=i||{};var k={type:"finder",additionalExtensions:[g],fields:["id","name",{project:["id","name","abbreviation"]}],maxHeight:400};return i.customField&&i.customField.required===!0&&(k.resetDisabled=!0),a.extend(i,{popupEditorContainer:[{targetSelector:"tr",targetCssClass:"ui-customfield_editable_true",alignmentSelector:".entity-custom-field-link",component:k}]}),b.create(j,i)}}}),define("tau/models/customField/model.customField.number.editable",["Underscore","tau/models/model.customField.editable","tau/utils/utils.jsonSchema"],function(a,b,c){var d=b.extend({category:"edit",name:"Editable custom field",schema:c.Schema.create({type:"object",properties:{value:{type:"number",optional:!1,minimum:0,maximum:a.MAX_INT,pre:["trim","castTolerantlyToType"],"default":0,fallbacks:{type:"setDefault"}}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.empty,b.validation=this.schema.validate(c)}});return d}),define("tau/components/extensions/customField/extension.customField.number.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.underscore"],function(a,b,c){return c.extend({category:"edit",$widget:null,fieldData:null,"bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");b.$widget=f,f.editableText({mask:"^[0-9]*$",restoreText:!1,onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,value:a}]})}}),e.behaviourCustomFieldRow({onActivate:function(){f.editableText("activate"),f.focus()}}),e.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.editableText("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.editableText("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/ui/templates/customField/ui.template.customField.text",["tau/core/templates-factory"],function(a){var b={name:"customField-text",markup:['<div class="ui-customfield  {{if !value}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value">${value}</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/components/component.customField.number",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.number.editable","tau/components/extensions/customField/extension.customField.number.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.text"],function(a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:f,extensions:[c,d,e]};return a.create(h,g)}}}),define("tau/models/customField/model.customField.richtext.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.htmlConverter"],function(a,b,c){var d=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{optional:!0,empty:!0,maxLength:1e3,type:"string",pre:["trim"]}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];b.validation=this.schema.validate(c)},"bus beforeSave":function(a){var b=a.data.cmd.$set,d=b.customFields[0];d.value=c.fromHtmlToSource(d.value)}});return d}),define("tau/components/extensions/customField/extension.customField.richtext.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data.name,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");b.$widget=f;var g=f.richeditor({placeholder:{text:"Double-click to add content...",className:"ui-description__inner_empty_true"},settings:{toolbar:[["Cut","Copy","Paste","PasteText","PasteFromWord","-","Bold","Italic","Underline","Strike","-","Subscript","Superscript"],["NumberedList","BulletedList","-","Outdent","Indent"],["JustifyLeft","JustifyCenter","JustifyRight"],["Link","Unlink","Anchor"],["Image","Table","HorizontalRule","SpecialChar"],"/",["Source","Format","Font","FontSize"],["Replace","-","RemoveFormat","TextColor","BGColor","-","Templates"],["Maximize"]],extraPlugins:"autogrow,charcount",charcount_limit:1e3},onSave:function(a){b.bus.fire("save",{customFields:[{name:c,value:a}]})}})}},"bus validate":function(){this.$widget.richeditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.richeditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.richeditor("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/ui/templates/customField/ui.template.customField.richtext",["tau/core/templates-factory"],function(a){var b={name:"customField-richtext",markup:['<div class="ui-customfield ui-customfield-richtext">','   <div class="ui-customfield__value value">{{html value}}</div>',"</div>"]};return a.register(b)}),define("tau/components/component.customField.richtext",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.richtext.editable","tau/components/extensions/customField/extension.customField.richtext.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.richtext"],function(a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:f,extensions:[c,d,e]};return a.create(h,g)}}}),define("tau/models/customField/model.customField.text.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"string",optional:!0,maxLength:50,minLength:0,pre:["trim"]}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,b.validation=this.schema.validate(c)}});return c}),define("tau/components/extensions/customField/extension.customField.text.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");b.$widget=f,f.editableText({restoreText:!1,onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,value:a}]})}}),e.behaviourCustomFieldRow({onActivate:function(){f.editableText("activate"),f.focus()}}),e.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.editableText("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.editableText("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/components/component.customField.text",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.text.editable","tau/components/extensions/customField/extension.customField.text.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.text"],function(a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:f,extensions:[c,d,e]};return a.create(h,g)}}}),define("tau/models/customField/model.customField.url.editor",["Underscore","tau/models/model.customField"],function(a,b){var c=b.extend({_beforeSave:function(a){return!0},_afterSave:function(a){return!0}});return c}),define("tau/models/customField/model.customField.url.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"object",optional:!1,properties:{label:{type:"string",optional:!1,maxLength:30,pre:["trim"]},url:{type:"string",optional:!1,pattern:b.PATTERN_URL,pre:["trim",function(a){return a.length==0&&this.schema.optional&&(this._wasError=1),a}]}},post:function(a){if(a.label==0||a.url==0)a={label:null,url:null};return a}}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0],d=this.config.customField||this.config.data;this.schema.properties.value.properties.label.optional=!d.required,this.schema.properties.value.properties.label.empty=!d.required,this.schema.properties.value.properties.url.optional=!d.required,this.schema.properties.value.properties.url.empty=!d.required,b.validation=this.schema.validate(c)}});return c}),define("tau/models/customField/model.customField.url.editable.editor",["tau/models/customField/model.customField.url.editable"],function(a,b){var c=a.extend({onInit:function(){this.beforeSaveHandler=!0,this.afterSaveHandler=!0,this.config.data&&this.fire("dataBind",this.config.data)}});return c}),define("tau/ui/behaviour/customField/ui.behaviour.customField.url.editor",["Underscore","jQuery"],function(a,b){b.widget("ui.behaviourUrlEditor",{options:{onSave:b.noop},_create:function(){var b=this.element;this.$element=b;var c=this;b.find(":button:first").click(function(b){b.preventDefault(),a.bind(c._save,c)()}),b.find(":input").keyup(function(b){b.keyCode==jQuery.ui.keyCode.ENTER&&(b.preventDefault(),a.bind(c._save,c)())})},_save:function(){var a=this.element;this.options.onSave({url:a.find("[name=url]").val(),label:a.find("[name=label]").val()})},setValidationErrors:function(b){var c=this.$element;a.each(b,function(a,b){c.find("[name="+b+"]").addClass("ui-validationerror").attr("title",a)})},resetValidationErrors:function(a){this.$element.find(":text").removeClass("ui-validationerror").attr("title",null)},setValue:function(b){var c=this.$element;a.each(b,function(a,b){c.find("[name="+b+"]").val(a)})},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.url.editor",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.url.editor"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=this.config.data||a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element;this.$widget=e,e.find("[name=url]").val(c.value.url),e.find("[name=label]").val(c.value.label),e.behaviourUrlEditor({onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,value:a}]})}}),e.find(":button:eq(1)").click(function(){b.bus.fire("reset")})}},"bus validate":function(){this.$widget.behaviourUrlEditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.behaviourUrlEditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(b){var c={};a.each(b.data.validation.errors,function(b){a.each(["url","label"],function(d){a.indexOf(b.path,d)!==-1&&(c[d]=b.description)})}),this.$widget.behaviourUrlEditor("setValidationErrors",c)}})}),define("tau/ui/templates/customField/ui.template.customField.url.editor",["tau/core/templates-factory"],function(a){var b={name:"customField-url-editor",markup:['<div class="ui-form">','   <div class="ui-form__row"><label for="url">Url</label><input type="text" name="url" /></div>','   <div class="ui-form__row"><label for="label">Description</label><input type="text" name="label" /></div>','   <div class="ui-form__row ui-form__row-controls button-group"><input type="button" value="save" class="button" /><input type="button" value="cancel" class="button" /></div>',"</div>"]};return a.register(b)}),define("tau/components/component.customField.url.editor",["tau/components/component.creator","tau/models/customField/model.customField.url.editor","tau/models/customField/model.customField.url.editable.editor","tau/components/extensions/customField/extension.customField.url.editor","tau/ui/templates/customField/ui.template.customField.url.editor"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[b,c,d],template:e};return a.create(g,f)}}}),define("tau/models/customField/model.customField.url.editable.row",["tau/models/customField/model.customField.url.editable"],function(a,b){var c=a.extend({onInit:function(){var a=this,b=this.config.context,c=b.entity.entityType.name},"bus afterSaveToStore":function(){this.bus.fire("refreshRow",{})}});return c}),define("tau/ui/templates/customField/ui.template.customField.url",["tau/core/templates-factory"],function(a){var b={name:"customField-url",markup:['<div class="ui-customfield ui-customfield-url {{if !value.url}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container">','           <span class="ui-customfield__value popup-target">${value.label}</span>',"           {{if value.label}}",'               <a class="ui-customfield__value-url external-view south url" href="${value.url}" title="${value.url}" target="_blank"></a>',"           {{/if}}","       </td>","   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/components/component.customField.url",["Underscore","tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.url.editable.row","tau/components/extensions/customField/extension.customField.url.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/extensions/popupEditorContainer.extension","tau/components/extensions/component.creator.extension","tau/ui/templates/customField/ui.template.customField.url"],function(a,b,c,d,e,f,g,h,i){return{create:function(j){var k={extensions:[c,d,e,f,h,{type:g,config:{onCreate:function(b){a(b.config).extend({popupEditorContainer:[{targetSelector:"tr",alignmentSelector:".ui-customfield__value",component:{type:"customField.url.editor"}}]})}}}],template:i};return b.create(k,j)}}}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners.details",["tau/core/templates-factory"],function(a){var b={name:"diagnostics.globalListeners.details",markup:['<span class="tau-global-listener ui-link">${name}</span><br/>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners",["tau/core/templates-factory","tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners.details"],function(a){var b={name:"diagnostics.globalListeners",markup:['<div class="tau-diagnostics-globalListeners">',,"<table>",'{{each data}}<tr class="tau-diagnostics-row"><td>${count}</td><td>${name}</td><td>{{tmpl(listeners) "diagnostics.globalListeners.details"}}</td></tr>{{/each}}',"</table>","</div>"],dependencies:["diagnostics.globalListeners.details"]};return a.register(b)}),define("tau/components/extensions/diagnostics/extension.diagnostics.base",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/extensions/component.extension.base"],function(a,b,c,d,e){var f=e.extend({init:function(a){this._super(a)},_getData:function(){var a=0,e=b.values(c.proxy.__subscriptions);return b.each(e,function(c){if(b.isObject(c)){var d=b.values(c);b.each(d,function(c){b.isObject(c)&&(a+=b(c).values().length)})}}),{countOfBuses:d.count(),globalBusListeners:c.getGlobalBus().getListenersCount(),storeListeners:a}},"bus beforeInit":function(){var a=this;a.fire("dataBind",a._getData())},signUp:function(){var a=["create","destroy"],e=["initialize","refresh","afterStoreOn","afterStoreUnbind"],f=this,g=function(a){f.refreshStats()};b.each(a,function(a){d.on(a,g,f)}),b.each(e,function(a){c.getGlobalBus().on(a,g,f,null,1e3)})},startMonitoringWithOutRefresh:function(){if(this.monitoringStarted)return;this.monitoringStarted=!0,this.signUp()},startMonitoring:function(){this.startMonitoringWithOutRefresh(),this.refreshStats()},"bus afterRender":function(){var a=this,d=this.config.startMonitoringConfig||{name:/(application|entity component)/,events:["afterRender"]},e=c.getGlobalBus(),f=function(c){c.caller.name.match(d.name)&&(b.each(d.events,function(b){e.removeAllListeners(a)}),a.startMonitoring())};b.each(d.events,function(b){e.on(b,f,a)})},refreshStats:function(){this.fire("refreshData",this._getData())},"bus destroy":function(){c.getGlobalBus().removeAllListeners(this),d.removeAllListeners(this)}});return f}),define("tau/components/component.diagnostics.globalListeners",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(a,b,c,d,e,f,g){return{create:function(b){var d=g.extend({_getData:function(){return this.startMonitoringWithOutRefresh(),{data:c.getGlobalBus().getListeners()}},_onDetailsClick:function(){var b=a(this).tmplItem().data.item;console.log(b.fn.toString()),console.log(b.fn)},_signUpOnClick:function(b){a(".tau-global-listener",b.data.element).click(this._onDetailsClick)},"bus elementRefreshedWithData":function(a){this._signUpOnClick(a)},"bus afterRender":function(a){this._signUpOnClick(a)}}),h={extensions:[d],template:f};return e.create(h,b)}}}),define("tau/ui/templates/diagnostics/ui.template.diagnostics",["tau/core/templates-factory"],function(a){var b={name:"diagnostics",markup:['<div class="tau-diagnostics-box">',,'<span class="ui-diag-label">Buses</span><span class="ui-diag-quantity">${countOfBuses}</span>','<span class="ui-diag-label">GB</span><span class="ui-diag-quantity">${globalBusListeners}</span>','<span class="ui-diag-label">Store</span><span class="ui-diag-quantity">${storeListeners}</span>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.diagnostics",["tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(a,b,c){return{create:function(d){var e={extensions:[c],template:b};return a.create(e,d)}}}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.storeListeners.details",["tau/core/templates-factory"],function(a){var b={name:"diagnostics.storeListeners.details",markup:['<span class="tau-store-listener ui-link">${name}</span><br/>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.store",["tau/core/templates-factory","tau/ui/templates/diagnostics/ui.template.diagnostics.storeListeners.details"],function(a){var b={name:"diagnostics.storeListeners",markup:['<div class="tau-diagnostics-storeListeners">',,"<table>",'{{each data}}<tr class="tau-diagnostics-row"><td>${items.length}</td><td>${name}</td><td>{{tmpl(items) "diagnostics.storeListeners.details"}}</td></tr>{{/each}}',"</table>","</div>"],dependencies:["diagnostics.storeListeners.details"]};return a.register(b)}),define("tau/components/component.diagnostics.store",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics.store","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(a,b,c,d,e,f,g){return{create:function(d){var h=g.extend({_getData:function(){this.startMonitoringWithOutRefresh();var a=0,d=b.values(c.proxy.__subscriptions),e={};return b.each(d,function(a){if(b.isObject(a)){var c=b.values(a);b.each(c,function(a){if(b.isObject(a)){var c=b(a).values();b.each(c,function(a){var b=a.config.eventName+"["+a.config.type+"]";e.hasOwnProperty(b)||(e[b]={name:b,items:[]});var c="unknown";a.config.listener&&a.config.listener.name&&(c=a.config.listener.name),a.config.listener&&a.config.listener.bus&&a.config.listener.bus.name&&(c=a.config.listener.bus.name),e[b].items.push({name:c,sub:a})})}})}}),{data:b.values(e)}},_onDetailsClick:function(){var b=a(this).tmplItem().data.sub;console.log(b.callback.toString()),console.log(b)},_signUpOnClick:function(b){a(".tau-store-listener",b.data.element).click(this._onDetailsClick)},"bus elementRefreshedWithData":function(a){this._signUpOnClick(a)},"bus afterRender":function(a){this._signUpOnClick(a)}}),i={extensions:[h],template:f};return e.create(i,d)}}}),define("tau/components/extensions/bubble/extensions.bubble.creator",["tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.tauBubble"],function(a,b){return a.extend({category:"edit",initBubble:function(a){var c=this;c.destroyContainer();var d=a.target;d.addClass("tau-bubble-target");var e=a.alignTo;if(!e||!e.length)e=d;e.addClass&&e.addClass("ui-link");var f=function(){c.initializeContainer(a.target,this.$popup,a.componentsConfig)};this.target=d,b.call(d,{alignTo:e,onShow:f})},destroy:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),delete this.container)},"bus initBubble":function(a){this.initBubble(a.data)},"bus toggleBubble":function(){b.call(this.target,"toggle")},initializeContainer:function(a,b,c){var d=this,e=b.find(".tau-bubble__inner");d.$popupInner=e,d.$target=a;if(a.data("bubbleLoaded")===!0)return;e.find("div.ui-loading-message").remove(),e.append("<div class='ui-loading-message'>Loading...</div>"),d.createComponents(c,function(b){var c=d.container=b[0].component;c.on("afterRender",function(b){e.find(".ui-loading-message").remove();var d=b.data.element;d.appendTo(e),a.data("bubbleLoaded",!0),b.removeListener(),a.tauBubble("adjustPosition"),a.tauBubble("adjustPositionStart"),a.tauBubble("adjustPosition"),a.bind("close",function(){c.fire("blur",{})}),a.bind("show",function(){c.fire("focus",{}),c.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition")}),c.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition"),setTimeout(function(){a.tauBubble("adjustPosition")},10),setTimeout(function(){c.fire("focus",{})},500)}),c.initialize();var f=function(){a.data("bubbleLoaded",!1),a.tauBubble("empty")},g=function(){a.tauBubble("destroy"),d.destroyContainer()};c.on("beforeSave",f),c.on("beforeRemove",f),c.on("reset",g),c.on("afterSave",g),c.on("afterRemove",g)})}})}),define("tau/models/model.extensions",["Underscore"],function(a){var b=function(a,b){var c=this,d=c.config.context,e=d.entity.entityType.name,f=[];for(var g=0;g<a.length;g++)f.push(a[g]);var h={id:d.entity.id,fields:a},i={innerCallback:function(a){var c=a.data,d=0;for(var e=0;e<f.length;e++)d+=c[f[e]];b.callback.call(b.scope,{count:d})}};c.store.get(e,h,{success:i.innerCallback,scope:i}).done()};return{calculateTagsCount:function(a){b.call(this,["tags-count"],a)},calculateBugsAndTasksCount:function(c){var d=[],e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");a.indexOf(e,"Planning")!==-1&&d.push("tasks-count"),a.indexOf(e,"Bug Tracking")!==-1&&d.push("bugs-count"),b.call(this,d,c)},calculateUserStoriesAndBugsCount:function(c){var d=[],e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");d.push("userStories-count"),a.indexOf(e,"Bug Tracking")!==-1&&d.push("bugs-count"),b.call(this,d,c)},calculateIterationsCount:function(a){b.call(this,["iterations-count"],a)},calculateReleasesCount:function(a){b.call(this,["releases-count"],a)},calculateFeaturesCount:function(a){b.call(this,["features-count"],a)},calculateRequestsCount:function(a){b.call(this,["requests-count"],a)},calculateImpedimentsCount:function(a){b.call(this,["impediments-count"],a)},calculateTimesCount:function(a){b.call(this,["times-count"],a)},calculateAttachmentsCount:function(a){b.call(this,["attachments-count"],a)},calculateCommentsCount:function(a){b.call(this,["comments-count"],a)},calculateTesCasesCount:function(a){b.call(this,["testCases-count"],a)},calculateUserStoriesCount:function(a){b.call(this,["userStories-count"],a)}}}),define("tau/utils/utils.urlBuilder",["Underscore","tau/configurator"],function(a,b){return{getViewUrl:function(a){return b.getApplicationPath()+"/View.aspx?noRedirect=1&id="+a},getAddImpedimentUrl:function(a){return b.getApplicationPath()+"/Project/Tracking/Impediment/Edit.aspx?AssignableID="+a},getAddTimeUrl:function(a){return b.getApplicationPath()+"/Project/Tracking/Time/Edit.aspx?AssignableID="+a},getAddTaskForUserStoryUrl:function(a){return b.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?UserStoryID="+a},getAddTaskForRequestUrl:function(a){return b.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?RequestID="+a},getSplitForUserStoryUrl:function(a,b){return"/Project/Planning/UserStory/Split.aspx?UserStoryID="+a+"&SplittedStoryID="+b},getAddBugForUserStoryUrl:function(a){return b.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?UserStoryID="+a},getAddBugForRequestUrl:function(a){return b.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?RequestID="+a},getAddTestCaseForUserStoryUrl:function(a){return b.getApplicationPath()+"/Project/QA/TestCase/Edit.aspx?UserStoryID="+a},getAssignTestCasesForTestPlanUrl:function(a){return b.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+a},getAddTestRunForTestPlanUrl:function(a){return b.getApplicationPath()+"/Project/QA/TestPlanRun/Edit.aspx?TestPlanID="+a},getAddUserStoryForRequestUrl:function(a){return b.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?RequestID="+a},getAddUserStoryForFeatureUrl:function(a){return b.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?FeatureID="+a},getAddUserStoryForIterationUrl:function(a){return b.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?IterationID="+a},getAddFeatureForRequestUrl:function(a){return b.getApplicationPath()+"/Project/Planning/Feature/Edit.aspx?RequestID="+a},getAddTestCaseForTestPlanRunUrl:function(a){return b.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+a},getAddIterationForReleaseUrl:function(a){return b.getApplicationPath()+"/Project/Planning/Iteration/Edit.aspx?ReleaseID="+a},getPrintUrl:function(a,c){return b.getApplicationPath()+"/RestUI/Print.aspx?id="+a+"&type=Tp.BusinessObjects."+c},getPrintUrlRelative:function(a,c){return"RestUI/Print.aspx?acid="+b.getCurrentAcid()+"#"+c.toLowerCase()+"/"+a+"/print"},getEditUrl:function(c,d){var e=b.getApplicationPath()+"/",f=d.toLowerCase();return f=="project"?e+="EditProject.aspx?ProjectID="+c:(e+="Project/",a.indexOf(["bug","testplan","testcase","testplanrun"],f)>-1?e+="QA/":a.indexOf(["impediment"],f)>-1?e+="Tracking/":a.indexOf(["request"],f)>-1?e+="HelpDesk/":e+="Planning/",e+=d+"/Edit.aspx?"+d+"ID="+c),e},getAvatarUrl:function(a,c){return b.getApplicationPath()+"/Avatar.ashx?UserId="+a+"&size="+c}}}),define("tau/components/extensions/comments/extensions.comments.refresher",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refresh:function(){var a=this.config.context.entity;this.config.store.evictProperties(a.id,a.entityType.name,["comments"]),this.fire("refresh")},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;(b===a.data.bugId||b===a.data.duplicateBugId)&&this.refresh()}})}),define("tau/configurations/base.container.config",["Underscore","tau/core/class","tau/core/termProcessor","tau/utils/utils.urlBuilder","tau/components/extensions/comments/extensions.comments.refresher"],function(a,b,c,d,e){var f=b.extend({init:function(a){var b=a.context.applicationContext?a.context.applicationContext.processes[0].terms:a.context.processes[0].terms;this.termProcessor=new c(b),this.collections={};var e=a.context.entity;this.registerAction("Old View",{label:"Old View",url:d.getViewUrl(e.id)}),this.registerAction("Old Edit",{label:"Old Edit",url:d.getEditUrl(e.id,e.entityType.name)}),this.registerAction("Print",{label:"Print View",command:function(a){a.redirectTo(d.getPrintUrlRelative(e.id,e.entityType.name),"_blank")}}),this.registerAction("-----","-----"),this.registerAction("Delete",{label:"Delete",confirmation:"Are you sure?",command:function(a){a.removeEntity()},className:"ui-menu__item-action-delete"}),this.registerAction("Move or Copy",{label:"Move or Copy",command:function(a){a.moveOrCopy()}}),this.registerAction("Convert",{label:"Convert",command:function(a){a.convert()}}),this.registerAction("Attach to Request",{label:"Attach To "+this.getTermName("Request"),command:function(a){a.attachToRequest()}}),this.registerAction("Add Impediment",{label:"Add "+this.getTermName("Impediment"),url:d.getAddImpedimentUrl(e.id)}),this.registerAdditionalInfoItem("Owner",{label:{type:"label",text:"Owner"},field:{type:"property.owner"}}),this.registerAdditionalInfoItem("Assigned Effort",{label:{type:"label",text:"Assigned Effort"},field:{type:"assignedEffort"}}),this.registerAdditionalInfoItem("Velocity",{label:{type:"label",text:"Velocity"},field:{type:"property.velocity"}}),this.registerAdditionalInfoItem("State",{label:{type:"label",text:"State"},field:{type:"property.entityState"}}),this.registerAdditionalInfoItem("Test Plan",{label:{type:"label",text:this.getTermName("TestPlan")},field:{type:"property.testPlan"}}),this.registerAdditionalInfoItem("Responsible",{label:{type:"label",text:"Responsible"},field:{type:"property.responsible"}}),this.registerAdditionalInfoItem("IsPrivate",{label:{type:"label",text:"Private?"},field:{type:"property.isPrivate"}}),this.registerAdditionalInfoItem("LastFailureComment",{label:{type:"label",text:"Last Failure Comment"},field:{type:"property.lastFailureComment"}}),this.registerAdditionalInfoItem("Release",{label:{type:"label",text:this.getTermName("Release")},field:{type:"property.release"},practices:["Planning"]}),this.registerAdditionalInfoItem("ImpedimentDate",{label:{type:"label",text:"Creation Date"},field:{type:"property.impedimentDate"}}),this.registerAdditionalInfoItem("CreationDate",{label:{type:"label",text:"Creation Date"},field:{type:"property.createDate"}}),this.registerAdditionalInfoItem("FinishDate",{label:{type:"label",text:"Finish  Date"},field:{type:"property.completeDate",editable:!0}}),this.registerAdditionalInfoItem("StartDate",{label:{type:"label",text:"Start Date"},field:{type:"property.startDate",editable:!0}}),this.registerAdditionalInfoItem("ResolvedOn",{label:{type:"label",text:"Resolved On"},field:{type:"property.completeDate"}}),this.registerAdditionalInfoItem("CompletionDate",{label:{type:"label",text:"Completion  Date"},field:{type:"property.completeDate"}}),this.registerAdditionalInfoItem("Iteration",{label:{type:"label",text:this.getTermName("Iteration")},field:{type:"property.iteration"},practices:["Iterations"]}),this.registerAdditionalInfoItem("Project",{label:{type:"label",text:this.getTermName("Project")},field:{type:"property.project"}}),this.registerAdditionalInfoItem("Priority",{label:{type:"label",text:this.getTermName("Priority")},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Business Value",{label:{type:"label",text:"Business Value"},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Initial Estimate",{label:{type:"label",text:"Initial Estimate"},field:{type:"property.initialEstimate"},practices:["Planning"]}),this.registerAdditionalInfoItem("Feature",{label:{type:"label",text:this.getTermName("Feature")},field:{type:"property.feature"},practices:["Requirements"]}),this.registerAdditionalInfoItem("User Story",{label:{type:"label",text:this.getTermName("userStory")},field:{type:"property.userStory"}}),this.registerAdditionalInfoItem("Assignable",{label:{type:"label",text:this.getTermName("Assignable")},field:{type:"property.assignable"}}),this.registerAdditionalInfoItem("Build",{label:{type:"label",text:this.getTermName("build")},field:{type:"property.build"}}),this.registerAdditionalInfoItem("Last Status",{label:{type:"label",text:"Last Status"},field:{type:"property.lastStatus"}}),this.registerAdditionalInfoItem("Last Run Date",{label:{type:"label",text:"Last Run Date"},field:{type:"property.lastRunDate"}}),this.registerAdditionalInfoItem("User Story For Task",{label:{type:"label",text:this.getTermName("userStory")},field:{type:"property.userStory",resetDisabled:!0}}),this.registerAdditionalInfoItem("Severity",{label:{type:"label",text:this.getTermName("Severity")},field:{type:"property.severity"},practices:["Planning"]})},getCollection:function(a){var b={};return a in this.collections||(this.collections[a]={}),b=this.collections[a],b},addToCollection:function(a,b,c){var d=this.getCollection(a);return d[b]=c,this},registerAction:function(a,b){this.addToCollection("actions",a,b)},getActions:function(b){var c=this.getActionsAliases(),d=this.getCollection("actions"),e=[];return a.forEach(c,function(a){a in d?e.push(d[a]):e.push({label:"--"+a,command:function(){alert("Still working on it")}})}),e},getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},registerAdditionalInfoItem:function(b,c){c.field&&a.defaults(c.field,{name:b+" "+c.field.type}),c.label&&a.defaults(c.label,{name:b+" "+c.label.type}),this.addToCollection("additionalInfo",b,c)},getAdditionalInfoItems:function(b){var c=this.getAdditionalInfoAliases(),d=this.getCollection("additionalInfo"),e=[];return a.forEach(c,function(a){a in d&&e.push(d[a])}),e},getAdditionalInfoAliases:function(){return[]},getTabs:function(a){return[{selected:!0,label:"description",header:[{type:"label",text:"Description"}],items:[{type:"tags"},{type:"container",name:"description container",cssClass:"ui-sub-control",children:[{type:"description"}]},this._buildRichTextCustomFieldsSummary(a),{type:"attachments"},{type:"label",text:"Comments",cssClass:"ui-ctrl-title"},{type:"container",name:"comments container",cssClass:"ui-sub-control",children:[{type:"comments",extensions:[e]}]}]}]},getAuditHistoryTab:function(){return{label:"track",header:[{type:"label",text:"Track"}],items:[{type:"audit.history"}],printable:!1}},getImplementationHistoryTab:function(){return{label:"implementationHistory",printable:!1,header:[{type:"label",text:"Flow"}],items:[{type:"implementationHistory"}]}},getPanels:function(a){var b=[{type:"collapsible",name:"additional info container",collapsed:!1,header:[{type:"label",text:"Info"}],items:[{type:"additionalInfo",children:this.getAdditionalInfoItems(a)}]}],c=this._buildCustomFieldsSummary(a);return c.length&&b.push({type:"collapsible",name:"custom fields collapsible",collapsed:!1,header:[{type:"label",text:"Custom Fields"}],items:c}),b},_buildCustomFieldsSummary:function(b){var c=b.context,d=c.applicationContext?c.applicationContext.processes[0].customFields:c.processes[0].customFields,e=c.entity.entityType.name.toLowerCase(),f=a(d).select(function(a){return e===a.entityKind.toLowerCase()&&a.type.toLowerCase()!=="richtext"}),g=[];for(var h=0;h<f.length;h++){var i=f[h],j=i.type.toLowerCase();if(j==="multipleselectionlist")continue;g.push({type:"customField."+j,customField:i})}return g},_buildRichTextCustomFieldsSummary:function(b){var c=b.context,d=c.applicationContext?c.applicationContext.processes[0].customFields:c.processes[0].customFields,e=c.entity.entityType.name.toLowerCase(),f=a(d).select(function(a){return e===a.entityKind.toLowerCase()&&a.type.toLowerCase()==="richtext"}),g={type:"container",name:"custom fields container",visible:f.length>0,children:[]};for(var h=0;h<f.length;h++){var i=f[h];g.children.push({type:"label",text:i.name,cssClass:"ui-ctrl-title"}),g.children.push({type:"container",name:"custom field container for "+i.type.toLowerCase(),cssClass:"ui-sub-control",children:[{type:"customField."+i.type.toLowerCase(),customField:i}]})}return g},getNames:function(a){return this.termProcessor.getTerms(a).names},getTermName:function(a){return this.termProcessor.getTerms(a).name},getDiagnosticsPanel:function(){return{type:"collapsible",name:"diagnostics container",printable:!1,collapsed:!0,header:[{type:"diagnostics"}],items:[{type:"collapsible",collapsed:!0,header:[{type:"label",text:"Global Bus Listeners"}],items:[{type:"diagnostics.globalListeners"}]},{type:"collapsible",collapsed:!0,header:[{type:"label",text:"Store Listeners"}],items:[{type:"diagnostics.store"}]}]}},getRightColumnComponents:function(a){var b=this.getPanels(a),c=[{type:"lookswitcher",printable:!1}];return window.appIsInDebugMode===!0&&c.push(this.getDiagnosticsPanel()),c.concat(b)},getConfig:function(a){var b=a.context.applicationContext?a.context.applicationContext.processes[0].terms:a.context.processes[0].terms;return this.termProcessor=new c(b),{children:[{type:"container",name:"main entity container",layout:"table",cssClass:"main-container",cellsCssClass:["general-info","additional-info"],children:[{type:"container",name:"general info column container",layout:"list",children:[{type:"breadcrumbs"},{type:"title"},{type:"tabs",tabs:this.getTabs(a),additionalHeaders:[{type:"menu.actions",items:this.getActions(a)}]}]},{type:"container",name:"additional info column container",layout:"list",children:this.getRightColumnComponents(a)}]}]}}});return f}),define("tau/ui/extensions/assignmentsList/ui.extension.assignmentsList.overlay",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender":function(a){this.element=a.data.element;var b=this.action||function(){};b.call(this),this.action=function(){}},getWidget:function(){return this.element.parents(".ui-placeholder:first")},showOverlay:function(){this.getWidget().tauOverlay()},hideOverlay:function(){this.getWidget().tauOverlay("hide")},"bus markElementToBeUpdated":function(a){this.showOverlay()},"bus updateElement":function(a){this.action=function(){this.hideOverlay()}},"bus markElementToBeDeleted":function(a){this.showOverlay()},"bus afterAssignmentRemoved":function(a){this.hideOverlay()},"bus beforeSaveAssignment":function(a){this.showOverlay()},"bus beforeAddAssignment":function(a){this.showOverlay()}})}),define("tau/configurations/baseAssignable.container.config",["Underscore","tau/configurations/base.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/ui/extensions/assignmentsList/ui.extension.assignmentsList.overlay"],function(a,b,c,d,e){var f=b.extend({init:function(a){b.prototype.init.call(this,a);var c=a.context.entity;this.registerAction("Add Time",{label:"Add "+this.getTermName("Time"),url:d.getAddTimeUrl(c.id),practices:["Time Tracking"]}),this.registerAction("Move to User Story",{label:"Move to Another User Story",command:function(){this.moveOrCopy()}}),this.registerAction("Find Duplicate",{label:"Find Duplicate",command:function(){this.markAsDuplicate()}}),this.registerAction("Split",{label:"Split",command:function(){this.split()}}),this.registerAction("Add Test Case",{label:"Add "+this.getTermName("testCase"),url:d.getAddTestCaseForUserStoryUrl(c.id),practices:["Test Cases"]}),this.registerAction("Add Bug",{label:"Add "+this.getTermName("bug"),url:d.getAddBugForUserStoryUrl(c.id),practices:["Bug Tracking"]}),this.registerAction("Create Bug",{label:"Create "+this.getTermName("bug"),url:d.getAddBugForRequestUrl(c.id),practices:["Bug Tracking"]}),this.registerAction("Add Task",{label:"Add "+this.getTermName("task"),url:d.getAddTaskForUserStoryUrl(c.id)}),this.registerAction("Create Task",{label:"Create "+this.getTermName("task"),url:d.getAddTaskForRequestUrl(c.id)}),this.registerAction("Create User Story",{label:"Create "+this.getTermName("userStory"),url:d.getAddUserStoryForRequestUrl(c.id)}),this.registerAction("Create Feature",{label:"Create "+this.getTermName("feature"),url:d.getAddFeatureForRequestUrl(c.id),practices:["Requirements"]})},getActionsAliases:function(){return["Add Time","-----","Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Release","Iteration"]},getTabs:function(a){var c=b.prototype.getTabs.call(this,a),d=this;return c.push({label:"track",header:[{type:"label",text:"Track"}],items:[{type:"collapsible",name:"time list collapsible",collapsed:!0,header:[{type:"label",text:"Time records"}],items:[{type:"timeList"}],practices:["Time Tracking"]},{type:"collapsible",printable:!1,name:"audit history collapsible",collapsed:!0,header:[{type:"label",text:"Audit history"}],items:[{type:"audit.history"}]}]},this.getImplementationHistoryTab()),c},getPanels:function(a){var c=b.prototype.getPanels.call(this,a);return c.unshift({type:"progressBar"},{type:"impedimentListPanel"},{type:"collapsible",collapsed:!1,header:[{type:"label",text:"Assignments"}],items:[{type:"assignmentsList",extensions:[e]}]}),c}});return f}),define("tau/configurations/baseContainable.container.config",["tau/configurations/base.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder"],function(a,b,c){var d=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add Iteration",{label:"Add "+this.getTermName("Iteration"),url:c.getAddIterationForReleaseUrl(d.id),practices:["Iterations"]})}});return d}),define("tau/components/extensions/extension.labelRefresher.base",["tau/components/extensions/component.extension.base"],function(a){return a.extend({eventName:null,propertyListForEvict:[],init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on(this.eventName,this.eventHandler,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener(this.eventName,this.eventHandler,this),this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refresh:function(){var a=this.config.context.entity;this.config.store.evictProperties(a.id,a.entityType.name,this.propertyListForEvict),this.fire("refresh")},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;b===a.data.bugId&&this.refresh()},eventHandler:function(a){this.isEntityInContext(a)&&this.refresh()}})}),define("tau/components/extensions/requestsList/extensions.requestList.labelRefresher",["tau/components/extensions/extension.labelRefresher.base"],function(a){return a.extend({eventName:"requestWasAttachedToEntity",propertyListForEvict:["requests-count"]})}),define("tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher",["tau/components/extensions/extension.labelRefresher.base"],function(a){return a.extend({eventName:"testCaseWasAdded",propertyListForEvict:["testCases-count"]})}),define("tau/components/extensions/entity/extension.requestList.remover",["Underscore","tau/core/model-base","tau/models/model.extensions","tau/configurator","libs/jsonselect"],function(a,b,c,d){return b.extend({init:function(a){this._super.apply(this,arguments),this.hideElementIfHelpDeskPracticeIsOff(this.config.context.applicationContext)},hideElementIfHelpDeskPracticeIsOff:function(b){this.store=d.getStore();var c=a.pluck(b.processes[0].practices,"name");a.indexOf(c,"Help Desk")<0&&(this.bus.getGlobalBus().on("requestWasAttachedToEntity",this._updateRefresh,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this._updateRefresh,this),this.bus.on("afterRender",this._update,this))},_updateRefresh:function(){var a=this.config.context;this.config.store.evictProperties(a.entity.id,a.entity.entityType.name,["requests-count"]),this._update()},_update:function(){c.calculateRequestsCount.call(this,{callback:function(a){var b=a.count,c=this.$el;b>0?c.show():c.hide()},scope:this})},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this._updateRefresh,this),this._super()},"bus afterRender":function(a){this.$el=a.data.element}})}),define("tau/models/dataprocessor/model.processor.assignments",["Underscore","tau/extensions/extension.underscore"],function(a){var b={getAssignmentsForRole:function(b,c){var d=a(c.assignments).select(function(a){return a.role.id==b.id});return d},getAssignments:function(a){var b={groups:[]},c=a.roleEfforts;for(var d=0;d<c.length;d++){var e=c[d].role,f={role:{id:e.id,name:e.name.substring(0,3)+"."},users:[]},g=this.getAssignmentsForRole(e,a);for(var h=0;h<g.length;h++){var i=g[h].generalUser;f.users.push({id:i.id,name:[i.firstName," ",i.lastName.substring(0,1),"."].join(""),assignmentId:g[h].id})}b.groups.push(f)}return b}};return b}),define("tau/models/dataprocessor/model.processor.importance",["Underscore","tau/core/class"],function(a,b){var c=b.extend({init:function(a,b){this.min=a,this.max=b},getKind:function(a){var b="medium";return a==this.min?b="high":a==this.max&&(b="low"),b}});return c}),define("tau/extensions/extension.underscore.async",["Underscore"],function(a){var exports={},b=Object.keys||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},c=function(a,b){var c=Array.prototype[a];return function(d,e,f){var g=d?d[a]:0;return g&&g===c?g.call(d,e,f):b(d,e,f)}},d=c("forEach",function(a,c){var d=a instanceof Object,e=d?b(a):a||[];for(var f=0,g=e.length;f<g;f++){var h=d?e[f]:f;c(a[h],h,a)}}),e=function(a,c,e){var f=a.length||b(a).length;if(!f)return e();var g=0;d(a,function(){var a=function(a){a?(e(a),e=function(){}):++g===f&&e()},b=Array.prototype.slice.call(arguments);c.length?(b=b.slice(0,c.length-1),b[c.length-1]=a):b.push(a),c.apply(this,b)})},f=function(a,c,d){var e=b(a);if(!e.length)return d();var f=0,g=function(){var b=e[f],h=[a[b],b,a].slice(0,c.length-1);h[c.length-1]=function(a){a?(d(a),d=function(){}):++f===e.length?d():g()},c.apply(this,h)};g()},g=c("map",function(a,b){var c=[];return d(a,function(a,d,e){c[c.length]=b(a,d,e)}),c}),h=function(a){return function(b,c,d){var e=[];a(b,function(a,b,d,f){var g=function(a,b){e[e.length]=b,f(a)},h=[a,b,d];c.length?(h=h.slice(0,c.length-1),h[c.length-1]=g):h.push(g),c.apply(this,h)},function(a){d(a,e)})}},i=c("filter",function(a,b,c){var e=[];return d(a,function(a,c,d){b(a,c,d)&&(e[e.length]=a)}),e}),j=function(a,b,c){var d=[];e(a,function(a,c,e,f){var g=function(b,c){c&&(d[d.length]=a),f(b)},h=[a,c,e];b.length?(h=h.slice(0,b.length-1),h[b.length-1]=g):h.push(g),b.apply(this,h)},function(a){c(a,d)})},k=c("reduce",function(a,b,c){return d(a,function(a,d,e){c=b(c,a,d,e)}),c}),l=function(a,b,c,d){f(a,function(a,d,e,f){var g=function(a,b){c=b,f(a)},h=[c,a,d,e];b.length?(h=h.slice(0,b.length-1),h[b.length-1]=g):h.push(g),b.apply(this,h)},function(a){d(a,c)})};exports.each=function(a,b,c){return(c?e:d)(a,b,c)},exports.map=function(a,b,c){return(c?h(e):g)(a,b,c)},exports.filter=function(a,b,c){return(c?j:i)(a,b,c)},exports.reduce=function(a,b,c,d){return(d?l:k)(a,b,c,d)},exports.parallel=function(a,b){var c=new a.constructor;e(a,function(a,b,d){a(function(a){var e=Array.prototype.slice.call(arguments,1);c[b]=e.length>1?e:e[0],d(a)})},function(a){(b||function(){})(a,c)})},exports.series=function(a,b){var c=new a.constructor;f(a,function(a,b,d){a(function(a,e){var f=Array.prototype.slice.call(arguments,1);c[b]=f.length>1?f:f[0],d(a)})},function(a){(b||function(){})(a,c)})},a.mixin({parallel:exports.parallel,series:exports.series})}),define("tau/models/dataProviders/model.provider.items.base",["Underscore","tau/core/class","tau/models/dataprocessor/model.processor.assignments","tau/models/dataprocessor/model.processor.importance","tau/utils/utils.urlBuilder","tau/extensions/extension.underscore.async"],function(a,b,c,d,e){return b.extend({init:function(a){this.config=a},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority"]},{roleEfforts:["id",{role:["id","name"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]}],b},_processAssignments:function(b){var d=c.getAssignments(b);return a.forEach(d.groups,function(b){a.forEach(b.users,function(a){a.avatarUrl=e.getAvatarUrl(a.id,24)})}),d},_processTags:function(b){return b.tags?a.isArray(b.tags)?b.tags:b.tags.toString().split(", "):[]},_calculateEffortToMaximum:function(b){if(b.length==0)return b;var c=a.max(b,function(a){return a.effort.total}),d=c.effort.total;return a.forEach(b,function(a){a.effort.percentFromMaximum=d==0?0:Math.round(a.effort.total/d*100)}),b},_convertData:function(b){var c=b,d=[],e=this;return a.forEach(c,function(a){d.push(e._convertItem(a))}),d},_convertItem:function(a){var b={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a)};return b.severity={id:a.severity.id,name:a.severity.name},b},_getEffortData:function(a){var b={};return b.estimated=a.effort,b.spent=a.effortCompleted,b.remain=a.effortToDo,b.total=b.spent+b.remain,b.percentComplete=b.total===0?0:Math.round(b.spent/b.total*100),b.percentFromMaximum=0,b.timeSpent=a.timeSpent,b.timeRemain=a.timeRemain,b.unit=this.config.context.getEffortPoint(a.__type),b},_getAssignedEffort:function(b){var c={},d=0,e=0,f=function(a){d+=a.effortToDo,e+=a.effortCompleted};return a.each(b.userStories,f),a.each(b.bugs,f),c.value=d+e,c.unit=this.config.context.getEffortPoint(b.__type),c},_getVelocityData:function(a){var b={};return b.value=a.velocity,b.unit=this.config.context.getEffortPoint(a.__type),b},_fetch:function(b,c,e,f){var g=this.config.context,h=g.entity.entityType.name,i=g.entity.id,j=g.applicationContext.processes[0].practices,k=a.pluck(j,"name"),l=this.config.store,m=this._createDetailCommand(b),n={id:i,nested:!0,fields:[m]},o=this,p=function(d){var e=d[0].data[b];a.map(e,function(a){a.__type=c});var g=o._convertData(e);f(g)};e&&(l=l.get(e,{fields:["id","importance"]}),p=function(e){var g=a(e[0].data).pluck("importance"),h=a.min(g),i=a.max(g);o.importanceProcessor=new d(h,i);var j=e[1].data[b];a.map(j,function(a){a.__type=c});var k=o._convertData(j);f(k)}),l=l.get(h,n),l.done({success:p,scope:o})},_sortByPriority:function(b){return a.sortBy(b,function(a){var b=a.numericPriority||0;return a.entityState.isFinal===!0&&(b+=100500),b})},changePriority:function(b,c,d,e){var f=this.config.store;f.evictProperties(b.id,b.__type,["numericPriority"]);var g=[];g.push(function(a){f.save("prioritizer",{id:b.id,$set:{beforeId:d.id,afterId:c.id}}).done({success:function(){a(null,arguments)}})}),g.push(function(a){f.get(b.__type,{id:b.id,fields:["id","numericPriority"]}).done({success:function(b){a(null,b[0].data)}})}),a.series(g,function(b,c){a.isFunction(e)&&e.call(null,{changed:c[1]})})}})}),define("tau/models/dataProviders/model.provider.items.bugs",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(a,b){return b.extend({fetch:function(a){this._fetch("bugs","bug","severity",a)},_createDetailCommand:function(b){var c={};c[b]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{severity:["id","name","importance"]}];var d={project:["id"]};return this.config.multiprojects&&d.project.push("abbreviation"),c[b].push(d),this.config.additionalFields&&a.indexOf(this.config.additionalFields,"iteration")>-1&&c[b].push({iteration:["id","name"]}),c},_convertItem:function(b){var c=this,d={id:b.id,name:b.name,numericPriority:b.numericPriority,__type:b.__type,entityState:{id:b.entityState.id,name:b.entityState.name,isInitial:b.entityState.isInitial,isFinal:b.entityState.isFinal,numericPriority:b.entityState.numericPriority},tags:this._processTags(b),effort:this._getEffortData(b),assignments:this._processAssignments(b),severity:{id:b.severity.id,name:b.severity.name,kind:c.importanceProcessor.getKind(b.severity.importance)},projectId:b.project.id,entitiesCount:0};return this.config.multiprojects&&(d.project={id:b.project.id,abbreviation:b.project.abbreviation}),this.config.additionalFields&&a.indexOf(this.config.additionalFields,"iteration")>-1&&(d.iteration={id:b.iteration?b.iteration.id:null,name:b.iteration?b.iteration.name:null}),d}})}),define("tau/models/dataProviders/model.provider.items.tasks",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(a,b){return b.extend({fetch:function(a){this._fetch("tasks","task","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority"]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{priority:["id","name","importance"]},{project:["id"]}],b},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),priority:null,projectId:a.project.id,entitiesCount:0};return c}})}),define("tau/models/dataProviders/model.provider.items.tasks_bugs",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.bugs","tau/models/dataProviders/model.provider.items.tasks"],function(a,b,c,d){return b.extend({init:function(b){this.config=b,this.providers=[new d(b)];var e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");a.indexOf(e,"Bug Tracking")!==-1&&this.providers.push(new c(b))},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(b){var c=this,d=function(a){var d=c._convertData(a);b(d)},e=[];a.forEach(c.providers,function(a){e.push(function(b){a.fetch(function(a){b(null,a)})})}),a.parallel(e,function(b,c){var e=a.flatten(c);d(e)})}})}),define("tau/models/dataProviders/model.provider.groups.base",["Underscore","tau/core/class"],function(a,b){return b.extend({init:function(a){this.config=a},_mergeGroups:function(b){var c=null;return b.length&&(c={key:[],items:[],title:[],isInitial:!1,isPlanned:!1,isFinal:!1,realGroups:[]},a.forEach(b,function(a){c.key.push(a.key),c.title.push(a.title?a.title:a.key),c.isInitial=!!a.isInitial,c.isPlanned=!!a.isPlanned,c.isFinal=!!a.isFinal,c.realGroups=c.realGroups.concat(a.realGroups)})),c},_fetchState:function(b,c,d){var e=this,f=a(c).isFunction()?c:function(b){var d=e.config.context.applicationContext.processes[0],f=b.entityType.name.toLowerCase();return b.process.id===d.id&&a.indexOf(c,f)>-1},g=this.config.store,h=["id","name","isFinal","isInitial","isPlanned","isCommentRequired","numericPriority",{entityType:["id","name"]},{process:["id"]},{nextStates:["id"]}],i={list:!0,fields:h};g=g.get("entityStates",i),g.done({success:function(b){var c=b[0].data;c=a(c).filter(f);var g=a.groupBy(c,function(a){return a.name});g=this._sortByState(g),a.forEach(g,function(b){b.collapsed=!!b.items[0].isFinal,b.isFinal=!!b.items[0].isFinal,b.isInitial=!!b.items[0].isInitial,b.isPlanned=!!b.items[0].isPlanned,b.realGroups=a.clone(b.items),b.items=[],delete b.stateWeight});var h=a.select(g,function(a){return a.isInitial}),i=a.select(g,function(a){return!a.isInitial&&a.isPlanned}),j=a.select(g,function(a){return!a.isInitial&&!a.isFinal&&!a.isPlanned}),k=a.select(g,function(a){return!a.isInitial&&a.isFinal&&!a.isPlanned});g=[];var l=null;h.length&&(l=e._mergeGroups(h),g.push(l)),i.length&&(l=e._mergeGroups(i),g.push(l)),g=g.concat(j),k.length&&(l=e._mergeGroups(k),g.push(l)),a.forEach(g,function(b){b.collapsed=!!b.isFinal,b.title&&a.isArray(b.title)&&(b.title=b.title.join(", ")),a.isArray(b.key)&&b.key.length==1&&(b.key=b.key.pop()),delete b.isFinal,delete b.isInitial,delete b.isPlanned}),d(g)},scope:this})},_sortByState:function(b){return a.forEach(b,function(b){var c=[];a.forEach(b.items,function(a){c.push(a.numericPriority)});var d=a.reduce(c,function(a,b){return a+b},0),e=d?d/c.length:0;b.stateWeight=e}),b=a.sortBy(b,function(a){return a.stateWeight}),b},moveToGroup:function(a,b,c,d){},_moveToGroupByState:function(b,c,d,e){var f=this.config.store,g=a.find(d.realGroups,function(a){return a.id==b.entityState.id}),h=a.find(c.realGroups,function(a){return a.entityType.name.toLowerCase()==b.__type.toLowerCase()&&a.process.id==g.process.id});if(!h||h.id==g.id){e.call(null);return}var i=[];i.push(function(a){f.save(b.__type,{id:b.id,$set:{entityState:{id:h.id}},fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(){a(null,arguments)}})}),i.push(function(a){f.get(b.__type,{id:b.id,fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(b){a(null,b[0].data)}})}),a.series(i,function(b,c){a.isFunction(e)&&e.call(null,{changed:c[1]})})},isAvailableForItem:function(a,b){return!0},getCommentRequirements:function(a,b){return[]}})}),define("tau/models/dataProviders/model.provider.groups.tasks_bugs",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(a,b){return b.extend({fetch:function(b,c,d){var e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name"),f={tasks:[],bugs:[]},g=[],h=[],i=a(c).select(function(a){return a.__type==="task"}),j=a(c).select(function(a){return a.__type==="bug"});f.tasks=a(i).chain().pluck("projectId").uniq().value(),a.indexOf(e,"Bug Tracking")!==-1&&(f.bugs=a(j).chain().pluck("projectId").uniq().value());var k=this.config.store,l=this;k.get("projects",{fields:[{process:["id"]}],list:!0}).done({success:function(c){var e=c[0].data,g={tasks:[],bugs:[]};a.forEach(f,function(b,c){g[c]=a(e).chain().select(function(c){return a(b).include(c.id)}).map(function(a){return a.process.id}).uniq().value()});var h=function(b){var c=(b.entityType.name||"").toLowerCase(),d=b.process.id;return c==="task"&&a(g.tasks).include(d)||c==="bug"&&a(g.bugs).include(d)};return l._fetchState(b,h,d)}})},moveToGroup:function(a,b,c,d){return this._moveToGroupByState(a,b,c,d)},isAvailableForItem:function(b,c,d){var e=a.find(d.realGroups,function(a){return a.id==b.entityState.id}),f=a.find(c.realGroups,function(a){return a.entityType.name.toLowerCase()==b.__type.toLowerCase()&&a.process.id==e.process.id}),g=a.pluck(e.nextStates,"id");return g.push(e.id),f&&a.include(g,f.id)},getCommentRequirements:function(b,c,d){var e=a.find(d.realGroups,function(a){return a.id==b.entityState.id}),f=[];return a.forEach(c,function(c){var d=a.find(c.realGroups,function(a){return a.entityType.name.toLowerCase()==b.__type.toLowerCase()&&a.process.id==e.process.id});f.push({isCommentRequired:d?d.isCommentRequired:!1})}),f}})}),define("tau/ui/extensions/list/extension.list.refresher",["tau/components/extensions/component.extension.base"],function(a,b){return a.extend({"bus afterInit":function(){if(this.signedUp)return;this.signedUp=!0;var a=this.config.context.entity,b=a.entityType.name,c=this.config.store,d=this;this._refresher||(this._refresher=function(){c.evictProperties(a.id,b,["tasks","bugs"]),d.fire("refresh")},c.unbind(this),c.on({eventName:"afterSave",type:"userStory",listener:this,filter:{id:a.id},hasChanges:["entityState"]},this._refresher))},"bus destroy":function(){this.config.store.unbind(this),delete this._refresher,this._super.apply(this,arguments)}})}),define("tau/configurations/userStory.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover","tau/models/dataProviders/model.provider.items.tasks_bugs","tau/models/dataProviders/model.provider.groups.tasks_bugs","tau/ui/extensions/list/extension.list.refresher"],function(a,b,c,d,e,f,g,h,i,j){var k=b.extend({getTabs:function(a){var d=b.prototype.getTabs.call(this,a),e=this;return d.splice(1,0,{label:"taskbug",header:[{type:"label",text:[{toString:function(){return e.getNames("task")},value:e.getNames("task"),practices:["Planning"]},{toString:function(){return e.getNames("bug")},value:e.getNames("task"),practices:["Bug Tracking"]}],getBadgeText:c.calculateBugsAndTasksCount,badgeFieldName:"count"}],items:[{type:"list.editable",extensions:[j],itemsDataProvider:h,groupsDataProvider:i,groupBy:"entityState.name",multiprojects:!0,views:[{type:"grid.entity",group:{dataIndex:"name"}}]}]},{label:"testcases",header:[{type:"label",text:e.getNames("testCase"),getBadgeText:c.calculateTesCasesCount,badgeFieldName:"count",extensions:[f]}],items:[{type:"testCaseList",practices:["Test Cases"]}],practices:["Test Cases"]}),d},getPanels:function(a){var d=b.prototype.getPanels.call(this,a);return d.push({type:"collapsible",collapsed:!0,header:[{type:"label",text:this.getNames("request"),getBadgeText:c.calculateRequestsCount,badgeFieldName:"count",extensions:[e]}],items:[{type:"requestList"}],extensions:[g]}),d},getActionsAliases:function(){return["Split","Add Task","Add Time","Add Bug","Add Test Case","Add Impediment","Attach to Request","Move or Copy","Convert","-----","Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return a.concat(["Owner","Business Value",this._super.apply(this,arguments),"Feature","CreationDate","CompletionDate"])}});return k}),define("tau/configurations/task.container.config",["tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover"],function(a,b,c,d){var e=a.extend({getAdditionalInfoAliases:function(){return["Owner","User Story For Task","CreationDate","CompletionDate"]},getActionsAliases:function(){return["Add Time","Add Impediment","Attach to Request","Convert","-----","Old View","Old Edit","Print","-----","Delete"]},getPanels:function(e){var f=a.prototype.getPanels.call(this,e);return f.push({type:"collapsible",collapsed:!0,header:[{type:"label",text:this.getNames("request"),getBadgeText:b.calculateRequestsCount,badgeFieldName:"count",extensions:[c]}],items:[{type:"requestList"}],extensions:[d]}),f}});return e}),define("tau/components/extensions/requestsList/extension.requestList.refresher",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("requestWasAttachedToEntity",this.onRequestWasAttachedToEntity,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this.onRequestWasAttachedToEntity,this),this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refreshComponentIfEntityFromCurrentContext:function(a){this.isEntityInContext(a)&&this.refresh()},onRequestWasAttachedToEntity:function(a){this.refreshComponentIfEntityFromCurrentContext(a)},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;b===a.data.bugId&&this.refresh()},refresh:function(){this.fire("evictProperty"),this.fire("refresh")}})}),define("tau/components/extensions/progressBar/extensions.progressBar.refresher",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;b==a.data.duplicateBugId&&a.data.stateId!=-1&&(this.fire("evictState"),this.fire("refresh"))}})}),define("tau/configurations/bug.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/requestsList/extension.requestList.refresher","tau/components/extensions/progressBar/extensions.progressBar.refresher","tau/components/extensions/entity/extension.requestList.remover"],function(a,b,c,d,e,f,g){var h=b.extend({getAdditionalInfoAliases:function(){return a.concat(["Owner","Priority","Severity",this._super.apply(this,arguments),"User Story","Build","CreationDate","CompletionDate"])},getActionsAliases:function(){return["Add Time","Add Impediment","Attach to Request","Move or Copy","Convert","Find Duplicate","-----","Old View","Old Edit","Print","-----","Delete"]},getPanels:function(a){var e=b.prototype.getPanels.call(this,a);return e.push({type:"collapsible",collapsed:!0,header:[{type:"label",text:this.getNames("request"),getBadgeText:c.calculateRequestsCount,badgeFieldName:"count",extensions:[d]}],items:[{type:"requestList"}],extensions:[g]}),e}});return h}),define("tau/configurations/request.container.config",["tau/configurations/baseAssignable.container.config","tau/models/model.extensions"],function(a,b){var c=a.extend({getAdditionalInfoAliases:function(){return["CreationDate","CompletionDate"]},getActionsAliases:function(){return["Add Time","Create Bug","Create User Story","Create Task","Create Feature","Move or Copy","-----","Old View","Old Edit","Print","-----","Delete"]}});return c}),define("tau/configurations/testplanrun.container.config",["Underscore","tau/configurations/baseAssignable.container.config"],function(a,b){var c=b.extend({getAdditionalInfoAliases:function(){return a.concat(["Test Plan","Build",this._super.apply(this,arguments),"CreationDate","CompletionDate"])},getActionsAliases:function(){return["Add Time","-----","Old View","Old Edit","Print","-----","Delete"]},getPanels:function(a){var c=b.prototype.getPanels.call(this,a);return c.splice(1,0,{type:"collapsible",collapsed:!1,header:[{type:"label",text:"Last Run"}],items:[{type:"testCasesRunResults"}]}),c}});return c}),define("tau/configurations/testcase.container.config",["tau/configurations/baseContainable.container.config"],function(a){var b=a.extend({getTabs:function(){var a=this._super.apply(this,arguments);return a[0].items[1].children=[{type:"container",layout:"table",cssClass:"test-case-description",cellsCssClass:["steps","success"],children:[{type:"container",children:[{type:"label",text:"Steps"},{type:"steps"}]},{type:"container",children:[{type:"label",text:"Success"},{type:"success"}]}]}],a.push(this.getAuditHistoryTab()),a},getActionsAliases:function(){return["Move or Copy","-----","Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Business Value","User Story","Owner","CreationDate","Last Status","LastFailureComment","Last Run Date"]}});return b}),define("tau/components/extensions/testCaseList/extension.testPlanRun.testCaseList.edit.addTestCase",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.urlBuilder","tau/core/termProcessor"],function(a,b,c,d,e){return c.extend({"bus afterRender+permissionsReady+dataBind":function(a){if(a.permissionsReady.data.editable){var c=a.dataBind.data,f=a.afterRender.data.element,g=this.config.context.applicationContext?this.config.context.applicationContext.processes[0].terms:this.config.context.processes[0].terms,h=new e(g),i=b('<a class="tau-add-testCase">Add '+h.getTerms("TestCase").names+"</a>");i.attr("href",d.getAddTestCaseForTestPlanRunUrl(this.config.context.entity.id)),f.find(".tau-add-testCase").replaceWith(i)}}})}),define("tau/configurations/testplan.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/components/extensions/testCaseList/extension.testPlanRun.testCaseList.edit.addTestCase","tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher"],function(a,b,c,d,e){var f=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add Test Plan Run",{label:"Add "+this.getTermName("TestPlanRun"),url:c.getAddTestRunForTestPlanUrl(d.id),practices:["Test Cases"]}),this.registerAction("Assign Test Cases",{label:"Assign "+this.getTermName("TestCase"),url:c.getAssignTestCasesForTestPlanUrl(d.id),practices:["Test Cases"]})},getTabs:function(c){var f=a.prototype.getTabs.call(this,c),g=this;return f.push({label:"testcases",header:[{type:"label",text:g.getNames("testCase"),getBadgeText:b.calculateTesCasesCount,badgeFieldName:"count",extensions:[e]}],items:[{type:"testCaseList",addTestCaseExtension:d,practices:["Test Cases"]}],practices:["Test Cases"]}),f.push(g.getAuditHistoryTab()),f},getAdditionalInfoAliases:function(){return["Initial Estimate","Owner","CreationDate"]},getActionsAliases:function(){return["Add Test Plan Run","Assign Test Cases","-----","Old View","Old Edit","Print","-----","Delete"]}});return f}),define("tau/models/dataProviders/model.provider.items.user_stories",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(a,b){return b.extend({fetch:function(a){this._fetch("userStories","userStory","priority",a)},fetchForGroup:function(b,c){var d=this.config.context,e=d.entity.entityType.name,f=d.entity.id,g=d.applicationContext.processes[0].practices,h=a.pluck(g,"name"),i=this.config.store,j="userStories",k="userStory",l=this._createDetailCommand(j),m={id:f,nested:!0,fields:[l]};i=i.get(e,m);var n=this,o=function(d){var e=a(d).pluck("data")[0][j];a.map(e,function(a){a.__type=k}),e=a.filter(e,function(a){return a.entityState.name==b.key});var f=n._convertData(e);c(f)};i.done({success:o,scope:n})},_createDetailCommand:function(b){var c={};c[b]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]}];var d={project:["id"]};return this.config.multiprojects&&d.project.push("abbreviation"),c[b].push(d),this.config.additionalFields&&a.indexOf(this.config.additionalFields,"iteration")>-1&&c[b].push({iteration:["id","name"]}),c},_convertData:function(a){return a=b.prototype._convertData.call(this,a),a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},_convertItem:function(b){var c=this,d={id:b.id,name:b.name,__type:b.__type,numericPriority:b.numericPriority,entityState:{id:b.entityState.id,name:b.entityState.name,isInitial:b.entityState.isInitial,isFinal:b.entityState.isFinal,numericPriority:b.entityState.numericPriority},tags:this._processTags(b),priority:{id:b.priority.id,name:b.priority.name,kind:c.importanceProcessor.getKind(b.priority.importance)},effort:this._getEffortData(b),assignments:this._processAssignments(b),projectId:b.project.id,entitiesCount:b["tasks-count"]};return this.config.multiprojects&&(d.project={id:b.project.id,abbreviation:b.project.abbreviation}),this.config.additionalFields&&a.indexOf(this.config.additionalFields,"iteration")>-1&&(d.iteration={id:b.iteration?b.iteration.id:null,name:b.iteration?b.iteration.name:null}),d}})}),define("tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(a,b,c,d){return b.extend({init:function(b){this.config=b,this.providers=[new c(b)];var e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");a.indexOf(e,"Bug Tracking")!==-1&&this.providers.push(new d(b))},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(b){var c=this,d=function(a){var d=c._convertData(a);b(d)},e=[];a.forEach(c.providers,function(a){e.push(function(b){a.fetch(function(a){b(null,a)})})}),a.parallel(e,function(b,c){var e=a.flatten(c);d(e)})}})}),define("tau/models/dataProviders/strategies/model.provider.groups.strategy.base",["Underscore","tau/core/class"],function(a,b){return b.extend({fetch:function(a,b,c){},moveToGroup:function(a,b,c,d){},isAvailableForItem:function(a,b){},getCommentRequirements:function(a,b){}})}),define("tau/models/dataProviders/strategies/model.provider.groups.strategy.states",["Underscore","tau/models/dataProviders/strategies/model.provider.groups.strategy.base"],function(a,b){return b.extend({fetch:function(a,b,c){},moveToGroup:function(b,c,d,e,f){var g=a.find(e.realGroups,function(a){return a.id==c.entityState.id}),h=a.find(d.realGroups,function(a){return a.entityType.name.toLowerCase()==c.__type.toLowerCase()&&a.process.id==g.process.id});if(!h||h.id==g.id){f.call(null);return}var i=[];i.push(function(a){b.save(c.__type,{id:c.id,$set:{entityState:{id:h.id}},fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(){a(null,arguments)}})}),i.push(function(a){b.get(c.__type,{id:c.id,fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(b){a(null,b[0].data)}})}),a.series(i,function(b,c){a.isFunction(f)&&f.call(null,{changed:c[1]})})},isAvailableForItem:function(b,c,d){var e=a.find(d.realGroups,function(a){return a.id==b.entityState.id}),f=a.find(c.realGroups,function(a){return a.entityType.name.toLowerCase()==b.__type.toLowerCase()&&a.process.id==e.process.id}),g=a.pluck(e.nextStates,"id");return g.push(e.id),f&&a.include(g,f.id)},getCommentRequirements:function(b,c,d){var e=a.find(d.realGroups,function(a){return a.id==b.entityState.id}),f=[];return a.forEach(c,function(c){var d=a.find(c.realGroups,function(a){return a.entityType.name.toLowerCase()==b.__type.toLowerCase()&&a.process.id==e.process.id});f.push({isCommentRequired:d?d.isCommentRequired:!1})}),f}})}),define("tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(a,b,c,d){return b.extend({init:function(a){this._super(a),this.strategy=new c},fetch:function(b,c,d){var e=["userstory"],f=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");return a.indexOf(f,"Bug Tracking")!==-1&&e.push("bug"),this._fetchState(b,e,d)},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/configurations/iteration.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups"],function(a,b,c,d,e){var f=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add User Story",{label:"Add "+this.getTermName("userStory"),url:c.getAddUserStoryForIterationUrl(d.id)})},getPanels:function(){var a=this._super.apply(this,arguments);return[{type:"iteration.progressBar"}].concat(a)},getActionsAliases:function(){return["Add User Story","-----","Old View","Old Edit","Print","-----","Delete"]},getTabs:function(c){var f=a.prototype.getTabs.call(this,c),g=this;return f.push({label:"userStories",header:[{type:"label",text:[{toString:function(){return g.getNames("userStory")},value:g.getNames("userStory")},{toString:function(){return g.getNames("bug")},value:g.getNames("bug"),practices:["Bug Tracking"]}],getBadgeText:b.calculateUserStoriesAndBugsCount,badgeFieldName:"count"}],items:[{type:"list.editable",itemsDataProvider:d,groupsDataProvider:e,groupBy:"entityState.name",views:[{type:"grid.entity",group:{dataIndex:"name"}}]}]}),f.push(g.getAuditHistoryTab()),f},getAdditionalInfoAliases:function(){return["StartDate","FinishDate","Release","Velocity","Assigned Effort"]}});return f}),define("tau/models/dataProviders/feature/feature.model.provider.user_stories.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories"],function(a,b,c){return b.extend({init:function(a){this.config=a,this.providers=[new c(a)]},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(b){var c=this,d=function(a){var d=c._convertData(a);b(d)},e=[];a.forEach(c.providers,function(a){e.push(function(b){a.fetch(function(a){b(null,a)})})}),a.parallel(e,function(b,c){var e=a.flatten(c);d(e)})}})}),define("tau/models/dataProviders/model.provider.groups.user_stories",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(a,b){return b.extend({fetch:function(b,c,d){var e=a(c).pluck("projectId"),f=this.config.store,g={fields:[{process:["id"]}],list:!0};f.get("projects",g,{scope:this,success:this.onProjects(e,b,d)}).done()},onProjects:function(b,c,d){return function(e){var f=a(e.data).chain().select(function(c){return a(b).include(c.id)}).map(function(a){return a.process.id}).uniq().value(),g=function(b){var c=(b.entityType.name||"").toLowerCase();return c==="userstory"&&a(f).include(b.process.id)};return this._fetchState(c,g,d)}},fetchForGroup:function(a,b){},moveToGroup:function(a,b,c,d){return this._moveToGroupByState(a,b,c,d)}})}),define("tau/models/dataProviders/feature/feature.model.provider.user_stories.groups",["Underscore","tau/models/dataProviders/model.provider.groups.user_stories","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(a,b,c,d){return b.extend({init:function(a){this._super(a),this.strategy=new c},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/configurations/feature.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover","tau/models/dataProviders/feature/feature.model.provider.user_stories.items","tau/models/dataProviders/feature/feature.model.provider.user_stories.groups"],function(a,b,c,d,e,f,g){var h=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add User Story",{label:"Add "+this.getTermName("userStory"),url:c.getAddUserStoryForFeatureUrl(d.id)})},getActionsAliases:function(){return["Add User Story","Add Impediment","Attach to Request","Move or Copy","Convert","-----","Old View","Old Edit","Print","-----","Delete"]},getPanels:function(c){var f=a.prototype.getPanels.call(this,c);return f.push({type:"collapsible",collapsed:!0,header:[{type:"label",text:this.getNames("request"),getBadgeText:b.calculateRequestsCount,badgeFieldName:"count",extensions:[d]}],items:[{type:"requestList"}],extensions:[e]}),[{type:"progressBar"},{type:"impedimentListPanel"},{type:"feature.totalEffort"},{type:"collapsible",collapsed:!1,header:[{type:"label",text:"Assignments"}],items:[{type:"feature.assignmentList"}]}].concat(f)},getTabs:function(c){var d=a.prototype.getTabs.call(this,c),e=this;return d.push({label:"userStories",header:[{type:"label",text:e.getNames("userStory"),getBadgeText:b.calculateUserStoriesCount,badgeFieldName:"count"}],items:[{type:"list.editable",itemsDataProvider:f,groupsDataProvider:g,groupBy:"entityState.name",multiprojects:!0,views:[{type:"grid.entity",group:{dataIndex:"name"}}]}]},this.getAuditHistoryTab(),this.getImplementationHistoryTab()),d},getAdditionalInfoAliases:function(){return["Owner","Initial Estimate","Business Value","Release","CreationDate","CompletionDate"]}});return h}),define("tau/models/dataProviders/model.provider.items.user_stories_bugs",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(a,b,c,d){return b.extend({init:function(b){this.config=b,this.providers=[new c(b)];var e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");a.indexOf(e,"Bug Tracking")!==-1&&this.providers.push(new d(b))},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(b){var c=this,d=function(a){var d=c._convertData(a);b(d)},e=[];a.forEach(c.providers,function(a){e.push(function(b){a.fetch(function(a){b(null,a)})})}),a.parallel(e,function(b,c){var e=a.flatten(c);d(e)})}})}),define("tau/models/dataProviders/release/release.model.provider.iterations.items",["Underscore","tau/models/dataProviders/model.provider.items.user_stories_bugs","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(a,b,c,d){return b.extend({init:function(b){this.config=b,b.additionalFields=["iteration"],this.providers=[new c(b)];var e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");a.indexOf(e,"Bug Tracking")!==-1&&this.providers.push(new d(b))},_convertData:function(c){return c=b.prototype._convertData.call(this,c),a.forEach(c,function(a){a.visibleEntityState=a.entityState.name}),this._sortByPriority(c)}})}),define("tau/models/dataProviders/release/release.model.provider.iterations.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(a,b,c){return b.extend({fetch:function(b,c,d){var e=["userstory"],f=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");return a.indexOf(f,"Bug Tracking")!==-1&&e.push("bug"),this._fetchIterations(b,e,d)},_fetchIterations:function(b,d,e){var f=this.config.context,g=f.entity.entityType.name,h=f.entity.id,i=this.config.store,j={id:h,nested:!0,fields:[{iterations:["id","name","startDate","endDate"]}]},k="d MMM";i=i.get("release",j),i.done({success:function(b){var d=a(b).pluck("data")[0].iterations,f=[];d=a.sortBy(d,function(a){return-1*c.parse(a.startDate)}),a.forEach(d,function(a){var b=c.parse(a.startDate).clearTime(),d=c.parse(a.endDate).clearTime(),e=!0,g=!1;Date.today().between(b,d)&&(e=!1,g=!0);var i=b.toString(k)+" / "+d.toString(k);i=i+" ("+Math.floor((d.getTime()-b.getTime())/1e3/60/60/24+1)+" days)",g&&(i+=" (current)"),a.releaseId=h,f.push({key:a.id,title:a.name,subtitle:i,collapsed:e,realGroup:a})}),f.unshift({key:null,title:"Backlog",collapsed:!0,realGroup:{id:null,releaseId:h}}),a.forEach(f,function(a){a.items=[]}),e(f)},scope:this})},moveToGroup:function(a,b,c,d){return this._moveToGroupByIteration(a,b,c,d)},_moveToGroupByIteration:function(b,c,d,e){var f=this.config.store,g=c.realGroup;if(!g||b.iteration&&g.id==b.iteration.id){e.call(null);return}var h=[];h.push(function(a){f.save(b.__type,{id:b.id,$set:{iteration:{id:g.id},release:{id:g.releaseId}},fields:["id",{iteration:["id"]}]}).done({success:function(){a(null,arguments)}})}),h.push(function(a){f.get(b.__type,{id:b.id,fields:["id",{iteration:["id"]}]}).done({success:function(b){a(null,b[0].data)}})}),a.series(h,function(b,c){a.isFunction(e)&&e.call(null,{changed:c[1]})})}})}),define("tau/ui/extensions/list/iterations/extension.list.release_iterations",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus preDataBind":function(a){var b=a.data;b.groups.length>1?b.isEmpty=!1:b.isEmpty=!0}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories_bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.user_stories_bugs","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(a,b,c,d){return b.extend({init:function(b){this.config=b,b.additionalFields=["iteration"],this.providers=[new c(b)];var e=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");a.indexOf(e,"Bug Tracking")!==-1&&this.providers.push(new d(b))},_convertData:function(a){var c=b.prototype._convertData.call(this,a);return this._sortByPriority(c)}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories_bugs.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(a,b,c,d){return b.extend({init:function(a){this._super(a),this.strategy=new c},fetch:function(b,c,d){var e=["userstory"],f=a.pluck(this.config.context.applicationContext.processes[0].practices,"name");return a.indexOf(f,"Bug Tracking")!==-1&&e.push("bug"),this._fetchState(b,e,d)},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/models/dataProviders/model.provider.items.features",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(a,b){return b.extend({fetch:function(a){this.config.store.get("entityState",{fields:["id",{entityType:["id","name"]},{role:["id","name"]},{process:["id"]}]}).get("project",{fields:["id",{process:["id"]}]}).done({scope:this,success:this.onReadyToFetch(a)})},onReadyToFetch:function(a){return function(b){this.entityStates=b[0].data,this.projects=b[1].data,this._fetch("features","feature","priority",a)}},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain","userStories-count",{entityState:["id","name","isInitial","isFinal","numericPriority"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{priority:["id","name","importance"]},{project:["id"]}],b},_convertData:function(c){return c=b.prototype._convertData.call(this,c),a.forEach(c,function(a){a.visibleEntityState=a.entityState.name}),c=this._calculateEffortToMaximum(c),this._sortByPriority(c)},_convertItem:function(b){var c=this,d=a(this.projects).detect(function(a){return a.id===b.project.id}),e=d.process.id,f=a(this.entityStates).chain().select(function(a){return a.entityType.name.toLowerCase()==="feature"&&a.process.id===e&&a.role!==null}).pluck("role").value(),g=a(f).reduce(function(b,c,d){if(0==d||!a.detect(b,function(a){return a.id===c.id}))b[b.length]=c;return b},[]);b.roleEfforts=a(g).map(function(a){return{role:a}});var h={id:b.id,name:b.name,__type:b.__type,numericPriority:b.numericPriority,entityState:{id:b.entityState.id,name:b.entityState.name,isInitial:b.entityState.isInitial,isFinal:b.entityState.isFinal,numericPriority:b.entityState.numericPriority},tags:this._processTags(b),effort:this._getEffortData(b),assignments:this._processAssignments(b),priority:{id:b.priority.id,name:b.priority.name,kind:c.importanceProcessor.getKind(b.priority.importance)},entitiesCount:b["userStories-count"]};return h}})}),define("tau/configurations/release.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/models/dataProviders/release/release.model.provider.iterations.items","tau/models/dataProviders/release/release.model.provider.iterations.groups","tau/ui/extensions/list/iterations/extension.list.release_iterations","tau/models/dataProviders/release/release.model.provider.user_stories_bugs.items","tau/models/dataProviders/release/release.model.provider.user_stories_bugs.groups","tau/models/dataProviders/model.provider.items.features"],function(a,b,c,d,e,f,g,h){var i=a.extend({getAdditionalInfoAliases:function(){return["StartDate","FinishDate","Assigned Effort"]},getPanels:function(){var a=this._super.apply(this,arguments);return[{type:"iteration.progressBar"}].concat(a)},getActionsAliases:function(){return["Add Iteration","-----","Old View","Old Edit","Print","-----","Delete"]},getTabs:function(i){var j=a.prototype.getTabs.call(this,i),k=this;return j.push({practices:["Iterations"],label:"iterations",header:[{type:"label",text:k.getNames("iteration"),getBadgeText:b.calculateIterationsCount,badgeFieldName:"count"}],items:[{practices:["Iterations"],type:"list",itemsDataProvider:c,groupsDataProvider:d,groupBy:"iteration.id",extensions:[e],views:[{type:"grid.entity",group:{dataIndex:"id"}}]}]},{label:"userStories",header:[{type:"label",text:[{toString:function(){return k.getNames("userStory")},value:k.getNames("userStory")},{toString:function(){return k.getNames("bug")},value:k.getNames("bug"),practices:["Bug Tracking"]}],getBadgeText:b.calculateUserStoriesAndBugsCount,badgeFieldName:"count"}],items:[{type:"list",itemsDataProvider:f,groupsDataProvider:g,groupBy:"entityState.name",views:[{type:"grid.entity",group:{dataIndex:"name"}}]}]},{practices:["Requirements"],label:"features",header:[{type:"label",text:k.getNames("feature"),getBadgeText:b.calculateFeaturesCount,badgeFieldName:"count"}],items:[{practices:["Requirements"],type:"list",itemsDataProvider:h,views:[{type:"grid.entity"}]}]},{label:"notes",header:[{type:"label",text:"Notes"}],items:[{type:"releaseNotes"}]}),j.push(k.getAuditHistoryTab()),j}});return i}),define("tau/configurations/build.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder"],function(a,b,c){var d=a.extend({init:function(b){a.prototype.init.call(this,b);var c=b.context.entity;this.registerAdditionalInfoItem("BuildDate",{label:{type:"label",text:"Build Date"},field:{type:"property.buildDate",editable:!0}})},getTabs:function(a){var b=this,c=b._super(a);return c.push(b.getAuditHistoryTab()),c},getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Owner","BuildDate","Release","Iteration"]}});return d}),define("tau/configurations/impediment.container.config",["tau/configurations/baseContainable.container.config"],function(a){var b=a.extend({getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},getTabs:function(b){var c=a.prototype.getTabs.call(this,b),d=this;return c.push(d.getAuditHistoryTab()),c},getAdditionalInfoAliases:function(){return["State","ImpedimentDate","ResolvedOn","Business Value","Assignable","Owner","Responsible","IsPrivate"]}});return b}),define("tau/models/dataProviders/project/project.model.provider.releases.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(a,b,c){return b.extend({fetch:function(a){this._fetch("iterations","iteration",!1,a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","tags","startDate","endDate",{release:["id","name"]},{userStories:["effortToDo","effortCompleted"]},{bugs:["effortToDo","effortCompleted"]}],b},_convertItem:function(a){var b={id:a.id,name:a.name,__type:a.__type,tags:this._processTags(a),release:a.release,assignedEffort:this._getAssignedEffort(a),startDate:c.format.date.short(a.startDate),endDate:c.format.date.short(a.endDate)};return b},_convertData:function(a){return a=this._super(a),this._sortByStartDate(a)},_sortByStartDate:function(b){return a.sortBy(b,function(a){return-1*a.startDate})}})}),define("tau/models/dataProviders/project/project.model.provider.releases.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(a,b,c){return b.extend({fetch:function(a,b,c){return this._fetchReleases(a,b,c)},_fetchReleases:function(b,d,e){var f=this.config.context,g=f.entity.entityType.name,h=f.entity.id,i=this.config.store,j=this,k={id:h,nested:!0,fields:[{releases:["id","name","startDate","endDate"]}]};i.get("project",k).done({success:function(b){var d=a(b).pluck("data")[0].releases;d=a.sortBy(d,function(a){return-1*c.parse(a.startDate)});var f=[];a.forEach(d,function(a){f.push(j._processRelease(a))}),a.forEach(f,function(a){a.items=[]}),e(f)}})},_processRelease:function(a){var b=c.parse(a.startDate).clearTime(),d=c.parse(a.endDate).clearTime(),e=!0,f=!1;Date.today().between(b,d)&&(e=!1,f=!0);var g="d MMM",h=c.formatAs(b,g)+" / "+c.formatAs(d,g);h=h+" ("+Math.floor((d.getTime()-b.getTime())/1e3/60/60/24+1)+" days)",f&&(h+=" (current)");var i={key:a.id,title:a.name,subtitle:h,collapsed:e,realGroup:a};return i}})}),define("tau/ui/extensions/list/extension.list.checkEmpty",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus preDataBind":function(a){var b=a.data;b.groups.length==0?b.isEmpty=!0:b.isEmpty=!1}})}),define("tau/models/dataProviders/project/project.model.provider.releases_flat.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(a,b,c){return b.extend({fetch:function(a){this._fetch("releases","release",!1,a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","tags","startDate","endDate"],b},_convertItem:function(a){var b=c.parse(a.startDate),d=c.parse(a.endDate),e=!1;Date.today().between(b,d)&&(e=!0);var f={id:a.id,name:a.name+(e?" (current)":""),__type:a.__type,tags:this._processTags(a),startDate:c.format.date.short(a.startDate),endDate:c.format.date.short(a.endDate)};return f},_convertData:function(a){return a=this._super(a),this._sortByStartDate(a)},_sortByStartDate:function(b){return a.sortBy(b,function(a){return-1*a.startDate})}})}),define("tau/configurations/project.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/models/dataProviders/project/project.model.provider.releases.items","tau/models/dataProviders/project/project.model.provider.releases.groups","tau/ui/extensions/list/extension.list.checkEmpty","tau/models/dataProviders/project/project.model.provider.releases_flat.items"],function(a,b,c,d,e,f,g){var h=a.extend({init:function(b){a.prototype.init.call(this,b);var c=b.context.entity;this.registerAdditionalInfoItem("Abbreviation",{label:{type:"label",text:"Abbreviation"},field:{type:"property.abbreviation",editable:!0}}),this.registerAdditionalInfoItem("IsActive",{label:{type:"label",text:"Active?"},field:{type:"property.isActive",editable:!1}}),this.registerAdditionalInfoItem("IsProduct",{label:{type:"label",text:"Product?"},field:{type:"property.IsProduct",editable:!0}}),this.registerAdditionalInfoItem("Company",{label:{type:"label",text:"Company"},field:{type:"property.company",editable:!0}}),this.registerAdditionalInfoItem("Process",{label:{type:"label",text:"Process"},field:{type:"property.process",editable:!0}}),this.registerAdditionalInfoItem("StartDate",{label:{type:"label",text:"Start Date"},field:{type:"property.startDate.project",editable:!0}}),this.registerAdditionalInfoItem("EndDate",{label:{type:"label",text:"End Date"},field:{type:"property.endDate.project",editable:!0}})},getAdditionalInfoAliases:function(){return["Abbreviation","Owner","IsActive","IsProduct","Company","Process","StartDate","EndDate"]},getTabs:function(c){var h=a.prototype.getTabs.call(this,c);h[0].items=h[0].items.slice(1);var i=this;return h.push({practices:["Iterations"],label:"releases",header:[{type:"label",text:i.getNames("release"),getBadgeText:b.calculateReleasesCount,badgeFieldName:"count"}],items:[{practices:["Iterations"],type:"list.editable",itemsDataProvider:d,groupsDataProvider:e,extensions:[f],groupBy:"release.id",sortable:!1,views:[{type:"grid.entity",group:{dataIndex:"id"}}]}]}),h.push({practices:["~Iterations"],label:"releases-flat",header:[{type:"label",text:i.getNames("release"),getBadgeText:b.calculateReleasesCount,badgeFieldName:"count"}],items:[{practices:["~Iterations"],type:"list.editable",itemsDataProvider:g,sortable:!1,views:[{type:"grid.entity"}]}]}),h},getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]}});return h}),define("tau/configurations/converters/converter.practice",["Underscore"],function(a){var b=function(b,c){var d=[],e=[];a.forEach(b,function(a){a[0]=="~"?d.push(a.slice(1)):e.push(a)});var f=!0;e.length&&(f=a.intersect(c,e).length>0);var g=!1;return d.length&&(g=a.intersect(c,d).length>0),f&&!g?!0:!1},c=function(d,e){return a.forEach(d,function(f,g){if(f.type=="tabs")a.forEach(f.tabs,function(a,b){a.header=c(a.header,e),f.tabs[b].items=c(a.items,e),f.tabs[b].items.length==0&&(f.tabs[b]=!1)}),f.tabs=a.filter(f.tabs,function(a,b){return a!==!1}),f.additionalHeaders=c(f.additionalHeaders,e),f.tabs.length==0&&(d[g]=!1);else if(f.type=="additionalInfo")f.children=c(f.children,e),f.children.length==0&&(d[g]=!1);else if(f.type=="label"&&a.isArray(f.text))f.text=c(f.text,e),f.text.length==0?d[g]=!1:d[g]=f;else if(f.practices)f.practices.length&&b(f.practices,e)==0&&(d[g]=!1);else if(f.children)d[g].children=c(f.children,e);else if(typeof f.items!="undefined")d[g].items=c(f.items,e),f.items.length==0&&(d[g]=!1);else if(g=="children"||g=="items")d[g]=c(f,e)}),d=a.filter(d,function(a,b){return a!==!1}),d};return{convert:function(a,b){return a=c(a,b),a}}}),define("tau/configurations/factory.container.config",["Underscore","tau/core/class","tau/core/termProcessor","tau/models/model.extensions","tau/configurations/base.container.config","tau/configurations/baseAssignable.container.config","tau/configurations/baseContainable.container.config","tau/configurations/userStory.container.config","tau/configurations/task.container.config","tau/configurations/bug.container.config","tau/configurations/request.container.config","tau/configurations/testplanrun.container.config","tau/configurations/testcase.container.config","tau/configurations/testplan.container.config","tau/configurations/iteration.container.config","tau/configurations/feature.container.config","tau/configurations/release.container.config","tau/configurations/build.container.config","tau/configurations/impediment.container.config","tau/configurations/project.container.config","tau/configurations/converters/converter.practice"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=b.extend({init:function(b,c){this.originalConfigObject=b,this.appConfig=c,this.practices=[];var d=this.appConfig.context.applicationContext;d&&(this.practices=a(d.processes[0].practices).pluck("name"))},getConfig:function(){var a=this.originalConfigObject.getConfig(this.appConfig);return u.convert(a,this.practices)},getActions:function(){var a=this.originalConfigObject.getActions(this.appConfig.context.applicationContext);return u.convert(a,this.practices)}}),w=b.extend({init:function(){this.configs={base:e,userstory:h,task:i,bug:j,request:k,testplanrun:l,testcase:m,testplan:n,iteration:o,feature:p,release:q,build:r,impediment:s,project:t}},getConfig:function(a){var b=a.context.entity.entityType.name.toLowerCase(),c=this.configs[b]?this.configs[b]:this.configs.base,d=new c(a),e=d.getConfig(a);return e},getContextBasedConfigObject:function(a){var b=a.context.entity.entityType.name.toLowerCase(),c=this.configs[b]?this.configs[b]:this.configs.base,d=new c(a);return new v(d,a)}});return new w}),define("tau/models/entity/actions/model.entity.actions",["Underscore","tau/configurator","tau/core/model-base","tau/configurations/factory.container.config"],function(a,b,c,d){return c.extend({name:"model.entity.actions",onInit:function(){var a=this,b=a.config.context.id;a.fire("permissionsReady",{editable:!0});var c=d.getContextBasedConfigObject(a.config),e=c.getActions();a.fire("dataBind",{items:e})}})}),define("tau/ui/templates/menu/ui.template.menu.actions.item",["tau/core/templates-factory"],function(a){var b={name:"menu-actions-item",markup:["           {{if url}}",'               <div class="ui-menu__item ui-menu__item-action ui-menu__item-action-link ${className}">','                  <a class="drop-down-option" href="${url}">${label}</a>',"               </div>","           {{else label}}",'               <div class="ui-menu__item ui-menu__item-action ${className}">','                   <span class="drop-down-option">${label}</span>',"               </div>","           {{else}}",'               <div class="ui-menu__item-separator">-----</div>',"           {{/if}}"]};return a.register(b)}),define("tau/ui/templates/menu/ui.template.menu.actions.list",["tau/core/templates-factory","tau/ui/templates/menu/ui.template.menu.actions.item"],function(a){var b={name:"menu-actions-list",markup:['<div class="ui-menu-actions">','   <div class=" ui-drop-down drop-down-list">','   {{tmpl(items) "menu-actions-item"}}',"   </div>","</div>"],dependencies:["menu-actions-item"]};return a.register(b)}),define("tau/ui/extensions/entity/actions/extension.entity.actions.editable",["tau/components/extensions/component.extension.base","tau/ui/templates/menu/ui.template.menu.actions.list"],function(a,b){return a.extend({category:"edit","bus permissionsReady+dataBind+afterRender":function(a){var c=this,d=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f=a.afterRender.data.element,g=f.find(".tau-entity-actions-target"),h={components:[{type:"menu.actions",template:b,items:e.items}],context:c.config.context},i={target:g,componentsConfig:h};c.fire("initBubble",i)}}})}),define("tau/ui/templates/entity/ui.template.entity.actions",["tau/core/templates-factory"],function(a){var b={name:"ui.template.entity.actions",markup:['<div class="tau-entity-actions">','   <span class="tau-entity-actions-target"></span>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.entity.actions",["tau/components/component.creator","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/models/entity/actions/model.entity.actions","tau/ui/extensions/entity/actions/extension.entity.actions.editable","tau/ui/templates/entity/ui.template.entity.actions"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[b,c,d,e],template:f};return a.create(h,g)}}}),define("tau/models/dataprocessor/model.processor.context",[],function(){function f(a){return a.checkPractice=e,a.getTimeTrackingPolicies=b,a.getEffortPoint=c,a.getTerms=d,a}var a=function(a,b){var c=null,d=a.processes[0].practices;for(var e=0;e<d.length;e++)d[e].name.toLowerCase()===b.toLowerCase()&&(c=d[e]);return c},b=function(){var b=a(this.applicationContext,"Time Tracking"),c=!b;return{disableSpentRemain:c}},c=function(b){var c=a(this.applicationContext,"Planning")||{},d=c.effortPoints;b=b||this.entity.entityType.name.toLowerCase();if(b==="task"||b==="request")d="Hour";var e=d.toLowerCase()==="point"?"pt":"h";return{name:d,shortName:e}},d=function(){var a=this.applicationContext,b=a&&a.processes&&a.processes.length>0?a.processes[0].terms:[];return b},e=function(b){return null!==a(this.applicationContext,b)};return f}),define("tau/models/model.entity",["Underscore","tau/configurator","tau/core/model-base","tau/models/dataprocessor/model.processor.context"],function(a,b,c,d){var e=function(){this.callbacks={}};return e.prototype={register:function(a,b){this.callbacks[a]=b},fnCallback:function(b){var c=this;return function(){var d=Array.prototype.slice.apply(arguments);c._ready.data[b]=d.length===1?d[0]:d;var e=c.callbacks[b];e&&e.fn.apply(e.scope,d),delete c.callbacks[b],a(c.callbacks).keys().length===0&&c._ready.fn.call(c._ready.scope,c._ready.data)}},ready:function(a){this._ready={fn:a.fn,scope:a.scope,data:{}}}},c.extend({name:"Entity",onInit:function(){var a=this;a.store.unbind(a);var c=a.config.context.id;a.store.on({eventName:"afterRemove",type:a.config.context.entityType.name,listener:this},function(b){var d=b.data.cmd.config.id;c==d&&a.fire("deleted",b.data)}),a.store.on({eventName:"beforeRemove",type:a.config.context.entityType.name,listener:this},function(b){var d=b.data.cmd.config.id;c==d&&a.fire("beforeDelete")});var d=new e;d.register("onGlobalSettings"),d.register("onContext"),d.ready({scope:this,fn:this.fnBindData});var f=b.getGlobalSettingsService();f.getGlobalSettings({scope:d,success:d.fnCallback("onGlobalSettings")}),a.store.get("context",{id:c,fields:["id","acid","culture",{loggedUser:["id","email","isAdministrator"]},{processes:["id","name","terms","practices","customFields"]},{selectedProjects:["id","name",{process:["id","name"]}]}]},{scope:d,success:d.fnCallback("onContext")}).done()},fnBindData:function(a){var b=a.onContext;b.data.globalSettings=a.onGlobalSettings,this.onContextRetrieved(b)},onContextRetrieved:function(b){var c={context:{}},e=this,f=e.config.context;a.extend(c.context,{assignable:f}),a.extend(c.context,{entity:f}),a.extend(c.context,{general:f}),a.extend(c.context,{applicationContext:b.data}),e.bus.fire("contextRetrieved",{context:d(c.context)})}})}),define("tau/views/view.entity",["Underscore","tau/core/view-base","tau/components/component.container","tau/configurations/factory.container.config"],function(a,b,c,d){return b.extend({init:function(a){this._super(a),this.config.placeholder&&this.config.placeholder.addClass("ui-entity-view")},"container afterInit":function(a){this.fireAfterInit()},initialize:function(){},"container afterRender":function(a){this.fireBeforeRender(),this.element=a.data.element,this.config.placeholder&&this.config.placeholder.append(this.element),this.config.placeholder&&this.config.placeholder.addClass("tau-entity-loaded"),this.fireAfterRender()},initializeContainer:function(a){this.container.initialize(a)},"bus contextRetrieved":function(b){var e=this,f=b.data;a.extend(f,d.getConfig(f)),this.container=c.create({name:"entity container",store:this.config.store}),this.container.on("afterInit",this["container afterInit"],this),this.container.on("afterRender",this["container afterRender"],this),e.bus.fire("onConfigContainerCreated",f),this.initializeContainer(f)},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){if(!this.container)return;this.container.destroy(),this.container=null},destroy:function(){this.destroyContainer(),this.container=null,this._super()}})}),define("tau/components/extensions/storeFreeze.extension",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus onConfigContainerCreated":function(a){this.config&&this.config.store&&(this.promise=this.config.store.freeze())},"bus afterInit":function(a){if(!this.promise)return;this.promise.unfreeze(),delete this.promise}})}),define("tau/components/extensions/practice.convert.extension",["Underscore","tau/components/extensions/component.extension.base","tau/configurations/converters/converter.practice"],function(a,b,c){return b.extend({practices:[],init:function(a){this._super(a),this.practices=[]},"bus onContextRetrieved":function(b){var c=b.data,d=this;a.each(c.processes[0].practices,function(a){d.practices.push(a.name)})},"bus onConfigContainerCreated":function(b){if(b.data.context){var d=b.data.context.applicationContext,e=this;e.practices=[],a.each(d.processes[0].practices,function(a){e.practices.push(a.name)})}var f=b.data;c.convert(f,this.practices)}})}),define("tau/components/extensions/extension.storeErrorEmiter",["Underscore","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c){var d=b.extend({"bus beforeInit":function(a){this._super(a);var b=this.config.store,c=this;b.unbind(this),b.on({eventName:"failure",listener:c},function(){c.onFailure.apply(c,arguments)})},onFailure:function(b){var c="Looks like application is not available. Please check your connection or server availability";b.data&&b.data.data&&(b.data.data.Message&&(c=b.data.data.Message),b.data.data.response&&(b.data.data.response.Message&&(c=b.data.data.response.Message),a.isArray(b.data.data.response)&&(c=b.data.data.response[1])));var d=0;b.data&&b.data.data&&(d=b.data.data.status||0),d===500&&window.appIsInDebugMode===!1&&(c="Looks like application is not available. Please check your connection or server availability"),this.fire("error",{message:c}),(d>=400||d===0)&&this.bus.fire("globalFailure"),b.data&&b.data.cmd&&(b.data.cmd.name!=="get"?this.bus.fire("refresh"):d===0&&this.bus.fire("destroy"))},destroy:function(){this.config.store.unbind(this),this._super()}});return d}),define("tau/ui/extensions/ui.extension.loading",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({showWaitIcon:function(){var a=b(".ui-wait-icon");a.length===0?(a=b('<div class="ui-wait-icon"></div>'),a.appendTo("body")):a.show()},"bus beforeInit":function(){this.bus.fire("showLoading","reaction on beforeInit")},"bus showLoading":function(){this.showWaitIcon()},"bus hideLoading":function(){b(".ui-wait-icon").hide()},init:function(a){this._super(a)},"bus beforeInit+afterRender+showLoading":function(a){this.bus.fire("hideLoading","hide on after render"),this.element=a.afterRender.data.element},"bus globalFailure":function(){this.bus.fire("hideLoading","hide on global failure"),this.element&&this.element.show()}})}),define("tau/components/extensions/extension.refresher",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({init:function(a){this._super.apply(this,arguments),this.bus.getGlobalBus().on("entityWasMovedToProject",this.onEntityWasMovedToProject,this)},destroy:function(){this.bus.getGlobalBus().removeListener("entityWasMovedToProject",this.onEntityWasMovedToProject,this),this._super.apply(this,arguments)},"bus onContextRetrieved":function(b){var c=b.data,d=this;a.each(c.processes[0].practices,function(a){d.practices.push(a.name)})},onEntityWasMovedToProject:function(a){var b=this.config.context.id;b==a.data.entity.id&&(this.fire("evictData"),this.fire("refresh"))}})}),define("tau/components/extensions/entity/extension.refresher.project",["Underscore","tau/core/model-base"],function(a,b){return b.extend({onInit:function(){var b=[this.config.context.entityType.name],c=this;c.store.unbind(this),a.forEach(b,function(a){c.store.on({eventName:"beforeSave",type:a,listener:c},function(){c.beforeEntitySave.apply(c,arguments)}),c.store.on({eventName:"afterSave",type:a,listener:c},function(){c.afterEntitySave.apply(c,arguments)})})},"bus contextRetrieved":function(a){this.project=a.data.context.applicationContext.selectedProjects[0]},beforeEntitySave:function(a){(a.data.changes.userStory||a.data.changes.project)&&a.data.cmd.config.fields.push({project:["id"]})},afterEntitySave:function(a){a.data.changes.project&&(this.fire("evictData"),this.fire("refresh"))}})}),define("tau/components/component.entity",["Underscore","tau/components/component.creator","tau/models/model.entity","tau/views/view.entity","tau/components/extensions/storeFreeze.extension","tau/components/extensions/practice.convert.extension","tau/components/extensions/error/extension.errorBar","tau/components/extensions/extension.storeErrorEmiter","tau/ui/extensions/ui.extension.loading","tau/components/extensions/extension.refresher","tau/components/extensions/entity/extension.refresher.project"],function(a,b,c,d,e,f,g,h,i,j,k){return{create:function(l,m){m=m||{};var n=a.clone(m.extensions||[]);n.push(e),n.push(f),n.push(g),n.push(h),n.push(i),n.push(j),n.push(k);var o={name:"entity component",ModelType:c,ViewType:d,extensions:n};return b.create(o,l)}}}),define("tau/models/model.entityList",["Underscore","tau/core/model-base","tau/models/dataprocessor/model.processor.assignments","tau/extensions/extension.underscore"],function(a,b,c){var d=function(a){this.model=a};d.prototype={groupByState:function(b){var c=a.groupBy(b,function(a){var b=2;return a.entityState.isinitial?b=1:a.entityState.isfinal&&(b=3),b});return a(c).sortBy(function(a){return a.key})},completeLoadEntities:function(b,c){c=c||["tasks"];var d=a(b).pluck("data"),e=d[0].tasks,f=d.length>1?d[1].bugs:[],g=[];a.indexOf(c,"tasks")!==-1&&(g=g.concat(e)),a.indexOf(c,"bugs")!==-1&&(g=g.concat(f));var h=this.groupByState(g),i=[];for(var j=0;j<h.length;j++){var k=h[j]?h[j].items:[];i=i.concat(a(k).sortBy(function(a){var b={task:-1,bug:1},c=a.__type;return b[c]||0}))}this.done(this.convertData(i))},convertData:function(a){var b=[];for(var d=0;d<a.length;d++){var e=a[d],f={id:e.id,name:e.name,__type:e.__type,entityState:{id:e.entityState.id,name:e.entityState.name},effort:e.effort,assignments:c.getAssignments(e)};b.push(f)}return b},done:function(a){var b={items:a};this.model.bus.fire("dataBind",b)}};var e=b.extend({_createDetailCommand:function(a){var b={};return b[a]=["id","name","effort",{entityState:["id","name","isinitial","isfinal"]},{roleEfforts:["id",{role:["id","name"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]}],a!="bugs",b},_retrieveEntity:function(b){var c=this.config.context,d=c.entity.entityType.name,e=c.entity.id,f=c.applicationContext.processes[0].practices,g=a.pluck(f,"name"),h=["tasks"];a.indexOf(g,"Bug Tracking")!==-1&&h.push("bugs");var i=this.store;for(var j=0;j<h.length;j++){var k=this._createDetailCommand(h[j]),l={id:e,nested:!0,fields:[k]};i=i.get(d,l)}i.done({success:function(a){return function(c){return b.completeLoadEntities(c,a)}}(h),scope:b})},onInit:function(){var a=new d(this);this._retrieveEntity(a)}});return e}),define("tau/ui/templates/common/ui.template.entityIcon",["tau/core/templates-factory","tau/ui/tags/ui.tag.term"],function(a,b){var c={tags:[b],name:"entity-icon",markup:['<em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">{{term(__type) "iconBig"}}</em>'],dependencies:[]};return a.register(c)}),define("tau/ui/templates/list/ui.template.list.assignments.user",["tau/core/templates-factory"],function(a){var b={name:"list-item-assignments-user",markup:['<b class="assigned-user">${name}</b>',"{{if $data !== $item.last}}&nbsp;|&nbsp;{{/if}}"].join("")};return a.register(b)}),define("tau/ui/templates/list/ui.template.list.item.assignments.group",["tau/core/templates-factory","tau/ui/templates/list/ui.template.list.assignments.user"],function(a){var b={name:"list-item-assignments-group",markup:["<nobr>${role.name}&nbsp;","{{if users.length > 0}}",'{{tmpl(users,{ last: users[users.length - 1] }) "list-item-assignments-user"}}',"{{/if}}","{{if users.length == 0}}",'<span class="unassigned-link">Unassigned</span>',"{{/if}}","</nobr>","{{if $data !== $item.last}}<br/>{{/if}}"].join(""),dependencies:["list-item-assignments-user"]};return a.register(b)}),define("tau/ui/templates/list/ui.template.list.item.assignments",["tau/core/templates-factory","tau/ui/templates/list/ui.template.list.item.assignments.group"],function(a){var b={name:"list-item-assignments",markup:['{{tmpl(groups, {last:groups[groups.length-1]}) "list-item-assignments-group"}}',""].join(""),dependencies:["list-item-assignments-group"]};return a.register(b)}),define("tau/ui/templates/entityList/ui.template.entityList.row",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon","tau/ui/templates/list/ui.template.list.item.assignments"],function(a){var b={name:"entityList-row",markup:["<tr>",'   <td>{{tmpl($data) "entity-icon"}}</td>','   <td class="id">${id}</td>','   <td><b><a href="#${__type}/${id}">${name}</a></b></td>',"   <td><b>${entityState.name}</b></td>","   <td>${effort}&nbsp;h</td>","   <td>",'   {{tmpl(assignments) "list-item-assignments"}}',"   </td>","</tr>"],dependencies:["list-item-assignments","entity-icon"]};return a.register(b)}),define("tau/ui/templates/entityList/ui.template.entityList",["tau/core/templates-factory","tau/ui/templates/entityList/ui.template.entityList.row"],function(a){var b={name:"entityList",options:{contentSelector:".ui-entityList-generalTable"},markup:['<div class="ui-entityList">','    <table cellspacing="0" cellpadding="4" class="ui-table ui-entityList-generalTable"{{if items.length === 0}} style="display:none"{{/if}}>',"        <thead>",'            <tr class="ui-entityList-headRow">','                <th style="width: 1%;">&nbsp;</th>','                <th style="width: 1%;">ID</th>',"                <th>Name</th>","                <th>State</th>","                <th>Effort</th>","                <th>Assignments</th>","            </tr>","        </thead>","        <tbody>",'            {{tmpl(items) "entityList-row"}}',"        </tbody>","    </table>","</div>"],dependencies:["entityList-row"]};return a.register(b)}),define("tau/models/propertyLists/model.propertyList.base",["Underscore","tau/core/model.editable.base"],function(a,b){return b.extend({getAssignable:function(a){var b=this,c=b.config.context.entity,d=c.entityType.name,e=c.id,f={id:e,fields:this.getRequiredFields()};return b.store.get(d,f).done({success:a}),b},sortProjects:function(b){var c=this.config.context.applicationContext,d=a.pluck(c.selectedProjects,"id"),e=b.sort(function(b,c){var e=a.indexOf(d,b.id),f=a.indexOf(d,c.id);return e>=0&&f>=0||e<0&&f<0?b.id-c.id:-1*e+f});return e},getCurrentEntityId:function(){var a=this.config.data.value;return this.config.data.id||a&&a.id},getRequiredFields:function(){return["id"]},onDataRetrieved:function(b){var c=a.pluck(b,"data");this.processData.apply(this,c)},propertyIsNotEmpty:function(){return a.isNumber(this.config.data.id)},"bus updateState":function(a){var b={},c=null;a.data&&a.data.id&&(c={id:a.data.id}),b[this.propertyType]=c,this.fire("save",b)}})}),define("tau/models/propertyLists/model.entityStateList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(a,b){return b.extend({name:"states-list",propertyType:"entityState",onInit:function(){var a=this,b=function(b){var c=b[0].data;a.store.get(a.propertyType,a.createGetStateForAssignableCommand(c)).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};this.getAssignable(b)},getRequiredFields:function(){return[{entityState:["id"]}]},createGetStateForAssignableCommand:function(a){return{id:a.entityState.id,fields:["id","name","isCommentRequired",{nextStates:["id","name","isCommentRequired","numericPriority"]}]}},processData:function(b){var c=[];b.nextStates=a.sortBy(b.nextStates,function(a){return a.numericPriority}),a.each(b.nextStates,function(a){c.push({id:a.id,name:a.name,isCommentRequired:a.isCommentRequired})}),this.fire("dataBind",{states:c,completed:!0,nullableValue:!1})}})}),define("tau/ui/extensions/entityStateList/ui.extension.entityStateList.practices.comment",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){var d=c.extend({"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,this.dataToBind=a.dataBind.data},"bus updateState":function(c){var d=this.entityStateId=c.data.id,e=a(this.dataToBind.states).detect(function(a){return a.id===d&&a.isCommentRequired});if(!e)return;c.cancel();var f=this.element;if(f.find(".ui-entity-state-comment").length>0){f.find(".ui-state-comment-field").focus();return}var g=f.find(".ui-drop-down");g.hide(),g.find(".drop-down-list").listSelectable("disable");var h=b("<div class='ui-entity-state-comment'></div>").append(b("<div class='ui-state-comment-header'>Please, provide comment</div>")).append(b("<div class='ui-state-comment-field-container'></div>").append("<textarea rows='5' class='ui-state-comment-field'></textarea>")).append(b("<div class='button-group'></div>").append(b("<button type='button' class='save button'>Save</button>").click(b.proxy(this._save,this))).append(b("<button type='button' class='cancel button'>Cancel</button>").click(b.proxy(this._cancel,this)))).appendTo(f),i=h.find(".ui-state-comment-field").focus(),j=h.find(".save"),k=function(){window.setTimeout(function(){var a=i.val()||"",b=a.trim().length===0;j.attr("disabled",b?"disabled":!1),b?j.addClass("disable"):j.removeClass("disable")},50)};k(),j.bind("focus",k),i.bind("change keypress",k)},_save:function(a){a.stopPropagation();var b=this,c=this.element.find(".ui-state-comment-field").val();b.fire("save",{id:null,typeName:"comment",$set:{description:c,general:{id:b.config.context.entity.id}},$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName"]}]}),b.fire("save",{$set:{entityState:{id:b.entityStateId}}})},_cancel:function(a){a.stopPropagation(),this.element.find(".ui-entity-state-comment").remove();var b=this.element.find(".ui-drop-down");b.find(".drop-down-list").listSelectable("enable"),b.show()}});return d}),define("tau/components/component.entityStateList",["tau/components/component.creator","tau/models/propertyLists/model.entityStateList","tau/ui/extensions/stateList/ui.extension.stateList.editable","tau/ui/extensions/entityStateList/ui.extension.entityStateList.practices.comment","tau/ui/templates/state/ui.template.state-list"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[d,b,c],template:e};return a.create(g,f)}}}),define("tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(a){var b={name:"feature-assignments-user-list",markup:['<div class="group" roleId="${role.id}">','<table class="role-header">',"   <tr>",'   <td class="role-title">','   {{tmpl "assignments-add-btn"}}',"&nbsp;${role.name}","   </td>","</tr>","</table>",'{{tmpl(users) "user"}}',"</div>"].join(""),dependencies:["user","assignments-add-btn"]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList.userList","tau/ui/templates/common/ui.template.user"],function(a){var b={name:"feature-assignments-list",markup:['<table class="box assignments-table-readonly assignments-table">','    <tr class="title-row">','       <td class="user-list" >','               {{tmpl(assignments.groups, {effortPoints: effortPoints}) "feature-assignments-user-list"}}',"       </td>","   </tr>","</table>"].join(""),dependencies:["feature-assignments-user-list","user"]};return a.register(b)}),define("tau/components/component.feature.assignmentList",["tau/components/component.assignmentsList","tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList"],function(a,b){return{create:function(c){return a.create(c,{template:b})}}}),define("tau/models/model.feature.totalEffort",["tau/core/model-base","tau/core/termProcessor"],function(a,b){var c=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;a.store.get(c,{id:d,fields:["id","userStories-count","effort"]},{scope:this,success:this.onGetEntity}).done({scope:this,success:this.onRequestCompleted})},floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onGetEntity:function(a){var c=a.data,d=this.config.context.applicationContext.processes[0].terms,e=new b(d),f=c["userStories-count"];f>0?(this.userStoriesCount=f,this.featureTerm=e.getTerms("feature").name,this.userStoriesTerm=e.getTerms("userStory").names,this.effort=this.floatToString(c.effort),this.point=this._getEffortPoints(),this.hidden=!1):(this.label="",this.hidden=!0)},onRequestCompleted:function(){this.fire("dataBind",{userStoriesCount:this.userStoriesCount,featureTerm:this.featureTerm,userStoriesTerm:this.userStoriesTerm,effort:this.effort,point:this.point,hidden:this.hidden})}});return c}),define("tau/ui/templates/feature/ui.template.totalEffort",["tau/core/templates-factory"],function(a){var b={name:"total-effort",markup:['<div style="',"{{if hidden}}","display:none","{{/if}}",'">',"{{if !hidden }}",'<div class="ui-total-effort">${featureTerm} has <span class="user-story-count">${userStoriesCount}</span> ${userStoriesTerm} with total effort <span class="effort">${effort}</span> ${point}</div>',"{{/if}}","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.feature.totalEffort",["tau/components/component.creator","tau/models/model.feature.totalEffort","tau/ui/templates/feature/ui.template.totalEffort"],function(a,b,c){return{create:function(d){var e={ModelType:b,template:c};return a.create(e,d)}}}),define("tau/models/model.field.richText",["tau/core/model-base","tau/utils/utils.htmlConverter"],function(a,b){var c=a.extend({name:"field ",init:function(a){this._super.apply(this,arguments),this.fieldName=a.fieldName;if(!a.fieldName)throw"model.field.richText fieldName is undefined"},onInit:function(){var a=this.config.context,b=a.entity.entityType.name,c=a.entity.id,d=this,e=function(a){var b=a.data.changes;if(!b.hasOwnProperty(d.fieldName))return;d.fire("applyChanges",b)},f=function(a){var b=a.data.changes;if(!b.hasOwnProperty(d.fieldName))return;d.fire("prepareChanges",b)};this.store.on({eventName:"beforeSave",type:b,listener:this},f).on({eventName:"afterSave",type:b,listener:this},e);var g={id:c,fields:["id",d.fieldName]};this.store.get(b,g,{scope:this,success:this.entityRetrieved}).done({success:this.requestDone,scope:this})},entityRetrieved:function(a){var b=a.data;this.id=b.id,this.fieldValue=b[this.fieldName]},requestDone:function(){this.bus.fire("dataBind",{html:b.fromSourceToHtml(this.fieldValue)})}});return c}),define("tau/models/model.field.richText.editable",["tau/core/model.editable.base","tau/utils/utils.htmlConverter","tau/utils/utils.jsonSchema"],function(a,b,c){var d=a.extend({category:"edit",name:"model.field.richText.editable",schema:null,init:function(a){this._super.apply(this,arguments);var b={type:"object",properties:{}};this.fieldName=a.fieldName,b.properties[this.fieldName]={optional:!0,empty:!0,type:"string"},this.schema=c.Schema.create(b)},"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(a){var c=a.data.cmd.$set;c[this.fieldName]=b.fromHtmlToSource(c[this.fieldName])},"bus validate":function(a){var b=a.data,c=b.cmd.$set;b.validation=this.schema.validate(c)}});return d}),define("tau/components/extensions/field/extension.field.richText.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(a,b,c){return c.extend({category:"edit","bus prepareChanges":function(a){this.bus.fire("markElementToBeUpdated",{element:this.element})},"bus applyChanges":function(a){var b=this;this.bus.on("afterRender",function(a){a.removeListener(),b.bus.fire("updateElement",{element:b.element})}),this.bus.fire("refresh")},"bus permissionsReady+afterRender":function(c){var d=this;this.element=c.afterRender.data.element;var e=c.permissionsReady.data;if(e.editable){var f=this.element.width(),g=c.afterRender.data.element.find(".ui-description__inner").richeditor({text:this.element.tmplItem().data.html,placeholder:{text:"Double-click to add description...",className:"ui-description__inner_empty_true"},onSave:function(a){var b={};b[d.config.fieldName]=a,d.bus.fire("save",b),g.addClass("data-saving")},settings:{toolbar:[["Cut","Copy","Paste","PasteText","PasteFromWord","-","Bold","Italic","Underline","Strike","-","Subscript","Superscript"],["NumberedList","BulletedList","-","Outdent","Indent"],["JustifyLeft","JustifyCenter","JustifyRight"],["Link","Unlink","Anchor"],["Image","Table","HorizontalRule","SpecialChar"],["Source","Format","Font","FontSize"],["Replace","-","RemoveFormat","TextColor","BGColor","-","Templates"],["Maximize"]],height:450}});g.bind("richeditorbeforeapply",function(c,e){var f=[],g=0,h=d.element.width(),i=b(c.target).richeditor("getSettings");a.each(i.toolbar,function(a){var b=a.length*28+20;g+b>h&&(g=0,f.push("/")),f.push(a),g+=b}),i.toolbar=f,b(c.target).richeditor("setSettings",i)})}}})}),define("tau/ui/templates/field/ui.template.field.richText",["tau/core/templates-factory"],function(a){var b={name:"description",markup:['<div class="ui-description">','   <div class="ui-description__inner">',"      {{html html}}","   </div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.field.richText",["tau/components/component.creator","tau/models/model.field.richText","tau/models/model.field.richText.editable","tau/components/extensions/field/extension.field.richText.editable","tau/ui/templates/field/ui.template.field.richText","tau/ui/extensions/ui.extension.shortcutProcessor"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[b,c,f,d],template:e};return g.shortcutProcessorTarget=".ui-description__inner",a.create(h,g)}}}),define("tau/components/component.description",["tau/components/component.field.richText"],function(a){return{create:function(b){return b=b||{},b.shortcutProcessorTarget=".ui-description__inner",b.fieldName="description",a.create(b)}}}),define("tau/models/finder/model.entity.finder",["Underscore","tau/core/model-base"],function(a,b){var c=b.extend({"bus loadMore+nextPageCommandFormed":function(a){var b=this,c=a.nextPageCommandFormed.data;b.fire("partialDataRequest",{type:c.type,config:c.config})},"bus dataRequestCompleted":function(a){var b=a.data,c=this,d=b.data.isNextPageAvailable();d||c.fire("nextPageIsNotAvailable");var e=b.data.length===0?this.config.emptyDataMessage:null;c.fire("dataLoaded",{data:{emptyMessage:e,items:b.data}}),d&&(c.fire("nextPageCommandFormed",b.data.getNextPageCommand()),c.fire("nextPageAvailable",{}))},getFields:function(){var a=this.config.fields||["id","name",{project:["id","abbreviation"]},{entityState:["id","name"]}];return a},"bus newSearchQuery":function(a){this.processSearchQuery(a)},processSearchQuery:function(b){var c=b.data,d=this;a.extend(c.config,{fields:d.getFields()}),d.fire("partialDataRequest",{type:c.type,config:c.config})},"bus searchConfigFormed":function(a){this.processSearchQuery(a)},onInit:function(){var a=this,b=this.config.actions||[];this.config.emptyDataMessage=this.config.emptyDataMessage||"No data found",a.fire("dataBind",{actions:b,data:{items:[]}}),a.config.context&&a.config.context.entity?a.fire("dataRequest",{type:"general",config:{id:a.config.context.entity.id,fields:[{project:["id","name"]}]},callback:function(b){a.fire("requireSearchConfig",{project:b.data.project})}}):a.fire("requireSearchConfig",{})}});return c}),define("tau/ui/templates/finder/ui.template.resultList.row",["tau/core/templates-factory"],function(a){var b={name:"resultList-row",markup:['<tr class="tau-result-list-row">','   <td class="id" width="1%"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></td>',"   <td>${name}</td>",'   <td style="white-space: nowrap;">{{if entityState }}${entityState.name} {{/if}}</td>','   <td style="white-space: nowrap;">${project.abbreviation}</td>',"</tr>"]};return a.register(b)}),define("tau/ui/templates/finder/ui.template.resultList",["tau/core/templates-factory","tau/ui/templates/finder/ui.template.resultList.row"],function(a){var b={name:"resultList",markup:['<div class="ui-resultList">','<div class="tau-no-results">${emptyMessage}</div>','    <table cellspacing="0" cellpadding="4" class="tau-result-list">',"        <tbody>",'            {{tmpl(items) "resultList-row"}}',"        </tbody>","    </table>",'<div class="tau-resultList-load-more">loading items...</div>',"</div>"],dependencies:["resultList-row"]};return a.register(b)}),define("tau/ui/templates/finder/ui.template.finderAction",["tau/core/templates-factory"],function(a){var b={name:"finder-action",markup:["<span id='${id}' class='action-link tau-finder-action'>${name}</span>"]};return a.register(b)}),define("tau/ui/templates/finder/ui.template.finder",["tau/core/templates-factory","tau/ui/templates/finder/ui.template.resultList","tau/ui/templates/finder/ui.template.finderAction"],function(a){var b={name:"finder",markup:['<div class="ui-finder-placeHolder">','<div class="ui-drop-down drop-down-actions tau-finder-actions">','{{tmpl(actions) "finder-action"}}',,"</div>",'<div class="ui-finder-header">','<div class="visual-search ui-drop-down">','<div class="filter-field-wrapper"><input type="text" class="filter-field"></div>',"</div>","</div>",'{{tmpl(data) "resultList"}}',"</div>"],dependencies:["resultList","finder-action"]};return a.register(b)}),define("tau/models/finder/model.assignable.search",["Underscore","tau/core/model-base","tau/core/termProcessor"],function(a,b,c){return b.extend({init:function(b){this._super(b);var d=function(a,b,c){a.hasOwnProperty(b)||(a[b]={}),a[b].$contains=c},e=function(b,c,d){if(d==="All uncompleted"){b[c]={isFinal:0};return}if(!b.hasOwnProperty(c)||a.isNull(b[c]))b[c]={name:{$in:[]}};if(d==="Backlog"){b[c]=null;return}b[c].name&&b[c].name.$in&&b[c].name.$in.push(d)},f=function(b,c,d){b.hasOwnProperty(c)||(b[c]={$in:[0]});var e=parseInt(d);a.isNumber(e)&&!a.isNaN(e)&&b[c].$in.push(e)};b.context&&b.context.applicationContext&&b.context.applicationContext.processes.length>0&&b.context.applicationContext.processes[0].terms?this.terms=new c(b.context.applicationContext.processes[0].terms):this.terms=new c;var g=this.terms;this.properties={id:{autoCompletable:!1,statement:f},text:{name:"name",autoCompletable:!1,statement:d},name:{autoCompletable:!1,statement:d},description:{autoCompletable:!1,statement:d},tag:{name:"tags",autoCompletable:!1,statement:d},project:{label:g.resolve("project"),autoCompletable:!0,statement:e},state:{name:"entityState",autoCompletable:!0,fields:[{entityType:["id"]}],items:[{label:"All uncompleted",value:"All uncompleted",id:0}],statement:e},iteration:{label:g.resolve("iteration"),autoCompletable:!0,category:"project",items:[{label:"Backlog",value:"Backlog",id:0}],fields:[{project:["id","abbreviation"]}],statement:e},release:{label:g.resolve("release"),autoCompletable:!0,category:"project",items:[{label:"Backlog",value:"Backlog",id:0}],fields:[{project:["id","abbreviation"]}],statement:e},priority:{autoCompletable:!0,fields:[{entityType:["id","name"]}],statement:e}}},getType:function(){return"assignable"},"bus autoCompleteRequest":function(b){var c=b.data,d=this,e=d.properties[c.property];if(!e)return;if(e.autoCompletable!==!0)return;if(e.autoCompleteValues){var f={config:c,data:e.autoCompleteValues};d["bus autoComplete"]({data:f});return}var g=e.hasOwnProperty("name")?e.name:c.property,h=["id","name"];e.hasOwnProperty("fields")&&a.mergeFields(h,e.fields);var i=function(a){var b={data:a.data,config:c};d.fire("autoComplete",b)};d.bus.fire("dataRequest",{type:g,config:{fields:h},callback:i})},_isEqualByCategory:function(a,b,c){return b.hasOwnProperty("category")?a[b.category]?a[b.category].name===c.category:!0:!0},"bus autoComplete":function(b){var c=b.data,d=c.config,e=[],f=this,g=this.properties[d.property];g.hasOwnProperty("items")&&(e=e.concat(g.items)),a.each(c.data,function(b){if(b.name===""||b.name==="-")return;if(a(e).any(function(a){return a.value.toLowerCase()===b.name.toLocaleLowerCase()&&f._isEqualByCategory(b,g,a)}))return;var c={label:b.name,value:b.name,id:b.id,dataItem:b},h=function(){return!0};g.hasOwnProperty("filter")&&(h=g.filter);if(!h.call(this,c,g,d))return;if(g.hasOwnProperty("category")){var i=b[g.category].abbreviation||b[g.category].name;a.extend(c,{category:i,label:b.name+" ["+i+"]"})}e.push(c)});var h=a(e).select(function(a){return!d.term||d.term==""?!0:a.value.toLowerCase().indexOf(d.term.toLowerCase())>=0});d.callback(h)},"bus search":function(b){var c=b.data,d=this,e=c.collection,f={};a.each(e,function(a){var b=d.properties[a.property];if(!b)return;var c=b.name?b.name:a.property;b.statement(f,c,a.value)}),d.bus.fire("newSearchQuery",{type:d.getType(),config:{$orderBy:"name",$query:f,$skip:0,$limit:20}})},getInitialQueryConfig:function(){var a={$skip:0,$limit:20,$query:{}};return a},getInitialQueryString:function(){return""},"bus requireSearchConfig":function(b){var c=this,d=b.data.project,e=c.getInitialQueryConfig();a.defaults(e,{$orderBy:"name"});var f=c.getInitialQueryString();c.fire("searchConfigFormed",{type:c.getType(),config:e,properties:c.properties,searchQuery:f})}})}),define("tau/models/finder/model.general.search",["Underscore","tau/models/finder/model.assignable.search"],function(a,b){return b.extend({init:function(b){var c=this;c._super(b),delete c.properties.release,delete c.properties.iteration,delete c.properties.state,delete c.properties.priority;var d=function(b,d,e){var f=a(c.properties.type.autoCompleteValues).select(function(a){return a.name.indexOf(e.toLowerCase())>=0});b.hasOwnProperty(d)||(b[d]={id:{$in:[0]}}),a.each(f,function(a){b[d].id.$in.push(a.id)})};c.properties.type={name:"entityType",autoCompletable:!0,statement:d,autoCompleteValues:[{id:2,name:c.terms.resolve("release")},{id:3,name:c.terms.resolve("iteration")},{id:4,name:c.terms.resolve("story")},{id:5,name:c.terms.resolve("task")},{id:8,name:c.terms.resolve("bug")},{id:9,name:c.terms.resolve("feature")},{id:11,name:c.terms.resolve("build")},{id:12,name:c.terms.resolve("test case")},{id:13,name:c.terms.resolve("test plan")},{id:14,name:c.terms.resolve("test run")},{id:16,name:c.terms.resolve("impediment")},{id:17,name:c.terms.resolve("request")},{id:21,name:c.terms.resolve("solution")}]}},getInitialQueryConfig:function(){return{$skip:0,$limit:20,$query:{}}},getInitialQueryString:function(){return""},getType:function(){return"general"}})}),define("tau/models/finder/model.data",["Underscore","tau/core/model-base"],function(a,b){return b.extend({"bus dataRequest":function(a){this.config.store.get(a.data.type,a.data.config,{success:a.data.callback}).done()},"bus partialDataRequest":function(a){var b=this,c=function(a){b.fire("dataRequestCompleted",a)};b.config.store.find(a.data.type,a.data.config,{success:c}).done()}})}),define("tau/ui/extensions/finder/ui.extension.list",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/finder/ui.template.resultList"],function(a,b,c,d){return c.extend({appendData:function(a,c){var e=this;e.getShowMoreElement(a).hide();var f=d.get().bind(e.config,c),g=c.emptyMessage||"";e._setNoResultsMessage(a,g);var h=b(".tau-result-list>tbody>tr",f);h.appendTo(b(".ui-resultList>table>tbody",a)),e.bus.fire("dataRendered",{element:a})},_setScrollingMode:function(a,b){this.getList(a).data("noScrolling",!b)},_setNoResultsMessage:function(c,d){var e=b(".tau-no-results",c);e.text(d),d===""||a.isNull(d)||a.isUndefined(d)?e.hide():e.show()},"bus elementReady+dataLoaded":function(a){var b=a.elementReady.data.element,c=a.dataLoaded.data.data;this.appendData(b,c)},"bus dataRendered+nextPageAvailable":function(a){var b=a.dataRendered.data.element;this._setScrollingMode(b,!0)},"bus search+dataLoaded":function(a){var b=this,c=a.search.data.element;this.bus.fire("elementReady",{element:c})},"bus loadMore+dataLoaded":function(a){var b=this,c=a.loadMore.data.element;this.bus.fire("elementReady",{element:c})},getList:function(a){return b(".ui-resultList",a)},attachScrollingEvents:function(a){var b=this,c=b.getList(a).scroll(function(d){c.data("noScrolling")!=1&&c.scrollTop()+c.innerHeight()>=c[0].scrollHeight&&b.bus.fire("scrollToEnd",{element:a})})},"bus search":function(a){var c=a.data.element;b(".tau-result-list>tbody",c).html(""),this.getShowMoreElement(c).show(),this._setNoResultsMessage(c,""),this._setScrollingMode(c,!1);var d=this.getList(c);d.prop({scrollTop:d.get(0).scrollHeight})},_signUpOnActionsAndSelection:function(a){var c=this;c.getList(a).click(function(a){var d=b(a.target).parents("tr.tau-result-list-row:first");if(!d.data)return;var e=d.data();if(!e)return;if(!e.tmplItem)return;e=e.tmplItem.data;if(!e)return;c.bus.fire("entitySelected",{entity:e})}),b(".action-link",a).click(function(){var a=b(this).data().tmplItem.data;a.fn.call(c)})},"bus afterRender":function(a){var b=a.data.element,c=this;c.bus.fire("elementReady",{element:b}),c.attachScrollingEvents(b),c._setScrollingMode(b,!1),this._signUpOnActionsAndSelection(b)},getShowMoreElement:function(a){return b(".tau-resultList-load-more",a)},"bus scrollToEnd+nextPageAvailable":function(a){var b=this,c=a.scrollToEnd.data.element,d=b.getList(c);b._setScrollingMode(c,!1),b.getShowMoreElement(c).show(),d.prop({scrollTop:d.get(0).scrollHeight}),b.bus.fire("loadMore",{element:c})}})}),define("tau/ui/extensions/finder/ui.extension.simpleSearch",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c,d,e){return d.extend({"bus afterRender":function(a){var c=a.data.element,d=this,e=b(".filter-field",c),f=function(){e.is(":visible")&&e.focus()};b(".tau-bubble").bind("show",f),d.fire("showHandlerSigned",{handler:f});var g=function(a){var e=b(this),f=e.val();if(a.keyCode==jQuery.ui.keyCode.ENTER){d.fire("completeInput",{element:c,value:f});return}if(a.keyCode==jQuery.ui.keyCode.DOWN||a.keyCode==jQuery.ui.keyCode.UP)return;d.fire("inputChange",{element:c,value:f})};e.keyup(g),this.disableChange=!1},"bus inputChange":function(a){var b=this;b.lastChangeDate||(b.lastChangeDate=new Date),b.lastArgs||(b.lastArgs={value:""});if(b.lastArgs.value==a.data.value)return;b.lastArgs=a.data,setTimeout(function(){if(!b.lastChangeDate)return;var a=new Date-b.lastChangeDate;a>500&&b.lastArgs&&b.fire("completeInput",b.lastArgs)},501)},"bus partialDataRequest":function(){this.disableChange=!0},"bus dataRequestCompleted":function(){this.disableChange=!1},"bus completeInput":function(a){var b=this;b.lastRequestArgs||(b.lastRequestArgs={value:""});if(b.lastRequestArgs.value==a.data.value)return;var c=a.data.value!==""&&a.data.value!==null?[{property:"name",value:a.data.value}]:[];b.fire("search",{element:a.data.element,collection:c}),b.lastChangeDate=null,b.lastRequestArgs=a.data},"bus destroy+showHandlerSigned":function(a){b(".tau-bubble").unbind("show",a.showHandlerSigned.data.handler)}})}),define("tau/components/component.finder",["tau/components/component.creator","tau/models/finder/model.entity.finder","tau/ui/templates/finder/ui.template.finder","tau/models/finder/model.general.search","tau/models/finder/model.data","tau/ui/extensions/finder/ui.extension.list","tau/ui/extensions/finder/ui.extension.simpleSearch"],function(a,b,c,d,e,f,g){return{create:function(h){var i=b,j=h.searchModel||d;!h.resetDisabled&&h.data&&(h.data.id||h.data.value&&h.data.value.id)&&(h.actions=[{name:"reset",fn:function(){this.bus.fire("entitySelected",{entity:null})}}]);var k={name:"finder",extensions:[e,i,j,f,g],template:c};return h.additionalExtensions&&(k.extensions=k.extensions.concat(h.additionalExtensions)),a.create(k,h)}}}),define("tau/models/baseInfoList/extension.model.additionalInfoImpedimentFilter",["Underscore","tau/models/extension.model.base"],function(a,b){var c=b.extend({"bus extendGetEntityQuery":function(b){var c=b.data.fields,d=["id"];c=b.data.fields=a.uniq(a.union(c,[{owner:d},{responsible:d},"isPrivate"])),a.each(c,function(b){b.hasOwnProperty("entityState")&&(b.entityState=a.uniq(a.union(b.entityState,["isFinal"])))})},"bus filterEntities":function(b){var c=b.data;c.entities=a.select(c.entities,function(a){if(a.entityState.isFinal)return!1;if(!a.isPrivate)return!0;var b=this.config.context.applicationContext.loggedUser.id;return(a.owner||{}).id==b||(a.responsible||{}).id==b},this)}});return c}),define("tau/components/extensions/impedimentList/extension.impedimentList.visibilityController",["jQuery","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({"bus afterRender":function(a){a.data.element.hide()},"bus afterRender+impedimentsCountRetrieved":function(a){if(a.impedimentsCountRetrieved.data.count>0){var b=a.afterRender.data.element;this.config.disableAnimation?b.show():b.slideDown("slow")}}})}),define("tau/components/extensions/impedimentList/extension.impedimentList.count.label.setter",["jQuery","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({"bus afterRender+impedimentsCountRetrieved":function(a){var b=a.impedimentsCountRetrieved.data.count;b>0&&this.fire("setBadgeText",{text:b})}})}),define("tau/models/baseInfoList/extension.model.entityIdRetriever",["tau/models/extension.model.base"],function(a){var b=a.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={};b[this.config.propertyName]=["id"];var c=[b];this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:c},callback:{success:this.onEntityRetrieved,scope:this}})},onEntityRetrieved:function(a){var b=a.data[this.config.propertyName];this.fire("entityIdsRetrieved",b)}});return b}),define("tau/models/baseInfoList/extension.model.additionalInfoEntityRetriever",["Underscore","tau/models/extension.model.base"],function(a,b){var c=b.extend({"bus entityIdsRetrieved":function(a){var b=a.data,c=b.length;for(var d=0;d<c;d++){var e={id:b[d].id,fields:["id","name",{entityState:["name"]}]};this.fire("extendGetEntityQuery",e),this.fire("get",{type:this.config.typeName,query:e})}this.fire("commitTransaction",{scope:this,success:this.onEntitiesRetrieved})},convertServerDataModelData:function(a){return a=a,{__type:a.__type,id:a.id,name:a.name,state:{name:a.entityState.name}}},onEntitiesRetrieved:function(b){var c={entities:a.pluck(b,"data")};this.fire("filterEntities",c),b=c.entities;var d=a.map(b,this.convertServerDataModelData,this);d=a.compact(d),this.fire("entitiesRetrieved",d)}});return c}),define("tau/models/model.list.baseInfo",["tau/core/model-base","tau/models/baseInfoList/extension.model.entityIdRetriever","tau/models/baseInfoList/extension.model.additionalInfoEntityRetriever"],function(a,b,c){var d=a.extend({init:function(a){this._super.apply(this,arguments),this.propertyName=a.propertyName,this.typeName=a.typeName,new b(a),new c(a)},onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction")},"bus entitiesRetrieved":function(a){var b={items:a.data};this.bus.fire("dataBind",b)},"bus evictProperty":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,[this.propertyName])}});return d}),define("tau/models/model.impedimentsCountCalculator",["tau/models/model.list.baseInfo","tau/models/baseInfoList/extension.model.additionalInfoImpedimentFilter"],function(a,b){var c=a.extend({init:function(a){a.propertyName="impediments",a.typeName="impediment",this._super.apply(this,arguments),new b(a)},"bus entitiesRetrieved":function(a){this.fire("impedimentsCountRetrieved",{count:a.data.length})},onGetEntity:function(a){var b=a.data,c=b["impediments-count"];this.fire("impedimentsCountRetrieved",{count:c})}});return c}),define("tau/components/component.impedimentListPanel",["Underscore","tau/components/component.collapsible","tau/components/extensions/impedimentList/extension.impedimentList.visibilityController","tau/components/extensions/impedimentList/extension.impedimentList.count.label.setter","tau/models/model.impedimentsCountCalculator","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(a,b,c,d,e,f,g,h){return{create:function(d){var f=d.context.applicationContext.processes[0].terms,i=new h(f);return d=d||{},a.extend(d,{collapsed:!0,header:[{type:"label.impedimentsCount"}],items:[{type:"impedimentList"}],extensions:[c,e,g]}),b.create(d)}}}),define("tau/models/dataprocessor/model.processor.implementationHistory",["Underscore","tau/core/termProcessor"],function(a,b){var c=function(b,c,d){return a.each(d,function(a){a in c&&(b[a]=c[a])}),b},d=function(a){this._historyItems=a};d.enhance=function(a){return(new this(a)).enhance()},d.prototype={constructor:d,enhance:function(){var a=this._historyItems;return a=this._addDateSpan(a),a},_addDateSpan:function(b){var c=this._createItemStateGroups(b);return a.each(c,function(b){var c=a.first(b).state;c.dateSpan=b.length}),b},_createItemStateGroups:function(b){var c=[],d=null,e=null;return a.each(b,function(a){d!=a.state.name&&(d=a.state.name,e&&c.push(e),e=[]),e.push(a)}),c.push(e),c}};var e=function(a){this._historyItems=a};e.compress=function(a){return(new this(a)).compress()},e.prototype={constructor:e,compress:function(){var a=this._historyItems;return a=this._compressAssignments(a),a=this._compressStates(a),a},_compressStates:function(b){var c=a.select(b,function(a,c){var d=!0;return this._isItemStateNeedsCompression(a.state)&&this._isItemNeedsCompression(a,c,b)&&(d=!1),d},this);return c},_isItemStateNeedsCompression:function(a){return a.isInitial||a.isFinal},_isItemNeedsCompression:function(a,b,c){var d=!1,e=c[b-1],f=!e;if(!f){var g=e.state.name!=a.state.name,h=a.transitions>1,i=a.assignments,j=a.relatedEntities,k=a.spentTime>0;g||!h&&!i&&!j&&!k&&(d=!0)}return d},_compressAssignments:function(a){return this._clearDublicatedAssignmentsForState(a),this._mergeIdenticalAssignmentsForItem(a),a},_clearDublicatedAssignmentsForState:function(b){var c=a.select(b,function(a,c){var d=!1;if(a.assignments){var e=b[c-1];e&&e.state.name==a.state.name&&this._areAssignmentsTheSame(e.assignments,a.assignments)&&(d=!0)}return d},this);a.each(c,function(a){delete a.assignments})},_mergeIdenticalAssignmentsForItem:function(b){a.each(b,function(b){if(b.assignments){var c=[],d={};a.each(b.assignments,function(a){a.id in d?d[a.id].roles.push(a.role):(d[a.id]=a,a.roles=[a.role],delete a.role,c.push(a))}),b.assignments=c}})},_areAssignmentsTheSame:function(b,c){var d=a.pluck(b,"id").join(""),e=a.pluck(c,"id").join("");return d==e}};var f=function(a){this._inputData=a,this._termProcessor=new b(a.terms)};return f.transform=function(a){return(new this(a)).transform()},f.prototype={constructor:f,transform:function(){var a={entityStates:this._getEntityStateNames(),historyItems:this._getHistoryItems()};return a},_getHistoryEntries:function(){return this._inputData.response[0].data.statistics.entries},_getAllEntityStatesForProcess:function(){return this._inputData.response[1].data.entityStates},_getAllUsers:function(){return this._inputData.response[2].data},_getAllRoles:function(){return this._inputData.response[3].data},_getEntityStateNames:function(){var b=this._getEntityStates(),c=this._sortEntityStates(b),d=a.map(c,function(a){return a.name});return d},_getEntityStates:function(){var b=this._inputData.entityTypeName,c=a.select(this._getAllEntityStatesForProcess(),function(a){return b.toLowerCase()==a.entityType.name.toLowerCase()});return c},_sortEntityStates:function(b){var c=a.sortBy(b,function(a){var b=a.numericPriority;return a.isInitial?b=Number.NEGATIVE_INFINITY:a.isFinal&&(b=Number.POSITIVE_INFINITY),b}).reverse();return c},_getHistoryItems:function(){var b=[];return a.each(this._getHistoryEntries(),function(a){b.push(this._createHistoryItem(a))},this),b=this._sortHistoryItems(b),b=this._enhanceHistoryItems(b),b=this._compressHistoryItems(b),b},_createHistoryItem:function(b){var c={date:new Date(Date.parse(b.date)),spentTime:parseFloat(b.time),transitions:parseFloat(b.transitions),state:this._getHistoryEntryState(b)},d=this._getHistoryEntryRelatedEntities(b);return a.isEmpty(d)||(c.relatedEntities=d),b.assignments&&(c.assignments=this._getHistoryEntryAssignments(b)),c},_getHistoryEntryState:function(a){var b=this._getEntityStateInfo(a.stateId),d=c({},b,["name","isInitial","isFinal"]);return b.role&&(d.roleId=b.role.id),d},_getEntityStateInfo:function(b){var c=a.detect(this._getAllEntityStatesForProcess(),function(a){return b==a.id});return c},_getHistoryEntryRelatedEntities:function(a){var b=c({},a,["opened","closed"]);return this._setEntityAlias(b.opened),this._setEntityAlias(b.closed),b},_setEntityAlias:function(b){a.each(b,function(a){var b=this._getEntityAlias(a.type);b&&(a.alias=b)},this)},_getEntityAlias:function(a){var b=this._termProcessor.getTerms(a);return b?b.name:null},_getHistoryEntryAssignments:function(b){var c=[];return a.each(b.assignments,function(a){var b=this._getUserInfo(a.userId);b&&c.push({id:a.userId,firstName:b.firstName,lastName:b.lastName,role:{id:parseInt(a.roleId),name:this._roleIdToName(a.roleId)}})},this),c},_getUserInfo:function(b){var d=null,e=a.detect(this._getAllUsers(),function(a){return b==a.id});return e&&(d=c({},e,["firstName","lastName"])),d},_roleIdToName:function(b){var c=a.detect(this._getAllRoles(),function(a){return b==a.id});return c.name},_sortHistoryItems:function(b){return a.sortBy(b,function(a){return new Date(Date.parse(a.date))})},_enhanceHistoryItems:function(a){return d.enhance(a)},_compressHistoryItems:function(a){return e.compress(a)}},f}),define("tau/models/model.implementationHistory",["Underscore","tau/core/model-base","tau/models/dataprocessor/model.processor.implementationHistory","tau/configurator","tau/core/types"],function(a,b,c,d,e){return b.extend({onInit:function(){var a=this.config.context,b="implementationHistory";this.store.evictProperties(this.config.context.entity.id,"implementationHistory",["statistics"]),this.store.get(b,{id:a.entity.id,fields:["id","statistics"]}).get("process",{id:a.applicationContext.processes[0].id,fields:[{entityStates:["id","name","isInitial","isFinal","numericPriority",{entityType:["id","name"]},{role:["id"]}]}]}).get("user",{fields:["id","firstName","lastName"]}).get("roles",{fields:["id","name"]}).done({scope:this,success:this.onDone}),this.store.unbind(this),this._bindToStoreChanges()},_bindToStoreChanges:function(){this._bindToStoreAfterSafe(),this._bindToStoreAfterRemove()},_bindToStoreAfterSafe:function(){this.store.on({eventName:"afterSave",type:this.config.context.entity.entityType.name,listener:this,filter:{id:this.config.context.entity.id},hasChanges:["entityState"]},this._getOnStoreChangesProxy()),a.each(this._getStoreObservableEntityTypes(),function(a){this.store.on({eventName:"afterSave",type:a,listener:this},this._getOnStoreChangesProxy())},this)},_bindToStoreAfterRemove:function(){a.each(this._getStoreObservableEntityTypes(),function(a){this.store.on({eventName:"afterRemove",type:a,listener:this},this._getOnStoreChangesProxy())},this)},_getStoreObservableEntityTypes:function(){if(!this._storeObservableEntityTypes){var a=["assignment","impediment"];switch(this.config.context.entity.entityType.name){case"userstory":a.push("task","bug");break;case"feature":a.push("userstory");break;case"request":a.push("feature","userstory","task","bug")}this._storeObservableEntityTypes=a}return this._storeObservableEntityTypes},_onStoreChanges:function(a){this.store.evictProperties(this.config.context.entity.id,"implementationHistory",["statistics"]),this.fire("afterUpdate")},_getOnStoreChangesProxy:function(){return this._onStoreChangesProxy||(this._onStoreChangesProxy=a.bind(this._onStoreChanges,this)),this._onStoreChangesProxy},onDone:function(a){var b=c.transform({response:a,entityTypeName:this.config.context.entity.entityType.name,terms:this.config.context.applicationContext.processes[0].terms});this.fire("dataBind",b)}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.dateRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date"],function(a,b,c,d){return c.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var c=this._$element.find(".tau-historyGrid td.tau-historyItem");a.each(this._data.historyItems,function(a,e){var f=c.eq(e),g=f.find(".tau-date"),h=b("<span/>").addClass("tau-day"),i=b("<span/>").addClass("tau-month");h.text(d.formatAs(a.date,"dd")),i.text(d.formatAs(a.date,"MMM")),g.attr("title",d.format.date.short(a.date)).append(h,i)})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.stateProgressRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){this._createFlowIndicators(),this._connectMarkers(),this.fire("stateProgressRendered")},_createFlowIndicators:function(){var b=this._$element.find(".tau-historyGrid .tau-historyItem");a.each(this._data.historyItems,function(a,c){this._markProgressStep(b.eq(c),a)},this)},_getHistoryItemStateIndex:function(b){return a.indexOf(this._data.entityStates,b)},_getFlowType:function(a){var b="NORMAL";return a.state.isFinal?b="DONE":this._isUnderImpediment(a)?b="IMPEDIMENT":a.transitions>1&&(b="MULTITRANS"),b},_isUnderImpediment:function(b){var c=a.any(this._getImpedimentRangeList(),function(a){return this._isInImpedimentRange(b,a)},this);return c},_getImpedimentRangeList:function(){if(!this._impedimentRangeList){this._impedimentRangeList=[];var b=this._getAllImpediments();a.each(b.opened,function(a,c){this._impedimentRangeList.push({start:a,end:b.closed[c]||Number.POSITIVE_INFINITY})},this),this._impedimentRangeList.sort(function(a,b){return b.end-b.start-(a.end-a.start)})}return this._impedimentRangeList},_getAllImpediments:function(){var b={opened:{},closed:{}};return a.each(this._data.historyItems,function(c){c.relatedEntities&&(a.each(c.relatedEntities.opened,function(a){this._isImpediment(a)&&(b.opened[a.id]=c.date)},this),a.each(c.relatedEntities.closed,function(a){this._isImpediment(a)&&(b.closed[a.id]=c.date)},this))},this),b},_isImpediment:function(a){return a.type.toLowerCase()=="impediment"},_isInImpedimentRange:function(a,b){return a.date>=b.start&&a.date<=b.end},_markProgressStep:function(a,c){var d=this._getHistoryItemStateIndex(c.state.name),e=this._getFlowType(c),f=this._createFlowIndicator(e),g=c.state.dateSpan;g&&!c.state.isFinal&&b("<span/>").addClass("datespan").text(g).attr("title",g+" consecutive days in this state").appendTo(f),a.find(".tau-progressSteps .tau-step:nth-child("+(d+1)+") .tau-marker").append(f)},_createFlowIndicator:function(a){var c=b("<div/>").addClass("tau-flow");switch(a){case"NORMAL":c.addClass("tau-normal");break;case"MULTITRANS":c.addClass("tau-transitions");break;case"IMPEDIMENT":c.addClass("tau-impediment");break;case"DONE":c.addClass("tau-done")}return c},_connectMarkers:function(){a.each(this._data.historyItems,function(a,b){var c=this._getHistoryItemStateIndex(a.state.name);this._connect(b,c,b-1,"in"),this._connect(b,c,b+1,"out")},this)},_connect:function(a,b,c,d){var e=this._data.historyItems[c];if(e){var f=this._getHistoryItemStateIndex(e.state.name),g=b-f;g>0&&this._$element.find(".tau-historyGrid .tau-historyItem").eq(a).find(".tau-progressSteps .tau-step").filter(function(a){return a>=f+1&&a<=b}).find(".tau-marker").addClass("tau-"+d)}}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.stateHistogramRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var a=this._createStateDateItemsHash();this._$element.find(".tau-historyGridInterpretation .stateName").each(function(c,d){var e=b(d),f=a[e.text()],g=e.attr("title")+" ("+f.absolute+" days)";e.attr("title",g).addClass("tau-dateItems-"+f.relative)})},_createStateDateItemsHash:function(){var b={};return a.each(this._data.entityStates,function(a){b[a]={absolute:0,relative:0}}),this._calculateAbsoluteHashValues(b),this._calculateRelativeHashValues(b),b},_calculateAbsoluteHashValues:function(b){a.each(this._data.historyItems,function(a){var c=a.state.dateSpan;c&&(b[a.state.name].absolute+=c)})},_calculateRelativeHashValues:function(b){var c=a.max(b,function(a){return a.absolute}).absolute;a.each(b,function(a,d){var e=a.absolute*100/c;b[d].relative=Math.round(e/10)*10})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.timeLoadRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){if(this._timeLoadWasReported()){var b=this._calculateMaxSpentTime(),c=this._$element.find(".tau-historyGrid td.tau-historyItem");a.each(this._data.historyItems,function(a,d){var e=a.spentTime,f=c.eq(d).find(".tau-date"),g=this._calculateRelatedRoundedSpentTime(b,e);if(!isNaN(g)){var h=f.attr("title");f.addClass("tau-timeLoad-"+g).attr("title",h+" ("+e+" hours)")}},this)}},_timeLoadWasReported:function(){return a.any(this._data.historyItems,function(a){return a.spentTime>0})},_calculateMaxSpentTime:function(){return a.max(this._data.historyItems,function(a){return a.spentTime}).spentTime},_calculateRelatedRoundedSpentTime:function(a,b){var c=b*100/a,d=Math.round(c/10)*10;return d}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){var d={create:function(a,c){return b("<div/>").addClass(this._createClassName(a,c)).attr("title",this._createTitle(a,c)).data("entityInfo",{id:a.id,type:a.type,alias:a.alias||a.type}).click(this._onRelatedEntityClick)},_createTitle:function(a,b){var c=["["+(a.alias||a.type)+"]"," #"+a.id,a.name,b?"(closed)":"(added)"].join(" ");return c},_createClassName:function(a,b){var c=["tau-entity","tau-"+a.type.toLowerCase(),b?"tau-closed":""].join(" ");return c},_onRelatedEntityClick:function(a){var c=b(this).data("entityInfo");c&&location.assign("#"+c.type+"/"+c.id)}};return c.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var b=this._$element.find(".tau-historyGrid .tau-historyItem");a.each(this._data.historyItems,function(c,e){var f=b.eq(e).find(".tau-relatedEntities");c.relatedEntities&&(a.each(c.relatedEntities.opened,function(a){f.append(d.create(a))}),a.each(c.relatedEntities.closed,function(a){f.append(d.create(a,!0))}))})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.assignmentsRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c,d){return c.extend({"bus afterRender+stateProgressRendered":function(a){this._$element=a.afterRender.data.element,this._data=a.afterRender.data.data,this._render()},_render:function(){var c=this._$element.find(".tau-historyGrid .tau-historyItem");a.each(this._data.historyItems,function(a,d){a.assignments&&!a.state.isFinal&&b('<div class="tau-assignments"/>').insertAfter(c.eq(d).find(".tau-flow")).append(this._getAssignments(a))},this)},_getAssignments:function(b){var c=[];return a.each(b.assignments,function(a){var e=[a.firstName,a.lastName,"("+this._getAssignmentRoles(a)+")"].join(" "),f=d.getApplicationPath()+"/Avatar.ashx?UserId="+a.id+"&size=50",g=this._isActiveAssignment(a,b)?' class="active"':"";c.push("<img"+g+' alt="avatar" title="'+e+'" src="'+f+'"/>')},this),c.join("")},_getAssignmentRoles:function(b){return a.map(b.roles,function(a){return a.name}).join(", ")},_isActiveAssignment:function(b,c){return a.any(b.roles,function(a){return a.id==c.state.roleId})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.legendRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date"],function(a,b,c,d){return c.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render(),this._bindEvents()},_render:function(){var a=b('<div class="tau-legend"></div>'),c=b('<h3><span class="tau-legendToggler">Legend</span></h3>');a.append(c,this._createGroups()),this._setState(a),a.appendTo(this._$element)},_createGroups:function(){var a=b('<div class="tau-groups"></div>');this._createGroupElement("Progress Flow",this._getProgressFlowTypes()).appendTo(a);var c=this._getRelatedEntitiesTypes();return c&&this._createGroupElement("Related Entities",c).appendTo(a),this._createGroupElement("Histograms",this._getHistogramTypes()).appendTo(a),a},_createGroupElement:function(c,d){var e=b("<dl/>"),f=b("<dt/>").text(c);return e.append(f),a.each(d,function(a){var c=b("<dd/>"),d=b(a.element).addClass("glyph");c.text(a.description),c.prepend(d),e.append(c)}),e},_getProgressFlowTypes:function(){var c=this._$element.find(".tau-historyGrid .tau-historyItem .tau-flow"),d={};a.each(c,function(a){var c=b.trim(a.className.replace("tau-flow",""));c in d||(d[c]=b(a).clone().empty().removeAttr("title"))});var e=a.map(d,function(a,b){var c={element:a};switch(b){case"tau-normal":c.description="normal flow";break;case"tau-transitions":c.description="multiple state transitions";break;case"tau-impediment":c.description="impediment";break;case"tau-done":c.description="final state"}return c});return e},_getRelatedEntitiesTypes:function(){var c=null,d=this._$element.find(".tau-historyGrid .tau-historyItem .tau-entity");if(d.size()>0){var e={};a.each(d,function(a){var c=b.trim(a.className.replace(/tau-entity|tau-closed/g,""));c in e||(e[c]=b(a).clone(!0).unbind().removeAttr("title"))});var f=a.map(e,function(a,b){return{element:a,description:a.data("entityInfo").alias}});c=[{element:b('<div class="tau-entity"></div>'),description:"entity (added)"},{element:'<div class="tau-entity tau-closed"></div>',description:"entity (closed)"}].concat(f)}return c},_getHistogramTypes:function(){var a=[];return a.push({element:this._getElementForStateHistogram(),description:"total days in entity state"}),this._timeLoadWasReported()&&a.push({element:this._getElementForTimeLoadHistogram(),description:"daily total spent time"}),a},_getElementForStateHistogram:function(){var a=b(['<div class="tau-historyGridInterpretation">','<div class="stateName tau-dateItems-50">',"<span>State name</span>","</div>","</div>"].join(""));return a},_timeLoadWasReported:function(){return a.any(this._data.historyItems,function(a){return a.spentTime>0})},_getElementForTimeLoadHistogram:function(){var a=new Date(0),c=b(['<div class="tau-date tau-timeLoad-50">','<span class="tau-day">'+d.formatAs(a,"dd")+"</span>",'<span class="tau-month">'+d.formatAs(a,"MMM")+"</span>","</div>"].join(""));return c},_setState:function(a){this._isCollapsed()&&this._collapse(a)},_bindEvents:function(){this._$element.find(".tau-legend .tau-legendToggler").click(b.proxy(this,"_toggleState"))},_toggleState:function(a){var c=b(a.currentTarget).parents(".tau-legend");this._isCollapsed()?this._uncollapse(c):this._collapse(c)},_isCollapsed:function(){return localStorage.getItem("implementationHistoryLegendState")=="collapsed"},_uncollapse:function(a){localStorage.removeItem("implementationHistoryLegendState"),a.removeClass("tau-collapsed")},_collapse:function(a){localStorage.setItem("implementationHistoryLegendState","collapsed"),a.addClass("tau-collapsed")}})}),define("libs/jquery/jquery.mousewheel",["jQuery"],function(a){(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(a)}),define("tau/components/extensions/implementationHistory/component.implementationHistory.historyGridScroller",["Underscore","jQuery","tau/components/extensions/component.extension.base","libs/jquery/jquery.mousewheel"],function(a,b,c){return c.extend({"bus afterRender":function(a){a.data.element.find(".tau-historyGrid").mousewheel(b.proxy(this,"_onMouseWheel"))},_onMouseWheel:function(a,c){var d=a.currentTarget;if(this._isScrollActive(d)){a.preventDefault();var e=b(d),f=e.scrollLeft(),g=f+ -c*100;e.scrollLeft(g)}},_isScrollActive:function(a){return a.scrollWidth>a.offsetWidth}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesHighlighter",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender":function(a){this._$relatedEntities=a.data.element.find(".tau-relatedEntities .tau-entity"),this._$relatedEntities.hover(b.proxy(this,"_onHoverIn"),b.proxy(this,"_onHoverOut"))},_getRelatedEntities:function(a){var c=b(a).data("entityInfo").id;return this._$relatedEntities.filter(function(){return c==b(this).data("entityInfo").id})},_onHoverIn:function(a){this._getRelatedEntities(a.currentTarget).addClass("tau-highlight")},_onHoverOut:function(a){this._getRelatedEntities(a.currentTarget).removeClass("tau-highlight")}})}),define("tau/ui/behaviour/overlay/ui.behaviour.overlay",["Underscore","jQuery"],function(a,b){b.widget("ui.tauOverlay",{options:{showOnCreation:!0},_create:function(){this.$target=this.element,this.options.showOnCreation&&this.show()},showLarge:function(){this._show("ui-spinner-centered")},show:function(){this._show("ui-overlay")},_show:function(a){var c=this;c.$overlay=c.overlay||b(['<div class="',a,'"></div>'].join("")),c.$overlay.detach(),c.$target.addClass("ui-overlay-container");var d=b("body");c.$target.css("position")==="relative"?d=c.$target:d=c.$target.offsetParent(),d.append(c.$overlay)},hide:function(){var a=this;a.destroy()},destroy:function(){var a=this;a.$target.removeClass("ui-overlay-container"),a.$overlay&&a.$overlay.remove(),b.Widget.prototype.destroy.apply(this,arguments)}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.updateOverlay",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(a){return a.extend({"bus afterRender":function(a){this._$element=a.data.element},"bus afterUpdate":function(a){this._$element.tauOverlay(),this.fire("refresh")}})}),define("tau/ui/templates/implementationHistory/ui.template.implementationHistoryItem",["tau/core/templates-factory"],function(a){var b={name:"implementationHistoryItem",options:{},dependencies:[],markup:['<td class="tau-historyItem">','<div class="tau-progressSteps">',"{{each(index, step) $item.parent.data.entityStates}}",'<div class="tau-step">','<div class="tau-marker"/>',"</div>","{{/each}}","</div>",'<div class="tau-date"></div>','<div class="tau-relatedEntities"></div>',"</td>"].join("")};return a.register(b)}),define("tau/ui/templates/implementationHistory/ui.template.implementationHistory",["tau/core/templates-factory","tau/ui/templates/implementationHistory/ui.template.implementationHistoryItem"],function(a){var b={name:"implementationHistory",options:{},dependencies:["implementationHistoryItem"],markup:['<div class="tau-implementationHistory">','<div class="tau-historyGridInterpretation">',"{{each(index, stateName) entityStates}}",'<div class="stateName" title="${stateName}">',"<span>${stateName}</span>","</div>","{{/each}}","<div>Date</div>","<div>Related Entities</div>","</div>",'<div class="tau-historyGrid">',"<table>","<tbody>","<tr>",'{{tmpl(historyItems) "implementationHistoryItem"}}',"</tr>","</tbody>","</table>","</div>","</div>"].join("")};return a.register(b)}),define("tau/components/component.implementationHistory",["tau/components/component.creator","tau/models/model.implementationHistory","tau/components/extensions/implementationHistory/component.implementationHistory.dateRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.stateProgressRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.stateHistogramRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.timeLoadRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.assignmentsRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.legendRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.historyGridScroller","tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesHighlighter","tau/components/extensions/implementationHistory/component.implementationHistory.updateOverlay","tau/ui/templates/implementationHistory/ui.template.implementationHistory"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){return{create:function(n){var o=n||{},p={extensions:[b,c,d,e,f,g,h,i,j,k,l],template:m};return a.create(p,o)}}}),define("tau/ui/templates/common/ui.template.attributeValue",["tau/core/templates-factory"],function(a){var b={name:"common-attributeValue",markup:['<span class="attr-item popup-target"><span class="attr-name">${name}</span></span>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/progressBar/ui.template.iteration.progressBar",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(a,b){var c={name:"iteration-progress-bar",tags:[b],markup:['<div class="entity-progress-box">','   <div class="ui-progressbar__data">','      <span class="ui-label-completed">Completed&nbsp;<b class="value">${effortCompleted}${point}</b></span>','      <span class="ui-label-todo">ToDo&nbsp;<b class="value">${effortToDo}${point}</b></span>',"   </div>",'   <div class="ui-progress-bar-progress ui-progressbar__progress">',"{{if percentCompleted !== 0 }}",'      <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${ Math.round(percentCompleted) < 15 ? 15 : Math.round(percentCompleted) }%;">','         <span class="ui-label ui-progressbar__progress__label"><b class="value">${ Math.round(percentCompleted) }%</b></span>',"      </span>","{{/if}}","   </div>","</div>"],dependencies:["common-attributeValue"]};return a.register(c)}),define("tau/components/component.iteration.progressBar",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/progressBar/ui.template.iteration.progressBar"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/ui/tags/ui.tag.implode",["Underscore"],function(a){return{register:function(b,c){c.$tau=c.$tau||{},c.$tau.text_implode=function(b){var c=new String(b);if(a.isString(b))c=b;else if(a.isArray(b)){var d=a.clone(b),e=d.pop();c=a.filter([d.join(", "),e],function(a){return a!=0}).join(" &amp; ")}return c}}}}),define("tau/ui/templates/label/ui.template.label",["tau/core/templates-factory","tau/ui/tags/ui.tag.implode"],function(a,b){var c={name:"label",tags:[b],markup:['<div><span class="ui-label{{if cssClass}} ${cssClass}{{/if}}">${$item.$tau.text_implode(text)}</span></div>'],dependencies:[]};return a.register(c)}),define("tau/ui/extensions/label/ui.extension.label",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender+setBadgeText":function(a){this.element=a.afterRender.data.element,this._getBadgeElement().text(a.setBadgeText.data.text),this.config.quantityCssClass&&this._getBadgeElement().addClass(this.config.quantityCssClass)},_getBadgeElement:function(){var a=this.element.find(".ui-quantity");return a.length==0&&(a=b('<span class="ui-quantity"></span>').appendTo(this.element)),a}})}),define("tau/components/component.label",["Underscore","tau/components/component.creator","tau/models/model.label","tau/ui/templates/label/ui.template.label","tau/ui/extensions/label/ui.extension.label"],function(a,b,c,d,e){return{create:function(f){var g={ModelType:c,template:d,extensions:a.clone(f.extensions||[])};return f.hideCounter||g.extensions.push(e),b.create(g,f)}}}),define("tau/components/component.label.impedimentsCount",["Underscore","tau/components/component.label","tau/components/extensions/impedimentList/extension.impedimentList.count.label.setter","tau/models/model.impedimentsCountCalculator","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(a,b,c,d,e,f,g){return{create:function(e){var h=e.context.applicationContext.processes[0].terms,i=new g(h);return e=e||{},a.extend(e,{text:i.getTerms("Impediment").names,quantityCssClass:e.quantityCssClass||"ui-red-quantity",extensions:[c,d,f]}),b.create(e)}}}),define("tau/ui/templates/list/ui.template.list.baseInfo.item",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(a){var b={name:"list-base-info-item",markup:['<tr class="{{if $item.index %2 != 0}}alternative-row{{/if}}">','   <td class="entity-type tau-list__table__cell-id">{{tmpl($data) "entity-link"}}</td>','   <td class="name">${name}</td>','   <td class="state">${state.name}</td>',"</tr>"].join(""),dependencies:["entity-link"]};return a.register(b)}),define("tau/ui/templates/list/ui.template.list.baseInfo",["tau/core/templates-factory","tau/ui/templates/list/ui.template.list.baseInfo.item"],function(a){var b={name:"request-list",options:{contentSelector:".request-list"},markup:['<div class="ui-base-info-list-content">','<table class="ui-table base-info-list" cellpadding="4" cellspacing="0" {{if items.length === 0}}style="display:none"{{/if}}>',"<tbody>","{{each items}}",'    {{tmpl($value, {index:$index}) "list-base-info-item"}}',"{{/each}}","</tbody>","</table>","</div>"].join(""),dependencies:["list-base-info-item"]};return a.register(b)}),define("tau/ui/extensions/baseList/ui.extension.baseList",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus beforeInit":function(a){var b=a.data.config;this.options={emptyDataMessage:b.emptyDataMessage||"No data",contentSelector:b.contentSelector||null,emptyElementCssClass:b.emptyElementCssClass||"ui-empty-data-msg"}},"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,a.dataBind.data.items.length===0&&this._applyToggleNoData(!0)},"bus hideListContent":function(a){this._applyToggleNoData(!0)},"bus showListContent":function(a){this._applyToggleNoData(!1)},_applyToggleNoData:function(a){this._toggleNoData(a)},_getVisibilityMethodName:function(a){return a?"show":"hide"},_toggleNoData:function(a){var b=this._getVisibilityMethodName(!a),c=this._getVisibilityMethodName(a),d=this.element,e=this.options;d.find(e.contentSelector)[b](),this._getNoDataMessageElement(d,e)[c]()},_getNoDataMessageElement:function(a,c){var d=a.find("."+c.emptyElementCssClass);return d.length===0&&(d=b(['<span class="',c.emptyElementCssClass,'">',c.emptyDataMessage,"</span>"].join("")).appendTo(a)),d}})}),define("tau/components/component.list.creator",["tau/components/component.creator","tau/ui/extensions/baseList/ui.extension.baseList"],function(a,b){return{create:function(c,d){return d.emptyDataMessage=c.message,d.contentSelector=c.template.options.contentSelector,c.showEmptyMessage!==!1&&(c.extensions=c.extensions||[],c.extensions.push(b)),a.create(c,d)}}}),define("tau/components/component.comments",["Underscore","tau/components/component.list.creator","tau/components/extensions/component.creator.extension","tau/models/model.comments","tau/models/model.comments.editable","tau/ui/extensions/ui.extension.shortcutProcessor","tau/ui/extensions/comments/ui.extension.comments.editable","tau/ui/extensions/comments/ui.extension.comments.add","tau/ui/templates/comments/ui.template.comments"],function(a,b,c,d,e,f,g,h,i){return{create:function(j){var k={extensions:a.concat([d,e,f,g,h,c,j.extensions]),template:i,showEmptyMessage:!1};return j.shortcutProcessorTarget=".ui-comment-text",b.create(k,j)}}}),define("tau/components/component.entityList",["tau/components/component.list.creator","tau/models/model.entityList","tau/ui/templates/entityList/ui.template.entityList"],function(a,b,c){return{create:function(d){var e={ModelType:b,template:c,message:"No tasks and bugs found"};return a.create(e,d)}}}),define("tau/components/component.list.baseInfo",["Underscore","tau/components/component.list.creator","tau/models/model.list.baseInfo","tau/models/assignmentsList/extension.model.store.operations","tau/ui/templates/list/ui.template.list.baseInfo","tau/core/termProcessor"],function(a,b,c,d,e,f){return{create:function(g,h){var i=g.context.applicationContext.processes[0].terms,j=new f(i);return h=h||{},h.extensions=a.compact(a.union(h.extensions,[c])),a.extend(h,{message:"No "+j.getTerms(g.typeName).names.toLowerCase()+" found",ModelType:d,template:e}),b.create(h,g)}}}),define("tau/components/component.impedimentList",["Underscore","tau/components/component.list.baseInfo","tau/models/baseInfoList/extension.model.additionalInfoImpedimentFilter"],function(a,b,c){return{create:function(a){return a.typeName="impediment",a.propertyName="impediments",b.create(a,{extensions:[c]})}}}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.progress",["tau/core/templates-factory"],function(a){var b=["{{if !$item.parent.parent.data.config.currentView.timeTrackingPolicies.disableSpentRemain}}","Time spent: ${timeSpent}{{if timeSpent}}h{{/if}}","\\n","Time remain: {{if !timeRemain && timeRemain !== 0}}N/A{{else}}${timeRemain}{{if timeRemain}}h{{/if}}{{/if}}","\\n","{{/if}}","Percent complete: ${percentComplete}%"].join(""),c={name:"cell-progress",markup:['<div{{if percentFromMaximum == 0}} class="tau-extension-tooltip" title="'+b+'"{{/if}}>',"{{if percentFromMaximum > 0}}",'    <div class="ui-progress-bar-progress ui-progressbar__progress tau-extension-tooltip" style="width:${percentFromMaximum}%;" title="'+b+'">','        <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${percentComplete}%;{{if percentComplete == 0}}display:none;{{/if}}"></span>',"    </div>","{{/if}}","</div>"]};return a.register(c)}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.assignments",["tau/core/templates-factory"],function(a){var b={name:"cell-assignments",markup:['<span class="ui-assignment__group">','   <span class="ui-assignment__group__title">${role.name}</span>',"   {{if users.length}}",'   <span class="ui-assignment__group__users">',"   {{each users}}",'       <span class="ui-assignment__user">','           <img style="width:24px; height:24px;" src="${avatarUrl}" alt="${name}" title="${name}" />',"       </span>","   {{/each}}","   </span>","   {{else}}",'   <span class="ui-assignment__group__unassigned">Unassigned</span>',"   {{/if}}","</span>"]};return a.register(b)}),define("tau/ui/templates/title/ui.template.title.simple",["tau/core/templates-factory"],function(a){var b={name:"ui.template.title.simple",markup:['<div class="ui-title-simple">','   <div class="entity-title">${entity.name}</div>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.name",["tau/core/templates-factory","tau/ui/templates/title/ui.template.title.simple"],function(a){var b={name:"cell-name",markup:['<span class="tau-title-container">','<div class="tau-title" title="${name}" runas="title" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.title.simple">${name}</div>',"</span>","{{if tags.length}}",'   <span class="tau-tags">${tags[0]}</span>','   {{if tags.length > 1}}<span class="tau-tags">&#133;</span>{{/if}}',"{{/if}}"]};return a.register(b)}),define("tau/ui/tags/ui.tag.abbr",["Underscore","jQuery"],function(a,b){return{register:function(a,c){c.$tau=c.$tau||{},c.$tau.abbr=function(a,c){var d=a||"",e=d.substr(0,c);return b.trim(e)}}}}),define("tau/ui/templates/common/ui.template.userIcon",["tau/core/templates-factory"],function(a){return a.register({name:"ui.template.userIcon",markup:['<span class="ui-assignment__user user" userId="${id}">','   <img src="${avatar}" style="width:24px; height:24px;" alt="${name}" title="${name}" class="user-name" />',"</span>"].join(""),dependencies:[]})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList.mini",["tau/core/templates-factory","tau/ui/tags/ui.tag.abbr","tau/ui/templates/common/ui.template.userIcon","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(a,b){var c={name:"ui.template.assignmentsList.userList.mini",tags:[b],markup:['<div class="ui-assignment__group group" roleId="${role.id}">','   <span class="ui-assignment__group__title">',"       <span>${$item.parent.$tau.abbr(role.name, 3)}</span>","   </span>","   {{if users.length}}",'   <span class="ui-assignment__group__users">','   {{tmpl(users) "ui.template.userIcon"}}',"   {{/if}}","   </span>","   {{if allowAdd}}",'   <span class="ui-assignment__group__unassigned">{{tmpl "assignments-add-btn"}}</span>',"   {{/if}}","</div>"].join(""),dependencies:["assignments-add-btn","ui.template.userIcon"]};return a.register(c)}),define("tau/ui/templates/assignmentsList/ui.template.assignments.mini",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList.mini"],function(a){var b={name:"ui.template.assignments.mini",markup:['<div class="assignments-table-readonly">','<div class="user-list">{{tmpl(assignments.groups) "ui.template.assignmentsList.userList.mini"}}</div>',"</div>"].join(""),dependencies:["ui.template.assignmentsList.userList.mini"]};return a.register(b)}),define("tau/ui/templates/property.effort/ui.template.property.effort.content",["tau/core/templates-factory"],function(a){var b="Estimated effort: ${effort}{{if effort}}${unit.shortName}{{/if}}",c={name:"ui.template.property.effort.content",markup:[' <div class="tau-extension-tooltip" title="'+b+'">','   <div class="entity-effort">${effort}<span class="entity-effort-info">${unit.shortName}</span></div>',"</div>"],dependencies:[]};return a.register(c)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"list-grid-entity__row",markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"   <tbody>",'       <tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a href="#${__type}/${id}"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','   {{tmpl($item.data) "cell-name"}}',"</td>","{{if $item.parent.data.config.currentView.multiprojects}}","   {{if project}}",'   <td class="tau-list__table__cell tau-list__table__cell-project">${project.abbreviation}</td>',"   {{else}}",'   <td class="tau-list__table__cell  tau-list__table__cell-project">&nbsp;</td>',"   {{/if}}","{{/if}}","{{if severity}}",'   <td class="tau-list__table__cell tau-list__table__cell-severity">','       <span runas="property.severity" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" class="tau-list-severity-${severity.kind}">${severity.name}</span>',"   </td>","{{else priority}}",'   <td class="tau-list__table__cell tau-list__table__cell-priority">','       <span class="tau-list-priority-${priority.kind}" runas="property.priority" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${priority.name}</span>',"   </td>","{{/if}}","{{if visibleEntityState}}",'   <td class="tau-list__table__cell tau-list__table__cell-state">','       <div runas="property.entityState" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${visibleEntityState}</div>',"   </td>","{{/if}}","{{if effort}}",'   <td class="tau-list__table__cell tau-list__table__cell-effort">','           <div runas="property.effort" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-entities-count="${entitiesCount}">','               {{tmpl({effort: effort.estimated, unit: effort.unit}) "ui.template.property.effort.content"}}',"           </div>","   </td>",'   <td class="tau-list__table__cell tau-list__table__cell-progress" >','       <div runas="progressBar.small" data-max-width-percents="${effort.percentFromMaximum}" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">','           {{tmpl(effort) "cell-progress"}}',"       </div>","   </td>","{{/if}}","{{if assignments}}",'<td class="tau-list__table__cell tau-list__table__cell-assignments" >','   <div runas="assignmentsList" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.assignments.mini">{{tmpl(assignments.groups) "cell-assignments"}}</div>',"</td>","{{/if}}","{{if velocity}}",'   <td class="tau-list__table__cell tau-list__table__cell-velocity" >',"       ${velocity.value}&nbsp;${velocity.unit.shortName} ","   </td>","{{/if}}","{{if assignedEffort}}",'   <td class="tau-list__table__cell tau-list__table__cell-assignedEffort" >','   <div class="tau-extension-tooltip" title="Assigned Effort: ${assignedEffort.value}&nbsp;${assignedEffort.unit.shortName}">',"       <div>${assignedEffort.value}&nbsp;${assignedEffort.unit.shortName}</div>","   </div>","   </td>","{{/if}}","{{if startDate}}",'   <td class="tau-list__table__cell tau-list__table__cell-date" >',"       ${startDate}","   </td>","{{/if}}","{{if endDate}}",'   <td class="tau-list__table__cell tau-list__table__cell-date" >',"       ${endDate}","   </td>","{{/if}}",'   <td class="tau-list__table__cell tau-list__table__cell-actions" >','       <div runas="entity.actions" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}"></div>',"   </td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row"],function(a){var b={name:"list-grid-entity__group",markup:['<div class="tau-list__group {{if collapsed}} tau-list__group_collapsed_true{{/if}}" role="group">','   <div class="tau-list__group__header tau-list__group__collapse" role="expander">',"       {{if realGroup}}","           {{if realGroup.__type && realGroup.id}}",'           <a class="tau-list__group__id" href="#${realGroup.__type}/${realGroup.id}"><em class="ui-type-icon ui-type-icon-${realGroup.__type}">${realGroup.id}</em></a>',"           {{/if}}","       {{/if}}",'       <span class="tau-list__group__title" role="title">${title}</span>','       {{if subtitle}}<span class="tau-list__group__subtitle" >${subtitle}</span>{{/if}}','       <span class="tau-list__group__counter{{if items.length == 0}} tau-list__group__counter__empty{{/if}}" role="counter">${items.length}</span>',"   </div>",'${$item.data.config=$item.parent.data.config,""}','   <ul class="tau-list__list" role="list">','      {{tmpl(items) "list-grid-entity__row"}}',"   </ul>","</div>"],dependencies:["list-grid-entity__row"]};return a.register(b)}),define("tau/ui/templates/list_/ui.template.list.comment",["tau/core/templates-factory"],function(a){var b={name:"list-grid__comment",markup:['<div class="ui-entity-state-comment" role="comment-form" style="display:none;">','<div class="ui-state-comment-header">Please, provide comment</div>','<div class="ui-state-comment-field-container">','<textarea rows="5" class="ui-state-comment-field"></textarea>',"</div>",'<div class="button-group">','<button type="button" class="save button">Save</button>','<button type="button" class="save button">Cancel</button>',"</div>","</div>"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/ui.template.list.comment"],function(a){var b={name:"list-grid-entity",markup:['<div class="tau-list">',"   {{if isEmpty === true}}",'      <div class="tau-list__empty-message">${config.currentView.emptyMessage}</div>',"   {{else}}",'     <div class="tau-list__content">',"       {{if groups && groups.length}}",'          {{tmpl(groups) "list-grid-entity__group"}}',"       {{/if}}","       {{if items && items.length}}",'           <div class="tau-list__group tau-list__group_flat_true"  role="group">','               <ul class="tau-list__list"  role="list">','                   {{tmpl(items) "list-grid-entity__row"}}',"               </ul>","           </div>","       {{/if}}","     </div>","   {{/if}}",'   <div class="tau-list__comment-holder">','          {{tmpl() "list-grid__comment"}}',"   </div>","</div>"],dependencies:["list-grid-entity__group","list-grid-entity__row","list-grid__comment"]};return a.register(b)}),define("tau/views/view.compositeControl",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher","tau/models/dataprocessor/model.processor.context"],function(a,b,c,d,e){var f=function(b){return a(b).map(function(a){return"tau/components/component."+a})},g=function(b){var c={},d=a(b).keys();return a(d).each(function(a){var d=a.split(":"),e=null,f=-1,g=d.length,h=c;while(++f<g-1)e=d[f],h.hasOwnProperty(e)||(h[e]={}),h=h[e];var i=d[f];h[i]=b[a]}),c},h=c.extend({init:function(a){this._loaded=!1,this._super(a)},initialize:function(){var b=this;b._super.apply(b,arguments);var c=b.config.dependencies,d=a.size(c)>0&&b.config.visible;if(d){var e=f(c);require(e,b.createComponentTypesCallback(c))}else b.fireDependenciesAreReady({})},createComponentTypesCallback:function(b){var c=this;return c.dependenciesHash={},function(){var d=arguments;a(b).each(function(a,b){c.dependenciesHash[a]=d[b]}),c.fireDependenciesAreReady(c.dependenciesHash)}},fireDependenciesAreReady:function(a){this.fire("dependenciesAreReady",{controlTypes:a})},"bus afterInit+dataBind":function(){},"bus afterInit+dataBind+dependenciesAreReady":function(a){var b=this,c=a.afterInit.data,d=a.dataBind.data,e=a.dependenciesAreReady.data;b.config.visible&&(b._loaded=!0),b.fireBeforeRender({data:d}),b.doRender(d,c.refreshSelector);var f=b.instantiateChildrenComponents(b.element.find("[runas]"),e.controlTypes);b.initializeChildrenComponents(f,d)},createOnAfterRenderCallback:function(a){return function(b){b.removeListener(),a.replaceWith(b.data.element)}},onDestroyCallback:function(a){var b=this,c=a.sender;delete b.children[c.uniqueId]},instantiateChildrenComponents:function(c,d){var e=this,f=[];e.children={};var h=a.bind(e.onDestroyCallback,e);return c.each(function(c,i){var j=b(this),k=j.attr("runas"),l=d.hasOwnProperty(k);if(!l)throw"The component type ["+k+"] not found";var m=d[k],n=m.create({context:e.config.context});n.uniqueId=n.uniqueId||a.uniqueId(),n.on("afterRender",e.createOnAfterRenderCallback(j)),n.on("destroy",h);var o={instance:n,config:g(j.data())};e.children[n.uniqueId]=n,f.push(o)}),f},initializeChildrenComponents:function(b,c){var e=this;b.length?(e.dispatcher=new d(a(b).pluck("instance")),e.dispatcher.listen("afterRender",function(a){e.fireAfterRender({data:c})}),a(b).each(function(a){e.fire("createComponentContext",a)})):e.fireAfterRender({data:c})},"bus createComponentContext":function(a){var b=this,c=a.data,d=c.config,f=d.context.general;d.context.entity=f,d.context.assignable=f,d.context.applicationContext=b.config.context.applicationContext,e(d.context),b.fire("componentContextCreated",c)},"bus componentContextCreated":function(a){var b=a.data;b.instance.fire("initialize",b.config)},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},destroyChildren:function(){var b=this;b.dispatcher=null,a(b.children).chain().keys().each(function(a){b.children[a].destroy()}),b.children=null},lifeCycleCleanUp:function(){this.destroyChildren(),this._super()},destroy:function(){this.destroyChildren(),this._super()}});return h}),define("tau/ui/extensions/list/extension.list.prioritize",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({category:"edit","bus afterRender":function(a){var c=a.data.element,d=this;this.$el=c,c.addClass("tau-list__sortable__true");var e=c.find("[role=group]");e.addClass("tau-list__group_sortable_true"),e.addClass("tau-list__group_available_true"),e.sortable({scroll:!0,scrollSensitivity:5,scrollSpeed:7,cursor:"move",connectWith:".tau-list__group_available_true[role=group]",items:".tau-list__list [role=item]",dropOnEmpty:!0,handle:"[role=sortable-handler]",forcePlaceholderSize:!0,placeholder:{element:function(a){var c=b('<li class="tau-list__list__item tau-list__sortable-placeholder ui-sortable-placeholder"></li>');return c.height(50),c},update:function(a,b){return}},helper:function(a,b){var c=b;return c}}),e.bind("sortstart",function(a,c){d.started=!0;var e=c.item,f=e.data("tmplItem").data||{},g=b(a.currentTarget);g.addClass("tau-list__group_sortover_true"),d.$group=g;var h=g.data("tmplItem")?g.data("tmplItem").data:{};d.fire("prioritize.start",{item:f,group:h})}),e.bind("sortstop",function(a,b){e.addClass("tau-list__group_available_true"),e.removeClass("tau-list__group_available_false"),e.removeClass("tau-list__group_sortover_true")}),e.bind("sortupdate",function(a,c){if(d.started)d.started=!1;else return;var e=c.item,f=e.prev("[role=item]"),g=e.next("[role=item]"),h=e.data("tmplItem").data||{},i=f.length?f.data("tmplItem").data:{},j=g.length?g.data("tmplItem").data:{},k=e.parents("[role=group]:first"),l=k.data("tmplItem")||null;l=l?l.data:null;var m=k.hasClass("tau-list__group_collapsed_true");k.addClass("i-target");var n=b(this),o=n.data("tmplItem")||null;o=o?o.data:null,d.fire("prioritize.checkAvailability",{$item:e,$prevGroup:n,$targetGroup:k,item:h,prev:i,next:j,group:l,prevGroup:o,isCollapsed:m})}),e.bind("sortchange",function(a,b){var c=e.find(".tau-list__sortable-placeholder").parents("[role=group]:first");c.length==1&&c.hasClass("tau-list__group_sortover_true")==0&&(e.removeClass("tau-list__group_sortover_true"),c.addClass("tau-list__group_sortover_true"))});var f=function(a,c,d,e){d?b(d[0]).find(".tau-list__list").append(this.placeholder[0]):c.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?c.item[0]:c.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var f=this,g=this.counter;window.setTimeout(function(){g==f.counter&&f.refreshPositions(!e)},0)};e.each(function(){var a=b(this);a.data("sortable")._rearrange=f})},"bus prioritize.checkAvailability":function(a){this.bus.fire("prioritize.isAvailable.default",{})},"bus prioritize.checkAvailability+prioritize.isNotAvailable":function(a){this.bus.fire("refresh")},"bus prioritize.checkAvailability+prioritize.isAvailable.default+prioritize.isAvailable.comment":function(a){var b=a["prioritize.checkAvailability"].data;this.fire("positionUpdated",b)},"bus prioritize.updateGroupsAvailability":function(c){var d=c.data,e=d.groups,f=this,g=this.$el.find("[role=group]");if(g.length<=1||g.length==e.length){g.addClass("tau-list__group_available_true").removeClass("tau-list__group_available_false"),this.$group.sortable("refresh");return}var h=a.filter(g.toArray(),function(c){var d=b(c).data("tmplItem").data;return a.any(e,function(a){return d===a})}),i=b(h);g.addClass("tau-list__group_available_false").removeClass("tau-list__group_available_true"),i.removeClass("tau-list__group_available_false").addClass("tau-list__group_available_true"),this.$group.sortable("refresh")},"bus beforeUpdate":function(){this.$el.find(".i-target [role=counter]").css("backgroundColor","#ffefd5")},"bus afterUpdate":function(c){this.$el.find("[role=group]").each(function(){b(this).find("[role=counter]").text(b(this).find("[role=item]").length)}),this.$el.find(".i-target [role=counter]").animate({backgroundColor:"#ffffff"},200),this.$el.find(".i-target").removeClass("i-target");var d=c.data.changedItem,e=this.$el.find(".i-item-"+d.id),f=e.parents("[role=item]:first"),g=f.data("tmplItem").data;a.extend(g,d);var h="tau-list__table__row_isfinalstate_true";e.toggleClass(h,!!g.entityState.isFinal)}})}),define("tau/ui/extensions/list/extension.list.prioritize.comment",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.tauBubble"],function(a,b,c,d){return c.extend({"bus afterRender":function(a){this.$root=a.data.element,this.$el=a.data.element.find("[role=comment-form]")},"bus prioritize.updateGroupsCommentRequirements":function(b){var c=b.data.groups,d=this.$root.find("[role=group]");d.data("isCommentRequired",!1),a.forEach(c,function(a,b){d.eq(b).data("isCommentRequired",a.isCommentRequired)})},"bus prioritize.checkAvailability":function(b){var c=b.data.$targetGroup,d=b.data.$prevGroup;if(!c.data("isCommentRequired")||c[0]===d[0]){this.fire("prioritize.isAvailable.comment");return}var e=b.data.$item;this.$item=e;var f=b.data.item;this.item=f;var g=this.$el,h=b.data.isCollapsed,i=!1;h==0?i=e.find("[role=sortable-handler]"):i=c.find("[role=title]"),e.tauBubble({showOnCreation:!0,alignTo:i}),g.detach(),e.tauBubble("widget").find("[role=content]").append(g),g.show();var j=g.find("textarea");j.val("").focus();var k=g.find(":button"),l=k.eq(0);l.bind("click",a.bind(this._save,this));var m=k.eq(1);m.bind("click",a.bind(this._cancel,this)),e.bind("taububblehide",a.bind(this._cancel,this));var n=function(){window.setTimeout(function(){var a=j.val()||"",b=a.trim().length===0;l.attr("disabled",b?"disabled":!1),b?l.addClass("disable"):l.removeClass("disable")},50)};n(),l.bind("focus",n),j.bind("change keypress",n)},_save:function(a){a.stopPropagation();var b=this,c=this.$el,d=c.find("textarea").val(),e=b.config.store,f=b.item;c.addClass("updating"),e.save("comment",{$set:{description:d,general:{id:f.id}},$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName"]}]}).done({success:function(){c.removeClass("updating"),b.fire("prioritize.isAvailable.comment"),b.$item.tauBubble("destroy")},failure:function(){b.fire("prioritize.isNotAvailable")}})},_cancel:function(){var a=this;a.fire("prioritize.isNotAvailable")}})}),define("tau/ui/templates/list_/ui.template.list",["tau/core/templates-factory"],function(a){var b={name:"list",markup:['<div class="tau-list">',"</div>"]};return a.register(b)}),define("tau/ui/extensions/list/extension.list.groups",["jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/list_/ui.template.list"],function(a,b,c){return b.extend({"bus afterRender":function(b){var c=this,d=b.data.element;d.delegate("[role=expander]","click",function(b){var d=a(b.target);if(d.is("a")||d.parent("a").length)return;var e=d.parents("[role=group]:first");e.toggleClass("tau-list__group_collapsed_true"),c.bus.fire("stateChanged")})}})}),define("tau/ui/extensions/list/extension.list.overlay",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element.parent()},showOverlay:function(){this.element.tauOverlay()},hideOverlay:function(){this.element.tauOverlay("hide")},"bus beforeInit":function(a){this.element&&this.element.length&&this.showOverlay()},"bus showOverlay":function(a){this.element&&this.element.length&&this.showOverlay()},"bus afterRender":function(a){if(this.element&&this.element.length){var b=this;b.hideOverlay()}}})}),define("tau/ui/extensions/list/extension.list.state",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c,d){return c.extend({initialState:{},"bus preDataBind":function(b){var c=b.data,e=d.getRouting().getStateParameter("list")||{},f=this;a.forEach(c.groups,function(b){var c=(new String(b.key)).toString();f.initialState[c]=b.collapsed,a.isUndefined(e[c])==0&&(b.collapsed=e[c])})},"bus afterInit+afterRender":function(a){this.$el=a.afterRender.data.element},"bus stateChanged":function(c){var d=this.$el.find("[role=group]"),e={},f=this;d.each(function(){var c=b(this),d=c.hasClass("tau-list__group_collapsed_true"),g=c.data("tmplItem").data,h=(new String(g.key)).toString();a.isUndefined(f.initialState[h])==0&&f.initialState[h]!==d&&(e[h]=d)}),f.bus.getGlobalBus().fire("routing.setState",{list:e})}})}),define("libs/jquery/jquery.tau.bubblepopup",["libs/jquery/jquery.ui"],function(a){return function(a,b){var c={TOP:"top",BOTTOM:"bottom",AUTO:"auto"},d={CONTENT:b+"-content",PLACEHOLDER:b+"-placeholder",ACTIVE:b+"-active"};a.widget("ui."+b,{options:{content:"",position:c.AUTO},_create:function(){this._createFrame(),this.hide(),this.setContent(a(this.options.content)),this.setPosition(this.options.position||c.AUTO),this._initDOM()},_createFrame:function(){var c=a("<div/>").addClass(b),e=a("<div/>").addClass(d.CONTENT);c.append(e),this._$frame=c,this._$contentWrapper=e},show:function(){this.updatePosition(),this.element.addClass(d.ACTIVE),this._trigger("show")},hide:function(){this._trigger("hide"),this.element.removeClass(d.ACTIVE)},setContent:function(b){this._$content=a(b).appendTo(this._$contentWrapper.empty())},getContent:function(){return this._$content},setPosition:function(a){if(this._isValidPosition(a)&&a!=this._$position){var b=this._$position=a;b==c.AUTO&&(b=this._calculatePosition()),this._setPositionMarker(b)}},getPosition:function(){return this._$position},updatePosition:function(){this.getPosition()==c.AUTO&&this._setPositionMarker(this._calculatePosition())},_isValidPosition:function(b){var d=!1;return a.each(c,function(a,c){if(b==c)return d=!0,!1}),d},_setPositionMarker:function(b){var d=a.map(c,function(a){if(a!=b)return a});this._$frame.removeClass(d.join(" ")).addClass(b)},_calculatePosition:function(){var b=a(window).height(),d=this.element.outerHeight(),e=this.element.offset(),f=2*e.top+d<b,g=c.TOP;return f&&(g=c.BOTTOM),g},_initDOM:function(){this.element.addClass(d.PLACEHOLDER).append(this._$frame)},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments),this._$frame.remove(),this.element.removeClass(d.PLACEHOLDER)}})}(a,"taububblepopup"),a}),define("tau/ui/extensions/ui.extension.tooltip",["jQuery","tau/components/extensions/component.extension.base","libs/jquery/jquery.tau.bubblepopup"],function(a,b){return b.extend({"bus afterRender":function(b){var c=b.data.element;c.find(".tau-extension-tooltip").each(function(b,c){var d=a(c),e=d.prop("title");d.data("tau-extension-tooltip",e),d.prop("title",""),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\\n/g,"<br/>");var f=null,g=!1;d.taububblepopup({content:'<div class="tau-tooltip-title">'+e+"</div>"}).mouseenter(function(){var b=a(this);f=setTimeout(function(){g=!0,b.taububblepopup("show")},500)}).mouseleave(function(){var b=a(this);clearTimeout(f),g&&b.taububblepopup("hide"),g=!1})})}})}),define("tau/ui/extensions/list/extension.list.handleAction",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({getRowElement:function(a,b){var c=a.find(".i-item-"+b);return c},"bus afterItemsProvided+afterRender+handleGlobalAction":function(b){var c=b.afterItemsProvided.data.data,d=b.handleGlobalAction.data.id,e=a(c).detect(function(a){return a.id==d});if(e){var f=b.afterRender.data.element,g=this.getRowElement(f,d);this.fire("markElementToBeUpdated",{element:g}),this.fire("updateElement",{element:g}),this.fire("evictData"),this.fire("refresh")}},"bus afterRender+beforeDeleteRow":function(a){var b=a.afterRender.data.element,c=a.beforeDeleteRow.data.id,d=this.getRowElement(b,c);this.fire("markElementToBeDeleted",{element:d}),this.fire("deleteElement",{element:d,callback:$.noop})},"bus afterRender+afterDeleteRow":function(a){var b=this,c=a.afterRender.data.element,d=a.afterDeleteRow.data.id,e=this.getRowElement(c,d);this.fire("deleteElement",{element:e,callback:function(){b.fire("refresh")}})}})}),define("tau/ui/extensions/list/extension.list.handleAction.generator",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){var c=function(b,c){var d=c.split(":"),e=b;return a(d).each(function(a){e=e[a]}),e};return function(a,d){return b.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on(a,this.onGlobalAction,this)},destroy:function(){this.bus.getGlobalBus().removeListener(a,this.onGlobalAction,this),this._super.apply(this,arguments)},onGlobalAction:function(a){var b=c(a.data,d);this.fire("handleGlobalAction",{id:b})}})}}),define("tau/models/dataProviders/model.provider.groups.default",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(a,b){return b.extend({fetch:function(b,c,d){var e=[];if(!b){d(!1);return}a.forEach(c,function(c){var d=a.complexKey(c,b),f=a(e).any(function(a){return a.key===d});f||e.push({key:d,items:[]})}),d(e)}})}),define("tau/models/model.list",["Underscore","tau/core/model-base","tau/models/dataProviders/model.provider.groups.default","tau/extensions/extension.underscore"],function(a,b,c){var d=b.extend({onInit:function(){var a=this,b=new this.config.itemsDataProvider(this.config);b.fetch(function(b){a.fire("afterItemsProvided",{data:b})})},"bus afterItemsProvided":function(b){var d=this,e=null;this.config.groupsDataProvider?e=this.config.groupsDataProvider:e=c;var f=b.data.data,g=a.isArray(this.config.groupBy)?this.config.groupBy[0]:this.config.groupBy,h=new e(this.config);h.fetch(g,f,function(a){d.fireAfterGroupsProvided(a)})},fireAfterGroupsProvided:function(a){this.fire("afterGroupsProvided",{data:a})},createSubscription:function(a,b){var c=this;c.store.on({eventName:"beforeRemove",type:a,listener:c},function(a){var d=a.data.id;b(d)&&c.fire("beforeDeleteRow",{id:d})}),c.store.on({eventName:"afterRemove",type:a,listener:c},function(a){var d=a.data.id;b(d)&&c.fire("afterDeleteRow",{id:d})})},"bus afterItemsProvided+afterGroupsProvided":function(b){var c=this,d=b.afterItemsProvided.data.data,e=b.afterGroupsProvided.data.data;if(d&&d.length){var f=function(b){return a(d).detect(function(a){return a.id==b})};a(d).chain().map(function(a){return a.__type}).unique().each(function(a){c.createSubscription(a,f)})}var g={items:[],groups:[],isEmpty:d.length?!1:!0};e!==!1?g.groups=this.innerGroupBy(d,e):g.items=d,this.data=g,this.fire("afterDataProvided",{data:g})},"bus afterDataProvided":function(a){var b=this.preProcess(a.data.data);this.fire("preDataBind",b),this.fire("dataBind",b)},preProcess:function(b){var c=this.config.views[0];return a.forEach(b.groups,function(b){b.title||(a.isObject(b.key)?b.title=a.complexKey(b.key,c.group.dataIndex):b.title=b.key)}),b.config={views:this.config.views,currentView:c},b},innerGroupBy:function(b,c){var d=a.isArray(this.config.groupBy)?this.config.groupBy[0]:this.config.groupBy,e=this;return a.forEach(c,function(c){a.forEach(b,function(b){var e=a.complexKey(b,d);a.isArray(c.key)&&a.indexOf(c.key,e)>-1?c.items.push(b):a.isEqual(c.key,e)&&c.items.push(b)})}),c},"bus prioritize.start":function(b){var d=b.data.item,e=b.data.group,f=null;this.config.groupsDataProvider?f=this.config.groupsDataProvider:f=c;var g=new f(this.config),h=a.filter(this.data.groups,function(a){return g.isAvailableForItem(d,a,e)});this.fire("prioritize.updateGroupsAvailability",{groups:h});var i=g.getCommentRequirements(d,this.data.groups,e);this.fire("prioritize.updateGroupsCommentRequirements",{groups:i})}});return d}),define("tau/models/model.list.editable",["Underscore","tau/core/model.editable.base"],function(a,b){var c=b.extend({category:"edit","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus positionUpdated":function(b){var c=b.data,d=this,e=c.item,f=this.config.store,g=[];c.isCollapsed==0&&g.push(function(a){var b=new d.config.itemsDataProvider(d.config);b.changePriority(c.item,c.prev,c.next,function(b){a(null,b)})}),c.group&&g.push(function(a){var b=new d.config.groupsDataProvider(d.config);b.moveToGroup(c.item,c.group,c.prevGroup,function(b){a(null,b)})}),c.isCollapsed==1?(d.fire("beforeUpdate"),d.fire("showOverlay"),a.parallel(g,function(){d.fire("refresh")})):(d.fire("beforeUpdate"),a.parallel(g,function(b,c){var e={};a.forEach(c,function(b){b&&a.extend(e,b.changed||{})}),d.fire("afterUpdate",{changedItem:e})}))}});return c}),define("tau/views/view.list",["tau/core/view-base"],function(a){return a.extend({"bus initialize":function(a){var b=this.config.views[0];b.type=b.type||"grid";var c=["tau/ui/templates/list_/",b.type,"/ui.template.list.",b.type].join(""),d=this;require([c],function(b){d.config.template=b,d.startLifeCycle(a)})}})}),define("tau/components/component.list",["Underscore","tau/components/component.creator","tau/ui/extensions/list/extension.list.prioritize","tau/ui/extensions/list/extension.list.prioritize.comment","tau/ui/extensions/list/extension.list.groups","tau/ui/extensions/list/extension.list.overlay","tau/ui/extensions/list/extension.list.state","tau/ui/extensions/ui.extension.tooltip","tau/ui/extensions/list/extension.list.handleAction","tau/ui/extensions/list/extension.list.handleAction.generator","tau/models/model.list","tau/models/model.list.editable","tau/views/view.list"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){return{create:function(h){h=h||{},h.views=h.views||[{}],a(h.views).each(function(a){a.emptyMessage=a.emptyMessage||"No items found"});var n=h.views[0];n.type=n.type||"grid",h.multiprojects&&(n.multiprojects=h.multiprojects),n.timeTrackingPolicies=h.context.getTimeTrackingPolicies();var o=[l,e,f,g,i,j("bugWasMarkedAsDuplicate","duplicateBugId"),j("entityWasMovedToProject","entity:id"),j("entityWasCopiedToProject","entity:id")];h.sortable!==!1&&(o.push(c),o.push(d));var p={extensions:o.concat(h.extensions||[]),ModelType:k,ViewType:h.ViewType||m};return h.template&&(p.template=h.template),b.create(p,h)}}}),define("tau/components/component.list.editable",["Underscore","tau/components/component.list","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity","tau/views/view.compositeControl"],function(a,b,c,d){return{create:function(e){return e=a(e).defaults({ViewType:d,template:c,dependencies:["title","property.severity","property.priority","property.entityState","assignmentsList","property.effort","entity.actions","progressBar.small"]}),b.create(e)}}}),define("tau/ui/templates/ui.template.lookswitcher",["tau/core/templates-factory"],function(a){var b={name:"ui.lookswitcher",markup:['<div class="ui-lookswitcher tau-look-switcher">','   {{if !loveNewLook }}<a class="ui-lookswitcher-love-link">Always use this awesome UI</a>{{/if}}','   {{if loveNewLook }}<a class="ui-lookswitcher-hate-link">Switch back to old look</a>{{/if}}',"</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.lookswitcher",["jQuery","Underscore","tau/configurator","tau/components/component.creator","tau/ui/templates/ui.template.lookswitcher","tau/components/extensions/component.extension.base"],function(a,b,c,d,e,f){var g={create:function(b){var g=f.extend({"bus beforeInit":function(){var a=this,b=c.getGlobalSettingsService();b.getGlobalSettings({success:function(b){a.fire("dataBind",{loveNewLook:b.LoveNewLook})}})},execute:function(a,b){var d=c.getGlobalSettingsService(),e=this;d.sendRequest("GlobalSettingsService",a,null,function(a){d.resetSettings(),b&&b()},function(a){})},"bus feltInLove+afterRender":function(a){var b=this;this.execute("WantToSeeBeatyAlways",function(){b.fire("refresh")})},"bus hateIt+afterRender":function(a){var b=this;b.execute("HateNewLook",function(){document.location.href=c.getApplicationPath()+"/view.aspx?id="+b.config.context.entity.id})},"bus afterRender":function(b){var c=this,d=b.data.element,e=function(b,e){a(b,d).click(function(){a(this).unbind(),a(this).addClass("tau-disabled"),a(this).attr("disabled"),c.fire(e)})};e(".ui-lookswitcher-love-link","feltInLove"),e(".ui-lookswitcher-hate-link","hateIt")}}),h={extensions:[g],template:e};return d.create(h,b)}};return g}),define("tau/models/model.menu.actions",["Underscore","tau/core/model-base"],function(a,b){var c=b.extend({onInit:function(){var b=this.config.items,c=[],d=0;a(b).each(function(a){if(a==="-----"){if(d===0)return;d=0}else++d;c.push(a)});var e={items:c};this.bus.fire("dataBind",e)}});return c}),define("tau/ui/behaviour/menu/ui.behaviour.menu.actions",["Underscore","jQuery","tau/core/tau-widget"],function(a,b,c){c.widget("ui.behaviourMenuActions",{_create:function(){this.init()},init:function(){var a=b(this.element);this.$element=a,this.$popup=a.find(".ui-menu__popup");var c=this;this.$items=this.$element.find(".ui-menu__item-action"),this.currentIndex=-1,c.isOpened=!1,this.$element.find(".ui-menu__trigger").click(function(a){}),this._bindEvents()},show:function(){var a=this;a.$popup.slideToggle(100,function(){a.isOpened=!a.isOpened,a.isOpened?a._mapKeyboard():a._unmapKeyboard()})},_bindEvents:function(){var a=this;a.$items.hover(function(){a.$items.not(this).removeClass("ui-menu__item-action-hover"),b(this).addClass("ui-menu__item-action-hover"),a.currentIndex=a.$items.index(this)},function(){b(this).removeClass("ui-menu__item-action-hover")}),b("body").click(function(c){a.isOpened&&a.close();if(b(c.target).parents(".ui-menu:first").length)return})},_mapKeyboard:function(){this.mapper=a.bind(this._keyboardEvents,this),b(document).bind("keydown",this.mapper)},_unmapKeyboard:function(){b(document).unbind("keydown",this.mapper)},_keyboardEvents:function(a){var c=this;switch(a.keyCode){case b.ui.keyCode.ESCAPE:c.close();break;case b.ui.keyCode.DOWN:c.currentIndex++,c.currentIndex=c.currentIndex<c.$items.length?c.currentIndex:0,c.$items.removeClass("ui-menu__item-action-hover"),c.$items.eq(c.currentIndex).addClass("ui-menu__item-action-hover");break;case b.ui.keyCode.UP:c.currentIndex--,c.currentIndex=c.currentIndex<0?c.$items.length-1:c.currentIndex,c.$items.removeClass("ui-menu__item-action-hover"),c.$items.eq(c.currentIndex).addClass("ui-menu__item-action-hover");break;case b.ui.keyCode.ENTER:var d=c.$items.filter(".ui-menu__item-action-hover");d&&d.trigger("click")}},close:function(){var a=this;this.$popup.slideUp(100,function(){a.isOpened=!1,a._unmapKeyboard()})},destroy:function(){}})}),define("tau/components/extensions/menu/extension.menu.actions",["Underscore","jQuery","tau/ui/extensions/editable-base","tau/ui/behaviour/menu/ui.behaviour.menu.actions","tau/utils/utils.redirect"],function(a,b,c,d,e){return c.extend({"bus dataBind+afterRender":function(b){this.redirect=new e(this.config.context);var c=this.$el=b.afterRender.data.element;c.behaviourMenuActions(),c.find(".ui-menu__item-action").click(a.bind(this.executeCommand,this))},"bus select":function(){this.$el.behaviourMenuActions("show")},removeEntity:function(){var a=this.config.context.entity;this.config.store.remove(a.entityType.name,{id:a.id}).done()},redirectTo:function(a,b){this.redirect.redirect(a,b)},split:function(){var a=this.config.context.entity.id,b={generalID:a};this.fire("split",b)},markAsDuplicate:function(){var a=this.config.context.entity.id,b={generalID:a};this.fire("markAsDuplicate",b)},convert:function(){var a=this.config.context.entity.id,b=this.config.context.applicationContext.selectedProjects[0].id,c={generalID:a,projectID:b};this.fire("convertEntity",c)},attachToRequest:function(){var a=this.config.context.entity.id;this.fire("attachToRequest",{generalID:a})},moveOrCopy:function(){var a=this.config.context.entity.id;this.fire("moveOrCopy",{generalID:a})},executeCommand:function(c){if(b(c.target).is("a"))return;var d=this,e=b(c.currentTarget).data().tmplItem.data,f=e.command,g=e.confirmation||!1;if(g&&window.confirm(g)==0)return;if(a.isFunction(f))a.bind(f,d)(d);else if(typeof f=="object"){var h={components:f,context:d.config.context};d.createComponents(h,function(a){var b=a[0].component;b.initialize()})}else e.url&&d.redirectTo(e.url);this.fire("beforeSave",{})}})}),define("tau/services/service.actions",["tau/core/class","tau/configurator"],function(a,b){var c=a.extend({getActionUrl:function(a){return b.getApplicationPath()+"/PageServices/ActionsService.asmx/"+a},getActiveProjectForEntity:function(a,b,c){var d={generalId:a};this.sendRequest("GetActiveProjectForEntity",d,b,c)},copyGeneralToProject:function(a,b,c,d){var e={generalId:a,projectId:b};this.sendRequest("CopyGeneralToProject",e,c,d)},getProjectIds:function(a,b){var c={};this.sendRequest("GetProjectIds",c,a,b)},moveGeneralToProject:function(a,b,c,d){var e={generalId:a,projectId:b};this.sendRequest("MoveGeneralToProject",e,c,d)},attachGeneralToRequest:function(a,b,c,d){var e={generalId:a,requestId:b};this.sendRequest("AttachGeneralToRequest",e,c,d)},generalCanConvertTo:function(a,b,c){var d={generalId:a};this.sendRequest("GeneralCanConvertTo",d,b,c)},convertGeneralToTask:function(a,b,c,d){var e={generalId:a,userStoryId:b};this.sendRequest("ConvertGeneralToTask",e,c,d)},convertGeneralToType:function(a,b,c,d){var e={generalId:a,entityTypeId:b};this.sendRequest("ConvertGeneralToType",e,c,d)},splitUserStory:function(a,b,c){var d={generalId:a};this.sendRequest("SplitUserStory",d,b,c)},sendRequest:function(a,b,c,d){$.ajax(this.getActionUrl(a),{contentType:"application/json",type:"POST",data:JSON.stringify(b),success:c,error:d})}});return c}),define("tau/ui/templates/actions/ui.template.moveOrCopy",["tau/core/templates-factory"],function(a){var b={name:"move-or-copy",markup:['<div style="display: none;">','\t<div id="copyActionPopup" style="padding: 10px">','\t\t\t\t<table cellpadding="6" cellspacing="0">',"\t\t\t\t\t<tr>","\t\t\t\t\t\t<td>",'                           <select id="projectSelector">','                               <option value="0" >- Select Project -</option>','                               {{each projects}}<option value="${ID}" >${Name}</option>{{/each}}',"                           </select>","\t\t\t\t\t\t</td>","\t\t\t\t\t\t<td>",'                           <input type="button" value="Copy" class="copy" disabled></button> ',"\t\t\t\t\t\t</td>","\t\t\t\t\t\t<td>",'                           <input type="button" value="Move" class="move" disabled></button> ',"\t\t\t\t\t\t</td>","\t\t\t\t\t</tr>","\t\t\t\t</table>",'\t\t\t\t\t<div style="font-size: 90%">',"\t\t\t\t\t\tCustom fields will be saved only when the entity is copied or moved to a project with the same process","\t\t\t\t\t</div>","\t</div>","</div>"]};return a.register(b)}),define("tau/components/extensions/menu/extensions.menu.moveOrCopy",["tau/components/extensions/component.extension.base","tau/services/service.actions","tau/core/templates-factory","tau/ui/templates/actions/ui.template.moveOrCopy"],function(a,b,c){var d=0;return a.extend({"bus moveOrCopy":function(a){var b=a.data.generalID;this.moveOrCopy(b)},moveOrCopy:function(a){var e=this;Ext.WindowMgr.zseed=99999;var f=new b,g=function(b){function i(b,c){var d=$("#"+h+" #projectSelector").val();d!=0&&f[b](e.config.context.entity.id,d,function(b){k.close(),c&&c(a,d)},function(a){k.close();var b=$.parseJSON(a.responseText).Message;e.fire("error",{message:b})})}d++;var g=c.get("move-or-copy").bind(e.config,{projects:b.d}).appendTo("body"),h="copyActionPopup"+d;g.find("#copyActionPopup").prop("id",h);var j=g.find(".copy,.move");g.find("#projectSelector").change(function(){var a="disabled";$(this).val()!="0"?j.removeAttr(a):j.attr(a,a)}),g.find(".copy").click(function(){var a=function(a,b){e.fire("entityWasCopiedToProject",{entity:{id:a},project:{id:b}})};i("copyGeneralToProject",a)}),g.find(".move").click(function(){var a=function(a,b){e.fire("entityWasMovedToProject",{entity:{id:a},project:{id:b}})};i("moveGeneralToProject",a)});var k=showModalPopup(h,{title:"Move or Copy",width:440,height:126})};f.getActiveProjectForEntity(a,g)}})}),define("tau/components/extensions/menu/extensions.menu.attachToRequest",["tau/components/extensions/component.extension.base","tau/services/service.actions","tau/core/templates-factory"],function(a,b,c){var d=0;return a.extend({"bus attachToRequest":function(a){var b=a.data.generalID;this.attachToRequest(b)},attachToRequest:function(a){Ext.WindowMgr.zseed=99999;var c=this,d=this.config.context.applicationContext.selectedProjects[0].id,e=[];for(var f=0;f<_projectContext.length;f++)e.push(_projectContext[f].id);var g=new b;g.getProjectIds(function(b){var e=Ext.create({xtype:"lookupgenerallistitemgrid",listeners:{lookupactionlinkclick:{fn:function(b,d,e,h,i,j){f.close(),f.destroy();var k=function(b){c.fire("requestWasAttachedToEntity",{entity:{id:a}},{project:{id:h.json.GeneralID}})},l=function(a){};g.attachGeneralToRequest(a,h.json.GeneralID,k,l)},scope:this}},showReleaseIteration:!1,showEntityType:!1,excludeEntityId:0,showProjects:!0,entityTypeIds:[17],showState:!1,projectIds:b.d,projectId:d,appendItems:[]}),f=showModalPopupForComponent(e,{width:680,height:500,title:"Attach to Request"})})}})}),define("tau/components/extensions/menu/extensions.menu.markAsDuplicate",["tau/components/extensions/component.extension.base","tau/configurator"],function(a,b){var c=0;return a.extend({"bus markAsDuplicate":function(a){var b=a.data.generalID;this.markAsDuplicate(b)},markAsDuplicate:function(a){Ext.WindowMgr.zseed=99999;var c=[];for(var d=0;d<_projectContext.length;d++)c.push(_projectContext[d].id);var e=this,f=Tp.controls.Duplicate.CreatePopup(c,a,undefined,{onMarkDelegate:function(a){var c=b.getStore(),d=c.freeze();e.fire("bugWasMarkedAsDuplicate",a),d.unfreeze()}});f.show(c,a),b.getKeyBoardManager().pushHandler({handleKeyDown:function(a){a.which==27&&(b.getKeyBoardManager().popHandler(),f.hide(),f.destroy())}})}})}),define("tau/components/extensions/menu/extensions.menu.split",["tau/components/extensions/component.extension.base","tau/services/service.actions","tau/utils/utils.urlBuilder","tau/utils/utils.redirect"],function(a,b,c,d){return a.extend({"bus split":function(a){var b=a.data.generalID;this.split(b)},split:function(a){var e=this,f=new b;f.splitUserStory(a,function(b){var e=b.d,f=c.getSplitForUserStoryUrl(a,e);(new d).redirect(f)},function(a){e.fire("error",{message:"Split operation is failed due to server error"})})}})}),define("tau/ui/templates/actions/ui.template.convert",["tau/core/templates-factory"],function(a){var b={name:"convert",markup:['<div style="display: none;">','\t<div id="convertEntityPanel" style="overflow: visible; padding: 10px">','\t\t<table cellpadding="6" cellspacing="0">',"\t\t\t<tr>","\t\t\t\t<td>","\t\t\t\t\tConvert to","\t\t\t\t</td>","\t\t\t\t<td>",'                   <select id="entityType">','                       <option value="0" >- Select New Type -</option>','                       {{each types}}<option value="${ID}" >${Name}</option>{{/each}}',"                   </select>","\t\t\t\t</td>","\t\t\t</tr>","\t\t\t<tr>",'\t\t\t\t<td colspan="2">','\t\t\t\t\t<span style="font-size: 90%">',"\t\t\t\t\t\tCustom fields will be saved only inside the same process and if they have the same name and type in both entities.","\t\t\t\t\t</span>","\t\t\t\t</td>","\t\t\t</tr>","\t\t</table>",'       <div style="" id="pnlLookupUserStory" style="display: none">',"\t\t\tSelect new parent user story:",'\t\t\t<table cellspacing="0" cellpadding="0">',"\t\t\t\t<tbody><tr>","\t\t\t\t\t<td>",'\t\t\t\t\t\t<input type="text" style="display: none;" id="hdnGeneralID">','                       <table cellspacing="0" cellpadding="0">',"                           <tr>","\t\t                        <td>","\t\t                        </td>","\t                        </tr>","\t                        <tr>","\t\t                        <td>",'\t\t\t                        <textarea style="height:16px;width:500px;" class="input" title="Type the beginning of the entity name (at least 2 symbols)" id="txtGeneralsLookup" cols="20" rows="1" ></textarea>',"\t\t                        </td>",'\t\t                        <td>&nbsp;&nbsp;<a id="lnkFind" href="javascript:void(0)">Find</a></td>',"\t                        </tr>","           </table>","\t\t\t\t\t</td>","\t\t\t\t</tr>","\t\t\t</tbody></table>","\t\t</div>",'\t\t<table cellpadding="6" cellspacing="0">',"\t\t\t<tr>","\t\t\t\t<td>",'                   <button type="button" value="Convert" class="convert-btn" disabled="disabled">Convert</button> ',"\t\t\t\t</td>","\t\t\t</tr>","\t\t</table>","\t</div>","</div>"]};return a.register(b)}),define("tau/components/extensions/menu/extensions.menu.converter",["tau/components/extensions/component.extension.base","tau/services/service.actions","tau/core/templates-factory","tau/ui/templates/actions/ui.template.convert"],function(a,b,c){var d=46,e=0;return a.extend({"bus convertEntity":function(a){var b=a.data.projectID,c=a.data.generalID;this.convert(c,b)},convert:function(a,f){var g=this.config.context.applicationContext.id,h=this.bus.getGlobalBus(),i=new b;Ext.WindowMgr.zseed=99999;var j=this,k=[],l=function(b){function n(){var a=g.find("#entityType").val();g.find("textarea").unbind("keypress"),g.find("textarea").unbind("keyup"),g.find("#pnlLookupUserStory").css("display",a==d?"block":"none"),a==0?g.find(".convert-btn").attr("disabled","disabled"):a==d?(g.find("textarea").bind("keypress ",function(a){a.keyCode==13&&(a.stopPropagation(),a.preventDefault())}),g.find("textarea").bind("keyup",m),g.find("textarea").bind("change",m),m()):g.find(".convert-btn").removeAttr("disabled")}e++;var g=c.get("convert").bind(j.config,{types:b.d}).appendTo("body"),l="convertEntityPanel"+e;g=g.find("#convertEntityPanel").prop("id",l);var m=function(){g.find("textarea").val().length==0?g.find(".convert-btn").attr("disabled","disabled"):g.find(".convert-btn").removeAttr("disabled")};$create(Tp.Atlas.Extenders.Lookup.GeneralLookupBehavior,{TargetControl:g.find("#txtGeneralsLookup")[0],clearLink:g.find("#lnkClear")[0],entityTypeIDs:[4],excludeEntityID:a,findLink:g.find("#lnkFind")[0],generalElement:g.find("#hdnGeneralID")[0],id:"lkpUserStories",projectID:f,projectIDs:k,showEntityTypeFilter:!1,showProjectFilter:!0,showReleaseIterationFilter:!0,onFindDelegate:function(){g.find(".convert-btn").removeAttr("disabled")},showStateFilter:!1},null,null),g.find(".convert-btn").click(function(){var b=g.find("#entityType").val();o.hide(),j.fire("showProgress",{text:"Converting..."});var c={generalId:a},e=function(b){o.close(),j.fire("hideProgress");var c=b.d,d=c.EntityTypeName.split("."),e=d[d.length-1],f={entity:{id:c.GeneralID},entityType:{name:e}};j.fire("generalWasConverted",f),h.fire("history.exclude",{id:a}),h.fire("routing.redirect",{url:"#"+e.toLowerCase()+"/"+c.GeneralID}),window._criticalTauChanges=!0},f=function(a){o.close(),j.fire("hideProgress");var b=jQuery.parseJSON(a.responseText)||{Message:"Server is not available"},c=b.Message;j.fire("error",{message:c})};if(b==d){var k=g.find("#hdnGeneralID").val();if(!k){j.fire("error",{message:"Parent user story is not specified"});return}i.convertGeneralToTask(a,k,e,f)}else c.entityTypeId=b,i.convertGeneralToType(a,b,e,f)}),g.find("#entityType").change(function(){n()}),n();var o=showModalPopup(l,{title:"Convert",width:600,height:220})};i.getProjectIds(function(b){k=b.d,i.generalCanConvertTo(a,l)})}})}),define("tau/ui/templates/menu/ui.template.menu.actions",["tau/core/templates-factory","tau/ui/templates/menu/ui.template.menu.actions.item"],function(a){var b={name:"menu-actions",markup:['<div class="ui-menu-actions">','   <span class="ui-menu__trigger">Actions<span class="ui-menu__indicator"></span></span>','   <div class="ui-menu__popup ui-drop-down">','       <div class=" ui-drop-down drop-down-list">','      {{tmpl(items) "menu-actions-item"}}',"       </div>","   </div>","</div>"],dependencies:["menu-actions-item"]};return a.register(b)}),define("tau/components/component.menu.actions",["tau/components/component.creator","tau/models/model.menu.actions","tau/components/extensions/menu/extension.menu.actions","tau/components/extensions/menu/extensions.menu.moveOrCopy","tau/components/extensions/menu/extensions.menu.attachToRequest","tau/components/extensions/menu/extensions.menu.markAsDuplicate","tau/components/extensions/menu/extensions.menu.split","tau/components/extensions/menu/extensions.menu.converter","tau/components/extensions/error/extension.errorBar","tau/ui/templates/menu/ui.template.menu.actions"],function(a,b,c,d,e,f,g,h,i,j){return{create:function(k){var l={extensions:[b,d,e,g,h,f,i,c],template:k.template||j};return a.create(l,k)}}}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base","libs/jquery/jquery.ui.confirmation"],function(a,b,c,d){var e=d.extend({"bus dataBind+afterRender":function(c){this.element=c.afterRender.data.element,this.dataToBind=c.dataBind.data;var d=this.element.find(".plugin-block");a(d).each(function(a){b(a).find(".tau-profile-actions").click(b.proxy(this.onDeleteProfile,{pluginBlock:b(a),parentExtension:this}))},this)},onDeleteProfile:function(a){a.preventDefault();var c=this.parentExtension,d=b(a.target).tmplItem().data,e=this.pluginBlock,f=function(){e.confirmation("hide"),e.tauOverlay("hide"),c.fire("refresh")};e.confirmation({message:"Do you really want to delete profile?",okLabel:"OK",cancelLabel:"Cancel",ok:function(){e.tauOverlay({showOnCreation:!1}),e.tauOverlay("showLarge"),e.confirmation("hideConfirmationMessage"),c.config.context.pluginRepository.deleteProfile(d.pluginName,d.name,f)},cancel:function(){e.confirmation("hide")}}),this.pluginBlock.confirmation("show")}});return e}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c,d){var e=d.extend({"bus dataBind+afterRender":function(c){this.element=c.afterRender.data.element,this.dataToBind=c.dataBind.data,a(this.element.find(".plugin-block")).each(function(a){var c=b(a).tmplItem().data.name;this.config.context.pluginRepository.getProfilesErrors(c,b.proxy(this.onProfilesErrorsRetrieved,{element:b(a),data:b(a).tmplItem().data}))},this)},onProfilesErrorsRetrieved:function(c){a(this.element.find(".tau-profileName")).each(function(d){a(c).each(function(a){if(a.ProfileName==b(d).tmplItem().data.name&&a.ErrorsExist){var c=b(d);c.fadeOut("slow"),c.children("a").addClass("error-indicator"),b(d).fadeIn("slow")}})},this)}});return e}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c,d){var e=d.extend({"bus dataBind+afterRender":function(c){a(c.afterRender.data.element.find(".plugins-category")).each(function(a){var c=b(a);c.find(".tau-pluginCategory").click(function(a){a.preventDefault();var d=b(this),e=d.hasClass("collapsed"),f=e?"collapsed":"expanded",g=e?"expanded":"collapsed";d.removeClass(f),d.addClass(g),e?(c.find(".plugin-block").show(),c.find(".create-me").show()):(c.find(".plugin-block").hide(),c.find(".create-me").hide())})})}});return e}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c,d){var e=d.extend({"bus dataBind+afterRender":function(c){this.element=c.afterRender.data.element,this.dataToBind=c.dataBind.data,a(this.element.find(".plugin-block")).each(function(a){var c=b(a),d=c.tmplItem().data.profilesMore.length;if(d>0){var e=c.find(".tau-profiles-more"),f=c.find(".tau-profiles-moreLink");f.show(),f.click([f,e],b.proxy(this.onShowMoreClick,{profilesMoreCount:d}))}},this)},onShowMoreClick:function(a){a.preventDefault();var b=a.data[0].find(".more-link"),c=a.data[1];c.is(":visible")?b.text(["Show more (",this.profilesMoreCount,")"].join("")):b.text("Show less"),c.animate({opacity:"toggle",height:"toggle"},"slow")}});return e}),define("tau/models/model.pluginsList",["Underscore","jQuery","tau/core/model-base"],function(a,b,c){var d=c.extend({onInit:function(){this.config.context.pluginRepository.getPlugins(b.proxy(this.onPluginsRetrieved,this))},onPluginsRetrieved:function(a){this.augmentData(a),this.fire("dataBind",{items:a})},augmentData:function(b){a(b).each(function(b){a(b.plugins).each(function(a){a.iconSrc=[this.config.configurator.getApplicationPath(),"/PluginIcon.ashx?pluginName=",a.name].join(""),a.profilesShort=a.profiles.slice(0,3),a.profilesMore=a.profiles.slice(3)},this)},this)}});return d}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.profile",["tau/core/templates-factory"],function(a){var b={name:"pluginsList-profile",markup:["<ul>",'   <li class="name tau-profileName"><a href="${editUrl}">${name}</a></li>','   <li class="delete"><a class="tau-profile-actions button danger" href=""><span class="delete-icon"></span></a></li>',"</ul>"]};return a.register(b)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.plugin",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.profile"],function(a){var b={name:"pluginsList-plugin",markup:['<div class="plugin-block">','   <img src="${iconSrc}" />','   <h4 class="_pluginName">${name}</h4>','   <p class="note-p">${description}</p>','   <div class="separator"></div>','   <div class="profiles-list">','       <div class="tau-profiles-short">','           {{tmpl(profilesShort) "pluginsList-profile"}}',"       </div>",'       <div class="tau-profiles-more" style="display:none">','           {{tmpl(profilesMore) "pluginsList-profile"}}',"       </div>","   </div>",'   <div class="pb-5 tau-profiles-moreLink" style="display:none">','       <a class="more-link">Show more (${profilesMore.length})</a>',"   </div>",'   <div class="pt-5">','       <button type="button" class="button bold" onClick="window.location.href = \'${newProfileUrl}\';">Add Profile</button>',"   </div>","</div>"],dependencies:["pluginsList-profile"]};return a.register(b)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.category",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.plugin"],function(a){var b={name:"pluginsList-category",markup:['<div class="plugins-category">','<div class="expanded tau-pluginCategory">','<span class="label">${category}</span>',"</div>",'{{tmpl(plugins) "pluginsList-plugin"}}',"</div>"],dependencies:["pluginsList-plugin"]};return a.register(b)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.category"],function(a){var b={name:"pluginsList",options:{contentSelector:".ui-pluginsList-table"},markup:['<div class="plugins">','   <div class="list">','       <h2 class="h2 icon">Plugins</h2>','       {{tmpl(items) "pluginsList-category"}}',"   </div>","</div>"],dependencies:["pluginsList-category"]};return a.register(b)}),define("tau/components/component.pluginsList",["tau/components/component.list.creator","tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable","tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay","tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible","tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore","tau/models/model.pluginsList","tau/ui/extensions/ui.extension.loading","tau/ui/templates/pluginsList/ui.template.pluginsList"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:f,template:h,message:"No plugins found",extensions:[b,c,d,e,g]};return a.create(j,i)}}}),define("tau/ui/templates/common/ui.template.buttonAction",["tau/core/templates-factory"],function(a){var b={name:"button-action",markup:['<a class="button-box ${id}-button user-action button small ${className}"',' role="button">','   <span class="">${title}</span>',"</a>"].join("")};return a.register(b)}),define("tau/ui/templates/print/ui.template.print",["tau/core/templates-factory","tau/ui/templates/common/ui.template.buttonAction"],function(a){var b={name:"print",markup:['<div class="ui-print">','   <div class="ui-print__controls">','       {{tmpl([{id: "x", className: "ui-print__controls__print", title: "Print"}]) "button-action"}}',"   </div>","</div>"],dependencies:["button-action"]};return a.register(b)}),define("tau/ui/extensions/print/ui.extension.print",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.redirect"],function(a,b,c,d){return c.extend({"bus beforeInit":function(a){this.options=a.data.config,this.options.window=this.options.window||window},"bus afterRender":function(b){this.element=b.data.element,this.entity=b.data.data.context.entity;var c=this.element,d=this;this._printHandler||(this._printHandler=a.bind(this._print,this),c.find(".ui-print__controls__print").bind("click",this._printHandler));var e=c.find(".ui-print__controls__close");this._closeHandler||(this._closeHandler=a.bind(this._close,this),c.find(".ui-print__controls__close").bind("click",this._closeHandler))},_print:function(a){this.options.window.print()},_close:function(a){a.preventDefault(),this.options.window.opener?this.options.window.close():(new d(this.options.context)).redirect("View.aspx?noRedirect=1&id=${entity.id}")}})}),define("tau/components/component.print",["Underscore","tau/core/component-base","tau/views/view.container","tau/ui/templates/print/ui.template.print","tau/ui/extensions/print/ui.extension.print"],function(a,b,c,d,e){return{create:function(f){return f=f||{},a.defaults(f,{template:d}),(new b(f)).attach(e).attach(c).bus}}}),define("tau/views/view.composer",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher"],function(a,b,c,d){var e=c.extend({init:function(a){this._loaded=!1,this._super(a)},initialize:function(){var b=this,c=b.config.children,d=a.size(c)>0&&b.config.visible;if(d){var e=b.config.children,f=b.config.context||{};this.fire("createComponents",{components:e,context:f})}else b._super.apply(b,arguments),b._fireChildrenRendered({children:[],childrenEvtArgs:[]})},"bus componentCreated":function(a){var b=a.data.component;this.fire("childComponentCreated",b)},"bus componentsCreated":function(a){this.fire("beforeComponentsInitialize",a.data),this.initializeChildrenComponents(a),this.fire("afterComponentsInitialize",a.data)},initializeChildrenComponents:function(b){var c=this,e=a(b.data).pluck("component"),f=a(b.data).pluck("config");c.dispatcher=new d(e),c.dispatcher.listen("afterInit",function(a){c.fireAfterInit()}),c.dispatcher.listen("afterRender",function(a){var b=a.argsArr,d={children:e,childrenEvtArgs:b};c._fireChildrenRendered(d)}),a(e).each(function(a,b){a.fire("initialize",f[b])})},_fireChildrenRendered:function(a){this.fire("internalChildrenRendered",a)},"bus afterInit+dataBind":function(a){},"bus afterInit+dataBind+internalChildrenRendered":function(c){this.destroyChildComponents();var d=this,e=c.afterInit.data,f=c.dataBind.data,g=c.internalChildrenRendered.data;d.children=g.children,d.config.visible&&(d._loaded=!0);if(g.children.length===0)d.render(f,e);else{d.fireBeforeRender({data:f});var h=d.bindTemplate(f);h.find("[runas]").each(function(c,d){var e=b(this),f=e.attr("runas"),h=e.attr("componentId"),i=a(g.childrenEvtArgs).detect(function(a,b){var c=a.view.config;return c.type===f&&c.id.toString()===h});if(!i){var k='Component "'+h+'" type of ['+f+"] not found";throw k}var j=i.element;e.replaceWith(j)}),h=d.prepareElement(h),d.fire("childrenRendered",g.children),d.updateElement(h,e.refreshSelector),!d.config.visible&&d.hide(),d.fireAfterRender({data:f})}},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},lifeCycleCleanUp:function(){this._super()},destroyChildComponents:function(){delete this.dispatcher;var a=null;if(this.children&&this.children.length)while(a=this.children.pop())a.destroy();delete this.children},destroy:function(){this.destroyChildComponents(),this._super()}});return e}),define("tau/models/model.progressBar",["tau/core/model-base"],function(a){var b=function(a){this.model=a};b.prototype={setEntity:function(a){this.entity=a.data},done:function(){var a=this.model.entity=this.entity;if(!a)return;var b={id:a.id,entityType:{name:a.__type},entityState:{id:a.entityState.id,name:a.entityState.name,isFinal:a.entityState.isFinal},effortCompleted:a.effortCompleted,effortToDo:a.effortToDo,timeSpent:a.timeSpent,timeRemain:a.timeRemain},c=Math.round(100*parseFloat(b.effortToDo)+100*parseFloat(b.effortCompleted))/100;b.percentCompleted=Math.round(1e4*(b.effortCompleted/c))/100,b.percentCompleted=isNaN(b.percentCompleted)?0:b.percentCompleted,b.percentCompleted=b.percentCompleted>100?100:b.percentCompleted,a.entityState.isFinal&&(b.percentCompleted=100),b.disableSpentRemain=this.model.config.context.getTimeTrackingPolicies().disableSpentRemain;var d=this.model.config.maxWidthPercents;_.isUndefined(d)===!1?b.maxWidthPercents=d:b.maxWidthPercents=100,this.model.bus.fire("dataBind",b)}};var c=a.extend({name:"Progress Bar",beforeSaveRoleEffort:function(a){var b=a.data.cmd.config;b.fields=b.fields||[],b.fields.push({assignable:["id","effortCompleted","effortToDo","timeSpent","timeRemain"]})},afterSaveEntity:function(a){var b=a.data;b.changes.hasOwnProperty("timeRemain")&&b.id===this.config.context.entity.id&&this.fire("remainTimeChanged")},afterSaveRoleEffort:function(a){var b=this;b.fire("roleEffortChanged")},onInit:function(){var a=this,c=new b(this),d=this.config.context,e=d.entity.entityType.name,f=d.entity.id,g=["effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isFinal"]}],h=function(b){var c=b.data.cmd.config.fields;b.data.cmd.config.fields=c.concat(g),a.fire("beforeChanges",b.data.changes)},i=function(b){if(a.isInTransaction(b))return;a.fire("applyChanges",b.data.changes)};a.store.unbind(this),a.store.on({eventName:"beforeSave",type:e,filter:{id:d.assignable.id},hasChanges:["entityState"],listener:this},h),a.store.on({eventName:"afterSave",type:e,filter:{id:d.assignable.id},hasChanges:["entityState"],listener:this},i),a.store.on({eventName:"beforeSave",type:"roleEffort",listener:this},function(){a.beforeSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"afterSave",type:"roleEffort",filter:{assignable:{id:d.assignable.id}},listener:this},function(b){if(a.isInTransaction(b))return;a.afterSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"afterSave",type:e,listener:this},function(){a.afterSaveEntity.apply(a,arguments)}),this.store.get(e,{id:f,fields:g},{success:c.setEntity,scope:c}).done({success:c.done,scope:c})},isInTransaction:function(a){var b=this,c=a.data?a.data.cmd:{};return c===b.lastCmd?!0:(b.lastCmd=c,!1)},"bus evict":function(){var a=this.config.context.general;this.store.evictProperties(a.id,a.entityType.name,["effortCompleted","effortToDo","timeSpent","timeRemain","entityState"])}});return c}),define("tau/models/model.state.editable",["tau/core/model.editable.base"],function(a){return a.extend({category:"edit",name:"Editable State","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})},"bus beforeSave":function(a){var b=a.data.cmd,c=b.fields||[];c=c.concat(["effortCompleted","effortToDo","timeSpent","timeRemain"]),b.fields=c}})}),define("tau/ui/extensions/progressBar/ui.extension.progressBar.updater",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(a){var b=a.extend({"bus afterRender":function(a){this.$el=a.data.element,this.config.context.getTimeTrackingPolicies().disableSpentRemain&&this.$el.find(".ui-progressbar__data").hide()},"bus roleEffortChanged":function(){this.fire("refresh")},"bus remainTimeChanged":function(){this.fire("refresh")},"bus beforeChanges":function(a){this.$el.tauOverlay()},"bus applyChanges":function(a){this.$el.tauOverlay("hide"),this.fire("refresh")}});return b}),define("tau/ui/extensions/ui.extensions.onMarkAsDuplicate",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;b==a.data.duplicateBugId&&(this.fire("evict"),this.fire("refresh"))}})}),define("tau/ui/templates/progressBar/ui.template.progressBar",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(a,b){var c={name:"progress-bar",tags:[b],markup:['<div class="entity-progress-box">','   <div class="state-select">{{term(entityType.name) "name"}} is','      <div componentId="ctrlEntityState" runas="property.entityState"></div>',"   </div>",'   <div class="ui-progressbar__data">','      <span class="ui-label-spent ui-progressbar__data__spent">Spent&nbsp;<b class="value">${timeSpent}h</b></span>','      <span class="ui-label-remain  ui-progressbar__data__remain">Remain&nbsp;<b class="value">${timeRemain}h</b></span>',"   </div>",'   <div class="ui-progress-bar-progress ui-progressbar__progress">',"{{if percentCompleted !== 0 }}",'      <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${ Math.round(percentCompleted) < 15 ? 15 : Math.round(percentCompleted) }%;">','         <span class="ui-label ui-progressbar__progress__label"><b class="value">${ Math.round(percentCompleted) }%</b></span>',"      </span>","{{/if}}","   </div>","</div>"],dependencies:["common-attributeValue"]};return a.register(c)}),define("tau/components/component.progressBar",["Underscore","tau/components/component.creator","tau/views/view.composer","tau/components/extensions/component.creator.extension","tau/models/model.progressBar","tau/models/model.state.editable","tau/ui/extensions/progressBar/ui.extension.progressBar.updater","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/ui/templates/progressBar/ui.template.progressBar"],function(a,b,c,d,e,f,g,h,i){return{create:function(j,k){k=k||{};var l={ViewType:c,extensions:[k.model||e,f,d,g,h],template:k.template||i},m=j.extensions||[];for(var n=0;n<m.length;n++)l.extensions.push(m[n]);return a(j).extend({children:[{id:"ctrlEntityState",type:"property.entityState",disabledExtensionCategories:j.disabledExtensionCategories}]}),b.create(l,j)}}}),define("tau/ui/templates/progressBar/ui.template.progressBar.small",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(a,b){var c=["{{if disableSpentRemain === false}}","Time spent: ${timeSpent}{{if timeSpent}}h{{/if}}","\\n","Time remain: {{if !timeRemain && timeRemain !== 0}}N/A{{else}}${timeRemain}{{if timeRemain}}h{{/if}}{{/if}}","\\n","{{/if}}","Percent complete: ${Math.round(percentCompleted)}%"].join(""),d={name:"progress-bar-small",tags:[b],markup:["<div>","{{if maxWidthPercents > 0}}",'    <div class="ui-progress-bar-progress ui-progressbar__progress tau-extension-tooltip" style="width:${maxWidthPercents}%;" title="'+c+'">','        <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${percentCompleted}%;{{if percentCompleted == 0}}display:none;{{/if}}"></span>',"    </div>","{{else}}",'   <div{{if maxWidthPercents == 0}} class="tau-extension-tooltip" title="'+c+'"{{/if}}>',"   </div>","{{/if}}","</div>"]};return a.register(d)}),define("tau/components/component.progressBar.small",["Underscore","tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.progressBar","tau/ui/extensions/progressBar/ui.extension.progressBar.updater","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/progressBar/ui.template.progressBar.small"],function(a,b,c,d,e,f,g){return{create:function(a,c){c=c||{};var h={extensions:[d,e,f],template:g};return b.create(h,a)}}}),define("tau/models/model.property.simple",["tau/core/model-base"],function(a){return a.extend({init:function(a){this._super.apply(this,arguments);if(!a.propertyName)throw"PropertyName was not configured";this.propertyName=a.propertyName,this.listenedEntities={}},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},listenOfPropertyChanged:function(){var a=this.config.context.entity.id;this.listenedEntities[a]||(this.listenedEntities[a]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onInit:function(){this.listenOfPropertyChanged(),this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.propertyName]}).done({success:this.onEntityRetrieved,scope:this})},onEntityRetrieved:function(a){var b=a[0].data[this.propertyName]||this.config.defaultText;this.fire("dataBind",{text:b})}})}),define("tau/models/model.property.text",["tau/models/model.property.simple"],function(a,b){return a.extend({})}),define("tau/models/model.property.text.editable",["tau/core/model.editable.base"],function(a){return a.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable})}})}),define("tau/models/model.property.text.validation",["tau/core/model-base","tau/utils/utils.jsonSchema"],function(a,b,c){var d=a.extend({category:"edit",name:"Model text validation",schema:b.Schema.create({type:"string",optional:!1,empty:!1,maxLength:50,minLength:0,pre:["trim"]}),"bus afterRender":function(a){this.$element=a.data.element},"bus validate":function(a){this.$element.find(".property-text").dateEditor("resetValidationErrors");var b=a.data,c=b.cmd.$set[this.config.propertyName];b.validation=this.schema.validate(c)},"bus afterValidate":function(a){var b=a.data.validation;this.$element.find(".property-text").editableText("setValue",b.instance)},"bus validationFailed":function(a){var b=a.data.validation;this.$element.find(".property-text").editableText("setValidationErrors",b.errors[0].description)}});return d}),define("tau/models/model.property.abbreviation.validation",["tau/models/model.property.text.validation","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",schema:b.Schema.create({type:"string",optional:!1,empty:!1,maxLength:3,minLength:0,pre:["trim"]})});return c}),define("tau/components/extensions/property/extension.property.text.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=this.permissions=a.permissionsReady.data;if(d.editable){var e=this.$el=a.afterRender.data.element,f=e.find(".property-text");b.$widget=f,f.editableText({restoreText:!1,onSave:function(a){var c={};c[b.config.propertyName]=a;var d={$set:c};d.$include=[b.config.propertyName],b.bus.fire("save",d)}})}},"bus edit":function(){this.permissions.editable&&this.$el.find(".property-text").editableText("activate")}})}),define("tau/components/extensions/property/extension.property.refresher",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({category:"refresher","bus propertyChanged":function(){this.fire("refresh")}})}),define("tau/ui/templates/property/ui.template.property",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(a){var b={name:"property",markup:["<div>",'   <span class="property">',"{{if  hasUrl}}",'{{tmpl($data) "entity-link"}}',"{{/if}}",'       <span class="property-text">${text}</span>',"   </span>","{{if subtext}}",'   <div class="tau-property__subtext">${subtext}</div>',"{{/if}}","</div>"].join(""),dependencies:["entity-link"]};return a.register(b)}),define("tau/components/component.property.abbreviation",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.abbreviation.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(a,b,c,d,e,f,g,h){return{create:function(a){a.propertyName="abbreviation";var i={ModelType:c,extensions:[d,e,f,g],template:h};return b.create(i,a)}}}),define("tau/models/model.property",["tau/core/model.editable.base","tau/configurator"],function(a,b){return a.extend({init:function(a){this._super.apply(this,arguments);if(!a.propertyName)throw"PropertyName was not configured";this.propertyName=a.propertyName,this.displayField=a.displayField||"name",this.valueField=a.valueField||"id",this.listenedEntities={}},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},buildRequest:function(a){var b=this.store;return b=b.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",a]}),b},getPropertyData:function(a){var b=this.buildRequest(a);b.done({success:this.onEntityRetrieved,scope:this})},getPropertyFields:function(){return[this.displayField,this.valueField]},onInit:function(){this._super.apply(this,arguments);var a={};a[this.propertyName]=this.getPropertyFields(),this.listenOfPropertyChanged(),this.getPropertyData(a)},listenOfPropertyChanged:function(){var a=this.config.context.entity.id;this.listenedEntities[a]||(this.listenedEntities[a]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onProcessProperty:function(a){var b={id:a[this.valueField],text:a[this.displayField]};return this.config.showUrl&&a.id&&(b.hasUrl=!0,b.__type=a.__type,b.id=a.id),b},processProperty:function(a){var b=this.onProcessProperty(a);this.fire("dataBind",b)},onEntityRetrieved:function(a){var b=this.property=a[0].data[this.propertyName]||{};this.processProperty(b)},entityBelongCurrentContext:function(a){return a.changes.hasOwnProperty(this.config.propertyName)&&a.cmd.config.id==this.config.context.entity.id},onEntityAfterSave:function(a){var b=a.data;this.entityBelongCurrentContext(b)&&this.fire("changed",b)},onEntityBeforeSave:function(a){var b=a.data;this.entityBelongCurrentContext(b)&&this.fire("beforeChanged",b)}})}),define("tau/models/model.property.assignable",["tau/models/model.property","tau/configurator"],function(a,b){return a.extend({onInit:function(){var a=this;a._super.apply(a,arguments),a.store.unbind(a),a.store.on({type:a.getEntityTypeName(),eventName:"beforeSave",listener:a,filter:{id:a.getEntityId()},hasChanges:[a.propertyName]},function(b){a.store.evictProperties(a.getEntityId(),a.getEntityTypeName(),[a.config.refField]),a.fire("beforeChanged",b.data)}),a.store.on({type:a.getEntityTypeName(),eventName:"afterSave",listener:a,filter:{id:a.getEntityId()},hasChanges:[a.propertyName]},function(b){a.fire("propertyChanged",b.data)})},getPropertyData:function(){var a=this;a.store.get(a.getEntityTypeName(),{id:a.getEntityId(),fields:["id",a.config.refField]},{success:function(b){if(!b.data[a.config.refField]||b.data[a.config.refField].length===0){a.processProperty({});return}a.store.get("assignable",{id:b.data[a.config.refField][0],fields:[a.displayField,a.valueField]},{success:function(b){a.processProperty(b.data)}}).done()},scope:a}).done()}})}),define("tau/models/finder/model.relation.editor",["Underscore","tau/core/model.editable.base"],function(a,b){return b.extend({"bus entitySelected":function(a){var b={};b[this.config.propertyName]=null;var c=a.data.entity;c&&c.id&&(b[this.config.propertyName]={id:c.id});var d=this.config.context;this.config.store.evictProperties(d.entity.id,d.entity.entityType.name,[this.config.propertyName]),this.fire("save",{$set:b})}})}),define("tau/models/model.property.bool",["tau/core/model-base"],function(a){return a.extend({init:function(a){this._super.apply(this,arguments);if(!a.propertyName)throw"PropertyName was not configured";this.propertyName=a.propertyName},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},onInit:function(){this.store.unbind(this),this.attachToChangePropertiesOfCurrentEntity(this.propertyName),this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.propertyName]}).done({success:this.onEntityRetrieved,scope:this})},onEntityRetrieved:function(a){var b=a[0].data,c={value:b[this.propertyName]};this.fire("dataBind",c)}})}),define("tau/models/model.property.editable",["tau/core/model.editable.base"],function(a){return a.extend({onInit:function(){this._super.apply(this,arguments)},"bus dataBind":function(){this.fire("permissionsReady",{editable:this.config.editable!=0})}})}),define("tau/components/extensions/property/extension.property.bool.editable",["Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle"],function(a,b){return b.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element;a.afterRender.data.element.find(".external-view").click(function(a){a.stopPropagation()});var d=this.permissions=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f=c.find(".property .ui-checkbox");f.checkboxToggle({classNames:{checked:"checked",unchecked:"unchecked"},onSave:function(a){b.bus.fire("elementUpdated");var c={};c[b.config.propertyName]=a,b.bus.fire("save",c)}})}},"bus edit":function(){this.permissions.editable&&this.element.find(".property .ui-checkbox").checkboxToggle("toggle")}})}),define("tau/ui/templates/property/ui.template.bool",["tau/core/templates-factory"],function(a){var b={name:"property-bool",markup:['<div><span class="property"><div class="ui-checkbox {{if value}}checked{{/if}}{{if !value}}unchecked{{/if}}">&nbsp;</div></span></div>'].join("")};return a.register(b)}),define("tau/components/component.property.bool",["Underscore","tau/components/component.creator","tau/models/model.property.bool","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/property/extension.property.bool.editable","tau/ui/templates/property/ui.template.bool"],function(a,b,c,d,e,f,g){return{create:function(h){var i=a.concat([h.extensions,e]);h.editable===!0&&(i=a.concat([i,f,d]));var j={ModelType:c,template:h.template||g,extensions:i};return b.create(j,h)}}}),define("tau/models/finder/model.build.search",["Underscore","tau/models/finder/model.assignable.search"],function(a,b){return b.extend({init:function(a){this._super(a),delete this.properties.state,delete this.properties.priority},getInitialQueryConfig:function(){return{$skip:0,$limit:20,$query:{}}},getInitialQueryString:function(){return""},getType:function(){return"build"}})}),define("tau/models/model.property.date",["tau/models/model.property.simple","tau/utils/utils.date"],function(a,b){return a.extend({onEntityRetrieved:function(a){var c=this.config.format?this.config.format:"date",d=a[0].data,e=b.format[c].short(this.property=d[this.propertyName]),f=b.parse(this.property),g={text:e};this.fire("extendData",{dataToBind:g,entity:d,date:f}),this.fire("dataBind",g)}})}),define("tau/models/model.property.date.validation",["tau/core/model-base","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(a,b,c){var d=a.extend({category:"edit",name:"Model date validation",schema:b.Schema.create({type:"string",optional:!1,empty:!1,post:function(a){if(this.wasError()==0){var b=c.parse(a),d=c.parse(this.schema.additionalProperties.max),e=c.parse(this.schema.additionalProperties.min);b==null?new this.Error("Date","Incorrect date format"):b<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 1-Jan-1900"):d&&b>d?new this.Error("Date","Date must be less then "+c.format.date.short(d)):e&&b<e?new this.Error("Date","Date must be greater then "+c.format.date.short(d)):a=c.formatAs(b,this.schema.additionalProperties.dateFormat)}return a},additionalProperties:{dateFormat:c.getFormatData().date.short,max:null,min:null}}),"bus afterInit":function(){this.config.format=="datetime"&&(this.schema.additionalProperties.dateFormat=c.getFormatData().datetime.short)},"bus afterRender":function(a){this.element=a.data.element},"bus validateDate":function(a){var b=this.schema.validate(a.data.value);a.data.value=b.instance},"bus validate":function(a){var b=this.element.find(".property");b.dateEditor("resetValidationErrors");var c=a.data,d=c.cmd.$set[this.config.propertyName];if(!c.validation||c.validation.isError()!=1)c.validation=this.schema.validate(d),c.cmd.$set[this.config.propertyName]=c.validation.instance},"bus resetValidationErrors":function(){var a=this.element.find(".property");a.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){var b=a.data.validation;this.element.find(".property").dateEditor("setValue",b.instance)},"bus validationFailed":function(a){var b=this.element.find(".property");b.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}});return d}),define("tau/models/model.property.date.editable",["tau/core/model.editable.base"],function(a){return a.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable})}})}),define("tau/components/extensions/property/extension.property.date.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(a,b,c,d){return c.extend({category:"edit",init:function(){this._super.apply(this,arguments),this.onClickProxy=b.proxy(this.onClickHandler,this)},"bus permissionsReady+afterRender+dataBind":function(a){var c=this,e=this.element=a.afterRender.data.element;a.afterRender.data.element.find(".external-view").click(function(a){a.stopPropagation()});var f=this.permissions=a.permissionsReady.data,g=this.date=a.dataBind.data,h=this.config.format;if(f.editable){this.element.bind("click",this.onClickProxy);var i=this.$widget=e.find(".property"),j=null;h=="datetime"?j="datetimepicker":j="datepicker",b.datepicker.parseDate=function(a,b,c){return d.parse(b)},b.datepicker.formatDate=function(a,b,c){return d.format.date.short(b)},i.dateEditor({dateFormat:d.getFormatData().date.short,widgetName:j,beforeChange:function(a){c.fire("validateDate",a)},onSave:function(a){var b={};b[c.config.propertyName]=a;if(c.trimString(a)!=c.trimString(g.text)){var d={$set:b};d.$include=[c.config.propertyName],c.bus.fire("save",d)}else c.fire("resetValidationErrors")}})}},trimString:function(a){return(a||"").trim()},showEditor:function(){this.$widget.dateEditor("activate"),this.$widget.focus()},"bus edit":function(){this.permissions.editable&&this.showEditor()},onClickHandler:function(){this.showEditor()},removeHandlers:function(){this.element&&this.element.unbind("click",this.onClickProxy)},removeWidget:function(){this.$widget&&this.$widget.dateEditor("destroy")},destroy:function(){this.removeHandlers(),this.removeWidget(),this._super.apply(this,arguments)}})}),define("tau/ui/templates/property/ui.template.property.date",["tau/core/templates-factory"],function(a){var b={name:"property-date",markup:'<div><div class="property"><div class="property-text">${text}</div></div>'};return a.register(b)}),define("tau/components/component.property.date",["Underscore","tau/components/component.creator","tau/models/model.property.date","tau/models/model.property.date.validation","tau/models/model.property.date.editable","tau/components/extensions/property/extension.property.date.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property.date"],function(a,b,c,d,e,f,g,h){return{create:function(i){i=a.extend(a.clone(i));var j={ModelType:c,template:h,extensions:a.concat([i.extensions,g,e,f,d])};return b.create(j,i)}}}),define("tau/components/component.property.buildDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=b||{},b.propertyName="buildDate",b.format="datetime",a.create(b)}}}),define("tau/components/component.property.completeDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="endDate",a.create(b)}}}),define("tau/components/component.property.createDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=b||{},b.propertyName="createDate",a.create(b)}}}),define("tau/models/model.property.effort",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;a.store.unbind(a),a.store.on(a.getSubscriptionConfig("afterSave"),_.bind(a.onEntityAfterSave,a)),a.store.on(a.getSubscriptionConfig("beforeSave"),_.bind(a.onEntityBeforeSave,a)),a.store.get(c,{id:d,fields:["id","effort",{roleEfforts:["id",{role:["id","hasEffort"]}]}]}).done({scope:a,success:a.done})},done:function(a){var b=this,c=a[0].data,d=b.config.context,e=d.entity.entityType.name,f={id:c.id,effort:Math.round(100*c.effort)/100,unit:d.getEffortPoint(e),roleEfforts:c.roleEfforts};b.fire("dataBind",f)},getSubscriptionConfig:function(a){var b=this,c=b.config.context.entity;return{eventName:a,type:"roleEffort",listener:b,filter:{assignable:{id:c.id}},hasChanges:["effort"]}},onEntityAfterSave:function(a){this.fire("propertyChanged")},onEntityBeforeSave:function(a){this.fire("beforeChangeProperty")}});return b}),define("tau/models/model.property.effort.editable",["tau/core/model.editable.base","Underscore"],function(a,b){var c=a.extend({name:"Effort Editable","bus beforeInit+dataBind":function(){var a=this,b={editable:!0};this.fire("permissionsReady",b)}});return c}),define("tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly.effortsList",["tau/core/templates-factory"],function(a){var b={name:"ui.template.assignments.effortsOnly.effortsList",markup:["{{if roleEffort}}",'<tr class="tau-row group" roleId="${role.id}">',"   <td><span>${role.name}</span></td>",'   <td class="tau-cell-role-effort-value role-effort"><div class="effort">${roleEffort.effort}<span class="point">${$item.effortPoints}</span></div></td>',"</tr>","{{/if}}"].join(""),dependencies:[]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly.effortsList"],function(a){var b={name:"ui.template.assignments.effortsOnly",markup:['<table class="assignments-table-readonly tau-assignments-effort-only">','   <tr class="tau-header-row tau-row-delimiter">','       <td class="tau-header-cell-title"></td>','       <td class="tau-header-cell-value">Effort</td>',"    </tr>",'   {{tmpl(assignments.groups, {effortPoints: effortPoints}) "ui.template.assignments.effortsOnly.effortsList"}}',"{{if tasksEffort}}",'   <tr class="tau-footer-row tau-row-delimiter">',"       <td>Tasks</td>","       <td>${tasksEffort.effort} h</td>","   </tr>","{{/if}}",'   <tr class="tau-footer-row tau-footer-row-total">',"       <td>Total</td>","       <td><span>${totalEffort.effort} ${effortPoints}</span></td>","   </tr>","</table>"].join(""),dependencies:["ui.template.assignments.effortsOnly.effortsList"]};return a.register(b)}),define("libs/jquery/jquery.textEditor",["libs/jquery/jquery"],function(a){return function(a,b){if(b in a)throw new Error('jQuery already has the "'+b+'" property.');var c=function(a,c){for(var d in c)a.bind(d+"."+b,c[d])},d=function(a,b){this.initElement(a),this.setOptions(b),this.bindEvents()};d.prototype={constructor:d,initElement:function(a){this.$element=a.addClass("editableText")},setOptions:function(b){var c=b||{};this.onSave=a.isFunction(c.onSave)?c.onSave:a.noop,this.onEditStart=a.isFunction(c.onEditStart)?c.onEditStart:a.noop,this.onEditEnd=a.isFunction(c.onEditEnd)?c.onEditEnd:a.noop,this.maxLength=c.maxLength||255,this.mask=c.mask?new RegExp(c.mask):!1,this.restoreText=typeof c.restoreText=="undefined"?!0:c.restoreText},bindEvents:function(){c(this.$element,{blur:a.proxy(this,"onBlur"),keydown:a.proxy(this,"mapKeys"),keypress:a.proxy(this,"mapKeys"),click:a.proxy(this,"onFocus")})},onFocus:function(a){a&&a.stopPropagation(),this.isActive()||(this.activate(),this.onEditStart(),this.storeInitialText())},onBlur:function(){this.isActive()&&(this.deactivate(),this.saveText(),this.onEditEnd())},onEnter:function(a){a.preventDefault(),this.$element.blur()},onEscape:function(a){a.preventDefault(),this.restoreInitialText(),this.$element.blur()},onKeyDefault:function(a){if(a.charCode!=0){var b=String.fromCharCode(a.charCode||a.keyCode),c=this.$element.text()+b;this.mask.test(c)||a.preventDefault()}},activate:function(){this.$element.prop("contentEditable",!0).addClass("active").focus()},deactivate:function(){this.$element.removeClass("active").removeProp("contentEditable")},isActive:function(){return this.$element.hasClass("active")},setInitialText:function(a){this.initialText=a},getInitialText:function(){return this.initialText},storeInitialText:function(){this.setInitialText(this.$element.text())},restoreInitialText:function(){this.$element.text(this.getInitialText())},trimText:function(a){return _.trim(a)},normalizeText:function(a){var b=this.trimText(a);return b.length==0&&this.restoreText===!0&&(b=this.getInitialText()),b},saveText:function(){var a=this.normalizeText(this.$element.text());this.$element.text(a),a!=this.getInitialText()&&this.onSave(a)},mapKeys:function(a){switch(a.which){case 13:this.onEnter(a);break;case 27:this.onEscape(a);break;default:a.type=="keypress"&&this.mask&&this.onKeyDefault(a)}}},a.fn[b]=function(c){return this.each(function(e,f){var g=a(f);g.data(b,new d(g,c))})},a[b]=function(c,d){return a(c)[b](d)}}(a,"textEditor"),a.fn.textEditor}),define("tau/ui/behaviour/common/ui.behaviour.editableText",["Underscore","jQuery","libs/jquery/jquery.textEditor"],function(a,b){b.widget("ui.editableText",{_create:function(){this.element.textEditor(this.options)},activate:function(){this.element.data("textEditor").isActive()?this.element.data("textEditor").onBlur():this.element.data("textEditor").onFocus()},setValidationErrors:function(b){this.element.addClass("ui-validationerror"),a.isString(b)&&this.element.attr("title",b)},resetValidationErrors:function(a){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title",a)},setValue:function(a){this.element.text(a)},destroy:function(){}})}),define("tau/ui/extensions/effort/extension.effort.editable",["tau/components/extensions/component.extension.base","tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly","tau/ui/behaviour/common/ui.behaviour.editableText"],function(a,b){return a.extend({category:"edit",normalizeEffort:function(a){return Math.abs(Math.round(parseFloat(a)*100)/100)||0},"bus afterRender+beforeChangeProperty":function(a){var b=a.afterRender.data.element;this.fire("markElementToBeUpdated",{element:b})},"bus propertyChanged":function(a){this.fire("refresh")},"bus refresh+afterRender":function(a){var b=a.afterRender.data.element;this.fire("updateElement",{element:b})},hasEffortIterator:function(a){return a.role.hasEffort},"bus permissionsReady+dataBind+afterRender":function(a){var c=this,d=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f=_(e.roleEfforts).chain().select(c.hasEffortIterator).size().value();d.editMode=f===1&&c.config.entitiesCount==0?"inline":"roleEfforts";var g=a.afterRender.data.element,h=g.find(".entity-effort");if(d.editMode==="inline")h.editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(a){var b=c.normalizeEffort(a),d=_(e.roleEfforts).detect(c.hasEffortIterator),f={typeName:"roleEffort",id:d.id,$set:{effort:b}};c.bus.fire("save",f)},onEditStart:function(){c._$additionalInfo=h.find(".entity-effort-info").detach()},onEditEnd:function(){c._$additionalInfo.appendTo(h)}});else{var i={components:[{type:"assignmentsList",template:b}],context:c.config.context},j={target:h,componentsConfig:i};c.fire("initBubble",j)}}}})}),define("tau/ui/templates/property.effort/ui.template.property.effort",["tau/core/templates-factory","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"ui.template.property.effort",markup:['<div class="tau-property">{{tmpl($item.data) "ui.template.property.effort.content"}}</div>'],dependencies:["ui.template.property.effort.content"]};return a.register(b)}),define("tau/components/component.property.effort",["tau/components/component.creator","tau/models/model.property.effort","tau/models/model.property.effort.editable","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/effort/extension.effort.editable","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property.effort/ui.template.property.effort"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={extensions:[b,c,f,d,e,g],template:h};return a.create(j,i)}}}),define("tau/components/component.property.endDate",["tau/components/component.property.date"],function(a,b){return{create:function(b){return b=b||{},b.propertyName="endDate",a.create(b)}}}),define("tau/models/model.property.date.validation.project",["Underscore","tau/core/model-base","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(a,b,c,d){var e=b.extend({category:"edit",name:"Model date validation","bus afterInit":function(){this.schema=c.Schema.create({type:"string",optional:!1,empty:!1,post:function(a){if(this.wasError()==0){var b=d.parse(a),c=d.parse(this.schema.additionalProperties.max),e=d.parse(this.schema.additionalProperties.min);b==null?new this.Error("Date","Incorrect date format"):b<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 1-Jan-1900"):c&&b>c?new this.Error("Date","Date must be less then "+d.format.date.short(c)):e&&b<e?new this.Error("Date","Date must be greater then "+d.format.date.short(e)):a=d.format.date.short(b)}return a},additionalProperties:{dateFormat:d.getFormatData().date.short,max:null,min:null}});var b=this.config.store,e=this.config.context.entity,f=this.config.bus,g=this,h=function(a){var b=a[0].data;this.config.propertyName=="startDate"&&(this.schema.additionalProperties.max=d.parse(b.endDate)),this.config.propertyName=="endDate"&&(this.schema.additionalProperties.min=d.parse(b.startDate))};b.get("project",{id:e.id,fields:["startDate","endDate"]}).done({success:a.bind(h,this)}),this.config.propertyName=="startDate"?b.on({eventName:"afterSave",type:"project",listener:this,filter:{id:e.id},hasChanges:["endDate"]},function(a){var b=d.parse(a.data.changes.endDate);g.schema.additionalProperties.max=b}):this.config.propertyName=="endDate"&&b.on({eventName:"afterSave",type:"project",listener:this,filter:{id:e.id},hasChanges:["startDate"]},function(a){var b=d.parse(a.data.changes.startDate);g.schema.additionalProperties.min=b})},"bus validate":function(a){var b=a.data,c=b.cmd.$set[this.config.propertyName];b.validation=b.validation&&b.validation.isError()==1?b.validation:this.schema.validate(c)}});return e}),define("tau/components/component.property.endDate.project",["tau/components/component.property.date","tau/models/model.property.date.validation.project"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="endDate",c.extensions=[b],a.create(c)}}}),define("tau/models/model.property.entityState",["tau/core/model-base","Underscore"],function(a,b){var c=function(a){this.model=a};c.prototype={done:function(a){var b=a[0].data.entityState;this.model.fire("dataBind",b)}};var d=a.extend({onInit:function(){var a=this,d=new c(this),e=this.config.context,f=e.entity.entityType.name,g=e.entity.id,h=[{entityState:["id","name","isFinal","isCommentRequired",{nextStates:["id"]}]}],i=function(c){var d=c.data.changes,e=c.data.cmd.config.fields;c.data.cmd.config.fields=b.union(e,h),a.fire("beforeChanges",d),a.fire("beforeChangeProperty")},j=function(b){a.fire("applyChanges",b.data.changes),a.fire("propertyChanged")};a.store.unbind(a),a.store.on({eventName:"beforeSave",type:f,hasChanges:["entityState"],listener:this},i),a.store.on({eventName:"afterSave",type:f,hasChanges:["entityState"],listener:this},j),this.store.get(f,{id:g,fields:h},{success:d.setEntity,scope:d}).done({success:d.done,scope:d})}});return d}),define("tau/models/model.property.entityState.editable",["tau/core/model.editable.base"],function(a){return a.extend({name:"Entity state editable","bus dataBind":function(){this.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/entityState/extension.entityState.editable",["tau/components/extensions/component.extension.base"],function(a){return a.extend({category:"edit","bus prepareChanges":function(a){this.bus.fire("markElementToBeUpdated",{element:this.element})},"bus applyChanges":function(a){var b=this;this.bus.on("afterRender",function(a){a.removeListener(),b.bus.fire("updateElement",{element:b.element})}),this.bus.fire("refresh")},"bus ownerChanged":function(){this.fire("refresh")},"bus beforeChangeOwner":function(){this.fire("markElementToBeUpdated",{element:this.element})},"bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element,d=a.permissionsReady.data,e=a.dataBind.data;if(e.nextStates.length>0&&d.editable){var f={components:[{type:"entityStateList",data:e}],context:b.config.context},g={target:c,componentsConfig:f,alignTo:c.find(".attr-name")};this.fire("initBubble",g)}this.bus.on("edit",function(){this.fire("toggleBubble")},this)}})}),define("tau/components/component.property.entityState",["tau/components/component.creator","tau/models/model.property.entityState","tau/models/model.property.entityState.editable","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.attributeValue","tau/components/extensions/entityState/extension.entityState.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,d,e,f,h]};return a.create(j,i)}}}),define("tau/models/finder/model.feature.search",["Underscore","tau/models/finder/model.assignable.search"],function(a,b){return b.extend({init:function(a){this._super(a),this.properties.state.filter=function(a){return a?a.dataItem?a.dataItem.entityType.id===9:!0:!0}},getType:function(){return"feature"}})}),define("tau/components/extensions/impedimentDate/extensions.model.impedimentDate.daysPassedCalculator",["Underscore","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c){function e(b,c){if(a.isDate(b)&&a.isDate(c)){var e=b.getTime(),f=c.getTime(),g=Math.abs(e-f);return Math.round(g/d)}return null}var d=864e5,f=c.extend({"bus extendData":function(a){var c=a.data.dataToBind||{},d=a.data.date;c.daysPassed=e(b.getCurrentDate(),d)}});return f}),define("tau/components/extensions/impedimentDate/extension.ui.impedimentDate.daysPassed",["jQuery","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({extractDataFromEvent:function(a,b){return(a[b]||{}).data||{}},"bus afterRender+dataBind":function(b){var c=this.extractDataFromEvent(b,"dataBind"),d=a(this.extractDataFromEvent(b,"afterRender").element),e=a(['<span class="ui-days-passed">(<span class="days-count">',c.daysPassed,"</span> days passed)</span>"].join(""));d.find(".property").parent().append(e)}})}),define("tau/components/component.property.impedimentDate",["Underscore","tau/components/component.property.createDate","tau/components/extensions/impedimentDate/extensions.model.impedimentDate.daysPassedCalculator","tau/components/extensions/impedimentDate/extension.ui.impedimentDate.daysPassed"],function(a,b,c,d){return{create:function(e){return e=e||{},e.extensions=a.concat([e.extensions,c,d]),b.create(e)}}}),define("tau/components/component.property.isActive",["tau/components/component.property.bool"],function(a){return{create:function(b){return b=b||{},b.propertyName="isActive",a.create(b)}}}),define("tau/components/component.property.isPrivate",["Underscore","tau/components/component.property.bool"],function(a,b){return{create:function(c){return c=a.clone(c||{}),c.propertyName="isPrivate",c.editable=!0,b.create(c)}}}),define("tau/components/component.property.isProduct",["tau/components/component.property.bool"],function(a){return{create:function(b){return b=b||{},b.propertyName="isProduct",a.create(b)}}}),define("tau/components/extensions/property/extension.property.editable",["Underscore","tau/components/extensions/component.extension.base"],function(a,b){return b.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(b){var c=this,d=this.element=b.afterRender.data.element;b.afterRender.data.element.find(".external-view").click(function(a){a.stopPropagation()});var e=this.permissions=b.permissionsReady.data,f=b.dataBind.data;(!f.text||!f.text.length)&&d.find(".property").addClass("editable");if(e.editable){var g={components:[a.extend({data:f,v2:!0},this.config.editorComponentConfig)],context:c.config.context},h={target:d.find(".property-text"),componentsConfig:g,alignTo:d.find(this.config.alignElementSelector||"")};this.fire("initBubble",h)}},"bus edit":function(){this.permissions.editable&&this.fire("toggleBubble")}})}),define("tau/components/component.property",["Underscore","tau/components/component.creator","tau/core/termProcessor","tau/models/model.property","tau/models/model.property.editable","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property"],function(a,b,c,d,e,f,g,h,i,j){return{create:function(k){var l=k.context.applicationContext.processes[0].terms,m=new c(l),n=k.editorComponentConfig||{};n.resetDisabled=k.resetDisabled,n.showEmptyDataMessage&&(n.emptyDataMessage="No "+m.getTerms(k.propertyName).names.toLowerCase()+" found"),n.showClearValue&&(k.clearValueLabel="reset "+m.getTerms(k.propertyName).name.toLowerCase());var o={ModelType:k.Model||d,template:k.template||j,extensions:a.concat([k.extensions,h,i,e,g,f])};return b.create(o,k)}}}),define("tau/components/component.property.assignable",["tau/components/component.property","tau/models/model.property.assignable","tau/models/finder/model.assignable.search","tau/models/finder/model.relation.editor"],function(a,b,c,d){return{create:function(e){return e.propertyName="assignable",e.refField="$ref:assignable[id]",e.showUrl=!0,e.Model=b,e.alignElementSelector=".property-text",e.showEmptyDataMessage=!0,e.editorComponentConfig={type:"finder",resetDisabled:!0,propertyName:"assignable",searchModel:c,additionalExtensions:[d],listType:"userStory",maxHeight:400},a.create(e)}}}),define("tau/components/component.property.build",["tau/components/component.property","tau/models/finder/model.build.search","tau/models/finder/model.relation.editor"],function(a,b,c){return{create:function(d){return d.propertyName="build",d.showUrl=!0,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"finder",propertyName:"build",fields:["id","name",{project:["id","abbreviation"]}],searchModel:b,additionalExtensions:[c],listType:"build",maxHeight:400},a.create(d)}}}),define("tau/components/component.property.company",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="company",b.showUrl=!1,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"company",maxHeight:200,filter:!1,expandable:!1,showEmptyDataMessage:!1,clearValueLabel:"no company",defaultValueLabel:"current",fullModeLabel:"show old"},a.create(b)}}}),define("tau/components/component.property.feature",["tau/components/component.property","tau/models/finder/model.feature.search","tau/models/finder/model.relation.editor"],function(a,b,c){return{create:function(d){return d.propertyName="feature",d.showUrl=!0,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"finder",propertyName:"feature",searchModel:b,additionalExtensions:[c],maxHeight:400,filter:!0,expandable:!0,showEmptyDataMessage:!0},a.create(d)}}}),define("tau/components/component.property.iteration",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="iteration",b.showUrl=!0,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"iteration",maxHeight:200,filter:!0,expandable:!0,showEmptyDataMessage:!0,clearValueLabel:"backlog",defaultValueLabel:"current",fullModeLabel:"show old"},a.create(b)}}}),define("tau/components/component.property.lastRunDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="lastRunDate",b.editable=!1,b.format="datetime",a.create(b)}}}),define("tau/ui/templates/property/ui.template.property.status",["tau/core/templates-factory"],function(a){var b={name:"property-last-status",markup:["<div>",'   <div class="ui-status {{if value === true}}green{{/if}}{{if value === false}}red{{/if}}">',"   {{if value === true}}","       Passed","   {{/if}}","   {{if value === false}}","       Failed","   {{/if}}","</div>","</div>"].join("")};return a.register(b)}),define("tau/components/component.property.lastStatus",["tau/components/component.property.bool","tau/ui/templates/property/ui.template.property.status"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="lastStatus",c.template=b,a.create(c)}}}),define("tau/models/model.property.user",["tau/models/model.property","tau/configurator"],function(a,b){var c=function(a){this.model=a};c.prototype={onGetEntity:function(a){this.entity=a.data},done:function(){var a=this.entity[this.model.config.propertyName],c={id:a.id,avatar:[b.getApplicationPath(),"/Avatar.ashx?UserId=",a.id,"&size=32"].join(""),name:[a.firstName,a.lastName].join(" ")};this.model.fire("dataBind",c)}};var d=a.extend({onInit:function(){var a=this;this.listenOfPropertyChanged();var b=a.config.context,d=b.entity.entityType.name,e=b.entity.id,f=new c(a),g={},h=this.config.propertyName;g[h]=["firstName","lastName"],a.store.get(d,{id:e,fields:["id",g]},{scope:f,success:f.onGetEntity}).done({scope:f,success:f.done})}});return d}),define("tau/components/extensions/user/extension.user.editable",["tau/components/extensions/component.extension.base"],function(a){return a.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element,d=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f={type:"userList",data:e,extensions:this.getExtensions(),v2:!0};this.extendEditorConfig(f);var g={components:[f],context:b.config.context},h={target:c,componentsConfig:g,alignTo:c.find(".user-name")};this.fire("initBubble",h)}this.bus.on("edit",function(){this.fire("toggleBubble")},this)},extendEditorConfig:function(){},getExtensions:function(){return[]}})}),define("tau/models/assignment/model.property.owner.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(a,b){return b.extend({assignTo:function(a){var b={type:this.config.context.entity.entityType.name,$set:{owner:{id:a}},$include:[{owner:["id","firstName","lastName"]}]};this.fire("save",b)}})}),define("tau/models/userList/extension.model.user.Excluder",["Underscore","tau/core/model-base"],function(a,b){return b.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b=["id","firstName","lastName"],c={};c[this.getUserPropertyName()]=b,this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[c]},callback:{scope:this,success:this.onEntityRetrieved}})},getUserPropertyName:function(){throw"Use Excluder getUserPropertyName should be ovveriden"},onEntityRetrieved:function(a){var b=a.data||{},c=[b[this.getUserPropertyName()]];this.fire("excludedUserReady",c)}})}),define("tau/models/userList/extension.model.owner.Excluder",["Underscore","tau/models/userList/extension.model.user.Excluder"],function(a,b){return b.extend({getUserPropertyName:function(){return"owner"}})}),define("tau/components/extensions/user/extension.owner.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder"],function(a,b,c){return a.extend({category:"edit",extendEditorConfig:function(a){a.UserExcluder=c},getExtensions:function(){return[b]}})}),define("tau/components/component.property.owner",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.user","tau/components/extensions/user/extension.owner.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,e,f,d,h]};return i=i||{},i.propertyName="owner",a.create(j,i)}}}),define("tau/components/component.property.priority",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="priority",b.editorType="",b.alignElementSelector=".property-text",b.showEmptyDataMessage=!0,b.editorComponentConfig={type:"state-list",listType:"priority",maxHeight:200},a.create(b)}}}),define("tau/models/model.property.process",["Underscore","tau/models/model.property"],function(a,b){return b.extend({getPropertyData:function(a){this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",{process:["id","name",{practices:["id","name"]}]}]}).done({success:this.onEntityRetrieved,scope:this})},processProperty:function(b){var c={id:b[this.valueField],text:b[this.displayField],subtext:a.pluck(b.practices,"name").join(", ")};this.fire("dataBind",c)}})}),define("tau/components/extensions/property/extension.property.process.refresher",["Underscore","tau/core/model-base","tau/utils/utils.redirect"],function(a,b,c){return b.extend({category:"refresher","bus afterInit":function(){var a=this.store,b=this.config.context.entity,d=this.config.bus;this.store.unbind(this),a.on({eventName:"afterSave",type:"project",listener:this,filter:{id:b.id},hasChanges:["process"]},function(){d.getGlobalBus().fire("processChanged",{project:b,entity:b}),(new c).reload()})}})}),define("tau/components/component.property.process",["Underscore","tau/components/component.creator","tau/core/termProcessor","tau/models/model.property.process","tau/models/model.property.editable","tau/components/extensions/property/extension.property.process.refresher","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property"],function(a,b,c,d,e,f,g,h,i,j,k){return{create:function(h){h.propertyName="process",h.showUrl=!1,h.alignElementSelector=".property-text",h.editorComponentConfig={type:"state-list",listType:"process",maxHeight:200,filter:!1,expandable:!1,showEmptyDataMessage:!1,showClearValue:!1,allowToReset:!1,defaultValueLabel:"current",fullModeLabel:"show old",confirmation:"It is strongly recommended to NOT change Process for Projects in progress as some data will be lost (esp. the Custom fields data). Are you sure you want to change process?"},h.extensions=[f];var l=h.context.applicationContext.processes[0].terms,m=new c(l),n=h.editorComponentConfig;n.resetDisabled=h.resetDisabled,n.showEmptyDataMessage&&(n.emptyDataMessage="No "+m.getTerms(h.propertyName).names.toLowerCase()+" found"),n.showClearValue&&(h.clearValueLabel="reset "+m.getTerms(h.propertyName).name.toLowerCase());var o={ModelType:h.Model||d,template:k,extensions:a.concat([h.extensions,i,j,e,g])};return b.create(o,h)}}}),define("tau/components/component.property.project",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="project",b.showUrl=!0,b.editable=!1,b.alignElementSelector=".property-text",a.create(b)}}}),define("tau/components/component.property.release",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="release",b.showUrl=!0,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"release",expandable:!0,filter:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show old",clearValueLabel:"backlog"},a.create(b)}}}),define("tau/models/assignment/model.property.responsible.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(a,b){return b.extend({assignTo:function(a){var b={type:this.config.context.entity.entityType.name,$set:{responsible:{id:a}},$include:[{responsible:["id","firstName","lastName"]}]};this.fire("save",b)}})}),define("tau/models/userList/extension.model.responsible.Excluder",["Underscore","tau/models/userList/extension.model.user.Excluder"],function(a,b){return b.extend({getUserPropertyName:function(){return"responsible"}})}),define("tau/components/extensions/user/extension.responsible.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.responsible.editable","tau/models/userList/extension.model.responsible.Excluder"],function(a,b,c){return a.extend({category:"edit",extendEditorConfig:function(a){a.UserExcluder=c},getExtensions:function(){return[b]}})}),define("tau/components/component.property.responsible",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.user","tau/components/extensions/user/extension.responsible.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,e,f,d,h]};return i=i||{},i.propertyName="responsible",a.create(j,i)}}}),define("tau/models/model.property.severity",["Underscore","tau/models/model.property","tau/models/dataprocessor/model.processor.importance"],function(a,b,c){return b.extend({getPropertyFields:function(){var b=this._super(),c=a.union(b,["importance"]);return c},buildRequest:function(a){var b=this._super(a);return b=b.get("severity",{fields:["id","importance"]}),b},onProcessProperty:function(a){var b=this._super(a);return b.kind=this.importanceProcessor.getKind(a.importance),b},onEntityRetrieved:function(b){var d=this.property=b[0].data[this.propertyName]||{},e=a(b[1].data).pluck("importance"),f=a.min(e),g=a.max(e);this.importanceProcessor=new c(f,g),this.processProperty(d)}})}),define("tau/ui/templates/property/ui.template.property.severity",["tau/core/templates-factory"],function(a){var b={name:"property-severity",markup:["<div>",'   <span class="property  tau-list-severity-${kind}">','       <span class="property-text">${text}</span>',"   </span>","</div>"].join(""),dependencies:[]};return a.register(b)}),define("tau/components/component.property.severity",["tau/components/component.property","tau/models/model.property.severity","tau/ui/templates/property/ui.template.property.severity"],function(a,b,c){return{create:function(d){return d.propertyName="severity",d.editorType="",d.showUrl=!1,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"state-list",listType:"severity",maxHeight:200},d.Model=b,d.template=c,a.create(d)}}}),define("tau/components/component.property.startDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=b||{},b.propertyName="startDate",a.create(b)}}}),define("tau/components/component.property.startDate.project",["tau/components/component.property.date","tau/models/model.property.date.validation.project"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="startDate",c.extensions=[b],a.create(c)}}}),define("tau/components/component.property.testPlan",["tau/components/component.property"],function(a){return{create:function(b){return b=b||{},b.propertyName="testPlan",b.showUrl=!0,b.editable=!1,a.create(b)}}}),define("tau/components/component.property.text",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.text.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:c,extensions:a.concat([i.extensions,d,e,f,g]),template:h};return b.create(j,i)}}}),define("tau/components/component.property.lastFailureComment",["Underscore","tau/components/component.property.text"],function(a,b){return{create:function(c){return c=a.clone(c||{}),c.propertyName="lastFailureComment",c.defaultText="N/A",b.create(c)}}}),define("tau/models/model.property.time",["tau/models/model.property.simple"],function(a){return a.extend({floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onEntityRetrieved:function(a){var b=a[0].data[this.propertyName],c={text:this.floatToString(b),point:this._getEffortPoints()};this.fire("dataBind",c)}})}),define("tau/models/model.property.time.editable",["tau/core/model.editable.base"],function(a){return a.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/property/extension.property.time.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(a,b,c){return c.extend({category:"edit",normalizeEffort:function(a){return Math.abs(Math.round(parseFloat(a)*100)/100)||0},"bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.permissions=a.permissionsReady.data;c.editable&&(b.$el=a.afterRender.data.element,b.$el.find(".property-text").editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(c){var d=a.dataBind.data,e=b.normalizeEffort(d.text),f=b.normalizeEffort(c);if(e===f)return this.restoreInitialText(),!1;var g={};g[b.config.propertyName]=f;var h={$include:["id"],id:b.config.context.entity.id,$set:g};b.bus.fire("save",h)},onEditStart:function(){this.$element.data("points",this.$element.find("span").detach())},onEditEnd:function(){this.$element.append(this.$element.data("points"))}}))},showEditor:function(){this.$el.find(".property-text").editableText("activate")},"bus edit":function(){this.permissions.editable&&this.showEditor()},onClickHandler:function(){},removeHandlers:function(){},removeWidget:function(){this.$widget&&this.$widget.editableText("destroy")},destroy:function(){this.removeHandlers(),this.removeWidget(),this._super.apply(this,arguments)}})}),define("tau/ui/templates/property/ui.template.property.time",["tau/core/templates-factory"],function(a){var b={name:"property-time",markup:["<div>",'   <div class="property"><div class="property-text">${text}<span class="point">${point}</span></div></div>',"</div>"].join("")};return a.register(b)}),define("tau/components/component.property.time",["Underscore","tau/components/component.creator","tau/models/model.property.time","tau/models/model.property.time.editable","tau/components/extensions/property/extension.property.time.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property.time","tau/ui/behaviour/common/ui.behaviour.editableText"],function(a,b,c,d,e,f,g){return{create:function(a){var h={ModelType:c,template:g,extensions:[e,d,f]};return b.create(h,a)}}}),define("tau/components/component.property.initialEstimate",["Underscore","tau/components/component.property.time"],function(a,b){return{create:function(c){return c=a.clone(c||{}),c.propertyName="initialEstimate",b.create(c)}}}),define("tau/models/finder/model.userStory.search",["Underscore","tau/models/finder/model.assignable.search"],function(a,b){return b.extend({init:function(a){this._super(a);var b=function(a,b,c){a[b]={name:{$contains:c}}};this.properties.feature={label:this.terms.resolve("feature"),autoCompletable:!1,statement:b},this.properties.state.filter=function(a){return a?a.dataItem?a.dataItem.entityType.id===4:!0:!0}},getType:function(){return"userStory"}})}),define("tau/components/component.property.userStory",["tau/components/component.property","tau/models/finder/model.userStory.search","tau/models/finder/model.relation.editor"],function(a,b,c){return{create:function(d){return d.propertyName="userStory",d.showUrl=!0,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"finder",propertyName:"userStory",searchModel:b,additionalExtensions:[c],listType:"userStory",maxHeight:400},a.create(d)}}}),define("tau/components/component.property.velocity",["tau/components/component.property.time"],function(a){return{create:function(b){return b.propertyName="velocity",a.create(b)}}}),define("tau/components/extensions/redirect/extension.redirect",["tau/components/extensions/component.extension.base","tau/utils/utils.redirect"],function(a,b){return a.extend({_redirect:function(a){this.redirect.redirect(a)},"bus afterInit":function(a){this.redirect=new b(a.data.config.context),this._redirect(a.data.config.to)},"bus redirect":function(a){this._redirect(a.data.to)}})}),define("tau/components/component.redirect",["tau/components/component.creator","tau/models/model.menu.actions","tau/components/extensions/redirect/extension.redirect","tau/ui/templates/menu/ui.template.menu.actions"],function(a,b,c,d){return{create:function(b){var d={extensions:[c]};return a.create(d,b)}}}),define("tau/models/model.releaseNotes",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(a,b,c){var d=b.extend({onInit:function(){var b=this.config.context.entity,d=this.config.store,e=this;d.unbind(this),d.on({eventName:"afterSave",type:"assignable",listener:this},function(b){var c=["entityState","name"],d=["feature","userstory","bug"];a.include(d,b.data.cmd.type.toLowerCase())&&a.intersect(a.keys(b.data.changes),c).length&&e.bus.fire("refresh")});var f=["feature","userstory","bug"];a.forEach(f,function(a){d.on({eventName:"afterRemove",type:a,listener:e},function(a){e.bus.fire("refresh")})}),d.get("release",{id:b.id,fields:["id","name","startDate","endDate"]}).find("bugs",{fields:["id","name"],$query:{"Release.Id":b.id,"EntityState.isFinal":1},$orderBy:"id"}).find("features",{fields:["id","name",{release:["id"]},{userStories:["id","name",{release:["id"]},{entityState:["id","isFinal"]}]}],$query:{"Release.Id":b.id,"EntityState.isFinal":1},$orderBy:"id"}).find("userStories",{fields:["id","name",{release:["id"]},{feature:["id"]},{entityState:["id","isFinal"]}],$query:{"Release.Id":b.id,"Feature.Id":null,"EntityState.isFinal":1},$orderBy:"id"}).done({success:function(b){var d=b[2].data,f=[];a.forEach(d,function(b){var c=[],d=[];a.forEach(b.userStories,function(a){a.entityState.isFinal==1&&a.release&&a.release.id===b.release.id&&c.push(a),!a.entityState.isFinal&&a.release&&a.release.id===b.release.id&&d.push(a)}),c.length>0?(b.userStories=c,f.push(b)):b.userStories.length&&d.length==b.userStories.length&&(b.userStories=[],f.push(b))});var g=b[0].data;g.endDate=c.format.date.short(g.endDate);var h=b[1].data,i=b[3].data;e.bus.fire("dataBind",{item:g,features:f,bugs:h,userStories:i})}})}});return d}),define("tau/ui/templates/releaseNotes/ui.template.releaseNotes",["tau/core/templates-factory"],function(a){var b={name:"releaseNotes",markup:['<div class="tau-releaseNotes">','<div class="tau-releaseNotes__inner">',"<pre>",'<span class="tau-releaseNotes__title">${item.name} / ${item.endDate}</span><br />',"----------------------------------------------------------<br /><br />","{{if features.length || userStories.length}}",'<div class="tau-releaseNotes__subtitle">Added features</div><br /><br />',"{{each features}}",'<div class="tau-releaseNotes__feature" data-name="${name}">',"- ${name}<br />","{{each userStories}}",'<div class="tau-releaseNotes__userstory" data-name="${name}">',"    - ${name}<br />","</div>","{{/each}}","</div>","{{/each}}","{{each userStories}}",'<div class="tau-releaseNotes__userstory tau-releaseNotes__userstory_separate_true" data-name="${name}">',"- ${name}<br />","</div>","{{/each}}","<br /><br />","{{/if}}","{{if bugs.length}}",'<div class="tau-releaseNotes__subtitle">Fixed Bugs</div><br /><br />',"{{each bugs}}",'<div class="tau-releaseNotes__bug" data-name="${name}">',"#${id} ${name}<br />","</div>","{{/each}}","{{/if}}","</pre>","</div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.releaseNotes",["tau/components/component.creator","tau/models/model.releaseNotes","tau/ui/templates/releaseNotes/ui.template.releaseNotes"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.requestList",["tau/components/component.list.baseInfo","tau/components/extensions/requestsList/extension.requestList.refresher"],function(a,b){return{create:function(c){var d={extensions:[b]};return c.typeName="request",c.propertyName="requests",a.create(c,d)}}}),define("tau/models/propertyLists/model.defaultList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(a,b){return b.extend({onInit:function(){var b=this,c=this.config,d=this.config.context.entity;this.propertyType=c.listType,b.store.get(c.listType,{fields:["id","name"]}).get(d.entityType.name,{id:d.id,fields:["id",c.listType]}).done({success:a.bind(b.onDataRetrieved,b)})},onDataRetrieved:function(b){var c=b[0].data,d=b[1].data,e=this.config.data,f=!!e&&!!e.id,g={states:a.reject(c,function(a){return e&&a.id===e.id}),completed:!0,nullableValue:f};this.fire("dataBind",g)}})}),define("tau/models/propertyLists/model.prioritiesList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(a,b){return b.extend({name:"priority-list-model",propertyType:"priority",onInit:function(){var a=this,b=function(b){var c=b[0].data;a.assignable=c,a.store.get(a.propertyType,a.createGetPrioritiesCommand()).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};this.getAssignable(b)},getRequiredFields:function(){return[{entityType:["id"]}]},createGetPrioritiesCommand:function(){return{fields:["id","name","importance",{entityType:["id"]}]}},processData:function(b){var c=this.getCurrentEntityId(),d=this.assignable.entityType.id,e=[];a.each(b,function(a){a.id!==c&&a.entityType.id===d&&e.push({id:a.id,name:a.name,importance:a.importance||0})}),e.sort(function(a,b){return a.importance-b.importance}),this.fire("dataBind",{states:e,completed:!0,nullableValue:!1})}})}),define("tau/models/propertyLists/model.severityList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(a,b){return b.extend({name:"severity-list",propertyType:"severity",onInit:function(){var a=this;a.store.get(a.propertyType,{fields:["id","name","importance"]}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})},getRequiredFields:function(){return["id","name","importance"]},createGetStateForAssignableCommand:function(){return{fields:["id","name","importance"]}},processData:function(b){var c=this.getCurrentEntityId(),d=[];a.each(b,function(a){a.id!==c&&d.push({id:a.id,name:a.name,importance:a.importance})}),d.sort(function(a,b){return a.importance-b.importance}),this.fire("dataBind",{states:d,completed:!0,nullableValue:!1})}})}),define("tau/models/propertyLists/model.releaseList",["Underscore","tau/models/propertyLists/model.propertyList.base","tau/configurator","tau/core/types","tau/utils/utils.date"],function(a,b,c,d,e){return b.extend({name:"release-list",propertyType:"release",onInit:function(){var a=this,b=function(){a.store.get("project",{id:a.config.context.applicationContext.selectedProjects[0].id,nested:!0,fields:["id",{releases:["id","name","startDate","endDate"]}]}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};b()},"bus beforeSave":function(a){var b=a.data.cmd,c=b.$set,d=b.fields=b.fields||[];this.entityContainIteration()&&d.push({iteration:["id","name"]})},entityContainIteration:function(){var a=d.findByKeyword(this.config.context.entity.entityType.name);return a.refs.hasOwnProperty("iteration")},getRequiredFields:function(){return[{entityState:["id"]}]},convertReleaseToDto:function(a){var b=this.isCurrentRelease(a),c=a.name+(b?" (current)":"");return{id:a.id,name:c,description:"From "+e.format.date.short(a.startDate)+" to "+e.format.date.short(a.endDate)}},isOldRelease:function(a){var b=c.getCurrentDate();return a.endDate<b},isCurrentRelease:function(a){var b=c.getCurrentDate();return a.startDate<=b&&b<=a.endDate},isCurrentOrFeatureRelease:function(a){return!this.isOldRelease(a)},selectOldReleases:function(){return a.select(this.projectReleaseList,this.isOldRelease,this)},selectCurrentAndFeatureReleases:function(b){return a.select(this.projectReleaseList,this.isCurrentOrFeatureRelease,this)},getCurrentRelease:function(){return a.detect(this.projectReleaseList,this.isCurrentRelease,this)},initProjectReleaseList:function(b){var c=this.getCurrentEntityId(),d=a.select(b.releases,function(a){return a.id!=c});a.each(d,function(a){a.startDate=e.parse(a.startDate),a.endDate=e.parse(a.endDate)}),this.projectReleaseList=d},processData:function(b){this.initProjectReleaseList(b);var c=this.getCurrentEntityId(),d=this.config,e=d.mode||"short",f=this.selectCurrentAndFeatureReleases(),g=[],h=this.selectOldReleases(),i=h.length==0;e=="short"&&f.length>0?g=f:(e=="full",g=g.concat(h,f),i=!0),g=a.map(g,this.convertReleaseToDto,this);var j={nullableValue:c!==null&&this.config.context.entity.entityType.name.toLowerCase()!=="iteration"&&this.propertyIsNotEmpty(),states:g,completed:i},k=this.getCurrentRelease();k&&(j.defaultValue=k.id),this.fire("dataBind",j)}})}),define("tau/models/propertyLists/model.iterationList",["Underscore","tau/models/propertyLists/model.propertyList.base","tau/configurator","tau/utils/utils.date"],function(a,b,c,d){return b.extend({name:"iteration-list",propertyType:"iteration",onInit:function(){var a=this,b=function(){a.store.get("project",{id:a.config.context.applicationContext.selectedProjects[0].id,nested:!0,fields:["id",{iterations:["id","name","startDate","endDate",{release:["id","name"]}]}]}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};b()},getRequiredFields:function(){return[{entityState:["id"]}]},"bus beforeSave":function(a){var b=a.data.cmd.fields=a.data.cmd.fields||[];b.push({release:["id","name"]})},processData:function(b){var e=this.config,f=this.getCurrentEntityId(),g=[],h=e.mode||"short",i=null,j=null,k=c.getCurrentDate(),l=function(a){a.id!==f&&g.push(a)};h==="full"?i=l:i=function(a){var b=d.parse(a.startDate),c=d.parse(a.endDate);a.id!==f&&(b>=k||c>=k)&&g.push(a)},a.each(b.iterations,i),g.length==0&&(e.mode=="full",i=l,a.each(b.iterations,i));var m=[],n={};a(g).each(function(a){var b=n[a.release.id]||{id:a.release.id,name:a.release.name};b.items=b.items||[];var c=d.parse(a.startDate),e=d.parse(a.endDate),f=k>=c&&k<=e,g=a.name+(f?" (current)":"");f&&(j=a),b.items.push({id:a.id,name:g,description:"From "+d.format.date.short(c)+" to "+d.format.date.short(e)}),n[b.id]||(m.push(b),n[b.id]=b)});var o=b.iterations.length,p=f?o-1:o,q={nullableValue:f!==null&&this.propertyIsNotEmpty(),states:m,completed:0===g.length-p};j&&(q.defaultValue=j.id),this.fire("dataBind",q)}})}),define("tau/models/propertyLists/model.userStoryList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(a,b){return b.extend({name:"userStory-list",propertyType:"userStory",onInit:function(){var a=this,b=function(){a.store.get("userStory",{fields:["id","name",{project:["id","name"]}]}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};b()},processData:function(b){var c=this.getCurrentEntityId(),d={};a.each(b,function(a){if(a.id==c)return;d.hasOwnProperty(a.project.id)||(d[a.project.id]=a.project,d[a.project.id].items=[]),d[a.project.id].items.push(a)});var e={states:this.sortProjects(a.values(d)),completed:!0,nullableValue:c!==null&&this.config.context.entity.entityType.name.toLowerCase()!="task"&&this.propertyIsNotEmpty()};this.fire("dataBind",e)}})}),define("tau/models/propertyLists/model.featureList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(a,b){return b.extend({name:"release-list",propertyType:"feature",onInit:function(){var a=this;a.store.get("project",{fields:["id","name",{process:["id"]},{features:["id","name"]}]},{success:a.onProjectRetrieved.tauCreateDelegate(a)}).get("feature",{fields:["id","name",{project:["id"]}]},{success:a.onFeatureRetrieved.tauCreateDelegate(a)}).get("process",{fields:["id",{practices:["name"]}]},{success:a.onProcessesRetrieved.tauCreateDelegate(a)}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})},onFeatureRetrieved:function(a){this.featureList=a.data},onProjectRetrieved:function(a){this.projectList=a.data},onProcessesRetrieved:function(a){this.processList=a.data},getFeaturesForProject:function(b){var c=this.getCurrentEntityId(),d=function(a){a.id!==c&&this.push(a)},e=[];return this.projectHasRequirementsPractice(b)&&a.each(b.features,d,e),e},onDataRetrieved:function(){this.processData(this.projectList,this.processList)},projectHasRequirementsPractice:function(b){var c=b.process.id,d=a.detect(this.processList,function(a){return a.id==c}),e=a.detect(d.practices,function(a){return a.name=="Requirements"});return!a.isEmpty(e)},processData:function(b,c){var d=[];this.processList=c,a.each(this.sortProjects(b),function(b){var c=this.getFeaturesForProject(b);a.isEmpty(c)||d.push({id:b.id,name:b.name,items:c})},this);var e={states:d,completed:!0,nullableValue:this.getCurrentEntityId()!==null&&this.propertyIsNotEmpty()};this.fire("dataBind",e)}})}),define("tau/components/component.state-list",["tau/components/component.creator","tau/models/propertyLists/model.defaultList","tau/models/propertyLists/model.entityStateList","tau/models/propertyLists/model.prioritiesList","tau/models/propertyLists/model.severityList","tau/models/propertyLists/model.releaseList","tau/models/propertyLists/model.iterationList","tau/models/propertyLists/model.userStoryList","tau/models/propertyLists/model.featureList","tau/ui/extensions/stateList/ui.extension.stateList.editable","tau/ui/templates/state/ui.template.state-list"],function(a,b,c,d,e,f,g,h,i,j,k){var l={entityState:c,priority:d,severity:e,release:f,iteration:g,userStory:h,feature:i,hasModel:function(a){return this.hasOwnProperty(a)},getByName:function(a){if(this.hasModel(a))return this[a];throw"Model for property list  [mode."+a+"] was not found."}};return{create:function(c){var d=b;l.hasModel(c.listType)&&(d=l.getByName(c.listType));var e=[d,j],f={extensions:e,template:k};return a.create(f,c)}}}),define("tau/components/component.steps",["tau/components/component.field.richText"],function(a){return{create:function(b){return b=b||{},b.shortcutProcessorTarget=".ui-description__inner",b.fieldName="steps",a.create(b)}}}),define("tau/components/component.success",["tau/components/component.field.richText"],function(a){return{create:function(b){return b=b||{},b.shortcutProcessorTarget=".ui-description__inner",b.fieldName="success",a.create(b)}}}),define("tau/ui/extensions/tabs/ui.extension.tabs.state",["Underscore","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c){var d=b.extend({"bus initialize":function(a){this.config=a.data},"bus beforeInit":function(b){var d=b.data.config,e=this,f=d.children[0],g=c.getRouting().getStateParameter("tab"),h=null;a.forEach(f.children,function(a,b){g&&a.label==g&&(h=b)}),h&&(a.forEach(f.children,function(a,b){f.children[b].selected=!1,d.children[b+1]&&(d.children[b+1].visible=!1)}),f.children[h].selected=!0,d.children[h+1].visible=!0)}});return d}),define("tau/ui/extensions/tabs/ui.extension.tabsHeader.state",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c,d){var e=c.extend({"bus initialize":function(a){this.config=a.data},"bus afterRender":function(a){var b=this;b.$el=a.data.element,b.bus.getGlobalBus().on("routing.stateChanged",this.stateChangedListener,this)},stateChangedListener:function(a){var b=a.data;b.name=="tab"&&this._findAndSelect(b.value)},"bus tabSelected":function(a){var b=this.config.children[a.data.index];this.bus.getGlobalBus().fire("routing.setState",{tab:b.label})},_findAndSelect:function(c){if(!this.$el)return;var d=this,e=this.$el.find(".tab-item:not(.tab-item-additional)"),f=0;a.forEach(e,function(a){var d=b(a);d.data("label")==c&&(f=d.data().index)}),e.filter(".selected").removeClass("selected"),e.eq(f).addClass("selected"),d.bus.fire("tabSelected",{index:f})},destroy:function(){this.bus.getGlobalBus().removeListener("routing.stateChanged",this.stateChangedListener,this),this._super()}});return e}),define("tau/ui/extensions/layout/ui.extension.layout.tabsHeader",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(a,b,c){return c.extend({"bus beforeInit":function(a){var b=a.data.config;this.options={childrenContainerSelector:b.childrenContainerSelector||"ul.entity-tabs"}},getTabItemCssName:function(a){return"tab-item"+((a.position||{}).right?" tab-item-right-part":"")},"bus afterRender+childrenRendered":function(c){var d=this;d.element=c.afterRender.data.element;var e=c.childrenRendered.data;d.children=e.children;var f=e.childrenEvtArgs,g=e.config.children;a(f).each(function(a,b){var c=a.element,e=g[b],f=e.selected,h=d.getTabItemCssName(e);d._add(c,f,h,e.label)}),this.findContainerElement().bind("click",b.proxy(this._onContainerClick,this))},findContainerElement:function(){return this.element.find(this.options.childrenContainerSelector)},getTabsCount:function(){return this.findContainerElement().children(".tab-item").length},_add:function(a,c,d,e){var f=c?"selected":"";d=d||"tab-item",b('<li class="'+d+'"></li>').data({label:e||a.text(),index:this.getTabsCount()}).addClass(f).append(a).appendTo(this.findContainerElement())},_onContainerClick:function(a){var c=b(a.target),d=".tab-item",e=c.is(d)?c:c.parents(d);if(e.is(d)){var f=e.data().index,g={index:f,tabHeader:this.children[f]};if(this.fire("beforeSelectTab",g)!=1){var h=this.findContainerElement();h.children(".tab-item.selected").removeClass("selected"),h.children(d).eq(f).addClass("selected"),this.fire("tabSelected",g)}a.stopPropagation()}},destroy:function(){this._super(),delete this.element,delete this.children}})}),define("tau/ui/templates/container/ui.template.container.tabsHeader",["tau/core/templates-factory"],function(a){var b={name:"container.tabsHeader",markup:['<div class="box table">','   <ul class="entity-tabs">',"   </ul>","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.tabsHeader",["Underscore","tau/core/component-base","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/tabs/ui.extension.tabsHeader.state","tau/ui/extensions/layout/ui.extension.layout.tabsHeader","tau/ui/templates/container/ui.template.container.tabsHeader"],function(a,b,c,d,e,f,g){return{create:function(h){return h=h||{},a.defaults(h,{template:g}),(new b(h)).attach(c).attach(d).attach(e).attach(f).bus}}}),define("tau/views/view.tabs",["Underscore","tau/views/view.container","tau/components/component.tabsHeader"],function(a,b){var c=b.extend({"bus beforeInit":function(b){var c=this;c._selectedIndex=-1,this.additionalHeaderTabIndexList={};var d=b.data.config;this.tabsHeader={type:"tabsHeader",children:[]},this.panels=[],a.each(d.tabs,this.addTabInfo,this),a.each(d.additionalHeaders||[],this.addAdditionalActionToTab,this),d.children=[this.tabsHeader].concat(this.panels)},addTabInfo:function(a,b){var c=a.selected===!0,d={type:"container",name:a.label+" tab container",selected:c,children:a.header||[],label:a.label};this.tabsHeader.children.push(d);var e={type:"container",visible:c,children:a.items||[]};this.panels.push(e),c&&(this._selectedIndex=b)},addAdditionalActionToTab:function(a){var b=a||{};b.position={right:!0};var c=this.tabsHeader;c.children.push(b),this.additionalHeaderTabIndexList[c.children.length]=!0},isAdditionalAction:function(a){return this.additionalHeaderTabIndexList[a+1]},onBeforeSelectTab:function(a){var b=a.data.index;this.isAdditionalAction(b)&&a.cancel(),a.data.tabHeader.fire("select")},"bus childrenRendered":function(a){var b=(this.children=a.data.children)[0];b.on("beforeSelectTab",this.onBeforeSelectTab,this),b.on("tabSelected",this.onTabSelected,this)},hideAllChildren:function(){a.forEach(this.children,function(a,b){b>0&&a.fire("hide")})},showChildrenByIndex:function(a){this.children[1+a].fire("show")},setSelectedTabIndex:function(a){this.children[1+a]&&(this.hideAllChildren(),this.showChildrenByIndex(a),this._selectedIndex=a)},onTabSelected:function(a){var b=a.data.index;this.setSelectedTabIndex(b)}});return c}),define("tau/components/component.tabs",["tau/components/component.creator","tau/views/view.tabs","tau/components/extensions/component.creator.extension","tau/ui/extensions/tabs/ui.extension.tabs.state","tau/ui/extensions/layout/ui.extension.layout","tau/ui/templates/container/ui.template.container.list"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[c,d,e],ViewType:b,template:f};return a.create(h,g)}}}),define("tau/models/model.tags",["Underscore","tau/core/model-base"],function(a,b){var c=function(a){this.model=a};c.prototype={_parseTags:function(b){b=b||"";var c=a.isArray(b)?b:b.split(",");return a(c).map(function(a){return a.trim()})},onGetTags:function(a){var b=a.data;this.id=b.id,this.tags=this._parseTags(b.tags)},done:function(a){var b={tags:this.tags};this.model.bus.fire("dataBind",b)}};var d=b.extend({onInit:function(){var a=new c(this),b=this.config.context,d=b.assignable.entityType.name,e=b.assignable.id,f={id:e,fields:["id","tags"]};this.store.get(d,f,{scope:a,success:a.onGetTags}).done({success:a.done,scope:a})},"bus evict":function(){var a=this.config.context.general;this.store.evictProperties(a.id,a.entityType.name,["tags"])}});return d}),define("tau/models/model.tags.editable",["tau/core/model.editable.base"],function(a){var b=a.extend({category:"edit",name:"Editable tags","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})}});return b}),define("tau/ui/behaviour/tags/ui.behaviour.tagsEditor",["Underscore","jQuery","tau/core/tau"],function(a,b,c){b.widget("ui.tagsEditor",{options:{selector:".ui-tags__tag",onSave:function(){}},_create:function(){this.init()},init:function(){this.$list=b(this.element);var c=this.options.selector,d=this.$list.find(c);d.append('<a href="#" class="ui-tags__control-delete" title="Delete tag">Delete tag</a>');var e=this;this.$list.delegate(".ui-tags__control-delete","click",function(a){a.preventDefault(),b(this).parents(c).eq(0).remove(),e.options.onSave(e.getTags())}),this.$widget=b('<li class="ui-tags__editor"><a href="#" title="Add tag" class="ui-tags__editor__control-show"><i>Add tag</i></a></li>'),this.$widget.find("a:first").click(a.bind(this.showEditor,this)),this.$list.append(this.$widget)},showEditor:function(d){d.preventDefault();if(!this._editorIsVisible){if(!this.$editor){var e=b(c.concat('<span class="ui-tags__editor__inner">','    <input type="text" maxlength="50" class="ui-tags__editor__input" />','    <div class="button-group" style="position: relative; top: 5px; left: 3px;"><a title="Add" class="button small ui-tags__editor__button-submit" >Add&nbsp;</a>','    <a title="Cancel" class="button small ui-tags__editor__button-cancel"  >x</a></div>',"</span>")),f=this;e.find(".ui-tags__editor__button-submit").click(function(){var a=f.parseTags(e.find(":text").val());f.addTags(a),f.hideEditor(),f.options.onSave(f.getTags())}),e.find(".ui-tags__editor__button-cancel").click(function(){f.hideEditor()}),e.find(":text").keydown(a.bind(this.mapKeys,this)),e.appendTo(this.$widget),this.$editor=e}this.resetEditor(),this.$widget.toggleClass("ui-tags__editor-active",!0),this._editorIsVisible=!0,this.$editor.find(":text").focus()}},hideEditor:function(){this.$editor&&this._editorIsVisible&&(this.$editor.find(":text").blur(),this.$widget.toggleClass("ui-tags__editor-active",!1),this._editorIsVisible=!1,this.resetEditor())},resetEditor:function(){this.$editor&&this.$editor.find(":text").val("")},mapKeys:function(a){switch(a.which){case 13:a.preventDefault();var b=this,c=b.parseTags(this.$editor.find(":text").val());b.addTags(c),b.hideEditor(),b.options.onSave(b.getTags());break;case 27:a.preventDefault(),this.hideEditor(a)}},getTagsElements:function(){var a=[];return this.$list.find(this.options.selector).each(function(c,d){var e=b(d);a.push({value:b.trim(e.find("span:first").text()),$el:e})}),a},getTags:function(){var a=[];return this.$list.find(this.options.selector).each(function(c,d){var e=b(d);a.push(b.trim(e.find("span:first").text()))}),a},addTags:function(c){var d=this.getTagsElements(),e=a.pluck(d,"value"),f=[],g=[];a.each(c,function(b,c){var h=a.indexOf(e,b);h==-1?f.push(b):g.push(d[h].$el)});var h=b();this.$list.find(this.options.selector).removeClass("ui-tags__tag-new"),a.each(f,function(a){var c=b('<li class="ui-tags__tag ui-tags__tag-new"><a href="#" class="ui-tags__control-delete" title="Delete tag">Delete tag</a></li>');c.prepend("<span></span>").children().text(a),h=h.add(c)});var i=this.$list.find(this.options.selector);i.length?i.last().after(h):this.$list.prepend(h),this.$list.find(this.options.selector).removeClass("ui-tags__tag-updated"),a.each(g,function(a){a.addClass("ui-tags__tag-updated")}),this.$list.find(".ui-tags__tag-new, .ui-tags__tag-updated").css("backgroundColor","#FFFFE1").animate({backgroundColor:"#d3e6fc"},{queue:!1,duration:3e3})},parseTags:function(b){b=b||"";var c=b.split(",");return c=a(c).map(function(a){return a.trim()}),c=a.uniq(c),c=a.compact(c),c}})}),define("tau/components/extensions/tags/extension.tags.editable",["tau/components/extensions/component.extension.base","tau/ui/behaviour/tags/ui.behaviour.tagsEditor"],function(a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.permissionsReady.data;if(c.editable)var d=a.afterRender.data.element.tagsEditor({validation:{trim:!0},onSave:function(a){b.bus.fire("elementUpdated"),b.bus.fire("save",{tags:a.join(",")}),d.addClass("data-saving")}})}})}),define("tau/ui/templates/tags/ui.template.tag.item",["tau/core/templates-factory"],function(a){var b={name:"tag-item",markup:['<li class="ui-tags__tag" rel="tag">',"   <span>${$item.data}</span>","</li>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/tags/ui.template.tags",["tau/core/templates-factory","tau/ui/templates/tags/ui.template.tag.item"],function(a){var b={name:"tags",markup:['<ul class="ui-tags">','   {{tmpl(tags) "tag-item"}}',"</ul>"],dependencies:["tag-item"]};return a.register(b)}),define("tau/components/component.tags",["tau/components/component.creator","tau/models/model.tags","tau/models/model.tags.editable","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/components/extensions/tags/extension.tags.editable","tau/ui/templates/tags/ui.template.tags"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[b,c,e,d],template:f};return a.create(h,g)}}}),define("tau/models/model.testCaseList",["Underscore","tau/core/model-base","tau/utils/utils.urlBuilder","tau/utils/utils.date","tau/utils/utils.htmlConverter"],function(a,b,c,d,e){function f(a){this.model=a}f.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(b){var c={items:[]};this.model.assignable=b.data;var d=a.sortBy(b.data.testCases,function(a){return a.numericPriority}),e=d.length;for(var f=0;f<e;f++)c.items.push(this.convertServerDataModelData(d[f]));this.model.bus&&this.model.bus.fire("dataBind",c)},convertServerDataModelData:function(a){var b=null;a.lastRunDate&&(b=d.format.datetime.short(a.lastRunDate));var f=undefined;a.lastStatus!=undefined&&(f={isPassed:a.lastStatus});var g={__type:"testCase",id:a.id,name:a.name,lastRunDate:b,applicationUrl:"#testcase/"+a.id,externalUrl:c.getViewUrl(a.id),steps:e.fromSourceToHtml(a.steps),success:e.fromSourceToHtml(a.success)};return f&&(g.lastRunStatus=f),g}};var g=b.extend({onInit:function(){var a=this,b=new f(a),c=a.config.context.entity;this.store.get(c.entityType.name,{id:c.id,fields:["id",{testCases:["id","name","lastRunDate","lastStatus","steps","success","numericPriority"]}]},b.getAssignableRetrievedCallback()).done()},"bus evictTestCases":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,["testCases","testCases-count"])}});return g}),define("tau/models/model.testCaseList.editable",["tau/core/model.editable.base"],function(a){return a.extend({category:"edit",name:"Editable State","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.edit.addTestCase",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus afterRender+permissionsReady":function(a){if(a.permissionsReady.data.editable){var c=a.afterRender.data.element;c.find(".tau-add-testCase").click(b.proxy(this.addTestCaseClickHandler,this))}},addTestCaseClickHandler:function(){function e(){Ext.WindowMgr.zseed=9999999;var b=new Tp.controls.TestCaseCreateEditorWindow({userStoryId:c,processId:a.applicationContext.processes[0].id});b.show(),b.on("saved",function(){d.fire("testCaseWasAdded",{assignable:{id:c}})})}var a=this.config.context,c=a.assignable.id,d=this;if(!window.processConfigurations){var f=window.progressDialog||{show:function(){},hide:function(){}};f.show("Loading..."),Ext.Ajax.request({url:(new Tp.WebServiceURL("/PageServices/TestCaseListService.asmx/GetProcessConfiguration")).toString(),headers:{"Content-Type":"application/json"},success:function(a){f.hide();var c=b.parseJSON(a.responseText).d;processConfigurations=c,e()},jsonData:{userStoryId:c}})}else e()}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.edit.runner",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus dataBind":function(a){this.data=a.data},onAfterRender:function(){},"bus afterRender":function(a){this.element=a.data.element,this.onAfterRender()},"bus afterRender+permissionsReady":function(a){if(a.permissionsReady.data.editable){var c=a.afterRender.data.element;c.find(".last-run").removeClass("hidden"),c.find(".buttons").removeClass("hidden"),c.find(".passed").click(b.proxy(this.passedClickHandler,this)),c.find(".failed").click(b.proxy(this.failedClickHandler,this))}},getTestCaseId:function(a){return b(a.target).parents("tbody").eq(0).tmplItem().data.id},passedClickHandler:function(a){var b=this.getTestCaseId(a);this.setTestCaseStatus(b,!0)},failedClickHandler:function(a){var b=this.getTestCaseId(a);this.setTestCaseStatus(b,!1)},setTestCaseStatus:function(a,b){Ext.Ajax.request({url:(new Tp.WebServiceURL("/PageServices/TestCaseListService.asmx/ChangeRunState")).toString(),headers:{"Content-Type":"application/json"},success:this._onChangeStateComplete.createDelegate(this),failure:this._onChangeStateFailed.createDelegate(this),jsonData:{testCaseID:a,status:b}})},openNextTestCase:function(){var a=this.testCaseId,b=this.data.items;for(var c=0;c<b.length-1;c++)b[c].id===a&&this.fire("expandTestCase",{testCaseId:b[c+1].id});this.onAfterRender=function(){}},_onChangeStateComplete:function(a){this.testCaseId=b.parseJSON(a.responseText).d.TestCaseID,this.onAfterRender=this.openNextTestCase,this.fire("testCaseStateWasChanged")},_onChangeStateFailed:function(a){this.fire("showError",{message:a.get_message()})},destroy:function(){delete this.data,delete this.element}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.refresher",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({"bus testCaseWasAdded":function(a){this.fire("evictTestCases"),this.fire("refresh")},"bus testCaseStateWasChanged":function(a){this.fire("evictTestCases"),this.fire("refresh")}})}),define("tau/ui/templates/testCaseList/ui.template.testCaseList.testCase",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(a){var b={name:"test-case-list-test-case",markup:['<tbody class="collapsed">',"   <tr>",'       <td class="toggler"><button class="extra-info expand" type="button"><div>+</div></button></td>','       <td class="testcase-id">','           {{tmpl($data) "entity-link"}}',"       </td>","       <td>${name}</td>","       <td>${lastRunDate}</td>","       <td>","{{if  lastRunStatus }}","   {{if lastRunStatus.isPassed === true}}",'       <span class="passed">Passed</span>',"   {{/if}}","   {{if lastRunStatus.isPassed === false}}",'       <span class="failed">Failed</span>',"   {{/if}}","{{/if}}",'       <td class="buttons hidden">','           <button class="passed green-button" type="button">Pass</button>','           <button class="failed  red-button" type="button">Fail</button>',"       </td>","</td>","   </tr>","   <tr>","       <td></td>",'       <td colspan="5">','           <div class="steps">',"               <h4>Steps</h4>","               <span>{{html steps}}</span>","           </div>",'           <div class="success">',"               <h4>Success</h4>","               <span>{{html success}}</span>","           </div>","       </td>","   </tr>","</tbody>"].join(""),dependencies:["entity-link"]};return a.register(b)}),define("tau/ui/templates/testCaseList/ui.template.testCaseList",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/testCaseList/ui.template.testCaseList.testCase"],function(a,b){var c={name:"test-case-list",options:{contentSelector:".ui-testCaseList-content"},tags:[b],markup:['<div class="ui-testCaseList">','   <div class="button-panel">','       <button class="tau-add-testCase" type="button">Add {{term("TestCase") "name"}}</button>',"   </div>",'   <div class="ui-testCaseList-content"{{if items.length === 0}} style="display:none"{{/if}}>','       <table class="ui-testCaseList">',"           <colgroup>",'               <col class="toggler">','               <col class="id">','               <col class="name">','               <col class="last-run-date">','               <col class="last-status">','               <col class="last-run">',"           </colgroup>","           <thead>","               <tr>",'                   <th class="toggler">','                       <button class="extra-info expand" type="button"><div>+</div></button>','                        <button class="extra-info collapse" type="button"><div>-</div></button>',"                   </th>",'                   <th class="identificator">ID</th>',"                   <th>Name</th>","                   <th>Last Run Date</th>","                   <th>Last Status</th>",'                   <th class="last-run">Run</th>',"               </tr>","           </thead>",'           {{tmpl(items) "test-case-list-test-case"}}',"       </table>","   </div>","</div>"].join(""),dependencies:["test-case-list-test-case"]};return a.register(c)}),define("tau/ui/extensions/testCaseList/ui.extension.testCaseList",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(a,b,c){return c.extend({"bus afterRender":function(a){var b=this;b.element=a.data.element,b.element.find("tbody .extra-info").click(function(){b._onButtonClick.call(b,this)}),b.element.find("thead .extra-info.expand").click(function(){b.expandAll()}),b.element.find("thead .extra-info.collapse").click(function(){b.collapseAll()})},"bus expandTestCase":function(a){var c=a.data.testCaseId;this.element.find("tbody.collapsed").each(function(){b(this).tmplItem().data.id==c&&b(this).removeClass("collapsed").find(".extra-info").removeClass("expand").addClass("collapse")})},expandAll:function(){this.element.find("tbody.collapsed").removeClass("collapsed"),this._changeButtonsState("expand","collapse","-")},collapseAll:function(){this.element.find("tbody:not(.collapsed)").addClass("collapsed"),this._changeButtonsState("collapse","expand","+")},_changeButtonsState:function(a,c,d){var e="tbody .extra-info."+a,f=function(){b(this).addClass(c).removeClass(a).children("div").text(d)};this.element.find(e).each(f)},_onButtonClick:function(a){b(a).toggleClass("collapse").toggleClass("expand").parents("tbody").toggleClass("collapsed");var c=b(a).children("div"),d=c.text();d=="+"?d="-":d="+",c.text(d)}})}),define("tau/components/component.testCaseList",["tau/components/component.list.creator","tau/models/model.testCaseList","tau/models/model.testCaseList.editable","tau/components/extensions/testCaseList/extension.testCaseList.edit.addTestCase","tau/components/extensions/testCaseList/extension.testCaseList.edit.runner","tau/components/extensions/testCaseList/extension.testCaseList.refresher","tau/ui/templates/testCaseList/ui.template.testCaseList","tau/ui/extensions/testCaseList/ui.extension.testCaseList"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={template:g,extensions:[b,c,h,i.addTestCaseExtension||d,e,f],message:"No test cases found"};return a.create(j,i)}}}),define("tau/models/model.testCasesRunResults",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;this.store.get(c,{id:d,fields:["passedCount","failedCount","notRunCount"]},{success:this.onDataRetrieved,scope:this}).done()},onDataRetrieved:function(a){var b=a.data,c={passedCount:b.passedCount,failedCount:b.failedCount,notRunCount:b.notRunCount};this.bus.fire("dataBind",c)}});return b}),define("tau/ui/templates/testCasesRunResults/ui.template.testCasesRunResults",["tau/core/templates-factory"],function(a){var b={name:"test-cases-run-results",markup:['<div class="tau-testCasesRunResults">','   <div class="tau-testCasesRunResults-container">','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-passed">Passed: ${passedCount}</span>','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-failed">Failed: ${failedCount}</span>','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-notRun">Not Run: ${notRunCount}</span>',"   </div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/component.testCasesRunResults",["tau/components/component.creator","tau/models/model.testCasesRunResults","tau/ui/templates/testCasesRunResults/ui.template.testCasesRunResults"],function(a,b,c){return{create:function(d){var e={ModelType:b,template:c};return a.create(e,d)}}}),define("tau/models/model.timeList",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(a,b,c){function d(a){return{id:a,fields:["id","name",{times:["id","date","spent","remain","description",{user:["id","firstName","lastName"]}]}]}}function e(a){var b={id:a,fields:["id",{tasks:["id","name",{times:["id","date","spent","remain","description",{user:["id","firstName","lastName"]}]}]}],list:!0,nested:!0};return b}function f(a){this.model=a,this.times=[]}f.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},getTaskRetrievedCallbackInfo:function(){return{scope:this,success:this.onTasksRetrieved}},getAllTasksRetrievedCallbackInfo:function(){return{scope:this,success:this.onAllTasksRetrieved}},onAssignableRetrieved:function(a){this.assignable=this.model.assignable=a.data;var b=this.model.assignable,c=b.times;this._addTimesToTimeArray(c,this.assignable)},onTasksRetrieved:function(b){a(b.data.tasks).each(function(a){a.__type="task"});var c=b.data.tasks;for(var d=0;d<c.length;d++)this._addTimesToTimeArray(c[d].times,c[d])},onAllTasksRetrieved:function(){var a={items:this.getTimes()};this.model.bus.fire("dataBind",a)},getTimesSortedByDate:function(){var b=[],d=this.times.length;for(var e=0;e<d;e++){var f=a(this.times[e]).clone();f.date=c.parse(f.date),b.push(f)}return b.sort(function(a,b){return b.date-a.date}),b},getTimes:function(){var a=[],b=this.getTimesSortedByDate(),c=b.length;for(var d=0;d<c;d++)a.push(this.convertServerDataModelData(b[d]));return a},convertServerDataModelData:function(a){var b=a.user;return{date:c.format.date.short(a.date),spent:a.spent,remain:a.remain,description:a.description,person:[b.firstName,b.lastName].join(" "),workOn:{__type:a.workOn.__type,name:a.workOn.name}}},_addTimesToTimeArray:function(b,c){var d=[];for(var e=0;e<b.length;e++){var f=a(b[e]).clone();f.workOn=c,d.push(f)}this.times=this.times.concat(d)}};var g=b.extend({isUserStory:function(a){return a.toLowerCase()=="userstory"},onInit:function(){var a=new f(this),b=this.config.context.entity,c=b.id,g=b.entityType.name,h=d(c),i=this.isUserStory(g),j=this.store;j=j.get(g,h,a.getAssignableRetrievedCallback());if(i){var k=e(c);j=j.get(g,k,a.getTaskRetrievedCallbackInfo())}j.done(a.getAllTasksRetrievedCallbackInfo())}});return g}),define("tau/ui/templates/timeList/ui.template.timeList.time",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon"],function(a){var b={name:"time-list-time",markup:["<tr>",'   <td class="date">${date}</td>','   <td class="spent">${spent} h</td>','   <td class="remain">${remain} h</td>','   <td class="description">${description}</td>','   <td class="work-on">','    {{tmpl(workOn) "entity-icon"}}',"    <span>${workOn.name}</span>","   </td>",'   <td class="person">${person}</td>',"</tr>"].join(""),dependencies:["entity-icon"]};return a.register(b)}),define("tau/ui/templates/timeList/ui.template.timeList",["tau/core/templates-factory","tau/ui/templates/timeList/ui.template.timeList.time"],function(a){var b={name:"time-list",options:{contentSelector:".time-list"},markup:['<div class="ui-timeList-content">','<table class="ui-table box time-list"{{if items.length === 0}} style="display:none"{{/if}}>',"<thead>",'   <tr class="head-row">','       <th class="header-cell">Date</th>','       <th class="header-cell">Time Spent</th>','       <th class="header-cell">Time Remain</th>','       <th class="header-cell">Description</th>','       <th class="header-cell">Work On</th>','       <th class="header-cell">Person</th>',"   </tr>","</thead>","<tbody>",'    {{tmpl(items) "time-list-time"}}',"</tbody>","</table>","</div>"].join(""),dependencies:["time-list-time"]};return a.register(b)}),define("tau/components/component.timeList",["tau/components/component.list.creator","tau/models/model.timeList","tau/ui/templates/timeList/ui.template.timeList"],function(a,b,c){return{create:function(d){var e={ModelType:b,template:c,message:"No time records found"};return a.create(e,d)}}}),define("tau/models/model.title",["tau/core/model-base","tau/configurator"],function(a,b){var c=function(a,b){this.model=a,this.appContext=b};c.prototype={onGetEntity:function(a){this.entity=a.data},setProcess:function(a){this.process=a},setProject:function(a){this.project=a},"get task subPath":function(){return"Project/Planning/UserStory"},done:function(){var a=b.getCurrentAcid()||this.appContext.acid,c={entity:this.entity,process:this.process,project:this.project,appPath:b.getApplicationPath(),url:b.getApplicationPath()+"/RestUI/TpView.aspx?acid="+a+"#"+this.entity.__type.toLowerCase()+"/"+this.entity.id};this.model.fire("dataBind",c)}};var d=a.extend({onInit:function(){var a=this,b=a.config.context,d=b.entity.entityType.name,e=b.entity.id,f=b.applicationContext.processes[0],g=new c(a,b.applicationContext);g.setProcess(f),g.setProject(b.applicationContext.selectedProjects[0]),a.store.get(d,{id:e,fields:["id","name"]},{scope:g,success:g.onGetEntity}).done({scope:g,success:g.done})}});return d}),define("tau/models/model.title.editable",["tau/core/model.editable.base","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",name:"Editable title",schema:b.Schema.create({type:"object",properties:{name:{optional:!1,type:"string",maxLength:255,pre:["trim"],fallbacks:{maxLength:"truncateToMaxLength",optional:function(){}}}}}),"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus validate":function(a){var b=a.data,c=b.cmd.$set;b.validation=this.schema.validate(c)}});return c}),define("tau/components/extensions/title/extension.title.editable",["tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.permissionsReady.data;if(c.editable){var d=a.afterRender.data.element,e=d.find(".entity-title");this.$widget=e,e.editableText({restoreText:!0,onSave:function(a){b.bus.fire("save",{name:a})},onEditStart:function(){b._$titleInfo=e.find(".title-info").detach()},onEditEnd:function(){b._$titleInfo.appendTo(e)}})}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.editableText("setValue",a.data.validation.instance.name)},"bus validationFailed":function(a){this.$widget.editableText("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/ui/templates/title/ui.template.title",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon"],function(a){var b={name:"title",markup:['<table class="ui-title">',"<tbody>","<tr>","<td>",'{{tmpl({__type:entity.__type}) "entity-icon"}}','<span class="entity-id"><a class="ui-link" href="${url}">#${entity.id}</a></span>',"</td>","<td>",'<div class="entity-title">',"${entity.name}",'{{if entity.__type !== "project"}}','<span class="title-info"> for ${project.name}</span>',"{{/if}}","</div>","</td>","</tr>","</tbody>","</table>"],dependencies:["entity-icon"]};return a.register(b)}),define("tau/components/component.title",["tau/components/component.creator","tau/models/model.title","tau/models/model.title.editable","tau/components/extensions/title/extension.title.editable","tau/ui/templates/title/ui.template.title"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[b,c,d],template:e};return a.create(g,f)}}}),define("tau/models/model.userList",["Underscore","tau/core/types","tau/core/model-base","tau/configurator","tau/utils/utils.textsearch"],function(a,b,c,d,e){return c.extend({init:function(){this._super.apply(this,arguments),this.textSearch=new e},"bus setFilter":function(a){this.config.data.filter=a.data.filter,this.fire("refresh",{refreshSelector:".user-list,.footer-box"})},setShowMore:function(a){this.config.data.showMore=a},"bus showMore":function(){this.setShowMore(!0),this.fire("refresh",{refreshSelector:".user-list,.footer-box"})},onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction",{})},"bus projectMembersReady+excludedUserReady+projectRolesReady":function(a){var b=a.projectMembersReady.data,c=a.excludedUserReady.data,d=a.projectRolesReady.data,e=[],f=[];!this.excludedUsersContainsLoggedUser(c)&&this.loggedUserInProjectTeam(b)&&(f=[{id:"assign-to-me",title:"Assign To Me"}]),this.filterIsNotEmpty()?e=this.getFilteredGroups(d,b,c):(e=this.getGroups(b,c,d),e.length==0&&(this.setShowMore(!0),e=this.getGroups(b,c,d)));var g={headerActions:f,moreAvailable:!1,groups:e};this.fire("extendDataToBind",g),this.fire("dataBind",g)},getGroups:function(a,b,c){var d=[];for(var e=0;e<c.length;e++){var f=c[e];if(this.usersForRoleIsVisible(f)){var g=this.getUsersForRole(f,a,b);g.length>0&&d.push({role:f,users:g})}}return d},isStringValidForFilter:function(a){return this.textSearch.match(a,this.config.data.filter)!==null},getFilteredGroups:function(a,b,c){var d=[];for(var e=0;e<a.length;e++){var f=a[e],g=[];if(this.isStringValidForFilter(f.name))g=this.getUsersForRole(f,b,c);else{g=this.getUsersForRole(f,b,c);var h=[];for(var i=0;i<g.length;i++)this.isStringValidForFilter(g[i].name)&&h.push(g[i]);g=h}g.length>0&&d.push({role:f,users:g})}return d},usersForRoleIsVisible:function(a){var b=this.config.data||{};if(this.isMoreAvailable()){if(b.hasOwnProperty("roleId"))return b.roleId===a.id;if(b.role)return a.id==b.role.id}return!0},userIsNotExcluded:function(a,b){if(!a.user.isActive)return!1;var c=a.user.id;if(b.constructor!=Array)return c!=b.id;for(var d=0;d<b.length;d++)if(c==b[d].id)return!1;return!0},getUsersForRole:function(a,b,c){var d=[];for(var e=0;e<b.length;e++){var f=b[e];f.role.id==a.id&&this.userIsNotExcluded(f,c)&&d.push(this.convertUser(f.user))}return d.sort(function(a,b){var c=a.name.toLowerCase(),d=b.name.toLowerCase();return c<d?-1:c>d?1:0}),d},convertUser:function(a){return{id:a.id,name:[a.firstName,a.lastName].join(" "),role:a.role,avatar:[d.getApplicationPath(),"/Avatar.ashx?UserId=",a.id,"&size=32"].join("")}},getLoggedUser:function(){return this.config.context.applicationContext.loggedUser},loggedUserInProjectTeam:function(b){var c=this.getLoggedUser();return a.any(b,function(a){return a.user.id===c.id})},excludedUsersContainsLoggedUser:function(a){var b=this.getLoggedUser();for(var c=0;c<a.length;c++)if(a[c].id===b.id)return!0;return!1},filterIsNotEmpty:function(){return this.config.data.filter&&this.config.data.filter.length},filterIsEmpty:function(){return!this.filterIsNotEmpty()},isMoreAvailable:function(){var a=this.config.data;return this.filterIsEmpty()&&a.showMore!==!0&&(a.hasOwnProperty("roleId")||a.hasOwnProperty("role"))},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/extensions/team/extension.model.teamOfEntityRetriever",["Underscore","tau/core/model-base"],function(a,b){return b.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{project:["id"]}]},callback:{scope:this,success:this.onEntityRetrieved}})},onEntityRetrieved:function(a){var b=a.data.project?a.data.project.id:a.data.id,c={user:["id","firstName","lastName","isActive"]},d={role:["id","name"]},e={projectMembers:[c,d]};this.fire("get",{type:"project",query:{id:b,fields:["id",e]},callback:{scope:this,success:this.onProjectRetrieved}}),this.fire("commitTransaction")},onProjectRetrieved:function(a){var b=a.data.projectMembers;this.fire("projectMembersReady",b);var c=this.getRoles(b);this.fire("projectRolesReady",c)},getRoles:function(b){var c={},d=[];return a.each(b,function(a){var b=a.role;c.hasOwnProperty(b.id)||(c[b.id]=!0,d.push(b))}),d}})}),define("tau/models/userList/extension.model.assignmentsUser.Excluder",["Underscore","tau/core/model-base"],function(a,b){return b.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={role:["id","name"]},c={generalUser:["id","firstName","lastName"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{assignments:["id",b,c],list:!0}]},callback:{scope:this,success:this.onEntityRetrieved}})},onEntityRetrieved:function(a){var b=this.config.data||{},c=a.data,d=[],e=b.roleId||(b.role||{}).id;if(e){var f=c.assignments||[];for(var g=0;g<f.length;g++)f[g].role.id==e&&d.push(f[g].generalUser)}this.fire("excludedUserReady",d)}})}),define("tau/components/extensions/userList/extension.userList.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({category:"edit",name:"user list",init:function(){this._super.apply(this,arguments),this._userClick=b.proxy(this.onUserClick,this),this._unassignClick=b.proxy(this.onUnassignClick,this),this._assignToMeClick=b.proxy(this.onAssignToMeClick,this),this._filterChanged=b.proxy(this.onFilterChanged,this),this._moreClicked=b.proxy(this.onMoreClick,this)},onMoreClick:function(a){a.stopPropagation(),this.fire("showMore")},onUserClick:function(a){var c=b(a.target),d=c.tmplItem().data;this.fire("changeAssignment",{user:d})},onUnassignClick:function(){this.fire("removeAssignment")},onAssignToMeClick:function(){this.fire("assignToLoggedUser")},onFilterChanged:function(a){if(a.keyCode==b.ui.keyCode.DOWN||a.keyCode==b.ui.keyCode.UP||a.keyCode==b.ui.keyCode.ENTER)return;a.preventDefault(),this.fire("setFilter",{filter:b(a.target).val()})},"bus beforeRender":function(){var a=this.$element;a&&(a.find(".user").unbind("click",this._userClick),a.find(".unassign-button").unbind("click",this._unassignClick),a.find(".assign-to-me-button").unbind("click",this._assignToMeClick),a.find(".user-search-box").unbind("keyup",this._filterChanged),a.find(".more-link").unbind("click",this._moreClicked))},"bus afterRender":function(a){var b=this,c=b.$element=a.data.element;c.find(".user").click(this._userClick),c.find(".unassign-button").click(this._unassignClick),c.find(".assign-to-me-button").click(this._assignToMeClick),c.find(".user-search-box").keyup(this._filterChanged),c.find(".more-link").bind("click",this._moreClicked)},"bus refresh":function(a){var b=this.$element.find(".user-list");this._resize(),b.listSelectable({items:".user",className:"user_hover"}),b.listSelectable("enable"),b.listSelectable("reset")},"bus focus":function(a){var b=this.$element.find(".user-list");b.listSelectable({items:".user",className:"user_hover"}),b.listSelectable("enable"),this.$element.find(".user-search-box").focus()},"bus blur":function(a){var b=this.$element.find(".user-list");b.listSelectable("disable")},_resize:function(a){if(!this.$element)return;var c=this.$element,d=c.find(".user-list");d.css("maxHeight",b(window).height()/3),d.css("overflowY","auto"),d.css("overflowX","hidden")},"bus afterRender+popupResize":function(a){this._resize(a.popupResize.data)},"bus popupResize":function(a){this._resize(a.data)}})}),define("tau/ui/templates/filteredUserList/ui.template.filteredUserList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user"],function(a){var b={name:"user-list",markup:'<div class="role-title">${role.name}</div>{{tmpl(users) "user"}}',dependencies:["user"]};return a.register(b)}),define("tau/ui/templates/common/ui.template.linkAction",["tau/core/templates-factory"],function(a){var b={name:"link-action",markup:['<a class="${id}-link user-action" >',"   ${title}","</a>"].join("")};return a.register(b)}),define("tau/ui/templates/filteredUserList/ui.template.filteredUserList",["tau/core/templates-factory","tau/ui/templates/filteredUserList/ui.template.filteredUserList.userList","tau/ui/templates/common/ui.template.buttonAction","tau/ui/templates/common/ui.template.linkAction"],function(a){var b={name:"filtered-user-list",markup:['<div class="filtered-user-list">','<div class="header-box">','{{tmpl(headerActions) "button-action"}}',"</div>",'<div class="search-box-container">','   <input type="text" class="user-search-box">','   <div class="help">For filter start typing name or occupation</div>',"</div>",'<div class="user-list"><div class="i-inner">{{tmpl(groups) "user-list"}}</div></div>','<div class="footer-box">','<a class="more-link ',"{{if moreAvailable == false}}","link-hidden","{{/if}}",'" >',"more...","</a>","</div>","</div>"],dependencies:["user-list","button-action","link-action"]};return a.register(b)}),define("tau/components/component.userList",["Underscore","tau/components/component.creator","tau/models/model.userList","tau/models/assignmentsList/extension.model.store.operations","tau/models/extensions/team/extension.model.teamOfEntityRetriever","tau/models/userList/extension.model.assignmentsUser.Excluder","tau/components/extensions/userList/extension.userList.editable","tau/ui/templates/filteredUserList/ui.template.filteredUserList"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j=[];a.isArray(i.extensions)&&(j=a.clone(i.extensions));var k={extensions:j,template:h};return j.push(c),j.push(g),j.push(d),j.push(e),j.push(i.UserExcluder||f),b.create(k,i)}}}),define("tau/models/model.userStoriesList",["Underscore","tau/core/model-base","tau/models/dataprocessor/model.processor.assignments","tau/extensions/extension.underscore"],function(a,b,c){var d=function(a){this.model=a};d.prototype={sortByState:function(b){var c=a(b).sortBy(function(a){var b=0;return a.entityState.isinitial?b=-1:a.entityState.isfinal&&(b=1),b});return c},completeLoadEntities:function(b){var c=b[0].data.userStories;a(c).each(function(a){a.__type="userStory"});var d=this.sortByState(c);this.done(this.convertData(d))},convertData:function(a){var b=[];for(var d=0;d<a.length;d++){var e=a[d];e.priority=e.priority||{id:null,name:null},e.entityState=e.entityState||{id:null,name:null},e.release=e.release||{id:null,name:null},e.iteration=e.iteration||{id:null,name:null};var f={__type:e.__type,id:e.id,name:e.name,effort:e.effort,project:{id:e.project?e.project.id:null,name:e.project?e.project.name:null},priority:{id:e.priority.id,name:e.priority.name},entityState:{id:e.entityState.id,name:e.entityState.name},release:{id:e.release.id,name:e.release.name},iteration:{id:e.iteration.id,name:e.iteration.name},assignments:c.getAssignments(e)};b.push(f)}return b},done:function(a){var b={items:a};this.model.bus.fire("dataBind",b)}};var e=b.extend({_createDetailCommand:function(a){var b={};return b[a]=["id","name","effort",{project:["id","name"]},{priority:["id","name"]},{entityState:["id","name","isinitial","isfinal"]},{release:["id","name"]},{iteration:["id","name"]},{roleEfforts:["id",{role:["id","name"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]}],b},_retrieveEntity:function(a){var b=this.config.context,c=b.entity.entityType.name,d=b.entity.id,e=this._createDetailCommand("userStories"),f={id:d,nested:!0,fields:[e]};this.store.get(c,f).done({success:a.completeLoadEntities,scope:a})},onInit:function(){var a=new d(this);this._retrieveEntity(a)}});return e}),define("tau/ui/templates/userStoriesList/ui.template.userStoriesList.row",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon","tau/ui/templates/list/ui.template.list.item.assignments"],function(a){var b={name:"user-stories-list-row",markup:["<tr>",'   <td>{{tmpl($data) "entity-icon"}}</td>','   <td class="id">${id}</td>','   <td><a href="#userstory/${id}">${name}</a></td>',"   <td>${project.name}</td>","   <td>${priority.name}</td>","   <td>${effort}</td>","   <td>${entityState.name}</td>",'   <td>${release.name || "Backlog"}{{if iteration.id}}/${iteration.name}{{/if}}</td>','   <td>{{tmpl(assignments) "list-item-assignments"}}</td>',"</tr>"].join(""),dependencies:["list-item-assignments","entity-icon"]};return a.register(b)}),define("tau/ui/templates/userStoriesList/ui.template.userStoriesList",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/userStoriesList/ui.template.userStoriesList.row"],function(a,b){var c={name:"user-stories-list",options:{contentSelector:".tau-userStoriesList"},tags:[b],markup:['<div class="tau-userStoriesList-content">','   <table class="ui-table tau-userStoriesList"{{if items.length === 0}} style="display:none"{{/if}}>',"      <thead>","         <tr>",'           <th class="icon">&nbsp;</th>','           <th class="id">ID</th>','           <th class="name">Name</th>','           <th class="project">{{term("Project") "name"}}</th>','           <th class="priority">{{term("Priority") "name"}}</th>','           <th class="effort">Effort</th>','           <th class="state">State</th>','           <th class="releaseIteration">{{term("Release") "name"}}/{{term("Iteration") "name"}}</th>','           <th class="assignments">Assignments</th>',"         </tr>","      </thead>","      <tbody>",'      {{tmpl(items) "user-stories-list-row"}}',"      </tbody>","   </table>","</div>"].join(""),dependencies:["user-stories-list-row"]};return a.register(c)}),define("tau/components/component.userStoriesList",["tau/components/component.list.creator","tau/core/termProcessor","tau/models/model.userStoriesList","tau/ui/templates/userStoriesList/ui.template.userStoriesList"],function(a,b,c,d){return{create:function(e){var f=e.context.applicationContext.processes[0].terms,g=new b(f),h={ModelType:c,template:d,message:"No "+g.getTerms("userStory").names.toLowerCase()+" found"};return a.create(h,e)}}}),define("tau/models/model.extension",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction")}});return b}),define("tau/configurations/converters/converter.print",["Underscore","tau/models/model.extension","tau/models/model.impedimentsCountCalculator","tau/components/extensions/impedimentList/extension.impedimentList.visibilityController","tau/models/assignmentsList/extension.model.store.operations"],function(a,b,c,d,e){var f={impedimentListPanel:function(f){return a.extend(f,{compId:"impediments",type:"container",layout:"list",cssClass:"b-section",disableAnimation:!0,children:[{type:"label.impedimentsCount",hideCounter:!0},{type:"impedimentList"}],extensions:[b,d,c,e]}),f},tabs:function(b){b=a.extend(b,{type:"container",children:[],cssClass:"b-tabs"});var c=[];return a.forEach(b.tabs,function(c,d){c=a.extend(c,{type:"container",children:c.items,cssClass:"b-tab"}),!a.isUndefined(c.header)&&c.header.length&&c.children.unshift({type:"label",text:c.header[0].text}),b.children[d]=c}),b},collapsible:function(b){return b=a.extend(b,{type:"container",children:[],cssClass:"b-section"}),b.children=b.items,!a.isUndefined(b.header)&&b.header.length&&b.children.unshift({type:"label",text:b.header[0].text}),b}},g=function(b){return a.forEach(b,function(c,d){if(c.type){if(c.printable===!1){delete b[d];return}a.isFunction(f[c.type])&&(b[d]=f[c.type](c,b)),c.children&&(b[d].children=g(c.children)),c.items&&(b[d].items=g(c.items)),b[d].disabledExtensionCategories=["edit"]}else d=="children"&&(b[d]=g(c))}),b};return{convert:function(a){return a=g(a),a.children&&a.children.length&&(a.children[0].cssClass="main-container main-container-print"),a}}}),define("tau/components/extensions/print.convert.extension",["tau/components/extensions/component.extension.base","tau/configurations/converters/converter.print"],function(a,b){return a.extend({"bus onConfigContainerCreated":function(a){var c=a.data;b.convert(c),c.children.push({type:"print"})}})}),define("tau/components/extensions/application/extension.controller.entity",["Underscore","tau/core/class","tau/core/tau","tau/components/component.entity","tau/configurator","tau/utils/utils.redirect","tau/core/event","tau/core/types","tau/components/extensions/print.convert.extension"],function(a,b,c,d,e,f,g,h,i){return b.extend({init:function(a){this.config=a,this.bus=a.bus,g.subscribeOn(this),this._initGlobalEvents()},_initParameters:function(){var a={id:c.getValueFromQueryString("id"),type:null,action:null},b=c.getValueFromQueryString("type").split(".");a.entity=b[b.length-1];var d=/\/(\w+?).aspx$/.exec(window.location.pathname);return d=d&&d.length?d[1]:null,d=d&&typeof d!="undefined"&&d.toLocaleLowerCase()!="demoview"&&d.toLocaleLowerCase()!="tpview"?d.toLocaleLowerCase():"show",a.action=d,a},_initGlobalEvents:function(){var b=this,c=function(a){var c=a.data,d={project:{id:c.project.id}},e={id:c.entity.id,changes:d,cmd:{config:{$set:d}}};b.bus.fire("application.reload",e)},d=function(a){var c=a.data,d={},e={id:c.bugId,changes:d,cmd:{config:{$set:d}}};b.bus.fire("application.reload",e)};b.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",d,b),b.bus.getGlobalBus().on("entityWasMovedToProject",c,b),b.bus.getGlobalBus().on("processChanged",c,b);var f=["general","assignment","roleEffort"],g=e.getStore(),h=function(a){b.bus.fire("application.reload",a.data)};a.each(f,function(a){g.on({type:a,eventName:"afterSave",listener:b},h),g.on({type:a,eventName:"afterRemove",listener:b},h)})},"bus routing.registered":function(b){var c=this._initParameters(),d=this,e=a.bind(this.execute,this);this.bus.fire("registerRoute",{pattern:"",callback:function(a){e(c.action,c)}}),this.bus.fire("registerRoute",{pattern:"{entity}/{id}",callback:function(a){e("show",a)}}),this.bus.fire("registerRoute",{pattern:"{entity}/{id}/{action}",callback:function(a){e(a.action,a)}}),this.bus.fire("registerRouteNotFound",{callback:function(a){d.bus.fire("error",{message:"URL is not found"})}}),this.bus.fire("dataBind",{})},"bus afterRender":function(a){this.$element=a.data.element,this.bus.fire("controller.ready")},"bus beforeRender":function(a){},_getItemConfig:function(b,c){var d={context:{id:b,entityType:{name:c}}},e=d.context;return a.extend(d.context,{assignable:e}),a.extend(d.context,{entity:e}),a.extend(d.context,{general:e}),d},execute:function(a,b){if(!b.id&&!b.entity){var c=e.getRouting(),d=c.getReferer()?c.getReferer().url:null;d?c.redirect("#"+d):this.bus.fire("application.exit");return}var f=this;a="action"+a,this[a]||(a="actionshow"),this.bus.fire("controller.preExecute",{action:a,parameters:b}),this[a].call(this,b.id,b.entity),this.bus.fire("controller.postExecute")},actionshow:function(a,b){this._action(a,b)},actionprint:function(a,b){this._action(a,b,{extensions:[i]}),jQuery("body").addClass("print-mode")},_action:function(a,b,c){this.current&&(this.current.destroy(),e.clearSingles());var f=this;this.current=d.create(this._getItemConfig(a,b),c||{}),this.current.on("beforeDelete",function(a){f.bus.fire("initProgress")}),this.current.on("deleted",function(a){f.bus.fire("application.exit")}),this.current.on("error",function(a){f.bus.fire("application.error")}),this.current.on("afterRender",function(a){f.$element.length&&(f.$element.append(a.data.element),f.bus.fire("contentRendered",{element:a.data.element}))}),this.current.initialize()},"bus destroy":function(){e.getStore().unbind(this),e.getGlobalBus().removeAllListeners(this),this.current&&this.current.fire("destroy")}})}),define("tau/components/component.application",["tau/components/component.creator","tau/core/component-base","tau/core/view-base","tau/components/extensions/application/extension.history","tau/components/extensions/application/extension.routing","tau/components/extensions/application/extension.integration","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/popup/ui.extension.popup","tau/components/extensions/application/extension.controller.entity","tau/ui/templates/application/ui.template.application"],function(a,b,c,d,e,f,g,h,i,j){return{create:function(a){a=a||{onCreate:function(){}};var k={name:"application component",template:j},l=new b(k);return l.attach(e,a).attach(d,a).attach(f,a).attach(g,a).attach(i,a).attach(c),a.integration&&a.integration.showInPopup===!0&&l.attach(h,a),l.bus}}}),require(["tau/components/component.additionalInfo","tau/components/component.application","tau/components/component.assignedEffort","tau/components/component.assignmentsList","tau/components/component.attachments","tau/components/component.attachmentsPreview","tau/components/component.audit.history","tau/components/component.breadcrumbs","tau/components/component.collapsible","tau/components/component.collapsibleHeader","tau/components/component.comment","tau/components/component.comment.new.editor","tau/components/component.commentList","tau/components/component.comments","tau/components/component.container","tau/components/component.creator","tau/components/component.customField.checkbox","tau/components/component.customField.date","tau/components/component.customField.dropdown","tau/components/component.customField.dropdown.list","tau/components/component.customField.entity","tau/components/component.customField.number","tau/components/component.customField.richtext","tau/components/component.customField.text","tau/components/component.customField.url.editor","tau/components/component.customField.url","tau/components/component.description","tau/components/component.diagnostics.globalListeners","tau/components/component.diagnostics","tau/components/component.diagnostics.store","tau/components/component.entity.actions","tau/components/component.entity","tau/components/component.entityList","tau/components/component.entityStateList","tau/components/component.feature.assignmentList","tau/components/component.feature.totalEffort","tau/components/component.field.richText","tau/components/component.finder","tau/components/component.impedimentList","tau/components/component.impedimentListPanel","tau/components/component.implementationHistory","tau/components/component.iteration.progressBar","tau/components/component.label.impedimentsCount","tau/components/component.label","tau/components/component.list.baseInfo","tau/components/component.list.creator","tau/components/component.list.editable","tau/components/component.list","tau/components/component.lookswitcher","tau/components/component.menu.actions","tau/components/component.pluginsList","tau/components/component.print","tau/components/component.progressBar","tau/components/component.progressBar.small","tau/components/component.property.abbreviation","tau/components/component.property.assignable","tau/components/component.property.bool","tau/components/component.property.build","tau/components/component.property.buildDate","tau/components/component.property.company","tau/components/component.property.completeDate","tau/components/component.property.createDate","tau/components/component.property.date","tau/components/component.property.effort","tau/components/component.property.endDate","tau/components/component.property.endDate.project","tau/components/component.property.entityState","tau/components/component.property.feature","tau/components/component.property.impedimentDate","tau/components/component.property.initialEstimate","tau/components/component.property.isActive","tau/components/component.property.isPrivate","tau/components/component.property.isProduct","tau/components/component.property.iteration","tau/components/component.property","tau/components/component.property.lastFailureComment","tau/components/component.property.lastRunDate","tau/components/component.property.lastStatus","tau/components/component.property.owner","tau/components/component.property.priority","tau/components/component.property.process","tau/components/component.property.project","tau/components/component.property.release","tau/components/component.property.responsible","tau/components/component.property.severity","tau/components/component.property.startDate","tau/components/component.property.startDate.project","tau/components/component.property.testPlan","tau/components/component.property.text","tau/components/component.property.time","tau/components/component.property.userStory","tau/components/component.property.velocity","tau/components/component.redirect","tau/components/component.releaseNotes","tau/components/component.requestList","tau/components/component.state-list","tau/components/component.steps","tau/components/component.success","tau/components/component.tabs","tau/components/component.tabsHeader","tau/components/component.tags","tau/components/component.testCaseList","tau/components/component.testCasesRunResults","tau/components/component.timeList","tau/components/component.title","tau/components/component.userList","tau/components/component.userStoriesList","tau/components/extensions/print.convert.extension"],function(){return{}}),define("all.components",function(){})